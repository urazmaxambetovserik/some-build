function W7(e,r){for(var a=0;a<r.length;a++){const l=r[a];if(typeof l!="string"&&!Array.isArray(l)){for(const m in l)if(m!=="default"&&!(m in e)){const y=Object.getOwnPropertyDescriptor(l,m);y&&Object.defineProperty(e,m,y.get?y:{enumerable:!0,get:()=>l[m]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))l(m);new MutationObserver(m=>{for(const y of m)if(y.type==="childList")for(const T of y.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&l(T)}).observe(document,{childList:!0,subtree:!0});function a(m){const y={};return m.integrity&&(y.integrity=m.integrity),m.referrerPolicy&&(y.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?y.credentials="include":m.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function l(m){if(m.ep)return;m.ep=!0;const y=a(m);fetch(m.href,y)}})();function Zp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jS={exports:{}},cv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tD;function Z7(){if(tD)return cv;tD=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function a(l,m,y){var T=null;if(y!==void 0&&(T=""+y),m.key!==void 0&&(T=""+m.key),"key"in m){y={};for(var i in m)i!=="key"&&(y[i]=m[i])}else y=m;return m=y.ref,{$$typeof:e,type:l,key:T,ref:m!==void 0?m:null,props:y}}return cv.Fragment=r,cv.jsx=a,cv.jsxs=a,cv}var rD;function X7(){return rD||(rD=1,jS.exports=Z7()),jS.exports}var be=X7();const jv={black:"#000",white:"#fff"},x_={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},b_={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},w_={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},S_={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},T_={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"},uv={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},Y7={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function Gm(e,...r){const a=new URL(`https://mui.com/production-error/?code=${e}`);return r.forEach(l=>a.searchParams.append("args[]",l)),`Minified MUI error #${e}; visit ${a} for the full message.`}const Vp="$$material";function kb(){return kb=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},kb.apply(null,arguments)}var US={exports:{}},vo={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nD;function Q7(){if(nD)return vo;nD=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),T=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),B=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),G=Symbol.iterator;function Q(ft){return ft===null||typeof ft!="object"?null:(ft=G&&ft[G]||ft["@@iterator"],typeof ft=="function"?ft:null)}var te={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ne=Object.assign,oe={};function ue(ft,Vt,Jt){this.props=ft,this.context=Vt,this.refs=oe,this.updater=Jt||te}ue.prototype.isReactComponent={},ue.prototype.setState=function(ft,Vt){if(typeof ft!="object"&&typeof ft!="function"&&ft!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ft,Vt,"setState")},ue.prototype.forceUpdate=function(ft){this.updater.enqueueForceUpdate(this,ft,"forceUpdate")};function ye(){}ye.prototype=ue.prototype;function we(ft,Vt,Jt){this.props=ft,this.context=Vt,this.refs=oe,this.updater=Jt||te}var ve=we.prototype=new ye;ve.constructor=we,ne(ve,ue.prototype),ve.isPureReactComponent=!0;var Ce=Array.isArray,Ee={H:null,A:null,T:null,S:null,V:null},Be=Object.prototype.hasOwnProperty;function Ke(ft,Vt,Jt,Cr,ln,tn){return Jt=tn.ref,{$$typeof:e,type:ft,key:Vt,ref:Jt!==void 0?Jt:null,props:tn}}function st(ft,Vt){return Ke(ft.type,Vt,void 0,void 0,void 0,ft.props)}function dt(ft){return typeof ft=="object"&&ft!==null&&ft.$$typeof===e}function bt(ft){var Vt={"=":"=0",":":"=2"};return"$"+ft.replace(/[=:]/g,function(Jt){return Vt[Jt]})}var ht=/\/+/g;function Re(ft,Vt){return typeof ft=="object"&&ft!==null&&ft.key!=null?bt(""+ft.key):Vt.toString(36)}function Pt(){}function wt(ft){switch(ft.status){case"fulfilled":return ft.value;case"rejected":throw ft.reason;default:switch(typeof ft.status=="string"?ft.then(Pt,Pt):(ft.status="pending",ft.then(function(Vt){ft.status==="pending"&&(ft.status="fulfilled",ft.value=Vt)},function(Vt){ft.status==="pending"&&(ft.status="rejected",ft.reason=Vt)})),ft.status){case"fulfilled":return ft.value;case"rejected":throw ft.reason}}throw ft}function Et(ft,Vt,Jt,Cr,ln){var tn=typeof ft;(tn==="undefined"||tn==="boolean")&&(ft=null);var Hr=!1;if(ft===null)Hr=!0;else switch(tn){case"bigint":case"string":case"number":Hr=!0;break;case"object":switch(ft.$$typeof){case e:case r:Hr=!0;break;case F:return Hr=ft._init,Et(Hr(ft._payload),Vt,Jt,Cr,ln)}}if(Hr)return ln=ln(ft),Hr=Cr===""?"."+Re(ft,0):Cr,Ce(ln)?(Jt="",Hr!=null&&(Jt=Hr.replace(ht,"$&/")+"/"),Et(ln,Vt,Jt,"",function(Ur){return Ur})):ln!=null&&(dt(ln)&&(ln=st(ln,Jt+(ln.key==null||ft&&ft.key===ln.key?"":(""+ln.key).replace(ht,"$&/")+"/")+Hr)),Vt.push(ln)),1;Hr=0;var Nn=Cr===""?".":Cr+":";if(Ce(ft))for(var jn=0;jn<ft.length;jn++)Cr=ft[jn],tn=Nn+Re(Cr,jn),Hr+=Et(Cr,Vt,Jt,tn,ln);else if(jn=Q(ft),typeof jn=="function")for(ft=jn.call(ft),jn=0;!(Cr=ft.next()).done;)Cr=Cr.value,tn=Nn+Re(Cr,jn++),Hr+=Et(Cr,Vt,Jt,tn,ln);else if(tn==="object"){if(typeof ft.then=="function")return Et(wt(ft),Vt,Jt,Cr,ln);throw Vt=String(ft),Error("Objects are not valid as a React child (found: "+(Vt==="[object Object]"?"object with keys {"+Object.keys(ft).join(", ")+"}":Vt)+"). If you meant to render a collection of children, use an array instead.")}return Hr}function et(ft,Vt,Jt){if(ft==null)return ft;var Cr=[],ln=0;return Et(ft,Cr,"","",function(tn){return Vt.call(Jt,tn,ln++)}),Cr}function Zt(ft){if(ft._status===-1){var Vt=ft._result;Vt=Vt(),Vt.then(function(Jt){(ft._status===0||ft._status===-1)&&(ft._status=1,ft._result=Jt)},function(Jt){(ft._status===0||ft._status===-1)&&(ft._status=2,ft._result=Jt)}),ft._status===-1&&(ft._status=0,ft._result=Vt)}if(ft._status===1)return ft._result.default;throw ft._result}var ir=typeof reportError=="function"?reportError:function(ft){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Vt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ft=="object"&&ft!==null&&typeof ft.message=="string"?String(ft.message):String(ft),error:ft});if(!window.dispatchEvent(Vt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ft);return}console.error(ft)};function or(){}return vo.Children={map:et,forEach:function(ft,Vt,Jt){et(ft,function(){Vt.apply(this,arguments)},Jt)},count:function(ft){var Vt=0;return et(ft,function(){Vt++}),Vt},toArray:function(ft){return et(ft,function(Vt){return Vt})||[]},only:function(ft){if(!dt(ft))throw Error("React.Children.only expected to receive a single React element child.");return ft}},vo.Component=ue,vo.Fragment=a,vo.Profiler=m,vo.PureComponent=we,vo.StrictMode=l,vo.Suspense=z,vo.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ee,vo.__COMPILER_RUNTIME={__proto__:null,c:function(ft){return Ee.H.useMemoCache(ft)}},vo.cache=function(ft){return function(){return ft.apply(null,arguments)}},vo.cloneElement=function(ft,Vt,Jt){if(ft==null)throw Error("The argument must be a React element, but you passed "+ft+".");var Cr=ne({},ft.props),ln=ft.key,tn=void 0;if(Vt!=null)for(Hr in Vt.ref!==void 0&&(tn=void 0),Vt.key!==void 0&&(ln=""+Vt.key),Vt)!Be.call(Vt,Hr)||Hr==="key"||Hr==="__self"||Hr==="__source"||Hr==="ref"&&Vt.ref===void 0||(Cr[Hr]=Vt[Hr]);var Hr=arguments.length-2;if(Hr===1)Cr.children=Jt;else if(1<Hr){for(var Nn=Array(Hr),jn=0;jn<Hr;jn++)Nn[jn]=arguments[jn+2];Cr.children=Nn}return Ke(ft.type,ln,void 0,void 0,tn,Cr)},vo.createContext=function(ft){return ft={$$typeof:T,_currentValue:ft,_currentValue2:ft,_threadCount:0,Provider:null,Consumer:null},ft.Provider=ft,ft.Consumer={$$typeof:y,_context:ft},ft},vo.createElement=function(ft,Vt,Jt){var Cr,ln={},tn=null;if(Vt!=null)for(Cr in Vt.key!==void 0&&(tn=""+Vt.key),Vt)Be.call(Vt,Cr)&&Cr!=="key"&&Cr!=="__self"&&Cr!=="__source"&&(ln[Cr]=Vt[Cr]);var Hr=arguments.length-2;if(Hr===1)ln.children=Jt;else if(1<Hr){for(var Nn=Array(Hr),jn=0;jn<Hr;jn++)Nn[jn]=arguments[jn+2];ln.children=Nn}if(ft&&ft.defaultProps)for(Cr in Hr=ft.defaultProps,Hr)ln[Cr]===void 0&&(ln[Cr]=Hr[Cr]);return Ke(ft,tn,void 0,void 0,null,ln)},vo.createRef=function(){return{current:null}},vo.forwardRef=function(ft){return{$$typeof:i,render:ft}},vo.isValidElement=dt,vo.lazy=function(ft){return{$$typeof:F,_payload:{_status:-1,_result:ft},_init:Zt}},vo.memo=function(ft,Vt){return{$$typeof:B,type:ft,compare:Vt===void 0?null:Vt}},vo.startTransition=function(ft){var Vt=Ee.T,Jt={};Ee.T=Jt;try{var Cr=ft(),ln=Ee.S;ln!==null&&ln(Jt,Cr),typeof Cr=="object"&&Cr!==null&&typeof Cr.then=="function"&&Cr.then(or,ir)}catch(tn){ir(tn)}finally{Ee.T=Vt}},vo.unstable_useCacheRefresh=function(){return Ee.H.useCacheRefresh()},vo.use=function(ft){return Ee.H.use(ft)},vo.useActionState=function(ft,Vt,Jt){return Ee.H.useActionState(ft,Vt,Jt)},vo.useCallback=function(ft,Vt){return Ee.H.useCallback(ft,Vt)},vo.useContext=function(ft){return Ee.H.useContext(ft)},vo.useDebugValue=function(){},vo.useDeferredValue=function(ft,Vt){return Ee.H.useDeferredValue(ft,Vt)},vo.useEffect=function(ft,Vt,Jt){var Cr=Ee.H;if(typeof Jt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Cr.useEffect(ft,Vt)},vo.useId=function(){return Ee.H.useId()},vo.useImperativeHandle=function(ft,Vt,Jt){return Ee.H.useImperativeHandle(ft,Vt,Jt)},vo.useInsertionEffect=function(ft,Vt){return Ee.H.useInsertionEffect(ft,Vt)},vo.useLayoutEffect=function(ft,Vt){return Ee.H.useLayoutEffect(ft,Vt)},vo.useMemo=function(ft,Vt){return Ee.H.useMemo(ft,Vt)},vo.useOptimistic=function(ft,Vt){return Ee.H.useOptimistic(ft,Vt)},vo.useReducer=function(ft,Vt,Jt){return Ee.H.useReducer(ft,Vt,Jt)},vo.useRef=function(ft){return Ee.H.useRef(ft)},vo.useState=function(ft){return Ee.H.useState(ft)},vo.useSyncExternalStore=function(ft,Vt,Jt){return Ee.H.useSyncExternalStore(ft,Vt,Jt)},vo.useTransition=function(){return Ee.H.useTransition()},vo.version="19.1.1",vo}var iD;function Y_(){return iD||(iD=1,US.exports=Q7()),US.exports}var ae=Y_();const Ko=Zp(ae),zb=W7({__proto__:null,default:Ko},[ae]);function K7(e){if(e.sheet)return e.sheet;for(var r=0;r<document.styleSheets.length;r++)if(document.styleSheets[r].ownerNode===e)return document.styleSheets[r]}function J7(e){var r=document.createElement("style");return r.setAttribute("data-emotion",e.key),e.nonce!==void 0&&r.setAttribute("nonce",e.nonce),r.appendChild(document.createTextNode("")),r.setAttribute("data-s",""),r}var eV=(function(){function e(a){var l=this;this._insertTag=function(m){var y;l.tags.length===0?l.insertionPoint?y=l.insertionPoint.nextSibling:l.prepend?y=l.container.firstChild:y=l.before:y=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(m,y),l.tags.push(m)},this.isSpeedy=a.speedy===void 0?!0:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var r=e.prototype;return r.hydrate=function(l){l.forEach(this._insertTag)},r.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(J7(this));var m=this.tags[this.tags.length-1];if(this.isSpeedy){var y=K7(m);try{y.insertRule(l,y.cssRules.length)}catch{}}else m.appendChild(document.createTextNode(l));this.ctr++},r.flush=function(){this.tags.forEach(function(l){var m;return(m=l.parentNode)==null?void 0:m.removeChild(l)}),this.tags=[],this.ctr=0},e})(),Xc="-ms-",Lb="-moz-",fa="-webkit-",kL="comm",l3="rule",c3="decl",tV="@import",zL="@keyframes",rV="@layer",nV=Math.abs,Cw=String.fromCharCode,iV=Object.assign;function oV(e,r){return gc(e,0)^45?(((r<<2^gc(e,0))<<2^gc(e,1))<<2^gc(e,2))<<2^gc(e,3):0}function LL(e){return e.trim()}function aV(e,r){return(e=r.exec(e))?e[0]:e}function da(e,r,a){return e.replace(r,a)}function NE(e,r){return e.indexOf(r)}function gc(e,r){return e.charCodeAt(r)|0}function Uv(e,r,a){return e.slice(r,a)}function Bp(e){return e.length}function u3(e){return e.length}function Y1(e,r){return r.push(e),e}function sV(e,r){return e.map(r).join("")}var Mw=1,B_=1,BL=0,Dh=0,Al=0,Q_="";function Iw(e,r,a,l,m,y,T){return{value:e,root:r,parent:a,type:l,props:m,children:y,line:Mw,column:B_,length:T,return:""}}function hv(e,r){return iV(Iw("",null,null,"",null,null,0),e,{length:-e.length},r)}function lV(){return Al}function cV(){return Al=Dh>0?gc(Q_,--Dh):0,B_--,Al===10&&(B_=1,Mw--),Al}function wf(){return Al=Dh<BL?gc(Q_,Dh++):0,B_++,Al===10&&(B_=1,Mw++),Al}function $p(){return gc(Q_,Dh)}function xb(){return Dh}function ox(e,r){return Uv(Q_,e,r)}function Vv(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function FL(e){return Mw=B_=1,BL=Bp(Q_=e),Dh=0,[]}function NL(e){return Q_="",e}function bb(e){return LL(ox(Dh-1,jE(e===91?e+2:e===40?e+1:e)))}function uV(e){for(;(Al=$p())&&Al<33;)wf();return Vv(e)>2||Vv(Al)>3?"":" "}function hV(e,r){for(;--r&&wf()&&!(Al<48||Al>102||Al>57&&Al<65||Al>70&&Al<97););return ox(e,xb()+(r<6&&$p()==32&&wf()==32))}function jE(e){for(;wf();)switch(Al){case e:return Dh;case 34:case 39:e!==34&&e!==39&&jE(Al);break;case 40:e===41&&jE(e);break;case 92:wf();break}return Dh}function fV(e,r){for(;wf()&&e+Al!==57;)if(e+Al===84&&$p()===47)break;return"/*"+ox(r,Dh-1)+"*"+Cw(e===47?e:wf())}function dV(e){for(;!Vv($p());)wf();return ox(e,Dh)}function pV(e){return NL(wb("",null,null,null,[""],e=FL(e),0,[0],e))}function wb(e,r,a,l,m,y,T,i,z){for(var B=0,F=0,G=T,Q=0,te=0,ne=0,oe=1,ue=1,ye=1,we=0,ve="",Ce=m,Ee=y,Be=l,Ke=ve;ue;)switch(ne=we,we=wf()){case 40:if(ne!=108&&gc(Ke,G-1)==58){NE(Ke+=da(bb(we),"&","&\f"),"&\f")!=-1&&(ye=-1);break}case 34:case 39:case 91:Ke+=bb(we);break;case 9:case 10:case 13:case 32:Ke+=uV(ne);break;case 92:Ke+=hV(xb()-1,7);continue;case 47:switch($p()){case 42:case 47:Y1(mV(fV(wf(),xb()),r,a),z);break;default:Ke+="/"}break;case 123*oe:i[B++]=Bp(Ke)*ye;case 125*oe:case 59:case 0:switch(we){case 0:case 125:ue=0;case 59+F:ye==-1&&(Ke=da(Ke,/\f/g,"")),te>0&&Bp(Ke)-G&&Y1(te>32?aD(Ke+";",l,a,G-1):aD(da(Ke," ","")+";",l,a,G-2),z);break;case 59:Ke+=";";default:if(Y1(Be=oD(Ke,r,a,B,F,m,i,ve,Ce=[],Ee=[],G),y),we===123)if(F===0)wb(Ke,r,Be,Be,Ce,y,G,i,Ee);else switch(Q===99&&gc(Ke,3)===110?100:Q){case 100:case 108:case 109:case 115:wb(e,Be,Be,l&&Y1(oD(e,Be,Be,0,0,m,i,ve,m,Ce=[],G),Ee),m,Ee,G,i,l?Ce:Ee);break;default:wb(Ke,Be,Be,Be,[""],Ee,0,i,Ee)}}B=F=te=0,oe=ye=1,ve=Ke="",G=T;break;case 58:G=1+Bp(Ke),te=ne;default:if(oe<1){if(we==123)--oe;else if(we==125&&oe++==0&&cV()==125)continue}switch(Ke+=Cw(we),we*oe){case 38:ye=F>0?1:(Ke+="\f",-1);break;case 44:i[B++]=(Bp(Ke)-1)*ye,ye=1;break;case 64:$p()===45&&(Ke+=bb(wf())),Q=$p(),F=G=Bp(ve=Ke+=dV(xb())),we++;break;case 45:ne===45&&Bp(Ke)==2&&(oe=0)}}return y}function oD(e,r,a,l,m,y,T,i,z,B,F){for(var G=m-1,Q=m===0?y:[""],te=u3(Q),ne=0,oe=0,ue=0;ne<l;++ne)for(var ye=0,we=Uv(e,G+1,G=nV(oe=T[ne])),ve=e;ye<te;++ye)(ve=LL(oe>0?Q[ye]+" "+we:da(we,/&\f/g,Q[ye])))&&(z[ue++]=ve);return Iw(e,r,a,m===0?l3:i,z,B,F)}function mV(e,r,a){return Iw(e,r,a,kL,Cw(lV()),Uv(e,2,-2),0)}function aD(e,r,a,l){return Iw(e,r,a,c3,Uv(e,0,l),Uv(e,l+1,-1),l)}function D_(e,r){for(var a="",l=u3(e),m=0;m<l;m++)a+=r(e[m],m,e,r)||"";return a}function AV(e,r,a,l){switch(e.type){case rV:if(e.children.length)break;case tV:case c3:return e.return=e.return||e.value;case kL:return"";case zL:return e.return=e.value+"{"+D_(e.children,l)+"}";case l3:e.value=e.props.join(",")}return Bp(a=D_(e.children,l))?e.return=e.value+"{"+a+"}":""}function gV(e){var r=u3(e);return function(a,l,m,y){for(var T="",i=0;i<r;i++)T+=e[i](a,l,m,y)||"";return T}}function _V(e){return function(r){r.root||(r=r.return)&&e(r)}}function jL(e){var r=Object.create(null);return function(a){return r[a]===void 0&&(r[a]=e(a)),r[a]}}var yV=function(r,a,l){for(var m=0,y=0;m=y,y=$p(),m===38&&y===12&&(a[l]=1),!Vv(y);)wf();return ox(r,Dh)},vV=function(r,a){var l=-1,m=44;do switch(Vv(m)){case 0:m===38&&$p()===12&&(a[l]=1),r[l]+=yV(Dh-1,a,l);break;case 2:r[l]+=bb(m);break;case 4:if(m===44){r[++l]=$p()===58?"&\f":"",a[l]=r[l].length;break}default:r[l]+=Cw(m)}while(m=wf());return r},xV=function(r,a){return NL(vV(FL(r),a))},sD=new WeakMap,bV=function(r){if(!(r.type!=="rule"||!r.parent||r.length<1)){for(var a=r.value,l=r.parent,m=r.column===l.column&&r.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(r.props.length===1&&a.charCodeAt(0)!==58&&!sD.get(l))&&!m){sD.set(r,!0);for(var y=[],T=xV(a,y),i=l.props,z=0,B=0;z<T.length;z++)for(var F=0;F<i.length;F++,B++)r.props[B]=y[z]?T[z].replace(/&\f/g,i[F]):i[F]+" "+T[z]}}},wV=function(r){if(r.type==="decl"){var a=r.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(r.return="",r.value="")}};function UL(e,r){switch(oV(e,r)){case 5103:return fa+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return fa+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return fa+e+Lb+e+Xc+e+e;case 6828:case 4268:return fa+e+Xc+e+e;case 6165:return fa+e+Xc+"flex-"+e+e;case 5187:return fa+e+da(e,/(\w+).+(:[^]+)/,fa+"box-$1$2"+Xc+"flex-$1$2")+e;case 5443:return fa+e+Xc+"flex-item-"+da(e,/flex-|-self/,"")+e;case 4675:return fa+e+Xc+"flex-line-pack"+da(e,/align-content|flex-|-self/,"")+e;case 5548:return fa+e+Xc+da(e,"shrink","negative")+e;case 5292:return fa+e+Xc+da(e,"basis","preferred-size")+e;case 6060:return fa+"box-"+da(e,"-grow","")+fa+e+Xc+da(e,"grow","positive")+e;case 4554:return fa+da(e,/([^-])(transform)/g,"$1"+fa+"$2")+e;case 6187:return da(da(da(e,/(zoom-|grab)/,fa+"$1"),/(image-set)/,fa+"$1"),e,"")+e;case 5495:case 3959:return da(e,/(image-set\([^]*)/,fa+"$1$`$1");case 4968:return da(da(e,/(.+:)(flex-)?(.*)/,fa+"box-pack:$3"+Xc+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+fa+e+e;case 4095:case 3583:case 4068:case 2532:return da(e,/(.+)-inline(.+)/,fa+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Bp(e)-1-r>6)switch(gc(e,r+1)){case 109:if(gc(e,r+4)!==45)break;case 102:return da(e,/(.+:)(.+)-([^]+)/,"$1"+fa+"$2-$3$1"+Lb+(gc(e,r+3)==108?"$3":"$2-$3"))+e;case 115:return~NE(e,"stretch")?UL(da(e,"stretch","fill-available"),r)+e:e}break;case 4949:if(gc(e,r+1)!==115)break;case 6444:switch(gc(e,Bp(e)-3-(~NE(e,"!important")&&10))){case 107:return da(e,":",":"+fa)+e;case 101:return da(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+fa+(gc(e,14)===45?"inline-":"")+"box$3$1"+fa+"$2$3$1"+Xc+"$2box$3")+e}break;case 5936:switch(gc(e,r+11)){case 114:return fa+e+Xc+da(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return fa+e+Xc+da(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return fa+e+Xc+da(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return fa+e+Xc+e+e}return e}var SV=function(r,a,l,m){if(r.length>-1&&!r.return)switch(r.type){case c3:r.return=UL(r.value,r.length);break;case zL:return D_([hv(r,{value:da(r.value,"@","@"+fa)})],m);case l3:if(r.length)return sV(r.props,function(y){switch(aV(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return D_([hv(r,{props:[da(y,/:(read-\w+)/,":"+Lb+"$1")]})],m);case"::placeholder":return D_([hv(r,{props:[da(y,/:(plac\w+)/,":"+fa+"input-$1")]}),hv(r,{props:[da(y,/:(plac\w+)/,":"+Lb+"$1")]}),hv(r,{props:[da(y,/:(plac\w+)/,Xc+"input-$1")]})],m)}return""})}},TV=[SV],EV=function(r){var a=r.key;if(a==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(oe){var ue=oe.getAttribute("data-emotion");ue.indexOf(" ")!==-1&&(document.head.appendChild(oe),oe.setAttribute("data-s",""))})}var m=r.stylisPlugins||TV,y={},T,i=[];T=r.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(oe){for(var ue=oe.getAttribute("data-emotion").split(" "),ye=1;ye<ue.length;ye++)y[ue[ye]]=!0;i.push(oe)});var z,B=[bV,wV];{var F,G=[AV,_V(function(oe){F.insert(oe)})],Q=gV(B.concat(m,G)),te=function(ue){return D_(pV(ue),Q)};z=function(ue,ye,we,ve){F=we,te(ue?ue+"{"+ye.styles+"}":ye.styles),ve&&(ne.inserted[ye.name]=!0)}}var ne={key:a,sheet:new eV({key:a,container:T,nonce:r.nonce,speedy:r.speedy,prepend:r.prepend,insertionPoint:r.insertionPoint}),nonce:r.nonce,inserted:y,registered:{},insert:z};return ne.sheet.hydrate(i),ne},VS={exports:{}},_a={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lD;function CV(){if(lD)return _a;lD=1;var e=typeof Symbol=="function"&&Symbol.for,r=e?Symbol.for("react.element"):60103,a=e?Symbol.for("react.portal"):60106,l=e?Symbol.for("react.fragment"):60107,m=e?Symbol.for("react.strict_mode"):60108,y=e?Symbol.for("react.profiler"):60114,T=e?Symbol.for("react.provider"):60109,i=e?Symbol.for("react.context"):60110,z=e?Symbol.for("react.async_mode"):60111,B=e?Symbol.for("react.concurrent_mode"):60111,F=e?Symbol.for("react.forward_ref"):60112,G=e?Symbol.for("react.suspense"):60113,Q=e?Symbol.for("react.suspense_list"):60120,te=e?Symbol.for("react.memo"):60115,ne=e?Symbol.for("react.lazy"):60116,oe=e?Symbol.for("react.block"):60121,ue=e?Symbol.for("react.fundamental"):60117,ye=e?Symbol.for("react.responder"):60118,we=e?Symbol.for("react.scope"):60119;function ve(Ee){if(typeof Ee=="object"&&Ee!==null){var Be=Ee.$$typeof;switch(Be){case r:switch(Ee=Ee.type,Ee){case z:case B:case l:case y:case m:case G:return Ee;default:switch(Ee=Ee&&Ee.$$typeof,Ee){case i:case F:case ne:case te:case T:return Ee;default:return Be}}case a:return Be}}}function Ce(Ee){return ve(Ee)===B}return _a.AsyncMode=z,_a.ConcurrentMode=B,_a.ContextConsumer=i,_a.ContextProvider=T,_a.Element=r,_a.ForwardRef=F,_a.Fragment=l,_a.Lazy=ne,_a.Memo=te,_a.Portal=a,_a.Profiler=y,_a.StrictMode=m,_a.Suspense=G,_a.isAsyncMode=function(Ee){return Ce(Ee)||ve(Ee)===z},_a.isConcurrentMode=Ce,_a.isContextConsumer=function(Ee){return ve(Ee)===i},_a.isContextProvider=function(Ee){return ve(Ee)===T},_a.isElement=function(Ee){return typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===r},_a.isForwardRef=function(Ee){return ve(Ee)===F},_a.isFragment=function(Ee){return ve(Ee)===l},_a.isLazy=function(Ee){return ve(Ee)===ne},_a.isMemo=function(Ee){return ve(Ee)===te},_a.isPortal=function(Ee){return ve(Ee)===a},_a.isProfiler=function(Ee){return ve(Ee)===y},_a.isStrictMode=function(Ee){return ve(Ee)===m},_a.isSuspense=function(Ee){return ve(Ee)===G},_a.isValidElementType=function(Ee){return typeof Ee=="string"||typeof Ee=="function"||Ee===l||Ee===B||Ee===y||Ee===m||Ee===G||Ee===Q||typeof Ee=="object"&&Ee!==null&&(Ee.$$typeof===ne||Ee.$$typeof===te||Ee.$$typeof===T||Ee.$$typeof===i||Ee.$$typeof===F||Ee.$$typeof===ue||Ee.$$typeof===ye||Ee.$$typeof===we||Ee.$$typeof===oe)},_a.typeOf=ve,_a}var cD;function MV(){return cD||(cD=1,VS.exports=CV()),VS.exports}var $S,uD;function IV(){if(uD)return $S;uD=1;var e=MV(),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},m={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},y={};y[e.ForwardRef]=l,y[e.Memo]=m;function T(ne){return e.isMemo(ne)?m:y[ne.$$typeof]||r}var i=Object.defineProperty,z=Object.getOwnPropertyNames,B=Object.getOwnPropertySymbols,F=Object.getOwnPropertyDescriptor,G=Object.getPrototypeOf,Q=Object.prototype;function te(ne,oe,ue){if(typeof oe!="string"){if(Q){var ye=G(oe);ye&&ye!==Q&&te(ne,ye,ue)}var we=z(oe);B&&(we=we.concat(B(oe)));for(var ve=T(ne),Ce=T(oe),Ee=0;Ee<we.length;++Ee){var Be=we[Ee];if(!a[Be]&&!(ue&&ue[Be])&&!(Ce&&Ce[Be])&&!(ve&&ve[Be])){var Ke=F(oe,Be);try{i(ne,Be,Ke)}catch{}}}}return ne}return $S=te,$S}IV();var PV=!0;function VL(e,r,a){var l="";return a.split(" ").forEach(function(m){e[m]!==void 0?r.push(e[m]+";"):m&&(l+=m+" ")}),l}var h3=function(r,a,l){var m=r.key+"-"+a.name;(l===!1||PV===!1)&&r.registered[m]===void 0&&(r.registered[m]=a.styles)},f3=function(r,a,l){h3(r,a,l);var m=r.key+"-"+a.name;if(r.inserted[a.name]===void 0){var y=a;do r.insert(a===y?"."+m:"",y,r.sheet,!0),y=y.next;while(y!==void 0)}};function RV(e){for(var r=0,a,l=0,m=e.length;m>=4;++l,m-=4)a=e.charCodeAt(l)&255|(e.charCodeAt(++l)&255)<<8|(e.charCodeAt(++l)&255)<<16|(e.charCodeAt(++l)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,r=(a&65535)*1540483477+((a>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(m){case 3:r^=(e.charCodeAt(l+2)&255)<<16;case 2:r^=(e.charCodeAt(l+1)&255)<<8;case 1:r^=e.charCodeAt(l)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}var DV={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},OV=/[A-Z]|^ms/g,kV=/_EMO_([^_]+?)_([^]*?)_EMO_/g,$L=function(r){return r.charCodeAt(1)===45},hD=function(r){return r!=null&&typeof r!="boolean"},GS=jL(function(e){return $L(e)?e:e.replace(OV,"-$&").toLowerCase()}),fD=function(r,a){switch(r){case"animation":case"animationName":if(typeof a=="string")return a.replace(kV,function(l,m,y){return Fp={name:m,styles:y,next:Fp},m})}return DV[r]!==1&&!$L(r)&&typeof a=="number"&&a!==0?a+"px":a};function $v(e,r,a){if(a==null)return"";var l=a;if(l.__emotion_styles!==void 0)return l;switch(typeof a){case"boolean":return"";case"object":{var m=a;if(m.anim===1)return Fp={name:m.name,styles:m.styles,next:Fp},m.name;var y=a;if(y.styles!==void 0){var T=y.next;if(T!==void 0)for(;T!==void 0;)Fp={name:T.name,styles:T.styles,next:Fp},T=T.next;var i=y.styles+";";return i}return zV(e,r,a)}case"function":{if(e!==void 0){var z=Fp,B=a(e);return Fp=z,$v(e,r,B)}break}}var F=a;if(r==null)return F;var G=r[F];return G!==void 0?G:F}function zV(e,r,a){var l="";if(Array.isArray(a))for(var m=0;m<a.length;m++)l+=$v(e,r,a[m])+";";else for(var y in a){var T=a[y];if(typeof T!="object"){var i=T;r!=null&&r[i]!==void 0?l+=y+"{"+r[i]+"}":hD(i)&&(l+=GS(y)+":"+fD(y,i)+";")}else if(Array.isArray(T)&&typeof T[0]=="string"&&(r==null||r[T[0]]===void 0))for(var z=0;z<T.length;z++)hD(T[z])&&(l+=GS(y)+":"+fD(y,T[z])+";");else{var B=$v(e,r,T);switch(y){case"animation":case"animationName":{l+=GS(y)+":"+B+";";break}default:l+=y+"{"+B+"}"}}}return l}var dD=/label:\s*([^\s;{]+)\s*(;|$)/g,Fp;function ax(e,r,a){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var l=!0,m="";Fp=void 0;var y=e[0];if(y==null||y.raw===void 0)l=!1,m+=$v(a,r,y);else{var T=y;m+=T[0]}for(var i=1;i<e.length;i++)if(m+=$v(a,r,e[i]),l){var z=y;m+=z[i]}dD.lastIndex=0;for(var B="",F;(F=dD.exec(m))!==null;)B+="-"+F[1];var G=RV(m)+B;return{name:G,styles:m,next:Fp}}var LV=function(r){return r()},GL=zb.useInsertionEffect?zb.useInsertionEffect:!1,HL=GL||LV,pD=GL||ae.useLayoutEffect,qL=ae.createContext(typeof HTMLElement<"u"?EV({key:"css"}):null);qL.Provider;var d3=function(r){return ae.forwardRef(function(a,l){var m=ae.useContext(qL);return r(a,m,l)})},sx=ae.createContext({}),p3={}.hasOwnProperty,UE="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",BV=function(r,a){var l={};for(var m in a)p3.call(a,m)&&(l[m]=a[m]);return l[UE]=r,l},FV=function(r){var a=r.cache,l=r.serialized,m=r.isStringTag;return h3(a,l,m),HL(function(){return f3(a,l,m)}),null},NV=d3(function(e,r,a){var l=e.css;typeof l=="string"&&r.registered[l]!==void 0&&(l=r.registered[l]);var m=e[UE],y=[l],T="";typeof e.className=="string"?T=VL(r.registered,y,e.className):e.className!=null&&(T=e.className+" ");var i=ax(y,void 0,ae.useContext(sx));T+=r.key+"-"+i.name;var z={};for(var B in e)p3.call(e,B)&&B!=="css"&&B!==UE&&(z[B]=e[B]);return z.className=T,a&&(z.ref=a),ae.createElement(ae.Fragment,null,ae.createElement(FV,{cache:r,serialized:i,isStringTag:typeof m=="string"}),ae.createElement(m,z))}),jV=NV,mD=function(r,a){var l=arguments;if(a==null||!p3.call(a,"css"))return ae.createElement.apply(void 0,l);var m=l.length,y=new Array(m);y[0]=jV,y[1]=BV(r,a);for(var T=2;T<m;T++)y[T]=l[T];return ae.createElement.apply(null,y)};(function(e){var r;r||(r=e.JSX||(e.JSX={}))})(mD||(mD={}));var UV=d3(function(e,r){var a=e.styles,l=ax([a],void 0,ae.useContext(sx)),m=ae.useRef();return pD(function(){var y=r.key+"-global",T=new r.sheet.constructor({key:y,nonce:r.sheet.nonce,container:r.sheet.container,speedy:r.sheet.isSpeedy}),i=!1,z=document.querySelector('style[data-emotion="'+y+" "+l.name+'"]');return r.sheet.tags.length&&(T.before=r.sheet.tags[0]),z!==null&&(i=!0,z.setAttribute("data-emotion",y),T.hydrate([z])),m.current=[T,i],function(){T.flush()}},[r]),pD(function(){var y=m.current,T=y[0],i=y[1];if(i){y[1]=!1;return}if(l.next!==void 0&&f3(r,l.next,!0),T.tags.length){var z=T.tags[T.tags.length-1].nextElementSibling;T.before=z,T.flush()}r.insert("",l,T,!1)},[r,l.name]),null});function K_(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return ax(r)}function l0(){var e=K_.apply(void 0,arguments),r="animation-"+e.name;return{name:r,styles:"@keyframes "+r+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var VV=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|popover|popoverTarget|popoverTargetAction|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,$V=jL(function(e){return VV.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),GV=$V,HV=function(r){return r!=="theme"},AD=function(r){return typeof r=="string"&&r.charCodeAt(0)>96?GV:HV},gD=function(r,a,l){var m;if(a){var y=a.shouldForwardProp;m=r.__emotion_forwardProp&&y?function(T){return r.__emotion_forwardProp(T)&&y(T)}:y}return typeof m!="function"&&l&&(m=r.__emotion_forwardProp),m},qV=function(r){var a=r.cache,l=r.serialized,m=r.isStringTag;return h3(a,l,m),HL(function(){return f3(a,l,m)}),null},WV=function e(r,a){var l=r.__emotion_real===r,m=l&&r.__emotion_base||r,y,T;a!==void 0&&(y=a.label,T=a.target);var i=gD(r,a,l),z=i||AD(m),B=!z("as");return function(){var F=arguments,G=l&&r.__emotion_styles!==void 0?r.__emotion_styles.slice(0):[];if(y!==void 0&&G.push("label:"+y+";"),F[0]==null||F[0].raw===void 0)G.push.apply(G,F);else{var Q=F[0];G.push(Q[0]);for(var te=F.length,ne=1;ne<te;ne++)G.push(F[ne],Q[ne])}var oe=d3(function(ue,ye,we){var ve=B&&ue.as||m,Ce="",Ee=[],Be=ue;if(ue.theme==null){Be={};for(var Ke in ue)Be[Ke]=ue[Ke];Be.theme=ae.useContext(sx)}typeof ue.className=="string"?Ce=VL(ye.registered,Ee,ue.className):ue.className!=null&&(Ce=ue.className+" ");var st=ax(G.concat(Ee),ye.registered,Be);Ce+=ye.key+"-"+st.name,T!==void 0&&(Ce+=" "+T);var dt=B&&i===void 0?AD(ve):z,bt={};for(var ht in ue)B&&ht==="as"||dt(ht)&&(bt[ht]=ue[ht]);return bt.className=Ce,we&&(bt.ref=we),ae.createElement(ae.Fragment,null,ae.createElement(qV,{cache:ye,serialized:st,isStringTag:typeof ve=="string"}),ae.createElement(ve,bt))});return oe.displayName=y!==void 0?y:"Styled("+(typeof m=="string"?m:m.displayName||m.name||"Component")+")",oe.defaultProps=r.defaultProps,oe.__emotion_real=oe,oe.__emotion_base=m,oe.__emotion_styles=G,oe.__emotion_forwardProp=i,Object.defineProperty(oe,"toString",{value:function(){return"."+T}}),oe.withComponent=function(ue,ye){var we=e(ue,kb({},a,ye,{shouldForwardProp:gD(oe,ye,!0)}));return we.apply(void 0,G)},oe}},ZV=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],VE=WV.bind(null);ZV.forEach(function(e){VE[e]=VE(e)});function XV(e){return e==null||Object.keys(e).length===0}function WL(e){const{styles:r,defaultTheme:a={}}=e,l=typeof r=="function"?m=>r(XV(m)?a:m):r;return be.jsx(UV,{styles:l})}function ZL(e,r){return VE(e,r)}function YV(e,r){Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=r(e.__emotion_styles))}const _D=[];function r0(e){return _D[0]=e,ax(_D)}var HS={exports:{}},Da={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yD;function QV(){if(yD)return Da;yD=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),T=Symbol.for("react.context"),i=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),Q=Symbol.for("react.view_transition"),te=Symbol.for("react.client.reference");function ne(oe){if(typeof oe=="object"&&oe!==null){var ue=oe.$$typeof;switch(ue){case e:switch(oe=oe.type,oe){case a:case m:case l:case z:case B:case Q:return oe;default:switch(oe=oe&&oe.$$typeof,oe){case T:case i:case G:case F:return oe;case y:return oe;default:return ue}}case r:return ue}}}return Da.ContextConsumer=y,Da.ContextProvider=T,Da.Element=e,Da.ForwardRef=i,Da.Fragment=a,Da.Lazy=G,Da.Memo=F,Da.Portal=r,Da.Profiler=m,Da.StrictMode=l,Da.Suspense=z,Da.SuspenseList=B,Da.isContextConsumer=function(oe){return ne(oe)===y},Da.isContextProvider=function(oe){return ne(oe)===T},Da.isElement=function(oe){return typeof oe=="object"&&oe!==null&&oe.$$typeof===e},Da.isForwardRef=function(oe){return ne(oe)===i},Da.isFragment=function(oe){return ne(oe)===a},Da.isLazy=function(oe){return ne(oe)===G},Da.isMemo=function(oe){return ne(oe)===F},Da.isPortal=function(oe){return ne(oe)===r},Da.isProfiler=function(oe){return ne(oe)===m},Da.isStrictMode=function(oe){return ne(oe)===l},Da.isSuspense=function(oe){return ne(oe)===z},Da.isSuspenseList=function(oe){return ne(oe)===B},Da.isValidElementType=function(oe){return typeof oe=="string"||typeof oe=="function"||oe===a||oe===m||oe===l||oe===z||oe===B||typeof oe=="object"&&oe!==null&&(oe.$$typeof===G||oe.$$typeof===F||oe.$$typeof===T||oe.$$typeof===y||oe.$$typeof===i||oe.$$typeof===te||oe.getModuleId!==void 0)},Da.typeOf=ne,Da}var vD;function KV(){return vD||(vD=1,HS.exports=QV()),HS.exports}var XL=KV();function jp(e){if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function YL(e){if(ae.isValidElement(e)||XL.isValidElementType(e)||!jp(e))return e;const r={};return Object.keys(e).forEach(a=>{r[a]=YL(e[a])}),r}function Kc(e,r,a={clone:!0}){const l=a.clone?{...e}:e;return jp(e)&&jp(r)&&Object.keys(r).forEach(m=>{ae.isValidElement(r[m])||XL.isValidElementType(r[m])?l[m]=r[m]:jp(r[m])&&Object.prototype.hasOwnProperty.call(e,m)&&jp(e[m])?l[m]=Kc(e[m],r[m],a):a.clone?l[m]=jp(r[m])?YL(r[m]):r[m]:l[m]=r[m]}),l}const JV=e=>{const r=Object.keys(e).map(a=>({key:a,val:e[a]}))||[];return r.sort((a,l)=>a.val-l.val),r.reduce((a,l)=>({...a,[l.key]:l.val}),{})};function e9(e){const{values:r={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:l=5,...m}=e,y=JV(r),T=Object.keys(y);function i(Q){return`@media (min-width:${typeof r[Q]=="number"?r[Q]:Q}${a})`}function z(Q){return`@media (max-width:${(typeof r[Q]=="number"?r[Q]:Q)-l/100}${a})`}function B(Q,te){const ne=T.indexOf(te);return`@media (min-width:${typeof r[Q]=="number"?r[Q]:Q}${a}) and (max-width:${(ne!==-1&&typeof r[T[ne]]=="number"?r[T[ne]]:te)-l/100}${a})`}function F(Q){return T.indexOf(Q)+1<T.length?B(Q,T[T.indexOf(Q)+1]):i(Q)}function G(Q){const te=T.indexOf(Q);return te===0?i(T[1]):te===T.length-1?z(T[te]):B(Q,T[T.indexOf(Q)+1]).replace("@media","@media not all and")}return{keys:T,values:y,up:i,down:z,between:B,only:F,not:G,unit:a,...m}}function xD(e,r){if(!e.containerQueries)return r;const a=Object.keys(r).filter(l=>l.startsWith("@container")).sort((l,m)=>{const y=/min-width:\s*([0-9.]+)/;return+(l.match(y)?.[1]||0)-+(m.match(y)?.[1]||0)});return a.length?a.reduce((l,m)=>{const y=r[m];return delete l[m],l[m]=y,l},{...r}):r}function t9(e,r){return r==="@"||r.startsWith("@")&&(e.some(a=>r.startsWith(`@${a}`))||!!r.match(/^@\d/))}function r9(e,r){const a=r.match(/^@([^/]+)?\/?(.+)?$/);if(!a)return null;const[,l,m]=a,y=Number.isNaN(+l)?l||0:+l;return e.containerQueries(m).up(y)}function n9(e){const r=(y,T)=>y.replace("@media",T?`@container ${T}`:"@container");function a(y,T){y.up=(...i)=>r(e.breakpoints.up(...i),T),y.down=(...i)=>r(e.breakpoints.down(...i),T),y.between=(...i)=>r(e.breakpoints.between(...i),T),y.only=(...i)=>r(e.breakpoints.only(...i),T),y.not=(...i)=>{const z=r(e.breakpoints.not(...i),T);return z.includes("not all and")?z.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):z}}const l={},m=y=>(a(l,y),l);return a(m),{...e,containerQueries:m}}const i9={borderRadius:4};function kv(e,r){return r?Kc(e,r,{clone:!1}):e}const Pw={xs:0,sm:600,md:900,lg:1200,xl:1536},bD={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Pw[e]}px)`},o9={containerQueries:e=>({up:r=>{let a=typeof r=="number"?r:Pw[r]||r;return typeof a=="number"&&(a=`${a}px`),e?`@container ${e} (min-width:${a})`:`@container (min-width:${a})`}})};function Hm(e,r,a){const l=e.theme||{};if(Array.isArray(r)){const y=l.breakpoints||bD;return r.reduce((T,i,z)=>(T[y.up(y.keys[z])]=a(r[z]),T),{})}if(typeof r=="object"){const y=l.breakpoints||bD;return Object.keys(r).reduce((T,i)=>{if(t9(y.keys,i)){const z=r9(l.containerQueries?l:o9,i);z&&(T[z]=a(r[i],i))}else if(Object.keys(y.values||Pw).includes(i)){const z=y.up(i);T[z]=a(r[i],i)}else{const z=i;T[z]=r[z]}return T},{})}return a(r)}function a9(e={}){return e.keys?.reduce((a,l)=>{const m=e.up(l);return a[m]={},a},{})||{}}function wD(e,r){return e.reduce((a,l)=>{const m=a[l];return(!m||Object.keys(m).length===0)&&delete a[l],a},r)}function sn(e){if(typeof e!="string")throw new Error(Gm(7));return e.charAt(0).toUpperCase()+e.slice(1)}function Rw(e,r,a=!0){if(!r||typeof r!="string")return null;if(e&&e.vars&&a){const l=`vars.${r}`.split(".").reduce((m,y)=>m&&m[y]?m[y]:null,e);if(l!=null)return l}return r.split(".").reduce((l,m)=>l&&l[m]!=null?l[m]:null,e)}function Bb(e,r,a,l=a){let m;return typeof e=="function"?m=e(a):Array.isArray(e)?m=e[a]||l:m=Rw(e,a)||l,r&&(m=r(m,l,e)),m}function il(e){const{prop:r,cssProperty:a=e.prop,themeKey:l,transform:m}=e,y=T=>{if(T[r]==null)return null;const i=T[r],z=T.theme,B=Rw(z,l)||{};return Hm(T,i,G=>{let Q=Bb(B,m,G);return G===Q&&typeof G=="string"&&(Q=Bb(B,m,`${r}${G==="default"?"":sn(G)}`,G)),a===!1?Q:{[a]:Q}})};return y.propTypes={},y.filterProps=[r],y}function s9(e){const r={};return a=>(r[a]===void 0&&(r[a]=e(a)),r[a])}const l9={m:"margin",p:"padding"},c9={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},SD={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},u9=s9(e=>{if(e.length>2)if(SD[e])e=SD[e];else return[e];const[r,a]=e.split(""),l=l9[r],m=c9[a]||"";return Array.isArray(m)?m.map(y=>l+y):[l+m]}),m3=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],A3=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...m3,...A3];function lx(e,r,a,l){const m=Rw(e,r,!0)??a;return typeof m=="number"||typeof m=="string"?y=>typeof y=="string"?y:typeof m=="string"?m.startsWith("var(")&&y===0?0:m.startsWith("var(")&&y===1?m:`calc(${y} * ${m})`:m*y:Array.isArray(m)?y=>{if(typeof y=="string")return y;const T=Math.abs(y),i=m[T];return y>=0?i:typeof i=="number"?-i:typeof i=="string"&&i.startsWith("var(")?`calc(-1 * ${i})`:`-${i}`}:typeof m=="function"?m:()=>{}}function g3(e){return lx(e,"spacing",8)}function cx(e,r){return typeof r=="string"||r==null?r:e(r)}function h9(e,r){return a=>e.reduce((l,m)=>(l[m]=cx(r,a),l),{})}function f9(e,r,a,l){if(!r.includes(a))return null;const m=u9(a),y=h9(m,l),T=e[a];return Hm(e,T,y)}function QL(e,r){const a=g3(e.theme);return Object.keys(e).map(l=>f9(e,r,l,a)).reduce(kv,{})}function js(e){return QL(e,m3)}js.propTypes={};js.filterProps=m3;function Us(e){return QL(e,A3)}Us.propTypes={};Us.filterProps=A3;function KL(e=8,r=g3({spacing:e})){if(e.mui)return e;const a=(...l)=>(l.length===0?[1]:l).map(y=>{const T=r(y);return typeof T=="number"?`${T}px`:T}).join(" ");return a.mui=!0,a}function Dw(...e){const r=e.reduce((l,m)=>(m.filterProps.forEach(y=>{l[y]=m}),l),{}),a=l=>Object.keys(l).reduce((m,y)=>r[y]?kv(m,r[y](l)):m,{});return a.propTypes={},a.filterProps=e.reduce((l,m)=>l.concat(m.filterProps),[]),a}function nd(e){return typeof e!="number"?e:`${e}px solid`}function cd(e,r){return il({prop:e,themeKey:"borders",transform:r})}const d9=cd("border",nd),p9=cd("borderTop",nd),m9=cd("borderRight",nd),A9=cd("borderBottom",nd),g9=cd("borderLeft",nd),_9=cd("borderColor"),y9=cd("borderTopColor"),v9=cd("borderRightColor"),x9=cd("borderBottomColor"),b9=cd("borderLeftColor"),w9=cd("outline",nd),S9=cd("outlineColor"),Ow=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const r=lx(e.theme,"shape.borderRadius",4),a=l=>({borderRadius:cx(r,l)});return Hm(e,e.borderRadius,a)}return null};Ow.propTypes={};Ow.filterProps=["borderRadius"];Dw(d9,p9,m9,A9,g9,_9,y9,v9,x9,b9,Ow,w9,S9);const kw=e=>{if(e.gap!==void 0&&e.gap!==null){const r=lx(e.theme,"spacing",8),a=l=>({gap:cx(r,l)});return Hm(e,e.gap,a)}return null};kw.propTypes={};kw.filterProps=["gap"];const zw=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const r=lx(e.theme,"spacing",8),a=l=>({columnGap:cx(r,l)});return Hm(e,e.columnGap,a)}return null};zw.propTypes={};zw.filterProps=["columnGap"];const Lw=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const r=lx(e.theme,"spacing",8),a=l=>({rowGap:cx(r,l)});return Hm(e,e.rowGap,a)}return null};Lw.propTypes={};Lw.filterProps=["rowGap"];const T9=il({prop:"gridColumn"}),E9=il({prop:"gridRow"}),C9=il({prop:"gridAutoFlow"}),M9=il({prop:"gridAutoColumns"}),I9=il({prop:"gridAutoRows"}),P9=il({prop:"gridTemplateColumns"}),R9=il({prop:"gridTemplateRows"}),D9=il({prop:"gridTemplateAreas"}),O9=il({prop:"gridArea"});Dw(kw,zw,Lw,T9,E9,C9,M9,I9,P9,R9,D9,O9);function O_(e,r){return r==="grey"?r:e}const k9=il({prop:"color",themeKey:"palette",transform:O_}),z9=il({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:O_}),L9=il({prop:"backgroundColor",themeKey:"palette",transform:O_});Dw(k9,z9,L9);function xf(e){return e<=1&&e!==0?`${e*100}%`:e}const B9=il({prop:"width",transform:xf}),_3=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const r=a=>{const l=e.theme?.breakpoints?.values?.[a]||Pw[a];return l?e.theme?.breakpoints?.unit!=="px"?{maxWidth:`${l}${e.theme.breakpoints.unit}`}:{maxWidth:l}:{maxWidth:xf(a)}};return Hm(e,e.maxWidth,r)}return null};_3.filterProps=["maxWidth"];const F9=il({prop:"minWidth",transform:xf}),N9=il({prop:"height",transform:xf}),j9=il({prop:"maxHeight",transform:xf}),U9=il({prop:"minHeight",transform:xf});il({prop:"size",cssProperty:"width",transform:xf});il({prop:"size",cssProperty:"height",transform:xf});const V9=il({prop:"boxSizing"});Dw(B9,_3,F9,N9,j9,U9,V9);const ux={border:{themeKey:"borders",transform:nd},borderTop:{themeKey:"borders",transform:nd},borderRight:{themeKey:"borders",transform:nd},borderBottom:{themeKey:"borders",transform:nd},borderLeft:{themeKey:"borders",transform:nd},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:nd},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Ow},color:{themeKey:"palette",transform:O_},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:O_},backgroundColor:{themeKey:"palette",transform:O_},p:{style:Us},pt:{style:Us},pr:{style:Us},pb:{style:Us},pl:{style:Us},px:{style:Us},py:{style:Us},padding:{style:Us},paddingTop:{style:Us},paddingRight:{style:Us},paddingBottom:{style:Us},paddingLeft:{style:Us},paddingX:{style:Us},paddingY:{style:Us},paddingInline:{style:Us},paddingInlineStart:{style:Us},paddingInlineEnd:{style:Us},paddingBlock:{style:Us},paddingBlockStart:{style:Us},paddingBlockEnd:{style:Us},m:{style:js},mt:{style:js},mr:{style:js},mb:{style:js},ml:{style:js},mx:{style:js},my:{style:js},margin:{style:js},marginTop:{style:js},marginRight:{style:js},marginBottom:{style:js},marginLeft:{style:js},marginX:{style:js},marginY:{style:js},marginInline:{style:js},marginInlineStart:{style:js},marginInlineEnd:{style:js},marginBlock:{style:js},marginBlockStart:{style:js},marginBlockEnd:{style:js},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:kw},rowGap:{style:Lw},columnGap:{style:zw},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:xf},maxWidth:{style:_3},minWidth:{transform:xf},height:{transform:xf},maxHeight:{transform:xf},minHeight:{transform:xf},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function $9(...e){const r=e.reduce((l,m)=>l.concat(Object.keys(m)),[]),a=new Set(r);return e.every(l=>a.size===Object.keys(l).length)}function G9(e,r){return typeof e=="function"?e(r):e}function H9(){function e(a,l,m,y){const T={[a]:l,theme:m},i=y[a];if(!i)return{[a]:l};const{cssProperty:z=a,themeKey:B,transform:F,style:G}=i;if(l==null)return null;if(B==="typography"&&l==="inherit")return{[a]:l};const Q=Rw(m,B)||{};return G?G(T):Hm(T,l,ne=>{let oe=Bb(Q,F,ne);return ne===oe&&typeof ne=="string"&&(oe=Bb(Q,F,`${a}${ne==="default"?"":sn(ne)}`,ne)),z===!1?oe:{[z]:oe}})}function r(a){const{sx:l,theme:m={},nested:y}=a||{};if(!l)return null;const T=m.unstable_sxConfig??ux;function i(z){let B=z;if(typeof z=="function")B=z(m);else if(typeof z!="object")return z;if(!B)return null;const F=a9(m.breakpoints),G=Object.keys(F);let Q=F;return Object.keys(B).forEach(te=>{const ne=G9(B[te],m);if(ne!=null)if(typeof ne=="object")if(T[te])Q=kv(Q,e(te,ne,m,T));else{const oe=Hm({theme:m},ne,ue=>({[te]:ue}));$9(oe,ne)?Q[te]=r({sx:ne,theme:m,nested:!0}):Q=kv(Q,oe)}else Q=kv(Q,e(te,ne,m,T))}),!y&&m.modularCssLayers?{"@layer sx":xD(m,wD(G,Q))}:xD(m,wD(G,Q))}return Array.isArray(l)?l.map(i):i(l)}return r}const i0=H9();i0.filterProps=["sx"];function q9(e,r){const a=this;if(a.vars){if(!a.colorSchemes?.[e]||typeof a.getColorSchemeSelector!="function")return{};let l=a.getColorSchemeSelector(e);return l==="&"?r:((l.includes("data-")||l.includes("."))&&(l=`*:where(${l.replace(/\s*&$/,"")}) &`),{[l]:r})}return a.palette.mode===e?r:{}}function hx(e={},...r){const{breakpoints:a={},palette:l={},spacing:m,shape:y={},...T}=e,i=e9(a),z=KL(m);let B=Kc({breakpoints:i,direction:"ltr",components:{},palette:{mode:"light",...l},spacing:z,shape:{...i9,...y}},T);return B=n9(B),B.applyStyles=q9,B=r.reduce((F,G)=>Kc(F,G),B),B.unstable_sxConfig={...ux,...T?.unstable_sxConfig},B.unstable_sx=function(G){return i0({sx:G,theme:this})},B}function W9(e){return Object.keys(e).length===0}function y3(e=null){const r=ae.useContext(sx);return!r||W9(r)?e:r}const Z9=hx();function fx(e=Z9){return y3(e)}function qS(e){const r=r0(e);return e!==r&&r.styles?(r.styles.match(/^@layer\s+[^{]*$/)||(r.styles=`@layer global{${r.styles}}`),r):e}function JL({styles:e,themeId:r,defaultTheme:a={}}){const l=fx(a),m=r&&l[r]||l;let y=typeof e=="function"?e(m):e;return m.modularCssLayers&&(Array.isArray(y)?y=y.map(T=>qS(typeof T=="function"?T(m):T)):y=qS(y)),be.jsx(WL,{styles:y})}const X9=e=>{const r={systemProps:{},otherProps:{}},a=e?.theme?.unstable_sxConfig??ux;return Object.keys(e).forEach(l=>{a[l]?r.systemProps[l]=e[l]:r.otherProps[l]=e[l]}),r};function v3(e){const{sx:r,...a}=e,{systemProps:l,otherProps:m}=X9(a);let y;return Array.isArray(r)?y=[l,...r]:typeof r=="function"?y=(...T)=>{const i=r(...T);return jp(i)?{...l,...i}:l}:y={...l,...r},{...m,sx:y}}const TD=e=>e,Y9=()=>{let e=TD;return{configure(r){e=r},generate(r){return e(r)},reset(){e=TD}}},eB=Y9();function tB(e){var r,a,l="";if(typeof e=="string"||typeof e=="number")l+=e;else if(typeof e=="object")if(Array.isArray(e)){var m=e.length;for(r=0;r<m;r++)e[r]&&(a=tB(e[r]))&&(l&&(l+=" "),l+=a)}else for(a in e)e[a]&&(l&&(l+=" "),l+=a);return l}function on(){for(var e,r,a=0,l="",m=arguments.length;a<m;a++)(e=arguments[a])&&(r=tB(e))&&(l&&(l+=" "),l+=r);return l}function Q9(e={}){const{themeId:r,defaultTheme:a,defaultClassName:l="MuiBox-root",generateClassName:m}=e,y=ZL("div",{shouldForwardProp:i=>i!=="theme"&&i!=="sx"&&i!=="as"})(i0);return ae.forwardRef(function(z,B){const F=fx(a),{className:G,component:Q="div",...te}=v3(z);return be.jsx(y,{as:Q,ref:B,className:on(G,m?m(l):l),theme:r&&F[r]||F,...te})})}const K9={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Bi(e,r,a="Mui"){const l=K9[r];return l?`${a}-${l}`:`${eB.generate(e)}-${r}`}function Fi(e,r,a="Mui"){const l={};return r.forEach(m=>{l[m]=Bi(e,m,a)}),l}function rB(e){const{variants:r,...a}=e,l={variants:r,style:r0(a),isProcessed:!0};return l.style===a||r&&r.forEach(m=>{typeof m.style!="function"&&(m.style=r0(m.style))}),l}const J9=hx();function WS(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}function ig(e,r){return r&&e&&typeof e=="object"&&e.styles&&!e.styles.startsWith("@layer")&&(e.styles=`@layer ${r}{${String(e.styles)}}`),e}function e$(e){return e?(r,a)=>a[e]:null}function t$(e,r,a){e.theme=n$(e.theme)?a:e.theme[r]||e.theme}function Sb(e,r,a){const l=typeof r=="function"?r(e):r;if(Array.isArray(l))return l.flatMap(m=>Sb(e,m,a));if(Array.isArray(l?.variants)){let m;if(l.isProcessed)m=a?ig(l.style,a):l.style;else{const{variants:y,...T}=l;m=a?ig(r0(T),a):T}return nB(e,l.variants,[m],a)}return l?.isProcessed?a?ig(r0(l.style),a):l.style:a?ig(r0(l),a):l}function nB(e,r,a=[],l=void 0){let m;e:for(let y=0;y<r.length;y+=1){const T=r[y];if(typeof T.props=="function"){if(m??={...e,...e.ownerState,ownerState:e.ownerState},!T.props(m))continue}else for(const i in T.props)if(e[i]!==T.props[i]&&e.ownerState?.[i]!==T.props[i])continue e;typeof T.style=="function"?(m??={...e,...e.ownerState,ownerState:e.ownerState},a.push(l?ig(r0(T.style(m)),l):T.style(m))):a.push(l?ig(r0(T.style),l):T.style)}return a}function iB(e={}){const{themeId:r,defaultTheme:a=J9,rootShouldForwardProp:l=WS,slotShouldForwardProp:m=WS}=e;function y(i){t$(i,r,a)}return(i,z={})=>{YV(i,Be=>Be.filter(Ke=>Ke!==i0));const{name:B,slot:F,skipVariantsResolver:G,skipSx:Q,overridesResolver:te=e$(o$(F)),...ne}=z,oe=B&&B.startsWith("Mui")||F?"components":"custom",ue=G!==void 0?G:F&&F!=="Root"&&F!=="root"||!1,ye=Q||!1;let we=WS;F==="Root"||F==="root"?we=l:F?we=m:i$(i)&&(we=void 0);const ve=ZL(i,{shouldForwardProp:we,label:r$(),...ne}),Ce=Be=>{if(Be.__emotion_real===Be)return Be;if(typeof Be=="function")return function(st){return Sb(st,Be,st.theme.modularCssLayers?oe:void 0)};if(jp(Be)){const Ke=rB(Be);return function(dt){return Ke.variants?Sb(dt,Ke,dt.theme.modularCssLayers?oe:void 0):dt.theme.modularCssLayers?ig(Ke.style,oe):Ke.style}}return Be},Ee=(...Be)=>{const Ke=[],st=Be.map(Ce),dt=[];if(Ke.push(y),B&&te&&dt.push(function(Pt){const Et=Pt.theme.components?.[B]?.styleOverrides;if(!Et)return null;const et={};for(const Zt in Et)et[Zt]=Sb(Pt,Et[Zt],Pt.theme.modularCssLayers?"theme":void 0);return te(Pt,et)}),B&&!ue&&dt.push(function(Pt){const Et=Pt.theme?.components?.[B]?.variants;return Et?nB(Pt,Et,[],Pt.theme.modularCssLayers?"theme":void 0):null}),ye||dt.push(i0),Array.isArray(st[0])){const Re=st.shift(),Pt=new Array(Ke.length).fill(""),wt=new Array(dt.length).fill("");let Et;Et=[...Pt,...Re,...wt],Et.raw=[...Pt,...Re.raw,...wt],Ke.unshift(Et)}const bt=[...Ke,...st,...dt],ht=ve(...bt);return i.muiName&&(ht.muiName=i.muiName),ht};return ve.withConfig&&(Ee.withConfig=ve.withConfig),Ee}}function r$(e,r){return void 0}function n$(e){for(const r in e)return!1;return!0}function i$(e){return typeof e=="string"&&e.charCodeAt(0)>96}function o$(e){return e&&e.charAt(0).toLowerCase()+e.slice(1)}const oB=iB();function Gv(e,r,a=!1){const l={...r};for(const m in e)if(Object.prototype.hasOwnProperty.call(e,m)){const y=m;if(y==="components"||y==="slots")l[y]={...e[y],...l[y]};else if(y==="componentsProps"||y==="slotProps"){const T=e[y],i=r[y];if(!i)l[y]=T||{};else if(!T)l[y]=i;else{l[y]={...i};for(const z in T)if(Object.prototype.hasOwnProperty.call(T,z)){const B=z;l[y][B]=Gv(T[B],i[B],a)}}}else y==="className"&&a&&r.className?l.className=on(e?.className,r?.className):y==="style"&&a&&r.style?l.style={...e?.style,...r?.style}:l[y]===void 0&&(l[y]=e[y])}return l}function a$(e){const{theme:r,name:a,props:l}=e;return!r||!r.components||!r.components[a]||!r.components[a].defaultProps?l:Gv(r.components[a].defaultProps,l)}function aB({props:e,name:r,defaultTheme:a,themeId:l}){let m=fx(a);return l&&(m=m[l]||m),a$({theme:m,name:r,props:e})}const Hp=typeof window<"u"?ae.useLayoutEffect:ae.useEffect;function s$(e,r=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(r,Math.min(e,a))}function x3(e,r=0,a=1){return s$(e,r,a)}function l$(e){e=e.slice(1);const r=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let a=e.match(r);return a&&a[0].length===1&&(a=a.map(l=>l+l)),a?`rgb${a.length===4?"a":""}(${a.map((l,m)=>m<3?parseInt(l,16):Math.round(parseInt(l,16)/255*1e3)/1e3).join(", ")})`:""}function o0(e){if(e.type)return e;if(e.charAt(0)==="#")return o0(l$(e));const r=e.indexOf("("),a=e.substring(0,r);if(!["rgb","rgba","hsl","hsla","color"].includes(a))throw new Error(Gm(9,e));let l=e.substring(r+1,e.length-1),m;if(a==="color"){if(l=l.split(" "),m=l.shift(),l.length===4&&l[3].charAt(0)==="/"&&(l[3]=l[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(m))throw new Error(Gm(10,m))}else l=l.split(",");return l=l.map(y=>parseFloat(y)),{type:a,values:l,colorSpace:m}}const c$=e=>{const r=o0(e);return r.values.slice(0,3).map((a,l)=>r.type.includes("hsl")&&l!==0?`${a}%`:a).join(" ")},Cv=(e,r)=>{try{return c$(e)}catch{return e}};function Bw(e){const{type:r,colorSpace:a}=e;let{values:l}=e;return r.includes("rgb")?l=l.map((m,y)=>y<3?parseInt(m,10):m):r.includes("hsl")&&(l[1]=`${l[1]}%`,l[2]=`${l[2]}%`),r.includes("color")?l=`${a} ${l.join(" ")}`:l=`${l.join(", ")}`,`${r}(${l})`}function sB(e){e=o0(e);const{values:r}=e,a=r[0],l=r[1]/100,m=r[2]/100,y=l*Math.min(m,1-m),T=(B,F=(B+a/30)%12)=>m-y*Math.max(Math.min(F-3,9-F,1),-1);let i="rgb";const z=[Math.round(T(0)*255),Math.round(T(8)*255),Math.round(T(4)*255)];return e.type==="hsla"&&(i+="a",z.push(r[3])),Bw({type:i,values:z})}function $E(e){e=o0(e);let r=e.type==="hsl"||e.type==="hsla"?o0(sB(e)).values:e.values;return r=r.map(a=>(e.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*r[0]+.7152*r[1]+.0722*r[2]).toFixed(3))}function u$(e,r){const a=$E(e),l=$E(r);return(Math.max(a,l)+.05)/(Math.min(a,l)+.05)}function Fb(e,r){return e=o0(e),r=x3(r),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${r}`:e.values[3]=r,Bw(e)}function X0(e,r,a){try{return Fb(e,r)}catch{return e}}function Fw(e,r){if(e=o0(e),r=x3(r),e.type.includes("hsl"))e.values[2]*=1-r;else if(e.type.includes("rgb")||e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]*=1-r;return Bw(e)}function Sa(e,r,a){try{return Fw(e,r)}catch{return e}}function Nw(e,r){if(e=o0(e),r=x3(r),e.type.includes("hsl"))e.values[2]+=(100-e.values[2])*r;else if(e.type.includes("rgb"))for(let a=0;a<3;a+=1)e.values[a]+=(255-e.values[a])*r;else if(e.type.includes("color"))for(let a=0;a<3;a+=1)e.values[a]+=(1-e.values[a])*r;return Bw(e)}function Ta(e,r,a){try{return Nw(e,r)}catch{return e}}function h$(e,r=.15){return $E(e)>.5?Fw(e,r):Nw(e,r)}function Q1(e,r,a){try{return h$(e,r)}catch{return e}}const lB=ae.createContext(null);function b3(){return ae.useContext(lB)}const f$=typeof Symbol=="function"&&Symbol.for,d$=f$?Symbol.for("mui.nested"):"__THEME_NESTED__";function p$(e,r){return typeof r=="function"?r(e):{...e,...r}}function m$(e){const{children:r,theme:a}=e,l=b3(),m=ae.useMemo(()=>{const y=l===null?{...a}:p$(l,a);return y!=null&&(y[d$]=l!==null),y},[a,l]);return be.jsx(lB.Provider,{value:m,children:r})}const cB=ae.createContext();function A$({value:e,...r}){return be.jsx(cB.Provider,{value:e??!0,...r})}const jw=()=>ae.useContext(cB)??!1,uB=ae.createContext(void 0);function g$({value:e,children:r}){return be.jsx(uB.Provider,{value:e,children:r})}function _$(e){const{theme:r,name:a,props:l}=e;if(!r||!r.components||!r.components[a])return l;const m=r.components[a];return m.defaultProps?Gv(m.defaultProps,l,r.components.mergeClassNameAndStyle):!m.styleOverrides&&!m.variants?Gv(m,l,r.components.mergeClassNameAndStyle):l}function y$({props:e,name:r}){const a=ae.useContext(uB);return _$({props:e,name:r,theme:{components:a}})}let ED=0;function v$(e){const[r,a]=ae.useState(e),l=e||r;return ae.useEffect(()=>{r==null&&(ED+=1,a(`mui-${ED}`))},[r]),l}const x$={...zb},CD=x$.useId;function J_(e){if(CD!==void 0){const r=CD();return e??r}return v$(e)}function b$(e){const r=y3(),a=J_()||"",{modularCssLayers:l}=e;let m="mui.global, mui.components, mui.theme, mui.custom, mui.sx";return!l||r!==null?m="":typeof l=="string"?m=l.replace(/mui(?!\.)/g,m):m=`@layer ${m};`,Hp(()=>{const y=document.querySelector("head");if(!y)return;const T=y.firstChild;if(m){if(T&&T.hasAttribute?.("data-mui-layer-order")&&T.getAttribute("data-mui-layer-order")===a)return;const i=document.createElement("style");i.setAttribute("data-mui-layer-order",a),i.textContent=m,y.prepend(i)}else y.querySelector(`style[data-mui-layer-order="${a}"]`)?.remove()},[m,a]),m?be.jsx(JL,{styles:m}):null}const MD={};function ID(e,r,a,l=!1){return ae.useMemo(()=>{const m=e&&r[e]||r;if(typeof a=="function"){const y=a(m),T=e?{...r,[e]:y}:y;return l?()=>T:T}return e?{...r,[e]:a}:{...r,...a}},[e,r,a,l])}function hB(e){const{children:r,theme:a,themeId:l}=e,m=y3(MD),y=b3()||MD,T=ID(l,m,a),i=ID(l,y,a,!0),z=(l?T[l]:T).direction==="rtl",B=b$(T);return be.jsx(m$,{theme:i,children:be.jsx(sx.Provider,{value:T,children:be.jsx(A$,{value:z,children:be.jsxs(g$,{value:l?T[l].components:T.components,children:[B,r]})})})})}const PD={theme:void 0};function w$(e){let r,a;return function(m){let y=r;return(y===void 0||m.theme!==a)&&(PD.theme=m.theme,y=rB(e(PD)),r=y,a=m.theme),y}}const w3="mode",S3="color-scheme",S$="data-color-scheme";function T$(e){const{defaultMode:r="system",defaultLightColorScheme:a="light",defaultDarkColorScheme:l="dark",modeStorageKey:m=w3,colorSchemeStorageKey:y=S3,attribute:T=S$,colorSchemeNode:i="document.documentElement",nonce:z}=e||{};let B="",F=T;if(T==="class"&&(F=".%s"),T==="data"&&(F="[data-%s]"),F.startsWith(".")){const Q=F.substring(1);B+=`${i}.classList.remove('${Q}'.replace('%s', light), '${Q}'.replace('%s', dark));
      ${i}.classList.add('${Q}'.replace('%s', colorScheme));`}const G=F.match(/\[([^[\]]+)\]/);if(G){const[Q,te]=G[1].split("=");te||(B+=`${i}.removeAttribute('${Q}'.replace('%s', light));
      ${i}.removeAttribute('${Q}'.replace('%s', dark));`),B+=`
      ${i}.setAttribute('${Q}'.replace('%s', colorScheme), ${te?`${te}.replace('%s', colorScheme)`:'""'});`}else B+=`${i}.setAttribute('${F}', colorScheme);`;return be.jsx("script",{suppressHydrationWarning:!0,nonce:typeof window>"u"?z:"",dangerouslySetInnerHTML:{__html:`(function() {
try {
  let colorScheme = '';
  const mode = localStorage.getItem('${m}') || '${r}';
  const dark = localStorage.getItem('${y}-dark') || '${l}';
  const light = localStorage.getItem('${y}-light') || '${a}';
  if (mode === 'system') {
    // handle system mode
    const mql = window.matchMedia('(prefers-color-scheme: dark)');
    if (mql.matches) {
      colorScheme = dark
    } else {
      colorScheme = light
    }
  }
  if (mode === 'light') {
    colorScheme = light;
  }
  if (mode === 'dark') {
    colorScheme = dark;
  }
  if (colorScheme) {
    ${B}
  }
} catch(e){}})();`}},"mui-color-scheme-init")}function E$(){}const C$=({key:e,storageWindow:r})=>(!r&&typeof window<"u"&&(r=window),{get(a){if(typeof window>"u")return;if(!r)return a;let l;try{l=r.localStorage.getItem(e)}catch{}return l||a},set:a=>{if(r)try{r.localStorage.setItem(e,a)}catch{}},subscribe:a=>{if(!r)return E$;const l=m=>{const y=m.newValue;m.key===e&&a(y)};return r.addEventListener("storage",l),()=>{r.removeEventListener("storage",l)}}});function ZS(){}function RD(e){if(typeof window<"u"&&typeof window.matchMedia=="function"&&e==="system")return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function fB(e,r){if(e.mode==="light"||e.mode==="system"&&e.systemMode==="light")return r("light");if(e.mode==="dark"||e.mode==="system"&&e.systemMode==="dark")return r("dark")}function M$(e){return fB(e,r=>{if(r==="light")return e.lightColorScheme;if(r==="dark")return e.darkColorScheme})}function I$(e){const{defaultMode:r="light",defaultLightColorScheme:a,defaultDarkColorScheme:l,supportedColorSchemes:m=[],modeStorageKey:y=w3,colorSchemeStorageKey:T=S3,storageWindow:i=typeof window>"u"?void 0:window,storageManager:z=C$,noSsr:B=!1}=e,F=m.join(","),G=m.length>1,Q=ae.useMemo(()=>z?.({key:y,storageWindow:i}),[z,y,i]),te=ae.useMemo(()=>z?.({key:`${T}-light`,storageWindow:i}),[z,T,i]),ne=ae.useMemo(()=>z?.({key:`${T}-dark`,storageWindow:i}),[z,T,i]),[oe,ue]=ae.useState(()=>{const st=Q?.get(r)||r,dt=te?.get(a)||a,bt=ne?.get(l)||l;return{mode:st,systemMode:RD(st),lightColorScheme:dt,darkColorScheme:bt}}),[ye,we]=ae.useState(B||!G);ae.useEffect(()=>{we(!0)},[]);const ve=M$(oe),Ce=ae.useCallback(st=>{ue(dt=>{if(st===dt.mode)return dt;const bt=st??r;return Q?.set(bt),{...dt,mode:bt,systemMode:RD(bt)}})},[Q,r]),Ee=ae.useCallback(st=>{st?typeof st=="string"?st&&!F.includes(st)?console.error(`\`${st}\` does not exist in \`theme.colorSchemes\`.`):ue(dt=>{const bt={...dt};return fB(dt,ht=>{ht==="light"&&(te?.set(st),bt.lightColorScheme=st),ht==="dark"&&(ne?.set(st),bt.darkColorScheme=st)}),bt}):ue(dt=>{const bt={...dt},ht=st.light===null?a:st.light,Re=st.dark===null?l:st.dark;return ht&&(F.includes(ht)?(bt.lightColorScheme=ht,te?.set(ht)):console.error(`\`${ht}\` does not exist in \`theme.colorSchemes\`.`)),Re&&(F.includes(Re)?(bt.darkColorScheme=Re,ne?.set(Re)):console.error(`\`${Re}\` does not exist in \`theme.colorSchemes\`.`)),bt}):ue(dt=>(te?.set(a),ne?.set(l),{...dt,lightColorScheme:a,darkColorScheme:l}))},[F,te,ne,a,l]),Be=ae.useCallback(st=>{oe.mode==="system"&&ue(dt=>{const bt=st?.matches?"dark":"light";return dt.systemMode===bt?dt:{...dt,systemMode:bt}})},[oe.mode]),Ke=ae.useRef(Be);return Ke.current=Be,ae.useEffect(()=>{if(typeof window.matchMedia!="function"||!G)return;const st=(...bt)=>Ke.current(...bt),dt=window.matchMedia("(prefers-color-scheme: dark)");return dt.addListener(st),st(dt),()=>{dt.removeListener(st)}},[G]),ae.useEffect(()=>{if(G){const st=Q?.subscribe(ht=>{(!ht||["light","dark","system"].includes(ht))&&Ce(ht||r)})||ZS,dt=te?.subscribe(ht=>{(!ht||F.match(ht))&&Ee({light:ht})})||ZS,bt=ne?.subscribe(ht=>{(!ht||F.match(ht))&&Ee({dark:ht})})||ZS;return()=>{st(),dt(),bt()}}},[Ee,Ce,F,r,i,G,Q,te,ne]),{...oe,mode:ye?oe.mode:void 0,systemMode:ye?oe.systemMode:void 0,colorScheme:ye?ve:void 0,setMode:Ce,setColorScheme:Ee}}const P$="*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function R$(e){const{themeId:r,theme:a={},modeStorageKey:l=w3,colorSchemeStorageKey:m=S3,disableTransitionOnChange:y=!1,defaultColorScheme:T,resolveTheme:i}=e,z={allColorSchemes:[],colorScheme:void 0,darkColorScheme:void 0,lightColorScheme:void 0,mode:void 0,setColorScheme:()=>{},setMode:()=>{},systemMode:void 0},B=ae.createContext(void 0),F=()=>ae.useContext(B)||z,G={},Q={};function te(ye){const{children:we,theme:ve,modeStorageKey:Ce=l,colorSchemeStorageKey:Ee=m,disableTransitionOnChange:Be=y,storageManager:Ke,storageWindow:st=typeof window>"u"?void 0:window,documentNode:dt=typeof document>"u"?void 0:document,colorSchemeNode:bt=typeof document>"u"?void 0:document.documentElement,disableNestedContext:ht=!1,disableStyleSheetGeneration:Re=!1,defaultMode:Pt="system",forceThemeRerender:wt=!1,noSsr:Et}=ye,et=ae.useRef(!1),Zt=b3(),ir=ae.useContext(B),or=!!ir&&!ht,ft=ae.useMemo(()=>ve||(typeof a=="function"?a():a),[ve]),Vt=ft[r],Jt=Vt||ft,{colorSchemes:Cr=G,components:ln=Q,cssVarPrefix:tn}=Jt,Hr=Object.keys(Cr).filter(ao=>!!Cr[ao]).join(","),Nn=ae.useMemo(()=>Hr.split(","),[Hr]),jn=typeof T=="string"?T:T.light,Ur=typeof T=="string"?T:T.dark,Gr=Cr[jn]&&Cr[Ur]?Pt:Cr[Jt.defaultColorScheme]?.palette?.mode||Jt.palette?.mode,{mode:Sn,setMode:Tr,systemMode:Zi,lightColorScheme:wn,darkColorScheme:Rn,colorScheme:mo,setColorScheme:di}=I$({supportedColorSchemes:Nn,defaultLightColorScheme:jn,defaultDarkColorScheme:Ur,modeStorageKey:Ce,colorSchemeStorageKey:Ee,defaultMode:Gr,storageManager:Ke,storageWindow:st,noSsr:Et});let Ao=Sn,eo=mo;or&&(Ao=ir.mode,eo=ir.colorScheme);let $o=eo||Jt.defaultColorScheme;Jt.vars&&!wt&&($o=Jt.defaultColorScheme);const _i=ae.useMemo(()=>{const ao=Jt.generateThemeVars?.()||Jt.vars,ai={...Jt,components:ln,colorSchemes:Cr,cssVarPrefix:tn,vars:ao};if(typeof ai.generateSpacing=="function"&&(ai.spacing=ai.generateSpacing()),$o){const Po=Cr[$o];Po&&typeof Po=="object"&&Object.keys(Po).forEach(to=>{Po[to]&&typeof Po[to]=="object"?ai[to]={...ai[to],...Po[to]}:ai[to]=Po[to]})}return i?i(ai):ai},[Jt,$o,ln,Cr,tn]),Bn=Jt.colorSchemeSelector;Hp(()=>{if(eo&&bt&&Bn&&Bn!=="media"){const ao=Bn;let ai=Bn;if(ao==="class"&&(ai=".%s"),ao==="data"&&(ai="[data-%s]"),ao?.startsWith("data-")&&!ao.includes("%s")&&(ai=`[${ao}="%s"]`),ai.startsWith("."))bt.classList.remove(...Nn.map(Po=>ai.substring(1).replace("%s",Po))),bt.classList.add(ai.substring(1).replace("%s",eo));else{const Po=ai.replace("%s",eo).match(/\[([^\]]+)\]/);if(Po){const[to,Va]=Po[1].split("=");Va||Nn.forEach(Mi=>{bt.removeAttribute(to.replace(eo,Mi))}),bt.setAttribute(to,Va?Va.replace(/"|'/g,""):"")}else bt.setAttribute(ai,eo)}}},[eo,Bn,bt,Nn]),ae.useEffect(()=>{let ao;if(Be&&et.current&&dt){const ai=dt.createElement("style");ai.appendChild(dt.createTextNode(P$)),dt.head.appendChild(ai),window.getComputedStyle(dt.body),ao=setTimeout(()=>{dt.head.removeChild(ai)},1)}return()=>{clearTimeout(ao)}},[eo,Be,dt]),ae.useEffect(()=>(et.current=!0,()=>{et.current=!1}),[]);const Ca=ae.useMemo(()=>({allColorSchemes:Nn,colorScheme:eo,darkColorScheme:Rn,lightColorScheme:wn,mode:Ao,setColorScheme:di,setMode:Tr,systemMode:Zi}),[Nn,eo,Rn,wn,Ao,di,Tr,Zi,_i.colorSchemeSelector]);let Io=!0;(Re||Jt.cssVariables===!1||or&&Zt?.cssVarPrefix===tn)&&(Io=!1);const Qa=be.jsxs(ae.Fragment,{children:[be.jsx(hB,{themeId:Vt?r:void 0,theme:_i,children:we}),Io&&be.jsx(WL,{styles:_i.generateStyleSheets?.()||[]})]});return or?Qa:be.jsx(B.Provider,{value:Ca,children:Qa})}const ne=typeof T=="string"?T:T.light,oe=typeof T=="string"?T:T.dark;return{CssVarsProvider:te,useColorScheme:F,getInitColorSchemeScript:ye=>T$({colorSchemeStorageKey:m,defaultLightColorScheme:ne,defaultDarkColorScheme:oe,modeStorageKey:l,...ye})}}function D$(e=""){function r(...l){if(!l.length)return"";const m=l[0];return typeof m=="string"&&!m.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${e?`${e}-`:""}${m}${r(...l.slice(1))})`:`, ${m}`}return(l,...m)=>`var(--${e?`${e}-`:""}${l}${r(...m)})`}const DD=(e,r,a,l=[])=>{let m=e;r.forEach((y,T)=>{T===r.length-1?Array.isArray(m)?m[Number(y)]=a:m&&typeof m=="object"&&(m[y]=a):m&&typeof m=="object"&&(m[y]||(m[y]=l.includes(y)?[]:{}),m=m[y])})},O$=(e,r,a)=>{function l(m,y=[],T=[]){Object.entries(m).forEach(([i,z])=>{(!a||a&&!a([...y,i]))&&z!=null&&(typeof z=="object"&&Object.keys(z).length>0?l(z,[...y,i],Array.isArray(z)?[...T,i]:T):r([...y,i],z,T))})}l(e)},k$=(e,r)=>typeof r=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(l=>e.includes(l))||e[e.length-1].toLowerCase().includes("opacity")?r:`${r}px`:r;function XS(e,r){const{prefix:a,shouldSkipGeneratingVar:l}=r||{},m={},y={},T={};return O$(e,(i,z,B)=>{if((typeof z=="string"||typeof z=="number")&&(!l||!l(i,z))){const F=`--${a?`${a}-`:""}${i.join("-")}`,G=k$(i,z);Object.assign(m,{[F]:G}),DD(y,i,`var(${F})`,B),DD(T,i,`var(${F}, ${G})`,B)}},i=>i[0]==="vars"),{css:m,vars:y,varsWithDefaults:T}}function z$(e,r={}){const{getSelector:a=ye,disableCssColorScheme:l,colorSchemeSelector:m,enableContrastVars:y}=r,{colorSchemes:T={},components:i,defaultColorScheme:z="light",...B}=e,{vars:F,css:G,varsWithDefaults:Q}=XS(B,r);let te=Q;const ne={},{[z]:oe,...ue}=T;if(Object.entries(ue||{}).forEach(([Ce,Ee])=>{const{vars:Be,css:Ke,varsWithDefaults:st}=XS(Ee,r);te=Kc(te,st),ne[Ce]={css:Ke,vars:Be}}),oe){const{css:Ce,vars:Ee,varsWithDefaults:Be}=XS(oe,r);te=Kc(te,Be),ne[z]={css:Ce,vars:Ee}}function ye(Ce,Ee){let Be=m;if(m==="class"&&(Be=".%s"),m==="data"&&(Be="[data-%s]"),m?.startsWith("data-")&&!m.includes("%s")&&(Be=`[${m}="%s"]`),Ce){if(Be==="media")return e.defaultColorScheme===Ce?":root":{[`@media (prefers-color-scheme: ${T[Ce]?.palette?.mode||Ce})`]:{":root":Ee}};if(Be)return e.defaultColorScheme===Ce?`:root, ${Be.replace("%s",String(Ce))}`:Be.replace("%s",String(Ce))}return":root"}return{vars:te,generateThemeVars:()=>{let Ce={...F};return Object.entries(ne).forEach(([,{vars:Ee}])=>{Ce=Kc(Ce,Ee)}),Ce},generateStyleSheets:()=>{const Ce=[],Ee=e.defaultColorScheme||"light";function Be(dt,bt){Object.keys(bt).length&&Ce.push(typeof dt=="string"?{[dt]:{...bt}}:dt)}Be(a(void 0,{...G}),G);const{[Ee]:Ke,...st}=ne;if(Ke){const{css:dt}=Ke,bt=T[Ee]?.palette?.mode,ht=!l&&bt?{colorScheme:bt,...dt}:{...dt};Be(a(Ee,{...ht}),ht)}return Object.entries(st).forEach(([dt,{css:bt}])=>{const ht=T[dt]?.palette?.mode,Re=!l&&ht?{colorScheme:ht,...bt}:{...bt};Be(a(dt,{...Re}),Re)}),y&&Ce.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),Ce}}}function L$(e){return function(a){return e==="media"?`@media (prefers-color-scheme: ${a})`:e?e.startsWith("data-")&&!e.includes("%s")?`[${e}="${a}"] &`:e==="class"?`.${a} &`:e==="data"?`[data-${a}] &`:`${e.replace("%s",a)} &`:"&"}}function Ni(e,r,a=void 0){const l={};for(const m in e){const y=e[m];let T="",i=!0;for(let z=0;z<y.length;z+=1){const B=y[z];B&&(T+=(i===!0?"":" ")+r(B),i=!1,a&&a[B]&&(T+=" "+a[B]))}l[m]=T}return l}const B$=hx(),F$=oB("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`maxWidth${sn(String(a.maxWidth))}`],a.fixed&&r.fixed,a.disableGutters&&r.disableGutters]}}),N$=e=>aB({props:e,name:"MuiContainer",defaultTheme:B$}),j$=(e,r)=>{const a=z=>Bi(r,z),{classes:l,fixed:m,disableGutters:y,maxWidth:T}=e,i={root:["root",T&&`maxWidth${sn(String(T))}`,m&&"fixed",y&&"disableGutters"]};return Ni(i,a,l)};function U$(e={}){const{createStyledComponent:r=F$,useThemeProps:a=N$,componentName:l="MuiContainer"}=e,m=r(({theme:T,ownerState:i})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!i.disableGutters&&{paddingLeft:T.spacing(2),paddingRight:T.spacing(2),[T.breakpoints.up("sm")]:{paddingLeft:T.spacing(3),paddingRight:T.spacing(3)}}}),({theme:T,ownerState:i})=>i.fixed&&Object.keys(T.breakpoints.values).reduce((z,B)=>{const F=B,G=T.breakpoints.values[F];return G!==0&&(z[T.breakpoints.up(F)]={maxWidth:`${G}${T.breakpoints.unit}`}),z},{}),({theme:T,ownerState:i})=>({...i.maxWidth==="xs"&&{[T.breakpoints.up("xs")]:{maxWidth:Math.max(T.breakpoints.values.xs,444)}},...i.maxWidth&&i.maxWidth!=="xs"&&{[T.breakpoints.up(i.maxWidth)]:{maxWidth:`${T.breakpoints.values[i.maxWidth]}${T.breakpoints.unit}`}}}));return ae.forwardRef(function(i,z){const B=a(i),{className:F,component:G="div",disableGutters:Q=!1,fixed:te=!1,maxWidth:ne="lg",classes:oe,...ue}=B,ye={...B,component:G,disableGutters:Q,fixed:te,maxWidth:ne},we=j$(ye,l);return be.jsx(m,{as:G,ownerState:ye,className:on(we.root,F),ref:z,...ue})})}function zv(e,r){return ae.isValidElement(e)&&r.indexOf(e.type.muiName??e.type?._payload?.value?.muiName)!==-1}const V$=(e,r)=>e.filter(a=>r.includes(a)),ey=(e,r,a)=>{const l=e.keys[0];Array.isArray(r)?r.forEach((m,y)=>{a((T,i)=>{y<=e.keys.length-1&&(y===0?Object.assign(T,i):T[e.up(e.keys[y])]=i)},m)}):r&&typeof r=="object"?(Object.keys(r).length>e.keys.length?e.keys:V$(e.keys,Object.keys(r))).forEach(y=>{if(e.keys.includes(y)){const T=r[y];T!==void 0&&a((i,z)=>{l===y?Object.assign(i,z):i[e.up(y)]=z},T)}}):(typeof r=="number"||typeof r=="string")&&a((m,y)=>{Object.assign(m,y)},r)};function Nb(e){return`--Grid-${e}Spacing`}function Uw(e){return`--Grid-parent-${e}Spacing`}const OD="--Grid-columns",k_="--Grid-parent-columns",$$=({theme:e,ownerState:r})=>{const a={};return ey(e.breakpoints,r.size,(l,m)=>{let y={};m==="grow"&&(y={flexBasis:0,flexGrow:1,maxWidth:"100%"}),m==="auto"&&(y={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"}),typeof m=="number"&&(y={flexGrow:0,flexBasis:"auto",width:`calc(100% * ${m} / var(${k_}) - (var(${k_}) - ${m}) * (var(${Uw("column")}) / var(${k_})))`}),l(a,y)}),a},G$=({theme:e,ownerState:r})=>{const a={};return ey(e.breakpoints,r.offset,(l,m)=>{let y={};m==="auto"&&(y={marginLeft:"auto"}),typeof m=="number"&&(y={marginLeft:m===0?"0px":`calc(100% * ${m} / var(${k_}) + var(${Uw("column")}) * ${m} / var(${k_}))`}),l(a,y)}),a},H$=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={[OD]:12};return ey(e.breakpoints,r.columns,(l,m)=>{const y=m??12;l(a,{[OD]:y,"> *":{[k_]:y}})}),a},q$=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={};return ey(e.breakpoints,r.rowSpacing,(l,m)=>{const y=typeof m=="string"?m:e.spacing?.(m);l(a,{[Nb("row")]:y,"> *":{[Uw("row")]:y}})}),a},W$=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={};return ey(e.breakpoints,r.columnSpacing,(l,m)=>{const y=typeof m=="string"?m:e.spacing?.(m);l(a,{[Nb("column")]:y,"> *":{[Uw("column")]:y}})}),a},Z$=({theme:e,ownerState:r})=>{if(!r.container)return{};const a={};return ey(e.breakpoints,r.direction,(l,m)=>{l(a,{flexDirection:m})}),a},X$=({ownerState:e})=>({minWidth:0,boxSizing:"border-box",...e.container&&{display:"flex",flexWrap:"wrap",...e.wrap&&e.wrap!=="wrap"&&{flexWrap:e.wrap},gap:`var(${Nb("row")}) var(${Nb("column")})`}}),Y$=e=>{const r=[];return Object.entries(e).forEach(([a,l])=>{l!==!1&&l!==void 0&&r.push(`grid-${a}-${String(l)}`)}),r},Q$=(e,r="xs")=>{function a(l){return l===void 0?!1:typeof l=="string"&&!Number.isNaN(Number(l))||typeof l=="number"&&l>0}if(a(e))return[`spacing-${r}-${String(e)}`];if(typeof e=="object"&&!Array.isArray(e)){const l=[];return Object.entries(e).forEach(([m,y])=>{a(y)&&l.push(`spacing-${m}-${String(y)}`)}),l}return[]},K$=e=>e===void 0?[]:typeof e=="object"?Object.entries(e).map(([r,a])=>`direction-${r}-${a}`):[`direction-xs-${String(e)}`];function J$(e,r){e.item!==void 0&&delete e.item,e.zeroMinWidth!==void 0&&delete e.zeroMinWidth,r.keys.forEach(a=>{e[a]!==void 0&&delete e[a]})}const eG=hx(),tG=oB("div",{name:"MuiGrid",slot:"Root"});function rG(e){return aB({props:e,name:"MuiGrid",defaultTheme:eG})}function nG(e={}){const{createStyledComponent:r=tG,useThemeProps:a=rG,useTheme:l=fx,componentName:m="MuiGrid"}=e,y=(B,F)=>{const{container:G,direction:Q,spacing:te,wrap:ne,size:oe}=B,ue={root:["root",G&&"container",ne!=="wrap"&&`wrap-xs-${String(ne)}`,...K$(Q),...Y$(oe),...G?Q$(te,F.breakpoints.keys[0]):[]]};return Ni(ue,ye=>Bi(m,ye),{})};function T(B,F,G=()=>!0){const Q={};return B===null||(Array.isArray(B)?B.forEach((te,ne)=>{te!==null&&G(te)&&F.keys[ne]&&(Q[F.keys[ne]]=te)}):typeof B=="object"?Object.keys(B).forEach(te=>{const ne=B[te];ne!=null&&G(ne)&&(Q[te]=ne)}):Q[F.keys[0]]=B),Q}const i=r(H$,W$,q$,$$,Z$,X$,G$),z=ae.forwardRef(function(F,G){const Q=l(),te=a(F),ne=v3(te);J$(ne,Q.breakpoints);const{className:oe,children:ue,columns:ye=12,container:we=!1,component:ve="div",direction:Ce="row",wrap:Ee="wrap",size:Be={},offset:Ke={},spacing:st=0,rowSpacing:dt=st,columnSpacing:bt=st,unstable_level:ht=0,...Re}=ne,Pt=T(Be,Q.breakpoints,Vt=>Vt!==!1),wt=T(Ke,Q.breakpoints),Et=F.columns??(ht?void 0:ye),et=F.spacing??(ht?void 0:st),Zt=F.rowSpacing??F.spacing??(ht?void 0:dt),ir=F.columnSpacing??F.spacing??(ht?void 0:bt),or={...ne,level:ht,columns:Et,container:we,direction:Ce,wrap:Ee,spacing:et,rowSpacing:Zt,columnSpacing:ir,size:Pt,offset:wt},ft=y(or,Q);return be.jsx(i,{ref:G,as:ve,ownerState:or,className:on(ft.root,oe),...Re,children:ae.Children.map(ue,Vt=>ae.isValidElement(Vt)&&zv(Vt,["Grid"])&&we&&Vt.props.container?ae.cloneElement(Vt,{unstable_level:Vt.props?.unstable_level??ht+1}):Vt)})});return z.muiName="Grid",z}function dB(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:jv.white,default:jv.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const pB=dB();function mB(){return{text:{primary:jv.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:jv.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const GE=mB();function kD(e,r,a,l){const m=l.light||l,y=l.dark||l*1.5;e[r]||(e.hasOwnProperty(a)?e[r]=e[a]:r==="light"?e.light=Nw(e.main,m):r==="dark"&&(e.dark=Fw(e.main,y)))}function zD(e,r,a,l,m){const y=m.light||m,T=m.dark||m*1.5;r[a]||(r.hasOwnProperty(l)?r[a]=r[l]:a==="light"?r.light=`color-mix(in ${e}, ${r.main}, #fff ${(y*100).toFixed(0)}%)`:a==="dark"&&(r.dark=`color-mix(in ${e}, ${r.main}, #000 ${(T*100).toFixed(0)}%)`))}function iG(e="light"){return e==="dark"?{main:w_[200],light:w_[50],dark:w_[400]}:{main:w_[700],light:w_[400],dark:w_[800]}}function oG(e="light"){return e==="dark"?{main:b_[200],light:b_[50],dark:b_[400]}:{main:b_[500],light:b_[300],dark:b_[700]}}function aG(e="light"){return e==="dark"?{main:x_[500],light:x_[300],dark:x_[700]}:{main:x_[700],light:x_[400],dark:x_[800]}}function sG(e="light"){return e==="dark"?{main:S_[400],light:S_[300],dark:S_[700]}:{main:S_[700],light:S_[500],dark:S_[900]}}function lG(e="light"){return e==="dark"?{main:T_[400],light:T_[300],dark:T_[700]}:{main:T_[800],light:T_[500],dark:T_[900]}}function cG(e="light"){return e==="dark"?{main:uv[400],light:uv[300],dark:uv[700]}:{main:"#ed6c02",light:uv[500],dark:uv[900]}}function uG(e){return`oklch(from ${e} var(--__l) 0 h / var(--__a))`}function T3(e){const{mode:r="light",contrastThreshold:a=3,tonalOffset:l=.2,colorSpace:m,...y}=e,T=e.primary||iG(r),i=e.secondary||oG(r),z=e.error||aG(r),B=e.info||sG(r),F=e.success||lG(r),G=e.warning||cG(r);function Q(ue){return m?uG(ue):u$(ue,GE.text.primary)>=a?GE.text.primary:pB.text.primary}const te=({color:ue,name:ye,mainShade:we=500,lightShade:ve=300,darkShade:Ce=700})=>{if(ue={...ue},!ue.main&&ue[we]&&(ue.main=ue[we]),!ue.hasOwnProperty("main"))throw new Error(Gm(11,ye?` (${ye})`:"",we));if(typeof ue.main!="string")throw new Error(Gm(12,ye?` (${ye})`:"",JSON.stringify(ue.main)));return m?(zD(m,ue,"light",ve,l),zD(m,ue,"dark",Ce,l)):(kD(ue,"light",ve,l),kD(ue,"dark",Ce,l)),ue.contrastText||(ue.contrastText=Q(ue.main)),ue};let ne;return r==="light"?ne=dB():r==="dark"&&(ne=mB()),Kc({common:{...jv},mode:r,primary:te({color:T,name:"primary"}),secondary:te({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:te({color:z,name:"error"}),warning:te({color:G,name:"warning"}),info:te({color:B,name:"info"}),success:te({color:F,name:"success"}),grey:Y7,contrastThreshold:a,getContrastText:Q,augmentColor:te,tonalOffset:l,...ne},y)}function hG(e){const r={};return Object.entries(e).forEach(l=>{const[m,y]=l;typeof y=="object"&&(r[m]=`${y.fontStyle?`${y.fontStyle} `:""}${y.fontVariant?`${y.fontVariant} `:""}${y.fontWeight?`${y.fontWeight} `:""}${y.fontStretch?`${y.fontStretch} `:""}${y.fontSize||""}${y.lineHeight?`/${y.lineHeight} `:""}${y.fontFamily||""}`)}),r}function fG(e,r){return{toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}},...r}}function dG(e){return Math.round(e*1e5)/1e5}const LD={textTransform:"uppercase"},BD='"Roboto", "Helvetica", "Arial", sans-serif';function AB(e,r){const{fontFamily:a=BD,fontSize:l=14,fontWeightLight:m=300,fontWeightRegular:y=400,fontWeightMedium:T=500,fontWeightBold:i=700,htmlFontSize:z=16,allVariants:B,pxToRem:F,...G}=typeof r=="function"?r(e):r,Q=l/14,te=F||(ue=>`${ue/z*Q}rem`),ne=(ue,ye,we,ve,Ce)=>({fontFamily:a,fontWeight:ue,fontSize:te(ye),lineHeight:we,...a===BD?{letterSpacing:`${dG(ve/ye)}em`}:{},...Ce,...B}),oe={h1:ne(m,96,1.167,-1.5),h2:ne(m,60,1.2,-.5),h3:ne(y,48,1.167,0),h4:ne(y,34,1.235,.25),h5:ne(y,24,1.334,0),h6:ne(T,20,1.6,.15),subtitle1:ne(y,16,1.75,.15),subtitle2:ne(T,14,1.57,.1),body1:ne(y,16,1.5,.15),body2:ne(y,14,1.43,.15),button:ne(T,14,1.75,.4,LD),caption:ne(y,12,1.66,.4),overline:ne(y,12,2.66,1,LD),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Kc({htmlFontSize:z,pxToRem:te,fontFamily:a,fontSize:l,fontWeightLight:m,fontWeightRegular:y,fontWeightMedium:T,fontWeightBold:i,...oe},G,{clone:!1})}const pG=.2,mG=.14,AG=.12;function fs(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${pG})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${mG})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${AG})`].join(",")}const gG=["none",fs(0,2,1,-1,0,1,1,0,0,1,3,0),fs(0,3,1,-2,0,2,2,0,0,1,5,0),fs(0,3,3,-2,0,3,4,0,0,1,8,0),fs(0,2,4,-1,0,4,5,0,0,1,10,0),fs(0,3,5,-1,0,5,8,0,0,1,14,0),fs(0,3,5,-1,0,6,10,0,0,1,18,0),fs(0,4,5,-2,0,7,10,1,0,2,16,1),fs(0,5,5,-3,0,8,10,1,0,3,14,2),fs(0,5,6,-3,0,9,12,1,0,3,16,2),fs(0,6,6,-3,0,10,14,1,0,4,18,3),fs(0,6,7,-4,0,11,15,1,0,4,20,3),fs(0,7,8,-4,0,12,17,2,0,5,22,4),fs(0,7,8,-4,0,13,19,2,0,5,24,4),fs(0,7,9,-4,0,14,21,2,0,5,26,4),fs(0,8,9,-5,0,15,22,2,0,6,28,5),fs(0,8,10,-5,0,16,24,2,0,6,30,5),fs(0,8,11,-5,0,17,26,2,0,6,32,5),fs(0,9,11,-5,0,18,28,2,0,7,34,6),fs(0,9,12,-6,0,19,29,2,0,7,36,6),fs(0,10,13,-6,0,20,31,3,0,8,38,7),fs(0,10,13,-6,0,21,33,3,0,8,40,7),fs(0,10,14,-6,0,22,35,3,0,8,42,7),fs(0,11,14,-7,0,23,36,3,0,9,44,8),fs(0,11,15,-7,0,24,38,3,0,9,46,8)],_G={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},yG={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function FD(e){return`${Math.round(e)}ms`}function vG(e){if(!e)return 0;const r=e/36;return Math.min(Math.round((4+15*r**.25+r/5)*10),3e3)}function xG(e){const r={..._G,...e.easing},a={...yG,...e.duration};return{getAutoHeightDuration:vG,create:(m=["all"],y={})=>{const{duration:T=a.standard,easing:i=r.easeInOut,delay:z=0,...B}=y;return(Array.isArray(m)?m:[m]).map(F=>`${F} ${typeof T=="string"?T:FD(T)} ${i} ${typeof z=="string"?z:FD(z)}`).join(",")},...e,easing:r,duration:a}}const bG={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function wG(e){return jp(e)||typeof e>"u"||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||Array.isArray(e)}function gB(e={}){const r={...e};function a(l){const m=Object.entries(l);for(let y=0;y<m.length;y++){const[T,i]=m[y];!wG(i)||T.startsWith("unstable_")?delete l[T]:jp(i)&&(l[T]={...i},a(l[T]))}}return a(r),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(r,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function ND(e){return typeof e=="number"?`${(e*100).toFixed(0)}%`:`calc((${e}) * 100%)`}const SG=e=>{if(!Number.isNaN(+e))return+e;const r=e.match(/\d*\.?\d+/g);if(!r)return 0;let a=0;for(let l=0;l<r.length;l+=1)a+=+r[l];return a};function TG(e){Object.assign(e,{alpha(r,a){const l=this||e;return l.colorSpace?`oklch(from ${r} l c h / ${typeof a=="string"?`calc(${a})`:a})`:l.vars?`rgba(${r.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof a=="string"?`calc(${a})`:a})`:Fb(r,SG(a))},lighten(r,a){const l=this||e;return l.colorSpace?`color-mix(in ${l.colorSpace}, ${r}, #fff ${ND(a)})`:Nw(r,a)},darken(r,a){const l=this||e;return l.colorSpace?`color-mix(in ${l.colorSpace}, ${r}, #000 ${ND(a)})`:Fw(r,a)}})}function HE(e={},...r){const{breakpoints:a,mixins:l={},spacing:m,palette:y={},transitions:T={},typography:i={},shape:z,colorSpace:B,...F}=e;if(e.vars&&e.generateThemeVars===void 0)throw new Error(Gm(20));const G=T3({...y,colorSpace:B}),Q=hx(e);let te=Kc(Q,{mixins:fG(Q.breakpoints,l),palette:G,shadows:gG.slice(),typography:AB(G,i),transitions:xG(T),zIndex:{...bG}});return te=Kc(te,F),te=r.reduce((ne,oe)=>Kc(ne,oe),te),te.unstable_sxConfig={...ux,...F?.unstable_sxConfig},te.unstable_sx=function(oe){return i0({sx:oe,theme:this})},te.toRuntimeSource=gB,TG(te),te}function qE(e){let r;return e<1?r=5.11916*e**2:r=4.5*Math.log(e+1)+2,Math.round(r*10)/1e3}const EG=[...Array(25)].map((e,r)=>{if(r===0)return"none";const a=qE(r);return`linear-gradient(rgba(255 255 255 / ${a}), rgba(255 255 255 / ${a}))`});function _B(e){return{inputPlaceholder:e==="dark"?.5:.42,inputUnderline:e==="dark"?.7:.42,switchTrackDisabled:e==="dark"?.2:.12,switchTrack:e==="dark"?.3:.38}}function yB(e){return e==="dark"?EG:[]}function CG(e){const{palette:r={mode:"light"},opacity:a,overlays:l,colorSpace:m,...y}=e,T=T3({...r,colorSpace:m});return{palette:T,opacity:{..._B(T.mode),...a},overlays:l||yB(T.mode),...y}}function MG(e){return!!e[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!e[0].match(/sxConfig$/)||e[0]==="palette"&&!!e[1]?.match(/(mode|contrastThreshold|tonalOffset)/)}const IG=e=>[...[...Array(25)].map((r,a)=>`--${e?`${e}-`:""}overlays-${a}`),`--${e?`${e}-`:""}palette-AppBar-darkBg`,`--${e?`${e}-`:""}palette-AppBar-darkColor`],PG=e=>(r,a)=>{const l=e.rootSelector||":root",m=e.colorSchemeSelector;let y=m;if(m==="class"&&(y=".%s"),m==="data"&&(y="[data-%s]"),m?.startsWith("data-")&&!m.includes("%s")&&(y=`[${m}="%s"]`),e.defaultColorScheme===r){if(r==="dark"){const T={};return IG(e.cssVarPrefix).forEach(i=>{T[i]=a[i],delete a[i]}),y==="media"?{[l]:a,"@media (prefers-color-scheme: dark)":{[l]:T}}:y?{[y.replace("%s",r)]:T,[`${l}, ${y.replace("%s",r)}`]:a}:{[l]:{...a,...T}}}if(y&&y!=="media")return`${l}, ${y.replace("%s",String(r))}`}else if(r){if(y==="media")return{[`@media (prefers-color-scheme: ${String(r)})`]:{[l]:a}};if(y)return y.replace("%s",String(r))}return l};function RG(e,r){r.forEach(a=>{e[a]||(e[a]={})})}function Or(e,r,a){!e[r]&&a&&(e[r]=a)}function Mv(e){return typeof e!="string"||!e.startsWith("hsl")?e:sB(e)}function Dm(e,r){`${r}Channel`in e||(e[`${r}Channel`]=Cv(Mv(e[r])))}function DG(e){return typeof e=="number"?`${e}px`:typeof e=="string"||typeof e=="function"||Array.isArray(e)?e:"8px"}const kp=e=>{try{return e()}catch{}},OG=(e="mui")=>D$(e);function YS(e,r,a,l,m){if(!a)return;a=a===!0?{}:a;const y=m==="dark"?"dark":"light";if(!l){r[m]=CG({...a,palette:{mode:y,...a?.palette},colorSpace:e});return}const{palette:T,...i}=HE({...l,palette:{mode:y,...a?.palette},colorSpace:e});return r[m]={...a,palette:T,opacity:{..._B(y),...a?.opacity},overlays:a?.overlays||yB(y)},i}function kG(e={},...r){const{colorSchemes:a={light:!0},defaultColorScheme:l,disableCssColorScheme:m=!1,cssVarPrefix:y="mui",nativeColor:T=!1,shouldSkipGeneratingVar:i=MG,colorSchemeSelector:z=a.light&&a.dark?"media":void 0,rootSelector:B=":root",...F}=e,G=Object.keys(a)[0],Q=l||(a.light&&G!=="light"?"light":G),te=OG(y),{[Q]:ne,light:oe,dark:ue,...ye}=a,we={...ye};let ve=ne;if((Q==="dark"&&!("dark"in a)||Q==="light"&&!("light"in a))&&(ve=!0),!ve)throw new Error(Gm(21,Q));let Ce;T&&(Ce="oklch");const Ee=YS(Ce,we,ve,F,Q);oe&&!we.light&&YS(Ce,we,oe,void 0,"light"),ue&&!we.dark&&YS(Ce,we,ue,void 0,"dark");let Be={defaultColorScheme:Q,...Ee,cssVarPrefix:y,colorSchemeSelector:z,rootSelector:B,getCssVar:te,colorSchemes:we,font:{...hG(Ee.typography),...Ee.font},spacing:DG(F.spacing)};Object.keys(Be.colorSchemes).forEach(ht=>{const Re=Be.colorSchemes[ht].palette,Pt=Et=>{const et=Et.split("-"),Zt=et[1],ir=et[2];return te(Et,Re[Zt][ir])};Re.mode==="light"&&(Or(Re.common,"background","#fff"),Or(Re.common,"onBackground","#000")),Re.mode==="dark"&&(Or(Re.common,"background","#000"),Or(Re.common,"onBackground","#fff"));function wt(Et,et,Zt){if(Ce){let ir;return Et===X0&&(ir=`transparent ${((1-Zt)*100).toFixed(0)}%`),Et===Sa&&(ir=`#000 ${(Zt*100).toFixed(0)}%`),Et===Ta&&(ir=`#fff ${(Zt*100).toFixed(0)}%`),`color-mix(in ${Ce}, ${et}, ${ir})`}return Et(et,Zt)}if(RG(Re,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),Re.mode==="light"){Or(Re.Alert,"errorColor",wt(Sa,Re.error.light,.6)),Or(Re.Alert,"infoColor",wt(Sa,Re.info.light,.6)),Or(Re.Alert,"successColor",wt(Sa,Re.success.light,.6)),Or(Re.Alert,"warningColor",wt(Sa,Re.warning.light,.6)),Or(Re.Alert,"errorFilledBg",Pt("palette-error-main")),Or(Re.Alert,"infoFilledBg",Pt("palette-info-main")),Or(Re.Alert,"successFilledBg",Pt("palette-success-main")),Or(Re.Alert,"warningFilledBg",Pt("palette-warning-main")),Or(Re.Alert,"errorFilledColor",kp(()=>Re.getContrastText(Re.error.main))),Or(Re.Alert,"infoFilledColor",kp(()=>Re.getContrastText(Re.info.main))),Or(Re.Alert,"successFilledColor",kp(()=>Re.getContrastText(Re.success.main))),Or(Re.Alert,"warningFilledColor",kp(()=>Re.getContrastText(Re.warning.main))),Or(Re.Alert,"errorStandardBg",wt(Ta,Re.error.light,.9)),Or(Re.Alert,"infoStandardBg",wt(Ta,Re.info.light,.9)),Or(Re.Alert,"successStandardBg",wt(Ta,Re.success.light,.9)),Or(Re.Alert,"warningStandardBg",wt(Ta,Re.warning.light,.9)),Or(Re.Alert,"errorIconColor",Pt("palette-error-main")),Or(Re.Alert,"infoIconColor",Pt("palette-info-main")),Or(Re.Alert,"successIconColor",Pt("palette-success-main")),Or(Re.Alert,"warningIconColor",Pt("palette-warning-main")),Or(Re.AppBar,"defaultBg",Pt("palette-grey-100")),Or(Re.Avatar,"defaultBg",Pt("palette-grey-400")),Or(Re.Button,"inheritContainedBg",Pt("palette-grey-300")),Or(Re.Button,"inheritContainedHoverBg",Pt("palette-grey-A100")),Or(Re.Chip,"defaultBorder",Pt("palette-grey-400")),Or(Re.Chip,"defaultAvatarColor",Pt("palette-grey-700")),Or(Re.Chip,"defaultIconColor",Pt("palette-grey-700")),Or(Re.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),Or(Re.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),Or(Re.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),Or(Re.LinearProgress,"primaryBg",wt(Ta,Re.primary.main,.62)),Or(Re.LinearProgress,"secondaryBg",wt(Ta,Re.secondary.main,.62)),Or(Re.LinearProgress,"errorBg",wt(Ta,Re.error.main,.62)),Or(Re.LinearProgress,"infoBg",wt(Ta,Re.info.main,.62)),Or(Re.LinearProgress,"successBg",wt(Ta,Re.success.main,.62)),Or(Re.LinearProgress,"warningBg",wt(Ta,Re.warning.main,.62)),Or(Re.Skeleton,"bg",Ce?wt(X0,Re.text.primary,.11):`rgba(${Pt("palette-text-primaryChannel")} / 0.11)`),Or(Re.Slider,"primaryTrack",wt(Ta,Re.primary.main,.62)),Or(Re.Slider,"secondaryTrack",wt(Ta,Re.secondary.main,.62)),Or(Re.Slider,"errorTrack",wt(Ta,Re.error.main,.62)),Or(Re.Slider,"infoTrack",wt(Ta,Re.info.main,.62)),Or(Re.Slider,"successTrack",wt(Ta,Re.success.main,.62)),Or(Re.Slider,"warningTrack",wt(Ta,Re.warning.main,.62));const Et=Ce?wt(Sa,Re.background.default,.6825):Q1(Re.background.default,.8);Or(Re.SnackbarContent,"bg",Et),Or(Re.SnackbarContent,"color",kp(()=>Ce?GE.text.primary:Re.getContrastText(Et))),Or(Re.SpeedDialAction,"fabHoverBg",Q1(Re.background.paper,.15)),Or(Re.StepConnector,"border",Pt("palette-grey-400")),Or(Re.StepContent,"border",Pt("palette-grey-400")),Or(Re.Switch,"defaultColor",Pt("palette-common-white")),Or(Re.Switch,"defaultDisabledColor",Pt("palette-grey-100")),Or(Re.Switch,"primaryDisabledColor",wt(Ta,Re.primary.main,.62)),Or(Re.Switch,"secondaryDisabledColor",wt(Ta,Re.secondary.main,.62)),Or(Re.Switch,"errorDisabledColor",wt(Ta,Re.error.main,.62)),Or(Re.Switch,"infoDisabledColor",wt(Ta,Re.info.main,.62)),Or(Re.Switch,"successDisabledColor",wt(Ta,Re.success.main,.62)),Or(Re.Switch,"warningDisabledColor",wt(Ta,Re.warning.main,.62)),Or(Re.TableCell,"border",wt(Ta,wt(X0,Re.divider,1),.88)),Or(Re.Tooltip,"bg",wt(X0,Re.grey[700],.92))}if(Re.mode==="dark"){Or(Re.Alert,"errorColor",wt(Ta,Re.error.light,.6)),Or(Re.Alert,"infoColor",wt(Ta,Re.info.light,.6)),Or(Re.Alert,"successColor",wt(Ta,Re.success.light,.6)),Or(Re.Alert,"warningColor",wt(Ta,Re.warning.light,.6)),Or(Re.Alert,"errorFilledBg",Pt("palette-error-dark")),Or(Re.Alert,"infoFilledBg",Pt("palette-info-dark")),Or(Re.Alert,"successFilledBg",Pt("palette-success-dark")),Or(Re.Alert,"warningFilledBg",Pt("palette-warning-dark")),Or(Re.Alert,"errorFilledColor",kp(()=>Re.getContrastText(Re.error.dark))),Or(Re.Alert,"infoFilledColor",kp(()=>Re.getContrastText(Re.info.dark))),Or(Re.Alert,"successFilledColor",kp(()=>Re.getContrastText(Re.success.dark))),Or(Re.Alert,"warningFilledColor",kp(()=>Re.getContrastText(Re.warning.dark))),Or(Re.Alert,"errorStandardBg",wt(Sa,Re.error.light,.9)),Or(Re.Alert,"infoStandardBg",wt(Sa,Re.info.light,.9)),Or(Re.Alert,"successStandardBg",wt(Sa,Re.success.light,.9)),Or(Re.Alert,"warningStandardBg",wt(Sa,Re.warning.light,.9)),Or(Re.Alert,"errorIconColor",Pt("palette-error-main")),Or(Re.Alert,"infoIconColor",Pt("palette-info-main")),Or(Re.Alert,"successIconColor",Pt("palette-success-main")),Or(Re.Alert,"warningIconColor",Pt("palette-warning-main")),Or(Re.AppBar,"defaultBg",Pt("palette-grey-900")),Or(Re.AppBar,"darkBg",Pt("palette-background-paper")),Or(Re.AppBar,"darkColor",Pt("palette-text-primary")),Or(Re.Avatar,"defaultBg",Pt("palette-grey-600")),Or(Re.Button,"inheritContainedBg",Pt("palette-grey-800")),Or(Re.Button,"inheritContainedHoverBg",Pt("palette-grey-700")),Or(Re.Chip,"defaultBorder",Pt("palette-grey-700")),Or(Re.Chip,"defaultAvatarColor",Pt("palette-grey-300")),Or(Re.Chip,"defaultIconColor",Pt("palette-grey-300")),Or(Re.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),Or(Re.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),Or(Re.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),Or(Re.LinearProgress,"primaryBg",wt(Sa,Re.primary.main,.5)),Or(Re.LinearProgress,"secondaryBg",wt(Sa,Re.secondary.main,.5)),Or(Re.LinearProgress,"errorBg",wt(Sa,Re.error.main,.5)),Or(Re.LinearProgress,"infoBg",wt(Sa,Re.info.main,.5)),Or(Re.LinearProgress,"successBg",wt(Sa,Re.success.main,.5)),Or(Re.LinearProgress,"warningBg",wt(Sa,Re.warning.main,.5)),Or(Re.Skeleton,"bg",Ce?wt(X0,Re.text.primary,.13):`rgba(${Pt("palette-text-primaryChannel")} / 0.13)`),Or(Re.Slider,"primaryTrack",wt(Sa,Re.primary.main,.5)),Or(Re.Slider,"secondaryTrack",wt(Sa,Re.secondary.main,.5)),Or(Re.Slider,"errorTrack",wt(Sa,Re.error.main,.5)),Or(Re.Slider,"infoTrack",wt(Sa,Re.info.main,.5)),Or(Re.Slider,"successTrack",wt(Sa,Re.success.main,.5)),Or(Re.Slider,"warningTrack",wt(Sa,Re.warning.main,.5));const Et=Ce?wt(Ta,Re.background.default,.985):Q1(Re.background.default,.98);Or(Re.SnackbarContent,"bg",Et),Or(Re.SnackbarContent,"color",kp(()=>Ce?pB.text.primary:Re.getContrastText(Et))),Or(Re.SpeedDialAction,"fabHoverBg",Q1(Re.background.paper,.15)),Or(Re.StepConnector,"border",Pt("palette-grey-600")),Or(Re.StepContent,"border",Pt("palette-grey-600")),Or(Re.Switch,"defaultColor",Pt("palette-grey-300")),Or(Re.Switch,"defaultDisabledColor",Pt("palette-grey-600")),Or(Re.Switch,"primaryDisabledColor",wt(Sa,Re.primary.main,.55)),Or(Re.Switch,"secondaryDisabledColor",wt(Sa,Re.secondary.main,.55)),Or(Re.Switch,"errorDisabledColor",wt(Sa,Re.error.main,.55)),Or(Re.Switch,"infoDisabledColor",wt(Sa,Re.info.main,.55)),Or(Re.Switch,"successDisabledColor",wt(Sa,Re.success.main,.55)),Or(Re.Switch,"warningDisabledColor",wt(Sa,Re.warning.main,.55)),Or(Re.TableCell,"border",wt(Sa,wt(X0,Re.divider,1),.68)),Or(Re.Tooltip,"bg",wt(X0,Re.grey[700],.92))}Dm(Re.background,"default"),Dm(Re.background,"paper"),Dm(Re.common,"background"),Dm(Re.common,"onBackground"),Dm(Re,"divider"),Object.keys(Re).forEach(Et=>{const et=Re[Et];Et!=="tonalOffset"&&et&&typeof et=="object"&&(et.main&&Or(Re[Et],"mainChannel",Cv(Mv(et.main))),et.light&&Or(Re[Et],"lightChannel",Cv(Mv(et.light))),et.dark&&Or(Re[Et],"darkChannel",Cv(Mv(et.dark))),et.contrastText&&Or(Re[Et],"contrastTextChannel",Cv(Mv(et.contrastText))),Et==="text"&&(Dm(Re[Et],"primary"),Dm(Re[Et],"secondary")),Et==="action"&&(et.active&&Dm(Re[Et],"active"),et.selected&&Dm(Re[Et],"selected")))})}),Be=r.reduce((ht,Re)=>Kc(ht,Re),Be);const Ke={prefix:y,disableCssColorScheme:m,shouldSkipGeneratingVar:i,getSelector:PG(Be),enableContrastVars:T},{vars:st,generateThemeVars:dt,generateStyleSheets:bt}=z$(Be,Ke);return Be.vars=st,Object.entries(Be.colorSchemes[Be.defaultColorScheme]).forEach(([ht,Re])=>{Be[ht]=Re}),Be.generateThemeVars=dt,Be.generateStyleSheets=bt,Be.generateSpacing=function(){return KL(F.spacing,g3(this))},Be.getColorSchemeSelector=L$(z),Be.spacing=Be.generateSpacing(),Be.shouldSkipGeneratingVar=i,Be.unstable_sxConfig={...ux,...F?.unstable_sxConfig},Be.unstable_sx=function(Re){return i0({sx:Re,theme:this})},Be.toRuntimeSource=gB,Be}function jD(e,r,a){e.colorSchemes&&a&&(e.colorSchemes[r]={...a!==!0&&a,palette:T3({...a===!0?{}:a.palette,mode:r})})}function Vw(e={},...r){const{palette:a,cssVariables:l=!1,colorSchemes:m=a?void 0:{light:!0},defaultColorScheme:y=a?.mode,...T}=e,i=y||"light",z=m?.[i],B={...m,...a?{[i]:{...typeof z!="boolean"&&z,palette:a}}:void 0};if(l===!1){if(!("colorSchemes"in e))return HE(e,...r);let F=a;"palette"in e||B[i]&&(B[i]!==!0?F=B[i].palette:i==="dark"&&(F={mode:"dark"}));const G=HE({...e,palette:F},...r);return G.defaultColorScheme=i,G.colorSchemes=B,G.palette.mode==="light"&&(G.colorSchemes.light={...B.light!==!0&&B.light,palette:G.palette},jD(G,"dark",B.dark)),G.palette.mode==="dark"&&(G.colorSchemes.dark={...B.dark!==!0&&B.dark,palette:G.palette},jD(G,"light",B.light)),G}return!a&&!("light"in B)&&i==="light"&&(B.light=!0),kG({...T,colorSchemes:B,defaultColorScheme:i,...typeof l!="boolean"&&l},...r)}const E3=Vw();function ty(){const e=fx(E3);return e[Vp]||e}function vB(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const eu=e=>vB(e)&&e!=="classes",pn=iB({themeId:Vp,defaultTheme:E3,rootShouldForwardProp:eu});function zG({theme:e,...r}){const a=Vp in e?e[Vp]:void 0;return be.jsx(hB,{...r,themeId:a?Vp:void 0,theme:a||e})}const K1={colorSchemeStorageKey:"mui-color-scheme",defaultLightColorScheme:"light",defaultDarkColorScheme:"dark",modeStorageKey:"mui-mode"},{CssVarsProvider:LG}=R$({themeId:Vp,theme:()=>Vw({cssVariables:!0}),colorSchemeStorageKey:K1.colorSchemeStorageKey,modeStorageKey:K1.modeStorageKey,defaultColorScheme:{light:K1.defaultLightColorScheme,dark:K1.defaultDarkColorScheme},resolveTheme:e=>{const r={...e,typography:AB(e.palette,e.typography)};return r.unstable_sx=function(l){return i0({sx:l,theme:this})},r}}),BG=LG;function FG({theme:e,...r}){const a=ae.useMemo(()=>{if(typeof e=="function")return e;const l=Vp in e?e[Vp]:e;return"colorSchemes"in l?null:"vars"in l?e:{...e,vars:null}},[e]);return a?be.jsx(zG,{theme:a,...r}):be.jsx(BG,{theme:e,...r})}function WE(...e){return e.reduce((r,a)=>a==null?r:function(...m){r.apply(this,m),a.apply(this,m)},()=>{})}function NG(e){return be.jsx(JL,{...e,defaultTheme:E3,themeId:Vp})}function jG(e){return function(a){return be.jsx(NG,{styles:typeof e=="function"?l=>e({theme:l,...a}):e})}}function UG(){return v3}const Yi=w$;function Wi(e){return y$(e)}function VG(e){return Bi("MuiSvgIcon",e)}Fi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const $G=e=>{const{color:r,fontSize:a,classes:l}=e,m={root:["root",r!=="inherit"&&`color${sn(r)}`,`fontSize${sn(a)}`]};return Ni(m,VG,l)},GG=pn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.color!=="inherit"&&r[`color${sn(a.color)}`],r[`fontSize${sn(a.fontSize)}`]]}})(Yi(({theme:e})=>({userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:e.transitions?.create?.("fill",{duration:(e.vars??e).transitions?.duration?.shorter}),variants:[{props:r=>!r.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:e.typography?.pxToRem?.(20)||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:e.typography?.pxToRem?.(24)||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:e.typography?.pxToRem?.(35)||"2.1875rem"}},...Object.entries((e.vars??e).palette).filter(([,r])=>r&&r.main).map(([r])=>({props:{color:r},style:{color:(e.vars??e).palette?.[r]?.main}})),{props:{color:"action"},style:{color:(e.vars??e).palette?.action?.active}},{props:{color:"disabled"},style:{color:(e.vars??e).palette?.action?.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}))),ZE=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiSvgIcon"}),{children:m,className:y,color:T="inherit",component:i="svg",fontSize:z="medium",htmlColor:B,inheritViewBox:F=!1,titleAccess:G,viewBox:Q="0 0 24 24",...te}=l,ne=ae.isValidElement(m)&&m.type==="svg",oe={...l,color:T,component:i,fontSize:z,instanceFontSize:r.fontSize,inheritViewBox:F,viewBox:Q,hasSvgAsChild:ne},ue={};F||(ue.viewBox=Q);const ye=$G(oe);return be.jsxs(GG,{as:i,className:on(ye.root,y),focusable:"false",color:B,"aria-hidden":G?void 0:!0,role:G?"img":void 0,ref:a,...ue,...te,...ne&&m.props,ownerState:oe,children:[ne?m.props.children:m,G?be.jsx("title",{children:G}):null]})});ZE.muiName="SvgIcon";function Fl(e,r){function a(l,m){return be.jsx(ZE,{"data-testid":void 0,ref:m,...l,children:e})}return a.muiName=ZE.muiName,ae.memo(ae.forwardRef(a))}function C3(e,r=166){let a;function l(...m){const y=()=>{e.apply(this,m)};clearTimeout(a),a=setTimeout(y,r)}return l.clear=()=>{clearTimeout(a)},l}function Wd(e){return e&&e.ownerDocument||document}function Zd(e){return Wd(e).defaultView||window}function UD(e,r){typeof e=="function"?e(r):e&&(e.current=r)}function Hv(e){const{controlled:r,default:a,name:l,state:m="value"}=e,{current:y}=ae.useRef(r!==void 0),[T,i]=ae.useState(a),z=y?r:T,B=ae.useCallback(F=>{y||i(F)},[]);return[z,B]}function ug(e){const r=ae.useRef(e);return Hp(()=>{r.current=e}),ae.useRef((...a)=>(0,r.current)(...a)).current}function rc(...e){const r=ae.useRef(void 0),a=ae.useCallback(l=>{const m=e.map(y=>{if(y==null)return null;if(typeof y=="function"){const T=y,i=T(l);return typeof i=="function"?i:()=>{T(null)}}return y.current=l,()=>{y.current=null}});return()=>{m.forEach(y=>y?.())}},e);return ae.useMemo(()=>e.every(l=>l==null)?null:l=>{r.current&&(r.current(),r.current=void 0),l!=null&&(r.current=a(l))},e)}function HG(e,r){const a=e.charCodeAt(2);return e[0]==="o"&&e[1]==="n"&&a>=65&&a<=90&&typeof r=="function"}function xB(e,r){if(!e)return r;function a(T,i){const z={};return Object.keys(i).forEach(B=>{HG(B,i[B])&&typeof T[B]=="function"&&(z[B]=(...F)=>{T[B](...F),i[B](...F)})}),z}if(typeof e=="function"||typeof r=="function")return T=>{const i=typeof r=="function"?r(T):r,z=typeof e=="function"?e({...T,...i}):e,B=on(T?.className,i?.className,z?.className),F=a(z,i);return{...i,...z,...F,...!!B&&{className:B},...i?.style&&z?.style&&{style:{...i.style,...z.style}},...i?.sx&&z?.sx&&{sx:[...Array.isArray(i.sx)?i.sx:[i.sx],...Array.isArray(z.sx)?z.sx:[z.sx]]}}};const l=r,m=a(e,l),y=on(l?.className,e?.className);return{...r,...e,...m,...!!y&&{className:y},...l?.style&&e?.style&&{style:{...l.style,...e.style}},...l?.sx&&e?.sx&&{sx:[...Array.isArray(l.sx)?l.sx:[l.sx],...Array.isArray(e.sx)?e.sx:[e.sx]]}}}function bB(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}function XE(e,r){return XE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,l){return a.__proto__=l,a},XE(e,r)}function wB(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,XE(e,r)}var QS={exports:{}},Zc={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VD;function qG(){if(VD)return Zc;VD=1;var e=Y_();function r(z){var B="https://react.dev/errors/"+z;if(1<arguments.length){B+="?args[]="+encodeURIComponent(arguments[1]);for(var F=2;F<arguments.length;F++)B+="&args[]="+encodeURIComponent(arguments[F])}return"Minified React error #"+z+"; visit "+B+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var l={d:{f:a,r:function(){throw Error(r(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},m=Symbol.for("react.portal");function y(z,B,F){var G=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:m,key:G==null?null:""+G,children:z,containerInfo:B,implementation:F}}var T=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function i(z,B){if(z==="font")return"";if(typeof B=="string")return B==="use-credentials"?B:""}return Zc.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=l,Zc.createPortal=function(z,B){var F=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B||B.nodeType!==1&&B.nodeType!==9&&B.nodeType!==11)throw Error(r(299));return y(z,B,null,F)},Zc.flushSync=function(z){var B=T.T,F=l.p;try{if(T.T=null,l.p=2,z)return z()}finally{T.T=B,l.p=F,l.d.f()}},Zc.preconnect=function(z,B){typeof z=="string"&&(B?(B=B.crossOrigin,B=typeof B=="string"?B==="use-credentials"?B:"":void 0):B=null,l.d.C(z,B))},Zc.prefetchDNS=function(z){typeof z=="string"&&l.d.D(z)},Zc.preinit=function(z,B){if(typeof z=="string"&&B&&typeof B.as=="string"){var F=B.as,G=i(F,B.crossOrigin),Q=typeof B.integrity=="string"?B.integrity:void 0,te=typeof B.fetchPriority=="string"?B.fetchPriority:void 0;F==="style"?l.d.S(z,typeof B.precedence=="string"?B.precedence:void 0,{crossOrigin:G,integrity:Q,fetchPriority:te}):F==="script"&&l.d.X(z,{crossOrigin:G,integrity:Q,fetchPriority:te,nonce:typeof B.nonce=="string"?B.nonce:void 0})}},Zc.preinitModule=function(z,B){if(typeof z=="string")if(typeof B=="object"&&B!==null){if(B.as==null||B.as==="script"){var F=i(B.as,B.crossOrigin);l.d.M(z,{crossOrigin:F,integrity:typeof B.integrity=="string"?B.integrity:void 0,nonce:typeof B.nonce=="string"?B.nonce:void 0})}}else B==null&&l.d.M(z)},Zc.preload=function(z,B){if(typeof z=="string"&&typeof B=="object"&&B!==null&&typeof B.as=="string"){var F=B.as,G=i(F,B.crossOrigin);l.d.L(z,F,{crossOrigin:G,integrity:typeof B.integrity=="string"?B.integrity:void 0,nonce:typeof B.nonce=="string"?B.nonce:void 0,type:typeof B.type=="string"?B.type:void 0,fetchPriority:typeof B.fetchPriority=="string"?B.fetchPriority:void 0,referrerPolicy:typeof B.referrerPolicy=="string"?B.referrerPolicy:void 0,imageSrcSet:typeof B.imageSrcSet=="string"?B.imageSrcSet:void 0,imageSizes:typeof B.imageSizes=="string"?B.imageSizes:void 0,media:typeof B.media=="string"?B.media:void 0})}},Zc.preloadModule=function(z,B){if(typeof z=="string")if(B){var F=i(B.as,B.crossOrigin);l.d.m(z,{as:typeof B.as=="string"&&B.as!=="script"?B.as:void 0,crossOrigin:F,integrity:typeof B.integrity=="string"?B.integrity:void 0})}else l.d.m(z)},Zc.requestFormReset=function(z){l.d.r(z)},Zc.unstable_batchedUpdates=function(z,B){return z(B)},Zc.useFormState=function(z,B,F){return T.H.useFormState(z,B,F)},Zc.useFormStatus=function(){return T.H.useHostTransitionStatus()},Zc.version="19.1.1",Zc}var $D;function SB(){if($D)return QS.exports;$D=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),QS.exports=qG(),QS.exports}var M3=SB();const J1=Zp(M3),GD={disabled:!1},jb=Ko.createContext(null);var WG=function(r){return r.scrollTop},Iv="unmounted",J0="exited",eg="entering",M_="entered",YE="exiting",Xd=(function(e){wB(r,e);function r(l,m){var y;y=e.call(this,l,m)||this;var T=m,i=T&&!T.isMounting?l.enter:l.appear,z;return y.appearStatus=null,l.in?i?(z=J0,y.appearStatus=eg):z=M_:l.unmountOnExit||l.mountOnEnter?z=Iv:z=J0,y.state={status:z},y.nextCallback=null,y}r.getDerivedStateFromProps=function(m,y){var T=m.in;return T&&y.status===Iv?{status:J0}:null};var a=r.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(m){var y=null;if(m!==this.props){var T=this.state.status;this.props.in?T!==eg&&T!==M_&&(y=eg):(T===eg||T===M_)&&(y=YE)}this.updateStatus(!1,y)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var m=this.props.timeout,y,T,i;return y=T=i=m,m!=null&&typeof m!="number"&&(y=m.exit,T=m.enter,i=m.appear!==void 0?m.appear:T),{exit:y,enter:T,appear:i}},a.updateStatus=function(m,y){if(m===void 0&&(m=!1),y!==null)if(this.cancelNextCallback(),y===eg){if(this.props.unmountOnExit||this.props.mountOnEnter){var T=this.props.nodeRef?this.props.nodeRef.current:J1.findDOMNode(this);T&&WG(T)}this.performEnter(m)}else this.performExit();else this.props.unmountOnExit&&this.state.status===J0&&this.setState({status:Iv})},a.performEnter=function(m){var y=this,T=this.props.enter,i=this.context?this.context.isMounting:m,z=this.props.nodeRef?[i]:[J1.findDOMNode(this),i],B=z[0],F=z[1],G=this.getTimeouts(),Q=i?G.appear:G.enter;if(!m&&!T||GD.disabled){this.safeSetState({status:M_},function(){y.props.onEntered(B)});return}this.props.onEnter(B,F),this.safeSetState({status:eg},function(){y.props.onEntering(B,F),y.onTransitionEnd(Q,function(){y.safeSetState({status:M_},function(){y.props.onEntered(B,F)})})})},a.performExit=function(){var m=this,y=this.props.exit,T=this.getTimeouts(),i=this.props.nodeRef?void 0:J1.findDOMNode(this);if(!y||GD.disabled){this.safeSetState({status:J0},function(){m.props.onExited(i)});return}this.props.onExit(i),this.safeSetState({status:YE},function(){m.props.onExiting(i),m.onTransitionEnd(T.exit,function(){m.safeSetState({status:J0},function(){m.props.onExited(i)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(m,y){y=this.setNextCallback(y),this.setState(m,y)},a.setNextCallback=function(m){var y=this,T=!0;return this.nextCallback=function(i){T&&(T=!1,y.nextCallback=null,m(i))},this.nextCallback.cancel=function(){T=!1},this.nextCallback},a.onTransitionEnd=function(m,y){this.setNextCallback(y);var T=this.props.nodeRef?this.props.nodeRef.current:J1.findDOMNode(this),i=m==null&&!this.props.addEndListener;if(!T||i){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var z=this.props.nodeRef?[this.nextCallback]:[T,this.nextCallback],B=z[0],F=z[1];this.props.addEndListener(B,F)}m!=null&&setTimeout(this.nextCallback,m)},a.render=function(){var m=this.state.status;if(m===Iv)return null;var y=this.props,T=y.children;y.in,y.mountOnEnter,y.unmountOnExit,y.appear,y.enter,y.exit,y.timeout,y.addEndListener,y.onEnter,y.onEntering,y.onEntered,y.onExit,y.onExiting,y.onExited,y.nodeRef;var i=bB(y,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Ko.createElement(jb.Provider,{value:null},typeof T=="function"?T(m,i):Ko.cloneElement(Ko.Children.only(T),i))},r})(Ko.Component);Xd.contextType=jb;Xd.propTypes={};function E_(){}Xd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:E_,onEntering:E_,onEntered:E_,onExit:E_,onExiting:E_,onExited:E_};Xd.UNMOUNTED=Iv;Xd.EXITED=J0;Xd.ENTERING=eg;Xd.ENTERED=M_;Xd.EXITING=YE;function ZG(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I3(e,r){var a=function(y){return r&&ae.isValidElement(y)?r(y):y},l=Object.create(null);return e&&ae.Children.map(e,function(m){return m}).forEach(function(m){l[m.key]=a(m)}),l}function XG(e,r){e=e||{},r=r||{};function a(F){return F in r?r[F]:e[F]}var l=Object.create(null),m=[];for(var y in e)y in r?m.length&&(l[y]=m,m=[]):m.push(y);var T,i={};for(var z in r){if(l[z])for(T=0;T<l[z].length;T++){var B=l[z][T];i[l[z][T]]=a(B)}i[z]=a(z)}for(T=0;T<m.length;T++)i[m[T]]=a(m[T]);return i}function og(e,r,a){return a[r]!=null?a[r]:e.props[r]}function YG(e,r){return I3(e.children,function(a){return ae.cloneElement(a,{onExited:r.bind(null,a),in:!0,appear:og(a,"appear",e),enter:og(a,"enter",e),exit:og(a,"exit",e)})})}function QG(e,r,a){var l=I3(e.children),m=XG(r,l);return Object.keys(m).forEach(function(y){var T=m[y];if(ae.isValidElement(T)){var i=y in r,z=y in l,B=r[y],F=ae.isValidElement(B)&&!B.props.in;z&&(!i||F)?m[y]=ae.cloneElement(T,{onExited:a.bind(null,T),in:!0,exit:og(T,"exit",e),enter:og(T,"enter",e)}):!z&&i&&!F?m[y]=ae.cloneElement(T,{in:!1}):z&&i&&ae.isValidElement(B)&&(m[y]=ae.cloneElement(T,{onExited:a.bind(null,T),in:B.props.in,exit:og(T,"exit",e),enter:og(T,"enter",e)}))}}),m}var KG=Object.values||function(e){return Object.keys(e).map(function(r){return e[r]})},JG={component:"div",childFactory:function(r){return r}},P3=(function(e){wB(r,e);function r(l,m){var y;y=e.call(this,l,m)||this;var T=y.handleExited.bind(ZG(y));return y.state={contextValue:{isMounting:!0},handleExited:T,firstRender:!0},y}var a=r.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},r.getDerivedStateFromProps=function(m,y){var T=y.children,i=y.handleExited,z=y.firstRender;return{children:z?YG(m,i):QG(m,T,i),firstRender:!1}},a.handleExited=function(m,y){var T=I3(this.props.children);m.key in T||(m.props.onExited&&m.props.onExited(y),this.mounted&&this.setState(function(i){var z=kb({},i.children);return delete z[m.key],{children:z}}))},a.render=function(){var m=this.props,y=m.component,T=m.childFactory,i=bB(m,["component","childFactory"]),z=this.state.contextValue,B=KG(this.state.children).map(T);return delete i.appear,delete i.enter,delete i.exit,y===null?Ko.createElement(jb.Provider,{value:z},B):Ko.createElement(jb.Provider,{value:z},Ko.createElement(y,i,B))},r})(Ko.Component);P3.propTypes={};P3.defaultProps=JG;const HD={};function TB(e,r){const a=ae.useRef(HD);return a.current===HD&&(a.current=e(r)),a}const eH=[];function tH(e){ae.useEffect(e,eH)}class R3{static create(){return new R3}currentId=null;start(r,a){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,a()},r)}clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)};disposeEffect=()=>this.clear}function EB(){const e=TB(R3.create).current;return tH(e.disposeEffect),e}const D3=e=>e.scrollTop;function F_(e,r){const{timeout:a,easing:l,style:m={}}=e;return{duration:m.transitionDuration??(typeof a=="number"?a:a[r.mode]||0),easing:m.transitionTimingFunction??(typeof l=="object"?l[r.mode]:l),delay:m.transitionDelay}}function rH(e){return Bi("MuiPaper",e)}Fi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const nH=e=>{const{square:r,elevation:a,variant:l,classes:m}=e,y={root:["root",l,!r&&"rounded",l==="elevation"&&`elevation${a}`]};return Ni(y,rH,m)},iH=pn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],!a.square&&r.rounded,a.variant==="elevation"&&r[`elevation${a.elevation}`]]}})(Yi(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow"),variants:[{props:({ownerState:r})=>!r.square,style:{borderRadius:e.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(e.vars||e).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),dx=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiPaper"}),m=ty(),{className:y,component:T="div",elevation:i=1,square:z=!1,variant:B="elevation",...F}=l,G={...l,component:T,elevation:i,square:z,variant:B},Q=nH(G);return be.jsx(iH,{as:T,ownerState:G,className:on(Q.root,y),ref:a,...F,style:{...B==="elevation"&&{"--Paper-shadow":(m.vars||m).shadows[i],...m.vars&&{"--Paper-overlay":m.vars.overlays?.[i]},...!m.vars&&m.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Fb("#fff",qE(i))}, ${Fb("#fff",qE(i))})`}},...F.style}})});function N_(e){return typeof e=="string"}function CB(e,r,a){return e===void 0||N_(e)?r:{...r,ownerState:{...r.ownerState,...a}}}function MB(e,r,a){return typeof e=="function"?e(r,a):e}function IB(e,r=[]){if(e===void 0)return{};const a={};return Object.keys(e).filter(l=>l.match(/^on[A-Z]/)&&typeof e[l]=="function"&&!r.includes(l)).forEach(l=>{a[l]=e[l]}),a}function qD(e){if(e===void 0)return{};const r={};return Object.keys(e).filter(a=>!(a.match(/^on[A-Z]/)&&typeof e[a]=="function")).forEach(a=>{r[a]=e[a]}),r}function PB(e){const{getSlotProps:r,additionalProps:a,externalSlotProps:l,externalForwardedProps:m,className:y}=e;if(!r){const te=on(a?.className,y,m?.className,l?.className),ne={...a?.style,...m?.style,...l?.style},oe={...a,...m,...l};return te.length>0&&(oe.className=te),Object.keys(ne).length>0&&(oe.style=ne),{props:oe,internalRef:void 0}}const T=IB({...m,...l}),i=qD(l),z=qD(m),B=r(T),F=on(B?.className,a?.className,y,m?.className,l?.className),G={...B?.style,...a?.style,...m?.style,...l?.style},Q={...B,...a,...z,...i};return F.length>0&&(Q.className=F),Object.keys(G).length>0&&(Q.style=G),{props:Q,internalRef:B.ref}}function pa(e,r){const{className:a,elementType:l,ownerState:m,externalForwardedProps:y,internalForwardedProps:T,shouldForwardComponentProp:i=!1,...z}=r,{component:B,slots:F={[e]:void 0},slotProps:G={[e]:void 0},...Q}=y,te=F[e]||l,ne=MB(G[e],m),{props:{component:oe,...ue},internalRef:ye}=PB({className:a,...z,externalForwardedProps:e==="root"?Q:void 0,externalSlotProps:ne}),we=rc(ye,ne?.ref,r.ref),ve=e==="root"?oe||B:oe,Ce=CB(te,{...e==="root"&&!B&&!F[e]&&T,...e!=="root"&&!F[e]&&T,...ue,...ve&&!i&&{as:ve},...ve&&i&&{component:ve},ref:we},m);return[te,Ce]}function WD(e){try{return e.matches(":focus-visible")}catch{}return!1}class Ub{static create(){return new Ub}static use(){const r=TB(Ub.create).current,[a,l]=ae.useState(!1);return r.shouldMount=a,r.setShouldMount=l,ae.useEffect(r.mountEffect,[a]),r}constructor(){this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}mount(){return this.mounted||(this.mounted=aH(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}mountEffect=()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())};start(...r){this.mount().then(()=>this.ref.current?.start(...r))}stop(...r){this.mount().then(()=>this.ref.current?.stop(...r))}pulsate(...r){this.mount().then(()=>this.ref.current?.pulsate(...r))}}function oH(){return Ub.use()}function aH(){let e,r;const a=new Promise((l,m)=>{e=l,r=m});return a.resolve=e,a.reject=r,a}function sH(e){const{className:r,classes:a,pulsate:l=!1,rippleX:m,rippleY:y,rippleSize:T,in:i,onExited:z,timeout:B}=e,[F,G]=ae.useState(!1),Q=on(r,a.ripple,a.rippleVisible,l&&a.ripplePulsate),te={width:T,height:T,top:-(T/2)+y,left:-(T/2)+m},ne=on(a.child,F&&a.childLeaving,l&&a.childPulsate);return!i&&!F&&G(!0),ae.useEffect(()=>{if(!i&&z!=null){const oe=setTimeout(z,B);return()=>{clearTimeout(oe)}}},[z,i,B]),be.jsx("span",{className:Q,style:te,children:be.jsx("span",{className:ne})})}const rd=Fi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),QE=550,lH=80,cH=l0`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,uH=l0`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,hH=l0`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,fH=pn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),dH=pn(sH,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${rd.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${cH};
    animation-duration: ${QE}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  &.${rd.ripplePulsate} {
    animation-duration: ${({theme:e})=>e.transitions.duration.shorter}ms;
  }

  & .${rd.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${rd.childLeaving} {
    opacity: 0;
    animation-name: ${uH};
    animation-duration: ${QE}ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
  }

  & .${rd.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${hH};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:e})=>e.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,pH=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTouchRipple"}),{center:m=!1,classes:y={},className:T,...i}=l,[z,B]=ae.useState([]),F=ae.useRef(0),G=ae.useRef(null);ae.useEffect(()=>{G.current&&(G.current(),G.current=null)},[z]);const Q=ae.useRef(!1),te=EB(),ne=ae.useRef(null),oe=ae.useRef(null),ue=ae.useCallback(Ce=>{const{pulsate:Ee,rippleX:Be,rippleY:Ke,rippleSize:st,cb:dt}=Ce;B(bt=>[...bt,be.jsx(dH,{classes:{ripple:on(y.ripple,rd.ripple),rippleVisible:on(y.rippleVisible,rd.rippleVisible),ripplePulsate:on(y.ripplePulsate,rd.ripplePulsate),child:on(y.child,rd.child),childLeaving:on(y.childLeaving,rd.childLeaving),childPulsate:on(y.childPulsate,rd.childPulsate)},timeout:QE,pulsate:Ee,rippleX:Be,rippleY:Ke,rippleSize:st},F.current)]),F.current+=1,G.current=dt},[y]),ye=ae.useCallback((Ce={},Ee={},Be=()=>{})=>{const{pulsate:Ke=!1,center:st=m||Ee.pulsate,fakeElement:dt=!1}=Ee;if(Ce?.type==="mousedown"&&Q.current){Q.current=!1;return}Ce?.type==="touchstart"&&(Q.current=!0);const bt=dt?null:oe.current,ht=bt?bt.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Re,Pt,wt;if(st||Ce===void 0||Ce.clientX===0&&Ce.clientY===0||!Ce.clientX&&!Ce.touches)Re=Math.round(ht.width/2),Pt=Math.round(ht.height/2);else{const{clientX:Et,clientY:et}=Ce.touches&&Ce.touches.length>0?Ce.touches[0]:Ce;Re=Math.round(Et-ht.left),Pt=Math.round(et-ht.top)}if(st)wt=Math.sqrt((2*ht.width**2+ht.height**2)/3),wt%2===0&&(wt+=1);else{const Et=Math.max(Math.abs((bt?bt.clientWidth:0)-Re),Re)*2+2,et=Math.max(Math.abs((bt?bt.clientHeight:0)-Pt),Pt)*2+2;wt=Math.sqrt(Et**2+et**2)}Ce?.touches?ne.current===null&&(ne.current=()=>{ue({pulsate:Ke,rippleX:Re,rippleY:Pt,rippleSize:wt,cb:Be})},te.start(lH,()=>{ne.current&&(ne.current(),ne.current=null)})):ue({pulsate:Ke,rippleX:Re,rippleY:Pt,rippleSize:wt,cb:Be})},[m,ue,te]),we=ae.useCallback(()=>{ye({},{pulsate:!0})},[ye]),ve=ae.useCallback((Ce,Ee)=>{if(te.clear(),Ce?.type==="touchend"&&ne.current){ne.current(),ne.current=null,te.start(0,()=>{ve(Ce,Ee)});return}ne.current=null,B(Be=>Be.length>0?Be.slice(1):Be),G.current=Ee},[te]);return ae.useImperativeHandle(a,()=>({pulsate:we,start:ye,stop:ve}),[we,ye,ve]),be.jsx(fH,{className:on(rd.root,y.root,T),ref:oe,...i,children:be.jsx(P3,{component:null,exit:!0,children:z})})});function mH(e){return Bi("MuiButtonBase",e)}const AH=Fi("MuiButtonBase",["root","disabled","focusVisible"]),gH=e=>{const{disabled:r,focusVisible:a,focusVisibleClassName:l,classes:m}=e,T=Ni({root:["root",r&&"disabled",a&&"focusVisible"]},mH,m);return a&&l&&(T.root+=` ${l}`),T},_H=pn("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${AH.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),px=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiButtonBase"}),{action:m,centerRipple:y=!1,children:T,className:i,component:z="button",disabled:B=!1,disableRipple:F=!1,disableTouchRipple:G=!1,focusRipple:Q=!1,focusVisibleClassName:te,LinkComponent:ne="a",onBlur:oe,onClick:ue,onContextMenu:ye,onDragLeave:we,onFocus:ve,onFocusVisible:Ce,onKeyDown:Ee,onKeyUp:Be,onMouseDown:Ke,onMouseLeave:st,onMouseUp:dt,onTouchEnd:bt,onTouchMove:ht,onTouchStart:Re,tabIndex:Pt=0,TouchRippleProps:wt,touchRippleRef:Et,type:et,...Zt}=l,ir=ae.useRef(null),or=oH(),ft=rc(or.ref,Et),[Vt,Jt]=ae.useState(!1);B&&Vt&&Jt(!1),ae.useImperativeHandle(m,()=>({focusVisible:()=>{Jt(!0),ir.current.focus()}}),[]);const Cr=or.shouldMount&&!F&&!B;ae.useEffect(()=>{Vt&&Q&&!F&&or.pulsate()},[F,Q,Vt,or]);const ln=Om(or,"start",Ke,G),tn=Om(or,"stop",ye,G),Hr=Om(or,"stop",we,G),Nn=Om(or,"stop",dt,G),jn=Om(or,"stop",Bn=>{Vt&&Bn.preventDefault(),st&&st(Bn)},G),Ur=Om(or,"start",Re,G),Gr=Om(or,"stop",bt,G),Sn=Om(or,"stop",ht,G),Tr=Om(or,"stop",Bn=>{WD(Bn.target)||Jt(!1),oe&&oe(Bn)},!1),Zi=ug(Bn=>{ir.current||(ir.current=Bn.currentTarget),WD(Bn.target)&&(Jt(!0),Ce&&Ce(Bn)),ve&&ve(Bn)}),wn=()=>{const Bn=ir.current;return z&&z!=="button"&&!(Bn.tagName==="A"&&Bn.href)},Rn=ug(Bn=>{Q&&!Bn.repeat&&Vt&&Bn.key===" "&&or.stop(Bn,()=>{or.start(Bn)}),Bn.target===Bn.currentTarget&&wn()&&Bn.key===" "&&Bn.preventDefault(),Ee&&Ee(Bn),Bn.target===Bn.currentTarget&&wn()&&Bn.key==="Enter"&&!B&&(Bn.preventDefault(),ue&&ue(Bn))}),mo=ug(Bn=>{Q&&Bn.key===" "&&Vt&&!Bn.defaultPrevented&&or.stop(Bn,()=>{or.pulsate(Bn)}),Be&&Be(Bn),ue&&Bn.target===Bn.currentTarget&&wn()&&Bn.key===" "&&!Bn.defaultPrevented&&ue(Bn)});let di=z;di==="button"&&(Zt.href||Zt.to)&&(di=ne);const Ao={};di==="button"?(Ao.type=et===void 0?"button":et,Ao.disabled=B):(!Zt.href&&!Zt.to&&(Ao.role="button"),B&&(Ao["aria-disabled"]=B));const eo=rc(a,ir),$o={...l,centerRipple:y,component:z,disabled:B,disableRipple:F,disableTouchRipple:G,focusRipple:Q,tabIndex:Pt,focusVisible:Vt},_i=gH($o);return be.jsxs(_H,{as:di,className:on(_i.root,i),ownerState:$o,onBlur:Tr,onClick:ue,onContextMenu:tn,onFocus:Zi,onKeyDown:Rn,onKeyUp:mo,onMouseDown:ln,onMouseLeave:jn,onMouseUp:Nn,onDragLeave:Hr,onTouchEnd:Gr,onTouchMove:Sn,onTouchStart:Ur,ref:eo,tabIndex:B?-1:Pt,type:et,...Ao,...Zt,children:[T,Cr?be.jsx(pH,{ref:ft,center:y,...wt}):null]})});function Om(e,r,a,l=!1){return ug(m=>(a&&a(m),l||e[r](m),!0))}function yH(e){return typeof e.main=="string"}function vH(e,r=[]){if(!yH(e))return!1;for(const a of r)if(!e.hasOwnProperty(a)||typeof e[a]!="string")return!1;return!0}function rl(e=[]){return([,r])=>r&&vH(r,e)}function xH(e){return Bi("MuiCircularProgress",e)}Fi("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const QA=44,KE=l0`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,JE=l0`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,bH=typeof KE!="string"?K_`
        animation: ${KE} 1.4s linear infinite;
      `:null,wH=typeof JE!="string"?K_`
        animation: ${JE} 1.4s ease-in-out infinite;
      `:null,SH=e=>{const{classes:r,variant:a,color:l,disableShrink:m}=e,y={root:["root",a,`color${sn(l)}`],svg:["svg"],circle:["circle",`circle${sn(a)}`,m&&"circleDisableShrink"]};return Ni(y,xH,r)},TH=pn("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`color${sn(a.color)}`]]}})(Yi(({theme:e})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("transform")}},{props:{variant:"indeterminate"},style:bH||{animation:`${KE} 1.4s linear infinite`}},...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}}))]}))),EH=pn("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),CH=pn("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.circle,r[`circle${sn(a.variant)}`],a.disableShrink&&r.circleDisableShrink]}})(Yi(({theme:e})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:e.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:r})=>r.variant==="indeterminate"&&!r.disableShrink,style:wH||{animation:`${JE} 1.4s ease-in-out infinite`}}]}))),c0=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiCircularProgress"}),{className:m,color:y="primary",disableShrink:T=!1,size:i=40,style:z,thickness:B=3.6,value:F=0,variant:G="indeterminate",...Q}=l,te={...l,color:y,disableShrink:T,size:i,thickness:B,value:F,variant:G},ne=SH(te),oe={},ue={},ye={};if(G==="determinate"){const we=2*Math.PI*((QA-B)/2);oe.strokeDasharray=we.toFixed(3),ye["aria-valuenow"]=Math.round(F),oe.strokeDashoffset=`${((100-F)/100*we).toFixed(3)}px`,ue.transform="rotate(-90deg)"}return be.jsx(TH,{className:on(ne.root,m),style:{width:i,height:i,...ue,...z},ownerState:te,ref:a,role:"progressbar",...ye,...Q,children:be.jsx(EH,{className:ne.svg,ownerState:te,viewBox:`${QA/2} ${QA/2} ${QA} ${QA}`,children:be.jsx(CH,{className:ne.circle,style:oe,ownerState:te,cx:QA,cy:QA,r:(QA-B)/2,fill:"none",strokeWidth:B})})})});function MH(e){return Bi("MuiIconButton",e)}const ZD=Fi("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),IH=e=>{const{classes:r,disabled:a,color:l,edge:m,size:y,loading:T}=e,i={root:["root",T&&"loading",a&&"disabled",l!=="default"&&`color${sn(l)}`,m&&`edge${sn(m)}`,`size${sn(y)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Ni(i,MH,r)},PH=pn(px,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.loading&&r.loading,a.color!=="default"&&r[`color${sn(a.color)}`],a.edge&&r[`edge${sn(a.edge)}`],r[`size${sn(a.size)}`]]}})(Yi(({theme:e})=>({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),variants:[{props:r=>!r.disableRipple,style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),Yi(({theme:e})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}})),...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{"--IconButton-hoverBg":e.alpha((e.vars||e).palette[r].main,(e.vars||e).palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:e.typography.pxToRem(28)}}],[`&.${ZD.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled},[`&.${ZD.loading}`]:{color:"transparent"}}))),RH=pn("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(e.vars||e).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),DH=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiIconButton"}),{edge:m=!1,children:y,className:T,color:i="default",disabled:z=!1,disableFocusRipple:B=!1,size:F="medium",id:G,loading:Q=null,loadingIndicator:te,...ne}=l,oe=J_(G),ue=te??be.jsx(c0,{"aria-labelledby":oe,color:"inherit",size:16}),ye={...l,edge:m,color:i,disabled:z,disableFocusRipple:B,loading:Q,loadingIndicator:ue,size:F},we=IH(ye);return be.jsxs(PH,{id:Q?oe:G,className:on(we.root,T),centerRipple:!0,focusRipple:!B,disabled:z||Q,ref:a,...ne,ownerState:ye,children:[typeof Q=="boolean"&&be.jsx("span",{className:we.loadingWrapper,style:{display:"contents"},children:be.jsx(RH,{className:we.loadingIndicator,ownerState:ye,children:Q&&ue})}),y]})});function OH(e){return Bi("MuiTypography",e)}const XD=Fi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]),kH={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},zH=UG(),LH=e=>{const{align:r,gutterBottom:a,noWrap:l,paragraph:m,variant:y,classes:T}=e,i={root:["root",y,e.align!=="inherit"&&`align${sn(r)}`,a&&"gutterBottom",l&&"noWrap",m&&"paragraph"]};return Ni(i,OH,T)},BH=pn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.variant&&r[a.variant],a.align!=="inherit"&&r[`align${sn(a.align)}`],a.noWrap&&r.noWrap,a.gutterBottom&&r.gutterBottom,a.paragraph&&r.paragraph]}})(Yi(({theme:e})=>({margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(e.typography).filter(([r,a])=>r!=="inherit"&&a&&typeof a=="object").map(([r,a])=>({props:{variant:r},style:a})),...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{color:(e.vars||e).palette[r].main}})),...Object.entries(e.palette?.text||{}).filter(([,r])=>typeof r=="string").map(([r])=>({props:{color:`text${sn(r)}`},style:{color:(e.vars||e).palette.text[r]}})),{props:({ownerState:r})=>r.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:r})=>r.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:r})=>r.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:r})=>r.paragraph,style:{marginBottom:16}}]}))),YD={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},tl=ae.forwardRef(function(r,a){const{color:l,...m}=Wi({props:r,name:"MuiTypography"}),y=!kH[l],T=zH({...m,...y&&{color:l}}),{align:i="inherit",className:z,component:B,gutterBottom:F=!1,noWrap:G=!1,paragraph:Q=!1,variant:te="body1",variantMapping:ne=YD,...oe}=T,ue={...T,align:i,color:l,className:z,component:B,gutterBottom:F,noWrap:G,paragraph:Q,variant:te,variantMapping:ne},ye=B||(Q?"p":ne[te]||YD[te])||"span",we=LH(ue);return be.jsx(BH,{as:ye,ref:a,className:on(we.root,z),...oe,ownerState:ue,style:{...i!=="inherit"&&{"--Typography-textAlign":i},...oe.style}})});function FH(e){return Bi("MuiAppBar",e)}Fi("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const NH=e=>{const{color:r,position:a,classes:l}=e,m={root:["root",`color${sn(r)}`,`position${sn(a)}`]};return Ni(m,FH,l)},QD=(e,r)=>e?`${e?.replace(")","")}, ${r})`:r,jH=pn(dx,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`position${sn(a.position)}`],r[`color${sn(a.color)}`]]}})(Yi(({theme:e})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":e.vars?e.vars.palette.AppBar.defaultBg:e.palette.grey[100],"--AppBar-color":e.vars?e.vars.palette.text.primary:e.palette.getContrastText(e.palette.grey[100]),...e.applyStyles("dark",{"--AppBar-background":e.vars?e.vars.palette.AppBar.defaultBg:e.palette.grey[900],"--AppBar-color":e.vars?e.vars.palette.text.primary:e.palette.getContrastText(e.palette.grey[900])})}},...Object.entries(e.palette).filter(rl(["contrastText"])).map(([r])=>({props:{color:r},style:{"--AppBar-background":(e.vars??e).palette[r].main,"--AppBar-color":(e.vars??e).palette[r].contrastText}})),{props:r=>r.enableColorOnDark===!0&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:r=>r.enableColorOnDark===!1&&!["inherit","transparent"].includes(r.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...e.applyStyles("dark",{backgroundColor:e.vars?QD(e.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:e.vars?QD(e.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...e.applyStyles("dark",{backgroundImage:"none"})}}]}))),UH=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiAppBar"}),{className:m,color:y="primary",enableColorOnDark:T=!1,position:i="fixed",...z}=l,B={...l,color:y,position:i,enableColorOnDark:T},F=NH(B);return be.jsx(jH,{square:!0,component:"header",ownerState:B,elevation:4,className:on(F.root,m,i==="fixed"&&"mui-fixed"),ref:a,...z})});function VH(e){const{elementType:r,externalSlotProps:a,ownerState:l,skipResolvingSlotProps:m=!1,...y}=e,T=m?{}:MB(a,l),{props:i,internalRef:z}=PB({...y,externalSlotProps:T}),B=rc(z,T?.ref,e.additionalProps?.ref);return CB(r,{...i,ref:B},l)}function ry(e){return parseInt(ae.version,10)>=19?e?.props?.ref||null:e?.ref||null}function $H(e){return typeof e=="function"?e():e}const GH=ae.forwardRef(function(r,a){const{children:l,container:m,disablePortal:y=!1}=r,[T,i]=ae.useState(null),z=rc(ae.isValidElement(l)?ry(l):null,a);if(Hp(()=>{y||i($H(m)||document.body)},[m,y]),Hp(()=>{if(T&&!y)return UD(a,T),()=>{UD(a,null)}},[a,T,y]),y){if(ae.isValidElement(l)){const B={ref:z};return ae.cloneElement(l,B)}return l}return T&&M3.createPortal(l,T)});function eb(e){return parseInt(e,10)||0}const HH={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function qH(e){for(const r in e)return!1;return!0}function KD(e){return qH(e)||e.outerHeightStyle===0&&!e.overflowing}const WH=ae.forwardRef(function(r,a){const{onChange:l,maxRows:m,minRows:y=1,style:T,value:i,...z}=r,{current:B}=ae.useRef(i!=null),F=ae.useRef(null),G=rc(a,F),Q=ae.useRef(null),te=ae.useRef(null),ne=ae.useCallback(()=>{const ve=F.current,Ce=te.current;if(!ve||!Ce)return;const Be=Zd(ve).getComputedStyle(ve);if(Be.width==="0px")return{outerHeightStyle:0,overflowing:!1};Ce.style.width=Be.width,Ce.value=ve.value||r.placeholder||"x",Ce.value.slice(-1)===`
`&&(Ce.value+=" ");const Ke=Be.boxSizing,st=eb(Be.paddingBottom)+eb(Be.paddingTop),dt=eb(Be.borderBottomWidth)+eb(Be.borderTopWidth),bt=Ce.scrollHeight;Ce.value="x";const ht=Ce.scrollHeight;let Re=bt;y&&(Re=Math.max(Number(y)*ht,Re)),m&&(Re=Math.min(Number(m)*ht,Re)),Re=Math.max(Re,ht);const Pt=Re+(Ke==="border-box"?st+dt:0),wt=Math.abs(Re-bt)<=1;return{outerHeightStyle:Pt,overflowing:wt}},[m,y,r.placeholder]),oe=ug(()=>{const ve=F.current,Ce=ne();if(!ve||!Ce||KD(Ce))return!1;const Ee=Ce.outerHeightStyle;return Q.current!=null&&Q.current!==Ee}),ue=ae.useCallback(()=>{const ve=F.current,Ce=ne();if(!ve||!Ce||KD(Ce))return;const Ee=Ce.outerHeightStyle;Q.current!==Ee&&(Q.current=Ee,ve.style.height=`${Ee}px`),ve.style.overflow=Ce.overflowing?"hidden":""},[ne]),ye=ae.useRef(-1);Hp(()=>{const ve=C3(ue),Ce=F?.current;if(!Ce)return;const Ee=Zd(Ce);Ee.addEventListener("resize",ve);let Be;return typeof ResizeObserver<"u"&&(Be=new ResizeObserver(()=>{oe()&&(Be.unobserve(Ce),cancelAnimationFrame(ye.current),ue(),ye.current=requestAnimationFrame(()=>{Be.observe(Ce)}))}),Be.observe(Ce)),()=>{ve.clear(),cancelAnimationFrame(ye.current),Ee.removeEventListener("resize",ve),Be&&Be.disconnect()}},[ne,ue,oe]),Hp(()=>{ue()});const we=ve=>{B||ue();const Ce=ve.target,Ee=Ce.value.length,Be=Ce.value.endsWith(`
`),Ke=Ce.selectionStart===Ee;Be&&Ke&&Ce.setSelectionRange(Ee,Ee),l&&l(ve)};return be.jsxs(ae.Fragment,{children:[be.jsx("textarea",{value:i,onChange:we,ref:G,rows:y,style:T,...z}),be.jsx("textarea",{"aria-hidden":!0,className:r.className,readOnly:!0,ref:te,tabIndex:-1,style:{...HH.shadow,...T,paddingTop:0,paddingBottom:0}})]})});function u0({props:e,states:r,muiFormControl:a}){return r.reduce((l,m)=>(l[m]=e[m],a&&typeof e[m]>"u"&&(l[m]=a[m]),l),{})}const $w=ae.createContext(void 0);function Yd(){return ae.useContext($w)}function JD(e){return e!=null&&!(Array.isArray(e)&&e.length===0)}function Vb(e,r=!1){return e&&(JD(e.value)&&e.value!==""||r&&JD(e.defaultValue)&&e.defaultValue!=="")}function ZH(e){return e.startAdornment}function XH(e){return Bi("MuiInputBase",e)}const j_=Fi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]);var eO;const Gw=(e,r)=>{const{ownerState:a}=e;return[r.root,a.formControl&&r.formControl,a.startAdornment&&r.adornedStart,a.endAdornment&&r.adornedEnd,a.error&&r.error,a.size==="small"&&r.sizeSmall,a.multiline&&r.multiline,a.color&&r[`color${sn(a.color)}`],a.fullWidth&&r.fullWidth,a.hiddenLabel&&r.hiddenLabel]},Hw=(e,r)=>{const{ownerState:a}=e;return[r.input,a.size==="small"&&r.inputSizeSmall,a.multiline&&r.inputMultiline,a.type==="search"&&r.inputTypeSearch,a.startAdornment&&r.inputAdornedStart,a.endAdornment&&r.inputAdornedEnd,a.hiddenLabel&&r.inputHiddenLabel]},YH=e=>{const{classes:r,color:a,disabled:l,error:m,endAdornment:y,focused:T,formControl:i,fullWidth:z,hiddenLabel:B,multiline:F,readOnly:G,size:Q,startAdornment:te,type:ne}=e,oe={root:["root",`color${sn(a)}`,l&&"disabled",m&&"error",z&&"fullWidth",T&&"focused",i&&"formControl",Q&&Q!=="medium"&&`size${sn(Q)}`,F&&"multiline",te&&"adornedStart",y&&"adornedEnd",B&&"hiddenLabel",G&&"readOnly"],input:["input",l&&"disabled",ne==="search"&&"inputTypeSearch",F&&"inputMultiline",Q==="small"&&"inputSizeSmall",B&&"inputHiddenLabel",te&&"inputAdornedStart",y&&"inputAdornedEnd",G&&"readOnly"]};return Ni(oe,XH,r)},qw=pn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:Gw})(Yi(({theme:e})=>({...e.typography.body1,color:(e.vars||e).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${j_.disabled}`]:{color:(e.vars||e).palette.text.disabled,cursor:"default"},variants:[{props:({ownerState:r})=>r.multiline,style:{padding:"4px 0 5px"}},{props:({ownerState:r,size:a})=>r.multiline&&a==="small",style:{paddingTop:1}},{props:({ownerState:r})=>r.fullWidth,style:{width:"100%"}}]}))),Ww=pn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Hw})(Yi(({theme:e})=>{const r=e.palette.mode==="light",a={color:"currentColor",...e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5},transition:e.transitions.create("opacity",{duration:e.transitions.duration.shorter})},l={opacity:"0 !important"},m=e.vars?{opacity:e.vars.opacity.inputPlaceholder}:{opacity:r?.42:.5};return{font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%","&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&::-ms-input-placeholder":a,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${j_.formControl} &`]:{"&::-webkit-input-placeholder":l,"&::-moz-placeholder":l,"&::-ms-input-placeholder":l,"&:focus::-webkit-input-placeholder":m,"&:focus::-moz-placeholder":m,"&:focus::-ms-input-placeholder":m},[`&.${j_.disabled}`]:{opacity:1,WebkitTextFillColor:(e.vars||e).palette.text.disabled},variants:[{props:({ownerState:y})=>!y.disableInjectingGlobalStyles,style:{animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}}},{props:{size:"small"},style:{paddingTop:1}},{props:({ownerState:y})=>y.multiline,style:{height:"auto",resize:"none",padding:0,paddingTop:0}},{props:{type:"search"},style:{MozAppearance:"textfield"}}]}})),tO=jG({"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}),O3=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiInputBase"}),{"aria-describedby":m,autoComplete:y,autoFocus:T,className:i,color:z,components:B={},componentsProps:F={},defaultValue:G,disabled:Q,disableInjectingGlobalStyles:te,endAdornment:ne,error:oe,fullWidth:ue=!1,id:ye,inputComponent:we="input",inputProps:ve={},inputRef:Ce,margin:Ee,maxRows:Be,minRows:Ke,multiline:st=!1,name:dt,onBlur:bt,onChange:ht,onClick:Re,onFocus:Pt,onKeyDown:wt,onKeyUp:Et,placeholder:et,readOnly:Zt,renderSuffix:ir,rows:or,size:ft,slotProps:Vt={},slots:Jt={},startAdornment:Cr,type:ln="text",value:tn,...Hr}=l,Nn=ve.value!=null?ve.value:tn,{current:jn}=ae.useRef(Nn!=null),Ur=ae.useRef(),Gr=ae.useCallback(Mi=>{},[]),Sn=rc(Ur,Ce,ve.ref,Gr),[Tr,Zi]=ae.useState(!1),wn=Yd(),Rn=u0({props:l,muiFormControl:wn,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Rn.focused=wn?wn.focused:Tr,ae.useEffect(()=>{!wn&&Q&&Tr&&(Zi(!1),bt&&bt())},[wn,Q,Tr,bt]);const mo=wn&&wn.onFilled,di=wn&&wn.onEmpty,Ao=ae.useCallback(Mi=>{Vb(Mi)?mo&&mo():di&&di()},[mo,di]);Hp(()=>{jn&&Ao({value:Nn})},[Nn,Ao,jn]);const eo=Mi=>{Pt&&Pt(Mi),ve.onFocus&&ve.onFocus(Mi),wn&&wn.onFocus?wn.onFocus(Mi):Zi(!0)},$o=Mi=>{bt&&bt(Mi),ve.onBlur&&ve.onBlur(Mi),wn&&wn.onBlur?wn.onBlur(Mi):Zi(!1)},_i=(Mi,...os)=>{if(!jn){const yl=Mi.target||Ur.current;if(yl==null)throw new Error(Gm(1));Ao({value:yl.value})}ve.onChange&&ve.onChange(Mi,...os),ht&&ht(Mi,...os)};ae.useEffect(()=>{Ao(Ur.current)},[]);const Bn=Mi=>{Ur.current&&Mi.currentTarget===Mi.target&&Ur.current.focus(),Re&&Re(Mi)};let Ca=we,Io=ve;st&&Ca==="input"&&(or?Io={type:void 0,minRows:or,maxRows:or,...Io}:Io={type:void 0,maxRows:Be,minRows:Ke,...Io},Ca=WH);const Qa=Mi=>{Ao(Mi.animationName==="mui-auto-fill-cancel"?Ur.current:{value:"x"})};ae.useEffect(()=>{wn&&wn.setAdornedStart(!!Cr)},[wn,Cr]);const ao={...l,color:Rn.color||"primary",disabled:Rn.disabled,endAdornment:ne,error:Rn.error,focused:Rn.focused,formControl:wn,fullWidth:ue,hiddenLabel:Rn.hiddenLabel,multiline:st,size:Rn.size,startAdornment:Cr,type:ln},ai=YH(ao),Po=Jt.root||B.Root||qw,to=Vt.root||F.root||{},Va=Jt.input||B.Input||Ww;return Io={...Io,...Vt.input??F.input},be.jsxs(ae.Fragment,{children:[!te&&typeof tO=="function"&&(eO||(eO=be.jsx(tO,{}))),be.jsxs(Po,{...to,ref:a,onClick:Bn,...Hr,...!N_(Po)&&{ownerState:{...ao,...to.ownerState}},className:on(ai.root,to.className,i,Zt&&"MuiInputBase-readOnly"),children:[Cr,be.jsx($w.Provider,{value:null,children:be.jsx(Va,{"aria-invalid":Rn.error,"aria-describedby":m,autoComplete:y,autoFocus:T,defaultValue:G,disabled:Rn.disabled,id:ye,onAnimationStart:Qa,name:dt,placeholder:et,readOnly:Zt,required:Rn.required,rows:or,value:Nn,onKeyDown:wt,onKeyUp:Et,type:ln,...Io,...!N_(Va)&&{as:Ca,ownerState:{...ao,...Io.ownerState}},ref:Sn,className:on(ai.input,Io.className,Zt&&"MuiInputBase-readOnly"),onBlur:$o,onChange:_i,onFocus:eo})}),ne,ir?ir({...Rn,startAdornment:Cr}):null]})]})});function QH(e){return Bi("MuiInput",e)}const fv={...j_,...Fi("MuiInput",["root","underline","input"])};function KH(e){return Bi("MuiOutlinedInput",e)}const zp={...j_,...Fi("MuiOutlinedInput",["root","notchedOutline","input"])};function JH(e){return Bi("MuiFilledInput",e)}const Y0={...j_,...Fi("MuiFilledInput",["root","underline","input","adornedStart","adornedEnd","sizeSmall","multiline","hiddenLabel"])},eq=Fl(be.jsx("path",{d:"M7 10l5 5 5-5z"})),tq={entering:{opacity:1},entered:{opacity:1}},rq=ae.forwardRef(function(r,a){const l=ty(),m={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:y,appear:T=!0,children:i,easing:z,in:B,onEnter:F,onEntered:G,onEntering:Q,onExit:te,onExited:ne,onExiting:oe,style:ue,timeout:ye=m,TransitionComponent:we=Xd,...ve}=r,Ce=ae.useRef(null),Ee=rc(Ce,ry(i),a),Be=wt=>Et=>{if(wt){const et=Ce.current;Et===void 0?wt(et):wt(et,Et)}},Ke=Be(Q),st=Be((wt,Et)=>{D3(wt);const et=F_({style:ue,timeout:ye,easing:z},{mode:"enter"});wt.style.webkitTransition=l.transitions.create("opacity",et),wt.style.transition=l.transitions.create("opacity",et),F&&F(wt,Et)}),dt=Be(G),bt=Be(oe),ht=Be(wt=>{const Et=F_({style:ue,timeout:ye,easing:z},{mode:"exit"});wt.style.webkitTransition=l.transitions.create("opacity",Et),wt.style.transition=l.transitions.create("opacity",Et),te&&te(wt)}),Re=Be(ne),Pt=wt=>{y&&y(Ce.current,wt)};return be.jsx(we,{appear:T,in:B,nodeRef:Ce,onEnter:st,onEntered:dt,onEntering:Ke,onExit:ht,onExited:Re,onExiting:bt,addEndListener:Pt,timeout:ye,...ve,children:(wt,{ownerState:Et,...et})=>ae.cloneElement(i,{style:{opacity:0,visibility:wt==="exited"&&!B?"hidden":void 0,...tq[wt],...ue,...i.props.style},ref:Ee,...et})})});function nq(e){return Bi("MuiBackdrop",e)}Fi("MuiBackdrop",["root","invisible"]);const iq=e=>{const{classes:r,invisible:a}=e;return Ni({root:["root",a&&"invisible"]},nq,r)},oq=pn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.invisible&&r.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),aq=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiBackdrop"}),{children:m,className:y,component:T="div",invisible:i=!1,open:z,components:B={},componentsProps:F={},slotProps:G={},slots:Q={},TransitionComponent:te,transitionDuration:ne,...oe}=l,ue={...l,component:T,invisible:i},ye=iq(ue),we={transition:te,root:B.Root,...Q},ve={...F,...G},Ce={component:T,slots:we,slotProps:ve},[Ee,Be]=pa("root",{elementType:oq,externalForwardedProps:Ce,className:on(ye.root,y),ownerState:ue}),[Ke,st]=pa("transition",{elementType:rq,externalForwardedProps:Ce,ownerState:ue});return be.jsx(Ke,{in:z,timeout:ne,...oe,...st,children:be.jsx(Ee,{"aria-hidden":!0,...Be,classes:ye,ref:a,children:m})})}),sq=Fi("MuiBox",["root"]),lq=Vw(),bo=Q9({themeId:Vp,defaultTheme:lq,defaultClassName:sq.root,generateClassName:eB.generate});function cq(e){return Bi("MuiButton",e)}const Q0=Fi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),RB=ae.createContext({}),DB=ae.createContext(void 0),uq=e=>{const{color:r,disableElevation:a,fullWidth:l,size:m,variant:y,loading:T,loadingPosition:i,classes:z}=e,B={root:["root",T&&"loading",y,`${y}${sn(r)}`,`size${sn(m)}`,`${y}Size${sn(m)}`,`color${sn(r)}`,a&&"disableElevation",l&&"fullWidth",T&&`loadingPosition${sn(i)}`],startIcon:["icon","startIcon",`iconSize${sn(m)}`],endIcon:["icon","endIcon",`iconSize${sn(m)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},F=Ni(B,cq,z);return{...z,...F}},OB=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],hq=pn(px,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`${a.variant}${sn(a.color)}`],r[`size${sn(a.size)}`],r[`${a.variant}Size${sn(a.size)}`],a.color==="inherit"&&r.colorInherit,a.disableElevation&&r.disableElevation,a.fullWidth&&r.fullWidth,a.loading&&r.loading]}})(Yi(({theme:e})=>{const r=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],a=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return{...e.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${Q0.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(e.vars||e).shadows[2],"&:hover":{boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2]}},"&:active":{boxShadow:(e.vars||e).shadows[8]},[`&.${Q0.focusVisible}`]:{boxShadow:(e.vars||e).shadows[6]},[`&.${Q0.disabled}`]:{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${Q0.disabled}`]:{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(e.palette).filter(rl()).map(([l])=>({props:{color:l},style:{"--variant-textColor":(e.vars||e).palette[l].main,"--variant-outlinedColor":(e.vars||e).palette[l].main,"--variant-outlinedBorder":e.alpha((e.vars||e).palette[l].main,.5),"--variant-containedColor":(e.vars||e).palette[l].contrastText,"--variant-containedBg":(e.vars||e).palette[l].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(e.vars||e).palette[l].dark,"--variant-textBg":e.alpha((e.vars||e).palette[l].main,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBorder":(e.vars||e).palette[l].main,"--variant-outlinedBg":e.alpha((e.vars||e).palette[l].main,(e.vars||e).palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedBg:r,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":e.vars?e.vars.palette.Button.inheritContainedHoverBg:a,"--variant-textBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"--variant-outlinedBg":e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Q0.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Q0.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:e.transitions.create(["background-color","box-shadow","border-color"],{duration:e.transitions.duration.short}),[`&.${Q0.loading}`]:{color:"transparent"}}}]}})),fq=pn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.startIcon,a.loading&&r.startIconLoadingStart,r[`iconSize${sn(a.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...OB]})),dq=pn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.endIcon,a.loading&&r.endIconLoadingEnd,r[`iconSize${sn(a.size)}`]]}})(({theme:e})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:e.transitions.create(["opacity"],{duration:e.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...OB]})),pq=pn("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:e})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(e.vars||e).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),rO=pn("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Tf=ae.forwardRef(function(r,a){const l=ae.useContext(RB),m=ae.useContext(DB),y=Gv(l,r),T=Wi({props:y,name:"MuiButton"}),{children:i,color:z="primary",component:B="button",className:F,disabled:G=!1,disableElevation:Q=!1,disableFocusRipple:te=!1,endIcon:ne,focusVisibleClassName:oe,fullWidth:ue=!1,id:ye,loading:we=null,loadingIndicator:ve,loadingPosition:Ce="center",size:Ee="medium",startIcon:Be,type:Ke,variant:st="text",...dt}=T,bt=J_(ye),ht=ve??be.jsx(c0,{"aria-labelledby":bt,color:"inherit",size:16}),Re={...T,color:z,component:B,disabled:G,disableElevation:Q,disableFocusRipple:te,fullWidth:ue,loading:we,loadingIndicator:ht,loadingPosition:Ce,size:Ee,type:Ke,variant:st},Pt=uq(Re),wt=(Be||we&&Ce==="start")&&be.jsx(fq,{className:Pt.startIcon,ownerState:Re,children:Be||be.jsx(rO,{className:Pt.loadingIconPlaceholder,ownerState:Re})}),Et=(ne||we&&Ce==="end")&&be.jsx(dq,{className:Pt.endIcon,ownerState:Re,children:ne||be.jsx(rO,{className:Pt.loadingIconPlaceholder,ownerState:Re})}),et=m||"",Zt=typeof we=="boolean"?be.jsx("span",{className:Pt.loadingWrapper,style:{display:"contents"},children:we&&be.jsx(pq,{className:Pt.loadingIndicator,ownerState:Re,children:ht})}):null;return be.jsxs(hq,{ownerState:Re,className:on(l.className,Pt.root,F,et),component:B,disabled:G||we,focusRipple:!te,focusVisibleClassName:on(Pt.focusVisible,oe),ref:a,type:Ke,id:we?bt:ye,...dt,classes:Pt,children:[wt,Ce!=="end"&&Zt,i,Ce==="end"&&Zt,Et]})});function mq(e){return ae.Children.toArray(e).filter(r=>ae.isValidElement(r))}function Aq(e){return Bi("MuiButtonGroup",e)}const xo=Fi("MuiButtonGroup",["root","contained","outlined","text","disableElevation","disabled","firstButton","fullWidth","horizontal","vertical","colorPrimary","colorSecondary","grouped","groupedHorizontal","groupedVertical","groupedText","groupedTextHorizontal","groupedTextVertical","groupedTextPrimary","groupedTextSecondary","groupedOutlined","groupedOutlinedHorizontal","groupedOutlinedVertical","groupedOutlinedPrimary","groupedOutlinedSecondary","groupedContained","groupedContainedHorizontal","groupedContainedVertical","groupedContainedPrimary","groupedContainedSecondary","lastButton","middleButton"]),gq=(e,r)=>{const{ownerState:a}=e;return[{[`& .${xo.grouped}`]:r.grouped},{[`& .${xo.grouped}`]:r[`grouped${sn(a.orientation)}`]},{[`& .${xo.grouped}`]:r[`grouped${sn(a.variant)}`]},{[`& .${xo.grouped}`]:r[`grouped${sn(a.variant)}${sn(a.orientation)}`]},{[`& .${xo.grouped}`]:r[`grouped${sn(a.variant)}${sn(a.color)}`]},{[`& .${xo.firstButton}`]:r.firstButton},{[`& .${xo.lastButton}`]:r.lastButton},{[`& .${xo.middleButton}`]:r.middleButton},r.root,r[a.variant],a.disableElevation===!0&&r.disableElevation,a.fullWidth&&r.fullWidth,a.orientation==="vertical"&&r.vertical]},_q=e=>{const{classes:r,color:a,disabled:l,disableElevation:m,fullWidth:y,orientation:T,variant:i}=e,z={root:["root",i,T,y&&"fullWidth",m&&"disableElevation",`color${sn(a)}`],grouped:["grouped",`grouped${sn(T)}`,`grouped${sn(i)}`,`grouped${sn(i)}${sn(T)}`,`grouped${sn(i)}${sn(a)}`,l&&"disabled"],firstButton:["firstButton"],lastButton:["lastButton"],middleButton:["middleButton"]};return Ni(z,Aq,r)},yq=pn("div",{name:"MuiButtonGroup",slot:"Root",overridesResolver:gq})(Yi(({theme:e})=>({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{variant:"contained"},style:{boxShadow:(e.vars||e).shadows[2]}},{props:{disableElevation:!0},style:{boxShadow:"none"}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{orientation:"vertical"},style:{flexDirection:"column",[`& .${xo.lastButton},& .${xo.middleButton}`]:{borderTopRightRadius:0,borderTopLeftRadius:0},[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderBottomRightRadius:0,borderBottomLeftRadius:0}}},{props:{orientation:"horizontal"},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${xo.lastButton},& .${xo.middleButton}`]:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}},{props:{variant:"text",orientation:"horizontal"},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderRight:e.vars?`1px solid ${e.alpha(e.vars.palette.common.onBackground,.23)}`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${xo.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:"text",orientation:"vertical"},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderBottom:e.vars?`1px solid ${e.alpha(e.vars.palette.common.onBackground,.23)}`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${xo.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(rl()).flatMap(([r])=>[{props:{variant:"text",color:r},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderColor:e.alpha((e.vars||e).palette[r].main,.5)}}}]),{props:{variant:"outlined",orientation:"horizontal"},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderRightColor:"transparent","&:hover":{borderRightColor:"currentColor"}},[`& .${xo.lastButton},& .${xo.middleButton}`]:{marginLeft:-1}}},{props:{variant:"outlined",orientation:"vertical"},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderBottomColor:"transparent","&:hover":{borderBottomColor:"currentColor"}},[`& .${xo.lastButton},& .${xo.middleButton}`]:{marginTop:-1}}},{props:{variant:"contained",orientation:"horizontal"},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderRight:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${xo.disabled}`]:{borderRight:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},{props:{variant:"contained",orientation:"vertical"},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderBottom:`1px solid ${(e.vars||e).palette.grey[400]}`,[`&.${xo.disabled}`]:{borderBottom:`1px solid ${(e.vars||e).palette.action.disabled}`}}}},...Object.entries(e.palette).filter(rl(["dark"])).map(([r])=>({props:{variant:"contained",color:r},style:{[`& .${xo.firstButton},& .${xo.middleButton}`]:{borderColor:(e.vars||e).palette[r].dark}}}))],[`& .${xo.grouped}`]:{minWidth:40,boxShadow:"none",props:{variant:"contained"},style:{"&:hover":{boxShadow:"none"}}}}))),vq=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiButtonGroup"}),{children:m,className:y,color:T="primary",component:i="div",disabled:z=!1,disableElevation:B=!1,disableFocusRipple:F=!1,disableRipple:G=!1,fullWidth:Q=!1,orientation:te="horizontal",size:ne="medium",variant:oe="outlined",...ue}=l,ye={...l,color:T,component:i,disabled:z,disableElevation:B,disableFocusRipple:F,disableRipple:G,fullWidth:Q,orientation:te,size:ne,variant:oe},we=_q(ye),ve=ae.useMemo(()=>({className:we.grouped,color:T,disabled:z,disableElevation:B,disableFocusRipple:F,disableRipple:G,fullWidth:Q,size:ne,variant:oe}),[T,z,B,F,G,Q,ne,oe,we.grouped]),Ce=mq(m),Ee=Ce.length,Be=Ke=>{const st=Ke===0,dt=Ke===Ee-1;return st&&dt?"":st?we.firstButton:dt?we.lastButton:we.middleButton};return be.jsx(yq,{as:i,role:"group",className:on(we.root,y),ref:a,ownerState:ye,...ue,children:be.jsx(RB.Provider,{value:ve,children:Ce.map((Ke,st)=>be.jsx(DB.Provider,{value:Be(st),children:Ke},st))})})});function xq(e){return Bi("PrivateSwitchBase",e)}Fi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const bq=e=>{const{classes:r,checked:a,disabled:l,edge:m}=e,y={root:["root",a&&"checked",l&&"disabled",m&&`edge${sn(m)}`],input:["input"]};return Ni(y,xq,r)},wq=pn(px,{name:"MuiSwitchBase"})({padding:9,borderRadius:"50%",variants:[{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:({edge:e,ownerState:r})=>e==="start"&&r.size!=="small",style:{marginLeft:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}},{props:({edge:e,ownerState:r})=>e==="end"&&r.size!=="small",style:{marginRight:-12}}]}),Sq=pn("input",{name:"MuiSwitchBase",shouldForwardProp:eu})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Tq=ae.forwardRef(function(r,a){const{autoFocus:l,checked:m,checkedIcon:y,defaultChecked:T,disabled:i,disableFocusRipple:z=!1,edge:B=!1,icon:F,id:G,inputProps:Q,inputRef:te,name:ne,onBlur:oe,onChange:ue,onFocus:ye,readOnly:we,required:ve=!1,tabIndex:Ce,type:Ee,value:Be,slots:Ke={},slotProps:st={},...dt}=r,[bt,ht]=Hv({controlled:m,default:!!T,name:"SwitchBase",state:"checked"}),Re=Yd(),Pt=tn=>{ye&&ye(tn),Re&&Re.onFocus&&Re.onFocus(tn)},wt=tn=>{oe&&oe(tn),Re&&Re.onBlur&&Re.onBlur(tn)},Et=tn=>{if(tn.nativeEvent.defaultPrevented)return;const Hr=tn.target.checked;ht(Hr),ue&&ue(tn,Hr)};let et=i;Re&&typeof et>"u"&&(et=Re.disabled);const Zt=Ee==="checkbox"||Ee==="radio",ir={...r,checked:bt,disabled:et,disableFocusRipple:z,edge:B},or=bq(ir),ft={slots:Ke,slotProps:{input:Q,...st}},[Vt,Jt]=pa("root",{ref:a,elementType:wq,className:or.root,shouldForwardComponentProp:!0,externalForwardedProps:{...ft,component:"span",...dt},getSlotProps:tn=>({...tn,onFocus:Hr=>{tn.onFocus?.(Hr),Pt(Hr)},onBlur:Hr=>{tn.onBlur?.(Hr),wt(Hr)}}),ownerState:ir,additionalProps:{centerRipple:!0,focusRipple:!z,disabled:et,role:void 0,tabIndex:null}}),[Cr,ln]=pa("input",{ref:te,elementType:Sq,className:or.input,externalForwardedProps:ft,getSlotProps:tn=>({...tn,onChange:Hr=>{tn.onChange?.(Hr),Et(Hr)}}),ownerState:ir,additionalProps:{autoFocus:l,checked:m,defaultChecked:T,disabled:et,id:Zt?G:void 0,name:ne,readOnly:we,required:ve,tabIndex:Ce,type:Ee,...Ee==="checkbox"&&Be===void 0?{}:{value:Be}}});return be.jsxs(Vt,{...Jt,children:[be.jsx(Cr,{...ln}),bt?y:F]})}),Eq=U$({createStyledComponent:pn("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`maxWidth${sn(String(a.maxWidth))}`],a.fixed&&r.fixed,a.disableGutters&&r.disableGutters]}}),useThemeProps:e=>Wi({props:e,name:"MuiContainer"})});function kB(e=window){const r=e.document.documentElement.clientWidth;return e.innerWidth-r}function Cq(e){const r=Wd(e);return r.body===e?Zd(e).innerWidth>r.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function Lv(e,r){r?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function nO(e){return parseInt(Zd(e).getComputedStyle(e).paddingRight,10)||0}function Mq(e){const a=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(e.tagName),l=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return a||l}function iO(e,r,a,l,m){const y=[r,a,...l];[].forEach.call(e.children,T=>{const i=!y.includes(T),z=!Mq(T);i&&z&&Lv(T,m)})}function KS(e,r){let a=-1;return e.some((l,m)=>r(l)?(a=m,!0):!1),a}function Iq(e,r){const a=[],l=e.container;if(!r.disableScrollLock){if(Cq(l)){const T=kB(Zd(l));a.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${nO(l)+T}px`;const i=Wd(l).querySelectorAll(".mui-fixed");[].forEach.call(i,z=>{a.push({value:z.style.paddingRight,property:"padding-right",el:z}),z.style.paddingRight=`${nO(z)+T}px`})}let y;if(l.parentNode instanceof DocumentFragment)y=Wd(l).body;else{const T=l.parentElement,i=Zd(l);y=T?.nodeName==="HTML"&&i.getComputedStyle(T).overflowY==="scroll"?T:l}a.push({value:y.style.overflow,property:"overflow",el:y},{value:y.style.overflowX,property:"overflow-x",el:y},{value:y.style.overflowY,property:"overflow-y",el:y}),y.style.overflow="hidden"}return()=>{a.forEach(({value:y,el:T,property:i})=>{y?T.style.setProperty(i,y):T.style.removeProperty(i)})}}function Pq(e){const r=[];return[].forEach.call(e.children,a=>{a.getAttribute("aria-hidden")==="true"&&r.push(a)}),r}class Rq{constructor(){this.modals=[],this.containers=[]}add(r,a){let l=this.modals.indexOf(r);if(l!==-1)return l;l=this.modals.length,this.modals.push(r),r.modalRef&&Lv(r.modalRef,!1);const m=Pq(a);iO(a,r.mount,r.modalRef,m,!0);const y=KS(this.containers,T=>T.container===a);return y!==-1?(this.containers[y].modals.push(r),l):(this.containers.push({modals:[r],container:a,restore:null,hiddenSiblings:m}),l)}mount(r,a){const l=KS(this.containers,y=>y.modals.includes(r)),m=this.containers[l];m.restore||(m.restore=Iq(m,a))}remove(r,a=!0){const l=this.modals.indexOf(r);if(l===-1)return l;const m=KS(this.containers,T=>T.modals.includes(r)),y=this.containers[m];if(y.modals.splice(y.modals.indexOf(r),1),this.modals.splice(l,1),y.modals.length===0)y.restore&&y.restore(),r.modalRef&&Lv(r.modalRef,a),iO(y.container,r.mount,r.modalRef,y.hiddenSiblings,!1),this.containers.splice(m,1);else{const T=y.modals[y.modals.length-1];T.modalRef&&Lv(T.modalRef,!1)}return l}isTopModal(r){return this.modals.length>0&&this.modals[this.modals.length-1]===r}}const Dq=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function Oq(e){const r=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(r)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:r}function kq(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const r=l=>e.ownerDocument.querySelector(`input[type="radio"]${l}`);let a=r(`[name="${e.name}"]:checked`);return a||(a=r(`[name="${e.name}"]`)),a!==e}function zq(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||kq(e))}function Lq(e){const r=[],a=[];return Array.from(e.querySelectorAll(Dq)).forEach((l,m)=>{const y=Oq(l);y===-1||!zq(l)||(y===0?r.push(l):a.push({documentOrder:m,tabIndex:y,node:l}))}),a.sort((l,m)=>l.tabIndex===m.tabIndex?l.documentOrder-m.documentOrder:l.tabIndex-m.tabIndex).map(l=>l.node).concat(r)}function Bq(){return!0}function Fq(e){const{children:r,disableAutoFocus:a=!1,disableEnforceFocus:l=!1,disableRestoreFocus:m=!1,getTabbable:y=Lq,isEnabled:T=Bq,open:i}=e,z=ae.useRef(!1),B=ae.useRef(null),F=ae.useRef(null),G=ae.useRef(null),Q=ae.useRef(null),te=ae.useRef(!1),ne=ae.useRef(null),oe=rc(ry(r),ne),ue=ae.useRef(null);ae.useEffect(()=>{!i||!ne.current||(te.current=!a)},[a,i]),ae.useEffect(()=>{if(!i||!ne.current)return;const ve=Wd(ne.current);return ne.current.contains(ve.activeElement)||(ne.current.hasAttribute("tabIndex")||ne.current.setAttribute("tabIndex","-1"),te.current&&ne.current.focus()),()=>{m||(G.current&&G.current.focus&&(z.current=!0,G.current.focus()),G.current=null)}},[i]),ae.useEffect(()=>{if(!i||!ne.current)return;const ve=Wd(ne.current),Ce=Ke=>{ue.current=Ke,!(l||!T()||Ke.key!=="Tab")&&ve.activeElement===ne.current&&Ke.shiftKey&&(z.current=!0,F.current&&F.current.focus())},Ee=()=>{const Ke=ne.current;if(Ke===null)return;if(!ve.hasFocus()||!T()||z.current){z.current=!1;return}if(Ke.contains(ve.activeElement)||l&&ve.activeElement!==B.current&&ve.activeElement!==F.current)return;if(ve.activeElement!==Q.current)Q.current=null;else if(Q.current!==null)return;if(!te.current)return;let st=[];if((ve.activeElement===B.current||ve.activeElement===F.current)&&(st=y(ne.current)),st.length>0){const dt=!!(ue.current?.shiftKey&&ue.current?.key==="Tab"),bt=st[0],ht=st[st.length-1];typeof bt!="string"&&typeof ht!="string"&&(dt?ht.focus():bt.focus())}else Ke.focus()};ve.addEventListener("focusin",Ee),ve.addEventListener("keydown",Ce,!0);const Be=setInterval(()=>{ve.activeElement&&ve.activeElement.tagName==="BODY"&&Ee()},50);return()=>{clearInterval(Be),ve.removeEventListener("focusin",Ee),ve.removeEventListener("keydown",Ce,!0)}},[a,l,m,T,i,y]);const ye=ve=>{G.current===null&&(G.current=ve.relatedTarget),te.current=!0,Q.current=ve.target;const Ce=r.props.onFocus;Ce&&Ce(ve)},we=ve=>{G.current===null&&(G.current=ve.relatedTarget),te.current=!0};return be.jsxs(ae.Fragment,{children:[be.jsx("div",{tabIndex:i?0:-1,onFocus:we,ref:B,"data-testid":"sentinelStart"}),ae.cloneElement(r,{ref:oe,onFocus:ye}),be.jsx("div",{tabIndex:i?0:-1,onFocus:we,ref:F,"data-testid":"sentinelEnd"})]})}function Nq(e){return typeof e=="function"?e():e}function jq(e){return e?e.props.hasOwnProperty("in"):!1}const oO=()=>{},tb=new Rq;function Uq(e){const{container:r,disableEscapeKeyDown:a=!1,disableScrollLock:l=!1,closeAfterTransition:m=!1,onTransitionEnter:y,onTransitionExited:T,children:i,onClose:z,open:B,rootRef:F}=e,G=ae.useRef({}),Q=ae.useRef(null),te=ae.useRef(null),ne=rc(te,F),[oe,ue]=ae.useState(!B),ye=jq(i);let we=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(we=!1);const ve=()=>Wd(Q.current),Ce=()=>(G.current.modalRef=te.current,G.current.mount=Q.current,G.current),Ee=()=>{tb.mount(Ce(),{disableScrollLock:l}),te.current&&(te.current.scrollTop=0)},Be=ug(()=>{const Et=Nq(r)||ve().body;tb.add(Ce(),Et),te.current&&Ee()}),Ke=()=>tb.isTopModal(Ce()),st=ug(Et=>{Q.current=Et,Et&&(B&&Ke()?Ee():te.current&&Lv(te.current,we))}),dt=ae.useCallback(()=>{tb.remove(Ce(),we)},[we]);ae.useEffect(()=>()=>{dt()},[dt]),ae.useEffect(()=>{B?Be():(!ye||!m)&&dt()},[B,dt,ye,m,Be]);const bt=Et=>et=>{Et.onKeyDown?.(et),!(et.key!=="Escape"||et.which===229||!Ke())&&(a||(et.stopPropagation(),z&&z(et,"escapeKeyDown")))},ht=Et=>et=>{Et.onClick?.(et),et.target===et.currentTarget&&z&&z(et,"backdropClick")};return{getRootProps:(Et={})=>{const et=IB(e);delete et.onTransitionEnter,delete et.onTransitionExited;const Zt={...et,...Et};return{role:"presentation",...Zt,onKeyDown:bt(Zt),ref:ne}},getBackdropProps:(Et={})=>{const et=Et;return{"aria-hidden":!0,...et,onClick:ht(et),open:B}},getTransitionProps:()=>{const Et=()=>{ue(!1),y&&y()},et=()=>{ue(!0),T&&T(),m&&dt()};return{onEnter:WE(Et,i?.props.onEnter??oO),onExited:WE(et,i?.props.onExited??oO)}},rootRef:ne,portalRef:st,isTopModal:Ke,exited:oe,hasTransition:ye}}function Vq(e){return Bi("MuiModal",e)}Fi("MuiModal",["root","hidden","backdrop"]);const $q=e=>{const{open:r,exited:a,classes:l}=e;return Ni({root:["root",!r&&a&&"hidden"],backdrop:["backdrop"]},Vq,l)},Gq=pn("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.open&&a.exited&&r.hidden]}})(Yi(({theme:e})=>({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:r})=>!r.open&&r.exited,style:{visibility:"hidden"}}]}))),Hq=pn(aq,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),zB=ae.forwardRef(function(r,a){const l=Wi({name:"MuiModal",props:r}),{BackdropComponent:m=Hq,BackdropProps:y,classes:T,className:i,closeAfterTransition:z=!1,children:B,container:F,component:G,components:Q={},componentsProps:te={},disableAutoFocus:ne=!1,disableEnforceFocus:oe=!1,disableEscapeKeyDown:ue=!1,disablePortal:ye=!1,disableRestoreFocus:we=!1,disableScrollLock:ve=!1,hideBackdrop:Ce=!1,keepMounted:Ee=!1,onClose:Be,onTransitionEnter:Ke,onTransitionExited:st,open:dt,slotProps:bt={},slots:ht={},theme:Re,...Pt}=l,wt={...l,closeAfterTransition:z,disableAutoFocus:ne,disableEnforceFocus:oe,disableEscapeKeyDown:ue,disablePortal:ye,disableRestoreFocus:we,disableScrollLock:ve,hideBackdrop:Ce,keepMounted:Ee},{getRootProps:Et,getBackdropProps:et,getTransitionProps:Zt,portalRef:ir,isTopModal:or,exited:ft,hasTransition:Vt}=Uq({...wt,rootRef:a}),Jt={...wt,exited:ft},Cr=$q(Jt),ln={};if(B.props.tabIndex===void 0&&(ln.tabIndex="-1"),Vt){const{onEnter:Gr,onExited:Sn}=Zt();ln.onEnter=Gr,ln.onExited=Sn}const tn={slots:{root:Q.Root,backdrop:Q.Backdrop,...ht},slotProps:{...te,...bt}},[Hr,Nn]=pa("root",{ref:a,elementType:Gq,externalForwardedProps:{...tn,...Pt,component:G},getSlotProps:Et,ownerState:Jt,className:on(i,Cr?.root,!Jt.open&&Jt.exited&&Cr?.hidden)}),[jn,Ur]=pa("backdrop",{ref:y?.ref,elementType:m,externalForwardedProps:tn,shouldForwardComponentProp:!0,additionalProps:y,getSlotProps:Gr=>et({...Gr,onClick:Sn=>{Gr?.onClick&&Gr.onClick(Sn)}}),className:on(y?.className,Cr?.backdrop),ownerState:Jt});return!Ee&&!dt&&(!Vt||ft)?null:be.jsx(GH,{ref:ir,container:F,disablePortal:ye,children:be.jsxs(Hr,{...Nn,children:[!Ce&&m?be.jsx(jn,{...Ur}):null,be.jsx(Fq,{disableEnforceFocus:oe,disableAutoFocus:ne,disableRestoreFocus:we,isEnabled:or,open:dt,children:ae.cloneElement(B,ln)})]})})});function qq(e){return Bi("MuiDivider",e)}const aO=Fi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),Wq=e=>{const{absolute:r,children:a,classes:l,flexItem:m,light:y,orientation:T,textAlign:i,variant:z}=e;return Ni({root:["root",r&&"absolute",z,y&&"light",T==="vertical"&&"vertical",m&&"flexItem",a&&"withChildren",a&&T==="vertical"&&"withChildrenVertical",i==="right"&&T!=="vertical"&&"textAlignRight",i==="left"&&T!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",T==="vertical"&&"wrapperVertical"]},qq,l)},Zq=pn("div",{name:"MuiDivider",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.absolute&&r.absolute,r[a.variant],a.light&&r.light,a.orientation==="vertical"&&r.vertical,a.flexItem&&r.flexItem,a.children&&r.withChildren,a.children&&a.orientation==="vertical"&&r.withChildrenVertical,a.textAlign==="right"&&a.orientation!=="vertical"&&r.textAlignRight,a.textAlign==="left"&&a.orientation!=="vertical"&&r.textAlignLeft]}})(Yi(({theme:e})=>({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(e.vars||e).palette.divider,borderBottomWidth:"thin",variants:[{props:{absolute:!0},style:{position:"absolute",bottom:0,left:0,width:"100%"}},{props:{light:!0},style:{borderColor:e.alpha((e.vars||e).palette.divider,.08)}},{props:{variant:"inset"},style:{marginLeft:72}},{props:{variant:"middle",orientation:"horizontal"},style:{marginLeft:e.spacing(2),marginRight:e.spacing(2)}},{props:{variant:"middle",orientation:"vertical"},style:{marginTop:e.spacing(1),marginBottom:e.spacing(1)}},{props:{orientation:"vertical"},style:{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"}},{props:{flexItem:!0},style:{alignSelf:"stretch",height:"auto"}},{props:({ownerState:r})=>!!r.children,style:{display:"flex",textAlign:"center",border:0,borderTopStyle:"solid",borderLeftStyle:"solid","&::before, &::after":{content:'""',alignSelf:"center"}}},{props:({ownerState:r})=>r.children&&r.orientation!=="vertical",style:{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(e.vars||e).palette.divider}`,borderTopStyle:"inherit"}}},{props:({ownerState:r})=>r.orientation==="vertical"&&r.children,style:{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(e.vars||e).palette.divider}`,borderLeftStyle:"inherit"}}},{props:({ownerState:r})=>r.textAlign==="right"&&r.orientation!=="vertical",style:{"&::before":{width:"90%"},"&::after":{width:"10%"}}},{props:({ownerState:r})=>r.textAlign==="left"&&r.orientation!=="vertical",style:{"&::before":{width:"10%"},"&::after":{width:"90%"}}}]}))),Xq=pn("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.wrapper,a.orientation==="vertical"&&r.wrapperVertical]}})(Yi(({theme:e})=>({display:"inline-block",paddingLeft:`calc(${e.spacing(1)} * 1.2)`,paddingRight:`calc(${e.spacing(1)} * 1.2)`,whiteSpace:"nowrap",variants:[{props:{orientation:"vertical"},style:{paddingTop:`calc(${e.spacing(1)} * 1.2)`,paddingBottom:`calc(${e.spacing(1)} * 1.2)`}}]}))),U_=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiDivider"}),{absolute:m=!1,children:y,className:T,orientation:i="horizontal",component:z=y||i==="vertical"?"div":"hr",flexItem:B=!1,light:F=!1,role:G=z!=="hr"?"separator":void 0,textAlign:Q="center",variant:te="fullWidth",...ne}=l,oe={...l,absolute:m,component:z,flexItem:B,light:F,orientation:i,role:G,textAlign:Q,variant:te},ue=Wq(oe);return be.jsx(Zq,{as:z,className:on(ue.root,T),role:G,ref:a,ownerState:oe,"aria-orientation":G==="separator"&&(z!=="hr"||i==="vertical")?i:void 0,...ne,children:y?be.jsx(Xq,{className:ue.wrapper,ownerState:oe,children:y}):null})});U_&&(U_.muiSkipListHighlight=!0);function Yq(e,r,a){const l=r.getBoundingClientRect(),m=a&&a.getBoundingClientRect(),y=Zd(r);let T;if(r.fakeTransform)T=r.fakeTransform;else{const B=y.getComputedStyle(r);T=B.getPropertyValue("-webkit-transform")||B.getPropertyValue("transform")}let i=0,z=0;if(T&&T!=="none"&&typeof T=="string"){const B=T.split("(")[1].split(")")[0].split(",");i=parseInt(B[4],10),z=parseInt(B[5],10)}return e==="left"?m?`translateX(${m.right+i-l.left}px)`:`translateX(${y.innerWidth+i-l.left}px)`:e==="right"?m?`translateX(-${l.right-m.left-i}px)`:`translateX(-${l.left+l.width-i}px)`:e==="up"?m?`translateY(${m.bottom+z-l.top}px)`:`translateY(${y.innerHeight+z-l.top}px)`:m?`translateY(-${l.top-m.top+l.height-z}px)`:`translateY(-${l.top+l.height-z}px)`}function Qq(e){return typeof e=="function"?e():e}function rb(e,r,a){const l=Qq(a),m=Yq(e,r,l);m&&(r.style.webkitTransform=m,r.style.transform=m)}const Kq=ae.forwardRef(function(r,a){const l=ty(),m={enter:l.transitions.easing.easeOut,exit:l.transitions.easing.sharp},y={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:T,appear:i=!0,children:z,container:B,direction:F="down",easing:G=m,in:Q,onEnter:te,onEntered:ne,onEntering:oe,onExit:ue,onExited:ye,onExiting:we,style:ve,timeout:Ce=y,TransitionComponent:Ee=Xd,...Be}=r,Ke=ae.useRef(null),st=rc(ry(z),Ke,a),dt=ir=>or=>{ir&&(or===void 0?ir(Ke.current):ir(Ke.current,or))},bt=dt((ir,or)=>{rb(F,ir,B),D3(ir),te&&te(ir,or)}),ht=dt((ir,or)=>{const ft=F_({timeout:Ce,style:ve,easing:G},{mode:"enter"});ir.style.webkitTransition=l.transitions.create("-webkit-transform",{...ft}),ir.style.transition=l.transitions.create("transform",{...ft}),ir.style.webkitTransform="none",ir.style.transform="none",oe&&oe(ir,or)}),Re=dt(ne),Pt=dt(we),wt=dt(ir=>{const or=F_({timeout:Ce,style:ve,easing:G},{mode:"exit"});ir.style.webkitTransition=l.transitions.create("-webkit-transform",or),ir.style.transition=l.transitions.create("transform",or),rb(F,ir,B),ue&&ue(ir)}),Et=dt(ir=>{ir.style.webkitTransition="",ir.style.transition="",ye&&ye(ir)}),et=ir=>{T&&T(Ke.current,ir)},Zt=ae.useCallback(()=>{Ke.current&&rb(F,Ke.current,B)},[F,B]);return ae.useEffect(()=>{if(Q||F==="down"||F==="right")return;const ir=C3(()=>{Ke.current&&rb(F,Ke.current,B)}),or=Zd(Ke.current);return or.addEventListener("resize",ir),()=>{ir.clear(),or.removeEventListener("resize",ir)}},[F,Q,B]),ae.useEffect(()=>{Q||Zt()},[Q,Zt]),be.jsx(Ee,{nodeRef:Ke,onEnter:bt,onEntered:Re,onEntering:ht,onExit:wt,onExited:Et,onExiting:Pt,addEndListener:et,appear:i,in:Q,timeout:Ce,...Be,children:(ir,{ownerState:or,...ft})=>ae.cloneElement(z,{ref:st,style:{visibility:ir==="exited"&&!Q?"hidden":void 0,...ve,...z.props.style},...ft})})});function Jq(e){return Bi("MuiDrawer",e)}Fi("MuiDrawer",["root","docked","paper","anchorLeft","anchorRight","anchorTop","anchorBottom","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const LB=(e,r)=>{const{ownerState:a}=e;return[r.root,(a.variant==="permanent"||a.variant==="persistent")&&r.docked,r.modal]},eW=e=>{const{classes:r,anchor:a,variant:l}=e,m={root:["root",`anchor${sn(a)}`],docked:[(l==="permanent"||l==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${sn(a)}`,l!=="temporary"&&`paperAnchorDocked${sn(a)}`]};return Ni(m,Jq,r)},tW=pn(zB,{name:"MuiDrawer",slot:"Root",overridesResolver:LB})(Yi(({theme:e})=>({zIndex:(e.vars||e).zIndex.drawer}))),rW=pn("div",{shouldForwardProp:eu,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:LB})({flex:"0 0 auto"}),nW=pn(dx,{name:"MuiDrawer",slot:"Paper",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.paper,r[`paperAnchor${sn(a.anchor)}`],a.variant!=="temporary"&&r[`paperAnchorDocked${sn(a.anchor)}`]]}})(Yi(({theme:e})=>({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(e.vars||e).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0,variants:[{props:{anchor:"left"},style:{left:0}},{props:{anchor:"top"},style:{top:0,left:0,right:0,height:"auto",maxHeight:"100%"}},{props:{anchor:"right"},style:{right:0}},{props:{anchor:"bottom"},style:{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"}},{props:({ownerState:r})=>r.anchor==="left"&&r.variant!=="temporary",style:{borderRight:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="top"&&r.variant!=="temporary",style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="right"&&r.variant!=="temporary",style:{borderLeft:`1px solid ${(e.vars||e).palette.divider}`}},{props:({ownerState:r})=>r.anchor==="bottom"&&r.variant!=="temporary",style:{borderTop:`1px solid ${(e.vars||e).palette.divider}`}}]}))),BB={left:"right",right:"left",top:"down",bottom:"up"};function iW(e){return["left","right"].includes(e)}function oW({direction:e},r){return e==="rtl"&&iW(r)?BB[r]:r}const Zw=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiDrawer"}),m=ty(),y=jw(),T={enter:m.transitions.duration.enteringScreen,exit:m.transitions.duration.leavingScreen},{anchor:i="left",BackdropProps:z,children:B,className:F,elevation:G=16,hideBackdrop:Q=!1,ModalProps:{BackdropProps:te,...ne}={},onClose:oe,open:ue=!1,PaperProps:ye={},SlideProps:we,TransitionComponent:ve,transitionDuration:Ce=T,variant:Ee="temporary",slots:Be={},slotProps:Ke={},...st}=l,dt=ae.useRef(!1);ae.useEffect(()=>{dt.current=!0},[]);const bt=oW({direction:y?"rtl":"ltr"},i),Re={...l,anchor:i,elevation:G,open:ue,variant:Ee,...st},Pt=eW(Re),wt={slots:{transition:ve,...Be},slotProps:{paper:ye,transition:we,...Ke,backdrop:xB(Ke.backdrop||{...z,...te},{transitionDuration:Ce})}},[Et,et]=pa("root",{ref:a,elementType:tW,className:on(Pt.root,Pt.modal,F),shouldForwardComponentProp:!0,ownerState:Re,externalForwardedProps:{...wt,...st,...ne},additionalProps:{open:ue,onClose:oe,hideBackdrop:Q,slots:{backdrop:wt.slots.backdrop},slotProps:{backdrop:wt.slotProps.backdrop}}}),[Zt,ir]=pa("paper",{elementType:nW,shouldForwardComponentProp:!0,className:on(Pt.paper,ye.className),ownerState:Re,externalForwardedProps:wt,additionalProps:{elevation:Ee==="temporary"?G:0,square:!0,...Ee==="temporary"&&{role:"dialog","aria-modal":"true"}}}),[or,ft]=pa("docked",{elementType:rW,ref:a,className:on(Pt.root,Pt.docked,F),ownerState:Re,externalForwardedProps:wt,additionalProps:st}),[Vt,Jt]=pa("transition",{elementType:Kq,ownerState:Re,externalForwardedProps:wt,additionalProps:{in:ue,direction:BB[bt],timeout:Ce,appear:dt.current}}),Cr=be.jsx(Zt,{...ir,children:B});if(Ee==="permanent")return be.jsx(or,{...ft,children:Cr});const ln=be.jsx(Vt,{...Jt,children:Cr});return Ee==="persistent"?be.jsx(or,{...ft,children:ln}):be.jsx(Et,{...et,children:ln})}),aW=e=>{const{classes:r,disableUnderline:a,startAdornment:l,endAdornment:m,size:y,hiddenLabel:T,multiline:i}=e,z={root:["root",!a&&"underline",l&&"adornedStart",m&&"adornedEnd",y==="small"&&`size${sn(y)}`,T&&"hiddenLabel",i&&"multiline"],input:["input"]},B=Ni(z,JH,r);return{...r,...B}},sW=pn(qw,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[...Gw(e,r),!a.disableUnderline&&r.underline]}})(Yi(({theme:e})=>{const r=e.palette.mode==="light",a=r?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",l=r?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",m=r?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",y=r?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{position:"relative",backgroundColor:e.vars?e.vars.palette.FilledInput.bg:l,borderTopLeftRadius:(e.vars||e).shape.borderRadius,borderTopRightRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:e.vars?e.vars.palette.FilledInput.hoverBg:m,"@media (hover: none)":{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:l}},[`&.${Y0.focused}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.bg:l},[`&.${Y0.disabled}`]:{backgroundColor:e.vars?e.vars.palette.FilledInput.disabledBg:y},variants:[{props:({ownerState:T})=>!T.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Y0.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Y0.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${e.vars?e.alpha(e.vars.palette.common.onBackground,e.vars.opacity.inputUnderline):a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Y0.disabled}, .${Y0.error}):before`]:{borderBottom:`1px solid ${(e.vars||e).palette.text.primary}`},[`&.${Y0.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(rl()).map(([T])=>({props:{disableUnderline:!1,color:T},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[T]?.main}`}}})),{props:({ownerState:T})=>T.startAdornment,style:{paddingLeft:12}},{props:({ownerState:T})=>T.endAdornment,style:{paddingRight:12}},{props:({ownerState:T})=>T.multiline,style:{padding:"25px 12px 8px"}},{props:({ownerState:T,size:i})=>T.multiline&&i==="small",style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:T})=>T.multiline&&T.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:T})=>T.multiline&&T.hiddenLabel&&T.size==="small",style:{paddingTop:8,paddingBottom:9}}]}})),lW=pn(Ww,{name:"MuiFilledInput",slot:"Input",overridesResolver:Hw})(Yi(({theme:e})=>({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{paddingTop:21,paddingBottom:4}},{props:({ownerState:r})=>r.hiddenLabel,style:{paddingTop:16,paddingBottom:17}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}},{props:({ownerState:r})=>r.hiddenLabel&&r.size==="small",style:{paddingTop:8,paddingBottom:9}},{props:({ownerState:r})=>r.multiline,style:{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}}]}))),k3=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiFilledInput"}),{disableUnderline:m=!1,components:y={},componentsProps:T,fullWidth:i=!1,hiddenLabel:z,inputComponent:B="input",multiline:F=!1,slotProps:G,slots:Q={},type:te="text",...ne}=l,oe={...l,disableUnderline:m,fullWidth:i,inputComponent:B,multiline:F,type:te},ue=aW(l),ye={root:{ownerState:oe},input:{ownerState:oe}},we=G??T?Kc(ye,G??T):ye,ve=Q.root??y.Root??sW,Ce=Q.input??y.Input??lW;return be.jsx(O3,{slots:{root:ve,input:Ce},slotProps:we,fullWidth:i,inputComponent:B,multiline:F,ref:a,type:te,...ne,classes:ue})});k3.muiName="Input";function cW(e){return Bi("MuiFormControl",e)}Fi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const uW=e=>{const{classes:r,margin:a,fullWidth:l}=e,m={root:["root",a!=="none"&&`margin${sn(a)}`,l&&"fullWidth"]};return Ni(m,cW,r)},hW=pn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`margin${sn(a.margin)}`],a.fullWidth&&r.fullWidth]}})({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top",variants:[{props:{margin:"normal"},style:{marginTop:16,marginBottom:8}},{props:{margin:"dense"},style:{marginTop:8,marginBottom:4}},{props:{fullWidth:!0},style:{width:"100%"}}]}),z3=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiFormControl"}),{children:m,className:y,color:T="primary",component:i="div",disabled:z=!1,error:B=!1,focused:F,fullWidth:G=!1,hiddenLabel:Q=!1,margin:te="none",required:ne=!1,size:oe="medium",variant:ue="outlined",...ye}=l,we={...l,color:T,component:i,disabled:z,error:B,fullWidth:G,hiddenLabel:Q,margin:te,required:ne,size:oe,variant:ue},ve=uW(we),[Ce,Ee]=ae.useState(()=>{let Et=!1;return m&&ae.Children.forEach(m,et=>{if(!zv(et,["Input","Select"]))return;const Zt=zv(et,["Select"])?et.props.input:et;Zt&&ZH(Zt.props)&&(Et=!0)}),Et}),[Be,Ke]=ae.useState(()=>{let Et=!1;return m&&ae.Children.forEach(m,et=>{zv(et,["Input","Select"])&&(Vb(et.props,!0)||Vb(et.props.inputProps,!0))&&(Et=!0)}),Et}),[st,dt]=ae.useState(!1);z&&st&&dt(!1);const bt=F!==void 0&&!z?F:st;let ht;ae.useRef(!1);const Re=ae.useCallback(()=>{Ke(!0)},[]),Pt=ae.useCallback(()=>{Ke(!1)},[]),wt=ae.useMemo(()=>({adornedStart:Ce,setAdornedStart:Ee,color:T,disabled:z,error:B,filled:Be,focused:bt,fullWidth:G,hiddenLabel:Q,size:oe,onBlur:()=>{dt(!1)},onFocus:()=>{dt(!0)},onEmpty:Pt,onFilled:Re,registerEffect:ht,required:ne,variant:ue}),[Ce,T,z,B,Be,bt,G,Q,ht,Pt,Re,ne,oe,ue]);return be.jsx($w.Provider,{value:wt,children:be.jsx(hW,{as:i,ownerState:we,className:on(ve.root,y),ref:a,...ye,children:m})})});function fW(e){return Bi("MuiFormControlLabel",e)}const Pv=Fi("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]),dW=e=>{const{classes:r,disabled:a,labelPlacement:l,error:m,required:y}=e,T={root:["root",a&&"disabled",`labelPlacement${sn(l)}`,m&&"error",y&&"required"],label:["label",a&&"disabled"],asterisk:["asterisk",m&&"error"]};return Ni(T,fW,r)},pW=pn("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`& .${Pv.label}`]:r.label},r.root,r[`labelPlacement${sn(a.labelPlacement)}`]]}})(Yi(({theme:e})=>({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,[`&.${Pv.disabled}`]:{cursor:"default"},[`& .${Pv.label}`]:{[`&.${Pv.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:"start"},style:{flexDirection:"row-reverse",marginRight:-11}},{props:{labelPlacement:"top"},style:{flexDirection:"column-reverse"}},{props:{labelPlacement:"bottom"},style:{flexDirection:"column"}},{props:({labelPlacement:r})=>r==="start"||r==="top"||r==="bottom",style:{marginLeft:16}}]}))),mW=pn("span",{name:"MuiFormControlLabel",slot:"Asterisk"})(Yi(({theme:e})=>({[`&.${Pv.error}`]:{color:(e.vars||e).palette.error.main}}))),JS=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiFormControlLabel"}),{checked:m,className:y,componentsProps:T={},control:i,disabled:z,disableTypography:B,inputRef:F,label:G,labelPlacement:Q="end",name:te,onChange:ne,required:oe,slots:ue={},slotProps:ye={},value:we,...ve}=l,Ce=Yd(),Ee=z??i.props.disabled??Ce?.disabled,Be=oe??i.props.required,Ke={disabled:Ee,required:Be};["checked","name","onChange","value","inputRef"].forEach(Et=>{typeof i.props[Et]>"u"&&typeof l[Et]<"u"&&(Ke[Et]=l[Et])});const st=u0({props:l,muiFormControl:Ce,states:["error"]}),dt={...l,disabled:Ee,labelPlacement:Q,required:Be,error:st.error},bt=dW(dt),ht={slots:ue,slotProps:{...T,...ye}},[Re,Pt]=pa("typography",{elementType:tl,externalForwardedProps:ht,ownerState:dt});let wt=G;return wt!=null&&wt.type!==tl&&!B&&(wt=be.jsx(Re,{component:"span",...Pt,className:on(bt.label,Pt?.className),children:wt})),be.jsxs(pW,{className:on(bt.root,y),ownerState:dt,ref:a,...ve,children:[ae.cloneElement(i,Ke),Be?be.jsxs("div",{children:[wt,be.jsxs(mW,{ownerState:dt,"aria-hidden":!0,className:bt.asterisk,children:["","*"]})]}):wt]})});function AW(e){return Bi("MuiFormGroup",e)}Fi("MuiFormGroup",["root","row","error"]);const gW=e=>{const{classes:r,row:a,error:l}=e;return Ni({root:["root",a&&"row",l&&"error"]},AW,r)},_W=pn("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.row&&r.row]}})({display:"flex",flexDirection:"column",flexWrap:"wrap",variants:[{props:{row:!0},style:{flexDirection:"row"}}]}),yW=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiFormGroup"}),{className:m,row:y=!1,...T}=l,i=Yd(),z=u0({props:l,muiFormControl:i,states:["error"]}),B={...l,row:y,error:z.error},F=gW(B);return be.jsx(_W,{className:on(F.root,m),ownerState:B,ref:a,...T})});function vW(e){return Bi("MuiFormHelperText",e)}const sO=Fi("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]);var lO;const xW=e=>{const{classes:r,contained:a,size:l,disabled:m,error:y,filled:T,focused:i,required:z}=e,B={root:["root",m&&"disabled",y&&"error",l&&`size${sn(l)}`,a&&"contained",i&&"focused",T&&"filled",z&&"required"]};return Ni(B,vW,r)},bW=pn("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.size&&r[`size${sn(a.size)}`],a.contained&&r.contained,a.filled&&r.filled]}})(Yi(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.caption,textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${sO.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${sO.error}`]:{color:(e.vars||e).palette.error.main},variants:[{props:{size:"small"},style:{marginTop:4}},{props:({ownerState:r})=>r.contained,style:{marginLeft:14,marginRight:14}}]}))),wW=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiFormHelperText"}),{children:m,className:y,component:T="p",disabled:i,error:z,filled:B,focused:F,margin:G,required:Q,variant:te,...ne}=l,oe=Yd(),ue=u0({props:l,muiFormControl:oe,states:["variant","size","disabled","error","filled","focused","required"]}),ye={...l,component:T,contained:ue.variant==="filled"||ue.variant==="outlined",variant:ue.variant,size:ue.size,disabled:ue.disabled,error:ue.error,filled:ue.filled,focused:ue.focused,required:ue.required};delete ye.ownerState;const we=xW(ye);return be.jsx(bW,{as:T,className:on(we.root,y),ref:a,...ne,ownerState:ye,children:m===" "?lO||(lO=be.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):m})});function SW(e){return Bi("MuiFormLabel",e)}const Bv=Fi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),TW=e=>{const{classes:r,color:a,focused:l,disabled:m,error:y,filled:T,required:i}=e,z={root:["root",`color${sn(a)}`,m&&"disabled",y&&"error",T&&"filled",l&&"focused",i&&"required"],asterisk:["asterisk",y&&"error"]};return Ni(z,SW,r)},EW=pn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.color==="secondary"&&r.colorSecondary,a.filled&&r.filled]}})(Yi(({theme:e})=>({color:(e.vars||e).palette.text.secondary,...e.typography.body1,lineHeight:"1.4375em",padding:0,position:"relative",variants:[...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{[`&.${Bv.focused}`]:{color:(e.vars||e).palette[r].main}}})),{props:{},style:{[`&.${Bv.disabled}`]:{color:(e.vars||e).palette.text.disabled},[`&.${Bv.error}`]:{color:(e.vars||e).palette.error.main}}}]}))),CW=pn("span",{name:"MuiFormLabel",slot:"Asterisk"})(Yi(({theme:e})=>({[`&.${Bv.error}`]:{color:(e.vars||e).palette.error.main}}))),MW=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiFormLabel"}),{children:m,className:y,color:T,component:i="label",disabled:z,error:B,filled:F,focused:G,required:Q,...te}=l,ne=Yd(),oe=u0({props:l,muiFormControl:ne,states:["color","required","focused","disabled","error","filled"]}),ue={...l,color:oe.color||"primary",component:i,disabled:oe.disabled,error:oe.error,filled:oe.filled,focused:oe.focused,required:oe.required},ye=TW(ue);return be.jsxs(EW,{as:i,ownerState:ue,className:on(ye.root,y),ref:a,...te,children:[m,oe.required&&be.jsxs(CW,{ownerState:ue,"aria-hidden":!0,className:ye.asterisk,children:["","*"]})]})}),eC=nG({createStyledComponent:pn("div",{name:"MuiGrid",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.container&&r.container]}}),componentName:"MuiGrid",useThemeProps:e=>Wi({props:e,name:"MuiGrid"}),useTheme:ty});function tC(e){return`scale(${e}, ${e**2})`}const IW={entering:{opacity:1,transform:tC(1)},entered:{opacity:1,transform:"none"}},eT=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),rC=ae.forwardRef(function(r,a){const{addEndListener:l,appear:m=!0,children:y,easing:T,in:i,onEnter:z,onEntered:B,onEntering:F,onExit:G,onExited:Q,onExiting:te,style:ne,timeout:oe="auto",TransitionComponent:ue=Xd,...ye}=r,we=EB(),ve=ae.useRef(),Ce=ty(),Ee=ae.useRef(null),Be=rc(Ee,ry(y),a),Ke=Et=>et=>{if(Et){const Zt=Ee.current;et===void 0?Et(Zt):Et(Zt,et)}},st=Ke(F),dt=Ke((Et,et)=>{D3(Et);const{duration:Zt,delay:ir,easing:or}=F_({style:ne,timeout:oe,easing:T},{mode:"enter"});let ft;oe==="auto"?(ft=Ce.transitions.getAutoHeightDuration(Et.clientHeight),ve.current=ft):ft=Zt,Et.style.transition=[Ce.transitions.create("opacity",{duration:ft,delay:ir}),Ce.transitions.create("transform",{duration:eT?ft:ft*.666,delay:ir,easing:or})].join(","),z&&z(Et,et)}),bt=Ke(B),ht=Ke(te),Re=Ke(Et=>{const{duration:et,delay:Zt,easing:ir}=F_({style:ne,timeout:oe,easing:T},{mode:"exit"});let or;oe==="auto"?(or=Ce.transitions.getAutoHeightDuration(Et.clientHeight),ve.current=or):or=et,Et.style.transition=[Ce.transitions.create("opacity",{duration:or,delay:Zt}),Ce.transitions.create("transform",{duration:eT?or:or*.666,delay:eT?Zt:Zt||or*.333,easing:ir})].join(","),Et.style.opacity=0,Et.style.transform=tC(.75),G&&G(Et)}),Pt=Ke(Q),wt=Et=>{oe==="auto"&&we.start(ve.current||0,Et),l&&l(Ee.current,Et)};return be.jsx(ue,{appear:m,in:i,nodeRef:Ee,onEnter:dt,onEntered:bt,onEntering:st,onExit:Re,onExited:Pt,onExiting:ht,addEndListener:wt,timeout:oe==="auto"?null:oe,...ye,children:(Et,{ownerState:et,...Zt})=>ae.cloneElement(y,{style:{opacity:0,transform:tC(.75),visibility:Et==="exited"&&!i?"hidden":void 0,...IW[Et],...ne,...y.props.style},ref:Be,...Zt})})});rC&&(rC.muiSupportAuto=!0);const PW=e=>{const{classes:r,disableUnderline:a}=e,m=Ni({root:["root",!a&&"underline"],input:["input"]},QH,r);return{...r,...m}},RW=pn(qw,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiInput",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[...Gw(e,r),!a.disableUnderline&&r.underline]}})(Yi(({theme:e})=>{let a=e.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return e.vars&&(a=e.alpha(e.vars.palette.common.onBackground,e.vars.opacity.inputUnderline)),{position:"relative",variants:[{props:({ownerState:l})=>l.formControl,style:{"label + &":{marginTop:16}}},{props:({ownerState:l})=>!l.disableUnderline,style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${fv.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${fv.error}`]:{"&::before, &::after":{borderBottomColor:(e.vars||e).palette.error.main}},"&::before":{borderBottom:`1px solid ${a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${fv.disabled}, .${fv.error}):before`]:{borderBottom:`2px solid ${(e.vars||e).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${a}`}},[`&.${fv.disabled}:before`]:{borderBottomStyle:"dotted"}}},...Object.entries(e.palette).filter(rl()).map(([l])=>({props:{color:l,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(e.vars||e).palette[l].main}`}}}))]}})),DW=pn(Ww,{name:"MuiInput",slot:"Input",overridesResolver:Hw})({}),L3=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiInput"}),{disableUnderline:m=!1,components:y={},componentsProps:T,fullWidth:i=!1,inputComponent:z="input",multiline:B=!1,slotProps:F,slots:G={},type:Q="text",...te}=l,ne=PW(l),ue={root:{ownerState:{disableUnderline:m}}},ye=F??T?Kc(F??T,ue):ue,we=G.root??y.Root??RW,ve=G.input??y.Input??DW;return be.jsx(O3,{slots:{root:we,input:ve},slotProps:ye,fullWidth:i,inputComponent:z,multiline:B,ref:a,type:Q,...te,classes:ne})});L3.muiName="Input";function OW(e){return Bi("MuiInputAdornment",e)}const cO=Fi("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]);var uO;const kW=(e,r)=>{const{ownerState:a}=e;return[r.root,r[`position${sn(a.position)}`],a.disablePointerEvents===!0&&r.disablePointerEvents,r[a.variant]]},zW=e=>{const{classes:r,disablePointerEvents:a,hiddenLabel:l,position:m,size:y,variant:T}=e,i={root:["root",a&&"disablePointerEvents",m&&`position${sn(m)}`,T,l&&"hiddenLabel",y&&`size${sn(y)}`]};return Ni(i,OW,r)},LW=pn("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:kW})(Yi(({theme:e})=>({display:"flex",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(e.vars||e).palette.action.active,variants:[{props:{variant:"filled"},style:{[`&.${cO.positionStart}&:not(.${cO.hiddenLabel})`]:{marginTop:16}}},{props:{position:"start"},style:{marginRight:8}},{props:{position:"end"},style:{marginLeft:8}},{props:{disablePointerEvents:!0},style:{pointerEvents:"none"}}]}))),BW=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiInputAdornment"}),{children:m,className:y,component:T="div",disablePointerEvents:i=!1,disableTypography:z=!1,position:B,variant:F,...G}=l,Q=Yd()||{};let te=F;F&&Q.variant,Q&&!te&&(te=Q.variant);const ne={...l,hiddenLabel:Q.hiddenLabel,size:Q.size,disablePointerEvents:i,position:B,variant:te},oe=zW(ne);return be.jsx($w.Provider,{value:null,children:be.jsx(LW,{as:T,ownerState:ne,className:on(oe.root,y),ref:a,...G,children:typeof m=="string"&&!z?be.jsx(tl,{color:"textSecondary",children:m}):be.jsxs(ae.Fragment,{children:[B==="start"?uO||(uO=be.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):null,m]})})})});function FW(e){return Bi("MuiInputLabel",e)}Fi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const NW=e=>{const{classes:r,formControl:a,size:l,shrink:m,disableAnimation:y,variant:T,required:i}=e,z={root:["root",a&&"formControl",!y&&"animated",m&&"shrink",l&&l!=="medium"&&`size${sn(l)}`,T],asterisk:[i&&"asterisk"]},B=Ni(z,FW,r);return{...r,...B}},jW=pn(MW,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`& .${Bv.asterisk}`]:r.asterisk},r.root,a.formControl&&r.formControl,a.size==="small"&&r.sizeSmall,a.shrink&&r.shrink,!a.disableAnimation&&r.animated,a.focused&&r.focused,r[a.variant]]}})(Yi(({theme:e})=>({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",variants:[{props:({ownerState:r})=>r.formControl,style:{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"}},{props:{size:"small"},style:{transform:"translate(0, 17px) scale(1)"}},{props:({ownerState:r})=>r.shrink,style:{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"}},{props:({ownerState:r})=>!r.disableAnimation,style:{transition:e.transitions.create(["color","transform","max-width"],{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut})}},{props:{variant:"filled"},style:{zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"filled",size:"small"},style:{transform:"translate(12px, 13px) scale(1)"}},{props:({variant:r,ownerState:a})=>r==="filled"&&a.shrink,style:{userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"}},{props:({variant:r,ownerState:a,size:l})=>r==="filled"&&a.shrink&&l==="small",style:{transform:"translate(12px, 4px) scale(0.75)"}},{props:{variant:"outlined"},style:{zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"}},{props:{variant:"outlined",size:"small"},style:{transform:"translate(14px, 9px) scale(1)"}},{props:({variant:r,ownerState:a})=>r==="outlined"&&a.shrink,style:{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}}]}))),FB=ae.forwardRef(function(r,a){const l=Wi({name:"MuiInputLabel",props:r}),{disableAnimation:m=!1,margin:y,shrink:T,variant:i,className:z,...B}=l,F=Yd();let G=T;typeof G>"u"&&F&&(G=F.filled||F.focused||F.adornedStart);const Q=u0({props:l,muiFormControl:F,states:["size","variant","required","focused"]}),te={...l,disableAnimation:m,formControl:F,shrink:G,size:Q.size,variant:Q.variant,required:Q.required,focused:Q.focused},ne=NW(te);return be.jsx(jW,{"data-shrink":G,ref:a,className:on(ne.root,z),...B,ownerState:te,classes:ne})});function UW(e){return Bi("MuiLinearProgress",e)}Fi("MuiLinearProgress",["root","colorPrimary","colorSecondary","determinate","indeterminate","buffer","query","dashed","dashedColorPrimary","dashedColorSecondary","bar","bar1","bar2","barColorPrimary","barColorSecondary","bar1Indeterminate","bar1Determinate","bar1Buffer","bar2Indeterminate","bar2Buffer"]);const nC=4,iC=l0`
  0% {
    left: -35%;
    right: 100%;
  }

  60% {
    left: 100%;
    right: -90%;
  }

  100% {
    left: 100%;
    right: -90%;
  }
`,VW=typeof iC!="string"?K_`
        animation: ${iC} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
      `:null,oC=l0`
  0% {
    left: -200%;
    right: 100%;
  }

  60% {
    left: 107%;
    right: -8%;
  }

  100% {
    left: 107%;
    right: -8%;
  }
`,$W=typeof oC!="string"?K_`
        animation: ${oC} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;
      `:null,aC=l0`
  0% {
    opacity: 1;
    background-position: 0 -23px;
  }

  60% {
    opacity: 0;
    background-position: 0 -23px;
  }

  100% {
    opacity: 1;
    background-position: -200px -23px;
  }
`,GW=typeof aC!="string"?K_`
        animation: ${aC} 3s infinite linear;
      `:null,HW=e=>{const{classes:r,variant:a,color:l}=e,m={root:["root",`color${sn(l)}`,a],dashed:["dashed",`dashedColor${sn(l)}`],bar1:["bar","bar1",`barColor${sn(l)}`,(a==="indeterminate"||a==="query")&&"bar1Indeterminate",a==="determinate"&&"bar1Determinate",a==="buffer"&&"bar1Buffer"],bar2:["bar","bar2",a!=="buffer"&&`barColor${sn(l)}`,a==="buffer"&&`color${sn(l)}`,(a==="indeterminate"||a==="query")&&"bar2Indeterminate",a==="buffer"&&"bar2Buffer"]};return Ni(m,UW,r)},B3=(e,r)=>e.vars?e.vars.palette.LinearProgress[`${r}Bg`]:e.palette.mode==="light"?e.lighten(e.palette[r].main,.62):e.darken(e.palette[r].main,.5),qW=pn("span",{name:"MuiLinearProgress",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[`color${sn(a.color)}`],r[a.variant]]}})(Yi(({theme:e})=>({position:"relative",overflow:"hidden",display:"block",height:4,zIndex:0,"@media print":{colorAdjust:"exact"},variants:[...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{backgroundColor:B3(e,r)}})),{props:({ownerState:r})=>r.color==="inherit"&&r.variant!=="buffer",style:{"&::before":{content:'""',position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:"currentColor",opacity:.3}}},{props:{variant:"buffer"},style:{backgroundColor:"transparent"}},{props:{variant:"query"},style:{transform:"rotate(180deg)"}}]}))),WW=pn("span",{name:"MuiLinearProgress",slot:"Dashed",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.dashed,r[`dashedColor${sn(a.color)}`]]}})(Yi(({theme:e})=>({position:"absolute",marginTop:0,height:"100%",width:"100%",backgroundSize:"10px 10px",backgroundPosition:"0 -23px",variants:[{props:{color:"inherit"},style:{opacity:.3,backgroundImage:"radial-gradient(currentColor 0%, currentColor 16%, transparent 42%)"}},...Object.entries(e.palette).filter(rl()).map(([r])=>{const a=B3(e,r);return{props:{color:r},style:{backgroundImage:`radial-gradient(${a} 0%, ${a} 16%, transparent 42%)`}}})]})),GW||{animation:`${aC} 3s infinite linear`}),ZW=pn("span",{name:"MuiLinearProgress",slot:"Bar1",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.bar,r.bar1,r[`barColor${sn(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&r.bar1Indeterminate,a.variant==="determinate"&&r.bar1Determinate,a.variant==="buffer"&&r.bar1Buffer]}})(Yi(({theme:e})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[{props:{color:"inherit"},style:{backgroundColor:"currentColor"}},...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{backgroundColor:(e.vars||e).palette[r].main}})),{props:{variant:"determinate"},style:{transition:`transform .${nC}s linear`}},{props:{variant:"buffer"},style:{zIndex:1,transition:`transform .${nC}s linear`}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:VW||{animation:`${iC} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite`}}]}))),XW=pn("span",{name:"MuiLinearProgress",slot:"Bar2",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.bar,r.bar2,r[`barColor${sn(a.color)}`],(a.variant==="indeterminate"||a.variant==="query")&&r.bar2Indeterminate,a.variant==="buffer"&&r.bar2Buffer]}})(Yi(({theme:e})=>({width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left",variants:[...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r},style:{"--LinearProgressBar2-barColor":(e.vars||e).palette[r].main}})),{props:({ownerState:r})=>r.variant!=="buffer"&&r.color!=="inherit",style:{backgroundColor:"var(--LinearProgressBar2-barColor, currentColor)"}},{props:({ownerState:r})=>r.variant!=="buffer"&&r.color==="inherit",style:{backgroundColor:"currentColor"}},{props:{color:"inherit"},style:{opacity:.3}},...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r,variant:"buffer"},style:{backgroundColor:B3(e,r),transition:`transform .${nC}s linear`}})),{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:{width:"auto"}},{props:({ownerState:r})=>r.variant==="indeterminate"||r.variant==="query",style:$W||{animation:`${oC} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite`}}]}))),YW=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiLinearProgress"}),{className:m,color:y="primary",value:T,valueBuffer:i,variant:z="indeterminate",...B}=l,F={...l,color:y,variant:z},G=HW(F),Q=jw(),te={},ne={bar1:{},bar2:{}};if((z==="determinate"||z==="buffer")&&T!==void 0){te["aria-valuenow"]=Math.round(T),te["aria-valuemin"]=0,te["aria-valuemax"]=100;let oe=T-100;Q&&(oe=-oe),ne.bar1.transform=`translateX(${oe}%)`}if(z==="buffer"&&i!==void 0){let oe=(i||0)-100;Q&&(oe=-oe),ne.bar2.transform=`translateX(${oe}%)`}return be.jsxs(qW,{className:on(G.root,m),ownerState:F,role:"progressbar",...te,ref:a,...B,children:[z==="buffer"?be.jsx(WW,{className:G.dashed,ownerState:F}):null,be.jsx(ZW,{className:G.bar1,ownerState:F,style:ne.bar1}),z==="determinate"?null:be.jsx(XW,{className:G.bar2,ownerState:F,style:ne.bar2})]})}),Nm=ae.createContext({});function QW(e){return Bi("MuiList",e)}Fi("MuiList",["root","padding","dense","subheader"]);const KW=e=>{const{classes:r,disablePadding:a,dense:l,subheader:m}=e;return Ni({root:["root",!a&&"padding",l&&"dense",m&&"subheader"]},QW,r)},JW=pn("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.disablePadding&&r.padding,a.dense&&r.dense,a.subheader&&r.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:e})=>!e.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:e})=>e.subheader,style:{paddingTop:0}}]}),mx=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiList"}),{children:m,className:y,component:T="ul",dense:i=!1,disablePadding:z=!1,subheader:B,...F}=l,G=ae.useMemo(()=>({dense:i}),[i]),Q={...l,component:T,dense:i,disablePadding:z},te=KW(Q);return be.jsx(Nm.Provider,{value:G,children:be.jsxs(JW,{as:T,className:on(te.root,y),ref:a,ownerState:Q,...F,children:[B,m]})})});function eZ(e){return Bi("MuiListItem",e)}Fi("MuiListItem",["root","container","dense","alignItemsFlexStart","divider","gutters","padding","secondaryAction"]);const tZ=Fi("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function rZ(e){return Bi("MuiListItemSecondaryAction",e)}Fi("MuiListItemSecondaryAction",["root","disableGutters"]);const nZ=e=>{const{disableGutters:r,classes:a}=e;return Ni({root:["root",r&&"disableGutters"]},rZ,a)},iZ=pn("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.disableGutters&&r.disableGutters]}})({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)",variants:[{props:({ownerState:e})=>e.disableGutters,style:{right:0}}]}),NB=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiListItemSecondaryAction"}),{className:m,...y}=l,T=ae.useContext(Nm),i={...l,disableGutters:T.disableGutters},z=nZ(i);return be.jsx(iZ,{className:on(z.root,m),ownerState:i,ref:a,...y})});NB.muiName="ListItemSecondaryAction";const oZ=(e,r)=>{const{ownerState:a}=e;return[r.root,a.dense&&r.dense,a.alignItems==="flex-start"&&r.alignItemsFlexStart,a.divider&&r.divider,!a.disableGutters&&r.gutters,!a.disablePadding&&r.padding,a.hasSecondaryAction&&r.secondaryAction]},aZ=e=>{const{alignItems:r,classes:a,dense:l,disableGutters:m,disablePadding:y,divider:T,hasSecondaryAction:i}=e;return Ni({root:["root",l&&"dense",!m&&"gutters",!y&&"padding",T&&"divider",r==="flex-start"&&"alignItemsFlexStart",i&&"secondaryAction"],container:["container"]},eZ,a)},sZ=pn("div",{name:"MuiListItem",slot:"Root",overridesResolver:oZ})(Yi(({theme:e})=>({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",variants:[{props:({ownerState:r})=>!r.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:r})=>!r.disablePadding&&r.dense,style:{paddingTop:4,paddingBottom:4}},{props:({ownerState:r})=>!r.disablePadding&&!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>!r.disablePadding&&!!r.secondaryAction,style:{paddingRight:48}},{props:({ownerState:r})=>!!r.secondaryAction,style:{[`& > .${tZ.root}`]:{paddingRight:48}}},{props:{alignItems:"flex-start"},style:{alignItems:"flex-start"}},{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:r})=>r.button,style:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}},{props:({ownerState:r})=>r.hasSecondaryAction,style:{paddingRight:48}}]}))),lZ=pn("li",{name:"MuiListItem",slot:"Container"})({position:"relative"}),Js=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiListItem"}),{alignItems:m="center",children:y,className:T,component:i,components:z={},componentsProps:B={},ContainerComponent:F="li",ContainerProps:{className:G,...Q}={},dense:te=!1,disableGutters:ne=!1,disablePadding:oe=!1,divider:ue=!1,secondaryAction:ye,slotProps:we={},slots:ve={},...Ce}=l,Ee=ae.useContext(Nm),Be=ae.useMemo(()=>({dense:te||Ee.dense||!1,alignItems:m,disableGutters:ne}),[m,Ee.dense,te,ne]),Ke=ae.useRef(null),st=ae.Children.toArray(y),dt=st.length&&zv(st[st.length-1],["ListItemSecondaryAction"]),bt={...l,alignItems:m,dense:Be.dense,disableGutters:ne,disablePadding:oe,divider:ue,hasSecondaryAction:dt},ht=aZ(bt),Re=rc(Ke,a),Pt=ve.root||z.Root||sZ,wt=we.root||B.root||{},Et={className:on(ht.root,wt.className,T),...Ce};let et=i||"li";return dt?(et=!Et.component&&!i?"div":et,F==="li"&&(et==="li"?et="div":Et.component==="li"&&(Et.component="div")),be.jsx(Nm.Provider,{value:Be,children:be.jsxs(lZ,{as:F,className:on(ht.container,G),ref:Re,ownerState:bt,...Q,children:[be.jsx(Pt,{...wt,...!N_(Pt)&&{as:et,ownerState:{...bt,...wt.ownerState}},...Et,children:st}),st.pop()]})})):be.jsx(Nm.Provider,{value:Be,children:be.jsxs(Pt,{...wt,as:et,ref:Re,...!N_(Pt)&&{ownerState:{...bt,...wt.ownerState}},...Et,children:[st,ye&&be.jsx(NB,{children:ye})]})})});function cZ(e){return Bi("MuiListItemIcon",e)}const hO=Fi("MuiListItemIcon",["root","alignItemsFlexStart"]),uZ=e=>{const{alignItems:r,classes:a}=e;return Ni({root:["root",r==="flex-start"&&"alignItemsFlexStart"]},cZ,a)},hZ=pn("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.alignItems==="flex-start"&&r.alignItemsFlexStart]}})(Yi(({theme:e})=>({minWidth:56,color:(e.vars||e).palette.action.active,flexShrink:0,display:"inline-flex",variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}))),ec=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiListItemIcon"}),{className:m,...y}=l,T=ae.useContext(Nm),i={...l,alignItems:T.alignItems},z=uZ(i);return be.jsx(hZ,{className:on(z.root,m),ownerState:i,ref:a,...y})});function fZ(e){return Bi("MuiListItemText",e)}const I_=Fi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),dZ=e=>{const{classes:r,inset:a,primary:l,secondary:m,dense:y}=e;return Ni({root:["root",a&&"inset",y&&"dense",l&&m&&"multiline"],primary:["primary"],secondary:["secondary"]},fZ,r)},pZ=pn("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`& .${I_.primary}`]:r.primary},{[`& .${I_.secondary}`]:r.secondary},r.root,a.inset&&r.inset,a.primary&&a.secondary&&r.multiline,a.dense&&r.dense]}})({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4,[`.${XD.root}:where(& .${I_.primary})`]:{display:"block"},[`.${XD.root}:where(& .${I_.secondary})`]:{display:"block"},variants:[{props:({ownerState:e})=>e.primary&&e.secondary,style:{marginTop:6,marginBottom:6}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:56}}]}),el=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiListItemText"}),{children:m,className:y,disableTypography:T=!1,inset:i=!1,primary:z,primaryTypographyProps:B,secondary:F,secondaryTypographyProps:G,slots:Q={},slotProps:te={},...ne}=l,{dense:oe}=ae.useContext(Nm);let ue=z??m,ye=F;const we={...l,disableTypography:T,inset:i,primary:!!ue,secondary:!!ye,dense:oe},ve=dZ(we),Ce={slots:Q,slotProps:{primary:B,secondary:G,...te}},[Ee,Be]=pa("root",{className:on(ve.root,y),elementType:pZ,externalForwardedProps:{...Ce,...ne},ownerState:we,ref:a}),[Ke,st]=pa("primary",{className:ve.primary,elementType:tl,externalForwardedProps:Ce,ownerState:we}),[dt,bt]=pa("secondary",{className:ve.secondary,elementType:tl,externalForwardedProps:Ce,ownerState:we});return ue!=null&&ue.type!==tl&&!T&&(ue=be.jsx(Ke,{variant:oe?"body2":"body1",component:st?.variant?void 0:"span",...st,children:ue})),ye!=null&&ye.type!==tl&&!T&&(ye=be.jsx(dt,{variant:"body2",color:"textSecondary",...bt,children:ye})),be.jsxs(Ee,{...Be,children:[ue,ye]})});function tT(e,r,a){return e===r?e.firstChild:r&&r.nextElementSibling?r.nextElementSibling:a?null:e.firstChild}function fO(e,r,a){return e===r?a?e.firstChild:e.lastChild:r&&r.previousElementSibling?r.previousElementSibling:a?null:e.lastChild}function jB(e,r){if(r===void 0)return!0;let a=e.innerText;return a===void 0&&(a=e.textContent),a=a.trim().toLowerCase(),a.length===0?!1:r.repeating?a[0]===r.keys[0]:a.startsWith(r.keys.join(""))}function dv(e,r,a,l,m,y){let T=!1,i=m(e,r,r?a:!1);for(;i;){if(i===e.firstChild){if(T)return!1;T=!0}const z=l?!1:i.disabled||i.getAttribute("aria-disabled")==="true";if(!i.hasAttribute("tabindex")||!jB(i,y)||z)i=m(e,i,a);else return i.focus(),!0}return!1}const mZ=ae.forwardRef(function(r,a){const{actions:l,autoFocus:m=!1,autoFocusItem:y=!1,children:T,className:i,disabledItemsFocusable:z=!1,disableListWrap:B=!1,onKeyDown:F,variant:G="selectedMenu",...Q}=r,te=ae.useRef(null),ne=ae.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});Hp(()=>{m&&te.current.focus()},[m]),ae.useImperativeHandle(l,()=>({adjustStyleForScrollbar:(ve,{direction:Ce})=>{const Ee=!te.current.style.width;if(ve.clientHeight<te.current.clientHeight&&Ee){const Be=`${kB(Zd(ve))}px`;te.current.style[Ce==="rtl"?"paddingLeft":"paddingRight"]=Be,te.current.style.width=`calc(100% + ${Be})`}return te.current}}),[]);const oe=ve=>{const Ce=te.current,Ee=ve.key;if(ve.ctrlKey||ve.metaKey||ve.altKey){F&&F(ve);return}const Ke=Wd(Ce).activeElement;if(Ee==="ArrowDown")ve.preventDefault(),dv(Ce,Ke,B,z,tT);else if(Ee==="ArrowUp")ve.preventDefault(),dv(Ce,Ke,B,z,fO);else if(Ee==="Home")ve.preventDefault(),dv(Ce,null,B,z,tT);else if(Ee==="End")ve.preventDefault(),dv(Ce,null,B,z,fO);else if(Ee.length===1){const st=ne.current,dt=Ee.toLowerCase(),bt=performance.now();st.keys.length>0&&(bt-st.lastTime>500?(st.keys=[],st.repeating=!0,st.previousKeyMatched=!0):st.repeating&&dt!==st.keys[0]&&(st.repeating=!1)),st.lastTime=bt,st.keys.push(dt);const ht=Ke&&!st.repeating&&jB(Ke,st);st.previousKeyMatched&&(ht||dv(Ce,Ke,!1,z,tT,st))?ve.preventDefault():st.previousKeyMatched=!1}F&&F(ve)},ue=rc(te,a);let ye=-1;ae.Children.forEach(T,(ve,Ce)=>{if(!ae.isValidElement(ve)){ye===Ce&&(ye+=1,ye>=T.length&&(ye=-1));return}ve.props.disabled||(G==="selectedMenu"&&ve.props.selected||ye===-1)&&(ye=Ce),ye===Ce&&(ve.props.disabled||ve.props.muiSkipListHighlight||ve.type.muiSkipListHighlight)&&(ye+=1,ye>=T.length&&(ye=-1))});const we=ae.Children.map(T,(ve,Ce)=>{if(Ce===ye){const Ee={};return y&&(Ee.autoFocus=!0),ve.props.tabIndex===void 0&&G==="selectedMenu"&&(Ee.tabIndex=0),ae.cloneElement(ve,Ee)}return ve});return be.jsx(mx,{role:"menu",ref:ue,className:i,onKeyDown:oe,tabIndex:m?0:-1,...Q,children:we})});function AZ(e){return Bi("MuiPopover",e)}Fi("MuiPopover",["root","paper"]);function dO(e,r){let a=0;return typeof r=="number"?a=r:r==="center"?a=e.height/2:r==="bottom"&&(a=e.height),a}function pO(e,r){let a=0;return typeof r=="number"?a=r:r==="center"?a=e.width/2:r==="right"&&(a=e.width),a}function mO(e){return[e.horizontal,e.vertical].map(r=>typeof r=="number"?`${r}px`:r).join(" ")}function nb(e){return typeof e=="function"?e():e}const gZ=e=>{const{classes:r}=e;return Ni({root:["root"],paper:["paper"]},AZ,r)},_Z=pn(zB,{name:"MuiPopover",slot:"Root"})({}),UB=pn(dx,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),yZ=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiPopover"}),{action:m,anchorEl:y,anchorOrigin:T={vertical:"top",horizontal:"left"},anchorPosition:i,anchorReference:z="anchorEl",children:B,className:F,container:G,elevation:Q=8,marginThreshold:te=16,open:ne,PaperProps:oe={},slots:ue={},slotProps:ye={},transformOrigin:we={vertical:"top",horizontal:"left"},TransitionComponent:ve,transitionDuration:Ce="auto",TransitionProps:Ee={},disableScrollLock:Be=!1,...Ke}=l,st=ae.useRef(),dt={...l,anchorOrigin:T,anchorReference:z,elevation:Q,marginThreshold:te,transformOrigin:we,TransitionComponent:ve,transitionDuration:Ce,TransitionProps:Ee},bt=gZ(dt),ht=ae.useCallback(()=>{if(z==="anchorPosition")return i;const Gr=nb(y),Tr=(Gr&&Gr.nodeType===1?Gr:Wd(st.current).body).getBoundingClientRect();return{top:Tr.top+dO(Tr,T.vertical),left:Tr.left+pO(Tr,T.horizontal)}},[y,T.horizontal,T.vertical,i,z]),Re=ae.useCallback(Gr=>({vertical:dO(Gr,we.vertical),horizontal:pO(Gr,we.horizontal)}),[we.horizontal,we.vertical]),Pt=ae.useCallback(Gr=>{const Sn={width:Gr.offsetWidth,height:Gr.offsetHeight},Tr=Re(Sn);if(z==="none")return{top:null,left:null,transformOrigin:mO(Tr)};const Zi=ht();let wn=Zi.top-Tr.vertical,Rn=Zi.left-Tr.horizontal;const mo=wn+Sn.height,di=Rn+Sn.width,Ao=Zd(nb(y)),eo=Ao.innerHeight-te,$o=Ao.innerWidth-te;if(te!==null&&wn<te){const _i=wn-te;wn-=_i,Tr.vertical+=_i}else if(te!==null&&mo>eo){const _i=mo-eo;wn-=_i,Tr.vertical+=_i}if(te!==null&&Rn<te){const _i=Rn-te;Rn-=_i,Tr.horizontal+=_i}else if(di>$o){const _i=di-$o;Rn-=_i,Tr.horizontal+=_i}return{top:`${Math.round(wn)}px`,left:`${Math.round(Rn)}px`,transformOrigin:mO(Tr)}},[y,z,ht,Re,te]),[wt,Et]=ae.useState(ne),et=ae.useCallback(()=>{const Gr=st.current;if(!Gr)return;const Sn=Pt(Gr);Sn.top!==null&&Gr.style.setProperty("top",Sn.top),Sn.left!==null&&(Gr.style.left=Sn.left),Gr.style.transformOrigin=Sn.transformOrigin,Et(!0)},[Pt]);ae.useEffect(()=>(Be&&window.addEventListener("scroll",et),()=>window.removeEventListener("scroll",et)),[y,Be,et]);const Zt=()=>{et()},ir=()=>{Et(!1)};ae.useEffect(()=>{ne&&et()}),ae.useImperativeHandle(m,()=>ne?{updatePosition:()=>{et()}}:null,[ne,et]),ae.useEffect(()=>{if(!ne)return;const Gr=C3(()=>{et()}),Sn=Zd(nb(y));return Sn.addEventListener("resize",Gr),()=>{Gr.clear(),Sn.removeEventListener("resize",Gr)}},[y,ne,et]);let or=Ce;const ft={slots:{transition:ve,...ue},slotProps:{transition:Ee,paper:oe,...ye}},[Vt,Jt]=pa("transition",{elementType:rC,externalForwardedProps:ft,ownerState:dt,getSlotProps:Gr=>({...Gr,onEntering:(Sn,Tr)=>{Gr.onEntering?.(Sn,Tr),Zt()},onExited:Sn=>{Gr.onExited?.(Sn),ir()}}),additionalProps:{appear:!0,in:ne}});Ce==="auto"&&!Vt.muiSupportAuto&&(or=void 0);const Cr=G||(y?Wd(nb(y)).body:void 0),[ln,{slots:tn,slotProps:Hr,...Nn}]=pa("root",{ref:a,elementType:_Z,externalForwardedProps:{...ft,...Ke},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:ue.backdrop},slotProps:{backdrop:xB(typeof ye.backdrop=="function"?ye.backdrop(dt):ye.backdrop,{invisible:!0})},container:Cr,open:ne},ownerState:dt,className:on(bt.root,F)}),[jn,Ur]=pa("paper",{ref:st,className:bt.paper,elementType:UB,externalForwardedProps:ft,shouldForwardComponentProp:!0,additionalProps:{elevation:Q,style:wt?void 0:{opacity:0}},ownerState:dt});return be.jsx(ln,{...Nn,...!N_(ln)&&{slots:tn,slotProps:Hr,disableScrollLock:Be},children:be.jsx(Vt,{...Jt,timeout:or,children:be.jsx(jn,{...Ur,children:B})})})});function vZ(e){return Bi("MuiMenu",e)}Fi("MuiMenu",["root","paper","list"]);const xZ={vertical:"top",horizontal:"right"},bZ={vertical:"top",horizontal:"left"},wZ=e=>{const{classes:r}=e;return Ni({root:["root"],paper:["paper"],list:["list"]},vZ,r)},SZ=pn(yZ,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiMenu",slot:"Root"})({}),TZ=pn(UB,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),EZ=pn(mZ,{name:"MuiMenu",slot:"List"})({outline:0}),CZ=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiMenu"}),{autoFocus:m=!0,children:y,className:T,disableAutoFocusItem:i=!1,MenuListProps:z={},onClose:B,open:F,PaperProps:G={},PopoverClasses:Q,transitionDuration:te="auto",TransitionProps:{onEntering:ne,...oe}={},variant:ue="selectedMenu",slots:ye={},slotProps:we={},...ve}=l,Ce=jw(),Ee={...l,autoFocus:m,disableAutoFocusItem:i,MenuListProps:z,onEntering:ne,PaperProps:G,transitionDuration:te,TransitionProps:oe,variant:ue},Be=wZ(Ee),Ke=m&&!i&&F,st=ae.useRef(null),dt=(or,ft)=>{st.current&&st.current.adjustStyleForScrollbar(or,{direction:Ce?"rtl":"ltr"}),ne&&ne(or,ft)},bt=or=>{or.key==="Tab"&&(or.preventDefault(),B&&B(or,"tabKeyDown"))};let ht=-1;ae.Children.map(y,(or,ft)=>{ae.isValidElement(or)&&(or.props.disabled||(ue==="selectedMenu"&&or.props.selected||ht===-1)&&(ht=ft))});const Re={slots:ye,slotProps:{list:z,transition:oe,paper:G,...we}},Pt=VH({elementType:ye.root,externalSlotProps:we.root,ownerState:Ee,className:[Be.root,T]}),[wt,Et]=pa("paper",{className:Be.paper,elementType:TZ,externalForwardedProps:Re,shouldForwardComponentProp:!0,ownerState:Ee}),[et,Zt]=pa("list",{className:on(Be.list,z.className),elementType:EZ,shouldForwardComponentProp:!0,externalForwardedProps:Re,getSlotProps:or=>({...or,onKeyDown:ft=>{bt(ft),or.onKeyDown?.(ft)}}),ownerState:Ee}),ir=typeof Re.slotProps.transition=="function"?Re.slotProps.transition(Ee):Re.slotProps.transition;return be.jsx(SZ,{onClose:B,anchorOrigin:{vertical:"bottom",horizontal:Ce?"right":"left"},transformOrigin:Ce?xZ:bZ,slots:{root:ye.root,paper:wt,backdrop:ye.backdrop,...ye.transition&&{transition:ye.transition}},slotProps:{root:Pt,paper:Et,backdrop:typeof we.backdrop=="function"?we.backdrop(Ee):we.backdrop,transition:{...ir,onEntering:(...or)=>{dt(...or),ir?.onEntering?.(...or)}}},open:F,ref:a,transitionDuration:te,ownerState:Ee,...ve,classes:Q,children:be.jsx(et,{actions:st,autoFocus:m&&(ht===-1||i),autoFocusItem:Ke,variant:ue,...Zt,children:y})})});function MZ(e){return Bi("MuiMenuItem",e)}const pv=Fi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),IZ=(e,r)=>{const{ownerState:a}=e;return[r.root,a.dense&&r.dense,a.divider&&r.divider,!a.disableGutters&&r.gutters]},PZ=e=>{const{disabled:r,dense:a,divider:l,disableGutters:m,selected:y,classes:T}=e,z=Ni({root:["root",a&&"dense",r&&"disabled",!m&&"gutters",l&&"divider",y&&"selected"]},MZ,T);return{...T,...z}},RZ=pn(px,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:IZ})(Yi(({theme:e})=>({...e.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${pv.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${pv.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${pv.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${pv.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${pv.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},[`& + .${aO.root}`]:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},[`& + .${aO.inset}`]:{marginLeft:52},[`& .${I_.root}`]:{marginTop:0,marginBottom:0},[`& .${I_.inset}`]:{paddingLeft:36},[`& .${hO.root}`]:{minWidth:36},variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:r})=>r.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:r})=>!r.dense,style:{[e.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:r})=>r.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...e.typography.body2,[`& .${hO.root} svg`]:{fontSize:"1.25rem"}}}]}))),KA=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiMenuItem"}),{autoFocus:m=!1,component:y="li",dense:T=!1,divider:i=!1,disableGutters:z=!1,focusVisibleClassName:B,role:F="menuitem",tabIndex:G,className:Q,...te}=l,ne=ae.useContext(Nm),oe=ae.useMemo(()=>({dense:T||ne.dense||!1,disableGutters:z}),[ne.dense,T,z]),ue=ae.useRef(null);Hp(()=>{m&&ue.current&&ue.current.focus()},[m]);const ye={...l,dense:oe.dense,divider:i,disableGutters:z},we=PZ(l),ve=rc(ue,a);let Ce;return l.disabled||(Ce=G!==void 0?G:-1),be.jsx(Nm.Provider,{value:oe,children:be.jsx(RZ,{ref:ve,role:F,tabIndex:Ce,component:y,focusVisibleClassName:on(we.focusVisible,B),className:on(we.root,Q),...te,ownerState:ye,classes:we})})});function DZ(e){return Bi("MuiNativeSelect",e)}const F3=Fi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),OZ=e=>{const{classes:r,variant:a,disabled:l,multiple:m,open:y,error:T}=e,i={select:["select",a,l&&"disabled",m&&"multiple",T&&"error"],icon:["icon",`icon${sn(a)}`,y&&"iconOpen",l&&"disabled"]};return Ni(i,DZ,r)},VB=pn("select",{name:"MuiNativeSelect"})(({theme:e})=>({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":{borderRadius:0},[`&.${F3.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},variants:[{props:({ownerState:r})=>r.variant!=="filled"&&r.variant!=="outlined",style:{"&&&":{paddingRight:24,minWidth:16}}},{props:{variant:"filled"},style:{"&&&":{paddingRight:32}}},{props:{variant:"outlined"},style:{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}}]})),kZ=pn(VB,{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:eu,overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.select,r[a.variant],a.error&&r.error,{[`&.${F3.multiple}`]:r.multiple}]}})({}),$B=pn("svg",{name:"MuiNativeSelect"})(({theme:e})=>({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${F3.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:({ownerState:r})=>r.open,style:{transform:"rotate(180deg)"}},{props:{variant:"filled"},style:{right:7}},{props:{variant:"outlined"},style:{right:7}}]})),zZ=pn($B,{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.icon,a.variant&&r[`icon${sn(a.variant)}`],a.open&&r.iconOpen]}})({}),LZ=ae.forwardRef(function(r,a){const{className:l,disabled:m,error:y,IconComponent:T,inputRef:i,variant:z="standard",...B}=r,F={...r,disabled:m,variant:z,error:y},G=OZ(F);return be.jsxs(ae.Fragment,{children:[be.jsx(kZ,{ownerState:F,className:on(G.select,l),disabled:m,ref:i||a,...B}),r.multiple?null:be.jsx(zZ,{as:T,ownerState:F,className:G.icon})]})});var AO;const BZ=pn("fieldset",{name:"MuiNotchedOutlined",shouldForwardProp:eu})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),FZ=pn("legend",{name:"MuiNotchedOutlined",shouldForwardProp:eu})(Yi(({theme:e})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:({ownerState:r})=>!r.withLabel,style:{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})}},{props:({ownerState:r})=>r.withLabel,style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:({ownerState:r})=>r.withLabel&&r.notched,style:{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})}}]})));function NZ(e){const{children:r,classes:a,className:l,label:m,notched:y,...T}=e,i=m!=null&&m!=="",z={...e,notched:y,withLabel:i};return be.jsx(BZ,{"aria-hidden":!0,className:l,ownerState:z,...T,children:be.jsx(FZ,{ownerState:z,children:i?be.jsx("span",{children:m}):AO||(AO=be.jsx("span",{className:"notranslate","aria-hidden":!0,children:""}))})})}const jZ=e=>{const{classes:r}=e,l=Ni({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},KH,r);return{...r,...l}},UZ=pn(qw,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:Gw})(Yi(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{position:"relative",borderRadius:(e.vars||e).shape.borderRadius,[`&:hover .${zp.notchedOutline}`]:{borderColor:(e.vars||e).palette.text.primary},"@media (hover: none)":{[`&:hover .${zp.notchedOutline}`]:{borderColor:e.vars?e.alpha(e.vars.palette.common.onBackground,.23):r}},[`&.${zp.focused} .${zp.notchedOutline}`]:{borderWidth:2},variants:[...Object.entries(e.palette).filter(rl()).map(([a])=>({props:{color:a},style:{[`&.${zp.focused} .${zp.notchedOutline}`]:{borderColor:(e.vars||e).palette[a].main}}})),{props:{},style:{[`&.${zp.error} .${zp.notchedOutline}`]:{borderColor:(e.vars||e).palette.error.main},[`&.${zp.disabled} .${zp.notchedOutline}`]:{borderColor:(e.vars||e).palette.action.disabled}}},{props:({ownerState:a})=>a.startAdornment,style:{paddingLeft:14}},{props:({ownerState:a})=>a.endAdornment,style:{paddingRight:14}},{props:({ownerState:a})=>a.multiline,style:{padding:"16.5px 14px"}},{props:({ownerState:a,size:l})=>a.multiline&&l==="small",style:{padding:"8.5px 14px"}}]}})),VZ=pn(NZ,{name:"MuiOutlinedInput",slot:"NotchedOutline"})(Yi(({theme:e})=>{const r=e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:e.vars?e.alpha(e.vars.palette.common.onBackground,.23):r}})),$Z=pn(Ww,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Hw})(Yi(({theme:e})=>({padding:"16.5px 14px",...!e.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:e.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:e.palette.mode==="light"?null:"#fff",caretColor:e.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},...e.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[e.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},variants:[{props:{size:"small"},style:{padding:"8.5px 14px"}},{props:({ownerState:r})=>r.multiline,style:{padding:0}},{props:({ownerState:r})=>r.startAdornment,style:{paddingLeft:0}},{props:({ownerState:r})=>r.endAdornment,style:{paddingRight:0}}]}))),N3=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiOutlinedInput"}),{components:m={},fullWidth:y=!1,inputComponent:T="input",label:i,multiline:z=!1,notched:B,slots:F={},slotProps:G={},type:Q="text",...te}=l,ne=jZ(l),oe=Yd(),ue=u0({props:l,muiFormControl:oe,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),ye={...l,color:ue.color||"primary",disabled:ue.disabled,error:ue.error,focused:ue.focused,formControl:oe,fullWidth:y,hiddenLabel:ue.hiddenLabel,multiline:z,size:ue.size,type:Q},we=F.root??m.Root??UZ,ve=F.input??m.Input??$Z,[Ce,Ee]=pa("notchedOutline",{elementType:VZ,className:ne.notchedOutline,shouldForwardComponentProp:!0,ownerState:ye,externalForwardedProps:{slots:F,slotProps:G},additionalProps:{label:i!=null&&i!==""&&ue.required?be.jsxs(ae.Fragment,{children:[i,"","*"]}):i}});return be.jsx(O3,{slots:{root:we,input:ve},slotProps:G,renderSuffix:Be=>be.jsx(Ce,{...Ee,notched:typeof B<"u"?B:!!(Be.startAdornment||Be.filled||Be.focused)}),fullWidth:y,inputComponent:T,multiline:z,ref:a,type:Q,...te,classes:{...ne,notchedOutline:null}})});N3.muiName="Input";function GZ(e){return Bi("MuiPagination",e)}Fi("MuiPagination",["root","ul","outlined","text"]);function HZ(e={}){const{boundaryCount:r=1,componentName:a="usePagination",count:l=1,defaultPage:m=1,disabled:y=!1,hideNextButton:T=!1,hidePrevButton:i=!1,onChange:z,page:B,showFirstButton:F=!1,showLastButton:G=!1,siblingCount:Q=1,...te}=e,[ne,oe]=Hv({controlled:B,default:m,name:a,state:"page"}),ue=(dt,bt)=>{B||oe(bt),z&&z(dt,bt)},ye=(dt,bt)=>{const ht=bt-dt+1;return Array.from({length:ht},(Re,Pt)=>dt+Pt)},we=ye(1,Math.min(r,l)),ve=ye(Math.max(l-r+1,r+1),l),Ce=Math.max(Math.min(ne-Q,l-r-Q*2-1),r+2),Ee=Math.min(Math.max(ne+Q,r+Q*2+2),l-r-1),Be=[...F?["first"]:[],...i?[]:["previous"],...we,...Ce>r+2?["start-ellipsis"]:r+1<l-r?[r+1]:[],...ye(Ce,Ee),...Ee<l-r-1?["end-ellipsis"]:l-r>r?[l-r]:[],...ve,...T?[]:["next"],...G?["last"]:[]],Ke=dt=>{switch(dt){case"first":return 1;case"previous":return ne-1;case"next":return ne+1;case"last":return l;default:return null}};return{items:Be.map(dt=>typeof dt=="number"?{onClick:bt=>{ue(bt,dt)},type:"page",page:dt,selected:dt===ne,disabled:y,"aria-current":dt===ne?"page":void 0}:{onClick:bt=>{ue(bt,Ke(dt))},type:dt,page:Ke(dt),selected:!1,disabled:y||!dt.includes("ellipsis")&&(dt==="next"||dt==="last"?ne>=l:ne<=1)}),...te}}function qZ(e){return Bi("MuiPaginationItem",e)}const Uu=Fi("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),WZ=Fl(be.jsx("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"})),ZZ=Fl(be.jsx("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"})),XZ=Fl(be.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),YZ=Fl(be.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),GB=(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`size${sn(a.size)}`],a.variant==="text"&&r[`text${sn(a.color)}`],a.variant==="outlined"&&r[`outlined${sn(a.color)}`],a.shape==="rounded"&&r.rounded,a.type==="page"&&r.page,(a.type==="start-ellipsis"||a.type==="end-ellipsis")&&r.ellipsis,(a.type==="previous"||a.type==="next")&&r.previousNext,(a.type==="first"||a.type==="last")&&r.firstLast]},QZ=e=>{const{classes:r,color:a,disabled:l,selected:m,size:y,shape:T,type:i,variant:z}=e,B={root:["root",`size${sn(y)}`,z,T,a!=="standard"&&`color${sn(a)}`,a!=="standard"&&`${z}${sn(a)}`,l&&"disabled",m&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[i]],icon:["icon"]};return Ni(B,qZ,r)},KZ=pn("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:GB})(Yi(({theme:e})=>({...e.typography.body2,borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,height:"auto",[`&.${Uu.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:{size:"small"},style:{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"}},{props:{size:"large"},style:{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)}}]}))),JZ=pn(px,{name:"MuiPaginationItem",slot:"Root",overridesResolver:GB})(Yi(({theme:e})=>({...e.typography.body2,borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(e.vars||e).palette.text.primary,[`&.${Uu.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${Uu.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},transition:e.transitions.create(["color","background-color"],{duration:e.transitions.duration.short}),"&:hover":{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Uu.selected}`]:{backgroundColor:(e.vars||e).palette.action.selected,"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${Uu.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.action.selected,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)},[`&.${Uu.disabled}`]:{opacity:1,color:(e.vars||e).palette.action.disabled,backgroundColor:(e.vars||e).palette.action.selected}},variants:[{props:{size:"small"},style:{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"}},{props:{size:"large"},style:{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:e.typography.pxToRem(15)}},{props:{shape:"rounded"},style:{borderRadius:(e.vars||e).shape.borderRadius}},{props:{variant:"outlined"},style:{border:e.vars?`1px solid ${e.alpha(e.vars.palette.common.onBackground,.23)}`:`1px solid ${e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${Uu.selected}`]:{[`&.${Uu.disabled}`]:{borderColor:(e.vars||e).palette.action.disabledBackground,color:(e.vars||e).palette.action.disabled}}}},{props:{variant:"text"},style:{[`&.${Uu.selected}`]:{[`&.${Uu.disabled}`]:{color:(e.vars||e).palette.action.disabled}}}},...Object.entries(e.palette).filter(rl(["dark","contrastText"])).map(([r])=>({props:{variant:"text",color:r},style:{[`&.${Uu.selected}`]:{color:(e.vars||e).palette[r].contrastText,backgroundColor:(e.vars||e).palette[r].main,"&:hover":{backgroundColor:(e.vars||e).palette[r].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[r].main}},[`&.${Uu.focusVisible}`]:{backgroundColor:(e.vars||e).palette[r].dark},[`&.${Uu.disabled}`]:{color:(e.vars||e).palette.action.disabled}}}})),...Object.entries(e.palette).filter(rl(["light"])).map(([r])=>({props:{variant:"outlined",color:r},style:{[`&.${Uu.selected}`]:{color:(e.vars||e).palette[r].main,border:`1px solid ${e.alpha((e.vars||e).palette[r].main,.5)}`,backgroundColor:e.alpha((e.vars||e).palette[r].main,(e.vars||e).palette.action.activatedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[r].main,`${(e.vars||e).palette.action.activatedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Uu.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette[r].main,`${(e.vars||e).palette.action.activatedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))]}))),eX=pn("div",{name:"MuiPaginationItem",slot:"Icon"})(Yi(({theme:e})=>({fontSize:e.typography.pxToRem(20),margin:"0 -8px",variants:[{props:{size:"small"},style:{fontSize:e.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:e.typography.pxToRem(22)}}]}))),tX=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiPaginationItem"}),{className:m,color:y="standard",component:T,components:i={},disabled:z=!1,page:B,selected:F=!1,shape:G="circular",size:Q="medium",slots:te={},slotProps:ne={},type:oe="page",variant:ue="text",...ye}=l,we={...l,color:y,disabled:z,selected:F,shape:G,size:Q,type:oe,variant:ue},ve=jw(),Ce=QZ(we),Ee={slots:{previous:te.previous??i.previous,next:te.next??i.next,first:te.first??i.first,last:te.last??i.last},slotProps:ne},[Be,Ke]=pa("previous",{elementType:XZ,externalForwardedProps:Ee,ownerState:we}),[st,dt]=pa("next",{elementType:YZ,externalForwardedProps:Ee,ownerState:we}),[bt,ht]=pa("first",{elementType:WZ,externalForwardedProps:Ee,ownerState:we}),[Re,Pt]=pa("last",{elementType:ZZ,externalForwardedProps:Ee,ownerState:we}),wt=ve?{previous:"next",next:"previous",first:"last",last:"first"}[oe]:oe,Et={previous:Be,next:st,first:bt,last:Re}[wt],et={previous:Ke,next:dt,first:ht,last:Pt}[wt];return oe==="start-ellipsis"||oe==="end-ellipsis"?be.jsx(KZ,{ref:a,ownerState:we,className:on(Ce.root,m),children:""}):be.jsxs(JZ,{ref:a,ownerState:we,component:T,disabled:z,className:on(Ce.root,m),...ye,children:[oe==="page"&&B,Et?be.jsx(eX,{...et,className:Ce.icon,as:Et}):null]})}),rX=e=>{const{classes:r,variant:a}=e;return Ni({root:["root",a],ul:["ul"]},GZ,r)},nX=pn("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant]]}})({}),iX=pn("ul",{name:"MuiPagination",slot:"Ul"})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function oX(e,r,a){return e==="page"?`${a?"":"Go to "}page ${r}`:`Go to ${e} page`}const aX=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiPagination"}),{boundaryCount:m=1,className:y,color:T="standard",count:i=1,defaultPage:z=1,disabled:B=!1,getItemAriaLabel:F=oX,hideNextButton:G=!1,hidePrevButton:Q=!1,onChange:te,page:ne,renderItem:oe=bt=>be.jsx(tX,{...bt}),shape:ue="circular",showFirstButton:ye=!1,showLastButton:we=!1,siblingCount:ve=1,size:Ce="medium",variant:Ee="text",...Be}=l,{items:Ke}=HZ({...l,componentName:"Pagination"}),st={...l,boundaryCount:m,color:T,count:i,defaultPage:z,disabled:B,getItemAriaLabel:F,hideNextButton:G,hidePrevButton:Q,renderItem:oe,shape:ue,showFirstButton:ye,showLastButton:we,siblingCount:ve,size:Ce,variant:Ee},dt=rX(st);return be.jsx(nX,{"aria-label":"pagination navigation",className:on(dt.root,y),ownerState:st,ref:a,...Be,children:be.jsx(iX,{className:dt.ul,ownerState:st,children:Ke.map((bt,ht)=>be.jsx("li",{children:oe({...bt,color:T,"aria-label":F(bt.type,bt.page,bt.selected),shape:ue,size:Ce,variant:Ee})},ht))})})}),sX=Fl(be.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),lX=Fl(be.jsx("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"})),cX=pn("span",{name:"MuiRadioButtonIcon",shouldForwardProp:eu})({position:"relative",display:"flex"}),uX=pn(sX,{name:"MuiRadioButtonIcon"})({transform:"scale(1)"}),hX=pn(lX,{name:"MuiRadioButtonIcon"})(Yi(({theme:e})=>({left:0,position:"absolute",transform:"scale(0)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeIn,duration:e.transitions.duration.shortest}),variants:[{props:{checked:!0},style:{transform:"scale(1)",transition:e.transitions.create("transform",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.shortest})}}]})));function HB(e){const{checked:r=!1,classes:a={},fontSize:l}=e,m={...e,checked:r};return be.jsxs(cX,{className:a.root,ownerState:m,children:[be.jsx(uX,{fontSize:l,className:a.background,ownerState:m}),be.jsx(hX,{fontSize:l,className:a.dot,ownerState:m})]})}const qB=ae.createContext(void 0);function fX(){return ae.useContext(qB)}function dX(e){return Bi("MuiRadio",e)}const gO=Fi("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary","sizeSmall"]),pX=e=>{const{classes:r,color:a,size:l}=e,m={root:["root",`color${sn(a)}`,l!=="medium"&&`size${sn(l)}`]};return{...r,...Ni(m,dX,r)}},mX=pn(Tq,{shouldForwardProp:e=>eu(e)||e==="classes",name:"MuiRadio",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.size!=="medium"&&r[`size${sn(a.size)}`],r[`color${sn(a.color)}`]]}})(Yi(({theme:e})=>({color:(e.vars||e).palette.text.secondary,[`&.${gO.disabled}`]:{color:(e.vars||e).palette.action.disabled},variants:[{props:{color:"default",disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r,disabled:!1,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[r].main,(e.vars||e).palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(rl()).map(([r])=>({props:{color:r,disabled:!1},style:{[`&.${gO.checked}`]:{color:(e.vars||e).palette[r].main}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}]})));function AX(e,r){return typeof r=="object"&&r!==null?e===r:String(e)===String(r)}const gX=be.jsx(HB,{checked:!0}),_X=be.jsx(HB,{}),rT=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiRadio"}),{checked:m,checkedIcon:y=gX,color:T="primary",icon:i=_X,name:z,onChange:B,size:F="medium",className:G,disabled:Q,disableRipple:te=!1,slots:ne={},slotProps:oe={},inputProps:ue,...ye}=l,we=Yd();let ve=Q;we&&typeof ve>"u"&&(ve=we.disabled),ve??=!1;const Ce={...l,disabled:ve,disableRipple:te,color:T,size:F},Ee=pX(Ce),Be=fX();let Ke=m;const st=WE(B,Be&&Be.onChange);let dt=z;Be&&(typeof Ke>"u"&&(Ke=AX(Be.value,l.value)),typeof dt>"u"&&(dt=Be.name));const bt=oe.input??ue,[ht,Re]=pa("root",{ref:a,elementType:mX,className:on(Ee.root,G),shouldForwardComponentProp:!0,externalForwardedProps:{slots:ne,slotProps:oe,...ye},getSlotProps:Pt=>({...Pt,onChange:(wt,...Et)=>{Pt.onChange?.(wt,...Et),st(wt,...Et)}}),ownerState:Ce,additionalProps:{type:"radio",icon:ae.cloneElement(i,{fontSize:i.props.fontSize??F}),checkedIcon:ae.cloneElement(y,{fontSize:y.props.fontSize??F}),disabled:ve,name:dt,checked:Ke,slots:ne,slotProps:{input:typeof bt=="function"?bt(Ce):bt}}});return be.jsx(ht,{...Re,classes:Ee})});function yX(e){return Bi("MuiRadioGroup",e)}Fi("MuiRadioGroup",["root","row","error"]);const vX=e=>{const{classes:r,row:a,error:l}=e;return Ni({root:["root",a&&"row",l&&"error"]},yX,r)},xX=ae.forwardRef(function(r,a){const{actions:l,children:m,className:y,defaultValue:T,name:i,onChange:z,value:B,...F}=r,G=ae.useRef(null),Q=vX(r),[te,ne]=Hv({controlled:B,default:T,name:"RadioGroup"});ae.useImperativeHandle(l,()=>({focus:()=>{let we=G.current.querySelector("input:not(:disabled):checked");we||(we=G.current.querySelector("input:not(:disabled)")),we&&we.focus()}}),[]);const oe=rc(a,G),ue=J_(i),ye=ae.useMemo(()=>({name:ue,onChange(we){ne(we.target.value),z&&z(we,we.target.value)},value:te}),[ue,z,ne,te]);return be.jsx(qB.Provider,{value:ye,children:be.jsx(yW,{role:"radiogroup",ref:oe,className:on(Q.root,y),...F,children:m})})});function WB(e){return Bi("MuiSelect",e)}const mv=Fi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]);var _O;const bX=pn(VB,{name:"MuiSelect",slot:"Select",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[{[`&.${mv.select}`]:r.select},{[`&.${mv.select}`]:r[a.variant]},{[`&.${mv.error}`]:r.error},{[`&.${mv.multiple}`]:r.multiple}]}})({[`&.${mv.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),wX=pn($B,{name:"MuiSelect",slot:"Icon",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.icon,a.variant&&r[`icon${sn(a.variant)}`],a.open&&r.iconOpen]}})({}),SX=pn("input",{shouldForwardProp:e=>vB(e)&&e!=="classes",name:"MuiSelect",slot:"NativeInput"})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function yO(e,r){return typeof r=="object"&&r!==null?e===r:String(e)===String(r)}function TX(e){return e==null||typeof e=="string"&&!e.trim()}const EX=e=>{const{classes:r,variant:a,disabled:l,multiple:m,open:y,error:T}=e,i={select:["select",a,l&&"disabled",m&&"multiple",T&&"error"],icon:["icon",`icon${sn(a)}`,y&&"iconOpen",l&&"disabled"],nativeInput:["nativeInput"]};return Ni(i,WB,r)},CX=ae.forwardRef(function(r,a){const{"aria-describedby":l,"aria-label":m,autoFocus:y,autoWidth:T,children:i,className:z,defaultOpen:B,defaultValue:F,disabled:G,displayEmpty:Q,error:te=!1,IconComponent:ne,inputRef:oe,labelId:ue,MenuProps:ye={},multiple:we,name:ve,onBlur:Ce,onChange:Ee,onClose:Be,onFocus:Ke,onOpen:st,open:dt,readOnly:bt,renderValue:ht,required:Re,SelectDisplayProps:Pt={},tabIndex:wt,type:Et,value:et,variant:Zt="standard",...ir}=r,[or,ft]=Hv({controlled:et,default:F,name:"Select"}),[Vt,Jt]=Hv({controlled:dt,default:B,name:"Select"}),Cr=ae.useRef(null),ln=ae.useRef(null),[tn,Hr]=ae.useState(null),{current:Nn}=ae.useRef(dt!=null),[jn,Ur]=ae.useState(),Gr=rc(a,oe),Sn=ae.useCallback($n=>{ln.current=$n,$n&&Hr($n)},[]),Tr=tn?.parentNode;ae.useImperativeHandle(Gr,()=>({focus:()=>{ln.current.focus()},node:Cr.current,value:or}),[or]),ae.useEffect(()=>{B&&Vt&&tn&&!Nn&&(Ur(T?null:Tr.clientWidth),ln.current.focus())},[tn,T]),ae.useEffect(()=>{y&&ln.current.focus()},[y]),ae.useEffect(()=>{if(!ue)return;const $n=Wd(ln.current).getElementById(ue);if($n){const Qi=()=>{getSelection().isCollapsed&&ln.current.focus()};return $n.addEventListener("click",Qi),()=>{$n.removeEventListener("click",Qi)}}},[ue]);const Zi=($n,Qi)=>{$n?st&&st(Qi):Be&&Be(Qi),Nn||(Ur(T?null:Tr.clientWidth),Jt($n))},wn=$n=>{$n.button===0&&($n.preventDefault(),ln.current.focus(),Zi(!0,$n))},Rn=$n=>{Zi(!1,$n)},mo=ae.Children.toArray(i),di=$n=>{const Qi=mo.find(Xo=>Xo.props.value===$n.target.value);Qi!==void 0&&(ft(Qi.props.value),Ee&&Ee($n,Qi))},Ao=$n=>Qi=>{let Xo;if(Qi.currentTarget.hasAttribute("tabindex")){if(we){Xo=Array.isArray(or)?or.slice():[];const ro=or.indexOf($n.props.value);ro===-1?Xo.push($n.props.value):Xo.splice(ro,1)}else Xo=$n.props.value;if($n.props.onClick&&$n.props.onClick(Qi),or!==Xo&&(ft(Xo),Ee)){const ro=Qi.nativeEvent||Qi,Ir=new ro.constructor(ro.type,ro);Object.defineProperty(Ir,"target",{writable:!0,value:{value:Xo,name:ve}}),Ee(Ir,$n)}we||Zi(!1,Qi)}},eo=$n=>{bt||[" ","ArrowUp","ArrowDown","Enter"].includes($n.key)&&($n.preventDefault(),Zi(!0,$n))},$o=tn!==null&&Vt,_i=$n=>{!$o&&Ce&&(Object.defineProperty($n,"target",{writable:!0,value:{value:or,name:ve}}),Ce($n))};delete ir["aria-invalid"];let Bn,Ca;const Io=[];let Qa=!1;(Vb({value:or})||Q)&&(ht?Bn=ht(or):Qa=!0);const ao=mo.map($n=>{if(!ae.isValidElement($n))return null;let Qi;if(we){if(!Array.isArray(or))throw new Error(Gm(2));Qi=or.some(Xo=>yO(Xo,$n.props.value)),Qi&&Qa&&Io.push($n.props.children)}else Qi=yO(or,$n.props.value),Qi&&Qa&&(Ca=$n.props.children);return ae.cloneElement($n,{"aria-selected":Qi?"true":"false",onClick:Ao($n),onKeyUp:Xo=>{Xo.key===" "&&Xo.preventDefault(),$n.props.onKeyUp&&$n.props.onKeyUp(Xo)},role:"option",selected:Qi,value:void 0,"data-value":$n.props.value})});Qa&&(we?Io.length===0?Bn=null:Bn=Io.reduce(($n,Qi,Xo)=>($n.push(Qi),Xo<Io.length-1&&$n.push(", "),$n),[]):Bn=Ca);let ai=jn;!T&&Nn&&tn&&(ai=Tr.clientWidth);let Po;typeof wt<"u"?Po=wt:Po=G?null:0;const to=Pt.id||(ve?`mui-component-select-${ve}`:void 0),Va={...r,variant:Zt,value:or,open:$o,error:te},Mi=EX(Va),os={...ye.PaperProps,...typeof ye.slotProps?.paper=="function"?ye.slotProps.paper(Va):ye.slotProps?.paper},yl={...ye.MenuListProps,...typeof ye.slotProps?.list=="function"?ye.slotProps.list(Va):ye.slotProps?.list},al=J_();return be.jsxs(ae.Fragment,{children:[be.jsx(bX,{as:"div",ref:Sn,tabIndex:Po,role:"combobox","aria-controls":$o?al:void 0,"aria-disabled":G?"true":void 0,"aria-expanded":$o?"true":"false","aria-haspopup":"listbox","aria-label":m,"aria-labelledby":[ue,to].filter(Boolean).join(" ")||void 0,"aria-describedby":l,"aria-required":Re?"true":void 0,"aria-invalid":te?"true":void 0,onKeyDown:eo,onMouseDown:G||bt?null:wn,onBlur:_i,onFocus:Ke,...Pt,ownerState:Va,className:on(Pt.className,Mi.select,z),id:to,children:TX(Bn)?_O||(_O=be.jsx("span",{className:"notranslate","aria-hidden":!0,children:""})):Bn}),be.jsx(SX,{"aria-invalid":te,value:Array.isArray(or)?or.join(","):or,name:ve,ref:Cr,"aria-hidden":!0,onChange:di,tabIndex:-1,disabled:G,className:Mi.nativeInput,autoFocus:y,required:Re,...ir,ownerState:Va}),be.jsx(wX,{as:ne,className:Mi.icon,ownerState:Va}),be.jsx(CZ,{id:`menu-${ve||""}`,anchorEl:Tr,open:$o,onClose:Rn,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},...ye,slotProps:{...ye.slotProps,list:{"aria-labelledby":ue,role:"listbox","aria-multiselectable":we?"true":void 0,disableListWrap:!0,id:al,...yl},paper:{...os,style:{minWidth:ai,...os!=null?os.style:null}}},children:ao})]})}),MX=e=>{const{classes:r}=e,l=Ni({root:["root"]},WB,r);return{...r,...l}},j3={name:"MuiSelect",slot:"Root",shouldForwardProp:e=>eu(e)&&e!=="variant"},IX=pn(L3,j3)(""),PX=pn(N3,j3)(""),RX=pn(k3,j3)(""),U3=ae.forwardRef(function(r,a){const l=Wi({name:"MuiSelect",props:r}),{autoWidth:m=!1,children:y,classes:T={},className:i,defaultOpen:z=!1,displayEmpty:B=!1,IconComponent:F=eq,id:G,input:Q,inputProps:te,label:ne,labelId:oe,MenuProps:ue,multiple:ye=!1,native:we=!1,onClose:ve,onOpen:Ce,open:Ee,renderValue:Be,SelectDisplayProps:Ke,variant:st="outlined",...dt}=l,bt=we?LZ:CX,ht=Yd(),Re=u0({props:l,muiFormControl:ht,states:["variant","error"]}),Pt=Re.variant||st,wt={...l,variant:Pt,classes:T},Et=MX(wt),{root:et,...Zt}=Et,ir=Q||{standard:be.jsx(IX,{ownerState:wt}),outlined:be.jsx(PX,{label:ne,ownerState:wt}),filled:be.jsx(RX,{ownerState:wt})}[Pt],or=rc(a,ry(ir));return be.jsx(ae.Fragment,{children:ae.cloneElement(ir,{inputComponent:bt,inputProps:{children:y,error:Re.error,IconComponent:F,variant:Pt,type:void 0,multiple:ye,...we?{id:G}:{autoWidth:m,defaultOpen:z,displayEmpty:B,labelId:oe,MenuProps:ue,onClose:ve,onOpen:Ce,open:Ee,renderValue:Be,SelectDisplayProps:{id:G,...Ke}},...te,classes:te?Kc(Zt,te.classes):Zt,...Q?Q.props.inputProps:{}},...(ye&&we||B)&&Pt==="outlined"?{notched:!0}:{},ref:or,className:on(ir.props.className,i,Et.root),...!Q&&{variant:Pt},...dt})})});U3.muiName="Select";const ZB=ae.createContext();function DX(e){return Bi("MuiTable",e)}Fi("MuiTable",["root","stickyHeader"]);const OX=e=>{const{classes:r,stickyHeader:a}=e;return Ni({root:["root",a&&"stickyHeader"]},DX,r)},kX=pn("table",{name:"MuiTable",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.stickyHeader&&r.stickyHeader]}})(Yi(({theme:e})=>({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":{...e.typography.body2,padding:e.spacing(2),color:(e.vars||e).palette.text.secondary,textAlign:"left",captionSide:"bottom"},variants:[{props:({ownerState:r})=>r.stickyHeader,style:{borderCollapse:"separate"}}]}))),vO="table",XB=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTable"}),{className:m,component:y=vO,padding:T="normal",size:i="medium",stickyHeader:z=!1,...B}=l,F={...l,component:y,padding:T,size:i,stickyHeader:z},G=OX(F),Q=ae.useMemo(()=>({padding:T,size:i,stickyHeader:z}),[T,i,z]);return be.jsx(ZB.Provider,{value:Q,children:be.jsx(kX,{as:y,role:y===vO?null:"table",ref:a,className:on(G.root,m),ownerState:F,...B})})}),Xw=ae.createContext();function zX(e){return Bi("MuiTableBody",e)}Fi("MuiTableBody",["root"]);const LX=e=>{const{classes:r}=e;return Ni({root:["root"]},zX,r)},BX=pn("tbody",{name:"MuiTableBody",slot:"Root"})({display:"table-row-group"}),FX={variant:"body"},xO="tbody",YB=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTableBody"}),{className:m,component:y=xO,...T}=l,i={...l,component:y},z=LX(i);return be.jsx(Xw.Provider,{value:FX,children:be.jsx(BX,{className:on(z.root,m),as:y,ref:a,role:y===xO?null:"rowgroup",ownerState:i,...T})})});function NX(e){return Bi("MuiTableCell",e)}const jX=Fi("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),UX=e=>{const{classes:r,variant:a,align:l,padding:m,size:y,stickyHeader:T}=e,i={root:["root",a,T&&"stickyHeader",l!=="inherit"&&`align${sn(l)}`,m!=="normal"&&`padding${sn(m)}`,`size${sn(y)}`]};return Ni(i,NX,r)},VX=pn("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,r[a.variant],r[`size${sn(a.size)}`],a.padding!=="normal"&&r[`padding${sn(a.padding)}`],a.align!=="inherit"&&r[`align${sn(a.align)}`],a.stickyHeader&&r.stickyHeader]}})(Yi(({theme:e})=>({...e.typography.body2,display:"table-cell",verticalAlign:"inherit",borderBottom:e.vars?`1px solid ${e.vars.palette.TableCell.border}`:`1px solid
    ${e.palette.mode==="light"?e.lighten(e.alpha(e.palette.divider,1),.88):e.darken(e.alpha(e.palette.divider,1),.68)}`,textAlign:"left",padding:16,variants:[{props:{variant:"head"},style:{color:(e.vars||e).palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium}},{props:{variant:"body"},style:{color:(e.vars||e).palette.text.primary}},{props:{variant:"footer"},style:{color:(e.vars||e).palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)}},{props:{size:"small"},style:{padding:"6px 16px",[`&.${jX.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}}},{props:{padding:"checkbox"},style:{width:48,padding:"0 0 0 4px"}},{props:{padding:"none"},style:{padding:0}},{props:{align:"left"},style:{textAlign:"left"}},{props:{align:"center"},style:{textAlign:"center"}},{props:{align:"right"},style:{textAlign:"right",flexDirection:"row-reverse"}},{props:{align:"justify"},style:{textAlign:"justify"}},{props:({ownerState:r})=>r.stickyHeader,style:{position:"sticky",top:0,zIndex:2,backgroundColor:(e.vars||e).palette.background.default}}]}))),Vs=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTableCell"}),{align:m="inherit",className:y,component:T,padding:i,scope:z,size:B,sortDirection:F,variant:G,...Q}=l,te=ae.useContext(ZB),ne=ae.useContext(Xw),oe=ne&&ne.variant==="head";let ue;T?ue=T:ue=oe?"th":"td";let ye=z;ue==="td"?ye=void 0:!ye&&oe&&(ye="col");const we=G||ne&&ne.variant,ve={...l,align:m,component:ue,padding:i||(te&&te.padding?te.padding:"normal"),size:B||(te&&te.size?te.size:"medium"),sortDirection:F,stickyHeader:we==="head"&&te&&te.stickyHeader,variant:we},Ce=UX(ve);let Ee=null;return F&&(Ee=F==="asc"?"ascending":"descending"),be.jsx(VX,{as:ue,ref:a,className:on(Ce.root,y),"aria-sort":Ee,scope:ye,ownerState:ve,...Q})});function $X(e){return Bi("MuiTableContainer",e)}Fi("MuiTableContainer",["root"]);const GX=e=>{const{classes:r}=e;return Ni({root:["root"]},$X,r)},HX=pn("div",{name:"MuiTableContainer",slot:"Root"})({width:"100%",overflowX:"auto"}),QB=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTableContainer"}),{className:m,component:y="div",...T}=l,i={...l,component:y},z=GX(i);return be.jsx(HX,{ref:a,as:y,className:on(z.root,m),ownerState:i,...T})});function qX(e){return Bi("MuiTableHead",e)}Fi("MuiTableHead",["root"]);const WX=e=>{const{classes:r}=e;return Ni({root:["root"]},qX,r)},ZX=pn("thead",{name:"MuiTableHead",slot:"Root"})({display:"table-header-group"}),XX={variant:"head"},bO="thead",YX=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTableHead"}),{className:m,component:y=bO,...T}=l,i={...l,component:y},z=WX(i);return be.jsx(Xw.Provider,{value:XX,children:be.jsx(ZX,{as:y,className:on(z.root,m),ref:a,role:y===bO?null:"rowgroup",ownerState:i,...T})})});function QX(e){return Bi("MuiToolbar",e)}Fi("MuiToolbar",["root","gutters","regular","dense"]);const KX=e=>{const{classes:r,disableGutters:a,variant:l}=e;return Ni({root:["root",!a&&"gutters",l]},QX,r)},JX=pn("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,!a.disableGutters&&r.gutters,r[a.variant]]}})(Yi(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:r})=>!r.disableGutters,style:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:e.mixins.toolbar}]}))),a0=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiToolbar"}),{className:m,component:y="div",disableGutters:T=!1,variant:i="regular",...z}=l,B={...l,component:y,disableGutters:T,variant:i},F=KX(B);return be.jsx(JX,{as:y,className:on(F.root,m),ref:a,ownerState:B,...z})});function eY(e){return Bi("MuiTableRow",e)}const wO=Fi("MuiTableRow",["root","selected","hover","head","footer"]),tY=e=>{const{classes:r,selected:a,hover:l,head:m,footer:y}=e;return Ni({root:["root",a&&"selected",l&&"hover",m&&"head",y&&"footer"]},eY,r)},rY=pn("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:a}=e;return[r.root,a.head&&r.head,a.footer&&r.footer]}})(Yi(({theme:e})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${wO.hover}:hover`]:{backgroundColor:(e.vars||e).palette.action.hover},[`&.${wO.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`)}}}))),SO="tr",$b=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTableRow"}),{className:m,component:y=SO,hover:T=!1,selected:i=!1,...z}=l,B=ae.useContext(Xw),F={...l,component:y,hover:T,selected:i,head:B&&B.variant==="head",footer:B&&B.variant==="footer"},G=tY(F);return be.jsx(rY,{as:y,ref:a,className:on(G.root,m),role:y===SO?null:"row",ownerState:F,...z})});function nY(e){return Bi("MuiTextField",e)}Fi("MuiTextField",["root"]);const iY={standard:L3,filled:k3,outlined:N3},oY=e=>{const{classes:r}=e;return Ni({root:["root"]},nY,r)},aY=pn(z3,{name:"MuiTextField",slot:"Root"})({}),ds=ae.forwardRef(function(r,a){const l=Wi({props:r,name:"MuiTextField"}),{autoComplete:m,autoFocus:y=!1,children:T,className:i,color:z="primary",defaultValue:B,disabled:F=!1,error:G=!1,FormHelperTextProps:Q,fullWidth:te=!1,helperText:ne,id:oe,InputLabelProps:ue,inputProps:ye,InputProps:we,inputRef:ve,label:Ce,maxRows:Ee,minRows:Be,multiline:Ke=!1,name:st,onBlur:dt,onChange:bt,onFocus:ht,placeholder:Re,required:Pt=!1,rows:wt,select:Et=!1,SelectProps:et,slots:Zt={},slotProps:ir={},type:or,value:ft,variant:Vt="outlined",...Jt}=l,Cr={...l,autoFocus:y,color:z,disabled:F,error:G,fullWidth:te,multiline:Ke,required:Pt,select:Et,variant:Vt},ln=oY(Cr),tn=J_(oe),Hr=ne&&tn?`${tn}-helper-text`:void 0,Nn=Ce&&tn?`${tn}-label`:void 0,jn=iY[Vt],Ur={slots:Zt,slotProps:{input:we,inputLabel:ue,htmlInput:ye,formHelperText:Q,select:et,...ir}},Gr={},Sn=Ur.slotProps.inputLabel;Vt==="outlined"&&(Sn&&typeof Sn.shrink<"u"&&(Gr.notched=Sn.shrink),Gr.label=Ce),Et&&((!et||!et.native)&&(Gr.id=void 0),Gr["aria-describedby"]=void 0);const[Tr,Zi]=pa("root",{elementType:aY,shouldForwardComponentProp:!0,externalForwardedProps:{...Ur,...Jt},ownerState:Cr,className:on(ln.root,i),ref:a,additionalProps:{disabled:F,error:G,fullWidth:te,required:Pt,color:z,variant:Vt}}),[wn,Rn]=pa("input",{elementType:jn,externalForwardedProps:Ur,additionalProps:Gr,ownerState:Cr}),[mo,di]=pa("inputLabel",{elementType:FB,externalForwardedProps:Ur,ownerState:Cr}),[Ao,eo]=pa("htmlInput",{elementType:"input",externalForwardedProps:Ur,ownerState:Cr}),[$o,_i]=pa("formHelperText",{elementType:wW,externalForwardedProps:Ur,ownerState:Cr}),[Bn,Ca]=pa("select",{elementType:U3,externalForwardedProps:Ur,ownerState:Cr}),Io=be.jsx(wn,{"aria-describedby":Hr,autoComplete:m,autoFocus:y,defaultValue:B,fullWidth:te,multiline:Ke,name:st,rows:wt,maxRows:Ee,minRows:Be,type:or,value:ft,id:tn,inputRef:ve,onBlur:dt,onChange:bt,onFocus:ht,placeholder:Re,inputProps:eo,slots:{input:Zt.htmlInput?Ao:void 0},...Rn});return be.jsxs(Tr,{...Zi,children:[Ce!=null&&Ce!==""&&be.jsx(mo,{htmlFor:tn,id:Nn,...di,children:Ce}),Et?be.jsx(Bn,{"aria-describedby":Hr,id:tn,labelId:Nn,value:ft,input:Io,...Ca,children:T}):Io,ne&&be.jsx($o,{id:Hr,..._i,children:ne})]})});var nT={exports:{}},Av={},iT={exports:{}},oT={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TO;function sY(){return TO||(TO=1,(function(e){function r(et,Zt){var ir=et.length;et.push(Zt);e:for(;0<ir;){var or=ir-1>>>1,ft=et[or];if(0<m(ft,Zt))et[or]=Zt,et[ir]=ft,ir=or;else break e}}function a(et){return et.length===0?null:et[0]}function l(et){if(et.length===0)return null;var Zt=et[0],ir=et.pop();if(ir!==Zt){et[0]=ir;e:for(var or=0,ft=et.length,Vt=ft>>>1;or<Vt;){var Jt=2*(or+1)-1,Cr=et[Jt],ln=Jt+1,tn=et[ln];if(0>m(Cr,ir))ln<ft&&0>m(tn,Cr)?(et[or]=tn,et[ln]=ir,or=ln):(et[or]=Cr,et[Jt]=ir,or=Jt);else if(ln<ft&&0>m(tn,ir))et[or]=tn,et[ln]=ir,or=ln;else break e}}return Zt}function m(et,Zt){var ir=et.sortIndex-Zt.sortIndex;return ir!==0?ir:et.id-Zt.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var T=Date,i=T.now();e.unstable_now=function(){return T.now()-i}}var z=[],B=[],F=1,G=null,Q=3,te=!1,ne=!1,oe=!1,ue=!1,ye=typeof setTimeout=="function"?setTimeout:null,we=typeof clearTimeout=="function"?clearTimeout:null,ve=typeof setImmediate<"u"?setImmediate:null;function Ce(et){for(var Zt=a(B);Zt!==null;){if(Zt.callback===null)l(B);else if(Zt.startTime<=et)l(B),Zt.sortIndex=Zt.expirationTime,r(z,Zt);else break;Zt=a(B)}}function Ee(et){if(oe=!1,Ce(et),!ne)if(a(z)!==null)ne=!0,Be||(Be=!0,Re());else{var Zt=a(B);Zt!==null&&Et(Ee,Zt.startTime-et)}}var Be=!1,Ke=-1,st=5,dt=-1;function bt(){return ue?!0:!(e.unstable_now()-dt<st)}function ht(){if(ue=!1,Be){var et=e.unstable_now();dt=et;var Zt=!0;try{e:{ne=!1,oe&&(oe=!1,we(Ke),Ke=-1),te=!0;var ir=Q;try{t:{for(Ce(et),G=a(z);G!==null&&!(G.expirationTime>et&&bt());){var or=G.callback;if(typeof or=="function"){G.callback=null,Q=G.priorityLevel;var ft=or(G.expirationTime<=et);if(et=e.unstable_now(),typeof ft=="function"){G.callback=ft,Ce(et),Zt=!0;break t}G===a(z)&&l(z),Ce(et)}else l(z);G=a(z)}if(G!==null)Zt=!0;else{var Vt=a(B);Vt!==null&&Et(Ee,Vt.startTime-et),Zt=!1}}break e}finally{G=null,Q=ir,te=!1}Zt=void 0}}finally{Zt?Re():Be=!1}}}var Re;if(typeof ve=="function")Re=function(){ve(ht)};else if(typeof MessageChannel<"u"){var Pt=new MessageChannel,wt=Pt.port2;Pt.port1.onmessage=ht,Re=function(){wt.postMessage(null)}}else Re=function(){ye(ht,0)};function Et(et,Zt){Ke=ye(function(){et(e.unstable_now())},Zt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(et){et.callback=null},e.unstable_forceFrameRate=function(et){0>et||125<et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):st=0<et?Math.floor(1e3/et):5},e.unstable_getCurrentPriorityLevel=function(){return Q},e.unstable_next=function(et){switch(Q){case 1:case 2:case 3:var Zt=3;break;default:Zt=Q}var ir=Q;Q=Zt;try{return et()}finally{Q=ir}},e.unstable_requestPaint=function(){ue=!0},e.unstable_runWithPriority=function(et,Zt){switch(et){case 1:case 2:case 3:case 4:case 5:break;default:et=3}var ir=Q;Q=et;try{return Zt()}finally{Q=ir}},e.unstable_scheduleCallback=function(et,Zt,ir){var or=e.unstable_now();switch(typeof ir=="object"&&ir!==null?(ir=ir.delay,ir=typeof ir=="number"&&0<ir?or+ir:or):ir=or,et){case 1:var ft=-1;break;case 2:ft=250;break;case 5:ft=1073741823;break;case 4:ft=1e4;break;default:ft=5e3}return ft=ir+ft,et={id:F++,callback:Zt,priorityLevel:et,startTime:ir,expirationTime:ft,sortIndex:-1},ir>or?(et.sortIndex=ir,r(B,et),a(z)===null&&et===a(B)&&(oe?(we(Ke),Ke=-1):oe=!0,Et(Ee,ir-or))):(et.sortIndex=ft,r(z,et),ne||te||(ne=!0,Be||(Be=!0,Re()))),et},e.unstable_shouldYield=bt,e.unstable_wrapCallback=function(et){var Zt=Q;return function(){var ir=Q;Q=Zt;try{return et.apply(this,arguments)}finally{Q=ir}}}})(oT)),oT}var EO;function lY(){return EO||(EO=1,iT.exports=sY()),iT.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CO;function cY(){if(CO)return Av;CO=1;var e=lY(),r=Y_(),a=SB();function l(h){var _="https://react.dev/errors/"+h;if(1<arguments.length){_+="?args[]="+encodeURIComponent(arguments[1]);for(var M=2;M<arguments.length;M++)_+="&args[]="+encodeURIComponent(arguments[M])}return"Minified React error #"+h+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function y(h){var _=h,M=h;if(h.alternate)for(;_.return;)_=_.return;else{h=_;do _=h,(_.flags&4098)!==0&&(M=_.return),h=_.return;while(h)}return _.tag===3?M:null}function T(h){if(h.tag===13){var _=h.memoizedState;if(_===null&&(h=h.alternate,h!==null&&(_=h.memoizedState)),_!==null)return _.dehydrated}return null}function i(h){if(y(h)!==h)throw Error(l(188))}function z(h){var _=h.alternate;if(!_){if(_=y(h),_===null)throw Error(l(188));return _!==h?null:h}for(var M=h,L=_;;){var X=M.return;if(X===null)break;var ie=X.alternate;if(ie===null){if(L=X.return,L!==null){M=L;continue}break}if(X.child===ie.child){for(ie=X.child;ie;){if(ie===M)return i(X),h;if(ie===L)return i(X),_;ie=ie.sibling}throw Error(l(188))}if(M.return!==L.return)M=X,L=ie;else{for(var De=!1,Xe=X.child;Xe;){if(Xe===M){De=!0,M=X,L=ie;break}if(Xe===L){De=!0,L=X,M=ie;break}Xe=Xe.sibling}if(!De){for(Xe=ie.child;Xe;){if(Xe===M){De=!0,M=ie,L=X;break}if(Xe===L){De=!0,L=ie,M=X;break}Xe=Xe.sibling}if(!De)throw Error(l(189))}}if(M.alternate!==L)throw Error(l(190))}if(M.tag!==3)throw Error(l(188));return M.stateNode.current===M?h:_}function B(h){var _=h.tag;if(_===5||_===26||_===27||_===6)return h;for(h=h.child;h!==null;){if(_=B(h),_!==null)return _;h=h.sibling}return null}var F=Object.assign,G=Symbol.for("react.element"),Q=Symbol.for("react.transitional.element"),te=Symbol.for("react.portal"),ne=Symbol.for("react.fragment"),oe=Symbol.for("react.strict_mode"),ue=Symbol.for("react.profiler"),ye=Symbol.for("react.provider"),we=Symbol.for("react.consumer"),ve=Symbol.for("react.context"),Ce=Symbol.for("react.forward_ref"),Ee=Symbol.for("react.suspense"),Be=Symbol.for("react.suspense_list"),Ke=Symbol.for("react.memo"),st=Symbol.for("react.lazy"),dt=Symbol.for("react.activity"),bt=Symbol.for("react.memo_cache_sentinel"),ht=Symbol.iterator;function Re(h){return h===null||typeof h!="object"?null:(h=ht&&h[ht]||h["@@iterator"],typeof h=="function"?h:null)}var Pt=Symbol.for("react.client.reference");function wt(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===Pt?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case ne:return"Fragment";case ue:return"Profiler";case oe:return"StrictMode";case Ee:return"Suspense";case Be:return"SuspenseList";case dt:return"Activity"}if(typeof h=="object")switch(h.$$typeof){case te:return"Portal";case ve:return(h.displayName||"Context")+".Provider";case we:return(h._context.displayName||"Context")+".Consumer";case Ce:var _=h.render;return h=h.displayName,h||(h=_.displayName||_.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case Ke:return _=h.displayName||null,_!==null?_:wt(h.type)||"Memo";case st:_=h._payload,h=h._init;try{return wt(h(_))}catch{}}return null}var Et=Array.isArray,et=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Zt=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ir={pending:!1,data:null,method:null,action:null},or=[],ft=-1;function Vt(h){return{current:h}}function Jt(h){0>ft||(h.current=or[ft],or[ft]=null,ft--)}function Cr(h,_){ft++,or[ft]=h.current,h.current=_}var ln=Vt(null),tn=Vt(null),Hr=Vt(null),Nn=Vt(null);function jn(h,_){switch(Cr(Hr,_),Cr(tn,h),Cr(ln,null),_.nodeType){case 9:case 11:h=(h=_.documentElement)&&(h=h.namespaceURI)?Hx(h):0;break;default:if(h=_.tagName,_=_.namespaceURI)_=Hx(_),h=qx(_,h);else switch(h){case"svg":h=1;break;case"math":h=2;break;default:h=0}}Jt(ln),Cr(ln,h)}function Ur(){Jt(ln),Jt(tn),Jt(Hr)}function Gr(h){h.memoizedState!==null&&Cr(Nn,h);var _=ln.current,M=qx(_,h.type);_!==M&&(Cr(tn,h),Cr(ln,M))}function Sn(h){tn.current===h&&(Jt(ln),Jt(tn)),Nn.current===h&&(Jt(Nn),Rp._currentValue=ir)}var Tr=Object.prototype.hasOwnProperty,Zi=e.unstable_scheduleCallback,wn=e.unstable_cancelCallback,Rn=e.unstable_shouldYield,mo=e.unstable_requestPaint,di=e.unstable_now,Ao=e.unstable_getCurrentPriorityLevel,eo=e.unstable_ImmediatePriority,$o=e.unstable_UserBlockingPriority,_i=e.unstable_NormalPriority,Bn=e.unstable_LowPriority,Ca=e.unstable_IdlePriority,Io=e.log,Qa=e.unstable_setDisableYieldValue,ao=null,ai=null;function Po(h){if(typeof Io=="function"&&Qa(h),ai&&typeof ai.setStrictMode=="function")try{ai.setStrictMode(ao,h)}catch{}}var to=Math.clz32?Math.clz32:os,Va=Math.log,Mi=Math.LN2;function os(h){return h>>>=0,h===0?32:31-(Va(h)/Mi|0)|0}var yl=256,al=4194304;function $n(h){var _=h&42;if(_!==0)return _;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function Qi(h,_,M){var L=h.pendingLanes;if(L===0)return 0;var X=0,ie=h.suspendedLanes,De=h.pingedLanes;h=h.warmLanes;var Xe=L&134217727;return Xe!==0?(L=Xe&~ie,L!==0?X=$n(L):(De&=Xe,De!==0?X=$n(De):M||(M=Xe&~h,M!==0&&(X=$n(M))))):(Xe=L&~ie,Xe!==0?X=$n(Xe):De!==0?X=$n(De):M||(M=L&~h,M!==0&&(X=$n(M)))),X===0?0:_!==0&&_!==X&&(_&ie)===0&&(ie=X&-X,M=_&-_,ie>=M||ie===32&&(M&4194048)!==0)?_:X}function Xo(h,_){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&_)===0}function ro(h,_){switch(h){case 1:case 2:case 4:case 8:case 64:return _+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ir(){var h=yl;return yl<<=1,(yl&4194048)===0&&(yl=256),h}function If(){var h=al;return al<<=1,(al&62914560)===0&&(al=4194304),h}function bc(h){for(var _=[],M=0;31>M;M++)_.push(h);return _}function Gs(h,_){h.pendingLanes|=_,_!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function hd(h,_,M,L,X,ie){var De=h.pendingLanes;h.pendingLanes=M,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=M,h.entangledLanes&=M,h.errorRecoveryDisabledLanes&=M,h.shellSuspendCounter=0;var Xe=h.entanglements,Tt=h.expirationTimes,dr=h.hiddenUpdates;for(M=De&~M;0<M;){var zr=31-to(M),Zr=1<<zr;Xe[zr]=0,Tt[zr]=-1;var Ar=dr[zr];if(Ar!==null)for(dr[zr]=null,zr=0;zr<Ar.length;zr++){var gr=Ar[zr];gr!==null&&(gr.lane&=-536870913)}M&=~Zr}L!==0&&Zu(h,L,0),ie!==0&&X===0&&h.tag!==0&&(h.suspendedLanes|=ie&~(De&~_))}function Zu(h,_,M){h.pendingLanes|=_,h.suspendedLanes&=~_;var L=31-to(_);h.entangledLanes|=_,h.entanglements[L]=h.entanglements[L]|1073741824|M&4194090}function Pf(h,_){var M=h.entangledLanes|=_;for(h=h.entanglements;M;){var L=31-to(M),X=1<<L;X&_|h[L]&_&&(h[L]|=_),M&=~X}}function rr(h){switch(h){case 2:h=1;break;case 8:h=4;break;case 32:h=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:h=128;break;case 268435456:h=134217728;break;default:h=0}return h}function Ul(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function kh(){var h=Zt.p;return h!==0?h:(h=window.event,h===void 0?32:Nd(h.type))}function Xu(h,_){var M=Zt.p;try{return Zt.p=h,_()}finally{Zt.p=M}}var ut=Math.random().toString(36).slice(2),le="__reactFiber$"+ut,ge="__reactProps$"+ut,Me="__reactContainer$"+ut,ze="__reactEvents$"+ut,g="__reactListeners$"+ut,ce="__reactHandles$"+ut,At="__reactResources$"+ut,Je="__reactMarker$"+ut;function vt(h){delete h[le],delete h[ge],delete h[ze],delete h[g],delete h[ce]}function Lt(h){var _=h[le];if(_)return _;for(var M=h.parentNode;M;){if(_=M[Me]||M[le]){if(M=_.alternate,_.child!==null||M!==null&&M.child!==null)for(h=Iy(h);h!==null;){if(M=h[le])return M;h=Iy(h)}return _}h=M,M=h.parentNode}return null}function kt(h){if(h=h[le]||h[Me]){var _=h.tag;if(_===5||_===6||_===13||_===26||_===27||_===3)return h}return null}function Fr(h){var _=h.tag;if(_===5||_===26||_===27||_===6)return h.stateNode;throw Error(l(33))}function Dr(h){var _=h[At];return _||(_=h[At]={hoistableStyles:new Map,hoistableScripts:new Map}),_}function wr(h){h[Je]=!0}var zn=new Set,Un={};function Yn(h,_){Ii(h,_),Ii(h+"Capture",_)}function Ii(h,_){for(Un[h]=_,h=0;h<_.length;h++)zn.add(_[h])}var Fn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),go={},wo={};function ia(h){return Tr.call(wo,h)?!0:Tr.call(go,h)?!1:Fn.test(h)?wo[h]=!0:(go[h]=!0,!1)}function Ui(h,_,M){if(ia(_))if(M===null)h.removeAttribute(_);else{switch(typeof M){case"undefined":case"function":case"symbol":h.removeAttribute(_);return;case"boolean":var L=_.toLowerCase().slice(0,5);if(L!=="data-"&&L!=="aria-"){h.removeAttribute(_);return}}h.setAttribute(_,""+M)}}function ri(h,_,M){if(M===null)h.removeAttribute(_);else{switch(typeof M){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(_);return}h.setAttribute(_,""+M)}}function yn(h,_,M,L){if(L===null)h.removeAttribute(M);else{switch(typeof L){case"undefined":case"function":case"symbol":case"boolean":h.removeAttribute(M);return}h.setAttributeNS(_,M,""+L)}}var He,mn;function ca(h){if(He===void 0)try{throw Error()}catch(M){var _=M.stack.trim().match(/\n( *(at )?)/);He=_&&_[1]||"",mn=-1<M.stack.indexOf(`
    at`)?" (<anonymous>)":-1<M.stack.indexOf("@")?"@unknown:0:0":""}return`
`+He+h+mn}var as=!1;function Hs(h,_){if(!h||as)return"";as=!0;var M=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var L={DetermineComponentFrameRoot:function(){try{if(_){var Zr=function(){throw Error()};if(Object.defineProperty(Zr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Zr,[])}catch(gr){var Ar=gr}Reflect.construct(h,[],Zr)}else{try{Zr.call()}catch(gr){Ar=gr}h.call(Zr.prototype)}}else{try{throw Error()}catch(gr){Ar=gr}(Zr=h())&&typeof Zr.catch=="function"&&Zr.catch(function(){})}}catch(gr){if(gr&&Ar&&typeof gr.stack=="string")return[gr.stack,Ar.stack]}return[null,null]}};L.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var X=Object.getOwnPropertyDescriptor(L.DetermineComponentFrameRoot,"name");X&&X.configurable&&Object.defineProperty(L.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var ie=L.DetermineComponentFrameRoot(),De=ie[0],Xe=ie[1];if(De&&Xe){var Tt=De.split(`
`),dr=Xe.split(`
`);for(X=L=0;L<Tt.length&&!Tt[L].includes("DetermineComponentFrameRoot");)L++;for(;X<dr.length&&!dr[X].includes("DetermineComponentFrameRoot");)X++;if(L===Tt.length||X===dr.length)for(L=Tt.length-1,X=dr.length-1;1<=L&&0<=X&&Tt[L]!==dr[X];)X--;for(;1<=L&&0<=X;L--,X--)if(Tt[L]!==dr[X]){if(L!==1||X!==1)do if(L--,X--,0>X||Tt[L]!==dr[X]){var zr=`
`+Tt[L].replace(" at new "," at ");return h.displayName&&zr.includes("<anonymous>")&&(zr=zr.replace("<anonymous>",h.displayName)),zr}while(1<=L&&0<=X);break}}}finally{as=!1,Error.prepareStackTrace=M}return(M=h?h.displayName||h.name:"")?ca(M):""}function tu(h){switch(h.tag){case 26:case 27:case 5:return ca(h.type);case 16:return ca("Lazy");case 13:return ca("Suspense");case 19:return ca("SuspenseList");case 0:case 15:return Hs(h.type,!1);case 11:return Hs(h.type.render,!1);case 1:return Hs(h.type,!0);case 31:return ca("Activity");default:return""}}function ss(h){try{var _="";do _+=tu(h),h=h.return;while(h);return _}catch(M){return`
Error generating stack: `+M.message+`
`+M.stack}}function Fe(h){switch(typeof h){case"bigint":case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function Qp(h){var _=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(_==="checkbox"||_==="radio")}function Yu(h){var _=Qp(h)?"checked":"value",M=Object.getOwnPropertyDescriptor(h.constructor.prototype,_),L=""+h[_];if(!h.hasOwnProperty(_)&&typeof M<"u"&&typeof M.get=="function"&&typeof M.set=="function"){var X=M.get,ie=M.set;return Object.defineProperty(h,_,{configurable:!0,get:function(){return X.call(this)},set:function(De){L=""+De,ie.call(this,De)}}),Object.defineProperty(h,_,{enumerable:M.enumerable}),{getValue:function(){return L},setValue:function(De){L=""+De},stopTracking:function(){h._valueTracker=null,delete h[_]}}}}function ru(h){h._valueTracker||(h._valueTracker=Yu(h))}function Rf(h){if(!h)return!1;var _=h._valueTracker;if(!_)return!0;var M=_.getValue(),L="";return h&&(L=Qp(h)?h.checked?"true":"false":h.value),h=L,h!==M?(_.setValue(h),!0):!1}function Qu(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}var Ku=/[\n"\\]/g;function As(h){return h.replace(Ku,function(_){return"\\"+_.charCodeAt(0).toString(16)+" "})}function Df(h,_,M,L,X,ie,De,Xe){h.name="",De!=null&&typeof De!="function"&&typeof De!="symbol"&&typeof De!="boolean"?h.type=De:h.removeAttribute("type"),_!=null?De==="number"?(_===0&&h.value===""||h.value!=_)&&(h.value=""+Fe(_)):h.value!==""+Fe(_)&&(h.value=""+Fe(_)):De!=="submit"&&De!=="reset"||h.removeAttribute("value"),_!=null?sl(h,De,Fe(_)):M!=null?sl(h,De,Fe(M)):L!=null&&h.removeAttribute("value"),X==null&&ie!=null&&(h.defaultChecked=!!ie),X!=null&&(h.checked=X&&typeof X!="function"&&typeof X!="symbol"),Xe!=null&&typeof Xe!="function"&&typeof Xe!="symbol"&&typeof Xe!="boolean"?h.name=""+Fe(Xe):h.removeAttribute("name")}function Vl(h,_,M,L,X,ie,De,Xe){if(ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"&&(h.type=ie),_!=null||M!=null){if(!(ie!=="submit"&&ie!=="reset"||_!=null))return;M=M!=null?""+Fe(M):"",_=_!=null?""+Fe(_):M,Xe||_===h.value||(h.value=_),h.defaultValue=_}L=L??X,L=typeof L!="function"&&typeof L!="symbol"&&!!L,h.checked=Xe?h.checked:!!L,h.defaultChecked=!!L,De!=null&&typeof De!="function"&&typeof De!="symbol"&&typeof De!="boolean"&&(h.name=De)}function sl(h,_,M){_==="number"&&Qu(h.ownerDocument)===h||h.defaultValue===""+M||(h.defaultValue=""+M)}function oa(h,_,M,L){if(h=h.options,_){_={};for(var X=0;X<M.length;X++)_["$"+M[X]]=!0;for(M=0;M<h.length;M++)X=_.hasOwnProperty("$"+h[M].value),h[M].selected!==X&&(h[M].selected=X),X&&L&&(h[M].defaultSelected=!0)}else{for(M=""+Fe(M),_=null,X=0;X<h.length;X++){if(h[X].value===M){h[X].selected=!0,L&&(h[X].defaultSelected=!0);return}_!==null||h[X].disabled||(_=h[X])}_!==null&&(_.selected=!0)}}function ll(h,_,M){if(_!=null&&(_=""+Fe(_),_!==h.value&&(h.value=_),M==null)){h.defaultValue!==_&&(h.defaultValue=_);return}h.defaultValue=M!=null?""+Fe(M):""}function vl(h,_,M,L){if(_==null){if(L!=null){if(M!=null)throw Error(l(92));if(Et(L)){if(1<L.length)throw Error(l(93));L=L[0]}M=L}M==null&&(M=""),_=M}M=Fe(_),h.defaultValue=M,L=h.textContent,L===M&&L!==""&&L!==null&&(h.value=L)}function cl(h,_){if(_){var M=h.firstChild;if(M&&M===h.lastChild&&M.nodeType===3){M.nodeValue=_;return}}h.textContent=_}var xl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function gs(h,_,M){var L=_.indexOf("--")===0;M==null||typeof M=="boolean"||M===""?L?h.setProperty(_,""):_==="float"?h.cssFloat="":h[_]="":L?h.setProperty(_,M):typeof M!="number"||M===0||xl.has(_)?_==="float"?h.cssFloat=M:h[_]=(""+M).trim():h[_]=M+"px"}function nu(h,_,M){if(_!=null&&typeof _!="object")throw Error(l(62));if(h=h.style,M!=null){for(var L in M)!M.hasOwnProperty(L)||_!=null&&_.hasOwnProperty(L)||(L.indexOf("--")===0?h.setProperty(L,""):L==="float"?h.cssFloat="":h[L]="");for(var X in _)L=_[X],_.hasOwnProperty(X)&&M[X]!==L&&gs(h,X,L)}else for(var ie in _)_.hasOwnProperty(ie)&&gs(h,ie,_[ie])}function fd(h){if(h.indexOf("-")===-1)return!1;switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ju=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fo(h){return Ju.test(""+h)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":h}var iu=null;function ou(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var ls=null,eh=null;function pd(h){var _=kt(h);if(_&&(h=_.stateNode)){var M=h[ge]||null;e:switch(h=_.stateNode,_.type){case"input":if(Df(h,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name),_=M.name,M.type==="radio"&&_!=null){for(M=h;M.parentNode;)M=M.parentNode;for(M=M.querySelectorAll('input[name="'+As(""+_)+'"][type="radio"]'),_=0;_<M.length;_++){var L=M[_];if(L!==h&&L.form===h.form){var X=L[ge]||null;if(!X)throw Error(l(90));Df(L,X.value,X.defaultValue,X.defaultValue,X.checked,X.defaultChecked,X.type,X.name)}}for(_=0;_<M.length;_++)L=M[_],L.form===h.form&&Rf(L)}break e;case"textarea":ll(h,M.value,M.defaultValue);break e;case"select":_=M.value,_!=null&&oa(h,!!M.multiple,_,!1)}}}var au=!1;function zh(h,_,M){if(au)return h(_,M);au=!0;try{var L=h(_);return L}finally{if(au=!1,(ls!==null||eh!==null)&&(Yl(),ls&&(_=ls,h=eh,eh=ls=null,pd(_),h)))for(_=0;_<h.length;_++)pd(h[_])}}function su(h,_){var M=h.stateNode;if(M===null)return null;var L=M[ge]||null;if(L===null)return null;M=L[_];e:switch(_){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(L=!L.disabled)||(h=h.type,L=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!L;break e;default:h=!1}if(h)return null;if(M&&typeof M!="function")throw Error(l(231,_,typeof M));return M}var $l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oi=!1;if($l)try{var wc={};Object.defineProperty(wc,"passive",{get:function(){oi=!0}}),window.addEventListener("test",wc,wc),window.removeEventListener("test",wc,wc)}catch{oi=!1}var Sc=null,rp=null,lu=null;function oc(){if(lu)return lu;var h,_=rp,M=_.length,L,X="value"in Sc?Sc.value:Sc.textContent,ie=X.length;for(h=0;h<M&&_[h]===X[h];h++);var De=M-h;for(L=1;L<=De&&_[M-L]===X[ie-L];L++);return lu=X.slice(h,1<L?1-L:void 0)}function cu(h){var _=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&_===13&&(h=13)):h=_,h===10&&(h=13),32<=h||h===13?h:0}function uu(){return!0}function Of(){return!1}function Ms(h){function _(M,L,X,ie,De){this._reactName=M,this._targetInst=X,this.type=L,this.nativeEvent=ie,this.target=De,this.currentTarget=null;for(var Xe in h)h.hasOwnProperty(Xe)&&(M=h[Xe],this[Xe]=M?M(ie):ie[Xe]);return this.isDefaultPrevented=(ie.defaultPrevented!=null?ie.defaultPrevented:ie.returnValue===!1)?uu:Of,this.isPropagationStopped=Of,this}return F(_.prototype,{preventDefault:function(){this.defaultPrevented=!0;var M=this.nativeEvent;M&&(M.preventDefault?M.preventDefault():typeof M.returnValue!="unknown"&&(M.returnValue=!1),this.isDefaultPrevented=uu)},stopPropagation:function(){var M=this.nativeEvent;M&&(M.stopPropagation?M.stopPropagation():typeof M.cancelBubble!="unknown"&&(M.cancelBubble=!0),this.isPropagationStopped=uu)},persist:function(){},isPersistent:uu}),_}var bl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},md=Ms(bl),Lh=F({},bl,{view:0,detail:0}),kf=Ms(Lh),Oa,Ka,ya,hu=F({},Lh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ul,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==ya&&(ya&&h.type==="mousemove"?(Oa=h.screenX-ya.screenX,Ka=h.screenY-ya.screenY):Ka=Oa=0,ya=h),Oa)},movementY:function(h){return"movementY"in h?h.movementY:Ka}}),qs=Ms(hu),Tc=F({},hu,{dataTransfer:0}),wl=Ms(Tc),Kp=F({},Lh,{relatedTarget:0}),zf=Ms(Kp),np=F({},bl,{animationName:0,elapsedTime:0,pseudoElement:0}),vi=Ms(np),fu=F({},bl,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),Jp=Ms(fu),Ad=F({},bl,{data:0}),hn=Ms(Ad),du={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$a={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gd(h){var _=this.nativeEvent;return _.getModifierState?_.getModifierState(h):(h=Gl[h])?!!_[h]:!1}function ul(){return gd}var Kr=F({},Lh,{key:function(h){if(h.key){var _=du[h.key]||h.key;if(_!=="Unidentified")return _}return h.type==="keypress"?(h=cu(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?$a[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ul,charCode:function(h){return h.type==="keypress"?cu(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?cu(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),Di=Ms(Kr),Oi=F({},hu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ws=Ms(Oi),Bh=F({},Lh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ul}),Ti=Ms(Bh),ip=F({},bl,{propertyName:0,elapsedTime:0,pseudoElement:0}),th=Ms(ip),_d=F({},hu,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),_s=Ms(_d),ma=F({},bl,{newState:0,oldState:0}),op=Ms(ma),yd=[9,13,27,32],vd=$l&&"CompositionEvent"in window,pu=null;$l&&"documentMode"in document&&(pu=document.documentMode);var mu=$l&&"TextEvent"in window&&!pu,Au=$l&&(!vd||pu&&8<pu&&11>=pu),Fh=" ",cs=!1;function ys(h,_){switch(h){case"keyup":return yd.indexOf(_.keyCode)!==-1;case"keydown":return _.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Is(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var gu=!1;function Nh(h,_){switch(h){case"compositionend":return Is(_);case"keypress":return _.which!==32?null:(cs=!0,Fh);case"textInput":return h=_.data,h===Fh&&cs?null:h;default:return null}}function Ma(h,_){if(gu)return h==="compositionend"||!vd&&ys(h,_)?(h=oc(),lu=rp=Sc=null,gu=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(_.ctrlKey||_.altKey||_.metaKey)||_.ctrlKey&&_.altKey){if(_.char&&1<_.char.length)return _.char;if(_.which)return String.fromCharCode(_.which)}return null;case"compositionend":return Au&&_.locale!=="ko"?null:_.data;default:return null}}var Ps={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mn(h){var _=h&&h.nodeName&&h.nodeName.toLowerCase();return _==="input"?!!Ps[h.type]:_==="textarea"}function Mr(h,_,M,L){ls?eh?eh.push(L):eh=[L]:ls=L,_=D0(_,"onChange"),0<_.length&&(M=new md("onChange","change",null,M,L),h.push({event:M,listeners:_}))}var ac=null,cn=null;function So(h){by(h,0)}function _u(h){var _=Fr(h);if(Rf(_))return h}function gn(h,_){if(h==="change")return _}var xd=!1;if($l){var jh;if($l){var Uh="oninput"in document;if(!Uh){var ap=document.createElement("div");ap.setAttribute("oninput","return;"),Uh=typeof ap.oninput=="function"}jh=Uh}else jh=!1;xd=jh&&(!document.documentMode||9<document.documentMode)}function bd(){ac&&(ac.detachEvent("onpropertychange",Ki),cn=ac=null)}function Ki(h){if(h.propertyName==="value"&&_u(cn)){var _=[];Mr(_,cn,h,ou(h)),zh(So,_)}}function wd(h,_,M){h==="focusin"?(bd(),ac=_,cn=M,ac.attachEvent("onpropertychange",Ki)):h==="focusout"&&bd()}function Zs(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return _u(cn)}function Rs(h,_){if(h==="click")return _u(_)}function Ec(h,_){if(h==="input"||h==="change")return _u(_)}function Ja(h,_){return h===_&&(h!==0||1/h===1/_)||h!==h&&_!==_}var ua=typeof Object.is=="function"?Object.is:Ja;function sc(h,_){if(ua(h,_))return!0;if(typeof h!="object"||h===null||typeof _!="object"||_===null)return!1;var M=Object.keys(h),L=Object.keys(_);if(M.length!==L.length)return!1;for(L=0;L<M.length;L++){var X=M[L];if(!Tr.call(_,X)||!ua(h[X],_[X]))return!1}return!0}function sp(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function Cc(h,_){var M=sp(h);h=0;for(var L;M;){if(M.nodeType===3){if(L=h+M.textContent.length,h<=_&&L>=_)return{node:M,offset:_-h};h=L}e:{for(;M;){if(M.nextSibling){M=M.nextSibling;break e}M=M.parentNode}M=void 0}M=sp(M)}}function Sl(h,_){return h&&_?h===_?!0:h&&h.nodeType===3?!1:_&&_.nodeType===3?Sl(h,_.parentNode):"contains"in h?h.contains(_):h.compareDocumentPosition?!!(h.compareDocumentPosition(_)&16):!1:!1}function vs(h){h=h!=null&&h.ownerDocument!=null&&h.ownerDocument.defaultView!=null?h.ownerDocument.defaultView:window;for(var _=Qu(h.document);_ instanceof h.HTMLIFrameElement;){try{var M=typeof _.contentWindow.location.href=="string"}catch{M=!1}if(M)h=_.contentWindow;else break;_=Qu(h.document)}return _}function em(h){var _=h&&h.nodeName&&h.nodeName.toLowerCase();return _&&(_==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||_==="textarea"||h.contentEditable==="true")}var Vh=$l&&"documentMode"in document&&11>=document.documentMode,$h=null,rh=null,nh=null,Mc=!1;function Ic(h,_,M){var L=M.window===M?M.document:M.nodeType===9?M:M.ownerDocument;Mc||$h==null||$h!==Qu(L)||(L=$h,"selectionStart"in L&&em(L)?L={start:L.selectionStart,end:L.selectionEnd}:(L=(L.ownerDocument&&L.ownerDocument.defaultView||window).getSelection(),L={anchorNode:L.anchorNode,anchorOffset:L.anchorOffset,focusNode:L.focusNode,focusOffset:L.focusOffset}),nh&&sc(nh,L)||(nh=L,L=D0(rh,"onSelect"),0<L.length&&(_=new md("onSelect","select",null,_,M),h.push({event:_,listeners:L}),_.target=$h)))}function ih(h,_){var M={};return M[h.toLowerCase()]=_.toLowerCase(),M["Webkit"+h]="webkit"+_,M["Moz"+h]="moz"+_,M}var oh={animationend:ih("Animation","AnimationEnd"),animationiteration:ih("Animation","AnimationIteration"),animationstart:ih("Animation","AnimationStart"),transitionrun:ih("Transition","TransitionRun"),transitionstart:ih("Transition","TransitionStart"),transitioncancel:ih("Transition","TransitionCancel"),transitionend:ih("Transition","TransitionEnd")},Pc={},ah={};$l&&(ah=document.createElement("div").style,"AnimationEvent"in window||(delete oh.animationend.animation,delete oh.animationiteration.animation,delete oh.animationstart.animation),"TransitionEvent"in window||delete oh.transitionend.transition);function Ia(h){if(Pc[h])return Pc[h];if(!oh[h])return h;var _=oh[h],M;for(M in _)if(_.hasOwnProperty(M)&&M in ah)return Pc[h]=_[M];return h}var Tl=Ia("animationend"),Gh=Ia("animationiteration"),tm=Ia("animationstart"),sA=Ia("transitionrun"),Hh=Ia("transitionstart"),Lf=Ia("transitioncancel"),lp=Ia("transitionend"),cp=new Map,sh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sh.push("scrollEnd");function es(h,_){cp.set(h,_),Yn(_,[h])}var Sd=new WeakMap;function xs(h,_){if(typeof h=="object"&&h!==null){var M=Sd.get(h);return M!==void 0?M:(_={value:h,source:_,stack:ss(_)},Sd.set(h,_),_)}return{value:h,source:_,stack:ss(_)}}var Aa=[],yu=0,mr=0;function Bf(){for(var h=yu,_=mr=yu=0;_<h;){var M=Aa[_];Aa[_++]=null;var L=Aa[_];Aa[_++]=null;var X=Aa[_];Aa[_++]=null;var ie=Aa[_];if(Aa[_++]=null,L!==null&&X!==null){var De=L.pending;De===null?X.next=X:(X.next=De.next,De.next=X),L.pending=X}ie!==0&&qh(M,X,ie)}}function vu(h,_,M,L){Aa[yu++]=h,Aa[yu++]=_,Aa[yu++]=M,Aa[yu++]=L,mr|=L,h.lanes|=L,h=h.alternate,h!==null&&(h.lanes|=L)}function lh(h,_,M,L){return vu(h,_,M,L),El(h)}function Rc(h,_){return vu(h,null,null,_),El(h)}function qh(h,_,M){h.lanes|=M;var L=h.alternate;L!==null&&(L.lanes|=M);for(var X=!1,ie=h.return;ie!==null;)ie.childLanes|=M,L=ie.alternate,L!==null&&(L.childLanes|=M),ie.tag===22&&(h=ie.stateNode,h===null||h._visibility&1||(X=!0)),h=ie,ie=ie.return;return h.tag===3?(ie=h.stateNode,X&&_!==null&&(X=31-to(M),h=ie.hiddenUpdates,L=h[X],L===null?h[X]=[_]:L.push(_),_.lane=M|536870912),ie):null}function El(h){if(50<ho)throw ho=0,sa=null,Error(l(185));for(var _=h.return;_!==null;)h=_,_=h.return;return h.tag===3?h.stateNode:null}var Dc={};function Ga(h,_,M,L){this.tag=h,this.key=M,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(h,_,M,L){return new Ga(h,_,M,L)}function ch(h){return h=h.prototype,!(!h||!h.isReactComponent)}function xu(h,_){var M=h.alternate;return M===null?(M=Dn(h.tag,_,h.key,h.mode),M.elementType=h.elementType,M.type=h.type,M.stateNode=h.stateNode,M.alternate=h,h.alternate=M):(M.pendingProps=_,M.type=h.type,M.flags=0,M.subtreeFlags=0,M.deletions=null),M.flags=h.flags&65011712,M.childLanes=h.childLanes,M.lanes=h.lanes,M.child=h.child,M.memoizedProps=h.memoizedProps,M.memoizedState=h.memoizedState,M.updateQueue=h.updateQueue,_=h.dependencies,M.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},M.sibling=h.sibling,M.index=h.index,M.ref=h.ref,M.refCleanup=h.refCleanup,M}function lA(h,_){h.flags&=65011714;var M=h.alternate;return M===null?(h.childLanes=0,h.lanes=_,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=M.childLanes,h.lanes=M.lanes,h.child=M.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=M.memoizedProps,h.memoizedState=M.memoizedState,h.updateQueue=M.updateQueue,h.type=M.type,_=M.dependencies,h.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext}),h}function Wh(h,_,M,L,X,ie){var De=0;if(L=h,typeof h=="function")ch(h)&&(De=1);else if(typeof h=="string")De=H2(h,M,ln.current)?26:h==="html"||h==="head"||h==="body"?27:5;else e:switch(h){case dt:return h=Dn(31,M,_,X),h.elementType=dt,h.lanes=ie,h;case ne:return Zh(M.children,X,ie,_);case oe:De=8,X|=24;break;case ue:return h=Dn(12,M,_,X|2),h.elementType=ue,h.lanes=ie,h;case Ee:return h=Dn(13,M,_,X),h.elementType=Ee,h.lanes=ie,h;case Be:return h=Dn(19,M,_,X),h.elementType=Be,h.lanes=ie,h;default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case ye:case ve:De=10;break e;case we:De=9;break e;case Ce:De=11;break e;case Ke:De=14;break e;case st:De=16,L=null;break e}De=29,M=Error(l(130,h===null?"null":typeof h,"")),L=null}return _=Dn(De,M,_,X),_.elementType=h,_.type=L,_.lanes=ie,_}function Zh(h,_,M,L){return h=Dn(7,h,L,_),h.lanes=M,h}function $i(h,_,M){return h=Dn(6,h,null,_),h.lanes=M,h}function Ff(h,_,M){return _=Dn(4,h.children!==null?h.children:[],h.key,_),_.lanes=M,_.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},_}var uh=[],bu=0,Td=null,up=0,Hl=[],bs=0,hh=null,Ds=1,lc="";function Oc(h,_){uh[bu++]=up,uh[bu++]=Td,Td=h,up=_}function Ed(h,_,M){Hl[bs++]=Ds,Hl[bs++]=lc,Hl[bs++]=hh,hh=h;var L=Ds;h=lc;var X=32-to(L)-1;L&=~(1<<X),M+=1;var ie=32-to(_)+X;if(30<ie){var De=X-X%5;ie=(L&(1<<De)-1).toString(32),L>>=De,X-=De,Ds=1<<32-to(_)+X|M<<X|L,lc=ie+h}else Ds=1<<ie|M<<X|L,lc=h}function wu(h){h.return!==null&&(Oc(h,1),Ed(h,1,0))}function Nf(h){for(;h===Td;)Td=uh[--bu],uh[bu]=null,up=uh[--bu],uh[bu]=null;for(;h===hh;)hh=Hl[--bs],Hl[bs]=null,lc=Hl[--bs],Hl[bs]=null,Ds=Hl[--bs],Hl[bs]=null}var ka=null,Jo=null,To=!1,kc=null,Xs=!1,hp=Error(l(519));function Su(h){var _=Error(l(418,""));throw fh(xs(_,h)),hp}function rm(h){var _=h.stateNode,M=h.type,L=h.memoizedProps;switch(_[le]=h,_[ge]=L,M){case"dialog":Oo("cancel",_),Oo("close",_);break;case"iframe":case"object":case"embed":Oo("load",_);break;case"video":case"audio":for(M=0;M<OA.length;M++)Oo(OA[M],_);break;case"source":Oo("error",_);break;case"img":case"image":case"link":Oo("error",_),Oo("load",_);break;case"details":Oo("toggle",_);break;case"input":Oo("invalid",_),Vl(_,L.value,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name,!0),ru(_);break;case"select":Oo("invalid",_);break;case"textarea":Oo("invalid",_),vl(_,L.value,L.defaultValue,L.children),ru(_)}M=L.children,typeof M!="string"&&typeof M!="number"&&typeof M!="bigint"||_.textContent===""+M||L.suppressHydrationWarning===!0||zA(_.textContent,M)?(L.popover!=null&&(Oo("beforetoggle",_),Oo("toggle",_)),L.onScroll!=null&&Oo("scroll",_),L.onScrollEnd!=null&&Oo("scrollend",_),L.onClick!=null&&(_.onclick=Zg),_=!0):_=!1,_||Su(h)}function Xh(h){for(ka=h.return;ka;)switch(ka.tag){case 5:case 13:Xs=!1;return;case 27:case 3:Xs=!0;return;default:ka=ka.return}}function Tu(h){if(h!==ka)return!1;if(!To)return Xh(h),To=!0,!1;var _=h.tag,M;if((M=_!==3&&_!==27)&&((M=_===5)&&(M=h.type,M=!(M!=="form"&&M!=="button")||Cy(h.type,h.memoizedProps)),M=!M),M&&Jo&&Su(h),Xh(h),_===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(l(317));e:{for(h=h.nextSibling,_=0;h;){if(h.nodeType===8)if(M=h.data,M==="/$"){if(_===0){Jo=dc(h.nextSibling);break e}_--}else M!=="$"&&M!=="$!"&&M!=="$?"||_++;h=h.nextSibling}Jo=null}}else _===27?(_=Jo,Sh(h.type)?(h=Kg,Kg=null,Jo=h):Jo=_):Jo=ka?dc(h.stateNode.nextSibling):null;return!0}function Eu(){Jo=ka=null,To=!1}function va(){var h=kc;return h!==null&&(Ci===null?Ci=h:Ci.push.apply(Ci,h),kc=null),h}function fh(h){kc===null?kc=[h]:kc.push(h)}var Yh=Vt(null),ql=null,za=null;function Cu(h,_,M){Cr(Yh,_._currentValue),_._currentValue=M}function Os(h){h._currentValue=Yh.current,Jt(Yh)}function fp(h,_,M){for(;h!==null;){var L=h.alternate;if((h.childLanes&_)!==_?(h.childLanes|=_,L!==null&&(L.childLanes|=_)):L!==null&&(L.childLanes&_)!==_&&(L.childLanes|=_),h===M)break;h=h.return}}function Cd(h,_,M,L){var X=h.child;for(X!==null&&(X.return=h);X!==null;){var ie=X.dependencies;if(ie!==null){var De=X.child;ie=ie.firstContext;e:for(;ie!==null;){var Xe=ie;ie=X;for(var Tt=0;Tt<_.length;Tt++)if(Xe.context===_[Tt]){ie.lanes|=M,Xe=ie.alternate,Xe!==null&&(Xe.lanes|=M),fp(ie.return,M,h),L||(De=null);break e}ie=Xe.next}}else if(X.tag===18){if(De=X.return,De===null)throw Error(l(341));De.lanes|=M,ie=De.alternate,ie!==null&&(ie.lanes|=M),fp(De,M,h),De=null}else De=X.child;if(De!==null)De.return=X;else for(De=X;De!==null;){if(De===h){De=null;break}if(X=De.sibling,X!==null){X.return=De.return,De=X;break}De=De.return}X=De}}function jf(h,_,M,L){h=null;for(var X=_,ie=!1;X!==null;){if(!ie){if((X.flags&524288)!==0)ie=!0;else if((X.flags&262144)!==0)break}if(X.tag===10){var De=X.alternate;if(De===null)throw Error(l(387));if(De=De.memoizedProps,De!==null){var Xe=X.type;ua(X.pendingProps.value,De.value)||(h!==null?h.push(Xe):h=[Xe])}}else if(X===Nn.current){if(De=X.alternate,De===null)throw Error(l(387));De.memoizedState.memoizedState!==X.memoizedState.memoizedState&&(h!==null?h.push(Rp):h=[Rp])}X=X.return}h!==null&&Cd(_,h,M,L),_.flags|=262144}function Md(h){for(h=h.firstContext;h!==null;){if(!ua(h.context._currentValue,h.memoizedValue))return!0;h=h.next}return!1}function zc(h){ql=h,za=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function ts(h){return Mu(ql,h)}function Qh(h,_){return ql===null&&zc(h),Mu(h,_)}function Mu(h,_){var M=_._currentValue;if(_={context:_,memoizedValue:M,next:null},za===null){if(h===null)throw Error(l(308));za=_,h.dependencies={lanes:0,firstContext:_},h.flags|=524288}else za=za.next=_;return M}var nm=typeof AbortController<"u"?AbortController:function(){var h=[],_=this.signal={aborted:!1,addEventListener:function(M,L){h.push(L)}};this.abort=function(){_.aborted=!0,h.forEach(function(M){return M()})}},Lc=e.unstable_scheduleCallback,Bc=e.unstable_NormalPriority,xn={$$typeof:ve,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pa(){return{controller:new nm,data:new Map,refCount:0}}function qn(h){h.refCount--,h.refCount===0&&Lc(Bc,function(){h.controller.abort()})}var Ro=null,Kh=0,Wl=0,ks=null;function im(h,_){if(Ro===null){var M=Ro=[];Kh=0,Wl=Jf(),ks={status:"pending",value:void 0,then:function(L){M.push(L)}}}return Kh++,_.then(La,La),_}function La(){if(--Kh===0&&Ro!==null){ks!==null&&(ks.status="fulfilled");var h=Ro;Ro=null,Wl=0,ks=null;for(var _=0;_<h.length;_++)(0,h[_])()}}function Iu(h,_){var M=[],L={status:"pending",value:null,reason:null,then:function(X){M.push(X)}};return h.then(function(){L.status="fulfilled",L.value=_;for(var X=0;X<M.length;X++)(0,M[X])(_)},function(X){for(L.status="rejected",L.reason=X,X=0;X<M.length;X++)(0,M[X])(void 0)}),L}var cc=et.S;et.S=function(h,_){typeof _=="object"&&_!==null&&typeof _.then=="function"&&im(h,_),cc!==null&&cc(h,_)};var Cl=Vt(null);function Vr(){var h=Cl.current;return h!==null?h:Bt.pooledCache}function Jr(h,_){_===null?Cr(Cl,Cl.current):Cr(Cl,_.pool)}function Id(){var h=Vr();return h===null?null:{parent:xn._currentValue,pool:h}}var Jh=Error(l(460)),ef=Error(l(474)),Ml=Error(l(542)),dh={then:function(){}};function Pu(h){return h=h.status,h==="fulfilled"||h==="rejected"}function Pd(){}function Zl(h,_,M){switch(M=h[M],M===void 0?h.push(_):M!==_&&(_.then(Pd,Pd),_=M),_.status){case"fulfilled":return _.value;case"rejected":throw h=_.reason,S(h),h;default:if(typeof _.status=="string")_.then(Pd,Pd);else{if(h=Bt,h!==null&&100<h.shellSuspendCounter)throw Error(l(482));h=_,h.status="pending",h.then(function(L){if(_.status==="pending"){var X=_;X.status="fulfilled",X.value=L}},function(L){if(_.status==="pending"){var X=_;X.status="rejected",X.reason=L}})}switch(_.status){case"fulfilled":return _.value;case"rejected":throw h=_.reason,S(h),h}throw b=_,Jh}}var b=null;function w(){if(b===null)throw Error(l(459));var h=b;return b=null,h}function S(h){if(h===Jh||h===Ml)throw Error(l(483))}var R=!1;function O(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function j(h,_){h=h.updateQueue,_.updateQueue===h&&(_.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function V(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function Z(h,_,M){var L=h.updateQueue;if(L===null)return null;if(L=L.shared,(gt&2)!==0){var X=L.pending;return X===null?_.next=_:(_.next=X.next,X.next=_),L.pending=_,_=El(h),qh(h,null,M),_}return vu(h,L,_,M),El(h)}function re(h,_,M){if(_=_.updateQueue,_!==null&&(_=_.shared,(M&4194048)!==0)){var L=_.lanes;L&=h.pendingLanes,M|=L,_.lanes=M,Pf(h,M)}}function pe(h,_){var M=h.updateQueue,L=h.alternate;if(L!==null&&(L=L.updateQueue,M===L)){var X=null,ie=null;if(M=M.firstBaseUpdate,M!==null){do{var De={lane:M.lane,tag:M.tag,payload:M.payload,callback:null,next:null};ie===null?X=ie=De:ie=ie.next=De,M=M.next}while(M!==null);ie===null?X=ie=_:ie=ie.next=_}else X=ie=_;M={baseState:L.baseState,firstBaseUpdate:X,lastBaseUpdate:ie,shared:L.shared,callbacks:L.callbacks},h.updateQueue=M;return}h=M.lastBaseUpdate,h===null?M.firstBaseUpdate=_:h.next=_,M.lastBaseUpdate=_}var xe=!1;function qe(){if(xe){var h=ks;if(h!==null)throw h}}function nt(h,_,M,L){xe=!1;var X=h.updateQueue;R=!1;var ie=X.firstBaseUpdate,De=X.lastBaseUpdate,Xe=X.shared.pending;if(Xe!==null){X.shared.pending=null;var Tt=Xe,dr=Tt.next;Tt.next=null,De===null?ie=dr:De.next=dr,De=Tt;var zr=h.alternate;zr!==null&&(zr=zr.updateQueue,Xe=zr.lastBaseUpdate,Xe!==De&&(Xe===null?zr.firstBaseUpdate=dr:Xe.next=dr,zr.lastBaseUpdate=Tt))}if(ie!==null){var Zr=X.baseState;De=0,zr=dr=Tt=null,Xe=ie;do{var Ar=Xe.lane&-536870913,gr=Ar!==Xe.lane;if(gr?(ar&Ar)===Ar:(L&Ar)===Ar){Ar!==0&&Ar===Wl&&(xe=!0),zr!==null&&(zr=zr.next={lane:0,tag:Xe.tag,payload:Xe.payload,callback:null,next:null});e:{var Pi=h,li=Xe;Ar=_;var Yo=M;switch(li.tag){case 1:if(Pi=li.payload,typeof Pi=="function"){Zr=Pi.call(Yo,Zr,Ar);break e}Zr=Pi;break e;case 3:Pi.flags=Pi.flags&-65537|128;case 0:if(Pi=li.payload,Ar=typeof Pi=="function"?Pi.call(Yo,Zr,Ar):Pi,Ar==null)break e;Zr=F({},Zr,Ar);break e;case 2:R=!0}}Ar=Xe.callback,Ar!==null&&(h.flags|=64,gr&&(h.flags|=8192),gr=X.callbacks,gr===null?X.callbacks=[Ar]:gr.push(Ar))}else gr={lane:Ar,tag:Xe.tag,payload:Xe.payload,callback:Xe.callback,next:null},zr===null?(dr=zr=gr,Tt=Zr):zr=zr.next=gr,De|=Ar;if(Xe=Xe.next,Xe===null){if(Xe=X.shared.pending,Xe===null)break;gr=Xe,Xe=gr.next,gr.next=null,X.lastBaseUpdate=gr,X.shared.pending=null}}while(!0);zr===null&&(Tt=Zr),X.baseState=Tt,X.firstBaseUpdate=dr,X.lastBaseUpdate=zr,ie===null&&(X.shared.lanes=0),En|=De,h.lanes=De,h.memoizedState=Zr}}function ot(h,_){if(typeof h!="function")throw Error(l(191,h));h.call(_)}function at(h,_){var M=h.callbacks;if(M!==null)for(h.callbacks=null,h=0;h<M.length;h++)ot(M[h],_)}var Rt=Vt(null),jt=Vt(0);function fr(h,_){h=Lr,Cr(jt,h),Cr(Rt,_),Lr=h|_.baseLanes}function Qt(){Cr(jt,Lr),Cr(Rt,Rt.current)}function qt(){Lr=jt.current,Jt(Rt),Jt(jt)}var Dt=0,yr=null,fn=null,an=null,ci=!1,ui=!1,yi=!1,ni=0,Tn=0,Wr=null,pi=0;function hi(){throw Error(l(321))}function mi(h,_){if(_===null)return!1;for(var M=0;M<_.length&&M<h.length;M++)if(!ua(h[M],_[M]))return!1;return!0}function Eo(h,_,M,L,X,ie){return Dt=ie,yr=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,et.H=h===null||h.memoizedState===null?_o:ii,yi=!1,ie=M(L,X),yi=!1,ui&&(ie=Uf(_,M,L,X)),Ha(h),ie}function Ha(h){et.H=sf;var _=fn!==null&&fn.next!==null;if(Dt=0,an=fn=yr=null,ci=!1,Tn=0,Wr=null,_)throw Error(l(300));h===null||Ba||(h=h.dependencies,h!==null&&Md(h)&&(Ba=!0))}function Uf(h,_,M,L){yr=h;var X=0;do{if(ui&&(Wr=null),Tn=0,ui=!1,25<=X)throw Error(l(301));if(X+=1,an=fn=null,h.updateQueue!=null){var ie=h.updateQueue;ie.lastEffect=null,ie.events=null,ie.stores=null,ie.memoCache!=null&&(ie.memoCache.index=0)}et.H=kg,ie=_(M,L)}while(ui);return ie}function Cg(){var h=et.H,_=h.useState()[0];return _=typeof _.then=="function"?Fc(_):_,h=h.useState()[0],(fn!==null?fn.memoizedState:null)!==h&&(yr.flags|=1024),_}function tf(){var h=ni!==0;return ni=0,h}function Vf(h,_,M){_.updateQueue=h.updateQueue,_.flags&=-2053,h.lanes&=~M}function Rr(h){if(ci){for(h=h.memoizedState;h!==null;){var _=h.queue;_!==null&&(_.pending=null),h=h.next}ci=!1}Dt=0,an=fn=yr=null,ui=!1,Tn=ni=0,Wr=null}function hl(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?yr.memoizedState=an=h:an=an.next=h,an}function aa(){if(fn===null){var h=yr.alternate;h=h!==null?h.memoizedState:null}else h=fn.next;var _=an===null?yr.memoizedState:an.next;if(_!==null)an=_,fn=h;else{if(h===null)throw yr.alternate===null?Error(l(467)):Error(l(310));fn=h,h={memoizedState:fn.memoizedState,baseState:fn.baseState,baseQueue:fn.baseQueue,queue:fn.queue,next:null},an===null?yr.memoizedState=an=h:an=an.next=h}return an}function ph(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Fc(h){var _=Tn;return Tn+=1,Wr===null&&(Wr=[]),h=Zl(Wr,h,_),_=yr,(an===null?_.memoizedState:an.next)===null&&(_=_.alternate,et.H=_===null||_.memoizedState===null?_o:ii),h}function dn(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return Fc(h);if(h.$$typeof===ve)return ts(h)}throw Error(l(438,String(h)))}function om(h){var _=null,M=yr.updateQueue;if(M!==null&&(_=M.memoCache),_==null){var L=yr.alternate;L!==null&&(L=L.updateQueue,L!==null&&(L=L.memoCache,L!=null&&(_={data:L.data.map(function(X){return X.slice()}),index:0})))}if(_==null&&(_={data:[],index:0}),M===null&&(M=ph(),yr.updateQueue=M),M.memoCache=_,M=_.data[_.index],M===void 0)for(M=_.data[_.index]=Array(h),L=0;L<h;L++)M[L]=bt;return _.index++,M}function mh(h,_){return typeof _=="function"?_(h):_}function Rd(h){var _=aa();return dp(_,fn,h)}function dp(h,_,M){var L=h.queue;if(L===null)throw Error(l(311));L.lastRenderedReducer=M;var X=h.baseQueue,ie=L.pending;if(ie!==null){if(X!==null){var De=X.next;X.next=ie.next,ie.next=De}_.baseQueue=X=ie,L.pending=null}if(ie=h.baseState,X===null)h.memoizedState=ie;else{_=X.next;var Xe=De=null,Tt=null,dr=_,zr=!1;do{var Zr=dr.lane&-536870913;if(Zr!==dr.lane?(ar&Zr)===Zr:(Dt&Zr)===Zr){var Ar=dr.revertLane;if(Ar===0)Tt!==null&&(Tt=Tt.next={lane:0,revertLane:0,action:dr.action,hasEagerState:dr.hasEagerState,eagerState:dr.eagerState,next:null}),Zr===Wl&&(zr=!0);else if((Dt&Ar)===Ar){dr=dr.next,Ar===Wl&&(zr=!0);continue}else Zr={lane:0,revertLane:dr.revertLane,action:dr.action,hasEagerState:dr.hasEagerState,eagerState:dr.eagerState,next:null},Tt===null?(Xe=Tt=Zr,De=ie):Tt=Tt.next=Zr,yr.lanes|=Ar,En|=Ar;Zr=dr.action,yi&&M(ie,Zr),ie=dr.hasEagerState?dr.eagerState:M(ie,Zr)}else Ar={lane:Zr,revertLane:dr.revertLane,action:dr.action,hasEagerState:dr.hasEagerState,eagerState:dr.eagerState,next:null},Tt===null?(Xe=Tt=Ar,De=ie):Tt=Tt.next=Ar,yr.lanes|=Zr,En|=Zr;dr=dr.next}while(dr!==null&&dr!==_);if(Tt===null?De=ie:Tt.next=Xe,!ua(ie,h.memoizedState)&&(Ba=!0,zr&&(M=ks,M!==null)))throw M;h.memoizedState=ie,h.baseState=De,h.baseQueue=Tt,L.lastRenderedState=ie}return X===null&&(L.lanes=0),[h.memoizedState,L.dispatch]}function pp(h){var _=aa(),M=_.queue;if(M===null)throw Error(l(311));M.lastRenderedReducer=h;var L=M.dispatch,X=M.pending,ie=_.memoizedState;if(X!==null){M.pending=null;var De=X=X.next;do ie=h(ie,De.action),De=De.next;while(De!==X);ua(ie,_.memoizedState)||(Ba=!0),_.memoizedState=ie,_.baseQueue===null&&(_.baseState=ie),M.lastRenderedState=ie}return[ie,L]}function Mg(h,_,M){var L=yr,X=aa(),ie=To;if(ie){if(M===void 0)throw Error(l(407));M=M()}else M=_();var De=!ua((fn||X).memoizedState,M);De&&(X.memoizedState=M,Ba=!0),X=X.queue;var Xe=Pg.bind(null,L,X,h);if(xr(2048,8,Xe,[h]),X.getSnapshot!==_||De||an!==null&&an.memoizedState.tag&1){if(L.flags|=2048,Nc(9,Ah(),Ig.bind(null,L,X,M,_),null),Bt===null)throw Error(l(349));ie||(Dt&124)!==0||p0(L,_,M)}return M}function p0(h,_,M){h.flags|=16384,h={getSnapshot:_,value:M},_=yr.updateQueue,_===null?(_=ph(),yr.updateQueue=_,_.stores=[h]):(M=_.stores,M===null?_.stores=[h]:M.push(h))}function Ig(h,_,M,L){_.value=M,_.getSnapshot=L,Il(_)&&cA(h)}function Pg(h,_,M){return M(function(){Il(_)&&cA(h)})}function Il(h){var _=h.getSnapshot;h=h.value;try{var M=_();return!ua(h,M)}catch{return!0}}function cA(h){var _=Rc(h,2);_!==null&&xa(_,h,2)}function zs(h){var _=hl();if(typeof h=="function"){var M=h;if(h=M(),yi){Po(!0);try{M()}finally{Po(!1)}}}return _.memoizedState=_.baseState=h,_.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:h},_}function rf(h,_,M,L){return h.baseState=M,dp(h,fn,typeof L=="function"?L:mh)}function Rg(h,_,M,L,X){if(hm(h))throw Error(l(485));if(h=_.action,h!==null){var ie={payload:X,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(De){ie.listeners.push(De)}};et.T!==null?M(!0):ie.isTransition=!1,L(ie),M=_.pending,M===null?(ie.next=_.pending=ie,uA(_,ie)):(ie.next=M.next,_.pending=M.next=ie)}}function uA(h,_){var M=_.action,L=_.payload,X=h.state;if(_.isTransition){var ie=et.T,De={};et.T=De;try{var Xe=M(X,L),Tt=et.S;Tt!==null&&Tt(De,Xe),hA(h,_,Xe)}catch(dr){nf(h,_,dr)}finally{et.T=ie}}else try{ie=M(X,L),hA(h,_,ie)}catch(dr){nf(h,_,dr)}}function hA(h,_,M){M!==null&&typeof M=="object"&&typeof M.then=="function"?M.then(function(L){am(h,_,L)},function(L){return nf(h,_,L)}):am(h,_,M)}function am(h,_,M){_.status="fulfilled",_.value=M,Ru(_),h.state=M,_=h.pending,_!==null&&(M=_.next,M===_?h.pending=null:(M=M.next,_.next=M,uA(h,M)))}function nf(h,_,M){var L=h.pending;if(h.pending=null,L!==null){L=L.next;do _.status="rejected",_.reason=M,Ru(_),_=_.next;while(_!==L)}h.action=null}function Ru(h){h=h.listeners;for(var _=0;_<h.length;_++)(0,h[_])()}function co(h,_){return _}function $f(h,_){if(To){var M=Bt.formState;if(M!==null){e:{var L=yr;if(To){if(Jo){t:{for(var X=Jo,ie=Xs;X.nodeType!==8;){if(!ie){X=null;break t}if(X=dc(X.nextSibling),X===null){X=null;break t}}ie=X.data,X=ie==="F!"||ie==="F"?X:null}if(X){Jo=dc(X.nextSibling),L=X.data==="F!";break e}}Su(L)}L=!1}L&&(_=M[0])}}return M=hl(),M.memoizedState=M.baseState=_,L={pending:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:_},M.queue=L,M=v0.bind(null,yr,L),L.dispatch=M,L=zs(!1),ie=AA.bind(null,yr,!1,L.queue),L=hl(),X={state:_,dispatch:null,action:h,pending:null},L.queue=X,M=Rg.bind(null,yr,X,ie,M),X.dispatch=M,L.memoizedState=h,[_,M,!1]}function fA(h){var _=aa();return m0(_,fn,h)}function m0(h,_,M){if(_=dp(h,_,co)[0],h=Rd(mh)[0],typeof _=="object"&&_!==null&&typeof _.then=="function")try{var L=Fc(_)}catch(De){throw De===Jh?Ml:De}else L=_;_=aa();var X=_.queue,ie=X.dispatch;return M!==_.memoizedState&&(yr.flags|=2048,Nc(9,Ah(),of.bind(null,X,M),null)),[L,ie,h]}function of(h,_){h.action=_}function dA(h){var _=aa(),M=fn;if(M!==null)return m0(_,M,h);aa(),_=_.memoizedState,M=aa();var L=M.queue.dispatch;return M.memoizedState=h,[_,L,!1]}function Nc(h,_,M,L){return h={tag:h,create:M,deps:L,inst:_,next:null},_=yr.updateQueue,_===null&&(_=ph(),yr.updateQueue=_),M=_.lastEffect,M===null?_.lastEffect=h.next=h:(L=M.next,M.next=h,h.next=L,_.lastEffect=h),h}function Ah(){return{destroy:void 0,resource:void 0}}function Gf(){return aa().memoizedState}function lr(h,_,M,L){var X=hl();L=L===void 0?null:L,yr.flags|=h,X.memoizedState=Nc(1|_,Ah(),M,L)}function xr(h,_,M,L){var X=aa();L=L===void 0?null:L;var ie=X.memoizedState.inst;fn!==null&&L!==null&&mi(L,fn.memoizedState.deps)?X.memoizedState=Nc(_,ie,M,L):(yr.flags|=h,X.memoizedState=Nc(1|_,ie,M,L))}function Dd(h,_){lr(8390656,8,h,_)}function Go(h,_){xr(2048,8,h,_)}function pt(h,_){return xr(4,2,h,_)}function sm(h,_){return xr(4,4,h,_)}function Hf(h,_){if(typeof _=="function"){h=h();var M=_(h);return function(){typeof M=="function"?M():_(null)}}if(_!=null)return h=h(),_.current=h,function(){_.current=null}}function lm(h,_,M){M=M!=null?M.concat([h]):null,xr(4,4,Hf.bind(null,_,h),M)}function Od(){}function A0(h,_){var M=aa();_=_===void 0?null:_;var L=M.memoizedState;return _!==null&&mi(_,L[1])?L[0]:(M.memoizedState=[h,_],h)}function jc(h,_){var M=aa();_=_===void 0?null:_;var L=M.memoizedState;if(_!==null&&mi(_,L[1]))return L[0];if(L=h(),yi){Po(!0);try{h()}finally{Po(!1)}}return M.memoizedState=[L,_],L}function qf(h,_,M){return M===void 0||(Dt&1073741824)!==0?h.memoizedState=_:(h.memoizedState=M,h=Xl(),yr.lanes|=h,En|=h,M)}function g0(h,_,M,L){return ua(M,_)?M:Rt.current!==null?(h=qf(h,M,L),ua(h,_)||(Ba=!0),h):(Dt&42)===0?(Ba=!0,h.memoizedState=M):(h=Xl(),yr.lanes|=h,En|=h,_)}function Dg(h,_,M,L,X){var ie=Zt.p;Zt.p=ie!==0&&8>ie?ie:8;var De=et.T,Xe={};et.T=Xe,AA(h,!1,_,M);try{var Tt=X(),dr=et.S;if(dr!==null&&dr(Xe,Tt),Tt!==null&&typeof Tt=="object"&&typeof Tt.then=="function"){var zr=Iu(Tt,L);um(h,_,zr,qo(h))}else um(h,_,L,qo(h))}catch(Zr){um(h,_,{then:function(){},status:"rejected",reason:Zr},qo())}finally{Zt.p=ie,et.T=De}}function Og(){}function mp(h,_,M,L){if(h.tag!==5)throw Error(l(476));var X=pA(h).queue;Dg(h,X,_,ir,M===null?Og:function(){return _0(h),M(L)})}function pA(h){var _=h.memoizedState;if(_!==null)return _;_={memoizedState:ir,baseState:ir,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:ir},next:null};var M={};return _.next={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mh,lastRenderedState:M},next:null},h.memoizedState=_,h=h.alternate,h!==null&&(h.memoizedState=_),_}function _0(h){var _=pA(h).next.queue;um(h,_,{},qo())}function mA(){return ts(Rp)}function cm(){return aa().memoizedState}function Ap(){return aa().memoizedState}function gp(h){for(var _=h.return;_!==null;){switch(_.tag){case 24:case 3:var M=qo();h=V(M);var L=Z(_,h,M);L!==null&&(xa(L,_,M),re(L,_,M)),_={cache:Pa()},h.payload=_;return}_=_.return}}function y0(h,_,M){var L=qo();M={lane:L,revertLane:0,action:M,hasEagerState:!1,eagerState:null,next:null},hm(h)?Ls(_,M):(M=lh(h,_,M,L),M!==null&&(xa(M,h,L),af(M,_,L)))}function v0(h,_,M){var L=qo();um(h,_,M,L)}function um(h,_,M,L){var X={lane:L,revertLane:0,action:M,hasEagerState:!1,eagerState:null,next:null};if(hm(h))Ls(_,X);else{var ie=h.alternate;if(h.lanes===0&&(ie===null||ie.lanes===0)&&(ie=_.lastRenderedReducer,ie!==null))try{var De=_.lastRenderedState,Xe=ie(De,M);if(X.hasEagerState=!0,X.eagerState=Xe,ua(Xe,De))return vu(h,_,X,0),Bt===null&&Bf(),!1}catch{}finally{}if(M=lh(h,_,X,L),M!==null)return xa(M,h,L),af(M,_,L),!0}return!1}function AA(h,_,M,L){if(L={lane:2,revertLane:Jf(),action:L,hasEagerState:!1,eagerState:null,next:null},hm(h)){if(_)throw Error(l(479))}else _=lh(h,M,L,2),_!==null&&xa(_,h,2)}function hm(h){var _=h.alternate;return h===yr||_!==null&&_===yr}function Ls(h,_){ui=ci=!0;var M=h.pending;M===null?_.next=_:(_.next=M.next,M.next=_),h.pending=_}function af(h,_,M){if((M&4194048)!==0){var L=_.lanes;L&=h.pendingLanes,M|=L,_.lanes=M,Pf(h,M)}}var sf={readContext:ts,use:dn,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useLayoutEffect:hi,useInsertionEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useSyncExternalStore:hi,useId:hi,useHostTransitionStatus:hi,useFormState:hi,useActionState:hi,useOptimistic:hi,useMemoCache:hi,useCacheRefresh:hi},_o={readContext:ts,use:dn,useCallback:function(h,_){return hl().memoizedState=[h,_===void 0?null:_],h},useContext:ts,useEffect:Dd,useImperativeHandle:function(h,_,M){M=M!=null?M.concat([h]):null,lr(4194308,4,Hf.bind(null,_,h),M)},useLayoutEffect:function(h,_){return lr(4194308,4,h,_)},useInsertionEffect:function(h,_){lr(4,2,h,_)},useMemo:function(h,_){var M=hl();_=_===void 0?null:_;var L=h();if(yi){Po(!0);try{h()}finally{Po(!1)}}return M.memoizedState=[L,_],L},useReducer:function(h,_,M){var L=hl();if(M!==void 0){var X=M(_);if(yi){Po(!0);try{M(_)}finally{Po(!1)}}}else X=_;return L.memoizedState=L.baseState=X,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:X},L.queue=h,h=h.dispatch=y0.bind(null,yr,h),[L.memoizedState,h]},useRef:function(h){var _=hl();return h={current:h},_.memoizedState=h},useState:function(h){h=zs(h);var _=h.queue,M=v0.bind(null,yr,_);return _.dispatch=M,[h.memoizedState,M]},useDebugValue:Od,useDeferredValue:function(h,_){var M=hl();return qf(M,h,_)},useTransition:function(){var h=zs(!1);return h=Dg.bind(null,yr,h.queue,!0,!1),hl().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,_,M){var L=yr,X=hl();if(To){if(M===void 0)throw Error(l(407));M=M()}else{if(M=_(),Bt===null)throw Error(l(349));(ar&124)!==0||p0(L,_,M)}X.memoizedState=M;var ie={value:M,getSnapshot:_};return X.queue=ie,Dd(Pg.bind(null,L,ie,h),[h]),L.flags|=2048,Nc(9,Ah(),Ig.bind(null,L,ie,M,_),null),M},useId:function(){var h=hl(),_=Bt.identifierPrefix;if(To){var M=lc,L=Ds;M=(L&~(1<<32-to(L)-1)).toString(32)+M,_=""+_+"R"+M,M=ni++,0<M&&(_+="H"+M.toString(32)),_+=""}else M=pi++,_=""+_+"r"+M.toString(32)+"";return h.memoizedState=_},useHostTransitionStatus:mA,useFormState:$f,useActionState:$f,useOptimistic:function(h){var _=hl();_.memoizedState=_.baseState=h;var M={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return _.queue=M,_=AA.bind(null,yr,!0,M),M.dispatch=_,[h,_]},useMemoCache:om,useCacheRefresh:function(){return hl().memoizedState=gp.bind(null,yr)}},ii={readContext:ts,use:dn,useCallback:A0,useContext:ts,useEffect:Go,useImperativeHandle:lm,useInsertionEffect:pt,useLayoutEffect:sm,useMemo:jc,useReducer:Rd,useRef:Gf,useState:function(){return Rd(mh)},useDebugValue:Od,useDeferredValue:function(h,_){var M=aa();return g0(M,fn.memoizedState,h,_)},useTransition:function(){var h=Rd(mh)[0],_=aa().memoizedState;return[typeof h=="boolean"?h:Fc(h),_]},useSyncExternalStore:Mg,useId:cm,useHostTransitionStatus:mA,useFormState:fA,useActionState:fA,useOptimistic:function(h,_){var M=aa();return rf(M,fn,h,_)},useMemoCache:om,useCacheRefresh:Ap},kg={readContext:ts,use:dn,useCallback:A0,useContext:ts,useEffect:Go,useImperativeHandle:lm,useInsertionEffect:pt,useLayoutEffect:sm,useMemo:jc,useReducer:pp,useRef:Gf,useState:function(){return pp(mh)},useDebugValue:Od,useDeferredValue:function(h,_){var M=aa();return fn===null?qf(M,h,_):g0(M,fn.memoizedState,h,_)},useTransition:function(){var h=pp(mh)[0],_=aa().memoizedState;return[typeof h=="boolean"?h:Fc(h),_]},useSyncExternalStore:Mg,useId:cm,useHostTransitionStatus:mA,useFormState:dA,useActionState:dA,useOptimistic:function(h,_){var M=aa();return fn!==null?rf(M,fn,h,_):(M.baseState=h,[h,M.queue.dispatch])},useMemoCache:om,useCacheRefresh:Ap},uc=null,Du=0;function gh(h){var _=Du;return Du+=1,uc===null&&(uc=[]),Zl(uc,h,_)}function Uc(h,_){_=_.props.ref,h.ref=_!==void 0?_:null}function _p(h,_){throw _.$$typeof===G?Error(l(525)):(h=Object.prototype.toString.call(_),Error(l(31,h==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":h)))}function fm(h){var _=h._init;return _(h._payload)}function gA(h){function _(Yt,Ft){if(h){var nr=Yt.deletions;nr===null?(Yt.deletions=[Ft],Yt.flags|=16):nr.push(Ft)}}function M(Yt,Ft){if(!h)return null;for(;Ft!==null;)_(Yt,Ft),Ft=Ft.sibling;return null}function L(Yt){for(var Ft=new Map;Yt!==null;)Yt.key!==null?Ft.set(Yt.key,Yt):Ft.set(Yt.index,Yt),Yt=Yt.sibling;return Ft}function X(Yt,Ft){return Yt=xu(Yt,Ft),Yt.index=0,Yt.sibling=null,Yt}function ie(Yt,Ft,nr){return Yt.index=nr,h?(nr=Yt.alternate,nr!==null?(nr=nr.index,nr<Ft?(Yt.flags|=67108866,Ft):nr):(Yt.flags|=67108866,Ft)):(Yt.flags|=1048576,Ft)}function De(Yt){return h&&Yt.alternate===null&&(Yt.flags|=67108866),Yt}function Xe(Yt,Ft,nr,Nr){return Ft===null||Ft.tag!==6?(Ft=$i(nr,Yt.mode,Nr),Ft.return=Yt,Ft):(Ft=X(Ft,nr),Ft.return=Yt,Ft)}function Tt(Yt,Ft,nr,Nr){var Gn=nr.type;return Gn===ne?zr(Yt,Ft,nr.props.children,Nr,nr.key):Ft!==null&&(Ft.elementType===Gn||typeof Gn=="object"&&Gn!==null&&Gn.$$typeof===st&&fm(Gn)===Ft.type)?(Ft=X(Ft,nr.props),Uc(Ft,nr),Ft.return=Yt,Ft):(Ft=Wh(nr.type,nr.key,nr.props,null,Yt.mode,Nr),Uc(Ft,nr),Ft.return=Yt,Ft)}function dr(Yt,Ft,nr,Nr){return Ft===null||Ft.tag!==4||Ft.stateNode.containerInfo!==nr.containerInfo||Ft.stateNode.implementation!==nr.implementation?(Ft=Ff(nr,Yt.mode,Nr),Ft.return=Yt,Ft):(Ft=X(Ft,nr.children||[]),Ft.return=Yt,Ft)}function zr(Yt,Ft,nr,Nr,Gn){return Ft===null||Ft.tag!==7?(Ft=Zh(nr,Yt.mode,Nr,Gn),Ft.return=Yt,Ft):(Ft=X(Ft,nr),Ft.return=Yt,Ft)}function Zr(Yt,Ft,nr){if(typeof Ft=="string"&&Ft!==""||typeof Ft=="number"||typeof Ft=="bigint")return Ft=$i(""+Ft,Yt.mode,nr),Ft.return=Yt,Ft;if(typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case Q:return nr=Wh(Ft.type,Ft.key,Ft.props,null,Yt.mode,nr),Uc(nr,Ft),nr.return=Yt,nr;case te:return Ft=Ff(Ft,Yt.mode,nr),Ft.return=Yt,Ft;case st:var Nr=Ft._init;return Ft=Nr(Ft._payload),Zr(Yt,Ft,nr)}if(Et(Ft)||Re(Ft))return Ft=Zh(Ft,Yt.mode,nr,null),Ft.return=Yt,Ft;if(typeof Ft.then=="function")return Zr(Yt,gh(Ft),nr);if(Ft.$$typeof===ve)return Zr(Yt,Qh(Yt,Ft),nr);_p(Yt,Ft)}return null}function Ar(Yt,Ft,nr,Nr){var Gn=Ft!==null?Ft.key:null;if(typeof nr=="string"&&nr!==""||typeof nr=="number"||typeof nr=="bigint")return Gn!==null?null:Xe(Yt,Ft,""+nr,Nr);if(typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case Q:return nr.key===Gn?Tt(Yt,Ft,nr,Nr):null;case te:return nr.key===Gn?dr(Yt,Ft,nr,Nr):null;case st:return Gn=nr._init,nr=Gn(nr._payload),Ar(Yt,Ft,nr,Nr)}if(Et(nr)||Re(nr))return Gn!==null?null:zr(Yt,Ft,nr,Nr,null);if(typeof nr.then=="function")return Ar(Yt,Ft,gh(nr),Nr);if(nr.$$typeof===ve)return Ar(Yt,Ft,Qh(Yt,nr),Nr);_p(Yt,nr)}return null}function gr(Yt,Ft,nr,Nr,Gn){if(typeof Nr=="string"&&Nr!==""||typeof Nr=="number"||typeof Nr=="bigint")return Yt=Yt.get(nr)||null,Xe(Ft,Yt,""+Nr,Gn);if(typeof Nr=="object"&&Nr!==null){switch(Nr.$$typeof){case Q:return Yt=Yt.get(Nr.key===null?nr:Nr.key)||null,Tt(Ft,Yt,Nr,Gn);case te:return Yt=Yt.get(Nr.key===null?nr:Nr.key)||null,dr(Ft,Yt,Nr,Gn);case st:var fo=Nr._init;return Nr=fo(Nr._payload),gr(Yt,Ft,nr,Nr,Gn)}if(Et(Nr)||Re(Nr))return Yt=Yt.get(nr)||null,zr(Ft,Yt,Nr,Gn,null);if(typeof Nr.then=="function")return gr(Yt,Ft,nr,gh(Nr),Gn);if(Nr.$$typeof===ve)return gr(Yt,Ft,nr,Qh(Ft,Nr),Gn);_p(Ft,Nr)}return null}function Pi(Yt,Ft,nr,Nr){for(var Gn=null,fo=null,Wn=Ft,fi=Ft=0,Fs=null;Wn!==null&&fi<nr.length;fi++){Wn.index>fi?(Fs=Wn,Wn=null):Fs=Wn.sibling;var ko=Ar(Yt,Wn,nr[fi],Nr);if(ko===null){Wn===null&&(Wn=Fs);break}h&&Wn&&ko.alternate===null&&_(Yt,Wn),Ft=ie(ko,Ft,fi),fo===null?Gn=ko:fo.sibling=ko,fo=ko,Wn=Fs}if(fi===nr.length)return M(Yt,Wn),To&&Oc(Yt,fi),Gn;if(Wn===null){for(;fi<nr.length;fi++)Wn=Zr(Yt,nr[fi],Nr),Wn!==null&&(Ft=ie(Wn,Ft,fi),fo===null?Gn=Wn:fo.sibling=Wn,fo=Wn);return To&&Oc(Yt,fi),Gn}for(Wn=L(Wn);fi<nr.length;fi++)Fs=gr(Wn,Yt,fi,nr[fi],Nr),Fs!==null&&(h&&Fs.alternate!==null&&Wn.delete(Fs.key===null?fi:Fs.key),Ft=ie(Fs,Ft,fi),fo===null?Gn=Fs:fo.sibling=Fs,fo=Fs);return h&&Wn.forEach(function(Nu){return _(Yt,Nu)}),To&&Oc(Yt,fi),Gn}function li(Yt,Ft,nr,Nr){if(nr==null)throw Error(l(151));for(var Gn=null,fo=null,Wn=Ft,fi=Ft=0,Fs=null,ko=nr.next();Wn!==null&&!ko.done;fi++,ko=nr.next()){Wn.index>fi?(Fs=Wn,Wn=null):Fs=Wn.sibling;var Nu=Ar(Yt,Wn,ko.value,Nr);if(Nu===null){Wn===null&&(Wn=Fs);break}h&&Wn&&Nu.alternate===null&&_(Yt,Wn),Ft=ie(Nu,Ft,fi),fo===null?Gn=Nu:fo.sibling=Nu,fo=Nu,Wn=Fs}if(ko.done)return M(Yt,Wn),To&&Oc(Yt,fi),Gn;if(Wn===null){for(;!ko.done;fi++,ko=nr.next())ko=Zr(Yt,ko.value,Nr),ko!==null&&(Ft=ie(ko,Ft,fi),fo===null?Gn=ko:fo.sibling=ko,fo=ko);return To&&Oc(Yt,fi),Gn}for(Wn=L(Wn);!ko.done;fi++,ko=nr.next())ko=gr(Wn,Yt,fi,ko.value,Nr),ko!==null&&(h&&ko.alternate!==null&&Wn.delete(ko.key===null?fi:ko.key),Ft=ie(ko,Ft,fi),fo===null?Gn=ko:fo.sibling=ko,fo=ko);return h&&Wn.forEach(function(A1){return _(Yt,A1)}),To&&Oc(Yt,fi),Gn}function Yo(Yt,Ft,nr,Nr){if(typeof nr=="object"&&nr!==null&&nr.type===ne&&nr.key===null&&(nr=nr.props.children),typeof nr=="object"&&nr!==null){switch(nr.$$typeof){case Q:e:{for(var Gn=nr.key;Ft!==null;){if(Ft.key===Gn){if(Gn=nr.type,Gn===ne){if(Ft.tag===7){M(Yt,Ft.sibling),Nr=X(Ft,nr.props.children),Nr.return=Yt,Yt=Nr;break e}}else if(Ft.elementType===Gn||typeof Gn=="object"&&Gn!==null&&Gn.$$typeof===st&&fm(Gn)===Ft.type){M(Yt,Ft.sibling),Nr=X(Ft,nr.props),Uc(Nr,nr),Nr.return=Yt,Yt=Nr;break e}M(Yt,Ft);break}else _(Yt,Ft);Ft=Ft.sibling}nr.type===ne?(Nr=Zh(nr.props.children,Yt.mode,Nr,nr.key),Nr.return=Yt,Yt=Nr):(Nr=Wh(nr.type,nr.key,nr.props,null,Yt.mode,Nr),Uc(Nr,nr),Nr.return=Yt,Yt=Nr)}return De(Yt);case te:e:{for(Gn=nr.key;Ft!==null;){if(Ft.key===Gn)if(Ft.tag===4&&Ft.stateNode.containerInfo===nr.containerInfo&&Ft.stateNode.implementation===nr.implementation){M(Yt,Ft.sibling),Nr=X(Ft,nr.children||[]),Nr.return=Yt,Yt=Nr;break e}else{M(Yt,Ft);break}else _(Yt,Ft);Ft=Ft.sibling}Nr=Ff(nr,Yt.mode,Nr),Nr.return=Yt,Yt=Nr}return De(Yt);case st:return Gn=nr._init,nr=Gn(nr._payload),Yo(Yt,Ft,nr,Nr)}if(Et(nr))return Pi(Yt,Ft,nr,Nr);if(Re(nr)){if(Gn=Re(nr),typeof Gn!="function")throw Error(l(150));return nr=Gn.call(nr),li(Yt,Ft,nr,Nr)}if(typeof nr.then=="function")return Yo(Yt,Ft,gh(nr),Nr);if(nr.$$typeof===ve)return Yo(Yt,Ft,Qh(Yt,nr),Nr);_p(Yt,nr)}return typeof nr=="string"&&nr!==""||typeof nr=="number"||typeof nr=="bigint"?(nr=""+nr,Ft!==null&&Ft.tag===6?(M(Yt,Ft.sibling),Nr=X(Ft,nr),Nr.return=Yt,Yt=Nr):(M(Yt,Ft),Nr=$i(nr,Yt.mode,Nr),Nr.return=Yt,Yt=Nr),De(Yt)):M(Yt,Ft)}return function(Yt,Ft,nr,Nr){try{Du=0;var Gn=Yo(Yt,Ft,nr,Nr);return uc=null,Gn}catch(Wn){if(Wn===Jh||Wn===Ml)throw Wn;var fo=Dn(29,Wn,null,Yt.mode);return fo.lanes=Nr,fo.return=Yt,fo}finally{}}}var lf=gA(!0),fl=gA(!1),ws=Vt(null),Pl=null;function Ou(h){var _=h.alternate;Cr(Ra,Ra.current&1),Cr(ws,h),Pl===null&&(_===null||Rt.current!==null||_.memoizedState!==null)&&(Pl=h)}function _A(h){if(h.tag===22){if(Cr(Ra,Ra.current),Cr(ws,h),Pl===null){var _=h.alternate;_!==null&&_.memoizedState!==null&&(Pl=h)}}else _h()}function _h(){Cr(Ra,Ra.current),Cr(ws,ws.current)}function Ss(h){Jt(ws),Pl===h&&(Pl=null),Jt(Ra)}var Ra=Vt(0);function ha(h){for(var _=h;_!==null;){if(_.tag===13){var M=_.memoizedState;if(M!==null&&(M=M.dehydrated,M===null||M.data==="$?"||FA(M)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if((_.flags&128)!==0)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===h)break;for(;_.sibling===null;){if(_.return===null||_.return===h)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}function Wf(h,_,M,L){_=h.memoizedState,M=M(L,_),M=M==null?_:F({},_,M),h.memoizedState=M,h.lanes===0&&(h.updateQueue.baseState=M)}var yp={enqueueSetState:function(h,_,M){h=h._reactInternals;var L=qo(),X=V(L);X.payload=_,M!=null&&(X.callback=M),_=Z(h,X,L),_!==null&&(xa(_,h,L),re(_,h,L))},enqueueReplaceState:function(h,_,M){h=h._reactInternals;var L=qo(),X=V(L);X.tag=1,X.payload=_,M!=null&&(X.callback=M),_=Z(h,X,L),_!==null&&(xa(_,h,L),re(_,h,L))},enqueueForceUpdate:function(h,_){h=h._reactInternals;var M=qo(),L=V(M);L.tag=2,_!=null&&(L.callback=_),_=Z(h,L,M),_!==null&&(xa(_,h,M),re(_,h,M))}};function yA(h,_,M,L,X,ie,De){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(L,ie,De):_.prototype&&_.prototype.isPureReactComponent?!sc(M,L)||!sc(X,ie):!0}function vA(h,_,M,L){h=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(M,L),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(M,L),_.state!==h&&yp.enqueueReplaceState(_,_.state,null)}function ea(h,_){var M=_;if("ref"in _){M={};for(var L in _)L!=="ref"&&(M[L]=_[L])}if(h=h.defaultProps){M===_&&(M=F({},M));for(var X in h)M[X]===void 0&&(M[X]=h[X])}return M}var Zf=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(_))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)};function xA(h){Zf(h)}function vp(h){console.error(h)}function Xf(h){Zf(h)}function xp(h,_){try{var M=h.onUncaughtError;M(_.value,{componentStack:_.stack})}catch(L){setTimeout(function(){throw L})}}function dm(h,_,M){try{var L=h.onCaughtError;L(M.value,{componentStack:M.stack,errorBoundary:_.tag===1?_.stateNode:null})}catch(X){setTimeout(function(){throw X})}}function kd(h,_,M){return M=V(M),M.tag=3,M.payload={element:null},M.callback=function(){xp(h,_)},M}function zd(h){return h=V(h),h.tag=3,h}function pm(h,_,M,L){var X=M.type.getDerivedStateFromError;if(typeof X=="function"){var ie=L.value;h.payload=function(){return X(ie)},h.callback=function(){dm(_,M,L)}}var De=M.stateNode;De!==null&&typeof De.componentDidCatch=="function"&&(h.callback=function(){dm(_,M,L),typeof X!="function"&&(Ji===null?Ji=new Set([this]):Ji.add(this));var Xe=L.stack;this.componentDidCatch(L.value,{componentStack:Xe!==null?Xe:""})})}function bA(h,_,M,L,X){if(M.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){if(_=M.alternate,_!==null&&jf(_,M,X,!0),M=ws.current,M!==null){switch(M.tag){case 13:return Pl===null?ra():M.alternate===null&&rn===0&&(rn=3),M.flags&=-257,M.flags|=65536,M.lanes=X,L===dh?M.flags|=16384:(_=M.updateQueue,_===null?M.updateQueue=new Set([L]):_.add(L),Ng(h,L,X)),!1;case 22:return M.flags|=65536,L===dh?M.flags|=16384:(_=M.updateQueue,_===null?(_={transitions:null,markerInstances:null,retryQueue:new Set([L])},M.updateQueue=_):(M=_.retryQueue,M===null?_.retryQueue=new Set([L]):M.add(L)),Ng(h,L,X)),!1}throw Error(l(435,M.tag))}return Ng(h,L,X),ra(),!1}if(To)return _=ws.current,_!==null?((_.flags&65536)===0&&(_.flags|=256),_.flags|=65536,_.lanes=X,L!==hp&&(h=Error(l(422),{cause:L}),fh(xs(h,M)))):(L!==hp&&(_=Error(l(423),{cause:L}),fh(xs(_,M))),h=h.current.alternate,h.flags|=65536,X&=-X,h.lanes|=X,L=xs(L,M),X=kd(h.stateNode,L,X),pe(h,X),rn!==4&&(rn=2)),!1;var ie=Error(l(520),{cause:L});if(ie=xs(ie,M),xi===null?xi=[ie]:xi.push(ie),rn!==4&&(rn=2),_===null)return!0;L=xs(L,M),M=_;do{switch(M.tag){case 3:return M.flags|=65536,h=X&-X,M.lanes|=h,h=kd(M.stateNode,L,h),pe(M,h),!1;case 1:if(_=M.type,ie=M.stateNode,(M.flags&128)===0&&(typeof _.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Ji===null||!Ji.has(ie))))return M.flags|=65536,X&=-X,M.lanes|=X,X=zd(X),pm(X,h,M,L),pe(M,X),!1}M=M.return}while(M!==null);return!1}var wA=Error(l(461)),Ba=!1;function qa(h,_,M,L){_.child=h===null?fl(_,null,M,L):lf(_,h.child,M,L)}function mm(h,_,M,L,X){M=M.render;var ie=_.ref;if("ref"in L){var De={};for(var Xe in L)Xe!=="ref"&&(De[Xe]=L[Xe])}else De=L;return zc(_),L=Eo(h,_,M,De,ie,X),Xe=tf(),h!==null&&!Ba?(Vf(h,_,X),cf(h,_,X)):(To&&Xe&&wu(_),_.flags|=1,qa(h,_,L,X),_.child)}function x0(h,_,M,L,X){if(h===null){var ie=M.type;return typeof ie=="function"&&!ch(ie)&&ie.defaultProps===void 0&&M.compare===null?(_.tag=15,_.type=ie,SA(h,_,ie,L,X)):(h=Wh(M.type,null,L,_,_.mode,X),h.ref=_.ref,h.return=_,_.child=h)}if(ie=h.child,!bp(h,X)){var De=ie.memoizedProps;if(M=M.compare,M=M!==null?M:sc,M(De,L)&&h.ref===_.ref)return cf(h,_,X)}return _.flags|=1,h=xu(ie,L),h.ref=_.ref,h.return=_,_.child=h}function SA(h,_,M,L,X){if(h!==null){var ie=h.memoizedProps;if(sc(ie,L)&&h.ref===_.ref)if(Ba=!1,_.pendingProps=L=ie,bp(h,X))(h.flags&131072)!==0&&(Ba=!0);else return _.lanes=h.lanes,cf(h,_,X)}return TA(h,_,M,L,X)}function b0(h,_,M){var L=_.pendingProps,X=L.children,ie=h!==null?h.memoizedState:null;if(L.mode==="hidden"){if((_.flags&128)!==0){if(L=ie!==null?ie.baseLanes|M:M,h!==null){for(X=_.child=h.child,ie=0;X!==null;)ie=ie|X.lanes|X.childLanes,X=X.sibling;_.childLanes=ie&~L}else _.childLanes=0,_.child=null;return Am(h,_,L,M)}if((M&536870912)!==0)_.memoizedState={baseLanes:0,cachePool:null},h!==null&&Jr(_,ie!==null?ie.cachePool:null),ie!==null?fr(_,ie):Qt(),_A(_);else return _.lanes=_.childLanes=536870912,Am(h,_,ie!==null?ie.baseLanes|M:M,M)}else ie!==null?(Jr(_,ie.cachePool),fr(_,ie),_h(),_.memoizedState=null):(h!==null&&Jr(_,null),Qt(),_h());return qa(h,_,X,M),_.child}function Am(h,_,M,L){var X=Vr();return X=X===null?null:{parent:xn._currentValue,pool:X},_.memoizedState={baseLanes:M,cachePool:X},h!==null&&Jr(_,null),Qt(),_A(_),h!==null&&jf(h,_,L,!0),null}function gm(h,_){var M=_.ref;if(M===null)h!==null&&h.ref!==null&&(_.flags|=4194816);else{if(typeof M!="function"&&typeof M!="object")throw Error(l(284));(h===null||h.ref!==M)&&(_.flags|=4194816)}}function TA(h,_,M,L,X){return zc(_),M=Eo(h,_,M,L,void 0,X),L=tf(),h!==null&&!Ba?(Vf(h,_,X),cf(h,_,X)):(To&&L&&wu(_),_.flags|=1,qa(h,_,M,X),_.child)}function w0(h,_,M,L,X,ie){return zc(_),_.updateQueue=null,M=Uf(_,L,M,X),Ha(h),L=tf(),h!==null&&!Ba?(Vf(h,_,ie),cf(h,_,ie)):(To&&L&&wu(_),_.flags|=1,qa(h,_,M,ie),_.child)}function S0(h,_,M,L,X){if(zc(_),_.stateNode===null){var ie=Dc,De=M.contextType;typeof De=="object"&&De!==null&&(ie=ts(De)),ie=new M(L,ie),_.memoizedState=ie.state!==null&&ie.state!==void 0?ie.state:null,ie.updater=yp,_.stateNode=ie,ie._reactInternals=_,ie=_.stateNode,ie.props=L,ie.state=_.memoizedState,ie.refs={},O(_),De=M.contextType,ie.context=typeof De=="object"&&De!==null?ts(De):Dc,ie.state=_.memoizedState,De=M.getDerivedStateFromProps,typeof De=="function"&&(Wf(_,M,De,L),ie.state=_.memoizedState),typeof M.getDerivedStateFromProps=="function"||typeof ie.getSnapshotBeforeUpdate=="function"||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(De=ie.state,typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount(),De!==ie.state&&yp.enqueueReplaceState(ie,ie.state,null),nt(_,L,ie,X),qe(),ie.state=_.memoizedState),typeof ie.componentDidMount=="function"&&(_.flags|=4194308),L=!0}else if(h===null){ie=_.stateNode;var Xe=_.memoizedProps,Tt=ea(M,Xe);ie.props=Tt;var dr=ie.context,zr=M.contextType;De=Dc,typeof zr=="object"&&zr!==null&&(De=ts(zr));var Zr=M.getDerivedStateFromProps;zr=typeof Zr=="function"||typeof ie.getSnapshotBeforeUpdate=="function",Xe=_.pendingProps!==Xe,zr||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(Xe||dr!==De)&&vA(_,ie,L,De),R=!1;var Ar=_.memoizedState;ie.state=Ar,nt(_,L,ie,X),qe(),dr=_.memoizedState,Xe||Ar!==dr||R?(typeof Zr=="function"&&(Wf(_,M,Zr,L),dr=_.memoizedState),(Tt=R||yA(_,M,Tt,L,Ar,dr,De))?(zr||typeof ie.UNSAFE_componentWillMount!="function"&&typeof ie.componentWillMount!="function"||(typeof ie.componentWillMount=="function"&&ie.componentWillMount(),typeof ie.UNSAFE_componentWillMount=="function"&&ie.UNSAFE_componentWillMount()),typeof ie.componentDidMount=="function"&&(_.flags|=4194308)):(typeof ie.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=L,_.memoizedState=dr),ie.props=L,ie.state=dr,ie.context=De,L=Tt):(typeof ie.componentDidMount=="function"&&(_.flags|=4194308),L=!1)}else{ie=_.stateNode,j(h,_),De=_.memoizedProps,zr=ea(M,De),ie.props=zr,Zr=_.pendingProps,Ar=ie.context,dr=M.contextType,Tt=Dc,typeof dr=="object"&&dr!==null&&(Tt=ts(dr)),Xe=M.getDerivedStateFromProps,(dr=typeof Xe=="function"||typeof ie.getSnapshotBeforeUpdate=="function")||typeof ie.UNSAFE_componentWillReceiveProps!="function"&&typeof ie.componentWillReceiveProps!="function"||(De!==Zr||Ar!==Tt)&&vA(_,ie,L,Tt),R=!1,Ar=_.memoizedState,ie.state=Ar,nt(_,L,ie,X),qe();var gr=_.memoizedState;De!==Zr||Ar!==gr||R||h!==null&&h.dependencies!==null&&Md(h.dependencies)?(typeof Xe=="function"&&(Wf(_,M,Xe,L),gr=_.memoizedState),(zr=R||yA(_,M,zr,L,Ar,gr,Tt)||h!==null&&h.dependencies!==null&&Md(h.dependencies))?(dr||typeof ie.UNSAFE_componentWillUpdate!="function"&&typeof ie.componentWillUpdate!="function"||(typeof ie.componentWillUpdate=="function"&&ie.componentWillUpdate(L,gr,Tt),typeof ie.UNSAFE_componentWillUpdate=="function"&&ie.UNSAFE_componentWillUpdate(L,gr,Tt)),typeof ie.componentDidUpdate=="function"&&(_.flags|=4),typeof ie.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof ie.componentDidUpdate!="function"||De===h.memoizedProps&&Ar===h.memoizedState||(_.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||De===h.memoizedProps&&Ar===h.memoizedState||(_.flags|=1024),_.memoizedProps=L,_.memoizedState=gr),ie.props=L,ie.state=gr,ie.context=Tt,L=zr):(typeof ie.componentDidUpdate!="function"||De===h.memoizedProps&&Ar===h.memoizedState||(_.flags|=4),typeof ie.getSnapshotBeforeUpdate!="function"||De===h.memoizedProps&&Ar===h.memoizedState||(_.flags|=1024),L=!1)}return ie=L,gm(h,_),L=(_.flags&128)!==0,ie||L?(ie=_.stateNode,M=L&&typeof M.getDerivedStateFromError!="function"?null:ie.render(),_.flags|=1,h!==null&&L?(_.child=lf(_,h.child,null,X),_.child=lf(_,null,M,X)):qa(h,_,M,X),_.memoizedState=ie.state,h=_.child):h=cf(h,_,X),h}function EA(h,_,M,L){return Eu(),_.flags|=256,qa(h,_,M,L),_.child}var CA={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function MA(h){return{baseLanes:h,cachePool:Id()}}function IA(h,_,M){return h=h!==null?h.childLanes&~M:0,_&&(h|=_n),h}function T0(h,_,M){var L=_.pendingProps,X=!1,ie=(_.flags&128)!==0,De;if((De=ie)||(De=h!==null&&h.memoizedState===null?!1:(Ra.current&2)!==0),De&&(X=!0,_.flags&=-129),De=(_.flags&32)!==0,_.flags&=-33,h===null){if(To){if(X?Ou(_):_h(),To){var Xe=Jo,Tt;if(Tt=Xe){e:{for(Tt=Xe,Xe=Xs;Tt.nodeType!==8;){if(!Xe){Xe=null;break e}if(Tt=dc(Tt.nextSibling),Tt===null){Xe=null;break e}}Xe=Tt}Xe!==null?(_.memoizedState={dehydrated:Xe,treeContext:hh!==null?{id:Ds,overflow:lc}:null,retryLane:536870912,hydrationErrors:null},Tt=Dn(18,null,null,0),Tt.stateNode=Xe,Tt.return=_,_.child=Tt,ka=_,Jo=null,Tt=!0):Tt=!1}Tt||Su(_)}if(Xe=_.memoizedState,Xe!==null&&(Xe=Xe.dehydrated,Xe!==null))return FA(Xe)?_.lanes=32:_.lanes=536870912,null;Ss(_)}return Xe=L.children,L=L.fallback,X?(_h(),X=_.mode,Xe=PA({mode:"hidden",children:Xe},X),L=Zh(L,X,M,null),Xe.return=_,L.return=_,Xe.sibling=L,_.child=Xe,X=_.child,X.memoizedState=MA(M),X.childLanes=IA(h,De,M),_.memoizedState=CA,L):(Ou(_),E0(_,Xe))}if(Tt=h.memoizedState,Tt!==null&&(Xe=Tt.dehydrated,Xe!==null)){if(ie)_.flags&256?(Ou(_),_.flags&=-257,_=C0(h,_,M)):_.memoizedState!==null?(_h(),_.child=h.child,_.flags|=128,_=null):(_h(),X=L.fallback,Xe=_.mode,L=PA({mode:"visible",children:L.children},Xe),X=Zh(X,Xe,M,null),X.flags|=2,L.return=_,X.return=_,L.sibling=X,_.child=L,lf(_,h.child,null,M),L=_.child,L.memoizedState=MA(M),L.childLanes=IA(h,De,M),_.memoizedState=CA,_=X);else if(Ou(_),FA(Xe)){if(De=Xe.nextSibling&&Xe.nextSibling.dataset,De)var dr=De.dgst;De=dr,L=Error(l(419)),L.stack="",L.digest=De,fh({value:L,source:null,stack:null}),_=C0(h,_,M)}else if(Ba||jf(h,_,M,!1),De=(M&h.childLanes)!==0,Ba||De){if(De=Bt,De!==null&&(L=M&-M,L=(L&42)!==0?1:rr(L),L=(L&(De.suspendedLanes|M))!==0?0:L,L!==0&&L!==Tt.retryLane))throw Tt.retryLane=L,Rc(h,L),xa(De,h,L),wA;Xe.data==="$?"||ra(),_=C0(h,_,M)}else Xe.data==="$?"?(_.flags|=192,_.child=h.child,_=null):(h=Tt.treeContext,Jo=dc(Xe.nextSibling),ka=_,To=!0,kc=null,Xs=!1,h!==null&&(Hl[bs++]=Ds,Hl[bs++]=lc,Hl[bs++]=hh,Ds=h.id,lc=h.overflow,hh=_),_=E0(_,L.children),_.flags|=4096);return _}return X?(_h(),X=L.fallback,Xe=_.mode,Tt=h.child,dr=Tt.sibling,L=xu(Tt,{mode:"hidden",children:L.children}),L.subtreeFlags=Tt.subtreeFlags&65011712,dr!==null?X=xu(dr,X):(X=Zh(X,Xe,M,null),X.flags|=2),X.return=_,L.return=_,L.sibling=X,_.child=L,L=X,X=_.child,Xe=h.child.memoizedState,Xe===null?Xe=MA(M):(Tt=Xe.cachePool,Tt!==null?(dr=xn._currentValue,Tt=Tt.parent!==dr?{parent:dr,pool:dr}:Tt):Tt=Id(),Xe={baseLanes:Xe.baseLanes|M,cachePool:Tt}),X.memoizedState=Xe,X.childLanes=IA(h,De,M),_.memoizedState=CA,L):(Ou(_),M=h.child,h=M.sibling,M=xu(M,{mode:"visible",children:L.children}),M.return=_,M.sibling=null,h!==null&&(De=_.deletions,De===null?(_.deletions=[h],_.flags|=16):De.push(h)),_.child=M,_.memoizedState=null,M)}function E0(h,_){return _=PA({mode:"visible",children:_},h.mode),_.return=h,h.child=_}function PA(h,_){return h=Dn(22,h,null,_),h.lanes=0,h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},h}function C0(h,_,M){return lf(_,h.child,null,M),h=E0(_,_.pendingProps.children),h.flags|=2,_.memoizedState=null,h}function No(h,_,M){h.lanes|=_;var L=h.alternate;L!==null&&(L.lanes|=_),fp(h.return,_,M)}function Ld(h,_,M,L,X){var ie=h.memoizedState;ie===null?h.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:L,tail:M,tailMode:X}:(ie.isBackwards=_,ie.rendering=null,ie.renderingStartTime=0,ie.last=L,ie.tail=M,ie.tailMode=X)}function zg(h,_,M){var L=_.pendingProps,X=L.revealOrder,ie=L.tail;if(qa(h,_,L.children,M),L=Ra.current,(L&2)!==0)L=L&1|2,_.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=_.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&No(h,M,_);else if(h.tag===19)No(h,M,_);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===_)break e;for(;h.sibling===null;){if(h.return===null||h.return===_)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}L&=1}switch(Cr(Ra,L),X){case"forwards":for(M=_.child,X=null;M!==null;)h=M.alternate,h!==null&&ha(h)===null&&(X=M),M=M.sibling;M=X,M===null?(X=_.child,_.child=null):(X=M.sibling,M.sibling=null),Ld(_,!1,X,M,ie);break;case"backwards":for(M=null,X=_.child,_.child=null;X!==null;){if(h=X.alternate,h!==null&&ha(h)===null){_.child=X;break}h=X.sibling,X.sibling=M,M=X,X=h}Ld(_,!0,M,null,ie);break;case"together":Ld(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function cf(h,_,M){if(h!==null&&(_.dependencies=h.dependencies),En|=_.lanes,(M&_.childLanes)===0)if(h!==null){if(jf(h,_,M,!1),(M&_.childLanes)===0)return null}else return null;if(h!==null&&_.child!==h.child)throw Error(l(153));if(_.child!==null){for(h=_.child,M=xu(h,h.pendingProps),_.child=M,M.return=_;h.sibling!==null;)h=h.sibling,M=M.sibling=xu(h,h.pendingProps),M.return=_;M.sibling=null}return _.child}function bp(h,_){return(h.lanes&_)!==0?!0:(h=h.dependencies,!!(h!==null&&Md(h)))}function _m(h,_,M){switch(_.tag){case 3:jn(_,_.stateNode.containerInfo),Cu(_,xn,h.memoizedState.cache),Eu();break;case 27:case 5:Gr(_);break;case 4:jn(_,_.stateNode.containerInfo);break;case 10:Cu(_,_.type,_.memoizedProps.value);break;case 13:var L=_.memoizedState;if(L!==null)return L.dehydrated!==null?(Ou(_),_.flags|=128,null):(M&_.child.childLanes)!==0?T0(h,_,M):(Ou(_),h=cf(h,_,M),h!==null?h.sibling:null);Ou(_);break;case 19:var X=(h.flags&128)!==0;if(L=(M&_.childLanes)!==0,L||(jf(h,_,M,!1),L=(M&_.childLanes)!==0),X){if(L)return zg(h,_,M);_.flags|=128}if(X=_.memoizedState,X!==null&&(X.rendering=null,X.tail=null,X.lastEffect=null),Cr(Ra,Ra.current),L)break;return null;case 22:case 23:return _.lanes=0,b0(h,_,M);case 24:Cu(_,xn,h.memoizedState.cache)}return cf(h,_,M)}function RA(h,_,M){if(h!==null)if(h.memoizedProps!==_.pendingProps)Ba=!0;else{if(!bp(h,M)&&(_.flags&128)===0)return Ba=!1,_m(h,_,M);Ba=(h.flags&131072)!==0}else Ba=!1,To&&(_.flags&1048576)!==0&&Ed(_,up,_.index);switch(_.lanes=0,_.tag){case 16:e:{h=_.pendingProps;var L=_.elementType,X=L._init;if(L=X(L._payload),_.type=L,typeof L=="function")ch(L)?(h=ea(L,h),_.tag=1,_=S0(null,_,L,h,M)):(_.tag=0,_=TA(null,_,L,h,M));else{if(L!=null){if(X=L.$$typeof,X===Ce){_.tag=11,_=mm(null,_,L,h,M);break e}else if(X===Ke){_.tag=14,_=x0(null,_,L,h,M);break e}}throw _=wt(L)||L,Error(l(306,_,""))}}return _;case 0:return TA(h,_,_.type,_.pendingProps,M);case 1:return L=_.type,X=ea(L,_.pendingProps),S0(h,_,L,X,M);case 3:e:{if(jn(_,_.stateNode.containerInfo),h===null)throw Error(l(387));L=_.pendingProps;var ie=_.memoizedState;X=ie.element,j(h,_),nt(_,L,null,M);var De=_.memoizedState;if(L=De.cache,Cu(_,xn,L),L!==ie.cache&&Cd(_,[xn],M,!0),qe(),L=De.element,ie.isDehydrated)if(ie={element:L,isDehydrated:!1,cache:De.cache},_.updateQueue.baseState=ie,_.memoizedState=ie,_.flags&256){_=EA(h,_,L,M);break e}else if(L!==X){X=xs(Error(l(424)),_),fh(X),_=EA(h,_,L,M);break e}else{switch(h=_.stateNode.containerInfo,h.nodeType){case 9:h=h.body;break;default:h=h.nodeName==="HTML"?h.ownerDocument.body:h}for(Jo=dc(h.firstChild),ka=_,To=!0,kc=null,Xs=!0,M=fl(_,null,L,M),_.child=M;M;)M.flags=M.flags&-3|4096,M=M.sibling}else{if(Eu(),L===X){_=cf(h,_,M);break e}qa(h,_,L,M)}_=_.child}return _;case 26:return gm(h,_),h===null?(M=e_(_.type,null,_.pendingProps,null))?_.memoizedState=M:To||(M=_.type,h=_.pendingProps,L=Pp(Hr.current).createElement(M),L[le]=_,L[ge]=h,zl(L,M,h),wr(L),_.stateNode=L):_.memoizedState=e_(_.type,h.memoizedProps,_.pendingProps,h.memoizedState),null;case 27:return Gr(_),h===null&&To&&(L=_.stateNode=NA(_.type,_.pendingProps,Hr.current),ka=_,Xs=!0,X=Jo,Sh(_.type)?(Kg=X,Jo=dc(L.firstChild)):Jo=X),qa(h,_,_.pendingProps.children,M),gm(h,_),h===null&&(_.flags|=4194304),_.child;case 5:return h===null&&To&&((X=L=Jo)&&(L=BA(L,_.type,_.pendingProps,Xs),L!==null?(_.stateNode=L,ka=_,Jo=dc(L.firstChild),Xs=!1,X=!0):X=!1),X||Su(_)),Gr(_),X=_.type,ie=_.pendingProps,De=h!==null?h.memoizedProps:null,L=ie.children,Cy(X,ie)?L=null:De!==null&&Cy(X,De)&&(_.flags|=32),_.memoizedState!==null&&(X=Eo(h,_,Cg,null,null,M),Rp._currentValue=X),gm(h,_),qa(h,_,L,M),_.child;case 6:return h===null&&To&&((h=M=Jo)&&(M=Yx(M,_.pendingProps,Xs),M!==null?(_.stateNode=M,ka=_,Jo=null,h=!0):h=!1),h||Su(_)),null;case 13:return T0(h,_,M);case 4:return jn(_,_.stateNode.containerInfo),L=_.pendingProps,h===null?_.child=lf(_,null,L,M):qa(h,_,L,M),_.child;case 11:return mm(h,_,_.type,_.pendingProps,M);case 7:return qa(h,_,_.pendingProps,M),_.child;case 8:return qa(h,_,_.pendingProps.children,M),_.child;case 12:return qa(h,_,_.pendingProps.children,M),_.child;case 10:return L=_.pendingProps,Cu(_,_.type,L.value),qa(h,_,L.children,M),_.child;case 9:return X=_.type._context,L=_.pendingProps.children,zc(_),X=ts(X),L=L(X),_.flags|=1,qa(h,_,L,M),_.child;case 14:return x0(h,_,_.type,_.pendingProps,M);case 15:return SA(h,_,_.type,_.pendingProps,M);case 19:return zg(h,_,M);case 31:return L=_.pendingProps,M=_.mode,L={mode:L.mode,children:L.children},h===null?(M=PA(L,M),M.ref=_.ref,_.child=M,M.return=_,_=M):(M=xu(h.child,L),M.ref=_.ref,_.child=M,M.return=_,_=M),_;case 22:return b0(h,_,M);case 24:return zc(_),L=ts(xn),h===null?(X=Vr(),X===null&&(X=Bt,ie=Pa(),X.pooledCache=ie,ie.refCount++,ie!==null&&(X.pooledCacheLanes|=M),X=ie),_.memoizedState={parent:L,cache:X},O(_),Cu(_,xn,X)):((h.lanes&M)!==0&&(j(h,_),nt(_,null,null,M),qe()),X=h.memoizedState,ie=_.memoizedState,X.parent!==L?(X={parent:L,cache:L},_.memoizedState=X,_.lanes===0&&(_.memoizedState=_.updateQueue.baseState=X),Cu(_,xn,L)):(L=ie.cache,Cu(_,xn,L),L!==X.cache&&Cd(_,[xn],M,!0))),qa(h,_,_.pendingProps.children,M),_.child;case 29:throw _.pendingProps}throw Error(l(156,_.tag))}function ku(h){h.flags|=4}function wp(h,_){if(_.type!=="stylesheet"||(_.state.loading&4)!==0)h.flags&=-16777217;else if(h.flags|=16777216,!a1(_)){if(_=ws.current,_!==null&&((ar&4194048)===ar?Pl!==null:(ar&62914560)!==ar&&(ar&536870912)===0||_!==Pl))throw b=dh,ef;h.flags|=8192}}function hc(h,_){_!==null&&(h.flags|=4),h.flags&16384&&(_=h.tag!==22?If():536870912,h.lanes|=_,si|=_)}function uf(h,_){if(!To)switch(h.tailMode){case"hidden":_=h.tail;for(var M=null;_!==null;)_.alternate!==null&&(M=_),_=_.sibling;M===null?h.tail=null:M.sibling=null;break;case"collapsed":M=h.tail;for(var L=null;M!==null;)M.alternate!==null&&(L=M),M=M.sibling;L===null?_||h.tail===null?h.tail=null:h.tail.sibling=null:L.sibling=null}}function Ei(h){var _=h.alternate!==null&&h.alternate.child===h.child,M=0,L=0;if(_)for(var X=h.child;X!==null;)M|=X.lanes|X.childLanes,L|=X.subtreeFlags&65011712,L|=X.flags&65011712,X.return=h,X=X.sibling;else for(X=h.child;X!==null;)M|=X.lanes|X.childLanes,L|=X.subtreeFlags,L|=X.flags,X.return=h,X=X.sibling;return h.subtreeFlags|=L,h.childLanes=M,_}function yh(h,_,M){var L=_.pendingProps;switch(Nf(_),_.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(_),null;case 1:return Ei(_),null;case 3:return M=_.stateNode,L=null,h!==null&&(L=h.memoizedState.cache),_.memoizedState.cache!==L&&(_.flags|=2048),Os(xn),Ur(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(h===null||h.child===null)&&(Tu(_)?ku(_):h===null||h.memoizedState.isDehydrated&&(_.flags&256)===0||(_.flags|=1024,va())),Ei(_),null;case 26:return M=_.memoizedState,h===null?(ku(_),M!==null?(Ei(_),wp(_,M)):(Ei(_),_.flags&=-16777217)):M?M!==h.memoizedState?(ku(_),Ei(_),wp(_,M)):(Ei(_),_.flags&=-16777217):(h.memoizedProps!==L&&ku(_),Ei(_),_.flags&=-16777217),null;case 27:Sn(_),M=Hr.current;var X=_.type;if(h!==null&&_.stateNode!=null)h.memoizedProps!==L&&ku(_);else{if(!L){if(_.stateNode===null)throw Error(l(166));return Ei(_),null}h=ln.current,Tu(_)?rm(_):(h=NA(X,L,M),_.stateNode=h,ku(_))}return Ei(_),null;case 5:if(Sn(_),M=_.type,h!==null&&_.stateNode!=null)h.memoizedProps!==L&&ku(_);else{if(!L){if(_.stateNode===null)throw Error(l(166));return Ei(_),null}if(h=ln.current,Tu(_))rm(_);else{switch(X=Pp(Hr.current),h){case 1:h=X.createElementNS("http://www.w3.org/2000/svg",M);break;case 2:h=X.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;default:switch(M){case"svg":h=X.createElementNS("http://www.w3.org/2000/svg",M);break;case"math":h=X.createElementNS("http://www.w3.org/1998/Math/MathML",M);break;case"script":h=X.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild);break;case"select":h=typeof L.is=="string"?X.createElement("select",{is:L.is}):X.createElement("select"),L.multiple?h.multiple=!0:L.size&&(h.size=L.size);break;default:h=typeof L.is=="string"?X.createElement(M,{is:L.is}):X.createElement(M)}}h[le]=_,h[ge]=L;e:for(X=_.child;X!==null;){if(X.tag===5||X.tag===6)h.appendChild(X.stateNode);else if(X.tag!==4&&X.tag!==27&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===_)break e;for(;X.sibling===null;){if(X.return===null||X.return===_)break e;X=X.return}X.sibling.return=X.return,X=X.sibling}_.stateNode=h;e:switch(zl(h,M,L),M){case"button":case"input":case"select":case"textarea":h=!!L.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&ku(_)}}return Ei(_),_.flags&=-16777217,null;case 6:if(h&&_.stateNode!=null)h.memoizedProps!==L&&ku(_);else{if(typeof L!="string"&&_.stateNode===null)throw Error(l(166));if(h=Hr.current,Tu(_)){if(h=_.stateNode,M=_.memoizedProps,L=null,X=ka,X!==null)switch(X.tag){case 27:case 5:L=X.memoizedProps}h[le]=_,h=!!(h.nodeValue===M||L!==null&&L.suppressHydrationWarning===!0||zA(h.nodeValue,M)),h||Su(_)}else h=Pp(h).createTextNode(L),h[le]=_,_.stateNode=h}return Ei(_),null;case 13:if(L=_.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(X=Tu(_),L!==null&&L.dehydrated!==null){if(h===null){if(!X)throw Error(l(318));if(X=_.memoizedState,X=X!==null?X.dehydrated:null,!X)throw Error(l(317));X[le]=_}else Eu(),(_.flags&128)===0&&(_.memoizedState=null),_.flags|=4;Ei(_),X=!1}else X=va(),h!==null&&h.memoizedState!==null&&(h.memoizedState.hydrationErrors=X),X=!0;if(!X)return _.flags&256?(Ss(_),_):(Ss(_),null)}if(Ss(_),(_.flags&128)!==0)return _.lanes=M,_;if(M=L!==null,h=h!==null&&h.memoizedState!==null,M){L=_.child,X=null,L.alternate!==null&&L.alternate.memoizedState!==null&&L.alternate.memoizedState.cachePool!==null&&(X=L.alternate.memoizedState.cachePool.pool);var ie=null;L.memoizedState!==null&&L.memoizedState.cachePool!==null&&(ie=L.memoizedState.cachePool.pool),ie!==X&&(L.flags|=2048)}return M!==h&&M&&(_.child.flags|=8192),hc(_,_.updateQueue),Ei(_),null;case 4:return Ur(),h===null&&Hg(_.stateNode.containerInfo),Ei(_),null;case 10:return Os(_.type),Ei(_),null;case 19:if(Jt(Ra),X=_.memoizedState,X===null)return Ei(_),null;if(L=(_.flags&128)!==0,ie=X.rendering,ie===null)if(L)uf(X,!1);else{if(rn!==0||h!==null&&(h.flags&128)!==0)for(h=_.child;h!==null;){if(ie=ha(h),ie!==null){for(_.flags|=128,uf(X,!1),h=ie.updateQueue,_.updateQueue=h,hc(_,h),_.subtreeFlags=0,h=M,M=_.child;M!==null;)lA(M,h),M=M.sibling;return Cr(Ra,Ra.current&1|2),_.child}h=h.sibling}X.tail!==null&&di()>Ai&&(_.flags|=128,L=!0,uf(X,!1),_.lanes=4194304)}else{if(!L)if(h=ha(ie),h!==null){if(_.flags|=128,L=!0,h=h.updateQueue,_.updateQueue=h,hc(_,h),uf(X,!0),X.tail===null&&X.tailMode==="hidden"&&!ie.alternate&&!To)return Ei(_),null}else 2*di()-X.renderingStartTime>Ai&&M!==536870912&&(_.flags|=128,L=!0,uf(X,!1),_.lanes=4194304);X.isBackwards?(ie.sibling=_.child,_.child=ie):(h=X.last,h!==null?h.sibling=ie:_.child=ie,X.last=ie)}return X.tail!==null?(_=X.tail,X.rendering=_,X.tail=_.sibling,X.renderingStartTime=di(),_.sibling=null,h=Ra.current,Cr(Ra,L?h&1|2:h&1),_):(Ei(_),null);case 22:case 23:return Ss(_),qt(),L=_.memoizedState!==null,h!==null?h.memoizedState!==null!==L&&(_.flags|=8192):L&&(_.flags|=8192),L?(M&536870912)!==0&&(_.flags&128)===0&&(Ei(_),_.subtreeFlags&6&&(_.flags|=8192)):Ei(_),M=_.updateQueue,M!==null&&hc(_,M.retryQueue),M=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(M=h.memoizedState.cachePool.pool),L=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(L=_.memoizedState.cachePool.pool),L!==M&&(_.flags|=2048),h!==null&&Jt(Cl),null;case 24:return M=null,h!==null&&(M=h.memoizedState.cache),_.memoizedState.cache!==M&&(_.flags|=2048),Os(xn),Ei(_),null;case 25:return null;case 30:return null}throw Error(l(156,_.tag))}function ym(h,_){switch(Nf(_),_.tag){case 1:return h=_.flags,h&65536?(_.flags=h&-65537|128,_):null;case 3:return Os(xn),Ur(),h=_.flags,(h&65536)!==0&&(h&128)===0?(_.flags=h&-65537|128,_):null;case 26:case 27:case 5:return Sn(_),null;case 13:if(Ss(_),h=_.memoizedState,h!==null&&h.dehydrated!==null){if(_.alternate===null)throw Error(l(340));Eu()}return h=_.flags,h&65536?(_.flags=h&-65537|128,_):null;case 19:return Jt(Ra),null;case 4:return Ur(),null;case 10:return Os(_.type),null;case 22:case 23:return Ss(_),qt(),h!==null&&Jt(Cl),h=_.flags,h&65536?(_.flags=h&-65537|128,_):null;case 24:return Os(xn),null;case 25:return null;default:return null}}function Sp(h,_){switch(Nf(_),_.tag){case 3:Os(xn),Ur();break;case 26:case 27:case 5:Sn(_);break;case 4:Ur();break;case 13:Ss(_);break;case 19:Jt(Ra);break;case 10:Os(_.type);break;case 22:case 23:Ss(_),qt(),h!==null&&Jt(Cl);break;case 24:Os(xn)}}function Tp(h,_){try{var M=_.updateQueue,L=M!==null?M.lastEffect:null;if(L!==null){var X=L.next;M=X;do{if((M.tag&h)===h){L=void 0;var ie=M.create,De=M.inst;L=ie(),De.destroy=L}M=M.next}while(M!==X)}}catch(Xe){wa(_,_.return,Xe)}}function Yf(h,_,M){try{var L=_.updateQueue,X=L!==null?L.lastEffect:null;if(X!==null){var ie=X.next;L=ie;do{if((L.tag&h)===h){var De=L.inst,Xe=De.destroy;if(Xe!==void 0){De.destroy=void 0,X=_;var Tt=M,dr=Xe;try{dr()}catch(zr){wa(X,Tt,zr)}}}L=L.next}while(L!==ie)}}catch(zr){wa(_,_.return,zr)}}function Ep(h){var _=h.updateQueue;if(_!==null){var M=h.stateNode;try{at(_,M)}catch(L){wa(h,h.return,L)}}}function Lg(h,_,M){M.props=ea(h.type,h.memoizedProps),M.state=h.memoizedState;try{M.componentWillUnmount()}catch(L){wa(h,_,L)}}function vm(h,_){try{var M=h.ref;if(M!==null){switch(h.tag){case 26:case 27:case 5:var L=h.stateNode;break;case 30:L=h.stateNode;break;default:L=h.stateNode}typeof M=="function"?h.refCleanup=M(L):M.current=L}}catch(X){wa(h,_,X)}}function fc(h,_){var M=h.ref,L=h.refCleanup;if(M!==null)if(typeof L=="function")try{L()}catch(X){wa(h,_,X)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof M=="function")try{M(null)}catch(X){wa(h,_,X)}else M.current=null}function Cp(h){var _=h.type,M=h.memoizedProps,L=h.stateNode;try{e:switch(_){case"button":case"input":case"select":case"textarea":M.autoFocus&&L.focus();break e;case"img":M.src?L.src=M.src:M.srcSet&&(L.srcset=M.srcSet)}}catch(X){wa(h,h.return,X)}}function Rl(h,_,M){try{var L=h.stateNode;LA(L,h.type,M,_),L[ge]=_}catch(X){wa(h,h.return,X)}}function Qf(h){return h.tag===5||h.tag===3||h.tag===26||h.tag===27&&Sh(h.type)||h.tag===4}function vh(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||Qf(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.tag===27&&Sh(h.type)||h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function zu(h,_,M){var L=h.tag;if(L===5||L===6)h=h.stateNode,_?(M.nodeType===9?M.body:M.nodeName==="HTML"?M.ownerDocument.body:M).insertBefore(h,_):(_=M.nodeType===9?M.body:M.nodeName==="HTML"?M.ownerDocument.body:M,_.appendChild(h),M=M._reactRootContainer,M!=null||_.onclick!==null||(_.onclick=Zg));else if(L!==4&&(L===27&&Sh(h.type)&&(M=h.stateNode,_=null),h=h.child,h!==null))for(zu(h,_,M),h=h.sibling;h!==null;)zu(h,_,M),h=h.sibling}function Vc(h,_,M){var L=h.tag;if(L===5||L===6)h=h.stateNode,_?M.insertBefore(h,_):M.appendChild(h);else if(L!==4&&(L===27&&Sh(h.type)&&(M=h.stateNode),h=h.child,h!==null))for(Vc(h,_,M),h=h.sibling;h!==null;)Vc(h,_,M),h=h.sibling}function Kf(h){var _=h.stateNode,M=h.memoizedProps;try{for(var L=h.type,X=_.attributes;X.length;)_.removeAttributeNode(X[0]);zl(_,L,M),_[le]=h,_[ge]=M}catch(ie){wa(h,h.return,ie)}}var Ts=!1,Wa=!1,Bg=!1,p=typeof WeakSet=="function"?WeakSet:Set,n=null;function c(h,_){if(h=h.containerInfo,Xg=F0,h=vs(h),em(h)){if("selectionStart"in h)var M={start:h.selectionStart,end:h.selectionEnd};else e:{M=(M=h.ownerDocument)&&M.defaultView||window;var L=M.getSelection&&M.getSelection();if(L&&L.rangeCount!==0){M=L.anchorNode;var X=L.anchorOffset,ie=L.focusNode;L=L.focusOffset;try{M.nodeType,ie.nodeType}catch{M=null;break e}var De=0,Xe=-1,Tt=-1,dr=0,zr=0,Zr=h,Ar=null;t:for(;;){for(var gr;Zr!==M||X!==0&&Zr.nodeType!==3||(Xe=De+X),Zr!==ie||L!==0&&Zr.nodeType!==3||(Tt=De+L),Zr.nodeType===3&&(De+=Zr.nodeValue.length),(gr=Zr.firstChild)!==null;)Ar=Zr,Zr=gr;for(;;){if(Zr===h)break t;if(Ar===M&&++dr===X&&(Xe=De),Ar===ie&&++zr===L&&(Tt=De),(gr=Zr.nextSibling)!==null)break;Zr=Ar,Ar=Zr.parentNode}Zr=gr}M=Xe===-1||Tt===-1?null:{start:Xe,end:Tt}}else M=null}M=M||{start:0,end:0}}else M=null;for(Fd={focusedElem:h,selectionRange:M},F0=!1,n=_;n!==null;)if(_=n,h=_.child,(_.subtreeFlags&1024)!==0&&h!==null)h.return=_,n=h;else for(;n!==null;){switch(_=n,ie=_.alternate,h=_.flags,_.tag){case 0:break;case 11:case 15:break;case 1:if((h&1024)!==0&&ie!==null){h=void 0,M=_,X=ie.memoizedProps,ie=ie.memoizedState,L=M.stateNode;try{var Pi=ea(M.type,X,M.elementType===M.type);h=L.getSnapshotBeforeUpdate(Pi,ie),L.__reactInternalSnapshotBeforeUpdate=h}catch(li){wa(M,M.return,li)}}break;case 3:if((h&1024)!==0){if(h=_.stateNode.containerInfo,M=h.nodeType,M===9)Na(h);else if(M===1)switch(h.nodeName){case"HEAD":case"HTML":case"BODY":Na(h);break;default:h.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((h&1024)!==0)throw Error(l(163))}if(h=_.sibling,h!==null){h.return=_.return,n=h;break}n=_.return}}function d(h,_,M){var L=M.flags;switch(M.tag){case 0:case 11:case 15:me(h,M),L&4&&Tp(5,M);break;case 1:if(me(h,M),L&4)if(h=M.stateNode,_===null)try{h.componentDidMount()}catch(De){wa(M,M.return,De)}else{var X=ea(M.type,_.memoizedProps);_=_.memoizedState;try{h.componentDidUpdate(X,_,h.__reactInternalSnapshotBeforeUpdate)}catch(De){wa(M,M.return,De)}}L&64&&Ep(M),L&512&&vm(M,M.return);break;case 3:if(me(h,M),L&64&&(h=M.updateQueue,h!==null)){if(_=null,M.child!==null)switch(M.child.tag){case 27:case 5:_=M.child.stateNode;break;case 1:_=M.child.stateNode}try{at(h,_)}catch(De){wa(M,M.return,De)}}break;case 27:_===null&&L&4&&Kf(M);case 26:case 5:me(h,M),_===null&&L&4&&Cp(M),L&512&&vm(M,M.return);break;case 12:me(h,M);break;case 13:me(h,M),L&4&&H(h,M),L&64&&(h=M.memoizedState,h!==null&&(h=h.dehydrated,h!==null&&(M=jx.bind(null,M),Qg(h,M))));break;case 22:if(L=M.memoizedState!==null||Ts,!L){_=_!==null&&_.memoizedState!==null||Wa,X=Ts;var ie=Wa;Ts=L,(Wa=_)&&!ie?Oe(h,M,(M.subtreeFlags&8772)!==0):me(h,M),Ts=X,Wa=ie}break;case 30:break;default:me(h,M)}}function x(h){var _=h.alternate;_!==null&&(h.alternate=null,x(_)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(_=h.stateNode,_!==null&&vt(_)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}var E=null,I=!1;function D(h,_,M){for(M=M.child;M!==null;)N(h,_,M),M=M.sibling}function N(h,_,M){if(ai&&typeof ai.onCommitFiberUnmount=="function")try{ai.onCommitFiberUnmount(ao,M)}catch{}switch(M.tag){case 26:Wa||fc(M,_),D(h,_,M),M.memoizedState?M.memoizedState.count--:M.stateNode&&(M=M.stateNode,M.parentNode.removeChild(M));break;case 27:Wa||fc(M,_);var L=E,X=I;Sh(M.type)&&(E=M.stateNode,I=!1),D(h,_,M),Sm(M.stateNode),E=L,I=X;break;case 5:Wa||fc(M,_);case 6:if(L=E,X=I,E=null,D(h,_,M),E=L,I=X,E!==null)if(I)try{(E.nodeType===9?E.body:E.nodeName==="HTML"?E.ownerDocument.body:E).removeChild(M.stateNode)}catch(ie){wa(M,_,ie)}else try{E.removeChild(M.stateNode)}catch(ie){wa(M,_,ie)}break;case 18:E!==null&&(I?(h=E,Xx(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,M.stateNode),GA(h)):Xx(E,M.stateNode));break;case 4:L=E,X=I,E=M.stateNode.containerInfo,I=!0,D(h,_,M),E=L,I=X;break;case 0:case 11:case 14:case 15:Wa||Yf(2,M,_),Wa||Yf(4,M,_),D(h,_,M);break;case 1:Wa||(fc(M,_),L=M.stateNode,typeof L.componentWillUnmount=="function"&&Lg(M,_,L)),D(h,_,M);break;case 21:D(h,_,M);break;case 22:Wa=(L=Wa)||M.memoizedState!==null,D(h,_,M),Wa=L;break;default:D(h,_,M)}}function H(h,_){if(_.memoizedState===null&&(h=_.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{GA(h)}catch(M){wa(_,_.return,M)}}function W(h){switch(h.tag){case 13:case 19:var _=h.stateNode;return _===null&&(_=h.stateNode=new p),_;case 22:return h=h.stateNode,_=h._retryCache,_===null&&(_=h._retryCache=new p),_;default:throw Error(l(435,h.tag))}}function ee(h,_){var M=W(h);_.forEach(function(L){var X=B2.bind(null,h,L);M.has(L)||(M.add(L),L.then(X,X))})}function Y(h,_){var M=_.deletions;if(M!==null)for(var L=0;L<M.length;L++){var X=M[L],ie=h,De=_,Xe=De;e:for(;Xe!==null;){switch(Xe.tag){case 27:if(Sh(Xe.type)){E=Xe.stateNode,I=!1;break e}break;case 5:E=Xe.stateNode,I=!1;break e;case 3:case 4:E=Xe.stateNode.containerInfo,I=!0;break e}Xe=Xe.return}if(E===null)throw Error(l(160));N(ie,De,X),E=null,I=!1,ie=X.alternate,ie!==null&&(ie.return=null),X.return=null}if(_.subtreeFlags&13878)for(_=_.child;_!==null;)fe(_,h),_=_.sibling}var se=null;function fe(h,_){var M=h.alternate,L=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Y(_,h),he(h),L&4&&(Yf(3,h,h.return),Tp(3,h),Yf(5,h,h.return));break;case 1:Y(_,h),he(h),L&512&&(Wa||M===null||fc(M,M.return)),L&64&&Ts&&(h=h.updateQueue,h!==null&&(L=h.callbacks,L!==null&&(M=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=M===null?L:M.concat(L))));break;case 26:var X=se;if(Y(_,h),he(h),L&512&&(Wa||M===null||fc(M,M.return)),L&4){var ie=M!==null?M.memoizedState:null;if(L=h.memoizedState,M===null)if(L===null)if(h.stateNode===null){e:{L=h.type,M=h.memoizedProps,X=X.ownerDocument||X;t:switch(L){case"title":ie=X.getElementsByTagName("title")[0],(!ie||ie[Je]||ie[le]||ie.namespaceURI==="http://www.w3.org/2000/svg"||ie.hasAttribute("itemprop"))&&(ie=X.createElement(L),X.head.insertBefore(ie,X.querySelector("head > title"))),zl(ie,L,M),ie[le]=h,wr(ie),L=ie;break e;case"link":var De=i1("link","href",X).get(L+(M.href||""));if(De){for(var Xe=0;Xe<De.length;Xe++)if(ie=De[Xe],ie.getAttribute("href")===(M.href==null||M.href===""?null:M.href)&&ie.getAttribute("rel")===(M.rel==null?null:M.rel)&&ie.getAttribute("title")===(M.title==null?null:M.title)&&ie.getAttribute("crossorigin")===(M.crossOrigin==null?null:M.crossOrigin)){De.splice(Xe,1);break t}}ie=X.createElement(L),zl(ie,L,M),X.head.appendChild(ie);break;case"meta":if(De=i1("meta","content",X).get(L+(M.content||""))){for(Xe=0;Xe<De.length;Xe++)if(ie=De[Xe],ie.getAttribute("content")===(M.content==null?null:""+M.content)&&ie.getAttribute("name")===(M.name==null?null:M.name)&&ie.getAttribute("property")===(M.property==null?null:M.property)&&ie.getAttribute("http-equiv")===(M.httpEquiv==null?null:M.httpEquiv)&&ie.getAttribute("charset")===(M.charSet==null?null:M.charSet)){De.splice(Xe,1);break t}}ie=X.createElement(L),zl(ie,L,M),X.head.appendChild(ie);break;default:throw Error(l(468,L))}ie[le]=h,wr(ie),L=ie}h.stateNode=L}else o1(X,h.type,h.stateNode);else h.stateNode=Ry(X,L,h.memoizedProps);else ie!==L?(ie===null?M.stateNode!==null&&(M=M.stateNode,M.parentNode.removeChild(M)):ie.count--,L===null?o1(X,h.type,h.stateNode):Ry(X,L,h.memoizedProps)):L===null&&h.stateNode!==null&&Rl(h,h.memoizedProps,M.memoizedProps)}break;case 27:Y(_,h),he(h),L&512&&(Wa||M===null||fc(M,M.return)),M!==null&&L&4&&Rl(h,h.memoizedProps,M.memoizedProps);break;case 5:if(Y(_,h),he(h),L&512&&(Wa||M===null||fc(M,M.return)),h.flags&32){X=h.stateNode;try{cl(X,"")}catch(gr){wa(h,h.return,gr)}}L&4&&h.stateNode!=null&&(X=h.memoizedProps,Rl(h,X,M!==null?M.memoizedProps:X)),L&1024&&(Bg=!0);break;case 6:if(Y(_,h),he(h),L&4){if(h.stateNode===null)throw Error(l(162));L=h.memoizedProps,M=h.stateNode;try{M.nodeValue=L}catch(gr){wa(h,h.return,gr)}}break;case 3:if(n_=null,X=se,se=O0(_.containerInfo),Y(_,h),se=X,he(h),L&4&&M!==null&&M.memoizedState.isDehydrated)try{GA(_.containerInfo)}catch(gr){wa(h,h.return,gr)}Bg&&(Bg=!1,Se(h));break;case 4:L=se,se=O0(h.stateNode.containerInfo),Y(_,h),he(h),se=L;break;case 12:Y(_,h),he(h);break;case 13:Y(_,h),he(h),h.child.flags&8192&&h.memoizedState!==null!=(M!==null&&M.memoizedState!==null)&&(bi=di()),L&4&&(L=h.updateQueue,L!==null&&(h.updateQueue=null,ee(h,L)));break;case 22:X=h.memoizedState!==null;var Tt=M!==null&&M.memoizedState!==null,dr=Ts,zr=Wa;if(Ts=dr||X,Wa=zr||Tt,Y(_,h),Wa=zr,Ts=dr,he(h),L&8192)e:for(_=h.stateNode,_._visibility=X?_._visibility&-2:_._visibility|1,X&&(M===null||Tt||Ts||Wa||Te(h)),M=null,_=h;;){if(_.tag===5||_.tag===26){if(M===null){Tt=M=_;try{if(ie=Tt.stateNode,X)De=ie.style,typeof De.setProperty=="function"?De.setProperty("display","none","important"):De.display="none";else{Xe=Tt.stateNode;var Zr=Tt.memoizedProps.style,Ar=Zr!=null&&Zr.hasOwnProperty("display")?Zr.display:null;Xe.style.display=Ar==null||typeof Ar=="boolean"?"":(""+Ar).trim()}}catch(gr){wa(Tt,Tt.return,gr)}}}else if(_.tag===6){if(M===null){Tt=_;try{Tt.stateNode.nodeValue=X?"":Tt.memoizedProps}catch(gr){wa(Tt,Tt.return,gr)}}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===h)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===h)break e;for(;_.sibling===null;){if(_.return===null||_.return===h)break e;M===_&&(M=null),_=_.return}M===_&&(M=null),_.sibling.return=_.return,_=_.sibling}L&4&&(L=h.updateQueue,L!==null&&(M=L.retryQueue,M!==null&&(L.retryQueue=null,ee(h,M))));break;case 19:Y(_,h),he(h),L&4&&(L=h.updateQueue,L!==null&&(h.updateQueue=null,ee(h,L)));break;case 30:break;case 21:break;default:Y(_,h),he(h)}}function he(h){var _=h.flags;if(_&2){try{for(var M,L=h.return;L!==null;){if(Qf(L)){M=L;break}L=L.return}if(M==null)throw Error(l(160));switch(M.tag){case 27:var X=M.stateNode,ie=vh(h);Vc(h,ie,X);break;case 5:var De=M.stateNode;M.flags&32&&(cl(De,""),M.flags&=-33);var Xe=vh(h);Vc(h,Xe,De);break;case 3:case 4:var Tt=M.stateNode.containerInfo,dr=vh(h);zu(h,dr,Tt);break;default:throw Error(l(161))}}catch(zr){wa(h,h.return,zr)}h.flags&=-3}_&4096&&(h.flags&=-4097)}function Se(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var _=h;Se(_),_.tag===5&&_.flags&1024&&_.stateNode.reset(),h=h.sibling}}function me(h,_){if(_.subtreeFlags&8772)for(_=_.child;_!==null;)d(h,_.alternate,_),_=_.sibling}function Te(h){for(h=h.child;h!==null;){var _=h;switch(_.tag){case 0:case 11:case 14:case 15:Yf(4,_,_.return),Te(_);break;case 1:fc(_,_.return);var M=_.stateNode;typeof M.componentWillUnmount=="function"&&Lg(_,_.return,M),Te(_);break;case 27:Sm(_.stateNode);case 26:case 5:fc(_,_.return),Te(_);break;case 22:_.memoizedState===null&&Te(_);break;case 30:Te(_);break;default:Te(_)}h=h.sibling}}function Oe(h,_,M){for(M=M&&(_.subtreeFlags&8772)!==0,_=_.child;_!==null;){var L=_.alternate,X=h,ie=_,De=ie.flags;switch(ie.tag){case 0:case 11:case 15:Oe(X,ie,M),Tp(4,ie);break;case 1:if(Oe(X,ie,M),L=ie,X=L.stateNode,typeof X.componentDidMount=="function")try{X.componentDidMount()}catch(dr){wa(L,L.return,dr)}if(L=ie,X=L.updateQueue,X!==null){var Xe=L.stateNode;try{var Tt=X.shared.hiddenCallbacks;if(Tt!==null)for(X.shared.hiddenCallbacks=null,X=0;X<Tt.length;X++)ot(Tt[X],Xe)}catch(dr){wa(L,L.return,dr)}}M&&De&64&&Ep(ie),vm(ie,ie.return);break;case 27:Kf(ie);case 26:case 5:Oe(X,ie,M),M&&L===null&&De&4&&Cp(ie),vm(ie,ie.return);break;case 12:Oe(X,ie,M);break;case 13:Oe(X,ie,M),M&&De&4&&H(X,ie);break;case 22:ie.memoizedState===null&&Oe(X,ie,M),vm(ie,ie.return);break;case 30:break;default:Oe(X,ie,M)}_=_.sibling}}function Le(h,_){var M=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(M=h.memoizedState.cachePool.pool),h=null,_.memoizedState!==null&&_.memoizedState.cachePool!==null&&(h=_.memoizedState.cachePool.pool),h!==M&&(h!=null&&h.refCount++,M!=null&&qn(M))}function Ge(h,_){h=null,_.alternate!==null&&(h=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==h&&(_.refCount++,h!=null&&qn(h))}function Ue(h,_,M,L){if(_.subtreeFlags&10256)for(_=_.child;_!==null;)Ze(h,_,M,L),_=_.sibling}function Ze(h,_,M,L){var X=_.flags;switch(_.tag){case 0:case 11:case 15:Ue(h,_,M,L),X&2048&&Tp(9,_);break;case 1:Ue(h,_,M,L);break;case 3:Ue(h,_,M,L),X&2048&&(h=null,_.alternate!==null&&(h=_.alternate.memoizedState.cache),_=_.memoizedState.cache,_!==h&&(_.refCount++,h!=null&&qn(h)));break;case 12:if(X&2048){Ue(h,_,M,L),h=_.stateNode;try{var ie=_.memoizedProps,De=ie.id,Xe=ie.onPostCommit;typeof Xe=="function"&&Xe(De,_.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(Tt){wa(_,_.return,Tt)}}else Ue(h,_,M,L);break;case 13:Ue(h,_,M,L);break;case 23:break;case 22:ie=_.stateNode,De=_.alternate,_.memoizedState!==null?ie._visibility&2?Ue(h,_,M,L):Ve(h,_):ie._visibility&2?Ue(h,_,M,L):(ie._visibility|=2,$e(h,_,M,L,(_.subtreeFlags&10256)!==0)),X&2048&&Le(De,_);break;case 24:Ue(h,_,M,L),X&2048&&Ge(_.alternate,_);break;default:Ue(h,_,M,L)}}function $e(h,_,M,L,X){for(X=X&&(_.subtreeFlags&10256)!==0,_=_.child;_!==null;){var ie=h,De=_,Xe=M,Tt=L,dr=De.flags;switch(De.tag){case 0:case 11:case 15:$e(ie,De,Xe,Tt,X),Tp(8,De);break;case 23:break;case 22:var zr=De.stateNode;De.memoizedState!==null?zr._visibility&2?$e(ie,De,Xe,Tt,X):Ve(ie,De):(zr._visibility|=2,$e(ie,De,Xe,Tt,X)),X&&dr&2048&&Le(De.alternate,De);break;case 24:$e(ie,De,Xe,Tt,X),X&&dr&2048&&Ge(De.alternate,De);break;default:$e(ie,De,Xe,Tt,X)}_=_.sibling}}function Ve(h,_){if(_.subtreeFlags&10256)for(_=_.child;_!==null;){var M=h,L=_,X=L.flags;switch(L.tag){case 22:Ve(M,L),X&2048&&Le(L.alternate,L);break;case 24:Ve(M,L),X&2048&&Ge(L.alternate,L);break;default:Ve(M,L)}_=_.sibling}}var We=8192;function yt(h){if(h.subtreeFlags&We)for(h=h.child;h!==null;)lt(h),h=h.sibling}function lt(h){switch(h.tag){case 26:yt(h),h.flags&We&&h.memoizedState!==null&&z0(se,h.memoizedState,h.memoizedProps);break;case 5:yt(h);break;case 3:case 4:var _=se;se=O0(h.stateNode.containerInfo),yt(h),se=_;break;case 22:h.memoizedState===null&&(_=h.alternate,_!==null&&_.memoizedState!==null?(_=We,We=16777216,yt(h),We=_):yt(h));break;default:yt(h)}}function Ot(h){var _=h.alternate;if(_!==null&&(h=_.child,h!==null)){_.child=null;do _=h.sibling,h.sibling=null,h=_;while(h!==null)}}function _t(h){var _=h.deletions;if((h.flags&16)!==0){if(_!==null)for(var M=0;M<_.length;M++){var L=_[M];n=L,xt(L,h)}Ot(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)It(h),h=h.sibling}function It(h){switch(h.tag){case 0:case 11:case 15:_t(h),h.flags&2048&&Yf(9,h,h.return);break;case 3:_t(h);break;case 12:_t(h);break;case 22:var _=h.stateNode;h.memoizedState!==null&&_._visibility&2&&(h.return===null||h.return.tag!==13)?(_._visibility&=-3,ur(h)):_t(h);break;default:_t(h)}}function ur(h){var _=h.deletions;if((h.flags&16)!==0){if(_!==null)for(var M=0;M<_.length;M++){var L=_[M];n=L,xt(L,h)}Ot(h)}for(h=h.child;h!==null;){switch(_=h,_.tag){case 0:case 11:case 15:Yf(8,_,_.return),ur(_);break;case 22:M=_.stateNode,M._visibility&2&&(M._visibility&=-3,ur(_));break;default:ur(_)}h=h.sibling}}function xt(h,_){for(;n!==null;){var M=n;switch(M.tag){case 0:case 11:case 15:Yf(8,M,_);break;case 23:case 22:if(M.memoizedState!==null&&M.memoizedState.cachePool!==null){var L=M.memoizedState.cachePool.pool;L!=null&&L.refCount++}break;case 24:qn(M.memoizedState.cache)}if(L=M.child,L!==null)L.return=M,n=L;else e:for(M=h;n!==null;){L=n;var X=L.sibling,ie=L.return;if(x(L),L===M){n=null;break e}if(X!==null){X.return=ie,n=X;break e}n=ie}}}var rt={getCacheForType:function(h){var _=ts(xn),M=_.data.get(h);return M===void 0&&(M=h(),_.data.set(h,M)),M}},zt=typeof WeakMap=="function"?WeakMap:Map,gt=0,Bt=null,Gt=null,ar=0,Ht=0,Xt=null,qr=!1,$r=!1,Yr=!1,Lr=0,rn=0,En=0,In=0,ki=0,_n=0,si=0,xi=null,Ci=null,On=!1,bi=0,Ai=1/0,wi=null,Ji=null,Vi=0,ta=null,so=null,Pn=0,An=0,zi=null,Ho=null,ho=0,sa=null;function qo(){if((gt&2)!==0&&ar!==0)return ar&-ar;if(et.T!==null){var h=Wl;return h!==0?h:Jf()}return kh()}function Xl(){_n===0&&(_n=(ar&536870912)===0||To?Ir():536870912);var h=ws.current;return h!==null&&(h.flags|=32),_n}function xa(h,_,M){(h===Bt&&(Ht===2||Ht===9)||h.cancelPendingCommit!==null)&&(jo(h,0),Es(h,ar,_n,!1)),Gs(h,M),((gt&2)===0||h!==Bt)&&(h===Bt&&((gt&2)===0&&(In|=M),rn===4&&Es(h,ar,_n,!1)),Gc(h))}function Dl(h,_,M){if((gt&6)!==0)throw Error(l(327));var L=!M&&(_&124)===0&&(_&h.expiredLanes)===0||Xo(h,_),X=L?hf(h,_):us(h,_,!0),ie=L;do{if(X===0){$r&&!L&&Es(h,_,0,!1);break}else{if(M=h.current.alternate,ie&&!dl(M)){X=us(h,_,!1),ie=!1;continue}if(X===2){if(ie=_,h.errorRecoveryDisabledLanes&ie)var De=0;else De=h.pendingLanes&-536870913,De=De!==0?De:De&536870912?536870912:0;if(De!==0){_=De;e:{var Xe=h;X=xi;var Tt=Xe.current.memoizedState.isDehydrated;if(Tt&&(jo(Xe,De).flags|=256),De=us(Xe,De,!1),De!==2){if(Yr&&!Tt){Xe.errorRecoveryDisabledLanes|=ie,In|=ie,X=4;break e}ie=Ci,Ci=X,ie!==null&&(Ci===null?Ci=ie:Ci.push.apply(Ci,ie))}X=De}if(ie=!1,X!==2)continue}}if(X===1){jo(h,0),Es(h,_,0,!0);break}e:{switch(L=h,ie=X,ie){case 0:case 1:throw Error(l(345));case 4:if((_&4194048)!==_)break;case 6:Es(L,_,_n,!qr);break e;case 2:Ci=null;break;case 3:case 5:break;default:throw Error(l(329))}if((_&62914560)===_&&(X=bi+300-di(),10<X)){if(Es(L,_,_n,!qr),Qi(L,0,!0)!==0)break e;L.timeoutHandle=Wx(Ol.bind(null,L,M,Ci,wi,On,_,_n,In,si,qr,ie,2,-0,0),X);break e}Ol(L,M,Ci,wi,On,_,_n,In,si,qr,ie,0,-0,0)}}break}while(!0);Gc(h)}function Ol(h,_,M,L,X,ie,De,Xe,Tt,dr,zr,Zr,Ar,gr){if(h.timeoutHandle=-1,Zr=_.subtreeFlags,(Zr&8192||(Zr&16785408)===16785408)&&(k0={stylesheets:null,count:0,unsuspend:q2},lt(_),Zr=s1(),Zr!==null)){h.cancelPendingCommit=Zr(Bu.bind(null,h,_,ie,M,L,X,De,Xe,Tt,zr,1,Ar,gr)),Es(h,ie,De,!dr);return}Bu(h,_,ie,M,L,X,De,Xe,Tt)}function dl(h){for(var _=h;;){var M=_.tag;if((M===0||M===11||M===15)&&_.flags&16384&&(M=_.updateQueue,M!==null&&(M=M.stores,M!==null)))for(var L=0;L<M.length;L++){var X=M[L],ie=X.getSnapshot;X=X.value;try{if(!ua(ie(),X))return!1}catch{return!1}}if(M=_.child,_.subtreeFlags&16384&&M!==null)M.return=_,_=M;else{if(_===h)break;for(;_.sibling===null;){if(_.return===null||_.return===h)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Es(h,_,M,L){_&=~ki,_&=~In,h.suspendedLanes|=_,h.pingedLanes&=~_,L&&(h.warmLanes|=_),L=h.expirationTimes;for(var X=_;0<X;){var ie=31-to(X),De=1<<ie;L[ie]=-1,X&=~De}M!==0&&Zu(h,M,_)}function Yl(){return(gt&6)===0?(Mp(0),!1):!0}function Wo(){if(Gt!==null){if(Ht===0)var h=Gt.return;else h=Gt,za=ql=null,Rr(h),uc=null,Du=0,h=Gt;for(;h!==null;)Sp(h.alternate,h),h=h.return;Gt=null}}function jo(h,_){var M=h.timeoutHandle;M!==-1&&(h.timeoutHandle=-1,U2(M)),M=h.cancelPendingCommit,M!==null&&(h.cancelPendingCommit=null,M()),Wo(),Bt=h,Gt=M=xu(h.current,null),ar=_,Ht=0,Xt=null,qr=!1,$r=Xo(h,_),Yr=!1,si=_n=ki=In=En=rn=0,Ci=xi=null,On=!1,(_&8)!==0&&(_|=_&32);var L=h.entangledLanes;if(L!==0)for(h=h.entanglements,L&=_;0<L;){var X=31-to(L),ie=1<<X;_|=h[X],L&=~ie}return Lr=_,Bf(),M}function Do(h,_){yr=null,et.H=sf,_===Jh||_===Ml?(_=w(),Ht=3):_===ef?(_=w(),Ht=4):Ht=_===wA?8:_!==null&&typeof _=="object"&&typeof _.then=="function"?6:1,Xt=_,Gt===null&&(rn=1,xp(h,xs(_,h.current)))}function ba(){var h=et.H;return et.H=sf,h===null?sf:h}function Fa(){var h=et.A;return et.A=rt,h}function ra(){rn=4,qr||(ar&4194048)!==ar&&ws.current!==null||($r=!0),(En&134217727)===0&&(In&134217727)===0||Bt===null||Es(Bt,ar,_n,!1)}function us(h,_,M){var L=gt;gt|=2;var X=ba(),ie=Fa();(Bt!==h||ar!==_)&&(wi=null,jo(h,_)),_=!1;var De=rn;e:do try{if(Ht!==0&&Gt!==null){var Xe=Gt,Tt=Xt;switch(Ht){case 8:Wo(),De=6;break e;case 3:case 2:case 9:case 6:ws.current===null&&(_=!0);var dr=Ht;if(Ht=0,Xt=null,kl(h,Xe,Tt,dr),M&&$r){De=0;break e}break;default:dr=Ht,Ht=0,Xt=null,kl(h,Xe,Tt,dr)}}xh(),De=rn;break}catch(zr){Do(h,zr)}while(!0);return _&&h.shellSuspendCounter++,za=ql=null,gt=L,et.H=X,et.A=ie,Gt===null&&(Bt=null,ar=0,Bf()),De}function xh(){for(;Gt!==null;)ff(Gt)}function hf(h,_){var M=gt;gt|=2;var L=ba(),X=Fa();Bt!==h||ar!==_?(wi=null,Ai=di()+500,jo(h,_)):$r=Xo(h,_);e:do try{if(Ht!==0&&Gt!==null){_=Gt;var ie=Xt;t:switch(Ht){case 1:Ht=0,Xt=null,kl(h,_,ie,1);break;case 2:case 9:if(Pu(ie)){Ht=0,Xt=null,df(_);break}_=function(){Ht!==2&&Ht!==9||Bt!==h||(Ht=7),Gc(h)},ie.then(_,_);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:Pu(ie)?(Ht=0,Xt=null,df(_)):(Ht=0,Xt=null,kl(h,_,ie,7));break;case 5:var De=null;switch(Gt.tag){case 26:De=Gt.memoizedState;case 5:case 27:var Xe=Gt;if(!De||a1(De)){Ht=0,Xt=null;var Tt=Xe.sibling;if(Tt!==null)Gt=Tt;else{var dr=Xe.return;dr!==null?(Gt=dr,pf(dr)):Gt=null}break t}}Ht=0,Xt=null,kl(h,_,ie,5);break;case 6:Ht=0,Xt=null,kl(h,_,ie,6);break;case 8:Wo(),rn=6;break e;default:throw Error(l(462))}}Lu();break}catch(zr){Do(h,zr)}while(!0);return za=ql=null,et.H=L,et.A=X,gt=M,Gt!==null?0:(Bt=null,ar=0,Bf(),rn)}function Lu(){for(;Gt!==null&&!Rn();)ff(Gt)}function ff(h){var _=RA(h.alternate,h,Lr);h.memoizedProps=h.pendingProps,_===null?pf(h):Gt=_}function df(h){var _=h,M=_.alternate;switch(_.tag){case 15:case 0:_=w0(M,_,_.pendingProps,_.type,void 0,ar);break;case 11:_=w0(M,_,_.pendingProps,_.type.render,_.ref,ar);break;case 5:Rr(_);default:Sp(M,_),_=Gt=lA(_,Lr),_=RA(M,_,Lr)}h.memoizedProps=h.pendingProps,_===null?pf(h):Gt=_}function kl(h,_,M,L){za=ql=null,Rr(_),uc=null,Du=0;var X=_.return;try{if(bA(h,X,_,M,ar)){rn=1,xp(h,xs(M,h.current)),Gt=null;return}}catch(ie){if(X!==null)throw Gt=X,ie;rn=1,xp(h,xs(M,h.current)),Gt=null;return}_.flags&32768?(To||L===1?h=!0:$r||(ar&536870912)!==0?h=!1:(qr=h=!0,(L===2||L===9||L===3||L===6)&&(L=ws.current,L!==null&&L.tag===13&&(L.flags|=16384))),bh(_,h)):pf(_)}function pf(h){var _=h;do{if((_.flags&32768)!==0){bh(_,qr);return}h=_.return;var M=yh(_.alternate,_,Lr);if(M!==null){Gt=M;return}if(_=_.sibling,_!==null){Gt=_;return}Gt=_=h}while(_!==null);rn===0&&(rn=5)}function bh(h,_){do{var M=ym(h.alternate,h);if(M!==null){M.flags&=32767,Gt=M;return}if(M=h.return,M!==null&&(M.flags|=32768,M.subtreeFlags=0,M.deletions=null),!_&&(h=h.sibling,h!==null)){Gt=h;return}Gt=h=M}while(h!==null);rn=6,Gt=null}function Bu(h,_,M,L,X,ie,De,Xe,Tt){h.cancelPendingCommit=null;do Fg();while(Vi!==0);if((gt&6)!==0)throw Error(l(327));if(_!==null){if(_===h.current)throw Error(l(177));if(ie=_.lanes|_.childLanes,ie|=mr,hd(h,M,ie,De,Xe,Tt),h===Bt&&(Gt=Bt=null,ar=0),so=_,ta=h,Pn=M,An=ie,zi=X,Ho=L,(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?(h.callbackNode=null,h.callbackPriority=0,gy(_i,function(){return Fx(),null})):(h.callbackNode=null,h.callbackPriority=0),L=(_.flags&13878)!==0,(_.subtreeFlags&13878)!==0||L){L=et.T,et.T=null,X=Zt.p,Zt.p=2,De=gt,gt|=4;try{c(h,_,M)}finally{gt=De,Zt.p=X,et.T=L}}Vi=1,wh(),xm(),Ys()}}function wh(){if(Vi===1){Vi=0;var h=ta,_=so,M=(_.flags&13878)!==0;if((_.subtreeFlags&13878)!==0||M){M=et.T,et.T=null;var L=Zt.p;Zt.p=2;var X=gt;gt|=4;try{fe(_,h);var ie=Fd,De=vs(h.containerInfo),Xe=ie.focusedElem,Tt=ie.selectionRange;if(De!==Xe&&Xe&&Xe.ownerDocument&&Sl(Xe.ownerDocument.documentElement,Xe)){if(Tt!==null&&em(Xe)){var dr=Tt.start,zr=Tt.end;if(zr===void 0&&(zr=dr),"selectionStart"in Xe)Xe.selectionStart=dr,Xe.selectionEnd=Math.min(zr,Xe.value.length);else{var Zr=Xe.ownerDocument||document,Ar=Zr&&Zr.defaultView||window;if(Ar.getSelection){var gr=Ar.getSelection(),Pi=Xe.textContent.length,li=Math.min(Tt.start,Pi),Yo=Tt.end===void 0?li:Math.min(Tt.end,Pi);!gr.extend&&li>Yo&&(De=Yo,Yo=li,li=De);var Yt=Cc(Xe,li),Ft=Cc(Xe,Yo);if(Yt&&Ft&&(gr.rangeCount!==1||gr.anchorNode!==Yt.node||gr.anchorOffset!==Yt.offset||gr.focusNode!==Ft.node||gr.focusOffset!==Ft.offset)){var nr=Zr.createRange();nr.setStart(Yt.node,Yt.offset),gr.removeAllRanges(),li>Yo?(gr.addRange(nr),gr.extend(Ft.node,Ft.offset)):(nr.setEnd(Ft.node,Ft.offset),gr.addRange(nr))}}}}for(Zr=[],gr=Xe;gr=gr.parentNode;)gr.nodeType===1&&Zr.push({element:gr,left:gr.scrollLeft,top:gr.scrollTop});for(typeof Xe.focus=="function"&&Xe.focus(),Xe=0;Xe<Zr.length;Xe++){var Nr=Zr[Xe];Nr.element.scrollLeft=Nr.left,Nr.element.scrollTop=Nr.top}}F0=!!Xg,Fd=Xg=null}finally{gt=X,Zt.p=L,et.T=M}}h.current=_,Vi=2}}function xm(){if(Vi===2){Vi=0;var h=ta,_=so,M=(_.flags&8772)!==0;if((_.subtreeFlags&8772)!==0||M){M=et.T,et.T=null;var L=Zt.p;Zt.p=2;var X=gt;gt|=4;try{d(h,_.alternate,_)}finally{gt=X,Zt.p=L,et.T=M}}Vi=3}}function Ys(){if(Vi===4||Vi===3){Vi=0,mo();var h=ta,_=so,M=Pn,L=Ho;(_.subtreeFlags&10256)!==0||(_.flags&10256)!==0?Vi=5:(Vi=0,so=ta=null,bm(h,h.pendingLanes));var X=h.pendingLanes;if(X===0&&(Ji=null),Ul(M),_=_.stateNode,ai&&typeof ai.onCommitFiberRoot=="function")try{ai.onCommitFiberRoot(ao,_,void 0,(_.current.flags&128)===128)}catch{}if(L!==null){_=et.T,X=Zt.p,Zt.p=2,et.T=null;try{for(var ie=h.onRecoverableError,De=0;De<L.length;De++){var Xe=L[De];ie(Xe.value,{componentStack:Xe.stack})}}finally{et.T=_,Zt.p=X}}(Pn&3)!==0&&Fg(),Gc(h),X=h.pendingLanes,(M&4194090)!==0&&(X&42)!==0?h===sa?ho++:(ho=0,sa=h):ho=0,Mp(0)}}function bm(h,_){(h.pooledCacheLanes&=_)===0&&(_=h.pooledCache,_!=null&&(h.pooledCache=null,qn(_)))}function Fg(h){return wh(),xm(),Ys(),Fx()}function Fx(){if(Vi!==5)return!1;var h=ta,_=An;An=0;var M=Ul(Pn),L=et.T,X=Zt.p;try{Zt.p=32>M?32:M,et.T=null,M=zi,zi=null;var ie=ta,De=Pn;if(Vi=0,so=ta=null,Pn=0,(gt&6)!==0)throw Error(l(331));var Xe=gt;if(gt|=4,It(ie.current),Ze(ie,ie.current,De,M),gt=Xe,Mp(0,!1),ai&&typeof ai.onPostCommitFiberRoot=="function")try{ai.onPostCommitFiberRoot(ao,ie)}catch{}return!0}finally{Zt.p=X,et.T=L,bm(h,_)}}function M0(h,_,M){_=xs(M,_),_=kd(h.stateNode,_,2),h=Z(h,_,2),h!==null&&(Gs(h,2),Gc(h))}function wa(h,_,M){if(h.tag===3)M0(h,h,M);else for(;_!==null;){if(_.tag===3){M0(_,h,M);break}else if(_.tag===1){var L=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(Ji===null||!Ji.has(L))){h=xs(M,h),M=zd(2),L=Z(_,M,2),L!==null&&(pm(M,L,_,h),Gs(L,2),Gc(L));break}}_=_.return}}function Ng(h,_,M){var L=h.pingCache;if(L===null){L=h.pingCache=new zt;var X=new Set;L.set(_,X)}else X=L.get(_),X===void 0&&(X=new Set,L.set(_,X));X.has(M)||(Yr=!0,X.add(M),h=jg.bind(null,h,_,M),_.then(h,h))}function jg(h,_,M){var L=h.pingCache;L!==null&&L.delete(_),h.pingedLanes|=h.suspendedLanes&M,h.warmLanes&=~M,Bt===h&&(ar&M)===M&&(rn===4||rn===3&&(ar&62914560)===ar&&300>di()-bi?(gt&2)===0&&jo(h,0):ki|=M,si===ar&&(si=0)),Gc(h)}function Nx(h,_){_===0&&(_=If()),h=Rc(h,_),h!==null&&(Gs(h,_),Gc(h))}function jx(h){var _=h.memoizedState,M=0;_!==null&&(M=_.retryLane),Nx(h,M)}function B2(h,_){var M=0;switch(h.tag){case 13:var L=h.stateNode,X=h.memoizedState;X!==null&&(M=X.retryLane);break;case 19:L=h.stateNode;break;case 22:L=h.stateNode._retryCache;break;default:throw Error(l(314))}L!==null&&L.delete(_),Nx(h,M)}function gy(h,_){return Zi(h,_)}var Fu=null,$c=null,Ug=!1,I0=!1,DA=!1,Bd=0;function Gc(h){h!==$c&&h.next===null&&($c===null?Fu=$c=h:$c=$c.next=h),I0=!0,Ug||(Ug=!0,Vx())}function Mp(h,_){if(!DA&&I0){DA=!0;do for(var M=!1,L=Fu;L!==null;){if(h!==0){var X=L.pendingLanes;if(X===0)var ie=0;else{var De=L.suspendedLanes,Xe=L.pingedLanes;ie=(1<<31-to(42|h)+1)-1,ie&=X&~(De&~Xe),ie=ie&201326741?ie&201326741|1:ie?ie|2:0}ie!==0&&(M=!0,_y(L,ie))}else ie=ar,ie=Qi(L,L===Bt?ie:0,L.cancelPendingCommit!==null||L.timeoutHandle!==-1),(ie&3)===0||Xo(L,ie)||(M=!0,_y(L,ie));L=L.next}while(M);DA=!1}}function Ux(){P0()}function P0(){I0=Ug=!1;var h=0;Bd!==0&&(j2()&&(h=Bd),Bd=0);for(var _=di(),M=null,L=Fu;L!==null;){var X=L.next,ie=Vg(L,_);ie===0?(L.next=null,M===null?Fu=X:M.next=X,X===null&&($c=M)):(M=L,(h!==0||(ie&3)!==0)&&(I0=!0)),L=X}Mp(h)}function Vg(h,_){for(var M=h.suspendedLanes,L=h.pingedLanes,X=h.expirationTimes,ie=h.pendingLanes&-62914561;0<ie;){var De=31-to(ie),Xe=1<<De,Tt=X[De];Tt===-1?((Xe&M)===0||(Xe&L)!==0)&&(X[De]=ro(Xe,_)):Tt<=_&&(h.expiredLanes|=Xe),ie&=~Xe}if(_=Bt,M=ar,M=Qi(h,h===_?M:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),L=h.callbackNode,M===0||h===_&&(Ht===2||Ht===9)||h.cancelPendingCommit!==null)return L!==null&&L!==null&&wn(L),h.callbackNode=null,h.callbackPriority=0;if((M&3)===0||Xo(h,M)){if(_=M&-M,_===h.callbackPriority)return _;switch(L!==null&&wn(L),Ul(M)){case 2:case 8:M=$o;break;case 32:M=_i;break;case 268435456:M=Ca;break;default:M=_i}return L=$g.bind(null,h),M=Zi(M,L),h.callbackPriority=_,h.callbackNode=M,_}return L!==null&&L!==null&&wn(L),h.callbackPriority=2,h.callbackNode=null,2}function $g(h,_){if(Vi!==0&&Vi!==5)return h.callbackNode=null,h.callbackPriority=0,null;var M=h.callbackNode;if(Fg()&&h.callbackNode!==M)return null;var L=ar;return L=Qi(h,h===Bt?L:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),L===0?null:(Dl(h,L,_),Vg(h,di()),h.callbackNode!=null&&h.callbackNode===M?$g.bind(null,h):null)}function _y(h,_){if(Fg())return null;Dl(h,_,!0)}function Vx(){V2(function(){(gt&6)!==0?Zi(eo,Ux):P0()})}function Jf(){return Bd===0&&(Bd=Ir()),Bd}function yy(h){return h==null||typeof h=="symbol"||typeof h=="boolean"?null:typeof h=="function"?h:Fo(""+h)}function Gg(h,_){var M=_.ownerDocument.createElement("input");return M.name=_.name,M.value=_.value,h.id&&M.setAttribute("form",h.id),_.parentNode.insertBefore(M,_),h=new FormData(h),M.parentNode.removeChild(M),h}function $x(h,_,M,L,X){if(_==="submit"&&M&&M.stateNode===X){var ie=yy((X[ge]||null).action),De=L.submitter;De&&(_=(_=De[ge]||null)?yy(_.formAction):De.getAttribute("formAction"),_!==null&&(ie=_,De=null));var Xe=new md("action","action",null,L,X);h.push({event:Xe,listeners:[{instance:null,listener:function(){if(L.defaultPrevented){if(Bd!==0){var Tt=De?Gg(X,De):new FormData(X);mp(M,{pending:!0,data:Tt,method:X.method,action:ie},null,Tt)}}else typeof ie=="function"&&(Xe.preventDefault(),Tt=De?Gg(X,De):new FormData(X),mp(M,{pending:!0,data:Tt,method:X.method,action:ie},ie,Tt))},currentTarget:X}]})}}for(var vy=0;vy<sh.length;vy++){var xy=sh[vy],F2=xy.toLowerCase(),Gx=xy[0].toUpperCase()+xy.slice(1);es(F2,"on"+Gx)}es(Tl,"onAnimationEnd"),es(Gh,"onAnimationIteration"),es(tm,"onAnimationStart"),es("dblclick","onDoubleClick"),es("focusin","onFocus"),es("focusout","onBlur"),es(sA,"onTransitionRun"),es(Hh,"onTransitionStart"),es(Lf,"onTransitionCancel"),es(lp,"onTransitionEnd"),Ii("onMouseEnter",["mouseout","mouseover"]),Ii("onMouseLeave",["mouseout","mouseover"]),Ii("onPointerEnter",["pointerout","pointerover"]),Ii("onPointerLeave",["pointerout","pointerover"]),Yn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var OA="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),N2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(OA));function by(h,_){_=(_&4)!==0;for(var M=0;M<h.length;M++){var L=h[M],X=L.event;L=L.listeners;e:{var ie=void 0;if(_)for(var De=L.length-1;0<=De;De--){var Xe=L[De],Tt=Xe.instance,dr=Xe.currentTarget;if(Xe=Xe.listener,Tt!==ie&&X.isPropagationStopped())break e;ie=Xe,X.currentTarget=dr;try{ie(X)}catch(zr){Zf(zr)}X.currentTarget=null,ie=Tt}else for(De=0;De<L.length;De++){if(Xe=L[De],Tt=Xe.instance,dr=Xe.currentTarget,Xe=Xe.listener,Tt!==ie&&X.isPropagationStopped())break e;ie=Xe,X.currentTarget=dr;try{ie(X)}catch(zr){Zf(zr)}X.currentTarget=null,ie=Tt}}}}function Oo(h,_){var M=_[ze];M===void 0&&(M=_[ze]=new Set);var L=h+"__bubble";M.has(L)||(Sy(_,h,2,!1),M.add(L))}function wy(h,_,M){var L=0;_&&(L|=4),Sy(M,h,L,_)}var R0="_reactListening"+Math.random().toString(36).slice(2);function Hg(h){if(!h[R0]){h[R0]=!0,zn.forEach(function(M){M!=="selectionchange"&&(N2.has(M)||wy(M,!1,h),wy(M,!0,h))});var _=h.nodeType===9?h:h.ownerDocument;_===null||_[R0]||(_[R0]=!0,wy("selectionchange",!1,_))}}function Sy(h,_,M,L){switch(Nd(_)){case 2:var X=zy;break;case 8:X=W2;break;default:X=Ly}M=X.bind(null,_,M,h),X=void 0,!oi||_!=="touchstart"&&_!=="touchmove"&&_!=="wheel"||(X=!0),L?X!==void 0?h.addEventListener(_,M,{capture:!0,passive:X}):h.addEventListener(_,M,!0):X!==void 0?h.addEventListener(_,M,{passive:X}):h.addEventListener(_,M,!1)}function qg(h,_,M,L,X){var ie=L;if((_&1)===0&&(_&2)===0&&L!==null)e:for(;;){if(L===null)return;var De=L.tag;if(De===3||De===4){var Xe=L.stateNode.containerInfo;if(Xe===X)break;if(De===4)for(De=L.return;De!==null;){var Tt=De.tag;if((Tt===3||Tt===4)&&De.stateNode.containerInfo===X)return;De=De.return}for(;Xe!==null;){if(De=Lt(Xe),De===null)return;if(Tt=De.tag,Tt===5||Tt===6||Tt===26||Tt===27){L=ie=De;continue e}Xe=Xe.parentNode}}L=L.return}zh(function(){var dr=ie,zr=ou(M),Zr=[];e:{var Ar=cp.get(h);if(Ar!==void 0){var gr=md,Pi=h;switch(h){case"keypress":if(cu(M)===0)break e;case"keydown":case"keyup":gr=Di;break;case"focusin":Pi="focus",gr=zf;break;case"focusout":Pi="blur",gr=zf;break;case"beforeblur":case"afterblur":gr=zf;break;case"click":if(M.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":gr=qs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":gr=wl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":gr=Ti;break;case Tl:case Gh:case tm:gr=vi;break;case lp:gr=th;break;case"scroll":case"scrollend":gr=kf;break;case"wheel":gr=_s;break;case"copy":case"cut":case"paste":gr=Jp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":gr=Ws;break;case"toggle":case"beforetoggle":gr=op}var li=(_&4)!==0,Yo=!li&&(h==="scroll"||h==="scrollend"),Yt=li?Ar!==null?Ar+"Capture":null:Ar;li=[];for(var Ft=dr,nr;Ft!==null;){var Nr=Ft;if(nr=Nr.stateNode,Nr=Nr.tag,Nr!==5&&Nr!==26&&Nr!==27||nr===null||Yt===null||(Nr=su(Ft,Yt),Nr!=null&&li.push(kA(Ft,Nr,nr))),Yo)break;Ft=Ft.return}0<li.length&&(Ar=new gr(Ar,Pi,null,M,zr),Zr.push({event:Ar,listeners:li}))}}if((_&7)===0){e:{if(Ar=h==="mouseover"||h==="pointerover",gr=h==="mouseout"||h==="pointerout",Ar&&M!==iu&&(Pi=M.relatedTarget||M.fromElement)&&(Lt(Pi)||Pi[Me]))break e;if((gr||Ar)&&(Ar=zr.window===zr?zr:(Ar=zr.ownerDocument)?Ar.defaultView||Ar.parentWindow:window,gr?(Pi=M.relatedTarget||M.toElement,gr=dr,Pi=Pi?Lt(Pi):null,Pi!==null&&(Yo=y(Pi),li=Pi.tag,Pi!==Yo||li!==5&&li!==27&&li!==6)&&(Pi=null)):(gr=null,Pi=dr),gr!==Pi)){if(li=qs,Nr="onMouseLeave",Yt="onMouseEnter",Ft="mouse",(h==="pointerout"||h==="pointerover")&&(li=Ws,Nr="onPointerLeave",Yt="onPointerEnter",Ft="pointer"),Yo=gr==null?Ar:Fr(gr),nr=Pi==null?Ar:Fr(Pi),Ar=new li(Nr,Ft+"leave",gr,M,zr),Ar.target=Yo,Ar.relatedTarget=nr,Nr=null,Lt(zr)===dr&&(li=new li(Yt,Ft+"enter",Pi,M,zr),li.target=nr,li.relatedTarget=Yo,Nr=li),Yo=Nr,gr&&Pi)t:{for(li=gr,Yt=Pi,Ft=0,nr=li;nr;nr=wm(nr))Ft++;for(nr=0,Nr=Yt;Nr;Nr=wm(Nr))nr++;for(;0<Ft-nr;)li=wm(li),Ft--;for(;0<nr-Ft;)Yt=wm(Yt),nr--;for(;Ft--;){if(li===Yt||Yt!==null&&li===Yt.alternate)break t;li=wm(li),Yt=wm(Yt)}li=null}else li=null;gr!==null&&Wg(Zr,Ar,gr,li,!1),Pi!==null&&Yo!==null&&Wg(Zr,Yo,Pi,li,!0)}}e:{if(Ar=dr?Fr(dr):window,gr=Ar.nodeName&&Ar.nodeName.toLowerCase(),gr==="select"||gr==="input"&&Ar.type==="file")var Gn=gn;else if(Mn(Ar))if(xd)Gn=Ec;else{Gn=Zs;var fo=wd}else gr=Ar.nodeName,!gr||gr.toLowerCase()!=="input"||Ar.type!=="checkbox"&&Ar.type!=="radio"?dr&&fd(dr.elementType)&&(Gn=gn):Gn=Rs;if(Gn&&(Gn=Gn(h,dr))){Mr(Zr,Gn,M,zr);break e}fo&&fo(h,Ar,dr),h==="focusout"&&dr&&Ar.type==="number"&&dr.memoizedProps.value!=null&&sl(Ar,"number",Ar.value)}switch(fo=dr?Fr(dr):window,h){case"focusin":(Mn(fo)||fo.contentEditable==="true")&&($h=fo,rh=dr,nh=null);break;case"focusout":nh=rh=$h=null;break;case"mousedown":Mc=!0;break;case"contextmenu":case"mouseup":case"dragend":Mc=!1,Ic(Zr,M,zr);break;case"selectionchange":if(Vh)break;case"keydown":case"keyup":Ic(Zr,M,zr)}var Wn;if(vd)e:{switch(h){case"compositionstart":var fi="onCompositionStart";break e;case"compositionend":fi="onCompositionEnd";break e;case"compositionupdate":fi="onCompositionUpdate";break e}fi=void 0}else gu?ys(h,M)&&(fi="onCompositionEnd"):h==="keydown"&&M.keyCode===229&&(fi="onCompositionStart");fi&&(Au&&M.locale!=="ko"&&(gu||fi!=="onCompositionStart"?fi==="onCompositionEnd"&&gu&&(Wn=oc()):(Sc=zr,rp="value"in Sc?Sc.value:Sc.textContent,gu=!0)),fo=D0(dr,fi),0<fo.length&&(fi=new hn(fi,h,null,M,zr),Zr.push({event:fi,listeners:fo}),Wn?fi.data=Wn:(Wn=Is(M),Wn!==null&&(fi.data=Wn)))),(Wn=mu?Nh(h,M):Ma(h,M))&&(fi=D0(dr,"onBeforeInput"),0<fi.length&&(fo=new hn("onBeforeInput","beforeinput",null,M,zr),Zr.push({event:fo,listeners:fi}),fo.data=Wn)),$x(Zr,h,dr,M,zr)}by(Zr,_)})}function kA(h,_,M){return{instance:h,listener:_,currentTarget:M}}function D0(h,_){for(var M=_+"Capture",L=[];h!==null;){var X=h,ie=X.stateNode;if(X=X.tag,X!==5&&X!==26&&X!==27||ie===null||(X=su(h,M),X!=null&&L.unshift(kA(h,X,ie)),X=su(h,_),X!=null&&L.push(kA(h,X,ie))),h.tag===3)return L;h=h.return}return[]}function wm(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5&&h.tag!==27);return h||null}function Wg(h,_,M,L,X){for(var ie=_._reactName,De=[];M!==null&&M!==L;){var Xe=M,Tt=Xe.alternate,dr=Xe.stateNode;if(Xe=Xe.tag,Tt!==null&&Tt===L)break;Xe!==5&&Xe!==26&&Xe!==27||dr===null||(Tt=dr,X?(dr=su(M,ie),dr!=null&&De.unshift(kA(M,dr,Tt))):X||(dr=su(M,ie),dr!=null&&De.push(kA(M,dr,Tt)))),M=M.return}De.length!==0&&h.push({event:_,listeners:De})}var Ip=/\r\n?/g,Bs=/\u0000|\uFFFD/g;function Ty(h){return(typeof h=="string"?h:""+h).replace(Ip,`
`).replace(Bs,"")}function zA(h,_){return _=Ty(_),Ty(h)===_}function Zg(){}function ga(h,_,M,L,X,ie){switch(M){case"children":typeof L=="string"?_==="body"||_==="textarea"&&L===""||cl(h,L):(typeof L=="number"||typeof L=="bigint")&&_!=="body"&&cl(h,""+L);break;case"className":ri(h,"class",L);break;case"tabIndex":ri(h,"tabindex",L);break;case"dir":case"role":case"viewBox":case"width":case"height":ri(h,M,L);break;case"style":nu(h,L,ie);break;case"data":if(_!=="object"){ri(h,"data",L);break}case"src":case"href":if(L===""&&(_!=="a"||M!=="href")){h.removeAttribute(M);break}if(L==null||typeof L=="function"||typeof L=="symbol"||typeof L=="boolean"){h.removeAttribute(M);break}L=Fo(""+L),h.setAttribute(M,L);break;case"action":case"formAction":if(typeof L=="function"){h.setAttribute(M,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof ie=="function"&&(M==="formAction"?(_!=="input"&&ga(h,_,"name",X.name,X,null),ga(h,_,"formEncType",X.formEncType,X,null),ga(h,_,"formMethod",X.formMethod,X,null),ga(h,_,"formTarget",X.formTarget,X,null)):(ga(h,_,"encType",X.encType,X,null),ga(h,_,"method",X.method,X,null),ga(h,_,"target",X.target,X,null)));if(L==null||typeof L=="symbol"||typeof L=="boolean"){h.removeAttribute(M);break}L=Fo(""+L),h.setAttribute(M,L);break;case"onClick":L!=null&&(h.onclick=Zg);break;case"onScroll":L!=null&&Oo("scroll",h);break;case"onScrollEnd":L!=null&&Oo("scrollend",h);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(l(61));if(M=L.__html,M!=null){if(X.children!=null)throw Error(l(60));h.innerHTML=M}}break;case"multiple":h.multiple=L&&typeof L!="function"&&typeof L!="symbol";break;case"muted":h.muted=L&&typeof L!="function"&&typeof L!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(L==null||typeof L=="function"||typeof L=="boolean"||typeof L=="symbol"){h.removeAttribute("xlink:href");break}M=Fo(""+L),h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",M);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":L!=null&&typeof L!="function"&&typeof L!="symbol"?h.setAttribute(M,""+L):h.removeAttribute(M);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":L&&typeof L!="function"&&typeof L!="symbol"?h.setAttribute(M,""):h.removeAttribute(M);break;case"capture":case"download":L===!0?h.setAttribute(M,""):L!==!1&&L!=null&&typeof L!="function"&&typeof L!="symbol"?h.setAttribute(M,L):h.removeAttribute(M);break;case"cols":case"rows":case"size":case"span":L!=null&&typeof L!="function"&&typeof L!="symbol"&&!isNaN(L)&&1<=L?h.setAttribute(M,L):h.removeAttribute(M);break;case"rowSpan":case"start":L==null||typeof L=="function"||typeof L=="symbol"||isNaN(L)?h.removeAttribute(M):h.setAttribute(M,L);break;case"popover":Oo("beforetoggle",h),Oo("toggle",h),Ui(h,"popover",L);break;case"xlinkActuate":yn(h,"http://www.w3.org/1999/xlink","xlink:actuate",L);break;case"xlinkArcrole":yn(h,"http://www.w3.org/1999/xlink","xlink:arcrole",L);break;case"xlinkRole":yn(h,"http://www.w3.org/1999/xlink","xlink:role",L);break;case"xlinkShow":yn(h,"http://www.w3.org/1999/xlink","xlink:show",L);break;case"xlinkTitle":yn(h,"http://www.w3.org/1999/xlink","xlink:title",L);break;case"xlinkType":yn(h,"http://www.w3.org/1999/xlink","xlink:type",L);break;case"xmlBase":yn(h,"http://www.w3.org/XML/1998/namespace","xml:base",L);break;case"xmlLang":yn(h,"http://www.w3.org/XML/1998/namespace","xml:lang",L);break;case"xmlSpace":yn(h,"http://www.w3.org/XML/1998/namespace","xml:space",L);break;case"is":Ui(h,"is",L);break;case"innerText":case"textContent":break;default:(!(2<M.length)||M[0]!=="o"&&M[0]!=="O"||M[1]!=="n"&&M[1]!=="N")&&(M=dd.get(M)||M,Ui(h,M,L))}}function Ey(h,_,M,L,X,ie){switch(M){case"style":nu(h,L,ie);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(l(61));if(M=L.__html,M!=null){if(X.children!=null)throw Error(l(60));h.innerHTML=M}}break;case"children":typeof L=="string"?cl(h,L):(typeof L=="number"||typeof L=="bigint")&&cl(h,""+L);break;case"onScroll":L!=null&&Oo("scroll",h);break;case"onScrollEnd":L!=null&&Oo("scrollend",h);break;case"onClick":L!=null&&(h.onclick=Zg);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Un.hasOwnProperty(M))e:{if(M[0]==="o"&&M[1]==="n"&&(X=M.endsWith("Capture"),_=M.slice(2,X?M.length-7:void 0),ie=h[ge]||null,ie=ie!=null?ie[M]:null,typeof ie=="function"&&h.removeEventListener(_,ie,X),typeof L=="function")){typeof ie!="function"&&ie!==null&&(M in h?h[M]=null:h.hasAttribute(M)&&h.removeAttribute(M)),h.addEventListener(_,L,X);break e}M in h?h[M]=L:L===!0?h.setAttribute(M,""):Ui(h,M,L)}}}function zl(h,_,M){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Oo("error",h),Oo("load",h);var L=!1,X=!1,ie;for(ie in M)if(M.hasOwnProperty(ie)){var De=M[ie];if(De!=null)switch(ie){case"src":L=!0;break;case"srcSet":X=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,_));default:ga(h,_,ie,De,M,null)}}X&&ga(h,_,"srcSet",M.srcSet,M,null),L&&ga(h,_,"src",M.src,M,null);return;case"input":Oo("invalid",h);var Xe=ie=De=X=null,Tt=null,dr=null;for(L in M)if(M.hasOwnProperty(L)){var zr=M[L];if(zr!=null)switch(L){case"name":X=zr;break;case"type":De=zr;break;case"checked":Tt=zr;break;case"defaultChecked":dr=zr;break;case"value":ie=zr;break;case"defaultValue":Xe=zr;break;case"children":case"dangerouslySetInnerHTML":if(zr!=null)throw Error(l(137,_));break;default:ga(h,_,L,zr,M,null)}}Vl(h,ie,Xe,Tt,dr,De,X,!1),ru(h);return;case"select":Oo("invalid",h),L=De=ie=null;for(X in M)if(M.hasOwnProperty(X)&&(Xe=M[X],Xe!=null))switch(X){case"value":ie=Xe;break;case"defaultValue":De=Xe;break;case"multiple":L=Xe;default:ga(h,_,X,Xe,M,null)}_=ie,M=De,h.multiple=!!L,_!=null?oa(h,!!L,_,!1):M!=null&&oa(h,!!L,M,!0);return;case"textarea":Oo("invalid",h),ie=X=L=null;for(De in M)if(M.hasOwnProperty(De)&&(Xe=M[De],Xe!=null))switch(De){case"value":L=Xe;break;case"defaultValue":X=Xe;break;case"children":ie=Xe;break;case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(l(91));break;default:ga(h,_,De,Xe,M,null)}vl(h,L,X,ie),ru(h);return;case"option":for(Tt in M)if(M.hasOwnProperty(Tt)&&(L=M[Tt],L!=null))switch(Tt){case"selected":h.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:ga(h,_,Tt,L,M,null)}return;case"dialog":Oo("beforetoggle",h),Oo("toggle",h),Oo("cancel",h),Oo("close",h);break;case"iframe":case"object":Oo("load",h);break;case"video":case"audio":for(L=0;L<OA.length;L++)Oo(OA[L],h);break;case"image":Oo("error",h),Oo("load",h);break;case"details":Oo("toggle",h);break;case"embed":case"source":case"link":Oo("error",h),Oo("load",h);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(dr in M)if(M.hasOwnProperty(dr)&&(L=M[dr],L!=null))switch(dr){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,_));default:ga(h,_,dr,L,M,null)}return;default:if(fd(_)){for(zr in M)M.hasOwnProperty(zr)&&(L=M[zr],L!==void 0&&Ey(h,_,zr,L,M,void 0));return}}for(Xe in M)M.hasOwnProperty(Xe)&&(L=M[Xe],L!=null&&ga(h,_,Xe,L,M,null))}function LA(h,_,M,L){switch(_){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var X=null,ie=null,De=null,Xe=null,Tt=null,dr=null,zr=null;for(gr in M){var Zr=M[gr];if(M.hasOwnProperty(gr)&&Zr!=null)switch(gr){case"checked":break;case"value":break;case"defaultValue":Tt=Zr;default:L.hasOwnProperty(gr)||ga(h,_,gr,null,L,Zr)}}for(var Ar in L){var gr=L[Ar];if(Zr=M[Ar],L.hasOwnProperty(Ar)&&(gr!=null||Zr!=null))switch(Ar){case"type":ie=gr;break;case"name":X=gr;break;case"checked":dr=gr;break;case"defaultChecked":zr=gr;break;case"value":De=gr;break;case"defaultValue":Xe=gr;break;case"children":case"dangerouslySetInnerHTML":if(gr!=null)throw Error(l(137,_));break;default:gr!==Zr&&ga(h,_,Ar,gr,L,Zr)}}Df(h,De,Xe,Tt,dr,zr,ie,X);return;case"select":gr=De=Xe=Ar=null;for(ie in M)if(Tt=M[ie],M.hasOwnProperty(ie)&&Tt!=null)switch(ie){case"value":break;case"multiple":gr=Tt;default:L.hasOwnProperty(ie)||ga(h,_,ie,null,L,Tt)}for(X in L)if(ie=L[X],Tt=M[X],L.hasOwnProperty(X)&&(ie!=null||Tt!=null))switch(X){case"value":Ar=ie;break;case"defaultValue":Xe=ie;break;case"multiple":De=ie;default:ie!==Tt&&ga(h,_,X,ie,L,Tt)}_=Xe,M=De,L=gr,Ar!=null?oa(h,!!M,Ar,!1):!!L!=!!M&&(_!=null?oa(h,!!M,_,!0):oa(h,!!M,M?[]:"",!1));return;case"textarea":gr=Ar=null;for(Xe in M)if(X=M[Xe],M.hasOwnProperty(Xe)&&X!=null&&!L.hasOwnProperty(Xe))switch(Xe){case"value":break;case"children":break;default:ga(h,_,Xe,null,L,X)}for(De in L)if(X=L[De],ie=M[De],L.hasOwnProperty(De)&&(X!=null||ie!=null))switch(De){case"value":Ar=X;break;case"defaultValue":gr=X;break;case"children":break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(l(91));break;default:X!==ie&&ga(h,_,De,X,L,ie)}ll(h,Ar,gr);return;case"option":for(var Pi in M)if(Ar=M[Pi],M.hasOwnProperty(Pi)&&Ar!=null&&!L.hasOwnProperty(Pi))switch(Pi){case"selected":h.selected=!1;break;default:ga(h,_,Pi,null,L,Ar)}for(Tt in L)if(Ar=L[Tt],gr=M[Tt],L.hasOwnProperty(Tt)&&Ar!==gr&&(Ar!=null||gr!=null))switch(Tt){case"selected":h.selected=Ar&&typeof Ar!="function"&&typeof Ar!="symbol";break;default:ga(h,_,Tt,Ar,L,gr)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var li in M)Ar=M[li],M.hasOwnProperty(li)&&Ar!=null&&!L.hasOwnProperty(li)&&ga(h,_,li,null,L,Ar);for(dr in L)if(Ar=L[dr],gr=M[dr],L.hasOwnProperty(dr)&&Ar!==gr&&(Ar!=null||gr!=null))switch(dr){case"children":case"dangerouslySetInnerHTML":if(Ar!=null)throw Error(l(137,_));break;default:ga(h,_,dr,Ar,L,gr)}return;default:if(fd(_)){for(var Yo in M)Ar=M[Yo],M.hasOwnProperty(Yo)&&Ar!==void 0&&!L.hasOwnProperty(Yo)&&Ey(h,_,Yo,void 0,L,Ar);for(zr in L)Ar=L[zr],gr=M[zr],!L.hasOwnProperty(zr)||Ar===gr||Ar===void 0&&gr===void 0||Ey(h,_,zr,Ar,L,gr);return}}for(var Yt in M)Ar=M[Yt],M.hasOwnProperty(Yt)&&Ar!=null&&!L.hasOwnProperty(Yt)&&ga(h,_,Yt,null,L,Ar);for(Zr in L)Ar=L[Zr],gr=M[Zr],!L.hasOwnProperty(Zr)||Ar===gr||Ar==null&&gr==null||ga(h,_,Zr,Ar,L,gr)}var Xg=null,Fd=null;function Pp(h){return h.nodeType===9?h:h.ownerDocument}function Hx(h){switch(h){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qx(h,_){if(h===0)switch(_){case"svg":return 1;case"math":return 2;default:return 0}return h===1&&_==="foreignObject"?0:h}function Cy(h,_){return h==="textarea"||h==="noscript"||typeof _.children=="string"||typeof _.children=="number"||typeof _.children=="bigint"||typeof _.dangerouslySetInnerHTML=="object"&&_.dangerouslySetInnerHTML!==null&&_.dangerouslySetInnerHTML.__html!=null}var My=null;function j2(){var h=window.event;return h&&h.type==="popstate"?h===My?!1:(My=h,!0):(My=null,!1)}var Wx=typeof setTimeout=="function"?setTimeout:void 0,U2=typeof clearTimeout=="function"?clearTimeout:void 0,Yg=typeof Promise=="function"?Promise:void 0,V2=typeof queueMicrotask=="function"?queueMicrotask:typeof Yg<"u"?function(h){return Yg.resolve(null).then(h).catch(Zx)}:Wx;function Zx(h){setTimeout(function(){throw h})}function Sh(h){return h==="head"}function Xx(h,_){var M=_,L=0,X=0;do{var ie=M.nextSibling;if(h.removeChild(M),ie&&ie.nodeType===8)if(M=ie.data,M==="/$"){if(0<L&&8>L){M=L;var De=h.ownerDocument;if(M&1&&Sm(De.documentElement),M&2&&Sm(De.body),M&4)for(M=De.head,Sm(M),De=M.firstChild;De;){var Xe=De.nextSibling,Tt=De.nodeName;De[Je]||Tt==="SCRIPT"||Tt==="STYLE"||Tt==="LINK"&&De.rel.toLowerCase()==="stylesheet"||M.removeChild(De),De=Xe}}if(X===0){h.removeChild(ie),GA(_);return}X--}else M==="$"||M==="$?"||M==="$!"?X++:L=M.charCodeAt(0)-48;else L=0;M=ie}while(M);GA(_)}function Na(h){var _=h.firstChild;for(_&&_.nodeType===10&&(_=_.nextSibling);_;){var M=_;switch(_=_.nextSibling,M.nodeName){case"HTML":case"HEAD":case"BODY":Na(M),vt(M);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(M.rel.toLowerCase()==="stylesheet")continue}h.removeChild(M)}}function BA(h,_,M,L){for(;h.nodeType===1;){var X=M;if(h.nodeName.toLowerCase()!==_.toLowerCase()){if(!L&&(h.nodeName!=="INPUT"||h.type!=="hidden"))break}else if(L){if(!h[Je])switch(_){case"meta":if(!h.hasAttribute("itemprop"))break;return h;case"link":if(ie=h.getAttribute("rel"),ie==="stylesheet"&&h.hasAttribute("data-precedence"))break;if(ie!==X.rel||h.getAttribute("href")!==(X.href==null||X.href===""?null:X.href)||h.getAttribute("crossorigin")!==(X.crossOrigin==null?null:X.crossOrigin)||h.getAttribute("title")!==(X.title==null?null:X.title))break;return h;case"style":if(h.hasAttribute("data-precedence"))break;return h;case"script":if(ie=h.getAttribute("src"),(ie!==(X.src==null?null:X.src)||h.getAttribute("type")!==(X.type==null?null:X.type)||h.getAttribute("crossorigin")!==(X.crossOrigin==null?null:X.crossOrigin))&&ie&&h.hasAttribute("async")&&!h.hasAttribute("itemprop"))break;return h;default:return h}}else if(_==="input"&&h.type==="hidden"){var ie=X.name==null?null:""+X.name;if(X.type==="hidden"&&h.getAttribute("name")===ie)return h}else return h;if(h=dc(h.nextSibling),h===null)break}return null}function Yx(h,_,M){if(_==="")return null;for(;h.nodeType!==3;)if((h.nodeType!==1||h.nodeName!=="INPUT"||h.type!=="hidden")&&!M||(h=dc(h.nextSibling),h===null))return null;return h}function FA(h){return h.data==="$!"||h.data==="$?"&&h.ownerDocument.readyState==="complete"}function Qg(h,_){var M=h.ownerDocument;if(h.data!=="$?"||M.readyState==="complete")_();else{var L=function(){_(),M.removeEventListener("DOMContentLoaded",L)};M.addEventListener("DOMContentLoaded",L),h._reactRetry=L}}function dc(h){for(;h!=null;h=h.nextSibling){var _=h.nodeType;if(_===1||_===3)break;if(_===8){if(_=h.data,_==="$"||_==="$!"||_==="$?"||_==="F!"||_==="F")break;if(_==="/$")return null}}return h}var Kg=null;function Iy(h){h=h.previousSibling;for(var _=0;h;){if(h.nodeType===8){var M=h.data;if(M==="$"||M==="$!"||M==="$?"){if(_===0)return h;_--}else M==="/$"&&_++}h=h.previousSibling}return null}function NA(h,_,M){switch(_=Pp(M),h){case"html":if(h=_.documentElement,!h)throw Error(l(452));return h;case"head":if(h=_.head,!h)throw Error(l(453));return h;case"body":if(h=_.body,!h)throw Error(l(454));return h;default:throw Error(l(451))}}function Sm(h){for(var _=h.attributes;_.length;)h.removeAttributeNode(_[0]);vt(h)}var Ql=new Map,Qx=new Set;function O0(h){return typeof h.getRootNode=="function"?h.getRootNode():h.nodeType===9?h:h.ownerDocument}var mf=Zt.d;Zt.d={f:Py,r:Kx,D:pc,C:e1,L:t1,m:r1,X:$2,S:Jg,M:G2};function Py(){var h=mf.f(),_=Yl();return h||_}function Kx(h){var _=kt(h);_!==null&&_.tag===5&&_.type==="form"?_0(_):mf.r(h)}var Hc=typeof document>"u"?null:document;function Jx(h,_,M){var L=Hc;if(L&&typeof _=="string"&&_){var X=As(_);X='link[rel="'+h+'"][href="'+X+'"]',typeof M=="string"&&(X+='[crossorigin="'+M+'"]'),Qx.has(X)||(Qx.add(X),h={rel:h,crossOrigin:M,href:_},L.querySelector(X)===null&&(_=L.createElement("link"),zl(_,"link",h),wr(_),L.head.appendChild(_)))}}function pc(h){mf.D(h),Jx("dns-prefetch",h,null)}function e1(h,_){mf.C(h,_),Jx("preconnect",h,_)}function t1(h,_,M){mf.L(h,_,M);var L=Hc;if(L&&h&&_){var X='link[rel="preload"][as="'+As(_)+'"]';_==="image"&&M&&M.imageSrcSet?(X+='[imagesrcset="'+As(M.imageSrcSet)+'"]',typeof M.imageSizes=="string"&&(X+='[imagesizes="'+As(M.imageSizes)+'"]')):X+='[href="'+As(h)+'"]';var ie=X;switch(_){case"style":ie=Tm(h);break;case"script":ie=Cm(h)}Ql.has(ie)||(h=F({rel:"preload",href:_==="image"&&M&&M.imageSrcSet?void 0:h,as:_},M),Ql.set(ie,h),L.querySelector(X)!==null||_==="style"&&L.querySelector(Em(ie))||_==="script"&&L.querySelector(jA(ie))||(_=L.createElement("link"),zl(_,"link",h),wr(_),L.head.appendChild(_)))}}function r1(h,_){mf.m(h,_);var M=Hc;if(M&&h){var L=_&&typeof _.as=="string"?_.as:"script",X='link[rel="modulepreload"][as="'+As(L)+'"][href="'+As(h)+'"]',ie=X;switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":ie=Cm(h)}if(!Ql.has(ie)&&(h=F({rel:"modulepreload",href:h},_),Ql.set(ie,h),M.querySelector(X)===null)){switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(M.querySelector(jA(ie)))return}L=M.createElement("link"),zl(L,"link",h),wr(L),M.head.appendChild(L)}}}function Jg(h,_,M){mf.S(h,_,M);var L=Hc;if(L&&h){var X=Dr(L).hoistableStyles,ie=Tm(h);_=_||"default";var De=X.get(ie);if(!De){var Xe={loading:0,preload:null};if(De=L.querySelector(Em(ie)))Xe.loading=5;else{h=F({rel:"stylesheet",href:h,"data-precedence":_},M),(M=Ql.get(ie))&&Th(h,M);var Tt=De=L.createElement("link");wr(Tt),zl(Tt,"link",h),Tt._p=new Promise(function(dr,zr){Tt.onload=dr,Tt.onerror=zr}),Tt.addEventListener("load",function(){Xe.loading|=1}),Tt.addEventListener("error",function(){Xe.loading|=2}),Xe.loading|=4,Mm(De,_,L)}De={type:"stylesheet",instance:De,count:1,state:Xe},X.set(ie,De)}}}function $2(h,_){mf.X(h,_);var M=Hc;if(M&&h){var L=Dr(M).hoistableScripts,X=Cm(h),ie=L.get(X);ie||(ie=M.querySelector(jA(X)),ie||(h=F({src:h,async:!0},_),(_=Ql.get(X))&&r_(h,_),ie=M.createElement("script"),wr(ie),zl(ie,"link",h),M.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},L.set(X,ie))}}function G2(h,_){mf.M(h,_);var M=Hc;if(M&&h){var L=Dr(M).hoistableScripts,X=Cm(h),ie=L.get(X);ie||(ie=M.querySelector(jA(X)),ie||(h=F({src:h,async:!0,type:"module"},_),(_=Ql.get(X))&&r_(h,_),ie=M.createElement("script"),wr(ie),zl(ie,"link",h),M.head.appendChild(ie)),ie={type:"script",instance:ie,count:1,state:null},L.set(X,ie))}}function e_(h,_,M,L){var X=(X=Hr.current)?O0(X):null;if(!X)throw Error(l(446));switch(h){case"meta":case"title":return null;case"style":return typeof M.precedence=="string"&&typeof M.href=="string"?(_=Tm(M.href),M=Dr(X).hoistableStyles,L=M.get(_),L||(L={type:"style",instance:null,count:0,state:null},M.set(_,L)),L):{type:"void",instance:null,count:0,state:null};case"link":if(M.rel==="stylesheet"&&typeof M.href=="string"&&typeof M.precedence=="string"){h=Tm(M.href);var ie=Dr(X).hoistableStyles,De=ie.get(h);if(De||(X=X.ownerDocument||X,De={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},ie.set(h,De),(ie=X.querySelector(Em(h)))&&!ie._p&&(De.instance=ie,De.state.loading=5),Ql.has(h)||(M={rel:"preload",as:"style",href:M.href,crossOrigin:M.crossOrigin,integrity:M.integrity,media:M.media,hrefLang:M.hrefLang,referrerPolicy:M.referrerPolicy},Ql.set(h,M),ie||n1(X,h,M,De.state))),_&&L===null)throw Error(l(528,""));return De}if(_&&L!==null)throw Error(l(529,""));return null;case"script":return _=M.async,M=M.src,typeof M=="string"&&_&&typeof _!="function"&&typeof _!="symbol"?(_=Cm(M),M=Dr(X).hoistableScripts,L=M.get(_),L||(L={type:"script",instance:null,count:0,state:null},M.set(_,L)),L):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,h))}}function Tm(h){return'href="'+As(h)+'"'}function Em(h){return'link[rel="stylesheet"]['+h+"]"}function t_(h){return F({},h,{"data-precedence":h.precedence,precedence:null})}function n1(h,_,M,L){h.querySelector('link[rel="preload"][as="style"]['+_+"]")?L.loading=1:(_=h.createElement("link"),L.preload=_,_.addEventListener("load",function(){return L.loading|=1}),_.addEventListener("error",function(){return L.loading|=2}),zl(_,"link",M),wr(_),h.head.appendChild(_))}function Cm(h){return'[src="'+As(h)+'"]'}function jA(h){return"script[async]"+h}function Ry(h,_,M){if(_.count++,_.instance===null)switch(_.type){case"style":var L=h.querySelector('style[data-href~="'+As(M.href)+'"]');if(L)return _.instance=L,wr(L),L;var X=F({},M,{"data-href":M.href,"data-precedence":M.precedence,href:null,precedence:null});return L=(h.ownerDocument||h).createElement("style"),wr(L),zl(L,"style",X),Mm(L,M.precedence,h),_.instance=L;case"stylesheet":X=Tm(M.href);var ie=h.querySelector(Em(X));if(ie)return _.state.loading|=4,_.instance=ie,wr(ie),ie;L=t_(M),(X=Ql.get(X))&&Th(L,X),ie=(h.ownerDocument||h).createElement("link"),wr(ie);var De=ie;return De._p=new Promise(function(Xe,Tt){De.onload=Xe,De.onerror=Tt}),zl(ie,"link",L),_.state.loading|=4,Mm(ie,M.precedence,h),_.instance=ie;case"script":return ie=Cm(M.src),(X=h.querySelector(jA(ie)))?(_.instance=X,wr(X),X):(L=M,(X=Ql.get(ie))&&(L=F({},M),r_(L,X)),h=h.ownerDocument||h,X=h.createElement("script"),wr(X),zl(X,"link",L),h.head.appendChild(X),_.instance=X);case"void":return null;default:throw Error(l(443,_.type))}else _.type==="stylesheet"&&(_.state.loading&4)===0&&(L=_.instance,_.state.loading|=4,Mm(L,M.precedence,h));return _.instance}function Mm(h,_,M){for(var L=M.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),X=L.length?L[L.length-1]:null,ie=X,De=0;De<L.length;De++){var Xe=L[De];if(Xe.dataset.precedence===_)ie=Xe;else if(ie!==X)break}ie?ie.parentNode.insertBefore(h,ie.nextSibling):(_=M.nodeType===9?M.head:M,_.insertBefore(h,_.firstChild))}function Th(h,_){h.crossOrigin==null&&(h.crossOrigin=_.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=_.referrerPolicy),h.title==null&&(h.title=_.title)}function r_(h,_){h.crossOrigin==null&&(h.crossOrigin=_.crossOrigin),h.referrerPolicy==null&&(h.referrerPolicy=_.referrerPolicy),h.integrity==null&&(h.integrity=_.integrity)}var n_=null;function i1(h,_,M){if(n_===null){var L=new Map,X=n_=new Map;X.set(M,L)}else X=n_,L=X.get(M),L||(L=new Map,X.set(M,L));if(L.has(h))return L;for(L.set(h,null),M=M.getElementsByTagName(h),X=0;X<M.length;X++){var ie=M[X];if(!(ie[Je]||ie[le]||h==="link"&&ie.getAttribute("rel")==="stylesheet")&&ie.namespaceURI!=="http://www.w3.org/2000/svg"){var De=ie.getAttribute(_)||"";De=h+De;var Xe=L.get(De);Xe?Xe.push(ie):L.set(De,[ie])}}return L}function o1(h,_,M){h=h.ownerDocument||h,h.head.insertBefore(M,_==="title"?h.querySelector("head > title"):null)}function H2(h,_,M){if(M===1||_.itemProp!=null)return!1;switch(h){case"meta":case"title":return!0;case"style":if(typeof _.precedence!="string"||typeof _.href!="string"||_.href==="")break;return!0;case"link":if(typeof _.rel!="string"||typeof _.href!="string"||_.href===""||_.onLoad||_.onError)break;switch(_.rel){case"stylesheet":return h=_.disabled,typeof _.precedence=="string"&&h==null;default:return!0}case"script":if(_.async&&typeof _.async!="function"&&typeof _.async!="symbol"&&!_.onLoad&&!_.onError&&_.src&&typeof _.src=="string")return!0}return!1}function a1(h){return!(h.type==="stylesheet"&&(h.state.loading&3)===0)}var k0=null;function q2(){}function z0(h,_,M){if(k0===null)throw Error(l(475));var L=k0;if(_.type==="stylesheet"&&(typeof M.media!="string"||matchMedia(M.media).matches!==!1)&&(_.state.loading&4)===0){if(_.instance===null){var X=Tm(M.href),ie=h.querySelector(Em(X));if(ie){h=ie._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(L.count++,L=L0.bind(L),h.then(L,L)),_.state.loading|=4,_.instance=ie,wr(ie);return}ie=h.ownerDocument||h,M=t_(M),(X=Ql.get(X))&&Th(M,X),ie=ie.createElement("link"),wr(ie);var De=ie;De._p=new Promise(function(Xe,Tt){De.onload=Xe,De.onerror=Tt}),zl(ie,"link",M),_.instance=ie}L.stylesheets===null&&(L.stylesheets=new Map),L.stylesheets.set(_,h),(h=_.state.preload)&&(_.state.loading&3)===0&&(L.count++,_=L0.bind(L),h.addEventListener("load",_),h.addEventListener("error",_))}}function s1(){if(k0===null)throw Error(l(475));var h=k0;return h.stylesheets&&h.count===0&&i_(h,h.stylesheets),0<h.count?function(_){var M=setTimeout(function(){if(h.stylesheets&&i_(h,h.stylesheets),h.unsuspend){var L=h.unsuspend;h.unsuspend=null,L()}},6e4);return h.unsuspend=_,function(){h.unsuspend=null,clearTimeout(M)}}:null}function L0(){if(this.count--,this.count===0){if(this.stylesheets)i_(this,this.stylesheets);else if(this.unsuspend){var h=this.unsuspend;this.unsuspend=null,h()}}}var Im=null;function i_(h,_){h.stylesheets=null,h.unsuspend!==null&&(h.count++,Im=new Map,_.forEach(Dy,h),Im=null,L0.call(h))}function Dy(h,_){if(!(_.state.loading&4)){var M=Im.get(h);if(M)var L=M.get(null);else{M=new Map,Im.set(h,M);for(var X=h.querySelectorAll("link[data-precedence],style[data-precedence]"),ie=0;ie<X.length;ie++){var De=X[ie];(De.nodeName==="LINK"||De.getAttribute("media")!=="not all")&&(M.set(De.dataset.precedence,De),L=De)}L&&M.set(null,L)}X=_.instance,De=X.getAttribute("data-precedence"),ie=M.get(De)||L,ie===L&&M.set(null,X),M.set(De,X),this.count++,L=L0.bind(this),X.addEventListener("load",L),X.addEventListener("error",L),ie?ie.parentNode.insertBefore(X,ie.nextSibling):(h=h.nodeType===9?h.head:h,h.insertBefore(X,h.firstChild)),_.state.loading|=4}}var Rp={$$typeof:ve,Provider:null,Consumer:null,_currentValue:ir,_currentValue2:ir,_threadCount:0};function l1(h,_,M,L,X,ie,De,Xe){this.tag=1,this.containerInfo=h,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bc(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bc(0),this.hiddenUpdates=bc(null),this.identifierPrefix=L,this.onUncaughtError=X,this.onCaughtError=ie,this.onRecoverableError=De,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Xe,this.incompleteTransitions=new Map}function c1(h,_,M,L,X,ie,De,Xe,Tt,dr,zr,Zr){return h=new l1(h,_,M,De,Xe,Tt,dr,Zr),_=1,ie===!0&&(_|=24),ie=Dn(3,null,null,_),h.current=ie,ie.stateNode=h,_=Pa(),_.refCount++,h.pooledCache=_,_.refCount++,ie.memoizedState={element:L,isDehydrated:M,cache:_},O(ie),h}function o_(h){return h?(h=Dc,h):Dc}function Oy(h,_,M,L,X,ie){X=o_(X),L.context===null?L.context=X:L.pendingContext=X,L=V(_),L.payload={element:M},ie=ie===void 0?null:ie,ie!==null&&(L.callback=ie),M=Z(h,L,_),M!==null&&(xa(M,h,_),re(M,h,_))}function ky(h,_){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var M=h.retryLane;h.retryLane=M!==0&&M<_?M:_}}function B0(h,_){ky(h,_),(h=h.alternate)&&ky(h,_)}function a_(h){if(h.tag===13){var _=Rc(h,67108864);_!==null&&xa(_,h,67108864),B0(h,67108864)}}var F0=!0;function zy(h,_,M,L){var X=et.T;et.T=null;var ie=Zt.p;try{Zt.p=2,Ly(h,_,M,L)}finally{Zt.p=ie,et.T=X}}function W2(h,_,M,L){var X=et.T;et.T=null;var ie=Zt.p;try{Zt.p=8,Ly(h,_,M,L)}finally{Zt.p=ie,et.T=X}}function Ly(h,_,M,L){if(F0){var X=By(L);if(X===null)qg(h,_,L,s_,M),h1(h,L);else if(Fy(X,h,_,M,L))L.stopPropagation();else if(h1(h,L),_&4&&-1<u1.indexOf(h)){for(;X!==null;){var ie=kt(X);if(ie!==null)switch(ie.tag){case 3:if(ie=ie.stateNode,ie.current.memoizedState.isDehydrated){var De=$n(ie.pendingLanes);if(De!==0){var Xe=ie;for(Xe.pendingLanes|=2,Xe.entangledLanes|=2;De;){var Tt=1<<31-to(De);Xe.entanglements[1]|=Tt,De&=~Tt}Gc(ie),(gt&6)===0&&(Ai=di()+500,Mp(0))}}break;case 13:Xe=Rc(ie,2),Xe!==null&&xa(Xe,ie,2),Yl(),B0(ie,2)}if(ie=By(L),ie===null&&qg(h,_,L,s_,M),ie===X)break;X=ie}X!==null&&L.stopPropagation()}else qg(h,_,L,null,M)}}function By(h){return h=ou(h),l_(h)}var s_=null;function l_(h){if(s_=null,h=Lt(h),h!==null){var _=y(h);if(_===null)h=null;else{var M=_.tag;if(M===13){if(h=T(_),h!==null)return h;h=null}else if(M===3){if(_.stateNode.current.memoizedState.isDehydrated)return _.tag===3?_.stateNode.containerInfo:null;h=null}else _!==h&&(h=null)}}return s_=h,null}function Nd(h){switch(h){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ao()){case eo:return 2;case $o:return 8;case _i:case Bn:return 32;case Ca:return 268435456;default:return 32}default:return 32}}var Pm=!1,Eh=null,Af=null,Ch=null,UA=new Map,VA=new Map,jd=[],u1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function h1(h,_){switch(h){case"focusin":case"focusout":Eh=null;break;case"dragenter":case"dragleave":Af=null;break;case"mouseover":case"mouseout":Ch=null;break;case"pointerover":case"pointerout":UA.delete(_.pointerId);break;case"gotpointercapture":case"lostpointercapture":VA.delete(_.pointerId)}}function N0(h,_,M,L,X,ie){return h===null||h.nativeEvent!==ie?(h={blockedOn:_,domEventName:M,eventSystemFlags:L,nativeEvent:ie,targetContainers:[X]},_!==null&&(_=kt(_),_!==null&&a_(_)),h):(h.eventSystemFlags|=L,_=h.targetContainers,X!==null&&_.indexOf(X)===-1&&_.push(X),h)}function Fy(h,_,M,L,X){switch(_){case"focusin":return Eh=N0(Eh,h,_,M,L,X),!0;case"dragenter":return Af=N0(Af,h,_,M,L,X),!0;case"mouseover":return Ch=N0(Ch,h,_,M,L,X),!0;case"pointerover":var ie=X.pointerId;return UA.set(ie,N0(UA.get(ie)||null,h,_,M,L,X)),!0;case"gotpointercapture":return ie=X.pointerId,VA.set(ie,N0(VA.get(ie)||null,h,_,M,L,X)),!0}return!1}function j0(h){var _=Lt(h.target);if(_!==null){var M=y(_);if(M!==null){if(_=M.tag,_===13){if(_=T(M),_!==null){h.blockedOn=_,Xu(h.priority,function(){if(M.tag===13){var L=qo();L=rr(L);var X=Rc(M,L);X!==null&&xa(X,M,L),B0(M,L)}});return}}else if(_===3&&M.stateNode.current.memoizedState.isDehydrated){h.blockedOn=M.tag===3?M.stateNode.containerInfo:null;return}}}h.blockedOn=null}function U0(h){if(h.blockedOn!==null)return!1;for(var _=h.targetContainers;0<_.length;){var M=By(h.nativeEvent);if(M===null){M=h.nativeEvent;var L=new M.constructor(M.type,M);iu=L,M.target.dispatchEvent(L),iu=null}else return _=kt(M),_!==null&&a_(_),h.blockedOn=M,!1;_.shift()}return!0}function f1(h,_,M){U0(h)&&M.delete(_)}function d1(){Pm=!1,Eh!==null&&U0(Eh)&&(Eh=null),Af!==null&&U0(Af)&&(Af=null),Ch!==null&&U0(Ch)&&(Ch=null),UA.forEach(f1),VA.forEach(f1)}function $A(h,_){h.blockedOn===_&&(h.blockedOn=null,Pm||(Pm=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,d1)))}var V0=null;function Ny(h){V0!==h&&(V0=h,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){V0===h&&(V0=null);for(var _=0;_<h.length;_+=3){var M=h[_],L=h[_+1],X=h[_+2];if(typeof L!="function"){if(l_(L||M)===null)continue;break}var ie=kt(M);ie!==null&&(h.splice(_,3),_-=3,mp(ie,{pending:!0,data:X,method:M.method,action:L},L,X))}}))}function GA(h){function _(Tt){return $A(Tt,h)}Eh!==null&&$A(Eh,h),Af!==null&&$A(Af,h),Ch!==null&&$A(Ch,h),UA.forEach(_),VA.forEach(_);for(var M=0;M<jd.length;M++){var L=jd[M];L.blockedOn===h&&(L.blockedOn=null)}for(;0<jd.length&&(M=jd[0],M.blockedOn===null);)j0(M),M.blockedOn===null&&jd.shift();if(M=(h.ownerDocument||h).$$reactFormReplay,M!=null)for(L=0;L<M.length;L+=3){var X=M[L],ie=M[L+1],De=X[ge]||null;if(typeof ie=="function")De||Ny(M);else if(De){var Xe=null;if(ie&&ie.hasAttribute("formAction")){if(X=ie,De=ie[ge]||null)Xe=De.formAction;else if(l_(X)!==null)continue}else Xe=De.action;typeof Xe=="function"?M[L+1]=Xe:(M.splice(L,3),L-=3),Ny(M)}}}function c_(h){this._internalRoot=h}$0.prototype.render=c_.prototype.render=function(h){var _=this._internalRoot;if(_===null)throw Error(l(409));var M=_.current,L=qo();Oy(M,L,h,_,null,null)},$0.prototype.unmount=c_.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var _=h.containerInfo;Oy(h.current,2,null,h,null,null),Yl(),_[Me]=null}};function $0(h){this._internalRoot=h}$0.prototype.unstable_scheduleHydration=function(h){if(h){var _=kh();h={blockedOn:null,target:h,priority:_};for(var M=0;M<jd.length&&_!==0&&_<jd[M].priority;M++);jd.splice(M,0,h),M===0&&j0(h)}};var p1=r.version;if(p1!=="19.1.1")throw Error(l(527,p1,"19.1.1"));Zt.findDOMNode=function(h){var _=h._reactInternals;if(_===void 0)throw typeof h.render=="function"?Error(l(188)):(h=Object.keys(h).join(","),Error(l(268,h)));return h=z(_),h=h!==null?B(h):null,h=h===null?null:h.stateNode,h};var m1={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:et,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var G0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!G0.isDisabled&&G0.supportsFiber)try{ao=G0.inject(m1),ai=G0}catch{}}return Av.createRoot=function(h,_){if(!m(h))throw Error(l(299));var M=!1,L="",X=xA,ie=vp,De=Xf,Xe=null;return _!=null&&(_.unstable_strictMode===!0&&(M=!0),_.identifierPrefix!==void 0&&(L=_.identifierPrefix),_.onUncaughtError!==void 0&&(X=_.onUncaughtError),_.onCaughtError!==void 0&&(ie=_.onCaughtError),_.onRecoverableError!==void 0&&(De=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Xe=_.unstable_transitionCallbacks)),_=c1(h,1,!1,null,null,M,L,X,ie,De,Xe,null),h[Me]=_.current,Hg(h),new c_(_)},Av.hydrateRoot=function(h,_,M){if(!m(h))throw Error(l(299));var L=!1,X="",ie=xA,De=vp,Xe=Xf,Tt=null,dr=null;return M!=null&&(M.unstable_strictMode===!0&&(L=!0),M.identifierPrefix!==void 0&&(X=M.identifierPrefix),M.onUncaughtError!==void 0&&(ie=M.onUncaughtError),M.onCaughtError!==void 0&&(De=M.onCaughtError),M.onRecoverableError!==void 0&&(Xe=M.onRecoverableError),M.unstable_transitionCallbacks!==void 0&&(Tt=M.unstable_transitionCallbacks),M.formState!==void 0&&(dr=M.formState)),_=c1(h,1,!0,_,M??null,L,X,ie,De,Xe,Tt,dr),_.context=o_(null),M=_.current,L=qo(),L=rr(L),X=V(L),X.callback=null,Z(M,X,L),M=L,_.current.lanes=M,Gs(_,M),Gc(_),h[Me]=_.current,Hg(h),new $0(_)},Av.version="19.1.1",Av}var MO;function uY(){if(MO)return nT.exports;MO=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),nT.exports=cY(),nT.exports}var hY=uY();/**
 * react-router v7.9.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var IO="popstate";function fY(e={}){function r(m,y){let{pathname:T="/",search:i="",hash:z=""}=bg(m.location.hash.substring(1));return!T.startsWith("/")&&!T.startsWith(".")&&(T="/"+T),sC("",{pathname:T,search:i,hash:z},y.state&&y.state.usr||null,y.state&&y.state.key||"default")}function a(m,y){let T=m.document.querySelector("base"),i="";if(T&&T.getAttribute("href")){let z=m.location.href,B=z.indexOf("#");i=B===-1?z:z.slice(0,B)}return i+"#"+(typeof y=="string"?y:qv(y))}function l(m,y){Ef(m.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(y)})`)}return pY(r,a,l,e)}function ms(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function Ef(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function dY(){return Math.random().toString(36).substring(2,10)}function PO(e,r){return{usr:e.state,key:e.key,idx:r}}function sC(e,r,a=null,l){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?bg(r):r,state:a,key:r&&r.key||l||dY()}}function qv({pathname:e="/",search:r="",hash:a=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),a&&a!=="#"&&(e+=a.charAt(0)==="#"?a:"#"+a),e}function bg(e){let r={};if(e){let a=e.indexOf("#");a>=0&&(r.hash=e.substring(a),e=e.substring(0,a));let l=e.indexOf("?");l>=0&&(r.search=e.substring(l),e=e.substring(0,l)),e&&(r.pathname=e)}return r}function pY(e,r,a,l={}){let{window:m=document.defaultView,v5Compat:y=!1}=l,T=m.history,i="POP",z=null,B=F();B==null&&(B=0,T.replaceState({...T.state,idx:B},""));function F(){return(T.state||{idx:null}).idx}function G(){i="POP";let ue=F(),ye=ue==null?null:ue-B;B=ue,z&&z({action:i,location:oe.location,delta:ye})}function Q(ue,ye){i="PUSH";let we=sC(oe.location,ue,ye);a&&a(we,ue),B=F()+1;let ve=PO(we,B),Ce=oe.createHref(we);try{T.pushState(ve,"",Ce)}catch(Ee){if(Ee instanceof DOMException&&Ee.name==="DataCloneError")throw Ee;m.location.assign(Ce)}y&&z&&z({action:i,location:oe.location,delta:1})}function te(ue,ye){i="REPLACE";let we=sC(oe.location,ue,ye);a&&a(we,ue),B=F();let ve=PO(we,B),Ce=oe.createHref(we);T.replaceState(ve,"",Ce),y&&z&&z({action:i,location:oe.location,delta:0})}function ne(ue){return mY(ue)}let oe={get action(){return i},get location(){return e(m,T)},listen(ue){if(z)throw new Error("A history only accepts one active listener");return m.addEventListener(IO,G),z=ue,()=>{m.removeEventListener(IO,G),z=null}},createHref(ue){return r(m,ue)},createURL:ne,encodeLocation(ue){let ye=ne(ue);return{pathname:ye.pathname,search:ye.search,hash:ye.hash}},push:Q,replace:te,go(ue){return T.go(ue)}};return oe}function mY(e,r=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),ms(a,"No window.location.(origin|href) available to create URL");let l=typeof e=="string"?e:qv(e);return l=l.replace(/ $/,"%20"),!r&&l.startsWith("//")&&(l=a+l),new URL(l,a)}function KB(e,r,a="/"){return AY(e,r,a,!1)}function AY(e,r,a,l){let m=typeof r=="string"?bg(r):r,y=qm(m.pathname||"/",a);if(y==null)return null;let T=JB(e);gY(T);let i=null;for(let z=0;i==null&&z<T.length;++z){let B=MY(y);i=EY(T[z],B,l)}return i}function JB(e,r=[],a=[],l="",m=!1){let y=(T,i,z=m,B)=>{let F={relativePath:B===void 0?T.path||"":B,caseSensitive:T.caseSensitive===!0,childrenIndex:i,route:T};if(F.relativePath.startsWith("/")){if(!F.relativePath.startsWith(l)&&z)return;ms(F.relativePath.startsWith(l),`Absolute route path "${F.relativePath}" nested under path "${l}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),F.relativePath=F.relativePath.slice(l.length)}let G=jm([l,F.relativePath]),Q=a.concat(F);T.children&&T.children.length>0&&(ms(T.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${G}".`),JB(T.children,r,Q,G,z)),!(T.path==null&&!T.index)&&r.push({path:G,score:SY(G,T.index),routesMeta:Q})};return e.forEach((T,i)=>{if(T.path===""||!T.path?.includes("?"))y(T,i);else for(let z of e5(T.path))y(T,i,!0,z)}),r}function e5(e){let r=e.split("/");if(r.length===0)return[];let[a,...l]=r,m=a.endsWith("?"),y=a.replace(/\?$/,"");if(l.length===0)return m?[y,""]:[y];let T=e5(l.join("/")),i=[];return i.push(...T.map(z=>z===""?y:[y,z].join("/"))),m&&i.push(...T),i.map(z=>e.startsWith("/")&&z===""?"/":z)}function gY(e){e.sort((r,a)=>r.score!==a.score?a.score-r.score:TY(r.routesMeta.map(l=>l.childrenIndex),a.routesMeta.map(l=>l.childrenIndex)))}var _Y=/^:[\w-]+$/,yY=3,vY=2,xY=1,bY=10,wY=-2,RO=e=>e==="*";function SY(e,r){let a=e.split("/"),l=a.length;return a.some(RO)&&(l+=wY),r&&(l+=vY),a.filter(m=>!RO(m)).reduce((m,y)=>m+(_Y.test(y)?yY:y===""?xY:bY),l)}function TY(e,r){return e.length===r.length&&e.slice(0,-1).every((l,m)=>l===r[m])?e[e.length-1]-r[r.length-1]:0}function EY(e,r,a=!1){let{routesMeta:l}=e,m={},y="/",T=[];for(let i=0;i<l.length;++i){let z=l[i],B=i===l.length-1,F=y==="/"?r:r.slice(y.length)||"/",G=Gb({path:z.relativePath,caseSensitive:z.caseSensitive,end:B},F),Q=z.route;if(!G&&B&&a&&!l[l.length-1].route.index&&(G=Gb({path:z.relativePath,caseSensitive:z.caseSensitive,end:!1},F)),!G)return null;Object.assign(m,G.params),T.push({params:m,pathname:jm([y,G.pathname]),pathnameBase:DY(jm([y,G.pathnameBase])),route:Q}),G.pathnameBase!=="/"&&(y=jm([y,G.pathnameBase]))}return T}function Gb(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,l]=CY(e.path,e.caseSensitive,e.end),m=r.match(a);if(!m)return null;let y=m[0],T=y.replace(/(.)\/+$/,"$1"),i=m.slice(1);return{params:l.reduce((B,{paramName:F,isOptional:G},Q)=>{if(F==="*"){let ne=i[Q]||"";T=y.slice(0,y.length-ne.length).replace(/(.)\/+$/,"$1")}const te=i[Q];return G&&!te?B[F]=void 0:B[F]=(te||"").replace(/%2F/g,"/"),B},{}),pathname:y,pathnameBase:T,pattern:e}}function CY(e,r=!1,a=!0){Ef(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let l=[],m="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(T,i,z)=>(l.push({paramName:i,isOptional:z!=null}),z?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(l.push({paramName:"*"}),m+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?m+="\\/*$":e!==""&&e!=="/"&&(m+="(?:(?=\\/|$))"),[new RegExp(m,r?void 0:"i"),l]}function MY(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return Ef(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function qm(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let a=r.endsWith("/")?r.length-1:r.length,l=e.charAt(a);return l&&l!=="/"?null:e.slice(a)||"/"}function IY(e,r="/"){let{pathname:a,search:l="",hash:m=""}=typeof e=="string"?bg(e):e;return{pathname:a?a.startsWith("/")?a:PY(a,r):r,search:OY(l),hash:kY(m)}}function PY(e,r){let a=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(m=>{m===".."?a.length>1&&a.pop():m!=="."&&a.push(m)}),a.length>1?a.join("/"):"/"}function aT(e,r,a,l){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(l)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function RY(e){return e.filter((r,a)=>a===0||r.route.path&&r.route.path.length>0)}function V3(e){let r=RY(e);return r.map((a,l)=>l===r.length-1?a.pathname:a.pathnameBase)}function $3(e,r,a,l=!1){let m;typeof e=="string"?m=bg(e):(m={...e},ms(!m.pathname||!m.pathname.includes("?"),aT("?","pathname","search",m)),ms(!m.pathname||!m.pathname.includes("#"),aT("#","pathname","hash",m)),ms(!m.search||!m.search.includes("#"),aT("#","search","hash",m)));let y=e===""||m.pathname==="",T=y?"/":m.pathname,i;if(T==null)i=a;else{let G=r.length-1;if(!l&&T.startsWith("..")){let Q=T.split("/");for(;Q[0]==="..";)Q.shift(),G-=1;m.pathname=Q.join("/")}i=G>=0?r[G]:"/"}let z=IY(m,i),B=T&&T!=="/"&&T.endsWith("/"),F=(y||T===".")&&a.endsWith("/");return!z.pathname.endsWith("/")&&(B||F)&&(z.pathname+="/"),z}var jm=e=>e.join("/").replace(/\/\/+/g,"/"),DY=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),OY=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kY=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function zY(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var t5=["POST","PUT","PATCH","DELETE"];new Set(t5);var LY=["GET",...t5];new Set(LY);var ny=ae.createContext(null);ny.displayName="DataRouter";var Yw=ae.createContext(null);Yw.displayName="DataRouterState";ae.createContext(!1);var r5=ae.createContext({isTransitioning:!1});r5.displayName="ViewTransition";var BY=ae.createContext(new Map);BY.displayName="Fetchers";var FY=ae.createContext(null);FY.displayName="Await";var Qd=ae.createContext(null);Qd.displayName="Navigation";var Ax=ae.createContext(null);Ax.displayName="Location";var Kd=ae.createContext({outlet:null,matches:[],isDataRoute:!1});Kd.displayName="Route";var G3=ae.createContext(null);G3.displayName="RouteError";function NY(e,{relative:r}={}){ms(iy(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:l}=ae.useContext(Qd),{hash:m,pathname:y,search:T}=_x(e,{relative:r}),i=y;return a!=="/"&&(i=y==="/"?a:jm([a,y])),l.createHref({pathname:i,search:T,hash:m})}function iy(){return ae.useContext(Ax)!=null}function Jm(){return ms(iy(),"useLocation() may be used only in the context of a <Router> component."),ae.useContext(Ax).location}var n5="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function i5(e){ae.useContext(Qd).static||ae.useLayoutEffect(e)}function gx(){let{isDataRoute:e}=ae.useContext(Kd);return e?eQ():jY()}function jY(){ms(iy(),"useNavigate() may be used only in the context of a <Router> component.");let e=ae.useContext(ny),{basename:r,navigator:a}=ae.useContext(Qd),{matches:l}=ae.useContext(Kd),{pathname:m}=Jm(),y=JSON.stringify(V3(l)),T=ae.useRef(!1);return i5(()=>{T.current=!0}),ae.useCallback((z,B={})=>{if(Ef(T.current,n5),!T.current)return;if(typeof z=="number"){a.go(z);return}let F=$3(z,JSON.parse(y),m,B.relative==="path");e==null&&r!=="/"&&(F.pathname=F.pathname==="/"?r:jm([r,F.pathname])),(B.replace?a.replace:a.push)(F,B.state,B)},[r,a,y,m,e])}var UY=ae.createContext(null);function VY(e){let r=ae.useContext(Kd).outlet;return ae.useMemo(()=>r&&ae.createElement(UY.Provider,{value:e},r),[r,e])}function _x(e,{relative:r}={}){let{matches:a}=ae.useContext(Kd),{pathname:l}=Jm(),m=JSON.stringify(V3(a));return ae.useMemo(()=>$3(e,JSON.parse(m),l,r==="path"),[e,m,l,r])}function $Y(e,r){return o5(e,r)}function o5(e,r,a,l,m){ms(iy(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:y}=ae.useContext(Qd),{matches:T}=ae.useContext(Kd),i=T[T.length-1],z=i?i.params:{},B=i?i.pathname:"/",F=i?i.pathnameBase:"/",G=i&&i.route;{let we=G&&G.path||"";a5(B,!G||we.endsWith("*")||we.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${B}" (under <Route path="${we}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${we}"> to <Route path="${we==="/"?"*":`${we}/*`}">.`)}let Q=Jm(),te;if(r){let we=typeof r=="string"?bg(r):r;ms(F==="/"||we.pathname?.startsWith(F),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${F}" but pathname "${we.pathname}" was given in the \`location\` prop.`),te=we}else te=Q;let ne=te.pathname||"/",oe=ne;if(F!=="/"){let we=F.replace(/^\//,"").split("/");oe="/"+ne.replace(/^\//,"").split("/").slice(we.length).join("/")}let ue=KB(e,{pathname:oe});Ef(G||ue!=null,`No routes matched location "${te.pathname}${te.search}${te.hash}" `),Ef(ue==null||ue[ue.length-1].route.element!==void 0||ue[ue.length-1].route.Component!==void 0||ue[ue.length-1].route.lazy!==void 0,`Matched leaf route at location "${te.pathname}${te.search}${te.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let ye=ZY(ue&&ue.map(we=>Object.assign({},we,{params:Object.assign({},z,we.params),pathname:jm([F,y.encodeLocation?y.encodeLocation(we.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:we.pathname]),pathnameBase:we.pathnameBase==="/"?F:jm([F,y.encodeLocation?y.encodeLocation(we.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:we.pathnameBase])})),T,a,l,m);return r&&ye?ae.createElement(Ax.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...te},navigationType:"POP"}},ye):ye}function GY(){let e=JY(),r=zY(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,l="rgba(200,200,200, 0.5)",m={padding:"0.5rem",backgroundColor:l},y={padding:"2px 4px",backgroundColor:l},T=null;return console.error("Error handled by React Router default ErrorBoundary:",e),T=ae.createElement(ae.Fragment,null,ae.createElement("p",null," Hey developer "),ae.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ae.createElement("code",{style:y},"ErrorBoundary")," or"," ",ae.createElement("code",{style:y},"errorElement")," prop on your route.")),ae.createElement(ae.Fragment,null,ae.createElement("h2",null,"Unexpected Application Error!"),ae.createElement("h3",{style:{fontStyle:"italic"}},r),a?ae.createElement("pre",{style:m},a):null,T)}var HY=ae.createElement(GY,null),qY=class extends ae.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){this.props.unstable_onError?this.props.unstable_onError(e,r):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?ae.createElement(Kd.Provider,{value:this.props.routeContext},ae.createElement(G3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function WY({routeContext:e,match:r,children:a}){let l=ae.useContext(ny);return l&&l.static&&l.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=r.route.id),ae.createElement(Kd.Provider,{value:e},a)}function ZY(e,r=[],a=null,l=null,m=null){if(e==null){if(!a)return null;if(a.errors)e=a.matches;else if(r.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let y=e,T=a?.errors;if(T!=null){let B=y.findIndex(F=>F.route.id&&T?.[F.route.id]!==void 0);ms(B>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(T).join(",")}`),y=y.slice(0,Math.min(y.length,B+1))}let i=!1,z=-1;if(a)for(let B=0;B<y.length;B++){let F=y[B];if((F.route.HydrateFallback||F.route.hydrateFallbackElement)&&(z=B),F.route.id){let{loaderData:G,errors:Q}=a,te=F.route.loader&&!G.hasOwnProperty(F.route.id)&&(!Q||Q[F.route.id]===void 0);if(F.route.lazy||te){i=!0,z>=0?y=y.slice(0,z+1):y=[y[0]];break}}}return y.reduceRight((B,F,G)=>{let Q,te=!1,ne=null,oe=null;a&&(Q=T&&F.route.id?T[F.route.id]:void 0,ne=F.route.errorElement||HY,i&&(z<0&&G===0?(a5("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),te=!0,oe=null):z===G&&(te=!0,oe=F.route.hydrateFallbackElement||null)));let ue=r.concat(y.slice(0,G+1)),ye=()=>{let we;return Q?we=ne:te?we=oe:F.route.Component?we=ae.createElement(F.route.Component,null):F.route.element?we=F.route.element:we=B,ae.createElement(WY,{match:F,routeContext:{outlet:B,matches:ue,isDataRoute:a!=null},children:we})};return a&&(F.route.ErrorBoundary||F.route.errorElement||G===0)?ae.createElement(qY,{location:a.location,revalidation:a.revalidation,component:ne,error:Q,children:ye(),routeContext:{outlet:null,matches:ue,isDataRoute:!0},unstable_onError:l}):ye()},null)}function H3(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function XY(e){let r=ae.useContext(ny);return ms(r,H3(e)),r}function YY(e){let r=ae.useContext(Yw);return ms(r,H3(e)),r}function QY(e){let r=ae.useContext(Kd);return ms(r,H3(e)),r}function q3(e){let r=QY(e),a=r.matches[r.matches.length-1];return ms(a.route.id,`${e} can only be used on routes that contain a unique "id"`),a.route.id}function KY(){return q3("useRouteId")}function JY(){let e=ae.useContext(G3),r=YY("useRouteError"),a=q3("useRouteError");return e!==void 0?e:r.errors?.[a]}function eQ(){let{router:e}=XY("useNavigate"),r=q3("useNavigate"),a=ae.useRef(!1);return i5(()=>{a.current=!0}),ae.useCallback(async(m,y={})=>{Ef(a.current,n5),a.current&&(typeof m=="number"?e.navigate(m):await e.navigate(m,{fromRouteId:r,...y}))},[e,r])}var DO={};function a5(e,r,a){!r&&!DO[e]&&(DO[e]=!0,Ef(!1,a))}ae.memo(tQ);function tQ({routes:e,future:r,state:a,unstable_onError:l}){return o5(e,void 0,a,l,r)}function rQ({to:e,replace:r,state:a,relative:l}){ms(iy(),"<Navigate> may be used only in the context of a <Router> component.");let{static:m}=ae.useContext(Qd);Ef(!m,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:y}=ae.useContext(Kd),{pathname:T}=Jm(),i=gx(),z=$3(e,V3(y),T,l==="path"),B=JSON.stringify(z);return ae.useEffect(()=>{i(JSON.parse(B),{replace:r,state:a,relative:l})},[i,B,l,r,a]),null}function Qw(e){return VY(e.context)}function ns(e){ms(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function nQ({basename:e="/",children:r=null,location:a,navigationType:l="POP",navigator:m,static:y=!1}){ms(!iy(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let T=e.replace(/^\/*/,"/"),i=ae.useMemo(()=>({basename:T,navigator:m,static:y,future:{}}),[T,m,y]);typeof a=="string"&&(a=bg(a));let{pathname:z="/",search:B="",hash:F="",state:G=null,key:Q="default"}=a,te=ae.useMemo(()=>{let ne=qm(z,T);return ne==null?null:{location:{pathname:ne,search:B,hash:F,state:G,key:Q},navigationType:l}},[T,z,B,F,G,Q,l]);return Ef(te!=null,`<Router basename="${T}"> is not able to match the URL "${z}${B}${F}" because it does not start with the basename, so the <Router> won't render anything.`),te==null?null:ae.createElement(Qd.Provider,{value:i},ae.createElement(Ax.Provider,{children:r,value:te}))}function iQ({children:e,location:r}){return $Y(lC(e),r)}function lC(e,r=[]){let a=[];return ae.Children.forEach(e,(l,m)=>{if(!ae.isValidElement(l))return;let y=[...r,m];if(l.type===ae.Fragment){a.push.apply(a,lC(l.props.children,y));return}ms(l.type===ns,`[${typeof l.type=="string"?l.type:l.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ms(!l.props.index||!l.props.children,"An index route cannot have child routes.");let T={id:l.props.id||y.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,middleware:l.props.middleware,loader:l.props.loader,action:l.props.action,hydrateFallbackElement:l.props.hydrateFallbackElement,HydrateFallback:l.props.HydrateFallback,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.hasErrorBoundary===!0||l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(T.children=lC(l.props.children,y)),a.push(T)}),a}var Tb="get",Eb="application/x-www-form-urlencoded";function Kw(e){return e!=null&&typeof e.tagName=="string"}function oQ(e){return Kw(e)&&e.tagName.toLowerCase()==="button"}function aQ(e){return Kw(e)&&e.tagName.toLowerCase()==="form"}function sQ(e){return Kw(e)&&e.tagName.toLowerCase()==="input"}function lQ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function cQ(e,r){return e.button===0&&(!r||r==="_self")&&!lQ(e)}function cC(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((r,a)=>{let l=e[a];return r.concat(Array.isArray(l)?l.map(m=>[a,m]):[[a,l]])},[]))}function uQ(e,r){let a=cC(e);return r&&r.forEach((l,m)=>{a.has(m)||r.getAll(m).forEach(y=>{a.append(m,y)})}),a}var ib=null;function hQ(){if(ib===null)try{new FormData(document.createElement("form"),0),ib=!1}catch{ib=!0}return ib}var fQ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sT(e){return e!=null&&!fQ.has(e)?(Ef(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Eb}"`),null):e}function dQ(e,r){let a,l,m,y,T;if(aQ(e)){let i=e.getAttribute("action");l=i?qm(i,r):null,a=e.getAttribute("method")||Tb,m=sT(e.getAttribute("enctype"))||Eb,y=new FormData(e)}else if(oQ(e)||sQ(e)&&(e.type==="submit"||e.type==="image")){let i=e.form;if(i==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let z=e.getAttribute("formaction")||i.getAttribute("action");if(l=z?qm(z,r):null,a=e.getAttribute("formmethod")||i.getAttribute("method")||Tb,m=sT(e.getAttribute("formenctype"))||sT(i.getAttribute("enctype"))||Eb,y=new FormData(i,e),!hQ()){let{name:B,type:F,value:G}=e;if(F==="image"){let Q=B?`${B}.`:"";y.append(`${Q}x`,"0"),y.append(`${Q}y`,"0")}else B&&y.append(B,G)}}else{if(Kw(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=Tb,l=null,m=Eb,T=e}return y&&m==="text/plain"&&(T=y,y=void 0),{action:l,method:a.toLowerCase(),encType:m,formData:y,body:T}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function W3(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function pQ(e,r,a){let l=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return l.pathname==="/"?l.pathname=`_root.${a}`:r&&qm(l.pathname,r)==="/"?l.pathname=`${r.replace(/\/$/,"")}/_root.${a}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${a}`,l}async function mQ(e,r){if(e.id in r)return r[e.id];try{let a=await import(e.module);return r[e.id]=a,a}catch(a){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function AQ(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function gQ(e,r,a){let l=await Promise.all(e.map(async m=>{let y=r.routes[m.route.id];if(y){let T=await mQ(y,a);return T.links?T.links():[]}return[]}));return xQ(l.flat(1).filter(AQ).filter(m=>m.rel==="stylesheet"||m.rel==="preload").map(m=>m.rel==="stylesheet"?{...m,rel:"prefetch",as:"style"}:{...m,rel:"prefetch"}))}function OO(e,r,a,l,m,y){let T=(z,B)=>a[B]?z.route.id!==a[B].route.id:!0,i=(z,B)=>a[B].pathname!==z.pathname||a[B].route.path?.endsWith("*")&&a[B].params["*"]!==z.params["*"];return y==="assets"?r.filter((z,B)=>T(z,B)||i(z,B)):y==="data"?r.filter((z,B)=>{let F=l.routes[z.route.id];if(!F||!F.hasLoader)return!1;if(T(z,B)||i(z,B))return!0;if(z.route.shouldRevalidate){let G=z.route.shouldRevalidate({currentUrl:new URL(m.pathname+m.search+m.hash,window.origin),currentParams:a[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:z.params,defaultShouldRevalidate:!0});if(typeof G=="boolean")return G}return!0}):[]}function _Q(e,r,{includeHydrateFallback:a}={}){return yQ(e.map(l=>{let m=r.routes[l.route.id];if(!m)return[];let y=[m.module];return m.clientActionModule&&(y=y.concat(m.clientActionModule)),m.clientLoaderModule&&(y=y.concat(m.clientLoaderModule)),a&&m.hydrateFallbackModule&&(y=y.concat(m.hydrateFallbackModule)),m.imports&&(y=y.concat(m.imports)),y}).flat(1))}function yQ(e){return[...new Set(e)]}function vQ(e){let r={},a=Object.keys(e).sort();for(let l of a)r[l]=e[l];return r}function xQ(e,r){let a=new Set;return new Set(r),e.reduce((l,m)=>{let y=JSON.stringify(vQ(m));return a.has(y)||(a.add(y),l.push({key:y,link:m})),l},[])}function s5(){let e=ae.useContext(ny);return W3(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function bQ(){let e=ae.useContext(Yw);return W3(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Z3=ae.createContext(void 0);Z3.displayName="FrameworkContext";function l5(){let e=ae.useContext(Z3);return W3(e,"You must render this element inside a <HydratedRouter> element"),e}function wQ(e,r){let a=ae.useContext(Z3),[l,m]=ae.useState(!1),[y,T]=ae.useState(!1),{onFocus:i,onBlur:z,onMouseEnter:B,onMouseLeave:F,onTouchStart:G}=r,Q=ae.useRef(null);ae.useEffect(()=>{if(e==="render"&&T(!0),e==="viewport"){let oe=ye=>{ye.forEach(we=>{T(we.isIntersecting)})},ue=new IntersectionObserver(oe,{threshold:.5});return Q.current&&ue.observe(Q.current),()=>{ue.disconnect()}}},[e]),ae.useEffect(()=>{if(l){let oe=setTimeout(()=>{T(!0)},100);return()=>{clearTimeout(oe)}}},[l]);let te=()=>{m(!0)},ne=()=>{m(!1),T(!1)};return a?e!=="intent"?[y,Q,{}]:[y,Q,{onFocus:gv(i,te),onBlur:gv(z,ne),onMouseEnter:gv(B,te),onMouseLeave:gv(F,ne),onTouchStart:gv(G,te)}]:[!1,Q,{}]}function gv(e,r){return a=>{e&&e(a),a.defaultPrevented||r(a)}}function SQ({page:e,...r}){let{router:a}=s5(),l=ae.useMemo(()=>KB(a.routes,e,a.basename),[a.routes,e,a.basename]);return l?ae.createElement(EQ,{page:e,matches:l,...r}):null}function TQ(e){let{manifest:r,routeModules:a}=l5(),[l,m]=ae.useState([]);return ae.useEffect(()=>{let y=!1;return gQ(e,r,a).then(T=>{y||m(T)}),()=>{y=!0}},[e,r,a]),l}function EQ({page:e,matches:r,...a}){let l=Jm(),{manifest:m,routeModules:y}=l5(),{basename:T}=s5(),{loaderData:i,matches:z}=bQ(),B=ae.useMemo(()=>OO(e,r,z,m,l,"data"),[e,r,z,m,l]),F=ae.useMemo(()=>OO(e,r,z,m,l,"assets"),[e,r,z,m,l]),G=ae.useMemo(()=>{if(e===l.pathname+l.search+l.hash)return[];let ne=new Set,oe=!1;if(r.forEach(ye=>{let we=m.routes[ye.route.id];!we||!we.hasLoader||(!B.some(ve=>ve.route.id===ye.route.id)&&ye.route.id in i&&y[ye.route.id]?.shouldRevalidate||we.hasClientLoader?oe=!0:ne.add(ye.route.id))}),ne.size===0)return[];let ue=pQ(e,T,"data");return oe&&ne.size>0&&ue.searchParams.set("_routes",r.filter(ye=>ne.has(ye.route.id)).map(ye=>ye.route.id).join(",")),[ue.pathname+ue.search]},[T,i,l,m,B,r,e,y]),Q=ae.useMemo(()=>_Q(F,m),[F,m]),te=TQ(F);return ae.createElement(ae.Fragment,null,G.map(ne=>ae.createElement("link",{key:ne,rel:"prefetch",as:"fetch",href:ne,...a})),Q.map(ne=>ae.createElement("link",{key:ne,rel:"modulepreload",href:ne,...a})),te.map(({key:ne,link:oe})=>ae.createElement("link",{key:ne,nonce:a.nonce,...oe})))}function CQ(...e){return r=>{e.forEach(a=>{typeof a=="function"?a(r):a!=null&&(a.current=r)})}}var c5=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{c5&&(window.__reactRouterVersion="7.9.2")}catch{}function MQ({basename:e,children:r,window:a}){let l=ae.useRef();l.current==null&&(l.current=fY({window:a,v5Compat:!0}));let m=l.current,[y,T]=ae.useState({action:m.action,location:m.location}),i=ae.useCallback(z=>{ae.startTransition(()=>T(z))},[T]);return ae.useLayoutEffect(()=>m.listen(i),[m,i]),ae.createElement(nQ,{basename:e,children:r,location:y.location,navigationType:y.action,navigator:m})}var u5=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Cs=ae.forwardRef(function({onClick:r,discover:a="render",prefetch:l="none",relative:m,reloadDocument:y,replace:T,state:i,target:z,to:B,preventScrollReset:F,viewTransition:G,...Q},te){let{basename:ne}=ae.useContext(Qd),oe=typeof B=="string"&&u5.test(B),ue,ye=!1;if(typeof B=="string"&&oe&&(ue=B,c5))try{let dt=new URL(window.location.href),bt=B.startsWith("//")?new URL(dt.protocol+B):new URL(B),ht=qm(bt.pathname,ne);bt.origin===dt.origin&&ht!=null?B=ht+bt.search+bt.hash:ye=!0}catch{Ef(!1,`<Link to="${B}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let we=NY(B,{relative:m}),[ve,Ce,Ee]=wQ(l,Q),Be=DQ(B,{replace:T,state:i,target:z,preventScrollReset:F,relative:m,viewTransition:G});function Ke(dt){r&&r(dt),dt.defaultPrevented||Be(dt)}let st=ae.createElement("a",{...Q,...Ee,href:ue||we,onClick:ye||y?r:Ke,ref:CQ(te,Ce),target:z,"data-discover":!oe&&a==="render"?"true":void 0});return ve&&!oe?ae.createElement(ae.Fragment,null,st,ae.createElement(SQ,{page:we})):st});Cs.displayName="Link";var IQ=ae.forwardRef(function({"aria-current":r="page",caseSensitive:a=!1,className:l="",end:m=!1,style:y,to:T,viewTransition:i,children:z,...B},F){let G=_x(T,{relative:B.relative}),Q=Jm(),te=ae.useContext(Yw),{navigator:ne,basename:oe}=ae.useContext(Qd),ue=te!=null&&FQ(G)&&i===!0,ye=ne.encodeLocation?ne.encodeLocation(G).pathname:G.pathname,we=Q.pathname,ve=te&&te.navigation&&te.navigation.location?te.navigation.location.pathname:null;a||(we=we.toLowerCase(),ve=ve?ve.toLowerCase():null,ye=ye.toLowerCase()),ve&&oe&&(ve=qm(ve,oe)||ve);const Ce=ye!=="/"&&ye.endsWith("/")?ye.length-1:ye.length;let Ee=we===ye||!m&&we.startsWith(ye)&&we.charAt(Ce)==="/",Be=ve!=null&&(ve===ye||!m&&ve.startsWith(ye)&&ve.charAt(ye.length)==="/"),Ke={isActive:Ee,isPending:Be,isTransitioning:ue},st=Ee?r:void 0,dt;typeof l=="function"?dt=l(Ke):dt=[l,Ee?"active":null,Be?"pending":null,ue?"transitioning":null].filter(Boolean).join(" ");let bt=typeof y=="function"?y(Ke):y;return ae.createElement(Cs,{...B,"aria-current":st,className:dt,ref:F,style:bt,to:T,viewTransition:i},typeof z=="function"?z(Ke):z)});IQ.displayName="NavLink";var PQ=ae.forwardRef(({discover:e="render",fetcherKey:r,navigate:a,reloadDocument:l,replace:m,state:y,method:T=Tb,action:i,onSubmit:z,relative:B,preventScrollReset:F,viewTransition:G,...Q},te)=>{let ne=LQ(),oe=BQ(i,{relative:B}),ue=T.toLowerCase()==="get"?"get":"post",ye=typeof i=="string"&&u5.test(i),we=ve=>{if(z&&z(ve),ve.defaultPrevented)return;ve.preventDefault();let Ce=ve.nativeEvent.submitter,Ee=Ce?.getAttribute("formmethod")||T;ne(Ce||ve.currentTarget,{fetcherKey:r,method:Ee,navigate:a,replace:m,state:y,relative:B,preventScrollReset:F,viewTransition:G})};return ae.createElement("form",{ref:te,method:ue,action:oe,onSubmit:l?z:we,...Q,"data-discover":!ye&&e==="render"?"true":void 0})});PQ.displayName="Form";function RQ(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function h5(e){let r=ae.useContext(ny);return ms(r,RQ(e)),r}function DQ(e,{target:r,replace:a,state:l,preventScrollReset:m,relative:y,viewTransition:T}={}){let i=gx(),z=Jm(),B=_x(e,{relative:y});return ae.useCallback(F=>{if(cQ(F,r)){F.preventDefault();let G=a!==void 0?a:qv(z)===qv(B);i(e,{replace:G,state:l,preventScrollReset:m,relative:y,viewTransition:T})}},[z,i,B,a,l,r,e,m,y,T])}function OQ(e){Ef(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=ae.useRef(cC(e)),a=ae.useRef(!1),l=Jm(),m=ae.useMemo(()=>uQ(l.search,a.current?null:r.current),[l.search]),y=gx(),T=ae.useCallback((i,z)=>{const B=cC(typeof i=="function"?i(new URLSearchParams(m)):i);a.current=!0,y("?"+B,z)},[y,m]);return[m,T]}var kQ=0,zQ=()=>`__${String(++kQ)}__`;function LQ(){let{router:e}=h5("useSubmit"),{basename:r}=ae.useContext(Qd),a=KY();return ae.useCallback(async(l,m={})=>{let{action:y,method:T,encType:i,formData:z,body:B}=dQ(l,r);if(m.navigate===!1){let F=m.fetcherKey||zQ();await e.fetch(F,a,m.action||y,{preventScrollReset:m.preventScrollReset,formData:z,body:B,formMethod:m.method||T,formEncType:m.encType||i,flushSync:m.flushSync})}else await e.navigate(m.action||y,{preventScrollReset:m.preventScrollReset,formData:z,body:B,formMethod:m.method||T,formEncType:m.encType||i,replace:m.replace,state:m.state,fromRouteId:a,flushSync:m.flushSync,viewTransition:m.viewTransition})},[e,r,a])}function BQ(e,{relative:r}={}){let{basename:a}=ae.useContext(Qd),l=ae.useContext(Kd);ms(l,"useFormAction must be used inside a RouteContext");let[m]=l.matches.slice(-1),y={..._x(e||".",{relative:r})},T=Jm();if(e==null){y.search=T.search;let i=new URLSearchParams(y.search),z=i.getAll("index");if(z.some(F=>F==="")){i.delete("index"),z.filter(G=>G).forEach(G=>i.append("index",G));let F=i.toString();y.search=F?`?${F}`:""}}return(!e||e===".")&&m.route.index&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(y.pathname=y.pathname==="/"?a:jm([a,y.pathname])),qv(y)}function FQ(e,{relative:r}={}){let a=ae.useContext(r5);ms(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:l}=h5("useViewTransitionState"),m=_x(e,{relative:r});if(!a.isTransitioning)return!1;let y=qm(a.currentLocation.pathname,l)||a.currentLocation.pathname,T=qm(a.nextLocation.pathname,l)||a.nextLocation.pathname;return Gb(m.pathname,T)!=null||Gb(m.pathname,y)!=null}const NQ=Fl(be.jsx("path",{d:"M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4"})),jQ=Fl(be.jsx("path",{d:"M4 9h4v11H4zm12 4h4v7h-4zm-6-9h4v16h-4z"})),UQ=Fl(be.jsx("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2"})),X3=Fl(be.jsx("path",{d:"M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2m-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1M9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m11 15H4v-2h16zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20z"})),VQ=Fl(be.jsx("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})),$Q=Fl(be.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"})),f5=Fl(be.jsx("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2m0 13c0 .55-.45 1-1 1H5c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h14c.55 0 1 .45 1 1zm-6-7c.55 0 1-.45 1-1s-.45-1-1-1h-1v-.01c0-.55-.45-1-1-1s-1 .45-1 1V8h-1c-.55 0-1 .45-1 1v3c0 .55.45 1 1 1h3v1h-3c-.55 0-1 .45-1 1s.45 1 1 1h1c0 .55.45 1 1 1s1-.45 1-1h1c.55 0 1-.45 1-1v-3c0-.55-.45-1-1-1h-3v-1z"})),GQ=Fl(be.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7m0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"})),Y3=Fl(be.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"})),Fv=Fl(be.jsx("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V7H4v3H1v2h3v3h2v-3h3v-2zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4"})),HQ=Fl(be.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"})),qQ=Fl(be.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z"})),kO=240;function WQ(){return be.jsxs(bo,{children:[be.jsxs(Zw,{variant:"permanent",sx:{width:kO,flexShrink:0,"& .MuiDrawer-paper":{width:kO,boxSizing:"border-box"}},children:[be.jsx(a0,{}),be.jsx(U_,{}),be.jsxs(mx,{children:[be.jsxs(Js,{component:Cs,to:"/admin",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Y3,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/admin/add-driver",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Fv,{})}),be.jsx(el,{sx:{color:"#000000"},primary:" "})]}),be.jsxs(Js,{component:Cs,to:"/admin/register-support",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Fv,{})}),be.jsx(el,{sx:{color:"#000000"},primary:" . "})]}),be.jsxs(Js,{component:Cs,to:"/admin/add-user-bonus",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(X3,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/admin/withdraw-driver",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(f5,{})}),be.jsx(el,{sx:{color:"#000000"},primary:"  ()"})]})]})]}),be.jsxs(bo,{component:"main",sx:{p:1},children:[be.jsx(a0,{}),be.jsx(Qw,{})]})]})}const zO=240;function ZQ(){const e=gx(),r=()=>{localStorage.removeItem("role"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),e("/login",{replace:!0})};return be.jsxs(bo,{sx:{display:"flex"},children:[be.jsx(UH,{position:"fixed",sx:{zIndex:a=>a.zIndex.drawer+1,backgroundColor:"white",color:"black",boxShadow:"none",borderBottom:"1px solid #ddd"},children:be.jsxs(a0,{sx:{justifyContent:"space-between"},children:[be.jsxs(bo,{sx:{display:"flex",alignItems:"center",gap:2},children:[be.jsx("img",{src:"/logo.png",alt:"Logo",style:{height:40}}),be.jsx(tl,{variant:"h6",noWrap:!0,component:"div",children:"ZIPP Admin"})]}),be.jsx(bo,{sx:{display:"flex",alignItems:"center",gap:2},children:be.jsx(Tf,{color:"error",variant:"outlined",onClick:r,children:""})})]})}),be.jsxs(Zw,{variant:"permanent",sx:{width:zO,flexShrink:0,"& .MuiDrawer-paper":{width:zO,boxSizing:"border-box"}},children:[be.jsx(a0,{}),be.jsx(U_,{}),be.jsxs(mx,{children:[be.jsx(Js,{component:Cs,to:"/",children:be.jsx(el,{primary:""})}),be.jsx(Js,{component:Cs,to:"/profile",children:be.jsx(el,{primary:""})}),be.jsx(Js,{component:Cs,to:"/settings",children:be.jsx(el,{primary:""})})]})]}),be.jsx(Qw,{})]})}const LO=240;function XQ(){return be.jsxs(bo,{children:[be.jsxs(Zw,{variant:"permanent",sx:{width:LO,"& .MuiDrawer-paper":{width:LO,boxSizing:"border-box"}},children:[be.jsx(a0,{}),be.jsx(U_,{}),be.jsxs(mx,{sx:{"& .MuiListItemText-primary":{fontSize:15}},children:[be.jsxs(Js,{component:Cs,to:"/super-admin",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(jQ,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/drivers",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Y3,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/add-driver",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Fv,{})}),be.jsx(el,{sx:{color:"#000000"},primary:" "})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/register-support",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Fv,{})}),be.jsx(el,{sx:{color:"#000000"},primary:" . "})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/register-admin",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Fv,{})}),be.jsx(el,{sx:{color:"#000000",fontSize:10},primary:" "})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/settings",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(HQ,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/tariffs",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(NQ,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/add-user-bonus",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(X3,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/working-zone",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(GQ,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/withdraw-driver",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(f5,{})}),be.jsx(el,{sx:{color:"#000000"},primary:"  ()"})]}),be.jsxs(Js,{component:Cs,to:"/super-admin/banners",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(UQ,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]})]})]}),be.jsxs(bo,{component:"main",sx:{p:1},children:[be.jsx(a0,{}),be.jsx(Qw,{})]})]})}const BO=240;function YQ(){return be.jsxs(bo,{children:[be.jsxs(Zw,{variant:"permanent",sx:{width:BO,flexShrink:0,"& .MuiDrawer-paper":{width:BO,boxSizing:"border-box"}},children:[be.jsx(a0,{}),be.jsx(U_,{}),be.jsxs(mx,{children:[be.jsxs(Js,{component:Cs,to:"/support",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(Y3,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]}),be.jsxs(Js,{component:Cs,to:"/support/add-user-bonus",children:[be.jsx(ec,{sx:{minWidth:36},children:be.jsx(X3,{})}),be.jsx(el,{sx:{color:"#000000"},primary:""})]})]})]}),be.jsxs(bo,{component:"main",sx:{p:1},children:[be.jsx(a0,{}),be.jsx(Qw,{})]})]})}function QQ(e){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}QQ(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var yx=e=>typeof e=="number"&&!isNaN(e),Ag=e=>typeof e=="string",Wm=e=>typeof e=="function",KQ=e=>Ag(e)||yx(e),uC=e=>Ag(e)||Wm(e)?e:null,JQ=(e,r)=>e===!1||yx(e)&&e>0?e:r,hC=e=>ae.isValidElement(e)||Ag(e)||Wm(e)||yx(e);function eK(e,r,a=300){let{scrollHeight:l,style:m}=e;requestAnimationFrame(()=>{m.minHeight="initial",m.height=l+"px",m.transition=`all ${a}ms`,requestAnimationFrame(()=>{m.height="0",m.padding="0",m.margin="0",setTimeout(r,a)})})}function tK({enter:e,exit:r,appendPosition:a=!1,collapse:l=!0,collapseDuration:m=300}){return function({children:y,position:T,preventExitTransition:i,done:z,nodeRef:B,isIn:F,playToast:G}){let Q=a?`${e}--${T}`:e,te=a?`${r}--${T}`:r,ne=ae.useRef(0);return ae.useLayoutEffect(()=>{let oe=B.current,ue=Q.split(" "),ye=we=>{we.target===B.current&&(G(),oe.removeEventListener("animationend",ye),oe.removeEventListener("animationcancel",ye),ne.current===0&&we.type!=="animationcancel"&&oe.classList.remove(...ue))};oe.classList.add(...ue),oe.addEventListener("animationend",ye),oe.addEventListener("animationcancel",ye)},[]),ae.useEffect(()=>{let oe=B.current,ue=()=>{oe.removeEventListener("animationend",ue),l?eK(oe,z,m):z()};F||(i?ue():(ne.current=1,oe.className+=` ${te}`,oe.addEventListener("animationend",ue)))},[F]),Ko.createElement(Ko.Fragment,null,y)}}function FO(e,r){return{content:d5(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:r}}function d5(e,r,a=!1){return ae.isValidElement(e)&&!Ag(e.type)?ae.cloneElement(e,{closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:a}):Wm(e)?e({closeToast:r.closeToast,toastProps:r,data:r.data,isPaused:a}):e}function rK({closeToast:e,theme:r,ariaLabel:a="close"}){return Ko.createElement("button",{className:`Toastify__close-button Toastify__close-button--${r}`,type:"button",onClick:l=>{l.stopPropagation(),e(!0)},"aria-label":a},Ko.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ko.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function nK({delay:e,isRunning:r,closeToast:a,type:l="default",hide:m,className:y,controlledProgress:T,progress:i,rtl:z,isIn:B,theme:F}){let G=m||T&&i===0,Q={animationDuration:`${e}ms`,animationPlayState:r?"running":"paused"};T&&(Q.transform=`scaleX(${i})`);let te=on("Toastify__progress-bar",T?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${F}`,`Toastify__progress-bar--${l}`,{"Toastify__progress-bar--rtl":z}),ne=Wm(y)?y({rtl:z,type:l,defaultClassName:te}):on(te,y),oe={[T&&i>=1?"onTransitionEnd":"onAnimationEnd"]:T&&i<1?null:()=>{B&&a()}};return Ko.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":G},Ko.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${F} Toastify__progress-bar--${l}`}),Ko.createElement("div",{role:"progressbar","aria-hidden":G?"true":"false","aria-label":"notification timer",className:ne,style:Q,...oe}))}var iK=1,p5=()=>`${iK++}`;function oK(e,r,a){let l=1,m=0,y=[],T=[],i=r,z=new Map,B=new Set,F=we=>(B.add(we),()=>B.delete(we)),G=()=>{T=Array.from(z.values()),B.forEach(we=>we())},Q=({containerId:we,toastId:ve,updateId:Ce})=>{let Ee=we?we!==e:e!==1,Be=z.has(ve)&&Ce==null;return Ee||Be},te=(we,ve)=>{z.forEach(Ce=>{var Ee;(ve==null||ve===Ce.props.toastId)&&((Ee=Ce.toggle)==null||Ee.call(Ce,we))})},ne=we=>{var ve,Ce;(Ce=(ve=we.props)==null?void 0:ve.onClose)==null||Ce.call(ve,we.removalReason),we.isActive=!1},oe=we=>{if(we==null)z.forEach(ne);else{let ve=z.get(we);ve&&ne(ve)}G()},ue=()=>{m-=y.length,y=[]},ye=we=>{var ve,Ce;let{toastId:Ee,updateId:Be}=we.props,Ke=Be==null;we.staleId&&z.delete(we.staleId),we.isActive=!0,z.set(Ee,we),G(),a(FO(we,Ke?"added":"updated")),Ke&&((Ce=(ve=we.props).onOpen)==null||Ce.call(ve))};return{id:e,props:i,observe:F,toggle:te,removeToast:oe,toasts:z,clearQueue:ue,buildToast:(we,ve)=>{if(Q(ve))return;let{toastId:Ce,updateId:Ee,data:Be,staleId:Ke,delay:st}=ve,dt=Ee==null;dt&&m++;let bt={...i,style:i.toastStyle,key:l++,...Object.fromEntries(Object.entries(ve).filter(([Re,Pt])=>Pt!=null)),toastId:Ce,updateId:Ee,data:Be,isIn:!1,className:uC(ve.className||i.toastClassName),progressClassName:uC(ve.progressClassName||i.progressClassName),autoClose:ve.isLoading?!1:JQ(ve.autoClose,i.autoClose),closeToast(Re){z.get(Ce).removalReason=Re,oe(Ce)},deleteToast(){let Re=z.get(Ce);if(Re!=null){if(a(FO(Re,"removed")),z.delete(Ce),m--,m<0&&(m=0),y.length>0){ye(y.shift());return}G()}}};bt.closeButton=i.closeButton,ve.closeButton===!1||hC(ve.closeButton)?bt.closeButton=ve.closeButton:ve.closeButton===!0&&(bt.closeButton=hC(i.closeButton)?i.closeButton:!0);let ht={content:we,props:bt,staleId:Ke};i.limit&&i.limit>0&&m>i.limit&&dt?y.push(ht):yx(st)?setTimeout(()=>{ye(ht)},st):ye(ht)},setProps(we){i=we},setToggle:(we,ve)=>{let Ce=z.get(we);Ce&&(Ce.toggle=ve)},isToastActive:we=>{var ve;return(ve=z.get(we))==null?void 0:ve.isActive},getSnapshot:()=>T}}var $u=new Map,Wv=[],fC=new Set,aK=e=>fC.forEach(r=>r(e)),m5=()=>$u.size>0;function sK(){Wv.forEach(e=>g5(e.content,e.options)),Wv=[]}var lK=(e,{containerId:r})=>{var a;return(a=$u.get(r||1))==null?void 0:a.toasts.get(e)};function A5(e,r){var a;if(r)return!!((a=$u.get(r))!=null&&a.isToastActive(e));let l=!1;return $u.forEach(m=>{m.isToastActive(e)&&(l=!0)}),l}function cK(e){if(!m5()){Wv=Wv.filter(r=>e!=null&&r.options.toastId!==e);return}if(e==null||KQ(e))$u.forEach(r=>{r.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let r=$u.get(e.containerId);r?r.removeToast(e.id):$u.forEach(a=>{a.removeToast(e.id)})}}var uK=(e={})=>{$u.forEach(r=>{r.props.limit&&(!e.containerId||r.id===e.containerId)&&r.clearQueue()})};function g5(e,r){hC(e)&&(m5()||Wv.push({content:e,options:r}),$u.forEach(a=>{a.buildToast(e,r)}))}function hK(e){var r;(r=$u.get(e.containerId||1))==null||r.setToggle(e.id,e.fn)}function _5(e,r){$u.forEach(a=>{(r==null||!(r!=null&&r.containerId)||r?.containerId===a.id)&&a.toggle(e,r?.id)})}function fK(e){let r=e.containerId||1;return{subscribe(a){let l=oK(r,e,aK);$u.set(r,l);let m=l.observe(a);return sK(),()=>{m(),$u.delete(r)}},setProps(a){var l;(l=$u.get(r))==null||l.setProps(a)},getSnapshot(){var a;return(a=$u.get(r))==null?void 0:a.getSnapshot()}}}function dK(e){return fC.add(e),()=>{fC.delete(e)}}function pK(e){return e&&(Ag(e.toastId)||yx(e.toastId))?e.toastId:p5()}function vx(e,r){return g5(e,r),r.toastId}function Jw(e,r){return{...r,type:r&&r.type||e,toastId:pK(r)}}function e2(e){return(r,a)=>vx(r,Jw(e,a))}function Zo(e,r){return vx(e,Jw("default",r))}Zo.loading=(e,r)=>vx(e,Jw("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...r}));function mK(e,{pending:r,error:a,success:l},m){let y;r&&(y=Ag(r)?Zo.loading(r,m):Zo.loading(r.render,{...m,...r}));let T={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},i=(B,F,G)=>{if(F==null){Zo.dismiss(y);return}let Q={type:B,...T,...m,data:G},te=Ag(F)?{render:F}:F;return y?Zo.update(y,{...Q,...te}):Zo(te.render,{...Q,...te}),G},z=Wm(e)?e():e;return z.then(B=>i("success",l,B)).catch(B=>i("error",a,B)),z}Zo.promise=mK;Zo.success=e2("success");Zo.info=e2("info");Zo.error=e2("error");Zo.warning=e2("warning");Zo.warn=Zo.warning;Zo.dark=(e,r)=>vx(e,Jw("default",{theme:"dark",...r}));function AK(e){cK(e)}Zo.dismiss=AK;Zo.clearWaitingQueue=uK;Zo.isActive=A5;Zo.update=(e,r={})=>{let a=lK(e,r);if(a){let{props:l,content:m}=a,y={delay:100,...l,...r,toastId:r.toastId||e,updateId:p5()};y.toastId!==e&&(y.staleId=e);let T=y.render||m;delete y.render,vx(T,y)}};Zo.done=e=>{Zo.update(e,{progress:1})};Zo.onChange=dK;Zo.play=e=>_5(!0,e);Zo.pause=e=>_5(!1,e);function gK(e){var r;let{subscribe:a,getSnapshot:l,setProps:m}=ae.useRef(fK(e)).current;m(e);let y=(r=ae.useSyncExternalStore(a,l,l))==null?void 0:r.slice();function T(i){if(!y)return[];let z=new Map;return e.newestOnTop&&y.reverse(),y.forEach(B=>{let{position:F}=B.props;z.has(F)||z.set(F,[]),z.get(F).push(B)}),Array.from(z,B=>i(B[0],B[1]))}return{getToastToRender:T,isToastActive:A5,count:y?.length}}function _K(e){let[r,a]=ae.useState(!1),[l,m]=ae.useState(!1),y=ae.useRef(null),T=ae.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:i,pauseOnHover:z,closeToast:B,onClick:F,closeOnClick:G}=e;hK({id:e.toastId,containerId:e.containerId,fn:a}),ae.useEffect(()=>{if(e.pauseOnFocusLoss)return Q(),()=>{te()}},[e.pauseOnFocusLoss]);function Q(){document.hasFocus()||ye(),window.addEventListener("focus",ue),window.addEventListener("blur",ye)}function te(){window.removeEventListener("focus",ue),window.removeEventListener("blur",ye)}function ne(Ke){if(e.draggable===!0||e.draggable===Ke.pointerType){we();let st=y.current;T.canCloseOnClick=!0,T.canDrag=!0,st.style.transition="none",e.draggableDirection==="x"?(T.start=Ke.clientX,T.removalDistance=st.offsetWidth*(e.draggablePercent/100)):(T.start=Ke.clientY,T.removalDistance=st.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function oe(Ke){let{top:st,bottom:dt,left:bt,right:ht}=y.current.getBoundingClientRect();Ke.nativeEvent.type!=="touchend"&&e.pauseOnHover&&Ke.clientX>=bt&&Ke.clientX<=ht&&Ke.clientY>=st&&Ke.clientY<=dt?ye():ue()}function ue(){a(!0)}function ye(){a(!1)}function we(){T.didMove=!1,document.addEventListener("pointermove",Ce),document.addEventListener("pointerup",Ee)}function ve(){document.removeEventListener("pointermove",Ce),document.removeEventListener("pointerup",Ee)}function Ce(Ke){let st=y.current;if(T.canDrag&&st){T.didMove=!0,r&&ye(),e.draggableDirection==="x"?T.delta=Ke.clientX-T.start:T.delta=Ke.clientY-T.start,T.start!==Ke.clientX&&(T.canCloseOnClick=!1);let dt=e.draggableDirection==="x"?`${T.delta}px, var(--y)`:`0, calc(${T.delta}px + var(--y))`;st.style.transform=`translate3d(${dt},0)`,st.style.opacity=`${1-Math.abs(T.delta/T.removalDistance)}`}}function Ee(){ve();let Ke=y.current;if(T.canDrag&&T.didMove&&Ke){if(T.canDrag=!1,Math.abs(T.delta)>T.removalDistance){m(!0),e.closeToast(!0),e.collapseAll();return}Ke.style.transition="transform 0.2s, opacity 0.2s",Ke.style.removeProperty("transform"),Ke.style.removeProperty("opacity")}}let Be={onPointerDown:ne,onPointerUp:oe};return i&&z&&(Be.onMouseEnter=ye,e.stacked||(Be.onMouseLeave=ue)),G&&(Be.onClick=Ke=>{F&&F(Ke),T.canCloseOnClick&&B(!0)}),{playToast:ue,pauseToast:ye,isRunning:r,preventExitTransition:l,toastRef:y,eventHandlers:Be}}var yK=typeof window<"u"?ae.useLayoutEffect:ae.useEffect,t2=({theme:e,type:r,isLoading:a,...l})=>Ko.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...l});function vK(e){return Ko.createElement(t2,{...e},Ko.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function xK(e){return Ko.createElement(t2,{...e},Ko.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function bK(e){return Ko.createElement(t2,{...e},Ko.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function wK(e){return Ko.createElement(t2,{...e},Ko.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function SK(){return Ko.createElement("div",{className:"Toastify__spinner"})}var dC={info:xK,warning:vK,success:bK,error:wK,spinner:SK},TK=e=>e in dC;function EK({theme:e,type:r,isLoading:a,icon:l}){let m=null,y={theme:e,type:r};return l===!1||(Wm(l)?m=l({...y,isLoading:a}):ae.isValidElement(l)?m=ae.cloneElement(l,y):a?m=dC.spinner():TK(r)&&(m=dC[r](y))),m}var CK=e=>{let{isRunning:r,preventExitTransition:a,toastRef:l,eventHandlers:m,playToast:y}=_K(e),{closeButton:T,children:i,autoClose:z,onClick:B,type:F,hideProgressBar:G,closeToast:Q,transition:te,position:ne,className:oe,style:ue,progressClassName:ye,updateId:we,role:ve,progress:Ce,rtl:Ee,toastId:Be,deleteToast:Ke,isIn:st,isLoading:dt,closeOnClick:bt,theme:ht,ariaLabel:Re}=e,Pt=on("Toastify__toast",`Toastify__toast-theme--${ht}`,`Toastify__toast--${F}`,{"Toastify__toast--rtl":Ee},{"Toastify__toast--close-on-click":bt}),wt=Wm(oe)?oe({rtl:Ee,position:ne,type:F,defaultClassName:Pt}):on(Pt,oe),Et=EK(e),et=!!Ce||!z,Zt={closeToast:Q,type:F,theme:ht},ir=null;return T===!1||(Wm(T)?ir=T(Zt):ae.isValidElement(T)?ir=ae.cloneElement(T,Zt):ir=rK(Zt)),Ko.createElement(te,{isIn:st,done:Ke,position:ne,preventExitTransition:a,nodeRef:l,playToast:y},Ko.createElement("div",{id:Be,tabIndex:0,onClick:B,"data-in":st,className:wt,...m,style:ue,ref:l,...st&&{role:ve,"aria-label":Re}},Et!=null&&Ko.createElement("div",{className:on("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!dt})},Et),d5(i,e,!r),ir,!e.customProgressBar&&Ko.createElement(nK,{...we&&!et?{key:`p-${we}`}:{},rtl:Ee,theme:ht,delay:z,isRunning:r,isIn:st,closeToast:Q,hide:G,type:F,className:ye,controlledProgress:et,progress:Ce||0})))},MK=(e,r=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:r}),IK=tK(MK("bounce",!0)),PK={position:"top-right",transition:IK,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function Xp(e){let r={...PK,...e},a=e.stacked,[l,m]=ae.useState(!0),y=ae.useRef(null),{getToastToRender:T,isToastActive:i,count:z}=gK(r),{className:B,style:F,rtl:G,containerId:Q,hotKeys:te}=r;function ne(ue){let ye=on("Toastify__toast-container",`Toastify__toast-container--${ue}`,{"Toastify__toast-container--rtl":G});return Wm(B)?B({position:ue,rtl:G,defaultClassName:ye}):on(ye,uC(B))}function oe(){a&&(m(!0),Zo.play())}return yK(()=>{var ue;if(a){let ye=y.current.querySelectorAll('[data-in="true"]'),we=12,ve=(ue=r.position)==null?void 0:ue.includes("top"),Ce=0,Ee=0;Array.from(ye).reverse().forEach((Be,Ke)=>{let st=Be;st.classList.add("Toastify__toast--stacked"),Ke>0&&(st.dataset.collapsed=`${l}`),st.dataset.pos||(st.dataset.pos=ve?"top":"bot");let dt=Ce*(l?.2:1)+(l?0:we*Ke);st.style.setProperty("--y",`${ve?dt:dt*-1}px`),st.style.setProperty("--g",`${we}`),st.style.setProperty("--s",`${1-(l?Ee:0)}`),Ce+=st.offsetHeight,Ee+=.025})}},[l,z,a]),ae.useEffect(()=>{function ue(ye){var we;let ve=y.current;te(ye)&&((we=ve.querySelector('[tabIndex="0"]'))==null||we.focus(),m(!1),Zo.pause()),ye.key==="Escape"&&(document.activeElement===ve||ve!=null&&ve.contains(document.activeElement))&&(m(!0),Zo.play())}return document.addEventListener("keydown",ue),()=>{document.removeEventListener("keydown",ue)}},[te]),Ko.createElement("section",{ref:y,className:"Toastify",id:Q,onMouseEnter:()=>{a&&(m(!1),Zo.pause())},onMouseLeave:oe,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":r["aria-label"]},T((ue,ye)=>{let we=ye.length?{...F}:{...F,pointerEvents:"none"};return Ko.createElement("div",{tabIndex:-1,className:ne(ue),"data-stacked":a,style:we,key:`c-${ue}`},ye.map(({content:ve,props:Ce})=>Ko.createElement(CK,{...Ce,stacked:a,collapseAll:oe,isIn:i(Ce.toastId,Ce.containerId),key:`t-${Ce.key}`},ve)))}))}function y5(e,r){return function(){return e.apply(r,arguments)}}const{toString:RK}=Object.prototype,{getPrototypeOf:Q3}=Object,{iterator:r2,toStringTag:v5}=Symbol,n2=(e=>r=>{const a=RK.call(r);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),Jd=e=>(e=e.toLowerCase(),r=>n2(r)===e),i2=e=>r=>typeof r===e,{isArray:oy}=Array,V_=i2("undefined");function xx(e){return e!==null&&!V_(e)&&e.constructor!==null&&!V_(e.constructor)&&Ph(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const x5=Jd("ArrayBuffer");function DK(e){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(e):r=e&&e.buffer&&x5(e.buffer),r}const OK=i2("string"),Ph=i2("function"),b5=i2("number"),bx=e=>e!==null&&typeof e=="object",kK=e=>e===!0||e===!1,Cb=e=>{if(n2(e)!=="object")return!1;const r=Q3(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(v5 in e)&&!(r2 in e)},zK=e=>{if(!bx(e)||xx(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},LK=Jd("Date"),BK=Jd("File"),FK=Jd("Blob"),NK=Jd("FileList"),jK=e=>bx(e)&&Ph(e.pipe),UK=e=>{let r;return e&&(typeof FormData=="function"&&e instanceof FormData||Ph(e.append)&&((r=n2(e))==="formdata"||r==="object"&&Ph(e.toString)&&e.toString()==="[object FormData]"))},VK=Jd("URLSearchParams"),[$K,GK,HK,qK]=["ReadableStream","Request","Response","Headers"].map(Jd),WK=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wx(e,r,{allOwnKeys:a=!1}={}){if(e===null||typeof e>"u")return;let l,m;if(typeof e!="object"&&(e=[e]),oy(e))for(l=0,m=e.length;l<m;l++)r.call(null,e[l],l,e);else{if(xx(e))return;const y=a?Object.getOwnPropertyNames(e):Object.keys(e),T=y.length;let i;for(l=0;l<T;l++)i=y[l],r.call(null,e[i],i,e)}}function w5(e,r){if(xx(e))return null;r=r.toLowerCase();const a=Object.keys(e);let l=a.length,m;for(;l-- >0;)if(m=a[l],r===m.toLowerCase())return m;return null}const ag=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,S5=e=>!V_(e)&&e!==ag;function pC(){const{caseless:e,skipUndefined:r}=S5(this)&&this||{},a={},l=(m,y)=>{const T=e&&w5(a,y)||y;Cb(a[T])&&Cb(m)?a[T]=pC(a[T],m):Cb(m)?a[T]=pC({},m):oy(m)?a[T]=m.slice():(!r||!V_(m))&&(a[T]=m)};for(let m=0,y=arguments.length;m<y;m++)arguments[m]&&wx(arguments[m],l);return a}const ZK=(e,r,a,{allOwnKeys:l}={})=>(wx(r,(m,y)=>{a&&Ph(m)?e[y]=y5(m,a):e[y]=m},{allOwnKeys:l}),e),XK=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),YK=(e,r,a,l)=>{e.prototype=Object.create(r.prototype,l),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:r.prototype}),a&&Object.assign(e.prototype,a)},QK=(e,r,a,l)=>{let m,y,T;const i={};if(r=r||{},e==null)return r;do{for(m=Object.getOwnPropertyNames(e),y=m.length;y-- >0;)T=m[y],(!l||l(T,e,r))&&!i[T]&&(r[T]=e[T],i[T]=!0);e=a!==!1&&Q3(e)}while(e&&(!a||a(e,r))&&e!==Object.prototype);return r},KK=(e,r,a)=>{e=String(e),(a===void 0||a>e.length)&&(a=e.length),a-=r.length;const l=e.indexOf(r,a);return l!==-1&&l===a},JK=e=>{if(!e)return null;if(oy(e))return e;let r=e.length;if(!b5(r))return null;const a=new Array(r);for(;r-- >0;)a[r]=e[r];return a},eJ=(e=>r=>e&&r instanceof e)(typeof Uint8Array<"u"&&Q3(Uint8Array)),tJ=(e,r)=>{const l=(e&&e[r2]).call(e);let m;for(;(m=l.next())&&!m.done;){const y=m.value;r.call(e,y[0],y[1])}},rJ=(e,r)=>{let a;const l=[];for(;(a=e.exec(r))!==null;)l.push(a);return l},nJ=Jd("HTMLFormElement"),iJ=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(a,l,m){return l.toUpperCase()+m}),NO=(({hasOwnProperty:e})=>(r,a)=>e.call(r,a))(Object.prototype),oJ=Jd("RegExp"),T5=(e,r)=>{const a=Object.getOwnPropertyDescriptors(e),l={};wx(a,(m,y)=>{let T;(T=r(m,y,e))!==!1&&(l[y]=T||m)}),Object.defineProperties(e,l)},aJ=e=>{T5(e,(r,a)=>{if(Ph(e)&&["arguments","caller","callee"].indexOf(a)!==-1)return!1;const l=e[a];if(Ph(l)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")})}})},sJ=(e,r)=>{const a={},l=m=>{m.forEach(y=>{a[y]=!0})};return oy(e)?l(e):l(String(e).split(r)),a},lJ=()=>{},cJ=(e,r)=>e!=null&&Number.isFinite(e=+e)?e:r;function uJ(e){return!!(e&&Ph(e.append)&&e[v5]==="FormData"&&e[r2])}const hJ=e=>{const r=new Array(10),a=(l,m)=>{if(bx(l)){if(r.indexOf(l)>=0)return;if(xx(l))return l;if(!("toJSON"in l)){r[m]=l;const y=oy(l)?[]:{};return wx(l,(T,i)=>{const z=a(T,m+1);!V_(z)&&(y[i]=z)}),r[m]=void 0,y}}return l};return a(e,0)},fJ=Jd("AsyncFunction"),dJ=e=>e&&(bx(e)||Ph(e))&&Ph(e.then)&&Ph(e.catch),E5=((e,r)=>e?setImmediate:r?((a,l)=>(ag.addEventListener("message",({source:m,data:y})=>{m===ag&&y===a&&l.length&&l.shift()()},!1),m=>{l.push(m),ag.postMessage(a,"*")}))(`axios@${Math.random()}`,[]):a=>setTimeout(a))(typeof setImmediate=="function",Ph(ag.postMessage)),pJ=typeof queueMicrotask<"u"?queueMicrotask.bind(ag):typeof process<"u"&&process.nextTick||E5,mJ=e=>e!=null&&Ph(e[r2]),vr={isArray:oy,isArrayBuffer:x5,isBuffer:xx,isFormData:UK,isArrayBufferView:DK,isString:OK,isNumber:b5,isBoolean:kK,isObject:bx,isPlainObject:Cb,isEmptyObject:zK,isReadableStream:$K,isRequest:GK,isResponse:HK,isHeaders:qK,isUndefined:V_,isDate:LK,isFile:BK,isBlob:FK,isRegExp:oJ,isFunction:Ph,isStream:jK,isURLSearchParams:VK,isTypedArray:eJ,isFileList:NK,forEach:wx,merge:pC,extend:ZK,trim:WK,stripBOM:XK,inherits:YK,toFlatObject:QK,kindOf:n2,kindOfTest:Jd,endsWith:KK,toArray:JK,forEachEntry:tJ,matchAll:rJ,isHTMLForm:nJ,hasOwnProperty:NO,hasOwnProp:NO,reduceDescriptors:T5,freezeMethods:aJ,toObjectSet:sJ,toCamelCase:iJ,noop:lJ,toFiniteNumber:cJ,findKey:w5,global:ag,isContextDefined:S5,isSpecCompliantForm:uJ,toJSONObject:hJ,isAsyncFn:fJ,isThenable:dJ,setImmediate:E5,asap:pJ,isIterable:mJ};function po(e,r,a,l,m){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",r&&(this.code=r),a&&(this.config=a),l&&(this.request=l),m&&(this.response=m,this.status=m.status?m.status:null)}vr.inherits(po,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:vr.toJSONObject(this.config),code:this.code,status:this.status}}});const C5=po.prototype,M5={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{M5[e]={value:e}});Object.defineProperties(po,M5);Object.defineProperty(C5,"isAxiosError",{value:!0});po.from=(e,r,a,l,m,y)=>{const T=Object.create(C5);vr.toFlatObject(e,T,function(F){return F!==Error.prototype},B=>B!=="isAxiosError");const i=e&&e.message?e.message:"Error",z=r==null&&e?e.code:r;return po.call(T,i,z,a,l,m),e&&T.cause==null&&Object.defineProperty(T,"cause",{value:e,configurable:!0}),T.name=e&&e.name||"Error",y&&Object.assign(T,y),T};const AJ=null;function mC(e){return vr.isPlainObject(e)||vr.isArray(e)}function I5(e){return vr.endsWith(e,"[]")?e.slice(0,-2):e}function jO(e,r,a){return e?e.concat(r).map(function(m,y){return m=I5(m),!a&&y?"["+m+"]":m}).join(a?".":""):r}function gJ(e){return vr.isArray(e)&&!e.some(mC)}const _J=vr.toFlatObject(vr,{},null,function(r){return/^is[A-Z]/.test(r)});function o2(e,r,a){if(!vr.isObject(e))throw new TypeError("target must be an object");r=r||new FormData,a=vr.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,function(oe,ue){return!vr.isUndefined(ue[oe])});const l=a.metaTokens,m=a.visitor||F,y=a.dots,T=a.indexes,z=(a.Blob||typeof Blob<"u"&&Blob)&&vr.isSpecCompliantForm(r);if(!vr.isFunction(m))throw new TypeError("visitor must be a function");function B(ne){if(ne===null)return"";if(vr.isDate(ne))return ne.toISOString();if(vr.isBoolean(ne))return ne.toString();if(!z&&vr.isBlob(ne))throw new po("Blob is not supported. Use a Buffer instead.");return vr.isArrayBuffer(ne)||vr.isTypedArray(ne)?z&&typeof Blob=="function"?new Blob([ne]):Buffer.from(ne):ne}function F(ne,oe,ue){let ye=ne;if(ne&&!ue&&typeof ne=="object"){if(vr.endsWith(oe,"{}"))oe=l?oe:oe.slice(0,-2),ne=JSON.stringify(ne);else if(vr.isArray(ne)&&gJ(ne)||(vr.isFileList(ne)||vr.endsWith(oe,"[]"))&&(ye=vr.toArray(ne)))return oe=I5(oe),ye.forEach(function(ve,Ce){!(vr.isUndefined(ve)||ve===null)&&r.append(T===!0?jO([oe],Ce,y):T===null?oe:oe+"[]",B(ve))}),!1}return mC(ne)?!0:(r.append(jO(ue,oe,y),B(ne)),!1)}const G=[],Q=Object.assign(_J,{defaultVisitor:F,convertValue:B,isVisitable:mC});function te(ne,oe){if(!vr.isUndefined(ne)){if(G.indexOf(ne)!==-1)throw Error("Circular reference detected in "+oe.join("."));G.push(ne),vr.forEach(ne,function(ye,we){(!(vr.isUndefined(ye)||ye===null)&&m.call(r,ye,vr.isString(we)?we.trim():we,oe,Q))===!0&&te(ye,oe?oe.concat(we):[we])}),G.pop()}}if(!vr.isObject(e))throw new TypeError("data must be an object");return te(e),r}function UO(e){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(l){return r[l]})}function K3(e,r){this._pairs=[],e&&o2(e,this,r)}const P5=K3.prototype;P5.append=function(r,a){this._pairs.push([r,a])};P5.toString=function(r){const a=r?function(l){return r.call(this,l,UO)}:UO;return this._pairs.map(function(m){return a(m[0])+"="+a(m[1])},"").join("&")};function yJ(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function R5(e,r,a){if(!r)return e;const l=a&&a.encode||yJ;vr.isFunction(a)&&(a={serialize:a});const m=a&&a.serialize;let y;if(m?y=m(r,a):y=vr.isURLSearchParams(r)?r.toString():new K3(r,a).toString(l),y){const T=e.indexOf("#");T!==-1&&(e=e.slice(0,T)),e+=(e.indexOf("?")===-1?"?":"&")+y}return e}class VO{constructor(){this.handlers=[]}use(r,a,l){return this.handlers.push({fulfilled:r,rejected:a,synchronous:l?l.synchronous:!1,runWhen:l?l.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){vr.forEach(this.handlers,function(l){l!==null&&r(l)})}}const D5={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vJ=typeof URLSearchParams<"u"?URLSearchParams:K3,xJ=typeof FormData<"u"?FormData:null,bJ=typeof Blob<"u"?Blob:null,wJ={isBrowser:!0,classes:{URLSearchParams:vJ,FormData:xJ,Blob:bJ},protocols:["http","https","file","blob","url","data"]},J3=typeof window<"u"&&typeof document<"u",AC=typeof navigator=="object"&&navigator||void 0,SJ=J3&&(!AC||["ReactNative","NativeScript","NS"].indexOf(AC.product)<0),TJ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",EJ=J3&&window.location.href||"http://localhost",CJ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:J3,hasStandardBrowserEnv:SJ,hasStandardBrowserWebWorkerEnv:TJ,navigator:AC,origin:EJ},Symbol.toStringTag,{value:"Module"})),Qc={...CJ,...wJ};function MJ(e,r){return o2(e,new Qc.classes.URLSearchParams,{visitor:function(a,l,m,y){return Qc.isNode&&vr.isBuffer(a)?(this.append(l,a.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)},...r})}function IJ(e){return vr.matchAll(/\w+|\[(\w*)]/g,e).map(r=>r[0]==="[]"?"":r[1]||r[0])}function PJ(e){const r={},a=Object.keys(e);let l;const m=a.length;let y;for(l=0;l<m;l++)y=a[l],r[y]=e[y];return r}function O5(e){function r(a,l,m,y){let T=a[y++];if(T==="__proto__")return!0;const i=Number.isFinite(+T),z=y>=a.length;return T=!T&&vr.isArray(m)?m.length:T,z?(vr.hasOwnProp(m,T)?m[T]=[m[T],l]:m[T]=l,!i):((!m[T]||!vr.isObject(m[T]))&&(m[T]=[]),r(a,l,m[T],y)&&vr.isArray(m[T])&&(m[T]=PJ(m[T])),!i)}if(vr.isFormData(e)&&vr.isFunction(e.entries)){const a={};return vr.forEachEntry(e,(l,m)=>{r(IJ(l),m,a,0)}),a}return null}function RJ(e,r,a){if(vr.isString(e))try{return(r||JSON.parse)(e),vr.trim(e)}catch(l){if(l.name!=="SyntaxError")throw l}return(a||JSON.stringify)(e)}const Sx={transitional:D5,adapter:["xhr","http","fetch"],transformRequest:[function(r,a){const l=a.getContentType()||"",m=l.indexOf("application/json")>-1,y=vr.isObject(r);if(y&&vr.isHTMLForm(r)&&(r=new FormData(r)),vr.isFormData(r))return m?JSON.stringify(O5(r)):r;if(vr.isArrayBuffer(r)||vr.isBuffer(r)||vr.isStream(r)||vr.isFile(r)||vr.isBlob(r)||vr.isReadableStream(r))return r;if(vr.isArrayBufferView(r))return r.buffer;if(vr.isURLSearchParams(r))return a.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let i;if(y){if(l.indexOf("application/x-www-form-urlencoded")>-1)return MJ(r,this.formSerializer).toString();if((i=vr.isFileList(r))||l.indexOf("multipart/form-data")>-1){const z=this.env&&this.env.FormData;return o2(i?{"files[]":r}:r,z&&new z,this.formSerializer)}}return y||m?(a.setContentType("application/json",!1),RJ(r)):r}],transformResponse:[function(r){const a=this.transitional||Sx.transitional,l=a&&a.forcedJSONParsing,m=this.responseType==="json";if(vr.isResponse(r)||vr.isReadableStream(r))return r;if(r&&vr.isString(r)&&(l&&!this.responseType||m)){const T=!(a&&a.silentJSONParsing)&&m;try{return JSON.parse(r,this.parseReviver)}catch(i){if(T)throw i.name==="SyntaxError"?po.from(i,po.ERR_BAD_RESPONSE,this,null,this.response):i}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qc.classes.FormData,Blob:Qc.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};vr.forEach(["delete","get","head","post","put","patch"],e=>{Sx.headers[e]={}});const DJ=vr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),OJ=e=>{const r={};let a,l,m;return e&&e.split(`
`).forEach(function(T){m=T.indexOf(":"),a=T.substring(0,m).trim().toLowerCase(),l=T.substring(m+1).trim(),!(!a||r[a]&&DJ[a])&&(a==="set-cookie"?r[a]?r[a].push(l):r[a]=[l]:r[a]=r[a]?r[a]+", "+l:l)}),r},$O=Symbol("internals");function _v(e){return e&&String(e).trim().toLowerCase()}function Mb(e){return e===!1||e==null?e:vr.isArray(e)?e.map(Mb):String(e)}function kJ(e){const r=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=a.exec(e);)r[l[1]]=l[2];return r}const zJ=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function lT(e,r,a,l,m){if(vr.isFunction(l))return l.call(this,r,a);if(m&&(r=a),!!vr.isString(r)){if(vr.isString(l))return r.indexOf(l)!==-1;if(vr.isRegExp(l))return l.test(r)}}function LJ(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,a,l)=>a.toUpperCase()+l)}function BJ(e,r){const a=vr.toCamelCase(" "+r);["get","set","has"].forEach(l=>{Object.defineProperty(e,l+a,{value:function(m,y,T){return this[l].call(this,r,m,y,T)},configurable:!0})})}let Rh=class{constructor(r){r&&this.set(r)}set(r,a,l){const m=this;function y(i,z,B){const F=_v(z);if(!F)throw new Error("header name must be a non-empty string");const G=vr.findKey(m,F);(!G||m[G]===void 0||B===!0||B===void 0&&m[G]!==!1)&&(m[G||z]=Mb(i))}const T=(i,z)=>vr.forEach(i,(B,F)=>y(B,F,z));if(vr.isPlainObject(r)||r instanceof this.constructor)T(r,a);else if(vr.isString(r)&&(r=r.trim())&&!zJ(r))T(OJ(r),a);else if(vr.isObject(r)&&vr.isIterable(r)){let i={},z,B;for(const F of r){if(!vr.isArray(F))throw TypeError("Object iterator must return a key-value pair");i[B=F[0]]=(z=i[B])?vr.isArray(z)?[...z,F[1]]:[z,F[1]]:F[1]}T(i,a)}else r!=null&&y(a,r,l);return this}get(r,a){if(r=_v(r),r){const l=vr.findKey(this,r);if(l){const m=this[l];if(!a)return m;if(a===!0)return kJ(m);if(vr.isFunction(a))return a.call(this,m,l);if(vr.isRegExp(a))return a.exec(m);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,a){if(r=_v(r),r){const l=vr.findKey(this,r);return!!(l&&this[l]!==void 0&&(!a||lT(this,this[l],l,a)))}return!1}delete(r,a){const l=this;let m=!1;function y(T){if(T=_v(T),T){const i=vr.findKey(l,T);i&&(!a||lT(l,l[i],i,a))&&(delete l[i],m=!0)}}return vr.isArray(r)?r.forEach(y):y(r),m}clear(r){const a=Object.keys(this);let l=a.length,m=!1;for(;l--;){const y=a[l];(!r||lT(this,this[y],y,r,!0))&&(delete this[y],m=!0)}return m}normalize(r){const a=this,l={};return vr.forEach(this,(m,y)=>{const T=vr.findKey(l,y);if(T){a[T]=Mb(m),delete a[y];return}const i=r?LJ(y):String(y).trim();i!==y&&delete a[y],a[i]=Mb(m),l[i]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const a=Object.create(null);return vr.forEach(this,(l,m)=>{l!=null&&l!==!1&&(a[m]=r&&vr.isArray(l)?l.join(", "):l)}),a}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,a])=>r+": "+a).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...a){const l=new this(r);return a.forEach(m=>l.set(m)),l}static accessor(r){const l=(this[$O]=this[$O]={accessors:{}}).accessors,m=this.prototype;function y(T){const i=_v(T);l[i]||(BJ(m,T),l[i]=!0)}return vr.isArray(r)?r.forEach(y):y(r),this}};Rh.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);vr.reduceDescriptors(Rh.prototype,({value:e},r)=>{let a=r[0].toUpperCase()+r.slice(1);return{get:()=>e,set(l){this[a]=l}}});vr.freezeMethods(Rh);function cT(e,r){const a=this||Sx,l=r||a,m=Rh.from(l.headers);let y=l.data;return vr.forEach(e,function(i){y=i.call(a,y,m.normalize(),r?r.status:void 0)}),m.normalize(),y}function k5(e){return!!(e&&e.__CANCEL__)}function ay(e,r,a){po.call(this,e??"canceled",po.ERR_CANCELED,r,a),this.name="CanceledError"}vr.inherits(ay,po,{__CANCEL__:!0});function z5(e,r,a){const l=a.config.validateStatus;!a.status||!l||l(a.status)?e(a):r(new po("Request failed with status code "+a.status,[po.ERR_BAD_REQUEST,po.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a))}function FJ(e){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return r&&r[1]||""}function NJ(e,r){e=e||10;const a=new Array(e),l=new Array(e);let m=0,y=0,T;return r=r!==void 0?r:1e3,function(z){const B=Date.now(),F=l[y];T||(T=B),a[m]=z,l[m]=B;let G=y,Q=0;for(;G!==m;)Q+=a[G++],G=G%e;if(m=(m+1)%e,m===y&&(y=(y+1)%e),B-T<r)return;const te=F&&B-F;return te?Math.round(Q*1e3/te):void 0}}function jJ(e,r){let a=0,l=1e3/r,m,y;const T=(B,F=Date.now())=>{a=F,m=null,y&&(clearTimeout(y),y=null),e(...B)};return[(...B)=>{const F=Date.now(),G=F-a;G>=l?T(B,F):(m=B,y||(y=setTimeout(()=>{y=null,T(m)},l-G)))},()=>m&&T(m)]}const Hb=(e,r,a=3)=>{let l=0;const m=NJ(50,250);return jJ(y=>{const T=y.loaded,i=y.lengthComputable?y.total:void 0,z=T-l,B=m(z),F=T<=i;l=T;const G={loaded:T,total:i,progress:i?T/i:void 0,bytes:z,rate:B||void 0,estimated:B&&i&&F?(i-T)/B:void 0,event:y,lengthComputable:i!=null,[r?"download":"upload"]:!0};e(G)},a)},GO=(e,r)=>{const a=e!=null;return[l=>r[0]({lengthComputable:a,total:e,loaded:l}),r[1]]},HO=e=>(...r)=>vr.asap(()=>e(...r)),UJ=Qc.hasStandardBrowserEnv?((e,r)=>a=>(a=new URL(a,Qc.origin),e.protocol===a.protocol&&e.host===a.host&&(r||e.port===a.port)))(new URL(Qc.origin),Qc.navigator&&/(msie|trident)/i.test(Qc.navigator.userAgent)):()=>!0,VJ=Qc.hasStandardBrowserEnv?{write(e,r,a,l,m,y){const T=[e+"="+encodeURIComponent(r)];vr.isNumber(a)&&T.push("expires="+new Date(a).toGMTString()),vr.isString(l)&&T.push("path="+l),vr.isString(m)&&T.push("domain="+m),y===!0&&T.push("secure"),document.cookie=T.join("; ")},read(e){const r=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function $J(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function GJ(e,r){return r?e.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):e}function L5(e,r,a){let l=!$J(r);return e&&(l||a==!1)?GJ(e,r):r}const qO=e=>e instanceof Rh?{...e}:e;function gg(e,r){r=r||{};const a={};function l(B,F,G,Q){return vr.isPlainObject(B)&&vr.isPlainObject(F)?vr.merge.call({caseless:Q},B,F):vr.isPlainObject(F)?vr.merge({},F):vr.isArray(F)?F.slice():F}function m(B,F,G,Q){if(vr.isUndefined(F)){if(!vr.isUndefined(B))return l(void 0,B,G,Q)}else return l(B,F,G,Q)}function y(B,F){if(!vr.isUndefined(F))return l(void 0,F)}function T(B,F){if(vr.isUndefined(F)){if(!vr.isUndefined(B))return l(void 0,B)}else return l(void 0,F)}function i(B,F,G){if(G in r)return l(B,F);if(G in e)return l(void 0,B)}const z={url:y,method:y,data:y,baseURL:T,transformRequest:T,transformResponse:T,paramsSerializer:T,timeout:T,timeoutMessage:T,withCredentials:T,withXSRFToken:T,adapter:T,responseType:T,xsrfCookieName:T,xsrfHeaderName:T,onUploadProgress:T,onDownloadProgress:T,decompress:T,maxContentLength:T,maxBodyLength:T,beforeRedirect:T,transport:T,httpAgent:T,httpsAgent:T,cancelToken:T,socketPath:T,responseEncoding:T,validateStatus:i,headers:(B,F,G)=>m(qO(B),qO(F),G,!0)};return vr.forEach(Object.keys({...e,...r}),function(F){const G=z[F]||m,Q=G(e[F],r[F],F);vr.isUndefined(Q)&&G!==i||(a[F]=Q)}),a}const B5=e=>{const r=gg({},e);let{data:a,withXSRFToken:l,xsrfHeaderName:m,xsrfCookieName:y,headers:T,auth:i}=r;if(r.headers=T=Rh.from(T),r.url=R5(L5(r.baseURL,r.url,r.allowAbsoluteUrls),e.params,e.paramsSerializer),i&&T.set("Authorization","Basic "+btoa((i.username||"")+":"+(i.password?unescape(encodeURIComponent(i.password)):""))),vr.isFormData(a)){if(Qc.hasStandardBrowserEnv||Qc.hasStandardBrowserWebWorkerEnv)T.setContentType(void 0);else if(vr.isFunction(a.getHeaders)){const z=a.getHeaders(),B=["content-type","content-length"];Object.entries(z).forEach(([F,G])=>{B.includes(F.toLowerCase())&&T.set(F,G)})}}if(Qc.hasStandardBrowserEnv&&(l&&vr.isFunction(l)&&(l=l(r)),l||l!==!1&&UJ(r.url))){const z=m&&y&&VJ.read(y);z&&T.set(m,z)}return r},HJ=typeof XMLHttpRequest<"u",qJ=HJ&&function(e){return new Promise(function(a,l){const m=B5(e);let y=m.data;const T=Rh.from(m.headers).normalize();let{responseType:i,onUploadProgress:z,onDownloadProgress:B}=m,F,G,Q,te,ne;function oe(){te&&te(),ne&&ne(),m.cancelToken&&m.cancelToken.unsubscribe(F),m.signal&&m.signal.removeEventListener("abort",F)}let ue=new XMLHttpRequest;ue.open(m.method.toUpperCase(),m.url,!0),ue.timeout=m.timeout;function ye(){if(!ue)return;const ve=Rh.from("getAllResponseHeaders"in ue&&ue.getAllResponseHeaders()),Ee={data:!i||i==="text"||i==="json"?ue.responseText:ue.response,status:ue.status,statusText:ue.statusText,headers:ve,config:e,request:ue};z5(function(Ke){a(Ke),oe()},function(Ke){l(Ke),oe()},Ee),ue=null}"onloadend"in ue?ue.onloadend=ye:ue.onreadystatechange=function(){!ue||ue.readyState!==4||ue.status===0&&!(ue.responseURL&&ue.responseURL.indexOf("file:")===0)||setTimeout(ye)},ue.onabort=function(){ue&&(l(new po("Request aborted",po.ECONNABORTED,e,ue)),ue=null)},ue.onerror=function(Ce){const Ee=Ce&&Ce.message?Ce.message:"Network Error",Be=new po(Ee,po.ERR_NETWORK,e,ue);Be.event=Ce||null,l(Be),ue=null},ue.ontimeout=function(){let Ce=m.timeout?"timeout of "+m.timeout+"ms exceeded":"timeout exceeded";const Ee=m.transitional||D5;m.timeoutErrorMessage&&(Ce=m.timeoutErrorMessage),l(new po(Ce,Ee.clarifyTimeoutError?po.ETIMEDOUT:po.ECONNABORTED,e,ue)),ue=null},y===void 0&&T.setContentType(null),"setRequestHeader"in ue&&vr.forEach(T.toJSON(),function(Ce,Ee){ue.setRequestHeader(Ee,Ce)}),vr.isUndefined(m.withCredentials)||(ue.withCredentials=!!m.withCredentials),i&&i!=="json"&&(ue.responseType=m.responseType),B&&([Q,ne]=Hb(B,!0),ue.addEventListener("progress",Q)),z&&ue.upload&&([G,te]=Hb(z),ue.upload.addEventListener("progress",G),ue.upload.addEventListener("loadend",te)),(m.cancelToken||m.signal)&&(F=ve=>{ue&&(l(!ve||ve.type?new ay(null,e,ue):ve),ue.abort(),ue=null)},m.cancelToken&&m.cancelToken.subscribe(F),m.signal&&(m.signal.aborted?F():m.signal.addEventListener("abort",F)));const we=FJ(m.url);if(we&&Qc.protocols.indexOf(we)===-1){l(new po("Unsupported protocol "+we+":",po.ERR_BAD_REQUEST,e));return}ue.send(y||null)})},WJ=(e,r)=>{const{length:a}=e=e?e.filter(Boolean):[];if(r||a){let l=new AbortController,m;const y=function(B){if(!m){m=!0,i();const F=B instanceof Error?B:this.reason;l.abort(F instanceof po?F:new ay(F instanceof Error?F.message:F))}};let T=r&&setTimeout(()=>{T=null,y(new po(`timeout ${r} of ms exceeded`,po.ETIMEDOUT))},r);const i=()=>{e&&(T&&clearTimeout(T),T=null,e.forEach(B=>{B.unsubscribe?B.unsubscribe(y):B.removeEventListener("abort",y)}),e=null)};e.forEach(B=>B.addEventListener("abort",y));const{signal:z}=l;return z.unsubscribe=()=>vr.asap(i),z}},ZJ=function*(e,r){let a=e.byteLength;if(a<r){yield e;return}let l=0,m;for(;l<a;)m=l+r,yield e.slice(l,m),l=m},XJ=async function*(e,r){for await(const a of YJ(e))yield*ZJ(a,r)},YJ=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const r=e.getReader();try{for(;;){const{done:a,value:l}=await r.read();if(a)break;yield l}}finally{await r.cancel()}},WO=(e,r,a,l)=>{const m=XJ(e,r);let y=0,T,i=z=>{T||(T=!0,l&&l(z))};return new ReadableStream({async pull(z){try{const{done:B,value:F}=await m.next();if(B){i(),z.close();return}let G=F.byteLength;if(a){let Q=y+=G;a(Q)}z.enqueue(new Uint8Array(F))}catch(B){throw i(B),B}},cancel(z){return i(z),m.return()}},{highWaterMark:2})},ZO=64*1024,{isFunction:ob}=vr,QJ=(({Request:e,Response:r})=>({Request:e,Response:r}))(vr.global),{ReadableStream:XO,TextEncoder:YO}=vr.global,QO=(e,...r)=>{try{return!!e(...r)}catch{return!1}},KJ=e=>{e=vr.merge.call({skipUndefined:!0},QJ,e);const{fetch:r,Request:a,Response:l}=e,m=r?ob(r):typeof fetch=="function",y=ob(a),T=ob(l);if(!m)return!1;const i=m&&ob(XO),z=m&&(typeof YO=="function"?(ne=>oe=>ne.encode(oe))(new YO):async ne=>new Uint8Array(await new a(ne).arrayBuffer())),B=y&&i&&QO(()=>{let ne=!1;const oe=new a(Qc.origin,{body:new XO,method:"POST",get duplex(){return ne=!0,"half"}}).headers.has("Content-Type");return ne&&!oe}),F=T&&i&&QO(()=>vr.isReadableStream(new l("").body)),G={stream:F&&(ne=>ne.body)};m&&["text","arrayBuffer","blob","formData","stream"].forEach(ne=>{!G[ne]&&(G[ne]=(oe,ue)=>{let ye=oe&&oe[ne];if(ye)return ye.call(oe);throw new po(`Response type '${ne}' is not supported`,po.ERR_NOT_SUPPORT,ue)})});const Q=async ne=>{if(ne==null)return 0;if(vr.isBlob(ne))return ne.size;if(vr.isSpecCompliantForm(ne))return(await new a(Qc.origin,{method:"POST",body:ne}).arrayBuffer()).byteLength;if(vr.isArrayBufferView(ne)||vr.isArrayBuffer(ne))return ne.byteLength;if(vr.isURLSearchParams(ne)&&(ne=ne+""),vr.isString(ne))return(await z(ne)).byteLength},te=async(ne,oe)=>{const ue=vr.toFiniteNumber(ne.getContentLength());return ue??Q(oe)};return async ne=>{let{url:oe,method:ue,data:ye,signal:we,cancelToken:ve,timeout:Ce,onDownloadProgress:Ee,onUploadProgress:Be,responseType:Ke,headers:st,withCredentials:dt="same-origin",fetchOptions:bt}=B5(ne),ht=r||fetch;Ke=Ke?(Ke+"").toLowerCase():"text";let Re=WJ([we,ve&&ve.toAbortSignal()],Ce),Pt=null;const wt=Re&&Re.unsubscribe&&(()=>{Re.unsubscribe()});let Et;try{if(Be&&B&&ue!=="get"&&ue!=="head"&&(Et=await te(st,ye))!==0){let Vt=new a(oe,{method:"POST",body:ye,duplex:"half"}),Jt;if(vr.isFormData(ye)&&(Jt=Vt.headers.get("content-type"))&&st.setContentType(Jt),Vt.body){const[Cr,ln]=GO(Et,Hb(HO(Be)));ye=WO(Vt.body,ZO,Cr,ln)}}vr.isString(dt)||(dt=dt?"include":"omit");const et=y&&"credentials"in a.prototype,Zt={...bt,signal:Re,method:ue.toUpperCase(),headers:st.normalize().toJSON(),body:ye,duplex:"half",credentials:et?dt:void 0};Pt=y&&new a(oe,Zt);let ir=await(y?ht(Pt,bt):ht(oe,Zt));const or=F&&(Ke==="stream"||Ke==="response");if(F&&(Ee||or&&wt)){const Vt={};["status","statusText","headers"].forEach(tn=>{Vt[tn]=ir[tn]});const Jt=vr.toFiniteNumber(ir.headers.get("content-length")),[Cr,ln]=Ee&&GO(Jt,Hb(HO(Ee),!0))||[];ir=new l(WO(ir.body,ZO,Cr,()=>{ln&&ln(),wt&&wt()}),Vt)}Ke=Ke||"text";let ft=await G[vr.findKey(G,Ke)||"text"](ir,ne);return!or&&wt&&wt(),await new Promise((Vt,Jt)=>{z5(Vt,Jt,{data:ft,headers:Rh.from(ir.headers),status:ir.status,statusText:ir.statusText,config:ne,request:Pt})})}catch(et){throw wt&&wt(),et&&et.name==="TypeError"&&/Load failed|fetch/i.test(et.message)?Object.assign(new po("Network Error",po.ERR_NETWORK,ne,Pt),{cause:et.cause||et}):po.from(et,et&&et.code,ne,Pt)}}},JJ=new Map,F5=e=>{let r=e?e.env:{};const{fetch:a,Request:l,Response:m}=r,y=[l,m,a];let T=y.length,i=T,z,B,F=JJ;for(;i--;)z=y[i],B=F.get(z),B===void 0&&F.set(z,B=i?new Map:KJ(r)),F=B;return B};F5();const gC={http:AJ,xhr:qJ,fetch:{get:F5}};vr.forEach(gC,(e,r)=>{if(e){try{Object.defineProperty(e,"name",{value:r})}catch{}Object.defineProperty(e,"adapterName",{value:r})}});const KO=e=>`- ${e}`,eee=e=>vr.isFunction(e)||e===null||e===!1,N5={getAdapter:(e,r)=>{e=vr.isArray(e)?e:[e];const{length:a}=e;let l,m;const y={};for(let T=0;T<a;T++){l=e[T];let i;if(m=l,!eee(l)&&(m=gC[(i=String(l)).toLowerCase()],m===void 0))throw new po(`Unknown adapter '${i}'`);if(m&&(vr.isFunction(m)||(m=m.get(r))))break;y[i||"#"+T]=m}if(!m){const T=Object.entries(y).map(([z,B])=>`adapter ${z} `+(B===!1?"is not supported by the environment":"is not available in the build"));let i=a?T.length>1?`since :
`+T.map(KO).join(`
`):" "+KO(T[0]):"as no adapter specified";throw new po("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return m},adapters:gC};function uT(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ay(null,e)}function JO(e){return uT(e),e.headers=Rh.from(e.headers),e.data=cT.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),N5.getAdapter(e.adapter||Sx.adapter,e)(e).then(function(l){return uT(e),l.data=cT.call(e,e.transformResponse,l),l.headers=Rh.from(l.headers),l},function(l){return k5(l)||(uT(e),l&&l.response&&(l.response.data=cT.call(e,e.transformResponse,l.response),l.response.headers=Rh.from(l.response.headers))),Promise.reject(l)})}const j5="1.12.2",a2={};["object","boolean","number","function","string","symbol"].forEach((e,r)=>{a2[e]=function(l){return typeof l===e||"a"+(r<1?"n ":" ")+e}});const ek={};a2.transitional=function(r,a,l){function m(y,T){return"[Axios v"+j5+"] Transitional option '"+y+"'"+T+(l?". "+l:"")}return(y,T,i)=>{if(r===!1)throw new po(m(T," has been removed"+(a?" in "+a:"")),po.ERR_DEPRECATED);return a&&!ek[T]&&(ek[T]=!0,console.warn(m(T," has been deprecated since v"+a+" and will be removed in the near future"))),r?r(y,T,i):!0}};a2.spelling=function(r){return(a,l)=>(console.warn(`${l} is likely a misspelling of ${r}`),!0)};function tee(e,r,a){if(typeof e!="object")throw new po("options must be an object",po.ERR_BAD_OPTION_VALUE);const l=Object.keys(e);let m=l.length;for(;m-- >0;){const y=l[m],T=r[y];if(T){const i=e[y],z=i===void 0||T(i,y,e);if(z!==!0)throw new po("option "+y+" must be "+z,po.ERR_BAD_OPTION_VALUE);continue}if(a!==!0)throw new po("Unknown option "+y,po.ERR_BAD_OPTION)}}const Ib={assertOptions:tee,validators:a2},Lp=Ib.validators;let hg=class{constructor(r){this.defaults=r||{},this.interceptors={request:new VO,response:new VO}}async request(r,a){try{return await this._request(r,a)}catch(l){if(l instanceof Error){let m={};Error.captureStackTrace?Error.captureStackTrace(m):m=new Error;const y=m.stack?m.stack.replace(/^.+\n/,""):"";try{l.stack?y&&!String(l.stack).endsWith(y.replace(/^.+\n.+\n/,""))&&(l.stack+=`
`+y):l.stack=y}catch{}}throw l}}_request(r,a){typeof r=="string"?(a=a||{},a.url=r):a=r||{},a=gg(this.defaults,a);const{transitional:l,paramsSerializer:m,headers:y}=a;l!==void 0&&Ib.assertOptions(l,{silentJSONParsing:Lp.transitional(Lp.boolean),forcedJSONParsing:Lp.transitional(Lp.boolean),clarifyTimeoutError:Lp.transitional(Lp.boolean)},!1),m!=null&&(vr.isFunction(m)?a.paramsSerializer={serialize:m}:Ib.assertOptions(m,{encode:Lp.function,serialize:Lp.function},!0)),a.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?a.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:a.allowAbsoluteUrls=!0),Ib.assertOptions(a,{baseUrl:Lp.spelling("baseURL"),withXsrfToken:Lp.spelling("withXSRFToken")},!0),a.method=(a.method||this.defaults.method||"get").toLowerCase();let T=y&&vr.merge(y.common,y[a.method]);y&&vr.forEach(["delete","get","head","post","put","patch","common"],ne=>{delete y[ne]}),a.headers=Rh.concat(T,y);const i=[];let z=!0;this.interceptors.request.forEach(function(oe){typeof oe.runWhen=="function"&&oe.runWhen(a)===!1||(z=z&&oe.synchronous,i.unshift(oe.fulfilled,oe.rejected))});const B=[];this.interceptors.response.forEach(function(oe){B.push(oe.fulfilled,oe.rejected)});let F,G=0,Q;if(!z){const ne=[JO.bind(this),void 0];for(ne.unshift(...i),ne.push(...B),Q=ne.length,F=Promise.resolve(a);G<Q;)F=F.then(ne[G++],ne[G++]);return F}Q=i.length;let te=a;for(;G<Q;){const ne=i[G++],oe=i[G++];try{te=ne(te)}catch(ue){oe.call(this,ue);break}}try{F=JO.call(this,te)}catch(ne){return Promise.reject(ne)}for(G=0,Q=B.length;G<Q;)F=F.then(B[G++],B[G++]);return F}getUri(r){r=gg(this.defaults,r);const a=L5(r.baseURL,r.url,r.allowAbsoluteUrls);return R5(a,r.params,r.paramsSerializer)}};vr.forEach(["delete","get","head","options"],function(r){hg.prototype[r]=function(a,l){return this.request(gg(l||{},{method:r,url:a,data:(l||{}).data}))}});vr.forEach(["post","put","patch"],function(r){function a(l){return function(y,T,i){return this.request(gg(i||{},{method:r,headers:l?{"Content-Type":"multipart/form-data"}:{},url:y,data:T}))}}hg.prototype[r]=a(),hg.prototype[r+"Form"]=a(!0)});let ree=class U5{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let a;this.promise=new Promise(function(y){a=y});const l=this;this.promise.then(m=>{if(!l._listeners)return;let y=l._listeners.length;for(;y-- >0;)l._listeners[y](m);l._listeners=null}),this.promise.then=m=>{let y;const T=new Promise(i=>{l.subscribe(i),y=i}).then(m);return T.cancel=function(){l.unsubscribe(y)},T},r(function(y,T,i){l.reason||(l.reason=new ay(y,T,i),a(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const a=this._listeners.indexOf(r);a!==-1&&this._listeners.splice(a,1)}toAbortSignal(){const r=new AbortController,a=l=>{r.abort(l)};return this.subscribe(a),r.signal.unsubscribe=()=>this.unsubscribe(a),r.signal}static source(){let r;return{token:new U5(function(m){r=m}),cancel:r}}};function nee(e){return function(a){return e.apply(null,a)}}function iee(e){return vr.isObject(e)&&e.isAxiosError===!0}const _C={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_C).forEach(([e,r])=>{_C[r]=e});function V5(e){const r=new hg(e),a=y5(hg.prototype.request,r);return vr.extend(a,hg.prototype,r,{allOwnKeys:!0}),vr.extend(a,r,null,{allOwnKeys:!0}),a.create=function(m){return V5(gg(e,m))},a}const nl=V5(Sx);nl.Axios=hg;nl.CanceledError=ay;nl.CancelToken=ree;nl.isCancel=k5;nl.VERSION=j5;nl.toFormData=o2;nl.AxiosError=po;nl.Cancel=nl.CanceledError;nl.all=function(r){return Promise.all(r)};nl.spread=nee;nl.isAxiosError=iee;nl.mergeConfig=gg;nl.AxiosHeaders=Rh;nl.formToJSON=e=>O5(vr.isHTMLForm(e)?new FormData(e):e);nl.getAdapter=N5.getAdapter;nl.HttpStatusCode=_C;nl.default=nl;const{Axios:nAe,AxiosError:iAe,CanceledError:oAe,isCancel:aAe,CancelToken:sAe,VERSION:lAe,all:cAe,Cancel:uAe,isAxiosError:hAe,spread:fAe,toFormData:dAe,AxiosHeaders:pAe,HttpStatusCode:mAe,formToJSON:AAe,getAdapter:gAe,mergeConfig:_Ae}=nl,oee="http://185.197.195.71:3333",aee="http://185.197.195.71:3344",ol=nl.create({baseURL:oee,headers:{"Content-Type":"application/json"}});ol.interceptors.request.use(e=>{const r=localStorage.getItem("access_token");return r&&(e.headers.Authorization=`Bearer ${r}`),e});ol.interceptors.request.use(e=>(console.log(" Request:",{url:e.url,method:e.method,headers:e.headers,data:e.data,params:e.params}),e),e=>(console.error(" Request error:",e),Promise.reject(e)));ol.interceptors.response.use(e=>(console.log(" Response:",{url:e.config.url,status:e.status,data:e.data}),e),e=>{if(e.response){const r=e.response.data;for(const a of r.errors)for(const l of a.messages)Zo.error(`${a.property}.${l.name}`);console.error(" Response error:",{url:e.config?.url,status:e.response.status,data:e.response.data})}else console.error(" Network/Unknown error:",e.message);return Promise.reject(e)});const see=async(e,r=1)=>(await ol.get("/driver",{params:{page:e,pageSize:r}})).data,lee=async e=>(await ol.post("/auth/register/driver",e)).data,cee=async e=>(await ol.get("/driver/by-phone",{params:{phone:e}})).data,uee=async(e,r)=>(await ol.post(`/driver/${e}/withdraw`,{amount:r})).data,Rv=e=>{const[r,a]=ae.useState(null),[l,m]=ae.useState(0),[y,T]=ae.useState(!1),i=B=>{const F=B.target.files?.[0]||null;a(F),T(!1),m(0)},z=async()=>{if(!r||y||l!=0)return;const B=new FormData;B.append("file",r);try{const F=await ol.post("/file",B,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:G=>{if(G.total){const Q=Math.round(G.loaded*100/G.total);m(Q)}}});console.log(" :",F.data),T(!0),e.onUploaded(F.data.url)}catch(F){console.error(" :",F)}m(0)};return be.jsxs(bo,{sx:{maxWidth:500,mx:"auto",position:"relative"},children:[be.jsx("input",{type:"file",id:e.label,onChange:i,style:{display:"none"}}),be.jsxs(vq,{variant:"outlined",color:y?"success":"info",children:[be.jsx("label",{htmlFor:e.label,children:be.jsx(Tf,{component:"span",children:r?r.name:" "})}),be.jsx(Tf,{variant:"outlined",color:y?"success":"info",onClick:z,disabled:!r,children:y?be.jsx(VQ,{}):be.jsx(qQ,{})})]}),l>0&&be.jsx(bo,{mt:2,children:be.jsx(YW,{variant:"determinate",value:l})}),be.jsx(tl,{sx:{position:"absolute",top:-10,left:15,zIndex:10,backgroundColor:"#fff",color:"#898989"},variant:"body2",children:e.label})]})},sy=e=>be.jsx(ds,{size:"small",label:" ",value:e.value,onChange:e.onChange,name:"phone",fullWidth:!0,slotProps:{input:{startAdornment:be.jsx(BW,{position:"start",children:"+998"})}}}),tk=()=>{const[e,r]=ae.useState(""),[a,l]=ae.useState(""),[m,y]=ae.useState(""),[T,i]=ae.useState(""),[z,B]=ae.useState(""),[F,G]=ae.useState(""),[Q,te]=ae.useState(""),[ne,oe]=ae.useState(0),[ue,ye]=ae.useState(0),[we,ve]=ae.useState(""),[Ce,Ee]=ae.useState(""),[Be,Ke]=ae.useState(""),st=ae.useMemo(()=>z&&Be&&e&&we&&Ce,[z,Be,e,we,Ce]),dt=async bt=>{bt.preventDefault(),await lee({phone:`+998${e}`,name:a,password:m,tariff:T,avatarFileId:z,carNumber:F,carYear:ne,carModel:Q,experienceYears:ue,techPassport:we,licenseNumber:Be,passportNumber:Ce}),Zo.success("  ")};return console.log("rerender"),be.jsxs(bo,{sx:{maxWidth:900,mx:"auto"},children:[be.jsx(tl,{variant:"h6",gutterBottom:!0,children:" "}),be.jsx(bo,{component:"form",onSubmit:dt,children:be.jsxs(eC,{container:!0,spacing:2,children:[be.jsx(sy,{value:e,onChange:bt=>r(bt.target.value)}),be.jsx(ds,{size:"small",label:"",name:"name",value:a,onChange:bt=>l(bt.target.value),fullWidth:!0,required:!0}),be.jsx(ds,{size:"small",label:"",type:"password",name:"password",value:m,onChange:bt=>y(bt.target.value),required:!0}),be.jsxs(ds,{size:"small",select:!0,label:"",name:"tariff",value:T,onChange:bt=>i(bt.target.value),required:!0,sx:{width:130},children:[be.jsx(KA,{value:"start",children:""}),be.jsx(KA,{value:"comfort",children:""}),be.jsx(KA,{value:"business",children:""}),be.jsx(KA,{value:"damas",children:""}),be.jsx(KA,{value:"scooter",children:""}),be.jsx(KA,{value:"passengerCar",children:""}),be.jsx(KA,{value:"labo",children:""})]}),be.jsx(Rv,{label:"",onUploaded:B}),be.jsx(ds,{size:"small",label:" ",name:"carNumber",value:F,onChange:bt=>G(bt.target.value),required:!0}),be.jsx(ds,{size:"small",label:" ",name:"carModel",value:Q,onChange:bt=>te(bt.target.value),required:!0}),be.jsx(ds,{size:"small",label:"  ( 1900)",name:"carYear",value:ne,onChange:bt=>oe(+bt.target.value),required:!0}),be.jsx(ds,{size:"small",label:"  ()",name:"experienceYears",type:"number",value:ue,onChange:bt=>ye(+bt.target.value),required:!0}),be.jsx(Rv,{label:" ",onUploaded:ve}),be.jsx(Rv,{label:"",onUploaded:Ke}),be.jsx(Rv,{label:"",onUploaded:Ee}),be.jsx(Tf,{type:"submit",variant:"contained",color:"primary",disabled:!st,children:""})]})}),be.jsx(Xp,{})]})},hee=async e=>(await ol.get("/client/by-phone",{params:{phone:e}})).data,fee=async(e,r)=>(await ol.post(`/client/${e}/add-bonus`,{amount:r})).data,hT=()=>{const[e,r]=ae.useState(""),[a,l]=ae.useState(""),[m,y]=ae.useState(!1),T=async i=>{i.preventDefault(),y(!0);try{const z=await hee(`998${e}`);await fee(z.id,Number(a)),r(""),Zo.success("  ")}finally{y(!1)}};return be.jsxs(bo,{sx:{maxWidth:400},children:[be.jsx(tl,{variant:"h6",gutterBottom:!0,children:"  "}),be.jsxs(bo,{component:"form",onSubmit:T,sx:{display:"flex",flexDirection:"column",gap:2},children:[be.jsx(sy,{value:e,onChange:i=>r(i.target.value)}),be.jsx(ds,{size:"small",label:" ( )",type:"number",value:a,onChange:i=>l(Number(i.target.value)),fullWidth:!0,required:!0}),be.jsx(Tf,{type:"submit",variant:"contained",color:"primary",disabled:m,children:m?be.jsx(c0,{size:20}):" "})]}),be.jsx(Xp,{})]})},dee=async()=>(await ol.get("/banner")).data,pee=async e=>(await ol.delete(`/banner/${e}`)).data,mee=async(e,r)=>(await ol.post("/banner",{imageUrl:e,clickUrl:r})).data,Aee=()=>{const[e,r]=ae.useState(""),[a,l]=ae.useState(""),[m,y]=ae.useState(!1),[T,i]=ae.useState([]);ae.useEffect(()=>{z()},[]);const z=async()=>{y(!0),await new Promise(Q=>setTimeout(Q,1500));const G=await dee();i(G.banners),y(!1)},B=async()=>{const G=await mee(e,a);Zo.success(" "),i([G,...T])},F=async G=>{await pee(G),i(T.filter(Q=>Q.id!==G))};return be.jsxs(bo,{sx:{width:"calc(100vw - 300px)"},children:[be.jsxs(bo,{sx:{display:"flex",gap:2,mb:2},children:[be.jsx(Rv,{label:" (9 : 16)",onUploaded:G=>r(aee+G)}),be.jsx(bo,{sx:{flex:1},children:be.jsx(ds,{size:"small",label:"",helperText:"   ",variant:"outlined",value:a,onChange:G=>l(G.target.value),fullWidth:!0})}),be.jsx(bo,{sx:{display:"flex",flexDirection:"column"},children:be.jsx(Tf,{variant:"contained",onClick:B,children:""})})]}),be.jsx(tl,{variant:"h6",sx:{pb:2},children:""}),m?be.jsx(bo,{sx:{display:"flex",justifyContent:"center",mt:4},children:be.jsx(c0,{})}):be.jsx(be.Fragment,{}),be.jsx(eC,{container:!0,spacing:2,children:T.map((G,Q)=>be.jsx(eC,{children:be.jsxs(bo,{sx:{position:"relative",width:"100%",height:200,overflow:"hidden",borderRadius:2,cursor:"pointer","&:hover .overlay":{opacity:1}},children:[be.jsx(bo,{component:"img",src:G.imageUrl,alt:`img-${Q}`,sx:{width:"100%",height:"100%",objectFit:"cover",aspectRatio:"16 / 9"}}),be.jsxs(bo,{className:"overlay",onClick:te=>{te.stopPropagation(),window.open(G.clickUrl)},sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",bgcolor:"rgba(0, 0, 0, 0.5)",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",opacity:0,transition:"opacity 0.3s ease",p:0},children:[be.jsx(tl,{sx:{mt:"auto",mb:"auto"},children:",  "}),be.jsx(DH,{onClick:te=>{te.stopPropagation(),F(G.id)},sx:{color:"red",bgcolor:"rgba(255,255,255,0.1)","&:hover":{bgcolor:"rgba(255,255,255,0.2)"}},children:be.jsx($Q,{})})]})]})},Q))}),be.jsx(Xp,{})]})},gee={start:"",comfort:"",business:"",damas:"",passengerCar:"",scooter:"",labo:""},rk=50,fT=()=>{const[e,r]=OQ(),[a,l]=ae.useState([]),[m,y]=ae.useState(!0),[T,i]=ae.useState(0),z=parseInt(e.get("page")||"1");ae.useEffect(()=>{(async()=>{y(!0);try{const Q=await see(z,rk);l(Q.data),i(Q.total)}catch(Q){console.error("   :",Q)}finally{y(!1)}})()},[z]);const B=(G,Q)=>{r({page:Q.toString()})},F=Math.ceil(T/rk);return be.jsxs(bo,{sx:{width:"calc(100vw - 300px)",p:2},children:[be.jsx(tl,{variant:"h5",gutterBottom:!0,children:""}),m?be.jsx(bo,{sx:{display:"flex",justifyContent:"center",mt:4},children:be.jsx(c0,{})}):be.jsxs(be.Fragment,{children:[be.jsx(QB,{component:dx,children:be.jsx(XB,{size:"small",children:be.jsxs(YB,{children:[be.jsxs($b,{sx:{backgroundColor:"#f0f0f0"},children:[be.jsx(Vs,{children:"ID"}),be.jsx(Vs,{align:"right",children:""}),be.jsx(Vs,{align:"right",children:" "}),be.jsx(Vs,{align:"right",children:" "}),be.jsx(Vs,{align:"right",children:""}),be.jsx(Vs,{align:"center",children:""}),be.jsx(Vs,{align:"center",children:""}),be.jsx(Vs,{align:"right",children:""})]}),a.map(G=>be.jsxs($b,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[be.jsxs(Vs,{children:["#",G.id.substring(0,5)]}),be.jsx(Vs,{align:"right",children:G.account.name}),be.jsx(Vs,{align:"right",children:G.info.carModel}),be.jsx(Vs,{align:"right",children:G.info.carNumber}),be.jsx(Vs,{align:"right",children:gee[G.tariff]}),be.jsx(Vs,{align:"center",children:G.rating??"-"}),be.jsx(Vs,{align:"center",children:G.isActive?"":""}),be.jsx(Vs,{align:"center"})]},G.id))]})})}),be.jsx(bo,{sx:{display:"flex",justifyContent:"center",mt:2},children:be.jsx(aX,{count:F,page:z,onChange:B,color:"primary"})})]}),be.jsx(Xp,{})]})},_ee=async(e,r,a)=>await ol.post("/auth/login",{role:e,phone:r,password:a});function yee(){const[e,r]=ae.useState("admin"),[a,l]=ae.useState(""),[m,y]=ae.useState(""),T=gx(),i=async()=>{const z=await _ee(e,`+998${a}`,m);localStorage.setItem("role",e),localStorage.setItem("access_token",z.data.accessToken),localStorage.setItem("refresh_token",z.data.refreshToken),e=="superAdmin"?T("/super-admin"):T(`/${e}`)};return be.jsxs(Eq,{sx:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundColor:"#f5f5f5"},children:[be.jsxs(dx,{elevation:3,sx:{p:4,border:"1px solid #ddd",width:"100%",maxWidth:400},children:[be.jsx(tl,{variant:"h5",align:"center",mb:2,children:""}),be.jsx(z3,{component:"fieldset",fullWidth:!0,children:be.jsxs(xX,{row:!0,value:e,onChange:z=>r(z.target.value),sx:{justifyContent:"center",mb:2},children:[be.jsx(JS,{value:"admin",control:be.jsx(rT,{}),label:"Admin"}),be.jsx(JS,{value:"superAdmin",control:be.jsx(rT,{}),label:"Super Admin"}),be.jsx(JS,{value:"support",control:be.jsx(rT,{}),label:"Support"})]})}),be.jsx(bo,{sx:{mb:1},children:be.jsx(sy,{value:a,onChange:z=>l(z.target.value)})}),be.jsx(ds,{size:"small",label:"",type:"password",variant:"outlined",fullWidth:!0,value:m,onChange:z=>y(z.target.value),sx:{mb:2}}),be.jsx(Tf,{variant:"contained",color:"primary",fullWidth:!0,onClick:i,children:""})]}),be.jsx(Xp,{})]})}const vee=async(e,r,a)=>(await ol.post("/auth/register/admin",{name:e,phone:r,password:a})).data,xee=()=>{const[e,r]=ae.useState(""),[a,l]=ae.useState(""),[m,y]=ae.useState(""),T=async()=>{await vee(e,"+998"+a,m),Zo.success("  ")};return be.jsxs(bo,{children:[be.jsx(tl,{variant:"h6",gutterBottom:!0,children:" "}),be.jsxs(bo,{component:"form",sx:{display:"flex",flexDirection:"column",gap:2},children:[be.jsx(ds,{size:"small",label:"",value:e,onChange:i=>r(i.target.value),fullWidth:!0}),be.jsx(sy,{value:a,onChange:i=>l(i.target.value)}),be.jsx(ds,{size:"small",label:"",type:"password",name:"password",value:m,onChange:i=>y(i.target.value),fullWidth:!0}),be.jsx(Tf,{variant:"contained",color:"primary",onClick:T,children:""})]}),be.jsx(Xp,{})]})},bee=async(e,r,a)=>(await ol.post("/auth/register/support",{name:e,phone:r,password:a})).data,nk=()=>{const[e,r]=ae.useState(""),[a,l]=ae.useState(""),[m,y]=ae.useState(""),T=async()=>{await bee(e,a,m),Zo.success(" ")};return be.jsxs(bo,{children:[be.jsx(tl,{variant:"h6",gutterBottom:!0,children:" ."}),be.jsxs(bo,{component:"form",sx:{display:"flex",flexDirection:"column",gap:2},children:[be.jsx(ds,{size:"small",label:"",value:e,onChange:i=>r(i.target.value),fullWidth:!0}),be.jsx(sy,{value:a,onChange:i=>l(i.target.value)}),be.jsx(ds,{size:"small",label:"",type:"password",name:"password",value:m,onChange:i=>y(i.target.value),fullWidth:!0}),be.jsx(Tf,{variant:"contained",color:"primary",onClick:T,children:""})]}),be.jsx(Xp,{})]})},wee=async()=>(await ol.get("/settings")).data,See=async e=>(await ol.put("/settings",e)).data,Tee=()=>{const[e,r]=ae.useState(null),[a,l]=ae.useState(!0),[m,y]=ae.useState(!1);ae.useEffect(()=>{(async()=>{try{const B=await wee();r(B)}finally{l(!1)}})()},[]);const T=z=>{if(!e)return;const{name:B,value:F}=z.target;r({...e,[B]:B==="systemCoefficient"?parseFloat(F):Number(F)})},i=async z=>{if(z.preventDefault(),!!e){y(!0);try{await See(e),Zo.success("")}finally{y(!1)}}};return a||!e?be.jsx(bo,{sx:{textAlign:"center",mt:4},children:be.jsx(c0,{})}):be.jsxs(bo,{children:[be.jsx(tl,{variant:"h6",gutterBottom:!0,children:" "}),be.jsxs(bo,{component:"form",onSubmit:i,sx:{display:"flex",flexDirection:"column",gap:4},children:[be.jsx(ds,{size:"small",label:"    ",name:"cancelPenalty",type:"number",value:e.cancelPenalty,onChange:T,helperText:"  :  ,  , ",fullWidth:!0}),be.jsx(ds,{size:"small",label:"   ",name:"pricePerWaitingMinute",type:"number",value:e.pricePerWaitingMinute,onChange:T,helperText:"    (   )",fullWidth:!0}),be.jsx(ds,{size:"small",label:" (%)",name:"commission",type:"number",value:e.commission,onChange:T,helperText:",     ",fullWidth:!0}),be.jsx(ds,{size:"small",label:" ",name:"systemCoefficient",type:"number",value:e.systemCoefficient,onChange:T,helperText:",     ",fullWidth:!0}),be.jsx(ds,{size:"small",label:"   ()",name:"freeWaitingTime",type:"number",value:e.freeWaitingTime,onChange:T,helperText:"   ",fullWidth:!0}),be.jsx(ds,{size:"small",label:"  (%  )",name:"bonusPercent",type:"number",value:e.bonusPercent,onChange:T,helperText:"   ",fullWidth:!0}),be.jsx(Tf,{type:"submit",variant:"contained",color:"primary",disabled:m,children:m?"...":""})]}),be.jsx(Xp,{})]})};var dT={},pT={},ik;function Eee(){return ik||(ik=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return a==="__proto__"}e.isUnsafeProperty=r})(pT)),pT}var mT={},ok;function $5(){return ok||(ok=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){switch(typeof a){case"number":case"symbol":return!1;case"string":return a.includes(".")||a.includes("[")||a.includes("]")}}e.isDeepKey=r})(mT)),mT}var AT={},ak;function G5(){return ak||(ak=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return typeof a=="string"||typeof a=="symbol"?a:Object.is(a?.valueOf?.(),-0)?"-0":String(a)}e.toKey=r})(AT)),AT}var gT={},sk;function eM(){return sk||(sk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){const l=[],m=a.length;if(m===0)return l;let y=0,T="",i="",z=!1;for(a.charCodeAt(0)===46&&(l.push(""),y++);y<m;){const B=a[y];i?B==="\\"&&y+1<m?(y++,T+=a[y]):B===i?i="":T+=B:z?B==='"'||B==="'"?i=B:B==="]"?(z=!1,l.push(T),T=""):T+=B:B==="["?(z=!0,T&&(l.push(T),T="")):B==="."?T&&(l.push(T),T=""):T+=B,y++}return T&&l.push(T),l}e.toPath=r})(gT)),gT}var lk;function tM(){return lk||(lk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Eee(),a=$5(),l=G5(),m=eM();function y(i,z,B){if(i==null)return B;switch(typeof z){case"string":{if(r.isUnsafeProperty(z))return B;const F=i[z];return F===void 0?a.isDeepKey(z)?y(i,m.toPath(z),B):B:F}case"number":case"symbol":{typeof z=="number"&&(z=l.toKey(z));const F=i[z];return F===void 0?B:F}default:{if(Array.isArray(z))return T(i,z,B);if(Object.is(z?.valueOf(),-0)?z="-0":z=String(z),r.isUnsafeProperty(z))return B;const F=i[z];return F===void 0?B:F}}}function T(i,z,B){if(z.length===0)return B;let F=i;for(let G=0;G<z.length;G++){if(F==null||r.isUnsafeProperty(z[G]))return B;F=F[z[G]]}return F===void 0?B:F}e.get=y})(dT)),dT}var _T,ck;function Cee(){return ck||(ck=1,_T=tM().get),_T}var Mee=Cee();const s2=Zp(Mee);var qd=e=>e===0?0:e>0?1:-1,ad=e=>typeof e=="number"&&e!=+e,sg=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,oo=e=>(typeof e=="number"||e instanceof Number)&&!ad(e),qp=e=>oo(e)||typeof e=="string",Iee=0,Zv=e=>{var r=++Iee;return"".concat(e||"").concat(r)},s0=function(r,a){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!oo(r)&&typeof r!="string")return l;var y;if(sg(r)){if(a==null)return l;var T=r.indexOf("%");y=a*parseFloat(r.slice(0,T))/100}else y=+r;return ad(y)&&(y=l),m&&a!=null&&y>a&&(y=a),y},H5=e=>{if(!Array.isArray(e))return!1;for(var r=e.length,a={},l=0;l<r;l++)if(!a[e[l]])a[e[l]]=!0;else return!0;return!1};function Np(e,r,a){return oo(e)&&oo(r)?e+a*(r-e):r}function q5(e,r,a){if(!(!e||!e.length))return e.find(l=>l&&(typeof r=="function"?r(l):s2(l,r))===a)}var yc=e=>e===null||typeof e>"u",rM=e=>yc(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),Pee=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function nM(e){if(typeof e!="string")return!1;var r=Pee;return r.includes(e)}var Ree=["viewBox","children"],uk=["points","pathLength"],yT={svg:Ree,polygon:uk,polyline:uk},iM=(e,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var a=e;if(ae.isValidElement(e)&&(a=e.props),typeof a!="object"&&typeof a!="function")return null;var l={};return Object.keys(a).forEach(m=>{nM(m)&&(l[m]=(y=>a[m](a,y)))}),l},Dee=(e,r,a)=>l=>(e(r,a,l),null),Oee=(e,r,a)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var l=null;return Object.keys(e).forEach(m=>{var y=e[m];nM(m)&&typeof y=="function"&&(l||(l={}),l[m]=Dee(y,r,a))}),l},kee=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function W5(e){if(typeof e!="string")return!1;var r=kee;return r.includes(e)}function wg(e){var r=Object.entries(e).filter(a=>{var[l]=a;return W5(l)});return Object.fromEntries(r)}var Z5=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,zee=(e,r,a,l)=>{var m;if(typeof r=="symbol"||typeof r=="number")return!0;var y=(m=l&&yT?.[l])!==null&&m!==void 0?m:[],T=r.startsWith("data-"),i=typeof e!="function"&&(!!l&&y.includes(r)||W5(r)),z=!!a&&nM(r);return T||i||z},Jc=(e,r,a)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var l=e;if(ae.isValidElement(e)&&(l=e.props),typeof l!="object"&&typeof l!="function")return null;var m={};return Object.keys(l).forEach(y=>{var T;zee((T=l)===null||T===void 0?void 0:T[y],y,r,a)&&(m[y]=l[y])}),m},Lee=["children","width","height","viewBox","className","style","title","desc"];function yC(){return yC=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},yC.apply(null,arguments)}function Bee(e,r){if(e==null)return{};var a,l,m=Fee(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Fee(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var X5=ae.forwardRef((e,r)=>{var{children:a,width:l,height:m,viewBox:y,className:T,style:i,title:z,desc:B}=e,F=Bee(e,Lee),G=y||{width:l,height:m,x:0,y:0},Q=on("recharts-surface",T);return ae.createElement("svg",yC({},Jc(F,!0,"svg"),{className:Q,width:l,height:m,style:i,viewBox:"".concat(G.x," ").concat(G.y," ").concat(G.width," ").concat(G.height),ref:r}),ae.createElement("title",null,z),ae.createElement("desc",null,B),a)}),Nee=["children","className"];function vC(){return vC=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},vC.apply(null,arguments)}function jee(e,r){if(e==null)return{};var a,l,m=Uee(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Uee(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var Zm=ae.forwardRef((e,r)=>{var{children:a,className:l}=e,m=jee(e,Nee),y=on("recharts-layer",l);return ae.createElement("g",vC({className:y},Jc(m,!0),{ref:r}),a)}),Vee=ae.createContext(null);function $s(e){return function(){return e}}const xC=Math.PI,bC=2*xC,tg=1e-6,$ee=bC-tg;function Y5(e){this._+=e[0];for(let r=1,a=e.length;r<a;++r)this._+=arguments[r]+e[r]}function Gee(e){let r=Math.floor(e);if(!(r>=0))throw new Error(`invalid digits: ${e}`);if(r>15)return Y5;const a=10**r;return function(l){this._+=l[0];for(let m=1,y=l.length;m<y;++m)this._+=Math.round(arguments[m]*a)/a+l[m]}}class Hee{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?Y5:Gee(r)}moveTo(r,a){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+a}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,a){this._append`L${this._x1=+r},${this._y1=+a}`}quadraticCurveTo(r,a,l,m){this._append`Q${+r},${+a},${this._x1=+l},${this._y1=+m}`}bezierCurveTo(r,a,l,m,y,T){this._append`C${+r},${+a},${+l},${+m},${this._x1=+y},${this._y1=+T}`}arcTo(r,a,l,m,y){if(r=+r,a=+a,l=+l,m=+m,y=+y,y<0)throw new Error(`negative radius: ${y}`);let T=this._x1,i=this._y1,z=l-r,B=m-a,F=T-r,G=i-a,Q=F*F+G*G;if(this._x1===null)this._append`M${this._x1=r},${this._y1=a}`;else if(Q>tg)if(!(Math.abs(G*z-B*F)>tg)||!y)this._append`L${this._x1=r},${this._y1=a}`;else{let te=l-T,ne=m-i,oe=z*z+B*B,ue=te*te+ne*ne,ye=Math.sqrt(oe),we=Math.sqrt(Q),ve=y*Math.tan((xC-Math.acos((oe+Q-ue)/(2*ye*we)))/2),Ce=ve/we,Ee=ve/ye;Math.abs(Ce-1)>tg&&this._append`L${r+Ce*F},${a+Ce*G}`,this._append`A${y},${y},0,0,${+(G*te>F*ne)},${this._x1=r+Ee*z},${this._y1=a+Ee*B}`}}arc(r,a,l,m,y,T){if(r=+r,a=+a,l=+l,T=!!T,l<0)throw new Error(`negative radius: ${l}`);let i=l*Math.cos(m),z=l*Math.sin(m),B=r+i,F=a+z,G=1^T,Q=T?m-y:y-m;this._x1===null?this._append`M${B},${F}`:(Math.abs(this._x1-B)>tg||Math.abs(this._y1-F)>tg)&&this._append`L${B},${F}`,l&&(Q<0&&(Q=Q%bC+bC),Q>$ee?this._append`A${l},${l},0,1,${G},${r-i},${a-z}A${l},${l},0,1,${G},${this._x1=B},${this._y1=F}`:Q>tg&&this._append`A${l},${l},0,${+(Q>=xC)},${G},${this._x1=r+l*Math.cos(y)},${this._y1=a+l*Math.sin(y)}`)}rect(r,a,l,m){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+a}h${l=+l}v${+m}h${-l}Z`}toString(){return this._}}function Q5(e){let r=3;return e.digits=function(a){if(!arguments.length)return r;if(a==null)r=null;else{const l=Math.floor(a);if(!(l>=0))throw new RangeError(`invalid digits: ${a}`);r=l}return e},()=>new Hee(r)}function oM(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function K5(e){this._context=e}K5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:this._context.lineTo(e,r);break}}};function l2(e){return new K5(e)}function J5(e){return e[0]}function eF(e){return e[1]}function tF(e,r){var a=$s(!0),l=null,m=l2,y=null,T=Q5(i);e=typeof e=="function"?e:e===void 0?J5:$s(e),r=typeof r=="function"?r:r===void 0?eF:$s(r);function i(z){var B,F=(z=oM(z)).length,G,Q=!1,te;for(l==null&&(y=m(te=T())),B=0;B<=F;++B)!(B<F&&a(G=z[B],B,z))===Q&&((Q=!Q)?y.lineStart():y.lineEnd()),Q&&y.point(+e(G,B,z),+r(G,B,z));if(te)return y=null,te+""||null}return i.x=function(z){return arguments.length?(e=typeof z=="function"?z:$s(+z),i):e},i.y=function(z){return arguments.length?(r=typeof z=="function"?z:$s(+z),i):r},i.defined=function(z){return arguments.length?(a=typeof z=="function"?z:$s(!!z),i):a},i.curve=function(z){return arguments.length?(m=z,l!=null&&(y=m(l)),i):m},i.context=function(z){return arguments.length?(z==null?l=y=null:y=m(l=z),i):l},i}function ab(e,r,a){var l=null,m=$s(!0),y=null,T=l2,i=null,z=Q5(B);e=typeof e=="function"?e:e===void 0?J5:$s(+e),r=typeof r=="function"?r:$s(r===void 0?0:+r),a=typeof a=="function"?a:a===void 0?eF:$s(+a);function B(G){var Q,te,ne,oe=(G=oM(G)).length,ue,ye=!1,we,ve=new Array(oe),Ce=new Array(oe);for(y==null&&(i=T(we=z())),Q=0;Q<=oe;++Q){if(!(Q<oe&&m(ue=G[Q],Q,G))===ye)if(ye=!ye)te=Q,i.areaStart(),i.lineStart();else{for(i.lineEnd(),i.lineStart(),ne=Q-1;ne>=te;--ne)i.point(ve[ne],Ce[ne]);i.lineEnd(),i.areaEnd()}ye&&(ve[Q]=+e(ue,Q,G),Ce[Q]=+r(ue,Q,G),i.point(l?+l(ue,Q,G):ve[Q],a?+a(ue,Q,G):Ce[Q]))}if(we)return i=null,we+""||null}function F(){return tF().defined(m).curve(T).context(y)}return B.x=function(G){return arguments.length?(e=typeof G=="function"?G:$s(+G),l=null,B):e},B.x0=function(G){return arguments.length?(e=typeof G=="function"?G:$s(+G),B):e},B.x1=function(G){return arguments.length?(l=G==null?null:typeof G=="function"?G:$s(+G),B):l},B.y=function(G){return arguments.length?(r=typeof G=="function"?G:$s(+G),a=null,B):r},B.y0=function(G){return arguments.length?(r=typeof G=="function"?G:$s(+G),B):r},B.y1=function(G){return arguments.length?(a=G==null?null:typeof G=="function"?G:$s(+G),B):a},B.lineX0=B.lineY0=function(){return F().x(e).y(r)},B.lineY1=function(){return F().x(e).y(a)},B.lineX1=function(){return F().x(l).y(r)},B.defined=function(G){return arguments.length?(m=typeof G=="function"?G:$s(!!G),B):m},B.curve=function(G){return arguments.length?(T=G,y!=null&&(i=T(y)),B):T},B.context=function(G){return arguments.length?(G==null?y=i=null:i=T(y=G),B):y},B}class rF{constructor(r,a){this._context=r,this._x=a}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(r,a){switch(r=+r,a=+a,this._point){case 0:{this._point=1,this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+r)/2,this._y0,this._x0,a,r,a):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+a)/2,r,this._y0,r,a);break}}this._x0=r,this._y0=a}}function qee(e){return new rF(e,!0)}function Wee(e){return new rF(e,!1)}function qb(){}function Wb(e,r,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+r)/6,(e._y0+4*e._y1+a)/6)}function nF(e){this._context=e}nF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Wb(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Wb(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function Zee(e){return new nF(e)}function iF(e){this._context=e}iF.prototype={areaStart:qb,areaEnd:qb,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._x2=e,this._y2=r;break;case 1:this._point=2,this._x3=e,this._y3=r;break;case 2:this._point=3,this._x4=e,this._y4=r,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+r)/6);break;default:Wb(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function Xee(e){return new iF(e)}function oF(e){this._context=e}oF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,l=(this._y0+4*this._y1+r)/6;this._line?this._context.lineTo(a,l):this._context.moveTo(a,l);break;case 3:this._point=4;default:Wb(this,e,r);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r}};function Yee(e){return new oF(e)}function aF(e){this._context=e}aF.prototype={areaStart:qb,areaEnd:qb,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,r){e=+e,r=+r,this._point?this._context.lineTo(e,r):(this._point=1,this._context.moveTo(e,r))}};function Qee(e){return new aF(e)}function hk(e){return e<0?-1:1}function fk(e,r,a){var l=e._x1-e._x0,m=r-e._x1,y=(e._y1-e._y0)/(l||m<0&&-0),T=(a-e._y1)/(m||l<0&&-0),i=(y*m+T*l)/(l+m);return(hk(y)+hk(T))*Math.min(Math.abs(y),Math.abs(T),.5*Math.abs(i))||0}function dk(e,r){var a=e._x1-e._x0;return a?(3*(e._y1-e._y0)/a-r)/2:r}function vT(e,r,a){var l=e._x0,m=e._y0,y=e._x1,T=e._y1,i=(y-l)/3;e._context.bezierCurveTo(l+i,m+i*r,y-i,T-i*a,y,T)}function Zb(e){this._context=e}Zb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:vT(this,this._t0,dk(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,r){var a=NaN;if(e=+e,r=+r,!(e===this._x1&&r===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;break;case 2:this._point=3,vT(this,dk(this,a=fk(this,e,r)),a);break;default:vT(this,this._t0,a=fk(this,e,r));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=r,this._t0=a}}};function sF(e){this._context=new lF(e)}(sF.prototype=Object.create(Zb.prototype)).point=function(e,r){Zb.prototype.point.call(this,r,e)};function lF(e){this._context=e}lF.prototype={moveTo:function(e,r){this._context.moveTo(r,e)},closePath:function(){this._context.closePath()},lineTo:function(e,r){this._context.lineTo(r,e)},bezierCurveTo:function(e,r,a,l,m,y){this._context.bezierCurveTo(r,e,l,a,y,m)}};function Kee(e){return new Zb(e)}function Jee(e){return new sF(e)}function cF(e){this._context=e}cF.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,r=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],r[0]):this._context.moveTo(e[0],r[0]),a===2)this._context.lineTo(e[1],r[1]);else for(var l=pk(e),m=pk(r),y=0,T=1;T<a;++y,++T)this._context.bezierCurveTo(l[0][y],m[0][y],l[1][y],m[1][y],e[T],r[T]);(this._line||this._line!==0&&a===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,r){this._x.push(+e),this._y.push(+r)}};function pk(e){var r,a=e.length-1,l,m=new Array(a),y=new Array(a),T=new Array(a);for(m[0]=0,y[0]=2,T[0]=e[0]+2*e[1],r=1;r<a-1;++r)m[r]=1,y[r]=4,T[r]=4*e[r]+2*e[r+1];for(m[a-1]=2,y[a-1]=7,T[a-1]=8*e[a-1]+e[a],r=1;r<a;++r)l=m[r]/y[r-1],y[r]-=l,T[r]-=l*T[r-1];for(m[a-1]=T[a-1]/y[a-1],r=a-2;r>=0;--r)m[r]=(T[r]-m[r+1])/y[r];for(y[a-1]=(e[a]+m[a-1])/2,r=0;r<a-1;++r)y[r]=2*e[r+1]-m[r+1];return[m,y]}function ete(e){return new cF(e)}function c2(e,r){this._context=e,this._t=r}c2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,r){switch(e=+e,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,r),this._context.lineTo(e,r);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,r)}break}}this._x=e,this._y=r}};function tte(e){return new c2(e,.5)}function rte(e){return new c2(e,0)}function nte(e){return new c2(e,1)}function $_(e,r){if((T=e.length)>1)for(var a=1,l,m,y=e[r[0]],T,i=y.length;a<T;++a)for(m=y,y=e[r[a]],l=0;l<i;++l)y[l][1]+=y[l][0]=isNaN(m[l][1])?m[l][0]:m[l][1]}function wC(e){for(var r=e.length,a=new Array(r);--r>=0;)a[r]=r;return a}function ite(e,r){return e[r]}function ote(e){const r=[];return r.key=e,r}function ate(){var e=$s([]),r=wC,a=$_,l=ite;function m(y){var T=Array.from(e.apply(this,arguments),ote),i,z=T.length,B=-1,F;for(const G of y)for(i=0,++B;i<z;++i)(T[i][B]=[0,+l(G,T[i].key,B,y)]).data=G;for(i=0,F=oM(r(T));i<z;++i)T[F[i]].index=i;return a(T,F),T}return m.keys=function(y){return arguments.length?(e=typeof y=="function"?y:$s(Array.from(y)),m):e},m.value=function(y){return arguments.length?(l=typeof y=="function"?y:$s(+y),m):l},m.order=function(y){return arguments.length?(r=y==null?wC:typeof y=="function"?y:$s(Array.from(y)),m):r},m.offset=function(y){return arguments.length?(a=y??$_,m):a},m}function ste(e,r){if((l=e.length)>0){for(var a,l,m=0,y=e[0].length,T;m<y;++m){for(T=a=0;a<l;++a)T+=e[a][m][1]||0;if(T)for(a=0;a<l;++a)e[a][m][1]/=T}$_(e,r)}}function lte(e,r){if((m=e.length)>0){for(var a=0,l=e[r[0]],m,y=l.length;a<y;++a){for(var T=0,i=0;T<m;++T)i+=e[T][a][1]||0;l[a][1]+=l[a][0]=-i/2}$_(e,r)}}function cte(e,r){if(!(!((T=e.length)>0)||!((y=(m=e[r[0]]).length)>0))){for(var a=0,l=1,m,y,T;l<y;++l){for(var i=0,z=0,B=0;i<T;++i){for(var F=e[r[i]],G=F[l][1]||0,Q=F[l-1][1]||0,te=(G-Q)/2,ne=0;ne<i;++ne){var oe=e[r[ne]],ue=oe[l][1]||0,ye=oe[l-1][1]||0;te+=ue-ye}z+=G,B+=te*G}m[l-1][1]+=m[l-1][0]=a,z&&(a-=B/z)}m[l-1][1]+=m[l-1][0]=a,$_(e,r)}}var xT={},bT={},mk;function ute(){return mk||(mk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a,l){const m=new Map;for(let y=0;y<a.length;y++){const T=a[y],i=l(T);m.has(i)||m.set(i,T)}return Array.from(m.values())}e.uniqBy=r})(bT)),bT}var wT={},Ak;function uF(){return Ak||(Ak=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return a}e.identity=r})(wT)),wT}var ST={},TT={},ET={},gk;function hte(){return gk||(gk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return Number.isSafeInteger(a)&&a>=0}e.isLength=r})(ET)),ET}var _k;function aM(){return _k||(_k=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=hte();function a(l){return l!=null&&typeof l!="function"&&r.isLength(l.length)}e.isArrayLike=a})(TT)),TT}var CT={},yk;function fte(){return yk||(yk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return typeof a=="object"&&a!==null}e.isObjectLike=r})(CT)),CT}var vk;function dte(){return vk||(vk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=aM(),a=fte();function l(m){return a.isObjectLike(m)&&r.isArrayLike(m)}e.isArrayLikeObject=l})(ST)),ST}var MT={},IT={},xk;function pte(){return xk||(xk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=tM();function a(l){return function(m){return r.get(m,l)}}e.property=a})(IT)),IT}var PT={},RT={},DT={},OT={},bk;function hF(){return bk||(bk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return a!==null&&(typeof a=="object"||typeof a=="function")}e.isObject=r})(OT)),OT}var kT={},wk;function fF(){return wk||(wk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return a==null||typeof a!="object"&&typeof a!="function"}e.isPrimitive=r})(kT)),kT}var zT={},Sk;function dF(){return Sk||(Sk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a,l){return a===l||Number.isNaN(a)&&Number.isNaN(l)}e.eq=r})(zT)),zT}var Tk;function mte(){return Tk||(Tk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=sM(),a=hF(),l=fF(),m=dF();function y(G,Q,te){return typeof te!="function"?r.isMatch(G,Q):T(G,Q,function ne(oe,ue,ye,we,ve,Ce){const Ee=te(oe,ue,ye,we,ve,Ce);return Ee!==void 0?!!Ee:T(oe,ue,ne,Ce)},new Map)}function T(G,Q,te,ne){if(Q===G)return!0;switch(typeof Q){case"object":return i(G,Q,te,ne);case"function":return Object.keys(Q).length>0?T(G,{...Q},te,ne):m.eq(G,Q);default:return a.isObject(G)?typeof Q=="string"?Q==="":!0:m.eq(G,Q)}}function i(G,Q,te,ne){if(Q==null)return!0;if(Array.isArray(Q))return B(G,Q,te,ne);if(Q instanceof Map)return z(G,Q,te,ne);if(Q instanceof Set)return F(G,Q,te,ne);const oe=Object.keys(Q);if(G==null)return oe.length===0;if(oe.length===0)return!0;if(ne&&ne.has(Q))return ne.get(Q)===G;ne&&ne.set(Q,G);try{for(let ue=0;ue<oe.length;ue++){const ye=oe[ue];if(!l.isPrimitive(G)&&!(ye in G)||Q[ye]===void 0&&G[ye]!==void 0||Q[ye]===null&&G[ye]!==null||!te(G[ye],Q[ye],ye,G,Q,ne))return!1}return!0}finally{ne&&ne.delete(Q)}}function z(G,Q,te,ne){if(Q.size===0)return!0;if(!(G instanceof Map))return!1;for(const[oe,ue]of Q.entries()){const ye=G.get(oe);if(te(ye,ue,oe,G,Q,ne)===!1)return!1}return!0}function B(G,Q,te,ne){if(Q.length===0)return!0;if(!Array.isArray(G))return!1;const oe=new Set;for(let ue=0;ue<Q.length;ue++){const ye=Q[ue];let we=!1;for(let ve=0;ve<G.length;ve++){if(oe.has(ve))continue;const Ce=G[ve];let Ee=!1;if(te(Ce,ye,ue,G,Q,ne)&&(Ee=!0),Ee){oe.add(ve),we=!0;break}}if(!we)return!1}return!0}function F(G,Q,te,ne){return Q.size===0?!0:G instanceof Set?B([...G],[...Q],te,ne):!1}e.isMatchWith=y,e.isSetMatch=F})(DT)),DT}var Ek;function sM(){return Ek||(Ek=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=mte();function a(l,m){return r.isMatchWith(l,m,()=>{})}e.isMatch=a})(RT)),RT}var LT={},BT={},FT={},Ck;function Ate(){return Ck||(Ck=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return Object.getOwnPropertySymbols(a).filter(l=>Object.prototype.propertyIsEnumerable.call(a,l))}e.getSymbols=r})(FT)),FT}var NT={},Mk;function pF(){return Mk||(Mk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return a==null?a===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(a)}e.getTag=r})(NT)),NT}var jT={},Ik;function mF(){return Ik||(Ik=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r="[object RegExp]",a="[object String]",l="[object Number]",m="[object Boolean]",y="[object Arguments]",T="[object Symbol]",i="[object Date]",z="[object Map]",B="[object Set]",F="[object Array]",G="[object Function]",Q="[object ArrayBuffer]",te="[object Object]",ne="[object Error]",oe="[object DataView]",ue="[object Uint8Array]",ye="[object Uint8ClampedArray]",we="[object Uint16Array]",ve="[object Uint32Array]",Ce="[object BigUint64Array]",Ee="[object Int8Array]",Be="[object Int16Array]",Ke="[object Int32Array]",st="[object BigInt64Array]",dt="[object Float32Array]",bt="[object Float64Array]";e.argumentsTag=y,e.arrayBufferTag=Q,e.arrayTag=F,e.bigInt64ArrayTag=st,e.bigUint64ArrayTag=Ce,e.booleanTag=m,e.dataViewTag=oe,e.dateTag=i,e.errorTag=ne,e.float32ArrayTag=dt,e.float64ArrayTag=bt,e.functionTag=G,e.int16ArrayTag=Be,e.int32ArrayTag=Ke,e.int8ArrayTag=Ee,e.mapTag=z,e.numberTag=l,e.objectTag=te,e.regexpTag=r,e.setTag=B,e.stringTag=a,e.symbolTag=T,e.uint16ArrayTag=we,e.uint32ArrayTag=ve,e.uint8ArrayTag=ue,e.uint8ClampedArrayTag=ye})(jT)),jT}var UT={},Pk;function gte(){return Pk||(Pk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)}e.isTypedArray=r})(UT)),UT}var Rk;function AF(){return Rk||(Rk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Ate(),a=pF(),l=mF(),m=fF(),y=gte();function T(F,G){return i(F,void 0,F,new Map,G)}function i(F,G,Q,te=new Map,ne=void 0){const oe=ne?.(F,G,Q,te);if(oe!==void 0)return oe;if(m.isPrimitive(F))return F;if(te.has(F))return te.get(F);if(Array.isArray(F)){const ue=new Array(F.length);te.set(F,ue);for(let ye=0;ye<F.length;ye++)ue[ye]=i(F[ye],ye,Q,te,ne);return Object.hasOwn(F,"index")&&(ue.index=F.index),Object.hasOwn(F,"input")&&(ue.input=F.input),ue}if(F instanceof Date)return new Date(F.getTime());if(F instanceof RegExp){const ue=new RegExp(F.source,F.flags);return ue.lastIndex=F.lastIndex,ue}if(F instanceof Map){const ue=new Map;te.set(F,ue);for(const[ye,we]of F)ue.set(ye,i(we,ye,Q,te,ne));return ue}if(F instanceof Set){const ue=new Set;te.set(F,ue);for(const ye of F)ue.add(i(ye,void 0,Q,te,ne));return ue}if(typeof Buffer<"u"&&Buffer.isBuffer(F))return F.subarray();if(y.isTypedArray(F)){const ue=new(Object.getPrototypeOf(F)).constructor(F.length);te.set(F,ue);for(let ye=0;ye<F.length;ye++)ue[ye]=i(F[ye],ye,Q,te,ne);return ue}if(F instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&F instanceof SharedArrayBuffer)return F.slice(0);if(F instanceof DataView){const ue=new DataView(F.buffer.slice(0),F.byteOffset,F.byteLength);return te.set(F,ue),z(ue,F,Q,te,ne),ue}if(typeof File<"u"&&F instanceof File){const ue=new File([F],F.name,{type:F.type});return te.set(F,ue),z(ue,F,Q,te,ne),ue}if(F instanceof Blob){const ue=new Blob([F],{type:F.type});return te.set(F,ue),z(ue,F,Q,te,ne),ue}if(F instanceof Error){const ue=new F.constructor;return te.set(F,ue),ue.message=F.message,ue.name=F.name,ue.stack=F.stack,ue.cause=F.cause,z(ue,F,Q,te,ne),ue}if(typeof F=="object"&&B(F)){const ue=Object.create(Object.getPrototypeOf(F));return te.set(F,ue),z(ue,F,Q,te,ne),ue}return F}function z(F,G,Q=F,te,ne){const oe=[...Object.keys(G),...r.getSymbols(G)];for(let ue=0;ue<oe.length;ue++){const ye=oe[ue],we=Object.getOwnPropertyDescriptor(F,ye);(we==null||we.writable)&&(F[ye]=i(G[ye],ye,Q,te,ne))}}function B(F){switch(a.getTag(F)){case l.argumentsTag:case l.arrayTag:case l.arrayBufferTag:case l.dataViewTag:case l.booleanTag:case l.dateTag:case l.float32ArrayTag:case l.float64ArrayTag:case l.int8ArrayTag:case l.int16ArrayTag:case l.int32ArrayTag:case l.mapTag:case l.numberTag:case l.objectTag:case l.regexpTag:case l.setTag:case l.stringTag:case l.symbolTag:case l.uint8ArrayTag:case l.uint8ClampedArrayTag:case l.uint16ArrayTag:case l.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=T,e.cloneDeepWithImpl=i,e.copyProperties=z})(BT)),BT}var Dk;function _te(){return Dk||(Dk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=AF();function a(l){return r.cloneDeepWithImpl(l,void 0,l,new Map,void 0)}e.cloneDeep=a})(LT)),LT}var Ok;function yte(){return Ok||(Ok=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=sM(),a=_te();function l(m){return m=a.cloneDeep(m),y=>r.isMatch(y,m)}e.matches=l})(PT)),PT}var VT={},$T={},GT={},kk;function vte(){return kk||(kk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=AF(),a=mF();function l(m,y){return r.cloneDeepWith(m,(T,i,z,B)=>{const F=y?.(T,i,z,B);if(F!==void 0)return F;if(typeof m=="object")switch(Object.prototype.toString.call(m)){case a.numberTag:case a.stringTag:case a.booleanTag:{const G=new m.constructor(m?.valueOf());return r.copyProperties(G,m),G}case a.argumentsTag:{const G={};return r.copyProperties(G,m),G.length=m.length,G[Symbol.iterator]=m[Symbol.iterator],G}default:return}})}e.cloneDeepWith=l})(GT)),GT}var zk;function xte(){return zk||(zk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=vte();function a(l){return r.cloneDeepWith(l)}e.cloneDeep=a})($T)),$T}var HT={},qT={},Lk;function gF(){return Lk||(Lk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=/^(?:0|[1-9]\d*)$/;function a(l,m=Number.MAX_SAFE_INTEGER){switch(typeof l){case"number":return Number.isInteger(l)&&l>=0&&l<m;case"symbol":return!1;case"string":return r.test(l)}}e.isIndex=a})(qT)),qT}var WT={},Bk;function bte(){return Bk||(Bk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=pF();function a(l){return l!==null&&typeof l=="object"&&r.getTag(l)==="[object Arguments]"}e.isArguments=a})(WT)),WT}var Fk;function wte(){return Fk||(Fk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=$5(),a=gF(),l=bte(),m=eM();function y(T,i){let z;if(Array.isArray(i)?z=i:typeof i=="string"&&r.isDeepKey(i)&&T?.[i]==null?z=m.toPath(i):z=[i],z.length===0)return!1;let B=T;for(let F=0;F<z.length;F++){const G=z[F];if((B==null||!Object.hasOwn(B,G))&&!((Array.isArray(B)||l.isArguments(B))&&a.isIndex(G)&&G<B.length))return!1;B=B[G]}return!0}e.has=y})(HT)),HT}var Nk;function Ste(){return Nk||(Nk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=sM(),a=G5(),l=xte(),m=tM(),y=wte();function T(i,z){switch(typeof i){case"object":{Object.is(i?.valueOf(),-0)&&(i="-0");break}case"number":{i=a.toKey(i);break}}return z=l.cloneDeep(z),function(B){const F=m.get(B,i);return F===void 0?y.has(B,i):z===void 0?F===void 0:r.isMatch(F,z)}}e.matchesProperty=T})(VT)),VT}var jk;function Tte(){return jk||(jk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=uF(),a=pte(),l=yte(),m=Ste();function y(T){if(T==null)return r.identity;switch(typeof T){case"function":return T;case"object":return Array.isArray(T)&&T.length===2?m.matchesProperty(T[0],T[1]):l.matches(T);case"string":case"symbol":case"number":return a.property(T)}}e.iteratee=y})(MT)),MT}var Uk;function Ete(){return Uk||(Uk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=ute(),a=uF(),l=dte(),m=Tte();function y(T,i=a.identity){return l.isArrayLikeObject(T)?r.uniqBy(Array.from(T),m.iteratee(i)):[]}e.uniqBy=y})(xT)),xT}var ZT,Vk;function Cte(){return Vk||(Vk=1,ZT=Ete().uniqBy),ZT}var Mte=Cte();const $k=Zp(Mte);function Ite(e,r,a){return r===!0?$k(e,a):typeof r=="function"?$k(e,r):e}var XT={exports:{}},YT={},QT={exports:{}},KT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gk;function Pte(){if(Gk)return KT;Gk=1;var e=Y_();function r(G,Q){return G===Q&&(G!==0||1/G===1/Q)||G!==G&&Q!==Q}var a=typeof Object.is=="function"?Object.is:r,l=e.useState,m=e.useEffect,y=e.useLayoutEffect,T=e.useDebugValue;function i(G,Q){var te=Q(),ne=l({inst:{value:te,getSnapshot:Q}}),oe=ne[0].inst,ue=ne[1];return y(function(){oe.value=te,oe.getSnapshot=Q,z(oe)&&ue({inst:oe})},[G,te,Q]),m(function(){return z(oe)&&ue({inst:oe}),G(function(){z(oe)&&ue({inst:oe})})},[G]),T(te),te}function z(G){var Q=G.getSnapshot;G=G.value;try{var te=Q();return!a(G,te)}catch{return!0}}function B(G,Q){return Q()}var F=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?B:i;return KT.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:F,KT}var Hk;function Rte(){return Hk||(Hk=1,QT.exports=Pte()),QT.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qk;function Dte(){if(qk)return YT;qk=1;var e=Y_(),r=Rte();function a(B,F){return B===F&&(B!==0||1/B===1/F)||B!==B&&F!==F}var l=typeof Object.is=="function"?Object.is:a,m=r.useSyncExternalStore,y=e.useRef,T=e.useEffect,i=e.useMemo,z=e.useDebugValue;return YT.useSyncExternalStoreWithSelector=function(B,F,G,Q,te){var ne=y(null);if(ne.current===null){var oe={hasValue:!1,value:null};ne.current=oe}else oe=ne.current;ne=i(function(){function ye(Be){if(!we){if(we=!0,ve=Be,Be=Q(Be),te!==void 0&&oe.hasValue){var Ke=oe.value;if(te(Ke,Be))return Ce=Ke}return Ce=Be}if(Ke=Ce,l(ve,Be))return Ke;var st=Q(Be);return te!==void 0&&te(Ke,st)?(ve=Be,Ke):(ve=Be,Ce=st)}var we=!1,ve,Ce,Ee=G===void 0?null:G;return[function(){return ye(F())},Ee===null?void 0:function(){return ye(Ee())}]},[F,G,Q,te]);var ue=m(B,ne[0],ne[1]);return T(function(){oe.hasValue=!0,oe.value=ue},[ue]),z(ue),ue},YT}var Wk;function Ote(){return Wk||(Wk=1,XT.exports=Dte()),XT.exports}var kte=Ote(),lM=ae.createContext(null),zte=e=>e,Wu=()=>{var e=ae.useContext(lM);return e?e.store.dispatch:zte},Pb=()=>{},Lte=()=>Pb,Bte=(e,r)=>e===r;function ji(e){var r=ae.useContext(lM);return kte.useSyncExternalStoreWithSelector(r?r.subscription.addNestedSub:Lte,r?r.store.getState:Pb,r?r.store.getState:Pb,r?e:Pb,Bte)}function Fte(e,r=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(r)}function Nte(e,r=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(r)}function jte(e,r="expected all items to be functions, instead received the following types: "){if(!e.every(a=>typeof a=="function")){const a=e.map(l=>typeof l=="function"?`function ${l.name||"unnamed"}()`:typeof l).join(", ");throw new TypeError(`${r}[${a}]`)}}var Zk=e=>Array.isArray(e)?e:[e];function Ute(e){const r=Array.isArray(e[0])?e[0]:e;return jte(r,"createSelector expects all input-selectors to be functions, but received the following types: "),r}function Vte(e,r){const a=[],{length:l}=e;for(let m=0;m<l;m++)a.push(e[m].apply(null,r));return a}var $te=class{constructor(e){this.value=e}deref(){return this.value}},Gte=typeof WeakRef<"u"?WeakRef:$te,Hte=0,Xk=1;function sb(){return{s:Hte,v:void 0,o:null,p:null}}function _F(e,r={}){let a=sb();const{resultEqualityCheck:l}=r;let m,y=0;function T(){let i=a;const{length:z}=arguments;for(let G=0,Q=z;G<Q;G++){const te=arguments[G];if(typeof te=="function"||typeof te=="object"&&te!==null){let ne=i.o;ne===null&&(i.o=ne=new WeakMap);const oe=ne.get(te);oe===void 0?(i=sb(),ne.set(te,i)):i=oe}else{let ne=i.p;ne===null&&(i.p=ne=new Map);const oe=ne.get(te);oe===void 0?(i=sb(),ne.set(te,i)):i=oe}}const B=i;let F;if(i.s===Xk)F=i.v;else if(F=e.apply(null,arguments),y++,l){const G=m?.deref?.()??m;G!=null&&l(G,F)&&(F=G,y!==0&&y--),m=typeof F=="object"&&F!==null||typeof F=="function"?new Gte(F):F}return B.s=Xk,B.v=F,F}return T.clearCache=()=>{a=sb(),T.resetResultsCount()},T.resultsCount=()=>y,T.resetResultsCount=()=>{y=0},T}function qte(e,...r){const a=typeof e=="function"?{memoize:e,memoizeOptions:r}:e,l=(...m)=>{let y=0,T=0,i,z={},B=m.pop();typeof B=="object"&&(z=B,B=m.pop()),Fte(B,`createSelector expects an output function after the inputs, but received: [${typeof B}]`);const F={...a,...z},{memoize:G,memoizeOptions:Q=[],argsMemoize:te=_F,argsMemoizeOptions:ne=[]}=F,oe=Zk(Q),ue=Zk(ne),ye=Ute(m),we=G(function(){return y++,B.apply(null,arguments)},...oe),ve=te(function(){T++;const Ee=Vte(ye,arguments);return i=we.apply(null,Ee),i},...ue);return Object.assign(ve,{resultFunc:B,memoizedResultFunc:we,dependencies:ye,dependencyRecomputations:()=>T,resetDependencyRecomputations:()=>{T=0},lastResult:()=>i,recomputations:()=>y,resetRecomputations:()=>{y=0},memoize:G,argsMemoize:te})};return Object.assign(l,{withTypes:()=>l}),l}var Pr=qte(_F),Wte=Object.assign((e,r=Pr)=>{Nte(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const a=Object.keys(e),l=a.map(y=>e[y]);return r(l,(...y)=>y.reduce((T,i,z)=>(T[a[z]]=i,T),{}))},{withTypes:()=>Wte}),JT={},eE={},tE={},Yk;function Zte(){return Yk||(Yk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(l){return typeof l=="symbol"?1:l===null?2:l===void 0?3:l!==l?4:0}const a=(l,m,y)=>{if(l!==m){const T=r(l),i=r(m);if(T===i&&T===0){if(l<m)return y==="desc"?1:-1;if(l>m)return y==="desc"?-1:1}return y==="desc"?i-T:T-i}return 0};e.compareValues=a})(tE)),tE}var rE={},nE={},Qk;function yF(){return Qk||(Qk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return typeof a=="symbol"||a instanceof Symbol}e.isSymbol=r})(nE)),nE}var Kk;function Xte(){return Kk||(Kk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=yF(),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/;function m(y,T){return Array.isArray(y)?!1:typeof y=="number"||typeof y=="boolean"||y==null||r.isSymbol(y)?!0:typeof y=="string"&&(l.test(y)||!a.test(y))||T!=null&&Object.hasOwn(T,y)}e.isKey=m})(rE)),rE}var Jk;function Yte(){return Jk||(Jk=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Zte(),a=Xte(),l=eM();function m(y,T,i,z){if(y==null)return[];i=z?void 0:i,Array.isArray(y)||(y=Object.values(y)),Array.isArray(T)||(T=T==null?[null]:[T]),T.length===0&&(T=[null]),Array.isArray(i)||(i=i==null?[]:[i]),i=i.map(te=>String(te));const B=(te,ne)=>{let oe=te;for(let ue=0;ue<ne.length&&oe!=null;++ue)oe=oe[ne[ue]];return oe},F=(te,ne)=>ne==null||te==null?ne:typeof te=="object"&&"key"in te?Object.hasOwn(ne,te.key)?ne[te.key]:B(ne,te.path):typeof te=="function"?te(ne):Array.isArray(te)?B(ne,te):typeof ne=="object"?ne[te]:ne,G=T.map(te=>(Array.isArray(te)&&te.length===1&&(te=te[0]),te==null||typeof te=="function"||Array.isArray(te)||a.isKey(te)?te:{key:te,path:l.toPath(te)}));return y.map(te=>({original:te,criteria:G.map(ne=>F(ne,te))})).slice().sort((te,ne)=>{for(let oe=0;oe<G.length;oe++){const ue=r.compareValues(te.criteria[oe],ne.criteria[oe],i[oe]);if(ue!==0)return ue}return 0}).map(te=>te.original)}e.orderBy=m})(eE)),eE}var iE={},e4;function Qte(){return e4||(e4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a,l=1){const m=[],y=Math.floor(l),T=(i,z)=>{for(let B=0;B<i.length;B++){const F=i[B];Array.isArray(F)&&z<y?T(F,z+1):m.push(F)}};return T(a,0),m}e.flatten=r})(iE)),iE}var oE={},t4;function vF(){return t4||(t4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=gF(),a=aM(),l=hF(),m=dF();function y(T,i,z){return l.isObject(z)&&(typeof i=="number"&&a.isArrayLike(z)&&r.isIndex(i)&&i<z.length||typeof i=="string"&&i in z)?m.eq(z[i],T):!1}e.isIterateeCall=y})(oE)),oE}var r4;function Kte(){return r4||(r4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Yte(),a=Qte(),l=vF();function m(y,...T){const i=T.length;return i>1&&l.isIterateeCall(y,T[0],T[1])?T=[]:i>2&&l.isIterateeCall(T[0],T[1],T[2])&&(T=[T[0]]),r.orderBy(y,a.flatten(T),["asc"])}e.sortBy=m})(JT)),JT}var aE,n4;function Jte(){return n4||(n4=1,aE=Kte().sortBy),aE}var ere=Jte();const u2=Zp(ere);var xF=e=>e.legend.settings,tre=e=>e.legend.size,rre=e=>e.legend.payload;Pr([rre,xF],(e,r)=>{var{itemSorter:a}=r,l=e.flat(1);return a?u2(l,a):l});var lb=1;function nre(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[r,a]=ae.useState({height:0,left:0,top:0,width:0}),l=ae.useCallback(m=>{if(m!=null){var y=m.getBoundingClientRect(),T={height:y.height,left:y.left,top:y.top,width:y.width};(Math.abs(T.height-r.height)>lb||Math.abs(T.left-r.left)>lb||Math.abs(T.top-r.top)>lb||Math.abs(T.width-r.width)>lb)&&a({height:T.height,left:T.left,top:T.top,width:T.width})}},[r.width,r.height,r.top,r.left,...e]);return[r,l]}function mc(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var ire=typeof Symbol=="function"&&Symbol.observable||"@@observable",i4=ire,sE=()=>Math.random().toString(36).substring(7).split("").join("."),ore={INIT:`@@redux/INIT${sE()}`,REPLACE:`@@redux/REPLACE${sE()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${sE()}`},Xb=ore;function cM(e){if(typeof e!="object"||e===null)return!1;let r=e;for(;Object.getPrototypeOf(r)!==null;)r=Object.getPrototypeOf(r);return Object.getPrototypeOf(e)===r||Object.getPrototypeOf(e)===null}function bF(e,r,a){if(typeof e!="function")throw new Error(mc(2));if(typeof r=="function"&&typeof a=="function"||typeof a=="function"&&typeof arguments[3]=="function")throw new Error(mc(0));if(typeof r=="function"&&typeof a>"u"&&(a=r,r=void 0),typeof a<"u"){if(typeof a!="function")throw new Error(mc(1));return a(bF)(e,r)}let l=e,m=r,y=new Map,T=y,i=0,z=!1;function B(){T===y&&(T=new Map,y.forEach((ue,ye)=>{T.set(ye,ue)}))}function F(){if(z)throw new Error(mc(3));return m}function G(ue){if(typeof ue!="function")throw new Error(mc(4));if(z)throw new Error(mc(5));let ye=!0;B();const we=i++;return T.set(we,ue),function(){if(ye){if(z)throw new Error(mc(6));ye=!1,B(),T.delete(we),y=null}}}function Q(ue){if(!cM(ue))throw new Error(mc(7));if(typeof ue.type>"u")throw new Error(mc(8));if(typeof ue.type!="string")throw new Error(mc(17));if(z)throw new Error(mc(9));try{z=!0,m=l(m,ue)}finally{z=!1}return(y=T).forEach(we=>{we()}),ue}function te(ue){if(typeof ue!="function")throw new Error(mc(10));l=ue,Q({type:Xb.REPLACE})}function ne(){const ue=G;return{subscribe(ye){if(typeof ye!="object"||ye===null)throw new Error(mc(11));function we(){const Ce=ye;Ce.next&&Ce.next(F())}return we(),{unsubscribe:ue(we)}},[i4](){return this}}}return Q({type:Xb.INIT}),{dispatch:Q,subscribe:G,getState:F,replaceReducer:te,[i4]:ne}}function are(e){Object.keys(e).forEach(r=>{const a=e[r];if(typeof a(void 0,{type:Xb.INIT})>"u")throw new Error(mc(12));if(typeof a(void 0,{type:Xb.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(mc(13))})}function wF(e){const r=Object.keys(e),a={};for(let y=0;y<r.length;y++){const T=r[y];typeof e[T]=="function"&&(a[T]=e[T])}const l=Object.keys(a);let m;try{are(a)}catch(y){m=y}return function(T={},i){if(m)throw m;let z=!1;const B={};for(let F=0;F<l.length;F++){const G=l[F],Q=a[G],te=T[G],ne=Q(te,i);if(typeof ne>"u")throw i&&i.type,new Error(mc(14));B[G]=ne,z=z||ne!==te}return z=z||l.length!==Object.keys(T).length,z?B:T}}function Yb(...e){return e.length===0?r=>r:e.length===1?e[0]:e.reduce((r,a)=>(...l)=>r(a(...l)))}function sre(...e){return r=>(a,l)=>{const m=r(a,l);let y=()=>{throw new Error(mc(15))};const T={getState:m.getState,dispatch:(z,...B)=>y(z,...B)},i=e.map(z=>z(T));return y=Yb(...i)(m.dispatch),{...m,dispatch:y}}}function SF(e){return cM(e)&&"type"in e&&typeof e.type=="string"}var TF=Symbol.for("immer-nothing"),o4=Symbol.for("immer-draftable"),Cf=Symbol.for("immer-state");function Gd(e,...r){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var G_=Object.getPrototypeOf;function _g(e){return!!e&&!!e[Cf]}function Xm(e){return e?EF(e)||Array.isArray(e)||!!e[o4]||!!e.constructor?.[o4]||Tx(e)||f2(e):!1}var lre=Object.prototype.constructor.toString();function EF(e){if(!e||typeof e!="object")return!1;const r=G_(e);if(r===null)return!0;const a=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return a===Object?!0:typeof a=="function"&&Function.toString.call(a)===lre}function Qb(e,r){h2(e)===0?Reflect.ownKeys(e).forEach(a=>{r(a,e[a],e)}):e.forEach((a,l)=>r(l,a,e))}function h2(e){const r=e[Cf];return r?r.type_:Array.isArray(e)?1:Tx(e)?2:f2(e)?3:0}function SC(e,r){return h2(e)===2?e.has(r):Object.prototype.hasOwnProperty.call(e,r)}function CF(e,r,a){const l=h2(e);l===2?e.set(r,a):l===3?e.add(a):e[r]=a}function cre(e,r){return e===r?e!==0||1/e===1/r:e!==e&&r!==r}function Tx(e){return e instanceof Map}function f2(e){return e instanceof Set}function rg(e){return e.copy_||e.base_}function TC(e,r){if(Tx(e))return new Map(e);if(f2(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const a=EF(e);if(r===!0||r==="class_only"&&!a){const l=Object.getOwnPropertyDescriptors(e);delete l[Cf];let m=Reflect.ownKeys(l);for(let y=0;y<m.length;y++){const T=m[y],i=l[T];i.writable===!1&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(l[T]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[T]})}return Object.create(G_(e),l)}else{const l=G_(e);if(l!==null&&a)return{...e};const m=Object.create(l);return Object.assign(m,e)}}function uM(e,r=!1){return d2(e)||_g(e)||!Xm(e)||(h2(e)>1&&Object.defineProperties(e,{set:{value:cb},add:{value:cb},clear:{value:cb},delete:{value:cb}}),Object.freeze(e),r&&Object.values(e).forEach(a=>uM(a,!0))),e}function cb(){Gd(2)}function d2(e){return Object.isFrozen(e)}var ure={};function yg(e){const r=ure[e];return r||Gd(0,e),r}var Xv;function MF(){return Xv}function hre(e,r){return{drafts_:[],parent_:e,immer_:r,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function a4(e,r){r&&(yg("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=r)}function EC(e){CC(e),e.drafts_.forEach(fre),e.drafts_=null}function CC(e){e===Xv&&(Xv=e.parent_)}function s4(e){return Xv=hre(Xv,e)}function fre(e){const r=e[Cf];r.type_===0||r.type_===1?r.revoke_():r.revoked_=!0}function l4(e,r){r.unfinalizedDrafts_=r.drafts_.length;const a=r.drafts_[0];return e!==void 0&&e!==a?(a[Cf].modified_&&(EC(r),Gd(4)),Xm(e)&&(e=Kb(r,e),r.parent_||Jb(r,e)),r.patches_&&yg("Patches").generateReplacementPatches_(a[Cf].base_,e,r.patches_,r.inversePatches_)):e=Kb(r,a,[]),EC(r),r.patches_&&r.patchListener_(r.patches_,r.inversePatches_),e!==TF?e:void 0}function Kb(e,r,a){if(d2(r))return r;const l=r[Cf];if(!l)return Qb(r,(m,y)=>c4(e,l,r,m,y,a)),r;if(l.scope_!==e)return r;if(!l.modified_)return Jb(e,l.base_,!0),l.base_;if(!l.finalized_){l.finalized_=!0,l.scope_.unfinalizedDrafts_--;const m=l.copy_;let y=m,T=!1;l.type_===3&&(y=new Set(m),m.clear(),T=!0),Qb(y,(i,z)=>c4(e,l,m,i,z,a,T)),Jb(e,m,!1),a&&e.patches_&&yg("Patches").generatePatches_(l,a,e.patches_,e.inversePatches_)}return l.copy_}function c4(e,r,a,l,m,y,T){if(_g(m)){const i=y&&r&&r.type_!==3&&!SC(r.assigned_,l)?y.concat(l):void 0,z=Kb(e,m,i);if(CF(a,l,z),_g(z))e.canAutoFreeze_=!1;else return}else T&&a.add(m);if(Xm(m)&&!d2(m)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Kb(e,m),(!r||!r.scope_.parent_)&&typeof l!="symbol"&&(Tx(a)?a.has(l):Object.prototype.propertyIsEnumerable.call(a,l))&&Jb(e,m)}}function Jb(e,r,a=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&uM(r,a)}function dre(e,r){const a=Array.isArray(e),l={type_:a?1:0,scope_:r?r.scope_:MF(),modified_:!1,finalized_:!1,assigned_:{},parent_:r,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let m=l,y=hM;a&&(m=[l],y=Yv);const{revoke:T,proxy:i}=Proxy.revocable(m,y);return l.draft_=i,l.revoke_=T,i}var hM={get(e,r){if(r===Cf)return e;const a=rg(e);if(!SC(a,r))return pre(e,a,r);const l=a[r];return e.finalized_||!Xm(l)?l:l===lE(e.base_,r)?(cE(e),e.copy_[r]=IC(l,e)):l},has(e,r){return r in rg(e)},ownKeys(e){return Reflect.ownKeys(rg(e))},set(e,r,a){const l=IF(rg(e),r);if(l?.set)return l.set.call(e.draft_,a),!0;if(!e.modified_){const m=lE(rg(e),r),y=m?.[Cf];if(y&&y.base_===a)return e.copy_[r]=a,e.assigned_[r]=!1,!0;if(cre(a,m)&&(a!==void 0||SC(e.base_,r)))return!0;cE(e),MC(e)}return e.copy_[r]===a&&(a!==void 0||r in e.copy_)||Number.isNaN(a)&&Number.isNaN(e.copy_[r])||(e.copy_[r]=a,e.assigned_[r]=!0),!0},deleteProperty(e,r){return lE(e.base_,r)!==void 0||r in e.base_?(e.assigned_[r]=!1,cE(e),MC(e)):delete e.assigned_[r],e.copy_&&delete e.copy_[r],!0},getOwnPropertyDescriptor(e,r){const a=rg(e),l=Reflect.getOwnPropertyDescriptor(a,r);return l&&{writable:!0,configurable:e.type_!==1||r!=="length",enumerable:l.enumerable,value:a[r]}},defineProperty(){Gd(11)},getPrototypeOf(e){return G_(e.base_)},setPrototypeOf(){Gd(12)}},Yv={};Qb(hM,(e,r)=>{Yv[e]=function(){return arguments[0]=arguments[0][0],r.apply(this,arguments)}});Yv.deleteProperty=function(e,r){return Yv.set.call(this,e,r,void 0)};Yv.set=function(e,r,a){return hM.set.call(this,e[0],r,a,e[0])};function lE(e,r){const a=e[Cf];return(a?rg(a):e)[r]}function pre(e,r,a){const l=IF(r,a);return l?"value"in l?l.value:l.get?.call(e.draft_):void 0}function IF(e,r){if(!(r in e))return;let a=G_(e);for(;a;){const l=Object.getOwnPropertyDescriptor(a,r);if(l)return l;a=G_(a)}}function MC(e){e.modified_||(e.modified_=!0,e.parent_&&MC(e.parent_))}function cE(e){e.copy_||(e.copy_=TC(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var mre=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(r,a,l)=>{if(typeof r=="function"&&typeof a!="function"){const y=a;a=r;const T=this;return function(z=y,...B){return T.produce(z,F=>a.call(this,F,...B))}}typeof a!="function"&&Gd(6),l!==void 0&&typeof l!="function"&&Gd(7);let m;if(Xm(r)){const y=s4(this),T=IC(r,void 0);let i=!0;try{m=a(T),i=!1}finally{i?EC(y):CC(y)}return a4(y,l),l4(m,y)}else if(!r||typeof r!="object"){if(m=a(r),m===void 0&&(m=r),m===TF&&(m=void 0),this.autoFreeze_&&uM(m,!0),l){const y=[],T=[];yg("Patches").generateReplacementPatches_(r,m,y,T),l(y,T)}return m}else Gd(1,r)},this.produceWithPatches=(r,a)=>{if(typeof r=="function")return(T,...i)=>this.produceWithPatches(T,z=>r(z,...i));let l,m;return[this.produce(r,a,(T,i)=>{l=T,m=i}),l,m]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Xm(e)||Gd(8),_g(e)&&(e=Um(e));const r=s4(this),a=IC(e,void 0);return a[Cf].isManual_=!0,CC(r),a}finishDraft(e,r){const a=e&&e[Cf];(!a||!a.isManual_)&&Gd(9);const{scope_:l}=a;return a4(l,r),l4(void 0,l)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,r){let a;for(a=r.length-1;a>=0;a--){const m=r[a];if(m.path.length===0&&m.op==="replace"){e=m.value;break}}a>-1&&(r=r.slice(a+1));const l=yg("Patches").applyPatches_;return _g(e)?l(e,r):this.produce(e,m=>l(m,r))}};function IC(e,r){const a=Tx(e)?yg("MapSet").proxyMap_(e,r):f2(e)?yg("MapSet").proxySet_(e,r):dre(e,r);return(r?r.scope_:MF()).drafts_.push(a),a}function Um(e){return _g(e)||Gd(10,e),PF(e)}function PF(e){if(!Xm(e)||d2(e))return e;const r=e[Cf];let a;if(r){if(!r.modified_)return r.base_;r.finalized_=!0,a=TC(e,r.scope_.immer_.useStrictShallowCopy_)}else a=TC(e,!0);return Qb(a,(l,m)=>{CF(a,l,PF(m))}),r&&(r.finalized_=!1),a}var Are=new mre,RF=Are.produce;function DF(e){return({dispatch:a,getState:l})=>m=>y=>typeof y=="function"?y(a,l,e):m(y)}var gre=DF(),_re=DF,yre=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Yb:Yb.apply(null,arguments)};function sd(e,r){function a(...l){if(r){let m=r(...l);if(!m)throw new Error(Sf(0));return{type:e,payload:m.payload,..."meta"in m&&{meta:m.meta},..."error"in m&&{error:m.error}}}return{type:e,payload:l[0]}}return a.toString=()=>`${e}`,a.type=e,a.match=l=>SF(l)&&l.type===e,a}var OF=class Dv extends Array{constructor(...r){super(...r),Object.setPrototypeOf(this,Dv.prototype)}static get[Symbol.species](){return Dv}concat(...r){return super.concat.apply(this,r)}prepend(...r){return r.length===1&&Array.isArray(r[0])?new Dv(...r[0].concat(this)):new Dv(...r.concat(this))}};function u4(e){return Xm(e)?RF(e,()=>{}):e}function ub(e,r,a){return e.has(r)?e.get(r):e.set(r,a(r)).get(r)}function vre(e){return typeof e=="boolean"}var xre=()=>function(r){const{thunk:a=!0,immutableCheck:l=!0,serializableCheck:m=!0,actionCreatorCheck:y=!0}=r??{};let T=new OF;return a&&(vre(a)?T.push(gre):T.push(_re(a.extraArgument))),T},bre="RTK_autoBatch",h4=e=>r=>{setTimeout(r,e)},wre=(e={type:"raf"})=>r=>(...a)=>{const l=r(...a);let m=!0,y=!1,T=!1;const i=new Set,z=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:h4(10):e.type==="callback"?e.queueNotification:h4(e.timeout),B=()=>{T=!1,y&&(y=!1,i.forEach(F=>F()))};return Object.assign({},l,{subscribe(F){const G=()=>m&&F(),Q=l.subscribe(G);return i.add(F),()=>{Q(),i.delete(F)}},dispatch(F){try{return m=!F?.meta?.[bre],y=!m,y&&(T||(T=!0,z(B))),l.dispatch(F)}finally{m=!0}}})},Sre=e=>function(a){const{autoBatch:l=!0}=a??{};let m=new OF(e);return l&&m.push(wre(typeof l=="object"?l:void 0)),m};function Tre(e){const r=xre(),{reducer:a=void 0,middleware:l,devTools:m=!0,preloadedState:y=void 0,enhancers:T=void 0}=e||{};let i;if(typeof a=="function")i=a;else if(cM(a))i=wF(a);else throw new Error(Sf(1));let z;typeof l=="function"?z=l(r):z=r();let B=Yb;m&&(B=yre({trace:!1,...typeof m=="object"&&m}));const F=sre(...z),G=Sre(F);let Q=typeof T=="function"?T(G):G();const te=B(...Q);return bF(i,y,te)}function kF(e){const r={},a=[];let l;const m={addCase(y,T){const i=typeof y=="string"?y:y.type;if(!i)throw new Error(Sf(28));if(i in r)throw new Error(Sf(29));return r[i]=T,m},addAsyncThunk(y,T){return T.pending&&(r[y.pending.type]=T.pending),T.rejected&&(r[y.rejected.type]=T.rejected),T.fulfilled&&(r[y.fulfilled.type]=T.fulfilled),T.settled&&a.push({matcher:y.settled,reducer:T.settled}),m},addMatcher(y,T){return a.push({matcher:y,reducer:T}),m},addDefaultCase(y){return l=y,m}};return e(m),[r,a,l]}function Ere(e){return typeof e=="function"}function Cre(e,r){let[a,l,m]=kF(r),y;if(Ere(e))y=()=>u4(e());else{const i=u4(e);y=()=>i}function T(i=y(),z){let B=[a[z.type],...l.filter(({matcher:F})=>F(z)).map(({reducer:F})=>F)];return B.filter(F=>!!F).length===0&&(B=[m]),B.reduce((F,G)=>{if(G)if(_g(F)){const te=G(F,z);return te===void 0?F:te}else{if(Xm(F))return RF(F,Q=>G(Q,z));{const Q=G(F,z);if(Q===void 0){if(F===null)return F;throw Error("A case reducer on a non-draftable value must not return undefined")}return Q}}return F},i)}return T.getInitialState=y,T}var Mre="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Ire=(e=21)=>{let r="",a=e;for(;a--;)r+=Mre[Math.random()*64|0];return r},Pre=Symbol.for("rtk-slice-createasyncthunk");function Rre(e,r){return`${e}/${r}`}function Dre({creators:e}={}){const r=e?.asyncThunk?.[Pre];return function(l){const{name:m,reducerPath:y=m}=l;if(!m)throw new Error(Sf(11));const T=(typeof l.reducers=="function"?l.reducers(kre()):l.reducers)||{},i=Object.keys(T),z={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},B={addCase(ve,Ce){const Ee=typeof ve=="string"?ve:ve.type;if(!Ee)throw new Error(Sf(12));if(Ee in z.sliceCaseReducersByType)throw new Error(Sf(13));return z.sliceCaseReducersByType[Ee]=Ce,B},addMatcher(ve,Ce){return z.sliceMatchers.push({matcher:ve,reducer:Ce}),B},exposeAction(ve,Ce){return z.actionCreators[ve]=Ce,B},exposeCaseReducer(ve,Ce){return z.sliceCaseReducersByName[ve]=Ce,B}};i.forEach(ve=>{const Ce=T[ve],Ee={reducerName:ve,type:Rre(m,ve),createNotation:typeof l.reducers=="function"};Lre(Ce)?Fre(Ee,Ce,B,r):zre(Ee,Ce,B)});function F(){const[ve={},Ce=[],Ee=void 0]=typeof l.extraReducers=="function"?kF(l.extraReducers):[l.extraReducers],Be={...ve,...z.sliceCaseReducersByType};return Cre(l.initialState,Ke=>{for(let st in Be)Ke.addCase(st,Be[st]);for(let st of z.sliceMatchers)Ke.addMatcher(st.matcher,st.reducer);for(let st of Ce)Ke.addMatcher(st.matcher,st.reducer);Ee&&Ke.addDefaultCase(Ee)})}const G=ve=>ve,Q=new Map,te=new WeakMap;let ne;function oe(ve,Ce){return ne||(ne=F()),ne(ve,Ce)}function ue(){return ne||(ne=F()),ne.getInitialState()}function ye(ve,Ce=!1){function Ee(Ke){let st=Ke[ve];return typeof st>"u"&&Ce&&(st=ub(te,Ee,ue)),st}function Be(Ke=G){const st=ub(Q,Ce,()=>new WeakMap);return ub(st,Ke,()=>{const dt={};for(const[bt,ht]of Object.entries(l.selectors??{}))dt[bt]=Ore(ht,Ke,()=>ub(te,Ke,ue),Ce);return dt})}return{reducerPath:ve,getSelectors:Be,get selectors(){return Be(Ee)},selectSlice:Ee}}const we={name:m,reducer:oe,actions:z.actionCreators,caseReducers:z.sliceCaseReducersByName,getInitialState:ue,...ye(y),injectInto(ve,{reducerPath:Ce,...Ee}={}){const Be=Ce??y;return ve.inject({reducerPath:Be,reducer:oe},Ee),{...we,...ye(Be,!0)}}};return we}}function Ore(e,r,a,l){function m(y,...T){let i=r(y);return typeof i>"u"&&l&&(i=a()),e(i,...T)}return m.unwrapped=e,m}var Mf=Dre();function kre(){function e(r,a){return{_reducerDefinitionType:"asyncThunk",payloadCreator:r,...a}}return e.withTypes=()=>e,{reducer(r){return Object.assign({[r.name](...a){return r(...a)}}[r.name],{_reducerDefinitionType:"reducer"})},preparedReducer(r,a){return{_reducerDefinitionType:"reducerWithPrepare",prepare:r,reducer:a}},asyncThunk:e}}function zre({type:e,reducerName:r,createNotation:a},l,m){let y,T;if("reducer"in l){if(a&&!Bre(l))throw new Error(Sf(17));y=l.reducer,T=l.prepare}else y=l;m.addCase(e,y).exposeCaseReducer(r,y).exposeAction(r,T?sd(e,T):sd(e))}function Lre(e){return e._reducerDefinitionType==="asyncThunk"}function Bre(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Fre({type:e,reducerName:r},a,l,m){if(!m)throw new Error(Sf(18));const{payloadCreator:y,fulfilled:T,pending:i,rejected:z,settled:B,options:F}=a,G=m(e,y,F);l.exposeAction(r,G),T&&l.addCase(G.fulfilled,T),i&&l.addCase(G.pending,i),z&&l.addCase(G.rejected,z),B&&l.addMatcher(G.settled,B),l.exposeCaseReducer(r,{fulfilled:T||hb,pending:i||hb,rejected:z||hb,settled:B||hb})}function hb(){}var Nre="task",zF="listener",LF="completed",fM="cancelled",jre=`task-${fM}`,Ure=`task-${LF}`,PC=`${zF}-${fM}`,Vre=`${zF}-${LF}`,p2=class{constructor(e){this.code=e,this.message=`${Nre} ${fM} (reason: ${e})`}name="TaskAbortError";message},dM=(e,r)=>{if(typeof e!="function")throw new TypeError(Sf(32))},ew=()=>{},BF=(e,r=ew)=>(e.catch(r),e),FF=(e,r)=>(e.addEventListener("abort",r,{once:!0}),()=>e.removeEventListener("abort",r)),fg=(e,r)=>{const a=e.signal;a.aborted||("reason"in a||Object.defineProperty(a,"reason",{enumerable:!0,value:r,configurable:!0,writable:!0}),e.abort(r))},dg=e=>{if(e.aborted){const{reason:r}=e;throw new p2(r)}};function NF(e,r){let a=ew;return new Promise((l,m)=>{const y=()=>m(new p2(e.reason));if(e.aborted){y();return}a=FF(e,y),r.finally(()=>a()).then(l,m)}).finally(()=>{a=ew})}var $re=async(e,r)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(a){return{status:a instanceof p2?"cancelled":"rejected",error:a}}finally{r?.()}},tw=e=>r=>BF(NF(e,r).then(a=>(dg(e),a))),jF=e=>{const r=tw(e);return a=>r(new Promise(l=>setTimeout(l,a)))},{assign:z_}=Object,f4={},m2="listenerMiddleware",Gre=(e,r)=>{const a=l=>FF(e,()=>fg(l,e.reason));return(l,m)=>{dM(l);const y=new AbortController;a(y);const T=$re(async()=>{dg(e),dg(y.signal);const i=await l({pause:tw(y.signal),delay:jF(y.signal),signal:y.signal});return dg(y.signal),i},()=>fg(y,Ure));return m?.autoJoin&&r.push(T.catch(ew)),{result:tw(e)(T),cancel(){fg(y,jre)}}}},Hre=(e,r)=>{const a=async(l,m)=>{dg(r);let y=()=>{};const i=[new Promise((z,B)=>{let F=e({predicate:l,effect:(G,Q)=>{Q.unsubscribe(),z([G,Q.getState(),Q.getOriginalState()])}});y=()=>{F(),B()}})];m!=null&&i.push(new Promise(z=>setTimeout(z,m,null)));try{const z=await NF(r,Promise.race(i));return dg(r),z}finally{y()}};return(l,m)=>BF(a(l,m))},UF=e=>{let{type:r,actionCreator:a,matcher:l,predicate:m,effect:y}=e;if(r)m=sd(r).match;else if(a)r=a.type,m=a.match;else if(l)m=l;else if(!m)throw new Error(Sf(21));return dM(y),{predicate:m,type:r,effect:y}},VF=z_(e=>{const{type:r,predicate:a,effect:l}=UF(e);return{id:Ire(),effect:l,type:r,predicate:a,pending:new Set,unsubscribe:()=>{throw new Error(Sf(22))}}},{withTypes:()=>VF}),d4=(e,r)=>{const{type:a,effect:l,predicate:m}=UF(r);return Array.from(e.values()).find(y=>(typeof a=="string"?y.type===a:y.predicate===m)&&y.effect===l)},RC=e=>{e.pending.forEach(r=>{fg(r,PC)})},qre=e=>()=>{e.forEach(RC),e.clear()},p4=(e,r,a)=>{try{e(r,a)}catch(l){setTimeout(()=>{throw l},0)}},$F=z_(sd(`${m2}/add`),{withTypes:()=>$F}),Wre=sd(`${m2}/removeAll`),GF=z_(sd(`${m2}/remove`),{withTypes:()=>GF}),Zre=(...e)=>{console.error(`${m2}/error`,...e)},Ex=(e={})=>{const r=new Map,{extra:a,onError:l=Zre}=e;dM(l);const m=F=>(F.unsubscribe=()=>r.delete(F.id),r.set(F.id,F),G=>{F.unsubscribe(),G?.cancelActive&&RC(F)}),y=F=>{const G=d4(r,F)??VF(F);return m(G)};z_(y,{withTypes:()=>y});const T=F=>{const G=d4(r,F);return G&&(G.unsubscribe(),F.cancelActive&&RC(G)),!!G};z_(T,{withTypes:()=>T});const i=async(F,G,Q,te)=>{const ne=new AbortController,oe=Hre(y,ne.signal),ue=[];try{F.pending.add(ne),await Promise.resolve(F.effect(G,z_({},Q,{getOriginalState:te,condition:(ye,we)=>oe(ye,we).then(Boolean),take:oe,delay:jF(ne.signal),pause:tw(ne.signal),extra:a,signal:ne.signal,fork:Gre(ne.signal,ue),unsubscribe:F.unsubscribe,subscribe:()=>{r.set(F.id,F)},cancelActiveListeners:()=>{F.pending.forEach((ye,we,ve)=>{ye!==ne&&(fg(ye,PC),ve.delete(ye))})},cancel:()=>{fg(ne,PC),F.pending.delete(ne)},throwIfCancelled:()=>{dg(ne.signal)}})))}catch(ye){ye instanceof p2||p4(l,ye,{raisedBy:"effect"})}finally{await Promise.all(ue),fg(ne,Vre),F.pending.delete(ne)}},z=qre(r);return{middleware:F=>G=>Q=>{if(!SF(Q))return G(Q);if($F.match(Q))return y(Q.payload);if(Wre.match(Q)){z();return}if(GF.match(Q))return T(Q.payload);let te=F.getState();const ne=()=>{if(te===f4)throw new Error(Sf(23));return te};let oe;try{if(oe=G(Q),r.size>0){const ue=F.getState(),ye=Array.from(r.values());for(const we of ye){let ve=!1;try{ve=we.predicate(Q,ue,te)}catch(Ce){ve=!1,p4(l,Ce,{raisedBy:"predicate"})}ve&&i(we,Q,F,ne)}}}finally{te=f4}return oe},startListening:y,stopListening:T,clearListeners:z}};function Sf(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Xre={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},HF=Mf({name:"chartLayout",initialState:Xre,reducers:{setLayout(e,r){e.layoutType=r.payload},setChartSize(e,r){e.width=r.payload.width,e.height=r.payload.height},setMargin(e,r){var a,l,m,y;e.margin.top=(a=r.payload.top)!==null&&a!==void 0?a:0,e.margin.right=(l=r.payload.right)!==null&&l!==void 0?l:0,e.margin.bottom=(m=r.payload.bottom)!==null&&m!==void 0?m:0,e.margin.left=(y=r.payload.left)!==null&&y!==void 0?y:0},setScale(e,r){e.scale=r.payload}}}),{setMargin:Yre,setLayout:Qre,setChartSize:Kre,setScale:Jre}=HF.actions,ene=HF.reducer;function m4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function A4(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?m4(Object(a),!0).forEach(function(l){tne(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function tne(e,r,a){return(r=rne(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function rne(e){var r=nne(e,"string");return typeof r=="symbol"?r:r+""}function nne(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var rw=Math.PI/180,ine=e=>e*180/Math.PI,_c=(e,r,a,l)=>({x:e+Math.cos(-rw*l)*a,y:r+Math.sin(-rw*l)*a}),one=function(r,a){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(r-(l.left||0)-(l.right||0)),Math.abs(a-(l.top||0)-(l.bottom||0)))/2},ane=(e,r)=>{var{x:a,y:l}=e,{x:m,y}=r;return Math.sqrt((a-m)**2+(l-y)**2)},sne=(e,r)=>{var{x:a,y:l}=e,{cx:m,cy:y}=r,T=ane({x:a,y:l},{x:m,y});if(T<=0)return{radius:T,angle:0};var i=(a-m)/T,z=Math.acos(i);return l>y&&(z=2*Math.PI-z),{radius:T,angle:ine(z),angleInRadian:z}},lne=e=>{var{startAngle:r,endAngle:a}=e,l=Math.floor(r/360),m=Math.floor(a/360),y=Math.min(l,m);return{startAngle:r-y*360,endAngle:a-y*360}},cne=(e,r)=>{var{startAngle:a,endAngle:l}=r,m=Math.floor(a/360),y=Math.floor(l/360),T=Math.min(m,y);return e+T*360},une=(e,r)=>{var{x:a,y:l}=e,{radius:m,angle:y}=sne({x:a,y:l},r),{innerRadius:T,outerRadius:i}=r;if(m<T||m>i||m===0)return null;var{startAngle:z,endAngle:B}=lne(r),F=y,G;if(z<=B){for(;F>B;)F-=360;for(;F<z;)F+=360;G=F>=z&&F<=B}else{for(;F>z;)F-=360;for(;F<B;)F+=360;G=F>=B&&F<=z}return G?A4(A4({},r),{},{radius:m,angle:cne(F,r)}):null};function qF(e,r,a){return Array.isArray(e)&&e&&r+a!==0?e.slice(r,a+1):e}function g4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function id(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?g4(Object(a),!0).forEach(function(l){hne(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function hne(e,r,a){return(r=fne(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function fne(e){var r=dne(e,"string");return typeof r=="symbol"?r:r+""}function dne(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Hu(e,r,a){return yc(e)||yc(r)?a:qp(r)?s2(e,r,a):typeof r=="function"?r(e):a}var pne=(e,r,a,l,m)=>{var y,T=-1,i=(y=r?.length)!==null&&y!==void 0?y:0;if(i<=1||e==null)return 0;if(l==="angleAxis"&&m!=null&&Math.abs(Math.abs(m[1]-m[0])-360)<=1e-6)for(var z=0;z<i;z++){var B=z>0?a[z-1].coordinate:a[i-1].coordinate,F=a[z].coordinate,G=z>=i-1?a[0].coordinate:a[z+1].coordinate,Q=void 0;if(qd(F-B)!==qd(G-F)){var te=[];if(qd(G-F)===qd(m[1]-m[0])){Q=G;var ne=F+m[1]-m[0];te[0]=Math.min(ne,(ne+B)/2),te[1]=Math.max(ne,(ne+B)/2)}else{Q=B;var oe=G+m[1]-m[0];te[0]=Math.min(F,(oe+F)/2),te[1]=Math.max(F,(oe+F)/2)}var ue=[Math.min(F,(Q+F)/2),Math.max(F,(Q+F)/2)];if(e>ue[0]&&e<=ue[1]||e>=te[0]&&e<=te[1]){({index:T}=a[z]);break}}else{var ye=Math.min(B,G),we=Math.max(B,G);if(e>(ye+F)/2&&e<=(we+F)/2){({index:T}=a[z]);break}}}else if(r){for(var ve=0;ve<i;ve++)if(ve===0&&e<=(r[ve].coordinate+r[ve+1].coordinate)/2||ve>0&&ve<i-1&&e>(r[ve].coordinate+r[ve-1].coordinate)/2&&e<=(r[ve].coordinate+r[ve+1].coordinate)/2||ve===i-1&&e>(r[ve].coordinate+r[ve-1].coordinate)/2){({index:T}=r[ve]);break}}return T},mne=(e,r,a)=>{if(r&&a){var{width:l,height:m}=a,{align:y,verticalAlign:T,layout:i}=r;if((i==="vertical"||i==="horizontal"&&T==="middle")&&y!=="center"&&oo(e[y]))return id(id({},e),{},{[y]:e[y]+(l||0)});if((i==="horizontal"||i==="vertical"&&y==="center")&&T!=="middle"&&oo(e[T]))return id(id({},e),{},{[T]:e[T]+(m||0)})}return e},eA=(e,r)=>e==="horizontal"&&r==="xAxis"||e==="vertical"&&r==="yAxis"||e==="centric"&&r==="angleAxis"||e==="radial"&&r==="radiusAxis",_4=1e-4,Ane=e=>{var r=e.domain();if(!(!r||r.length<=2)){var a=r.length,l=e.range(),m=Math.min(l[0],l[1])-_4,y=Math.max(l[0],l[1])+_4,T=e(r[0]),i=e(r[a-1]);(T<m||T>y||i<m||i>y)&&e.domain([r[0],r[a-1]])}},gne=e=>{var r=e.length;if(!(r<=0))for(var a=0,l=e[0].length;a<l;++a)for(var m=0,y=0,T=0;T<r;++T){var i=ad(e[T][a][1])?e[T][a][0]:e[T][a][1];i>=0?(e[T][a][0]=m,e[T][a][1]=m+i,m=e[T][a][1]):(e[T][a][0]=y,e[T][a][1]=y+i,y=e[T][a][1])}},_ne=e=>{var r=e.length;if(!(r<=0))for(var a=0,l=e[0].length;a<l;++a)for(var m=0,y=0;y<r;++y){var T=ad(e[y][a][1])?e[y][a][0]:e[y][a][1];T>=0?(e[y][a][0]=m,e[y][a][1]=m+T,m=e[y][a][1]):(e[y][a][0]=0,e[y][a][1]=0)}},yne={sign:gne,expand:ste,none:$_,silhouette:lte,wiggle:cte,positive:_ne},vne=(e,r,a)=>{var l=yne[a],m=ate().keys(r).value((y,T)=>+Hu(y,T,0)).order(wC).offset(l);return m(e)};function xne(e){return e==null?void 0:String(e)}function y4(e){var{axis:r,ticks:a,bandSize:l,entry:m,index:y,dataKey:T}=e;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!yc(m[r.dataKey])){var i=q5(a,"value",m[r.dataKey]);if(i)return i.coordinate+l/2}return a[y]?a[y].coordinate+l/2:null}var z=Hu(m,yc(T)?r.dataKey:T);return yc(z)?null:r.scale(z)}var bne=e=>{var r=e.flat(2).filter(oo);return[Math.min(...r),Math.max(...r)]},wne=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Sne=(e,r,a)=>{if(e!=null)return wne(Object.keys(e).reduce((l,m)=>{var y=e[m],{stackedData:T}=y,i=T.reduce((z,B)=>{var F=qF(B,r,a),G=bne(F);return[Math.min(z[0],G[0]),Math.max(z[1],G[1])]},[1/0,-1/0]);return[Math.min(i[0],l[0]),Math.max(i[1],l[1])]},[1/0,-1/0]))},v4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,x4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,DC=(e,r,a)=>{if(e&&e.scale&&e.scale.bandwidth){var l=e.scale.bandwidth();if(!a||l>0)return l}if(e&&r&&r.length>=2){for(var m=u2(r,F=>F.coordinate),y=1/0,T=1,i=m.length;T<i;T++){var z=m[T],B=m[T-1];y=Math.min((z.coordinate||0)-(B.coordinate||0),y)}return y===1/0?0:y}return a?void 0:0};function b4(e){var{tooltipEntrySettings:r,dataKey:a,payload:l,value:m,name:y}=e;return id(id({},r),{},{dataKey:a,payload:l,value:m,name:y})}function WF(e,r){if(e)return String(e);if(typeof r=="string")return r}function Tne(e,r,a,l,m){if(a==="horizontal"||a==="vertical"){var y=e>=m.left&&e<=m.left+m.width&&r>=m.top&&r<=m.top+m.height;return y?{x:e,y:r}:null}return l?une({x:e,y:r},l):null}var Ene=(e,r,a,l)=>{var m=r.find(B=>B&&B.index===a);if(m){if(e==="horizontal")return{x:m.coordinate,y:l.y};if(e==="vertical")return{x:l.x,y:m.coordinate};if(e==="centric"){var y=m.coordinate,{radius:T}=l;return id(id(id({},l),_c(l.cx,l.cy,T,y)),{},{angle:y,radius:T})}var i=m.coordinate,{angle:z}=l;return id(id(id({},l),_c(l.cx,l.cy,i,z)),{},{angle:z,radius:i})}return{x:0,y:0}},Cne=(e,r)=>r==="horizontal"?e.x:r==="vertical"?e.y:r==="centric"?e.angle:e.radius,tA=e=>e.layout.width,rA=e=>e.layout.height,Mne=e=>e.layout.scale,ZF=e=>e.layout.margin,A2=Pr(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),g2=Pr(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Ine="data-recharts-item-index",Pne="data-recharts-item-data-key",Cx=60;function w4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function fb(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?w4(Object(a),!0).forEach(function(l){Rne(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Rne(e,r,a){return(r=Dne(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Dne(e){var r=One(e,"string");return typeof r=="symbol"?r:r+""}function One(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var kne=e=>e.brush.height;function zne(e){var r=g2(e);return r.reduce((a,l)=>{if(l.orientation==="left"&&!l.mirror&&!l.hide){var m=typeof l.width=="number"?l.width:Cx;return a+m}return a},0)}function Lne(e){var r=g2(e);return r.reduce((a,l)=>{if(l.orientation==="right"&&!l.mirror&&!l.hide){var m=typeof l.width=="number"?l.width:Cx;return a+m}return a},0)}function Bne(e){var r=A2(e);return r.reduce((a,l)=>l.orientation==="top"&&!l.mirror&&!l.hide?a+l.height:a,0)}function Fne(e){var r=A2(e);return r.reduce((a,l)=>l.orientation==="bottom"&&!l.mirror&&!l.hide?a+l.height:a,0)}var vc=Pr([tA,rA,ZF,kne,zne,Lne,Bne,Fne,xF,tre],(e,r,a,l,m,y,T,i,z,B)=>{var F={left:(a.left||0)+m,right:(a.right||0)+y},G={top:(a.top||0)+T,bottom:(a.bottom||0)+i},Q=fb(fb({},G),F),te=Q.bottom;Q.bottom+=l,Q=mne(Q,z,B);var ne=e-Q.left-Q.right,oe=r-Q.top-Q.bottom;return fb(fb({brushBottom:te},Q),{},{width:Math.max(ne,0),height:Math.max(oe,0)})}),Nne=Pr(vc,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),XF=Pr(tA,rA,(e,r)=>({x:0,y:0,width:e,height:r})),jne=ae.createContext(null),ep=()=>ae.useContext(jne)!=null,_2=e=>e.brush,y2=Pr([_2,vc,ZF],(e,r,a)=>({height:e.height,x:oo(e.x)?e.x:r.left,y:oo(e.y)?e.y:r.top+r.height+r.brushBottom-(a?.bottom||0),width:oo(e.width)?e.width:r.width})),pM=()=>{var e,r=ep(),a=ji(Nne),l=ji(y2),m=(e=ji(_2))===null||e===void 0?void 0:e.padding;return!r||!l||!m?a:{width:l.width-m.left-m.right,height:l.height-m.top-m.bottom,x:m.left,y:m.top}},Une={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Vne=()=>{var e;return(e=ji(vc))!==null&&e!==void 0?e:Une},$ne=()=>ji(tA),Gne=()=>ji(rA),Ya=e=>e.layout.layoutType,mM=()=>ji(Ya),Hne={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},YF=Mf({name:"legend",initialState:Hne,reducers:{setLegendSize(e,r){e.size.width=r.payload.width,e.size.height=r.payload.height},setLegendSettings(e,r){e.settings.align=r.payload.align,e.settings.layout=r.payload.layout,e.settings.verticalAlign=r.payload.verticalAlign,e.settings.itemSorter=r.payload.itemSorter},addLegendPayload(e,r){e.payload.push(r.payload)},removeLegendPayload(e,r){var a=Um(e).payload.indexOf(r.payload);a>-1&&e.payload.splice(a,1)}}}),{setLegendSize:yAe,setLegendSettings:vAe,addLegendPayload:qne,removeLegendPayload:Wne}=YF.actions,Zne=YF.reducer;function OC(){return OC=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},OC.apply(null,arguments)}function S4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function uE(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?S4(Object(a),!0).forEach(function(l){Xne(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Xne(e,r,a){return(r=Yne(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Yne(e){var r=Qne(e,"string");return typeof r=="symbol"?r:r+""}function Qne(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Kne(e){return Array.isArray(e)&&qp(e[0])&&qp(e[1])?e.join(" ~ "):e}var Jne=e=>{var{separator:r=" : ",contentStyle:a={},itemStyle:l={},labelStyle:m={},payload:y,formatter:T,itemSorter:i,wrapperClassName:z,labelClassName:B,label:F,labelFormatter:G,accessibilityLayer:Q=!1}=e,te=()=>{if(y&&y.length){var Ee={padding:0,margin:0},Be=(i?u2(y,i):y).map((Ke,st)=>{if(Ke.type==="none")return null;var dt=Ke.formatter||T||Kne,{value:bt,name:ht}=Ke,Re=bt,Pt=ht;if(dt){var wt=dt(bt,ht,Ke,st,y);if(Array.isArray(wt))[Re,Pt]=wt;else if(wt!=null)Re=wt;else return null}var Et=uE({display:"block",paddingTop:4,paddingBottom:4,color:Ke.color||"#000"},l);return ae.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(st),style:Et},qp(Pt)?ae.createElement("span",{className:"recharts-tooltip-item-name"},Pt):null,qp(Pt)?ae.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,ae.createElement("span",{className:"recharts-tooltip-item-value"},Re),ae.createElement("span",{className:"recharts-tooltip-item-unit"},Ke.unit||""))});return ae.createElement("ul",{className:"recharts-tooltip-item-list",style:Ee},Be)}return null},ne=uE({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),oe=uE({margin:0},m),ue=!yc(F),ye=ue?F:"",we=on("recharts-default-tooltip",z),ve=on("recharts-tooltip-label",B);ue&&G&&y!==void 0&&y!==null&&(ye=G(F,y));var Ce=Q?{role:"status","aria-live":"assertive"}:{};return ae.createElement("div",OC({className:we,style:ne},Ce),ae.createElement("p",{className:ve,style:oe},ae.isValidElement(ye)?ye:"".concat(ye)),te())},yv="recharts-tooltip-wrapper",eie={visibility:"hidden"};function tie(e){var{coordinate:r,translateX:a,translateY:l}=e;return on(yv,{["".concat(yv,"-right")]:oo(a)&&r&&oo(r.x)&&a>=r.x,["".concat(yv,"-left")]:oo(a)&&r&&oo(r.x)&&a<r.x,["".concat(yv,"-bottom")]:oo(l)&&r&&oo(r.y)&&l>=r.y,["".concat(yv,"-top")]:oo(l)&&r&&oo(r.y)&&l<r.y})}function T4(e){var{allowEscapeViewBox:r,coordinate:a,key:l,offsetTopLeft:m,position:y,reverseDirection:T,tooltipDimension:i,viewBox:z,viewBoxDimension:B}=e;if(y&&oo(y[l]))return y[l];var F=a[l]-i-(m>0?m:0),G=a[l]+m;if(r[l])return T[l]?F:G;var Q=z[l];if(Q==null)return 0;if(T[l]){var te=F,ne=Q;return te<ne?Math.max(G,Q):Math.max(F,Q)}if(B==null)return 0;var oe=G+i,ue=Q+B;return oe>ue?Math.max(F,Q):Math.max(G,Q)}function rie(e){var{translateX:r,translateY:a,useTranslate3d:l}=e;return{transform:l?"translate3d(".concat(r,"px, ").concat(a,"px, 0)"):"translate(".concat(r,"px, ").concat(a,"px)")}}function nie(e){var{allowEscapeViewBox:r,coordinate:a,offsetTopLeft:l,position:m,reverseDirection:y,tooltipBox:T,useTranslate3d:i,viewBox:z}=e,B,F,G;return T.height>0&&T.width>0&&a?(F=T4({allowEscapeViewBox:r,coordinate:a,key:"x",offsetTopLeft:l,position:m,reverseDirection:y,tooltipDimension:T.width,viewBox:z,viewBoxDimension:z.width}),G=T4({allowEscapeViewBox:r,coordinate:a,key:"y",offsetTopLeft:l,position:m,reverseDirection:y,tooltipDimension:T.height,viewBox:z,viewBoxDimension:z.height}),B=rie({translateX:F,translateY:G,useTranslate3d:i})):B=eie,{cssProperties:B,cssClasses:tie({translateX:F,translateY:G,coordinate:a})}}function E4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function db(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?E4(Object(a),!0).forEach(function(l){kC(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function kC(e,r,a){return(r=iie(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function iie(e){var r=oie(e,"string");return typeof r=="symbol"?r:r+""}function oie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class aie extends ae.PureComponent{constructor(){super(...arguments),kC(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),kC(this,"handleKeyDown",r=>{if(r.key==="Escape"){var a,l,m,y;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(a=(l=this.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&a!==void 0?a:0,y:(m=(y=this.props.coordinate)===null||y===void 0?void 0:y.y)!==null&&m!==void 0?m:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var r,a;this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:r,allowEscapeViewBox:a,animationDuration:l,animationEasing:m,children:y,coordinate:T,hasPayload:i,isAnimationActive:z,offset:B,position:F,reverseDirection:G,useTranslate3d:Q,viewBox:te,wrapperStyle:ne,lastBoundingBox:oe,innerRef:ue,hasPortalFromProps:ye}=this.props,{cssClasses:we,cssProperties:ve}=nie({allowEscapeViewBox:a,coordinate:T,offsetTopLeft:B,position:F,reverseDirection:G,tooltipBox:{height:oe.height,width:oe.width},useTranslate3d:Q,viewBox:te}),Ce=ye?{}:db(db({transition:z&&r?"transform ".concat(l,"ms ").concat(m):void 0},ve),{},{pointerEvents:"none",visibility:!this.state.dismissed&&r&&i?"visible":"hidden",position:"absolute",top:0,left:0}),Ee=db(db({},Ce),{},{visibility:!this.state.dismissed&&r&&i?"visible":"hidden"},ne);return ae.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:we,style:Ee,ref:ue},y)}}var sie=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ly={devToolsEnabled:!1,isSsr:sie()},QF=()=>ji(e=>e.rootProps.accessibilityLayer);function qu(e){return Number.isFinite(e)}function nw(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function zC(){return zC=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},zC.apply(null,arguments)}function C4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function M4(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?C4(Object(a),!0).forEach(function(l){lie(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function lie(e,r,a){return(r=cie(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function cie(e){var r=uie(e,"string");return typeof r=="symbol"?r:r+""}function uie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var I4={curveBasisClosed:Xee,curveBasisOpen:Yee,curveBasis:Zee,curveBumpX:qee,curveBumpY:Wee,curveLinearClosed:Qee,curveLinear:l2,curveMonotoneX:Kee,curveMonotoneY:Jee,curveNatural:ete,curveStep:tte,curveStepAfter:nte,curveStepBefore:rte},pb=e=>qu(e.x)&&qu(e.y),vv=e=>e.x,xv=e=>e.y,hie=(e,r)=>{if(typeof e=="function")return e;var a="curve".concat(rM(e));return(a==="curveMonotone"||a==="curveBump")&&r?I4["".concat(a).concat(r==="vertical"?"Y":"X")]:I4[a]||l2},fie=e=>{var{type:r="linear",points:a=[],baseLine:l,layout:m,connectNulls:y=!1}=e,T=hie(r,m),i=y?a.filter(pb):a,z;if(Array.isArray(l)){var B=y?l.filter(G=>pb(G)):l,F=i.map((G,Q)=>M4(M4({},G),{},{base:B[Q]}));return m==="vertical"?z=ab().y(xv).x1(vv).x0(G=>G.base.x):z=ab().x(vv).y1(xv).y0(G=>G.base.y),z.defined(pb).curve(T),z(F)}return m==="vertical"&&oo(l)?z=ab().y(xv).x1(vv).x0(l):oo(l)?z=ab().x(vv).y1(xv).y0(l):z=tF().x(vv).y(xv),z.defined(pb).curve(T),z(i)},Rb=e=>{var{className:r,points:a,path:l,pathRef:m}=e;if((!a||!a.length)&&!l)return null;var y=a&&a.length?fie(e):l;return ae.createElement("path",zC({},wg(e),iM(e),{className:on("recharts-curve",r),d:y===null?void 0:y,ref:m}))},die=["x","y","top","left","width","height","className"];function LC(){return LC=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},LC.apply(null,arguments)}function P4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function pie(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?P4(Object(a),!0).forEach(function(l){mie(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function mie(e,r,a){return(r=Aie(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Aie(e){var r=gie(e,"string");return typeof r=="symbol"?r:r+""}function gie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function _ie(e,r){if(e==null)return{};var a,l,m=yie(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function yie(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var vie=(e,r,a,l,m,y)=>"M".concat(e,",").concat(m,"v").concat(l,"M").concat(y,",").concat(r,"h").concat(a),xie=e=>{var{x:r=0,y:a=0,top:l=0,left:m=0,width:y=0,height:T=0,className:i}=e,z=_ie(e,die),B=pie({x:r,y:a,top:l,left:m,width:y,height:T},z);return!oo(r)||!oo(a)||!oo(y)||!oo(T)||!oo(l)||!oo(m)?null:ae.createElement("path",LC({},Jc(B,!0),{className:on("recharts-cross",i),d:vie(r,a,y,T,l,m)}))};function bie(e,r,a,l){var m=l/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?r.x-m:a.left+.5,y:e==="horizontal"?a.top+.5:r.y-m,width:e==="horizontal"?l:a.width-1,height:e==="horizontal"?a.height-1:l}}function R4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function wie(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?R4(Object(a),!0).forEach(function(l){Sie(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Sie(e,r,a){return(r=Tie(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Tie(e){var r=Eie(e,"string");return typeof r=="symbol"?r:r+""}function Eie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function tp(e,r){var a=wie({},e),l=r,m=Object.keys(r),y=m.reduce((T,i)=>(T[i]===void 0&&l[i]!==void 0&&(T[i]=l[i]),T),a);return y}function Cie(){}function D4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function O4(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?D4(Object(a),!0).forEach(function(l){Mie(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):D4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Mie(e,r,a){return(r=Iie(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Iie(e){var r=Pie(e,"string");return typeof r=="symbol"?r:r+""}function Pie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Rie=e=>e.replace(/([A-Z])/g,r=>"-".concat(r.toLowerCase())),Die=(e,r,a)=>e.map(l=>"".concat(Rie(l)," ").concat(r,"ms ").concat(a)).join(","),Oie=(e,r)=>[Object.keys(e),Object.keys(r)].reduce((a,l)=>a.filter(m=>l.includes(m))),Qv=(e,r)=>Object.keys(r).reduce((a,l)=>O4(O4({},a),{},{[l]:e(l,r[l])}),{});function k4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Ac(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?k4(Object(a),!0).forEach(function(l){kie(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function kie(e,r,a){return(r=zie(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function zie(e){var r=Lie(e,"string");return typeof r=="symbol"?r:r+""}function Lie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var iw=(e,r,a)=>e+(r-e)*a,BC=e=>{var{from:r,to:a}=e;return r!==a},KF=(e,r,a)=>{var l=Qv((m,y)=>{if(BC(y)){var[T,i]=e(y.from,y.to,y.velocity);return Ac(Ac({},y),{},{from:T,velocity:i})}return y},r);return a<1?Qv((m,y)=>BC(y)?Ac(Ac({},y),{},{velocity:iw(y.velocity,l[m].velocity,a),from:iw(y.from,l[m].from,a)}):y,r):KF(e,l,a-1)};function Bie(e,r,a,l,m,y){var T,i=l.reduce((Q,te)=>Ac(Ac({},Q),{},{[te]:{from:e[te],velocity:0,to:r[te]}}),{}),z=()=>Qv((Q,te)=>te.from,i),B=()=>!Object.values(i).filter(BC).length,F=null,G=Q=>{T||(T=Q);var te=Q-T,ne=te/a.dt;i=KF(a,i,ne),m(Ac(Ac(Ac({},e),r),z())),T=Q,B()||(F=y.setTimeout(G))};return()=>(F=y.setTimeout(G),()=>{F()})}function Fie(e,r,a,l,m,y,T){var i=null,z=m.reduce((G,Q)=>Ac(Ac({},G),{},{[Q]:[e[Q],r[Q]]}),{}),B,F=G=>{B||(B=G);var Q=(G-B)/l,te=Qv((oe,ue)=>iw(...ue,a(Q)),z);if(y(Ac(Ac(Ac({},e),r),te)),Q<1)i=T.setTimeout(F);else{var ne=Qv((oe,ue)=>iw(...ue,a(1)),z);y(Ac(Ac(Ac({},e),r),ne))}};return()=>(i=T.setTimeout(F),()=>{i()})}const Nie=(e,r,a,l,m,y)=>{var T=Oie(e,r);return a.isStepper===!0?Bie(e,r,a,T,m,y):Fie(e,r,a,l,T,m,y)};var ow=1e-4,JF=(e,r)=>[0,3*e,3*r-6*e,3*e-3*r+1],e6=(e,r)=>e.map((a,l)=>a*r**l).reduce((a,l)=>a+l),z4=(e,r)=>a=>{var l=JF(e,r);return e6(l,a)},jie=(e,r)=>a=>{var l=JF(e,r),m=[...l.map((y,T)=>y*T).slice(1),0];return e6(m,a)},L4=function(){for(var r,a,l,m,y=arguments.length,T=new Array(y),i=0;i<y;i++)T[i]=arguments[i];if(T.length===1)switch(T[0]){case"linear":[r,l,a,m]=[0,0,1,1];break;case"ease":[r,l,a,m]=[.25,.1,.25,1];break;case"ease-in":[r,l,a,m]=[.42,0,1,1];break;case"ease-out":[r,l,a,m]=[.42,0,.58,1];break;case"ease-in-out":[r,l,a,m]=[0,0,.58,1];break;default:{var z=T[0].split("(");z[0]==="cubic-bezier"&&z[1].split(")")[0].split(",").length===4&&([r,l,a,m]=z[1].split(")")[0].split(",").map(ne=>parseFloat(ne)))}}else T.length===4&&([r,l,a,m]=T);var B=z4(r,a),F=z4(l,m),G=jie(r,a),Q=ne=>ne>1?1:ne<0?0:ne,te=ne=>{for(var oe=ne>1?1:ne,ue=oe,ye=0;ye<8;++ye){var we=B(ue)-oe,ve=G(ue);if(Math.abs(we-oe)<ow||ve<ow)return F(ue);ue=Q(ue-we/ve)}return F(ue)};return te.isStepper=!1,te},Uie=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:a=100,damping:l=8,dt:m=17}=r,y=(T,i,z)=>{var B=-(T-i)*a,F=z*l,G=z+(B-F)*m/1e3,Q=z*m/1e3+T;return Math.abs(Q-i)<ow&&Math.abs(G)<ow?[i,0]:[Q,G]};return y.isStepper=!0,y.dt=m,y},Vie=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return L4(e);case"spring":return Uie();default:if(e.split("(")[0]==="cubic-bezier")return L4(e)}return typeof e=="function"?e:null};function $ie(e){var r,a=()=>null,l=!1,m=null,y=T=>{if(!l){if(Array.isArray(T)){if(!T.length)return;var i=T,[z,...B]=i;if(typeof z=="number"){m=e.setTimeout(y.bind(null,B),z);return}y(z),m=e.setTimeout(y.bind(null,B));return}typeof T=="string"&&(r=T,a(r)),typeof T=="object"&&(r=T,a(r)),typeof T=="function"&&T()}};return{stop:()=>{l=!0},start:T=>{l=!1,m&&(m(),m=null),y(T)},subscribe:T=>(a=T,()=>{a=()=>null}),getTimeoutController:()=>e}}class Gie{setTimeout(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=performance.now(),m=null,y=T=>{T-l>=a?r(T):typeof requestAnimationFrame=="function"&&(m=requestAnimationFrame(y))};return m=requestAnimationFrame(y),()=>{cancelAnimationFrame(m)}}}function Hie(){return $ie(new Gie)}var qie=ae.createContext(Hie);function Wie(e,r){var a=ae.useContext(qie);return ae.useMemo(()=>r??a(e),[e,r,a])}var Zie={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},B4={t:0},hE={t:1};function t6(e){var r=tp(e,Zie),{isActive:a,canBegin:l,duration:m,easing:y,begin:T,onAnimationEnd:i,onAnimationStart:z,children:B}=r,F=Wie(r.animationId,r.animationManager),[G,Q]=ae.useState(a?B4:hE),te=ae.useRef(null);return ae.useEffect(()=>{a||Q(hE)},[a]),ae.useEffect(()=>{if(!a||!l)return Cie;var ne=Nie(B4,hE,Vie(y),m,Q,F.getTimeoutController()),oe=()=>{te.current=ne()};return F.start([z,T,oe,m,i]),()=>{F.stop(),te.current&&te.current(),i()}},[a,l,m,y,T,z,i,F]),B(G.t)}function r6(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",a=ae.useRef(Zv(r)),l=ae.useRef(e);return l.current!==e&&(a.current=Zv(r),l.current=e),a.current}function F4(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function N4(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?F4(Object(a),!0).forEach(function(l){Xie(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):F4(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Xie(e,r,a){return(r=Yie(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Yie(e){var r=Qie(e,"string");return typeof r=="symbol"?r:r+""}function Qie(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function aw(){return aw=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},aw.apply(null,arguments)}var j4=(e,r,a,l,m)=>{var y=Math.min(Math.abs(a)/2,Math.abs(l)/2),T=l>=0?1:-1,i=a>=0?1:-1,z=l>=0&&a>=0||l<0&&a<0?1:0,B;if(y>0&&m instanceof Array){for(var F=[0,0,0,0],G=0,Q=4;G<Q;G++)F[G]=m[G]>y?y:m[G];B="M".concat(e,",").concat(r+T*F[0]),F[0]>0&&(B+="A ".concat(F[0],",").concat(F[0],",0,0,").concat(z,",").concat(e+i*F[0],",").concat(r)),B+="L ".concat(e+a-i*F[1],",").concat(r),F[1]>0&&(B+="A ".concat(F[1],",").concat(F[1],",0,0,").concat(z,`,
        `).concat(e+a,",").concat(r+T*F[1])),B+="L ".concat(e+a,",").concat(r+l-T*F[2]),F[2]>0&&(B+="A ".concat(F[2],",").concat(F[2],",0,0,").concat(z,`,
        `).concat(e+a-i*F[2],",").concat(r+l)),B+="L ".concat(e+i*F[3],",").concat(r+l),F[3]>0&&(B+="A ".concat(F[3],",").concat(F[3],",0,0,").concat(z,`,
        `).concat(e,",").concat(r+l-T*F[3])),B+="Z"}else if(y>0&&m===+m&&m>0){var te=Math.min(y,m);B="M ".concat(e,",").concat(r+T*te,`
            A `).concat(te,",").concat(te,",0,0,").concat(z,",").concat(e+i*te,",").concat(r,`
            L `).concat(e+a-i*te,",").concat(r,`
            A `).concat(te,",").concat(te,",0,0,").concat(z,",").concat(e+a,",").concat(r+T*te,`
            L `).concat(e+a,",").concat(r+l-T*te,`
            A `).concat(te,",").concat(te,",0,0,").concat(z,",").concat(e+a-i*te,",").concat(r+l,`
            L `).concat(e+i*te,",").concat(r+l,`
            A `).concat(te,",").concat(te,",0,0,").concat(z,",").concat(e,",").concat(r+l-T*te," Z")}else B="M ".concat(e,",").concat(r," h ").concat(a," v ").concat(l," h ").concat(-a," Z");return B},Kie={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Jie=e=>{var r=tp(e,Kie),a=ae.useRef(null),[l,m]=ae.useState(-1);ae.useEffect(()=>{if(a.current&&a.current.getTotalLength)try{var wt=a.current.getTotalLength();wt&&m(wt)}catch{}},[]);var{x:y,y:T,width:i,height:z,radius:B,className:F}=r,{animationEasing:G,animationDuration:Q,animationBegin:te,isAnimationActive:ne,isUpdateAnimationActive:oe}=r,ue=ae.useRef(i),ye=ae.useRef(z),we=ae.useRef(y),ve=ae.useRef(T),Ce=ae.useMemo(()=>({x:y,y:T,width:i,height:z,radius:B}),[y,T,i,z,B]),Ee=r6(Ce,"rectangle-");if(y!==+y||T!==+T||i!==+i||z!==+z||i===0||z===0)return null;var Be=on("recharts-rectangle",F);if(!oe)return ae.createElement("path",aw({},Jc(r,!0),{className:Be,d:j4(y,T,i,z,B)}));var Ke=ue.current,st=ye.current,dt=we.current,bt=ve.current,ht="0px ".concat(l===-1?1:l,"px"),Re="".concat(l,"px 0px"),Pt=Die(["strokeDasharray"],Q,typeof G=="string"?G:void 0);return ae.createElement(t6,{animationId:Ee,key:Ee,canBegin:l>0,duration:Q,easing:G,isActive:oe,begin:te},wt=>{var Et=Np(Ke,i,wt),et=Np(st,z,wt),Zt=Np(dt,y,wt),ir=Np(bt,T,wt);a.current&&(ue.current=Et,ye.current=et,we.current=Zt,ve.current=ir);var or;return ne?wt>0?or={transition:Pt,strokeDasharray:Re}:or={strokeDasharray:ht}:or={strokeDasharray:Re},ae.createElement("path",aw({},Jc(r,!0),{className:Be,d:j4(Zt,ir,Et,et,B),ref:a,style:N4(N4({},or),r.style)}))})};function n6(e){var{cx:r,cy:a,radius:l,startAngle:m,endAngle:y}=e,T=_c(r,a,l,m),i=_c(r,a,l,y);return{points:[T,i],cx:r,cy:a,radius:l,startAngle:m,endAngle:y}}function FC(){return FC=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},FC.apply(null,arguments)}var eoe=(e,r)=>{var a=qd(r-e),l=Math.min(Math.abs(r-e),359.999);return a*l},mb=e=>{var{cx:r,cy:a,radius:l,angle:m,sign:y,isExternal:T,cornerRadius:i,cornerIsExternal:z}=e,B=i*(T?1:-1)+l,F=Math.asin(i/B)/rw,G=z?m:m+y*F,Q=_c(r,a,B,G),te=_c(r,a,l,G),ne=z?m-y*F:m,oe=_c(r,a,B*Math.cos(F*rw),ne);return{center:Q,circleTangency:te,lineTangency:oe,theta:F}},i6=e=>{var{cx:r,cy:a,innerRadius:l,outerRadius:m,startAngle:y,endAngle:T}=e,i=eoe(y,T),z=y+i,B=_c(r,a,m,y),F=_c(r,a,m,z),G="M ".concat(B.x,",").concat(B.y,`
    A `).concat(m,",").concat(m,`,0,
    `).concat(+(Math.abs(i)>180),",").concat(+(y>z),`,
    `).concat(F.x,",").concat(F.y,`
  `);if(l>0){var Q=_c(r,a,l,y),te=_c(r,a,l,z);G+="L ".concat(te.x,",").concat(te.y,`
            A `).concat(l,",").concat(l,`,0,
            `).concat(+(Math.abs(i)>180),",").concat(+(y<=z),`,
            `).concat(Q.x,",").concat(Q.y," Z")}else G+="L ".concat(r,",").concat(a," Z");return G},toe=e=>{var{cx:r,cy:a,innerRadius:l,outerRadius:m,cornerRadius:y,forceCornerRadius:T,cornerIsExternal:i,startAngle:z,endAngle:B}=e,F=qd(B-z),{circleTangency:G,lineTangency:Q,theta:te}=mb({cx:r,cy:a,radius:m,angle:z,sign:F,cornerRadius:y,cornerIsExternal:i}),{circleTangency:ne,lineTangency:oe,theta:ue}=mb({cx:r,cy:a,radius:m,angle:B,sign:-F,cornerRadius:y,cornerIsExternal:i}),ye=i?Math.abs(z-B):Math.abs(z-B)-te-ue;if(ye<0)return T?"M ".concat(Q.x,",").concat(Q.y,`
        a`).concat(y,",").concat(y,",0,0,1,").concat(y*2,`,0
        a`).concat(y,",").concat(y,",0,0,1,").concat(-y*2,`,0
      `):i6({cx:r,cy:a,innerRadius:l,outerRadius:m,startAngle:z,endAngle:B});var we="M ".concat(Q.x,",").concat(Q.y,`
    A`).concat(y,",").concat(y,",0,0,").concat(+(F<0),",").concat(G.x,",").concat(G.y,`
    A`).concat(m,",").concat(m,",0,").concat(+(ye>180),",").concat(+(F<0),",").concat(ne.x,",").concat(ne.y,`
    A`).concat(y,",").concat(y,",0,0,").concat(+(F<0),",").concat(oe.x,",").concat(oe.y,`
  `);if(l>0){var{circleTangency:ve,lineTangency:Ce,theta:Ee}=mb({cx:r,cy:a,radius:l,angle:z,sign:F,isExternal:!0,cornerRadius:y,cornerIsExternal:i}),{circleTangency:Be,lineTangency:Ke,theta:st}=mb({cx:r,cy:a,radius:l,angle:B,sign:-F,isExternal:!0,cornerRadius:y,cornerIsExternal:i}),dt=i?Math.abs(z-B):Math.abs(z-B)-Ee-st;if(dt<0&&y===0)return"".concat(we,"L").concat(r,",").concat(a,"Z");we+="L".concat(Ke.x,",").concat(Ke.y,`
      A`).concat(y,",").concat(y,",0,0,").concat(+(F<0),",").concat(Be.x,",").concat(Be.y,`
      A`).concat(l,",").concat(l,",0,").concat(+(dt>180),",").concat(+(F>0),",").concat(ve.x,",").concat(ve.y,`
      A`).concat(y,",").concat(y,",0,0,").concat(+(F<0),",").concat(Ce.x,",").concat(Ce.y,"Z")}else we+="L".concat(r,",").concat(a,"Z");return we},roe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},noe=e=>{var r=tp(e,roe),{cx:a,cy:l,innerRadius:m,outerRadius:y,cornerRadius:T,forceCornerRadius:i,cornerIsExternal:z,startAngle:B,endAngle:F,className:G}=r;if(y<m||B===F)return null;var Q=on("recharts-sector",G),te=y-m,ne=s0(T,te,0,!0),oe;return ne>0&&Math.abs(B-F)<360?oe=toe({cx:a,cy:l,innerRadius:m,outerRadius:y,cornerRadius:Math.min(ne,te/2),forceCornerRadius:i,cornerIsExternal:z,startAngle:B,endAngle:F}):oe=i6({cx:a,cy:l,innerRadius:m,outerRadius:y,startAngle:B,endAngle:F}),ae.createElement("path",FC({},Jc(r,!0),{className:Q,d:oe}))};function ioe(e,r,a){var l,m,y,T;if(e==="horizontal")l=r.x,y=l,m=a.top,T=a.top+a.height;else if(e==="vertical")m=r.y,T=m,l=a.left,y=a.left+a.width;else if(r.cx!=null&&r.cy!=null)if(e==="centric"){var{cx:i,cy:z,innerRadius:B,outerRadius:F,angle:G}=r,Q=_c(i,z,B,G),te=_c(i,z,F,G);l=Q.x,m=Q.y,y=te.x,T=te.y}else return n6(r);return[{x:l,y:m},{x:y,y:T}]}var fE={},dE={},pE={},U4;function ooe(){return U4||(U4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=yF();function a(l){return r.isSymbol(l)?NaN:Number(l)}e.toNumber=a})(pE)),pE}var V4;function aoe(){return V4||(V4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=ooe();function a(l){return l?(l=r.toNumber(l),l===1/0||l===-1/0?(l<0?-1:1)*Number.MAX_VALUE:l===l?l:0):l===0?l:0}e.toFinite=a})(dE)),dE}var $4;function soe(){return $4||($4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=vF(),a=aoe();function l(m,y,T){T&&typeof T!="number"&&r.isIterateeCall(m,y,T)&&(y=T=void 0),m=a.toFinite(m),y===void 0?(y=m,m=0):y=a.toFinite(y),T=T===void 0?m<y?1:-1:a.toFinite(T);const i=Math.max(Math.ceil((y-m)/(T||1)),0),z=new Array(i);for(let B=0;B<i;B++)z[B]=m,m+=T;return z}e.range=l})(fE)),fE}var mE,G4;function loe(){return G4||(G4=1,mE=soe().range),mE}var coe=loe();const o6=Zp(coe);function n0(e,r){return e==null||r==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function uoe(e,r){return e==null||r==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function AM(e){let r,a,l;e.length!==2?(r=n0,a=(i,z)=>n0(e(i),z),l=(i,z)=>e(i)-z):(r=e===n0||e===uoe?e:hoe,a=e,l=e);function m(i,z,B=0,F=i.length){if(B<F){if(r(z,z)!==0)return F;do{const G=B+F>>>1;a(i[G],z)<0?B=G+1:F=G}while(B<F)}return B}function y(i,z,B=0,F=i.length){if(B<F){if(r(z,z)!==0)return F;do{const G=B+F>>>1;a(i[G],z)<=0?B=G+1:F=G}while(B<F)}return B}function T(i,z,B=0,F=i.length){const G=m(i,z,B,F-1);return G>B&&l(i[G-1],z)>-l(i[G],z)?G-1:G}return{left:m,center:T,right:y}}function hoe(){return 0}function a6(e){return e===null?NaN:+e}function*foe(e,r){for(let a of e)a!=null&&(a=+a)>=a&&(yield a)}const doe=AM(n0),Mx=doe.right;AM(a6).center;class H4 extends Map{constructor(r,a=Aoe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:a}}),r!=null)for(const[l,m]of r)this.set(l,m)}get(r){return super.get(q4(this,r))}has(r){return super.has(q4(this,r))}set(r,a){return super.set(poe(this,r),a)}delete(r){return super.delete(moe(this,r))}}function q4({_intern:e,_key:r},a){const l=r(a);return e.has(l)?e.get(l):a}function poe({_intern:e,_key:r},a){const l=r(a);return e.has(l)?e.get(l):(e.set(l,a),a)}function moe({_intern:e,_key:r},a){const l=r(a);return e.has(l)&&(a=e.get(l),e.delete(l)),a}function Aoe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function goe(e=n0){if(e===n0)return s6;if(typeof e!="function")throw new TypeError("compare is not a function");return(r,a)=>{const l=e(r,a);return l||l===0?l:(e(a,a)===0)-(e(r,r)===0)}}function s6(e,r){return(e==null||!(e>=e))-(r==null||!(r>=r))||(e<r?-1:e>r?1:0)}const _oe=Math.sqrt(50),yoe=Math.sqrt(10),voe=Math.sqrt(2);function sw(e,r,a){const l=(r-e)/Math.max(0,a),m=Math.floor(Math.log10(l)),y=l/Math.pow(10,m),T=y>=_oe?10:y>=yoe?5:y>=voe?2:1;let i,z,B;return m<0?(B=Math.pow(10,-m)/T,i=Math.round(e*B),z=Math.round(r*B),i/B<e&&++i,z/B>r&&--z,B=-B):(B=Math.pow(10,m)*T,i=Math.round(e/B),z=Math.round(r/B),i*B<e&&++i,z*B>r&&--z),z<i&&.5<=a&&a<2?sw(e,r,a*2):[i,z,B]}function NC(e,r,a){if(r=+r,e=+e,a=+a,!(a>0))return[];if(e===r)return[e];const l=r<e,[m,y,T]=l?sw(r,e,a):sw(e,r,a);if(!(y>=m))return[];const i=y-m+1,z=new Array(i);if(l)if(T<0)for(let B=0;B<i;++B)z[B]=(y-B)/-T;else for(let B=0;B<i;++B)z[B]=(y-B)*T;else if(T<0)for(let B=0;B<i;++B)z[B]=(m+B)/-T;else for(let B=0;B<i;++B)z[B]=(m+B)*T;return z}function jC(e,r,a){return r=+r,e=+e,a=+a,sw(e,r,a)[2]}function UC(e,r,a){r=+r,e=+e,a=+a;const l=r<e,m=l?jC(r,e,a):jC(e,r,a);return(l?-1:1)*(m<0?1/-m:m)}function W4(e,r){let a;for(const l of e)l!=null&&(a<l||a===void 0&&l>=l)&&(a=l);return a}function Z4(e,r){let a;for(const l of e)l!=null&&(a>l||a===void 0&&l>=l)&&(a=l);return a}function l6(e,r,a=0,l=1/0,m){if(r=Math.floor(r),a=Math.floor(Math.max(0,a)),l=Math.floor(Math.min(e.length-1,l)),!(a<=r&&r<=l))return e;for(m=m===void 0?s6:goe(m);l>a;){if(l-a>600){const z=l-a+1,B=r-a+1,F=Math.log(z),G=.5*Math.exp(2*F/3),Q=.5*Math.sqrt(F*G*(z-G)/z)*(B-z/2<0?-1:1),te=Math.max(a,Math.floor(r-B*G/z+Q)),ne=Math.min(l,Math.floor(r+(z-B)*G/z+Q));l6(e,r,te,ne,m)}const y=e[r];let T=a,i=l;for(bv(e,a,r),m(e[l],y)>0&&bv(e,a,l);T<i;){for(bv(e,T,i),++T,--i;m(e[T],y)<0;)++T;for(;m(e[i],y)>0;)--i}m(e[a],y)===0?bv(e,a,i):(++i,bv(e,i,l)),i<=r&&(a=i+1),r<=i&&(l=i-1)}return e}function bv(e,r,a){const l=e[r];e[r]=e[a],e[a]=l}function xoe(e,r,a){if(e=Float64Array.from(foe(e)),!(!(l=e.length)||isNaN(r=+r))){if(r<=0||l<2)return Z4(e);if(r>=1)return W4(e);var l,m=(l-1)*r,y=Math.floor(m),T=W4(l6(e,y).subarray(0,y+1)),i=Z4(e.subarray(y+1));return T+(i-T)*(m-y)}}function boe(e,r,a=a6){if(!(!(l=e.length)||isNaN(r=+r))){if(r<=0||l<2)return+a(e[0],0,e);if(r>=1)return+a(e[l-1],l-1,e);var l,m=(l-1)*r,y=Math.floor(m),T=+a(e[y],y,e),i=+a(e[y+1],y+1,e);return T+(i-T)*(m-y)}}function woe(e,r,a){e=+e,r=+r,a=(m=arguments.length)<2?(r=e,e=0,1):m<3?1:+a;for(var l=-1,m=Math.max(0,Math.ceil((r-e)/a))|0,y=new Array(m);++l<m;)y[l]=e+l*a;return y}function ud(e,r){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(r).domain(e);break}return this}function nA(e,r){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof r=="function"?this.interpolator(r):this.range(r);break}}return this}const VC=Symbol("implicit");function gM(){var e=new H4,r=[],a=[],l=VC;function m(y){let T=e.get(y);if(T===void 0){if(l!==VC)return l;e.set(y,T=r.push(y)-1)}return a[T%a.length]}return m.domain=function(y){if(!arguments.length)return r.slice();r=[],e=new H4;for(const T of y)e.has(T)||e.set(T,r.push(T)-1);return m},m.range=function(y){return arguments.length?(a=Array.from(y),m):a.slice()},m.unknown=function(y){return arguments.length?(l=y,m):l},m.copy=function(){return gM(r,a).unknown(l)},ud.apply(m,arguments),m}function _M(){var e=gM().unknown(void 0),r=e.domain,a=e.range,l=0,m=1,y,T,i=!1,z=0,B=0,F=.5;delete e.unknown;function G(){var Q=r().length,te=m<l,ne=te?m:l,oe=te?l:m;y=(oe-ne)/Math.max(1,Q-z+B*2),i&&(y=Math.floor(y)),ne+=(oe-ne-y*(Q-z))*F,T=y*(1-z),i&&(ne=Math.round(ne),T=Math.round(T));var ue=woe(Q).map(function(ye){return ne+y*ye});return a(te?ue.reverse():ue)}return e.domain=function(Q){return arguments.length?(r(Q),G()):r()},e.range=function(Q){return arguments.length?([l,m]=Q,l=+l,m=+m,G()):[l,m]},e.rangeRound=function(Q){return[l,m]=Q,l=+l,m=+m,i=!0,G()},e.bandwidth=function(){return T},e.step=function(){return y},e.round=function(Q){return arguments.length?(i=!!Q,G()):i},e.padding=function(Q){return arguments.length?(z=Math.min(1,B=+Q),G()):z},e.paddingInner=function(Q){return arguments.length?(z=Math.min(1,Q),G()):z},e.paddingOuter=function(Q){return arguments.length?(B=+Q,G()):B},e.align=function(Q){return arguments.length?(F=Math.max(0,Math.min(1,Q)),G()):F},e.copy=function(){return _M(r(),[l,m]).round(i).paddingInner(z).paddingOuter(B).align(F)},ud.apply(G(),arguments)}function c6(e){var r=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return c6(r())},e}function Soe(){return c6(_M.apply(null,arguments).paddingInner(1))}function yM(e,r,a){e.prototype=r.prototype=a,a.constructor=e}function u6(e,r){var a=Object.create(e.prototype);for(var l in r)a[l]=r[l];return a}function Ix(){}var Kv=.7,lw=1/Kv,L_="\\s*([+-]?\\d+)\\s*",Jv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Gp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Toe=/^#([0-9a-f]{3,8})$/,Eoe=new RegExp(`^rgb\\(${L_},${L_},${L_}\\)$`),Coe=new RegExp(`^rgb\\(${Gp},${Gp},${Gp}\\)$`),Moe=new RegExp(`^rgba\\(${L_},${L_},${L_},${Jv}\\)$`),Ioe=new RegExp(`^rgba\\(${Gp},${Gp},${Gp},${Jv}\\)$`),Poe=new RegExp(`^hsl\\(${Jv},${Gp},${Gp}\\)$`),Roe=new RegExp(`^hsla\\(${Jv},${Gp},${Gp},${Jv}\\)$`),X4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yM(Ix,ex,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Y4,formatHex:Y4,formatHex8:Doe,formatHsl:Ooe,formatRgb:Q4,toString:Q4});function Y4(){return this.rgb().formatHex()}function Doe(){return this.rgb().formatHex8()}function Ooe(){return h6(this).formatHsl()}function Q4(){return this.rgb().formatRgb()}function ex(e){var r,a;return e=(e+"").trim().toLowerCase(),(r=Toe.exec(e))?(a=r[1].length,r=parseInt(r[1],16),a===6?K4(r):a===3?new Ih(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):a===8?Ab(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):a===4?Ab(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=Eoe.exec(e))?new Ih(r[1],r[2],r[3],1):(r=Coe.exec(e))?new Ih(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=Moe.exec(e))?Ab(r[1],r[2],r[3],r[4]):(r=Ioe.exec(e))?Ab(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=Poe.exec(e))?tz(r[1],r[2]/100,r[3]/100,1):(r=Roe.exec(e))?tz(r[1],r[2]/100,r[3]/100,r[4]):X4.hasOwnProperty(e)?K4(X4[e]):e==="transparent"?new Ih(NaN,NaN,NaN,0):null}function K4(e){return new Ih(e>>16&255,e>>8&255,e&255,1)}function Ab(e,r,a,l){return l<=0&&(e=r=a=NaN),new Ih(e,r,a,l)}function koe(e){return e instanceof Ix||(e=ex(e)),e?(e=e.rgb(),new Ih(e.r,e.g,e.b,e.opacity)):new Ih}function $C(e,r,a,l){return arguments.length===1?koe(e):new Ih(e,r,a,l??1)}function Ih(e,r,a,l){this.r=+e,this.g=+r,this.b=+a,this.opacity=+l}yM(Ih,$C,u6(Ix,{brighter(e){return e=e==null?lw:Math.pow(lw,e),new Ih(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Kv:Math.pow(Kv,e),new Ih(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ih(pg(this.r),pg(this.g),pg(this.b),cw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:J4,formatHex:J4,formatHex8:zoe,formatRgb:ez,toString:ez}));function J4(){return`#${lg(this.r)}${lg(this.g)}${lg(this.b)}`}function zoe(){return`#${lg(this.r)}${lg(this.g)}${lg(this.b)}${lg((isNaN(this.opacity)?1:this.opacity)*255)}`}function ez(){const e=cw(this.opacity);return`${e===1?"rgb(":"rgba("}${pg(this.r)}, ${pg(this.g)}, ${pg(this.b)}${e===1?")":`, ${e})`}`}function cw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pg(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function lg(e){return e=pg(e),(e<16?"0":"")+e.toString(16)}function tz(e,r,a,l){return l<=0?e=r=a=NaN:a<=0||a>=1?e=r=NaN:r<=0&&(e=NaN),new Hd(e,r,a,l)}function h6(e){if(e instanceof Hd)return new Hd(e.h,e.s,e.l,e.opacity);if(e instanceof Ix||(e=ex(e)),!e)return new Hd;if(e instanceof Hd)return e;e=e.rgb();var r=e.r/255,a=e.g/255,l=e.b/255,m=Math.min(r,a,l),y=Math.max(r,a,l),T=NaN,i=y-m,z=(y+m)/2;return i?(r===y?T=(a-l)/i+(a<l)*6:a===y?T=(l-r)/i+2:T=(r-a)/i+4,i/=z<.5?y+m:2-y-m,T*=60):i=z>0&&z<1?0:T,new Hd(T,i,z,e.opacity)}function Loe(e,r,a,l){return arguments.length===1?h6(e):new Hd(e,r,a,l??1)}function Hd(e,r,a,l){this.h=+e,this.s=+r,this.l=+a,this.opacity=+l}yM(Hd,Loe,u6(Ix,{brighter(e){return e=e==null?lw:Math.pow(lw,e),new Hd(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Kv:Math.pow(Kv,e),new Hd(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,r=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,l=a+(a<.5?a:1-a)*r,m=2*a-l;return new Ih(AE(e>=240?e-240:e+120,m,l),AE(e,m,l),AE(e<120?e+240:e-120,m,l),this.opacity)},clamp(){return new Hd(rz(this.h),gb(this.s),gb(this.l),cw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=cw(this.opacity);return`${e===1?"hsl(":"hsla("}${rz(this.h)}, ${gb(this.s)*100}%, ${gb(this.l)*100}%${e===1?")":`, ${e})`}`}}));function rz(e){return e=(e||0)%360,e<0?e+360:e}function gb(e){return Math.max(0,Math.min(1,e||0))}function AE(e,r,a){return(e<60?r+(a-r)*e/60:e<180?a:e<240?r+(a-r)*(240-e)/60:r)*255}const vM=e=>()=>e;function Boe(e,r){return function(a){return e+a*r}}function Foe(e,r,a){return e=Math.pow(e,a),r=Math.pow(r,a)-e,a=1/a,function(l){return Math.pow(e+l*r,a)}}function Noe(e){return(e=+e)==1?f6:function(r,a){return a-r?Foe(r,a,e):vM(isNaN(r)?a:r)}}function f6(e,r){var a=r-e;return a?Boe(e,a):vM(isNaN(e)?r:e)}const nz=(function e(r){var a=Noe(r);function l(m,y){var T=a((m=$C(m)).r,(y=$C(y)).r),i=a(m.g,y.g),z=a(m.b,y.b),B=f6(m.opacity,y.opacity);return function(F){return m.r=T(F),m.g=i(F),m.b=z(F),m.opacity=B(F),m+""}}return l.gamma=e,l})(1);function joe(e,r){r||(r=[]);var a=e?Math.min(r.length,e.length):0,l=r.slice(),m;return function(y){for(m=0;m<a;++m)l[m]=e[m]*(1-y)+r[m]*y;return l}}function Uoe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Voe(e,r){var a=r?r.length:0,l=e?Math.min(a,e.length):0,m=new Array(l),y=new Array(a),T;for(T=0;T<l;++T)m[T]=cy(e[T],r[T]);for(;T<a;++T)y[T]=r[T];return function(i){for(T=0;T<l;++T)y[T]=m[T](i);return y}}function $oe(e,r){var a=new Date;return e=+e,r=+r,function(l){return a.setTime(e*(1-l)+r*l),a}}function uw(e,r){return e=+e,r=+r,function(a){return e*(1-a)+r*a}}function Goe(e,r){var a={},l={},m;(e===null||typeof e!="object")&&(e={}),(r===null||typeof r!="object")&&(r={});for(m in r)m in e?a[m]=cy(e[m],r[m]):l[m]=r[m];return function(y){for(m in a)l[m]=a[m](y);return l}}var GC=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gE=new RegExp(GC.source,"g");function Hoe(e){return function(){return e}}function qoe(e){return function(r){return e(r)+""}}function Woe(e,r){var a=GC.lastIndex=gE.lastIndex=0,l,m,y,T=-1,i=[],z=[];for(e=e+"",r=r+"";(l=GC.exec(e))&&(m=gE.exec(r));)(y=m.index)>a&&(y=r.slice(a,y),i[T]?i[T]+=y:i[++T]=y),(l=l[0])===(m=m[0])?i[T]?i[T]+=m:i[++T]=m:(i[++T]=null,z.push({i:T,x:uw(l,m)})),a=gE.lastIndex;return a<r.length&&(y=r.slice(a),i[T]?i[T]+=y:i[++T]=y),i.length<2?z[0]?qoe(z[0].x):Hoe(r):(r=z.length,function(B){for(var F=0,G;F<r;++F)i[(G=z[F]).i]=G.x(B);return i.join("")})}function cy(e,r){var a=typeof r,l;return r==null||a==="boolean"?vM(r):(a==="number"?uw:a==="string"?(l=ex(r))?(r=l,nz):Woe:r instanceof ex?nz:r instanceof Date?$oe:Uoe(r)?joe:Array.isArray(r)?Voe:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?Goe:uw)(e,r)}function xM(e,r){return e=+e,r=+r,function(a){return Math.round(e*(1-a)+r*a)}}function Zoe(e,r){r===void 0&&(r=e,e=cy);for(var a=0,l=r.length-1,m=r[0],y=new Array(l<0?0:l);a<l;)y[a]=e(m,m=r[++a]);return function(T){var i=Math.max(0,Math.min(l-1,Math.floor(T*=l)));return y[i](T-i)}}function Xoe(e){return function(){return e}}function hw(e){return+e}var iz=[0,1];function Gu(e){return e}function HC(e,r){return(r-=e=+e)?function(a){return(a-e)/r}:Xoe(isNaN(r)?NaN:.5)}function Yoe(e,r){var a;return e>r&&(a=e,e=r,r=a),function(l){return Math.max(e,Math.min(r,l))}}function Qoe(e,r,a){var l=e[0],m=e[1],y=r[0],T=r[1];return m<l?(l=HC(m,l),y=a(T,y)):(l=HC(l,m),y=a(y,T)),function(i){return y(l(i))}}function Koe(e,r,a){var l=Math.min(e.length,r.length)-1,m=new Array(l),y=new Array(l),T=-1;for(e[l]<e[0]&&(e=e.slice().reverse(),r=r.slice().reverse());++T<l;)m[T]=HC(e[T],e[T+1]),y[T]=a(r[T],r[T+1]);return function(i){var z=Mx(e,i,1,l)-1;return y[z](m[z](i))}}function Px(e,r){return r.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function v2(){var e=iz,r=iz,a=cy,l,m,y,T=Gu,i,z,B;function F(){var Q=Math.min(e.length,r.length);return T!==Gu&&(T=Yoe(e[0],e[Q-1])),i=Q>2?Koe:Qoe,z=B=null,G}function G(Q){return Q==null||isNaN(Q=+Q)?y:(z||(z=i(e.map(l),r,a)))(l(T(Q)))}return G.invert=function(Q){return T(m((B||(B=i(r,e.map(l),uw)))(Q)))},G.domain=function(Q){return arguments.length?(e=Array.from(Q,hw),F()):e.slice()},G.range=function(Q){return arguments.length?(r=Array.from(Q),F()):r.slice()},G.rangeRound=function(Q){return r=Array.from(Q),a=xM,F()},G.clamp=function(Q){return arguments.length?(T=Q?!0:Gu,F()):T!==Gu},G.interpolate=function(Q){return arguments.length?(a=Q,F()):a},G.unknown=function(Q){return arguments.length?(y=Q,G):y},function(Q,te){return l=Q,m=te,F()}}function bM(){return v2()(Gu,Gu)}function Joe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function fw(e,r){if((a=(e=r?e.toExponential(r-1):e.toExponential()).indexOf("e"))<0)return null;var a,l=e.slice(0,a);return[l.length>1?l[0]+l.slice(2):l,+e.slice(a+1)]}function H_(e){return e=fw(Math.abs(e)),e?e[1]:NaN}function eae(e,r){return function(a,l){for(var m=a.length,y=[],T=0,i=e[0],z=0;m>0&&i>0&&(z+i+1>l&&(i=Math.max(1,l-z)),y.push(a.substring(m-=i,m+i)),!((z+=i+1)>l));)i=e[T=(T+1)%e.length];return y.reverse().join(r)}}function tae(e){return function(r){return r.replace(/[0-9]/g,function(a){return e[+a]})}}var rae=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function tx(e){if(!(r=rae.exec(e)))throw new Error("invalid format: "+e);var r;return new wM({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}tx.prototype=wM.prototype;function wM(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}wM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function nae(e){e:for(var r=e.length,a=1,l=-1,m;a<r;++a)switch(e[a]){case".":l=m=a;break;case"0":l===0&&(l=a),m=a;break;default:if(!+e[a])break e;l>0&&(l=0);break}return l>0?e.slice(0,l)+e.slice(m+1):e}var d6;function iae(e,r){var a=fw(e,r);if(!a)return e+"";var l=a[0],m=a[1],y=m-(d6=Math.max(-8,Math.min(8,Math.floor(m/3)))*3)+1,T=l.length;return y===T?l:y>T?l+new Array(y-T+1).join("0"):y>0?l.slice(0,y)+"."+l.slice(y):"0."+new Array(1-y).join("0")+fw(e,Math.max(0,r+y-1))[0]}function oz(e,r){var a=fw(e,r);if(!a)return e+"";var l=a[0],m=a[1];return m<0?"0."+new Array(-m).join("0")+l:l.length>m+1?l.slice(0,m+1)+"."+l.slice(m+1):l+new Array(m-l.length+2).join("0")}const az={"%":(e,r)=>(e*100).toFixed(r),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Joe,e:(e,r)=>e.toExponential(r),f:(e,r)=>e.toFixed(r),g:(e,r)=>e.toPrecision(r),o:e=>Math.round(e).toString(8),p:(e,r)=>oz(e*100,r),r:oz,s:iae,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function sz(e){return e}var lz=Array.prototype.map,cz=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function oae(e){var r=e.grouping===void 0||e.thousands===void 0?sz:eae(lz.call(e.grouping,Number),e.thousands+""),a=e.currency===void 0?"":e.currency[0]+"",l=e.currency===void 0?"":e.currency[1]+"",m=e.decimal===void 0?".":e.decimal+"",y=e.numerals===void 0?sz:tae(lz.call(e.numerals,String)),T=e.percent===void 0?"%":e.percent+"",i=e.minus===void 0?"":e.minus+"",z=e.nan===void 0?"NaN":e.nan+"";function B(G){G=tx(G);var Q=G.fill,te=G.align,ne=G.sign,oe=G.symbol,ue=G.zero,ye=G.width,we=G.comma,ve=G.precision,Ce=G.trim,Ee=G.type;Ee==="n"?(we=!0,Ee="g"):az[Ee]||(ve===void 0&&(ve=12),Ce=!0,Ee="g"),(ue||Q==="0"&&te==="=")&&(ue=!0,Q="0",te="=");var Be=oe==="$"?a:oe==="#"&&/[boxX]/.test(Ee)?"0"+Ee.toLowerCase():"",Ke=oe==="$"?l:/[%p]/.test(Ee)?T:"",st=az[Ee],dt=/[defgprs%]/.test(Ee);ve=ve===void 0?6:/[gprs]/.test(Ee)?Math.max(1,Math.min(21,ve)):Math.max(0,Math.min(20,ve));function bt(ht){var Re=Be,Pt=Ke,wt,Et,et;if(Ee==="c")Pt=st(ht)+Pt,ht="";else{ht=+ht;var Zt=ht<0||1/ht<0;if(ht=isNaN(ht)?z:st(Math.abs(ht),ve),Ce&&(ht=nae(ht)),Zt&&+ht==0&&ne!=="+"&&(Zt=!1),Re=(Zt?ne==="("?ne:i:ne==="-"||ne==="("?"":ne)+Re,Pt=(Ee==="s"?cz[8+d6/3]:"")+Pt+(Zt&&ne==="("?")":""),dt){for(wt=-1,Et=ht.length;++wt<Et;)if(et=ht.charCodeAt(wt),48>et||et>57){Pt=(et===46?m+ht.slice(wt+1):ht.slice(wt))+Pt,ht=ht.slice(0,wt);break}}}we&&!ue&&(ht=r(ht,1/0));var ir=Re.length+ht.length+Pt.length,or=ir<ye?new Array(ye-ir+1).join(Q):"";switch(we&&ue&&(ht=r(or+ht,or.length?ye-Pt.length:1/0),or=""),te){case"<":ht=Re+ht+Pt+or;break;case"=":ht=Re+or+ht+Pt;break;case"^":ht=or.slice(0,ir=or.length>>1)+Re+ht+Pt+or.slice(ir);break;default:ht=or+Re+ht+Pt;break}return y(ht)}return bt.toString=function(){return G+""},bt}function F(G,Q){var te=B((G=tx(G),G.type="f",G)),ne=Math.max(-8,Math.min(8,Math.floor(H_(Q)/3)))*3,oe=Math.pow(10,-ne),ue=cz[8+ne/3];return function(ye){return te(oe*ye)+ue}}return{format:B,formatPrefix:F}}var _b,SM,p6;aae({thousands:",",grouping:[3],currency:["$",""]});function aae(e){return _b=oae(e),SM=_b.format,p6=_b.formatPrefix,_b}function sae(e){return Math.max(0,-H_(Math.abs(e)))}function lae(e,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(H_(r)/3)))*3-H_(Math.abs(e)))}function cae(e,r){return e=Math.abs(e),r=Math.abs(r)-e,Math.max(0,H_(r)-H_(e))+1}function m6(e,r,a,l){var m=UC(e,r,a),y;switch(l=tx(l??",f"),l.type){case"s":{var T=Math.max(Math.abs(e),Math.abs(r));return l.precision==null&&!isNaN(y=lae(m,T))&&(l.precision=y),p6(l,T)}case"":case"e":case"g":case"p":case"r":{l.precision==null&&!isNaN(y=cae(m,Math.max(Math.abs(e),Math.abs(r))))&&(l.precision=y-(l.type==="e"));break}case"f":case"%":{l.precision==null&&!isNaN(y=sae(m))&&(l.precision=y-(l.type==="%")*2);break}}return SM(l)}function h0(e){var r=e.domain;return e.ticks=function(a){var l=r();return NC(l[0],l[l.length-1],a??10)},e.tickFormat=function(a,l){var m=r();return m6(m[0],m[m.length-1],a??10,l)},e.nice=function(a){a==null&&(a=10);var l=r(),m=0,y=l.length-1,T=l[m],i=l[y],z,B,F=10;for(i<T&&(B=T,T=i,i=B,B=m,m=y,y=B);F-- >0;){if(B=jC(T,i,a),B===z)return l[m]=T,l[y]=i,r(l);if(B>0)T=Math.floor(T/B)*B,i=Math.ceil(i/B)*B;else if(B<0)T=Math.ceil(T*B)/B,i=Math.floor(i*B)/B;else break;z=B}return e},e}function A6(){var e=bM();return e.copy=function(){return Px(e,A6())},ud.apply(e,arguments),h0(e)}function g6(e){var r;function a(l){return l==null||isNaN(l=+l)?r:l}return a.invert=a,a.domain=a.range=function(l){return arguments.length?(e=Array.from(l,hw),a):e.slice()},a.unknown=function(l){return arguments.length?(r=l,a):r},a.copy=function(){return g6(e).unknown(r)},e=arguments.length?Array.from(e,hw):[0,1],h0(a)}function _6(e,r){e=e.slice();var a=0,l=e.length-1,m=e[a],y=e[l],T;return y<m&&(T=a,a=l,l=T,T=m,m=y,y=T),e[a]=r.floor(m),e[l]=r.ceil(y),e}function uz(e){return Math.log(e)}function hz(e){return Math.exp(e)}function uae(e){return-Math.log(-e)}function hae(e){return-Math.exp(-e)}function fae(e){return isFinite(e)?+("1e"+e):e<0?0:e}function dae(e){return e===10?fae:e===Math.E?Math.exp:r=>Math.pow(e,r)}function pae(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),r=>Math.log(r)/e)}function fz(e){return(r,a)=>-e(-r,a)}function TM(e){const r=e(uz,hz),a=r.domain;let l=10,m,y;function T(){return m=pae(l),y=dae(l),a()[0]<0?(m=fz(m),y=fz(y),e(uae,hae)):e(uz,hz),r}return r.base=function(i){return arguments.length?(l=+i,T()):l},r.domain=function(i){return arguments.length?(a(i),T()):a()},r.ticks=i=>{const z=a();let B=z[0],F=z[z.length-1];const G=F<B;G&&([B,F]=[F,B]);let Q=m(B),te=m(F),ne,oe;const ue=i==null?10:+i;let ye=[];if(!(l%1)&&te-Q<ue){if(Q=Math.floor(Q),te=Math.ceil(te),B>0){for(;Q<=te;++Q)for(ne=1;ne<l;++ne)if(oe=Q<0?ne/y(-Q):ne*y(Q),!(oe<B)){if(oe>F)break;ye.push(oe)}}else for(;Q<=te;++Q)for(ne=l-1;ne>=1;--ne)if(oe=Q>0?ne/y(-Q):ne*y(Q),!(oe<B)){if(oe>F)break;ye.push(oe)}ye.length*2<ue&&(ye=NC(B,F,ue))}else ye=NC(Q,te,Math.min(te-Q,ue)).map(y);return G?ye.reverse():ye},r.tickFormat=(i,z)=>{if(i==null&&(i=10),z==null&&(z=l===10?"s":","),typeof z!="function"&&(!(l%1)&&(z=tx(z)).precision==null&&(z.trim=!0),z=SM(z)),i===1/0)return z;const B=Math.max(1,l*i/r.ticks().length);return F=>{let G=F/y(Math.round(m(F)));return G*l<l-.5&&(G*=l),G<=B?z(F):""}},r.nice=()=>a(_6(a(),{floor:i=>y(Math.floor(m(i))),ceil:i=>y(Math.ceil(m(i)))})),r}function y6(){const e=TM(v2()).domain([1,10]);return e.copy=()=>Px(e,y6()).base(e.base()),ud.apply(e,arguments),e}function dz(e){return function(r){return Math.sign(r)*Math.log1p(Math.abs(r/e))}}function pz(e){return function(r){return Math.sign(r)*Math.expm1(Math.abs(r))*e}}function EM(e){var r=1,a=e(dz(r),pz(r));return a.constant=function(l){return arguments.length?e(dz(r=+l),pz(r)):r},h0(a)}function v6(){var e=EM(v2());return e.copy=function(){return Px(e,v6()).constant(e.constant())},ud.apply(e,arguments)}function mz(e){return function(r){return r<0?-Math.pow(-r,e):Math.pow(r,e)}}function mae(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Aae(e){return e<0?-e*e:e*e}function CM(e){var r=e(Gu,Gu),a=1;function l(){return a===1?e(Gu,Gu):a===.5?e(mae,Aae):e(mz(a),mz(1/a))}return r.exponent=function(m){return arguments.length?(a=+m,l()):a},h0(r)}function MM(){var e=CM(v2());return e.copy=function(){return Px(e,MM()).exponent(e.exponent())},ud.apply(e,arguments),e}function gae(){return MM.apply(null,arguments).exponent(.5)}function Az(e){return Math.sign(e)*e*e}function _ae(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function x6(){var e=bM(),r=[0,1],a=!1,l;function m(y){var T=_ae(e(y));return isNaN(T)?l:a?Math.round(T):T}return m.invert=function(y){return e.invert(Az(y))},m.domain=function(y){return arguments.length?(e.domain(y),m):e.domain()},m.range=function(y){return arguments.length?(e.range((r=Array.from(y,hw)).map(Az)),m):r.slice()},m.rangeRound=function(y){return m.range(y).round(!0)},m.round=function(y){return arguments.length?(a=!!y,m):a},m.clamp=function(y){return arguments.length?(e.clamp(y),m):e.clamp()},m.unknown=function(y){return arguments.length?(l=y,m):l},m.copy=function(){return x6(e.domain(),r).round(a).clamp(e.clamp()).unknown(l)},ud.apply(m,arguments),h0(m)}function b6(){var e=[],r=[],a=[],l;function m(){var T=0,i=Math.max(1,r.length);for(a=new Array(i-1);++T<i;)a[T-1]=boe(e,T/i);return y}function y(T){return T==null||isNaN(T=+T)?l:r[Mx(a,T)]}return y.invertExtent=function(T){var i=r.indexOf(T);return i<0?[NaN,NaN]:[i>0?a[i-1]:e[0],i<a.length?a[i]:e[e.length-1]]},y.domain=function(T){if(!arguments.length)return e.slice();e=[];for(let i of T)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(n0),m()},y.range=function(T){return arguments.length?(r=Array.from(T),m()):r.slice()},y.unknown=function(T){return arguments.length?(l=T,y):l},y.quantiles=function(){return a.slice()},y.copy=function(){return b6().domain(e).range(r).unknown(l)},ud.apply(y,arguments)}function w6(){var e=0,r=1,a=1,l=[.5],m=[0,1],y;function T(z){return z!=null&&z<=z?m[Mx(l,z,0,a)]:y}function i(){var z=-1;for(l=new Array(a);++z<a;)l[z]=((z+1)*r-(z-a)*e)/(a+1);return T}return T.domain=function(z){return arguments.length?([e,r]=z,e=+e,r=+r,i()):[e,r]},T.range=function(z){return arguments.length?(a=(m=Array.from(z)).length-1,i()):m.slice()},T.invertExtent=function(z){var B=m.indexOf(z);return B<0?[NaN,NaN]:B<1?[e,l[0]]:B>=a?[l[a-1],r]:[l[B-1],l[B]]},T.unknown=function(z){return arguments.length&&(y=z),T},T.thresholds=function(){return l.slice()},T.copy=function(){return w6().domain([e,r]).range(m).unknown(y)},ud.apply(h0(T),arguments)}function S6(){var e=[.5],r=[0,1],a,l=1;function m(y){return y!=null&&y<=y?r[Mx(e,y,0,l)]:a}return m.domain=function(y){return arguments.length?(e=Array.from(y),l=Math.min(e.length,r.length-1),m):e.slice()},m.range=function(y){return arguments.length?(r=Array.from(y),l=Math.min(e.length,r.length-1),m):r.slice()},m.invertExtent=function(y){var T=r.indexOf(y);return[e[T-1],e[T]]},m.unknown=function(y){return arguments.length?(a=y,m):a},m.copy=function(){return S6().domain(e).range(r).unknown(a)},ud.apply(m,arguments)}const _E=new Date,yE=new Date;function Nl(e,r,a,l){function m(y){return e(y=arguments.length===0?new Date:new Date(+y)),y}return m.floor=y=>(e(y=new Date(+y)),y),m.ceil=y=>(e(y=new Date(y-1)),r(y,1),e(y),y),m.round=y=>{const T=m(y),i=m.ceil(y);return y-T<i-y?T:i},m.offset=(y,T)=>(r(y=new Date(+y),T==null?1:Math.floor(T)),y),m.range=(y,T,i)=>{const z=[];if(y=m.ceil(y),i=i==null?1:Math.floor(i),!(y<T)||!(i>0))return z;let B;do z.push(B=new Date(+y)),r(y,i),e(y);while(B<y&&y<T);return z},m.filter=y=>Nl(T=>{if(T>=T)for(;e(T),!y(T);)T.setTime(T-1)},(T,i)=>{if(T>=T)if(i<0)for(;++i<=0;)for(;r(T,-1),!y(T););else for(;--i>=0;)for(;r(T,1),!y(T););}),a&&(m.count=(y,T)=>(_E.setTime(+y),yE.setTime(+T),e(_E),e(yE),Math.floor(a(_E,yE))),m.every=y=>(y=Math.floor(y),!isFinite(y)||!(y>0)?null:y>1?m.filter(l?T=>l(T)%y===0:T=>m.count(0,T)%y===0):m)),m}const dw=Nl(()=>{},(e,r)=>{e.setTime(+e+r)},(e,r)=>r-e);dw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Nl(r=>{r.setTime(Math.floor(r/e)*e)},(r,a)=>{r.setTime(+r+a*e)},(r,a)=>(a-r)/e):dw);dw.range;const Lm=1e3,od=Lm*60,Bm=od*60,Ym=Bm*24,IM=Ym*7,gz=Ym*30,vE=Ym*365,cg=Nl(e=>{e.setTime(e-e.getMilliseconds())},(e,r)=>{e.setTime(+e+r*Lm)},(e,r)=>(r-e)/Lm,e=>e.getUTCSeconds());cg.range;const PM=Nl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lm)},(e,r)=>{e.setTime(+e+r*od)},(e,r)=>(r-e)/od,e=>e.getMinutes());PM.range;const RM=Nl(e=>{e.setUTCSeconds(0,0)},(e,r)=>{e.setTime(+e+r*od)},(e,r)=>(r-e)/od,e=>e.getUTCMinutes());RM.range;const DM=Nl(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Lm-e.getMinutes()*od)},(e,r)=>{e.setTime(+e+r*Bm)},(e,r)=>(r-e)/Bm,e=>e.getHours());DM.range;const OM=Nl(e=>{e.setUTCMinutes(0,0,0)},(e,r)=>{e.setTime(+e+r*Bm)},(e,r)=>(r-e)/Bm,e=>e.getUTCHours());OM.range;const Rx=Nl(e=>e.setHours(0,0,0,0),(e,r)=>e.setDate(e.getDate()+r),(e,r)=>(r-e-(r.getTimezoneOffset()-e.getTimezoneOffset())*od)/Ym,e=>e.getDate()-1);Rx.range;const x2=Nl(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/Ym,e=>e.getUTCDate()-1);x2.range;const T6=Nl(e=>{e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCDate(e.getUTCDate()+r)},(e,r)=>(r-e)/Ym,e=>Math.floor(e/Ym));T6.range;function Sg(e){return Nl(r=>{r.setDate(r.getDate()-(r.getDay()+7-e)%7),r.setHours(0,0,0,0)},(r,a)=>{r.setDate(r.getDate()+a*7)},(r,a)=>(a-r-(a.getTimezoneOffset()-r.getTimezoneOffset())*od)/IM)}const b2=Sg(0),pw=Sg(1),yae=Sg(2),vae=Sg(3),q_=Sg(4),xae=Sg(5),bae=Sg(6);b2.range;pw.range;yae.range;vae.range;q_.range;xae.range;bae.range;function Tg(e){return Nl(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-e)%7),r.setUTCHours(0,0,0,0)},(r,a)=>{r.setUTCDate(r.getUTCDate()+a*7)},(r,a)=>(a-r)/IM)}const w2=Tg(0),mw=Tg(1),wae=Tg(2),Sae=Tg(3),W_=Tg(4),Tae=Tg(5),Eae=Tg(6);w2.range;mw.range;wae.range;Sae.range;W_.range;Tae.range;Eae.range;const kM=Nl(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,r)=>{e.setMonth(e.getMonth()+r)},(e,r)=>r.getMonth()-e.getMonth()+(r.getFullYear()-e.getFullYear())*12,e=>e.getMonth());kM.range;const zM=Nl(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCMonth(e.getUTCMonth()+r)},(e,r)=>r.getUTCMonth()-e.getUTCMonth()+(r.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());zM.range;const Qm=Nl(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,r)=>{e.setFullYear(e.getFullYear()+r)},(e,r)=>r.getFullYear()-e.getFullYear(),e=>e.getFullYear());Qm.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Nl(r=>{r.setFullYear(Math.floor(r.getFullYear()/e)*e),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,a)=>{r.setFullYear(r.getFullYear()+a*e)});Qm.range;const Km=Nl(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,r)=>{e.setUTCFullYear(e.getUTCFullYear()+r)},(e,r)=>r.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Km.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Nl(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/e)*e),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,a)=>{r.setUTCFullYear(r.getUTCFullYear()+a*e)});Km.range;function E6(e,r,a,l,m,y){const T=[[cg,1,Lm],[cg,5,5*Lm],[cg,15,15*Lm],[cg,30,30*Lm],[y,1,od],[y,5,5*od],[y,15,15*od],[y,30,30*od],[m,1,Bm],[m,3,3*Bm],[m,6,6*Bm],[m,12,12*Bm],[l,1,Ym],[l,2,2*Ym],[a,1,IM],[r,1,gz],[r,3,3*gz],[e,1,vE]];function i(B,F,G){const Q=F<B;Q&&([B,F]=[F,B]);const te=G&&typeof G.range=="function"?G:z(B,F,G),ne=te?te.range(B,+F+1):[];return Q?ne.reverse():ne}function z(B,F,G){const Q=Math.abs(F-B)/G,te=AM(([,,ue])=>ue).right(T,Q);if(te===T.length)return e.every(UC(B/vE,F/vE,G));if(te===0)return dw.every(Math.max(UC(B,F,G),1));const[ne,oe]=T[Q/T[te-1][2]<T[te][2]/Q?te-1:te];return ne.every(oe)}return[i,z]}const[Cae,Mae]=E6(Km,zM,w2,T6,OM,RM),[Iae,Pae]=E6(Qm,kM,b2,Rx,DM,PM);function xE(e){if(0<=e.y&&e.y<100){var r=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return r.setFullYear(e.y),r}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function bE(e){if(0<=e.y&&e.y<100){var r=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return r.setUTCFullYear(e.y),r}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function wv(e,r,a){return{y:e,m:r,d:a,H:0,M:0,S:0,L:0}}function Rae(e){var r=e.dateTime,a=e.date,l=e.time,m=e.periods,y=e.days,T=e.shortDays,i=e.months,z=e.shortMonths,B=Sv(m),F=Tv(m),G=Sv(y),Q=Tv(y),te=Sv(T),ne=Tv(T),oe=Sv(i),ue=Tv(i),ye=Sv(z),we=Tv(z),ve={a:Zt,A:ir,b:or,B:ft,c:null,d:wz,e:wz,f:ese,g:use,G:fse,H:Qae,I:Kae,j:Jae,L:C6,m:tse,M:rse,p:Vt,q:Jt,Q:Ez,s:Cz,S:nse,u:ise,U:ose,V:ase,w:sse,W:lse,x:null,X:null,y:cse,Y:hse,Z:dse,"%":Tz},Ce={a:Cr,A:ln,b:tn,B:Hr,c:null,d:Sz,e:Sz,f:gse,g:Cse,G:Ise,H:pse,I:mse,j:Ase,L:I6,m:_se,M:yse,p:Nn,q:jn,Q:Ez,s:Cz,S:vse,u:xse,U:bse,V:wse,w:Sse,W:Tse,x:null,X:null,y:Ese,Y:Mse,Z:Pse,"%":Tz},Ee={a:bt,A:ht,b:Re,B:Pt,c:wt,d:xz,e:xz,f:Wae,g:vz,G:yz,H:bz,I:bz,j:$ae,L:qae,m:Vae,M:Gae,p:dt,q:Uae,Q:Xae,s:Yae,S:Hae,u:Lae,U:Bae,V:Fae,w:zae,W:Nae,x:Et,X:et,y:vz,Y:yz,Z:jae,"%":Zae};ve.x=Be(a,ve),ve.X=Be(l,ve),ve.c=Be(r,ve),Ce.x=Be(a,Ce),Ce.X=Be(l,Ce),Ce.c=Be(r,Ce);function Be(Ur,Gr){return function(Sn){var Tr=[],Zi=-1,wn=0,Rn=Ur.length,mo,di,Ao;for(Sn instanceof Date||(Sn=new Date(+Sn));++Zi<Rn;)Ur.charCodeAt(Zi)===37&&(Tr.push(Ur.slice(wn,Zi)),(di=_z[mo=Ur.charAt(++Zi)])!=null?mo=Ur.charAt(++Zi):di=mo==="e"?" ":"0",(Ao=Gr[mo])&&(mo=Ao(Sn,di)),Tr.push(mo),wn=Zi+1);return Tr.push(Ur.slice(wn,Zi)),Tr.join("")}}function Ke(Ur,Gr){return function(Sn){var Tr=wv(1900,void 0,1),Zi=st(Tr,Ur,Sn+="",0),wn,Rn;if(Zi!=Sn.length)return null;if("Q"in Tr)return new Date(Tr.Q);if("s"in Tr)return new Date(Tr.s*1e3+("L"in Tr?Tr.L:0));if(Gr&&!("Z"in Tr)&&(Tr.Z=0),"p"in Tr&&(Tr.H=Tr.H%12+Tr.p*12),Tr.m===void 0&&(Tr.m="q"in Tr?Tr.q:0),"V"in Tr){if(Tr.V<1||Tr.V>53)return null;"w"in Tr||(Tr.w=1),"Z"in Tr?(wn=bE(wv(Tr.y,0,1)),Rn=wn.getUTCDay(),wn=Rn>4||Rn===0?mw.ceil(wn):mw(wn),wn=x2.offset(wn,(Tr.V-1)*7),Tr.y=wn.getUTCFullYear(),Tr.m=wn.getUTCMonth(),Tr.d=wn.getUTCDate()+(Tr.w+6)%7):(wn=xE(wv(Tr.y,0,1)),Rn=wn.getDay(),wn=Rn>4||Rn===0?pw.ceil(wn):pw(wn),wn=Rx.offset(wn,(Tr.V-1)*7),Tr.y=wn.getFullYear(),Tr.m=wn.getMonth(),Tr.d=wn.getDate()+(Tr.w+6)%7)}else("W"in Tr||"U"in Tr)&&("w"in Tr||(Tr.w="u"in Tr?Tr.u%7:"W"in Tr?1:0),Rn="Z"in Tr?bE(wv(Tr.y,0,1)).getUTCDay():xE(wv(Tr.y,0,1)).getDay(),Tr.m=0,Tr.d="W"in Tr?(Tr.w+6)%7+Tr.W*7-(Rn+5)%7:Tr.w+Tr.U*7-(Rn+6)%7);return"Z"in Tr?(Tr.H+=Tr.Z/100|0,Tr.M+=Tr.Z%100,bE(Tr)):xE(Tr)}}function st(Ur,Gr,Sn,Tr){for(var Zi=0,wn=Gr.length,Rn=Sn.length,mo,di;Zi<wn;){if(Tr>=Rn)return-1;if(mo=Gr.charCodeAt(Zi++),mo===37){if(mo=Gr.charAt(Zi++),di=Ee[mo in _z?Gr.charAt(Zi++):mo],!di||(Tr=di(Ur,Sn,Tr))<0)return-1}else if(mo!=Sn.charCodeAt(Tr++))return-1}return Tr}function dt(Ur,Gr,Sn){var Tr=B.exec(Gr.slice(Sn));return Tr?(Ur.p=F.get(Tr[0].toLowerCase()),Sn+Tr[0].length):-1}function bt(Ur,Gr,Sn){var Tr=te.exec(Gr.slice(Sn));return Tr?(Ur.w=ne.get(Tr[0].toLowerCase()),Sn+Tr[0].length):-1}function ht(Ur,Gr,Sn){var Tr=G.exec(Gr.slice(Sn));return Tr?(Ur.w=Q.get(Tr[0].toLowerCase()),Sn+Tr[0].length):-1}function Re(Ur,Gr,Sn){var Tr=ye.exec(Gr.slice(Sn));return Tr?(Ur.m=we.get(Tr[0].toLowerCase()),Sn+Tr[0].length):-1}function Pt(Ur,Gr,Sn){var Tr=oe.exec(Gr.slice(Sn));return Tr?(Ur.m=ue.get(Tr[0].toLowerCase()),Sn+Tr[0].length):-1}function wt(Ur,Gr,Sn){return st(Ur,r,Gr,Sn)}function Et(Ur,Gr,Sn){return st(Ur,a,Gr,Sn)}function et(Ur,Gr,Sn){return st(Ur,l,Gr,Sn)}function Zt(Ur){return T[Ur.getDay()]}function ir(Ur){return y[Ur.getDay()]}function or(Ur){return z[Ur.getMonth()]}function ft(Ur){return i[Ur.getMonth()]}function Vt(Ur){return m[+(Ur.getHours()>=12)]}function Jt(Ur){return 1+~~(Ur.getMonth()/3)}function Cr(Ur){return T[Ur.getUTCDay()]}function ln(Ur){return y[Ur.getUTCDay()]}function tn(Ur){return z[Ur.getUTCMonth()]}function Hr(Ur){return i[Ur.getUTCMonth()]}function Nn(Ur){return m[+(Ur.getUTCHours()>=12)]}function jn(Ur){return 1+~~(Ur.getUTCMonth()/3)}return{format:function(Ur){var Gr=Be(Ur+="",ve);return Gr.toString=function(){return Ur},Gr},parse:function(Ur){var Gr=Ke(Ur+="",!1);return Gr.toString=function(){return Ur},Gr},utcFormat:function(Ur){var Gr=Be(Ur+="",Ce);return Gr.toString=function(){return Ur},Gr},utcParse:function(Ur){var Gr=Ke(Ur+="",!0);return Gr.toString=function(){return Ur},Gr}}}var _z={"-":"",_:" ",0:"0"},nc=/^\s*\d+/,Dae=/^%/,Oae=/[\\^$*+?|[\]().{}]/g;function la(e,r,a){var l=e<0?"-":"",m=(l?-e:e)+"",y=m.length;return l+(y<a?new Array(a-y+1).join(r)+m:m)}function kae(e){return e.replace(Oae,"\\$&")}function Sv(e){return new RegExp("^(?:"+e.map(kae).join("|")+")","i")}function Tv(e){return new Map(e.map((r,a)=>[r.toLowerCase(),a]))}function zae(e,r,a){var l=nc.exec(r.slice(a,a+1));return l?(e.w=+l[0],a+l[0].length):-1}function Lae(e,r,a){var l=nc.exec(r.slice(a,a+1));return l?(e.u=+l[0],a+l[0].length):-1}function Bae(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.U=+l[0],a+l[0].length):-1}function Fae(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.V=+l[0],a+l[0].length):-1}function Nae(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.W=+l[0],a+l[0].length):-1}function yz(e,r,a){var l=nc.exec(r.slice(a,a+4));return l?(e.y=+l[0],a+l[0].length):-1}function vz(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.y=+l[0]+(+l[0]>68?1900:2e3),a+l[0].length):-1}function jae(e,r,a){var l=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(a,a+6));return l?(e.Z=l[1]?0:-(l[2]+(l[3]||"00")),a+l[0].length):-1}function Uae(e,r,a){var l=nc.exec(r.slice(a,a+1));return l?(e.q=l[0]*3-3,a+l[0].length):-1}function Vae(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.m=l[0]-1,a+l[0].length):-1}function xz(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.d=+l[0],a+l[0].length):-1}function $ae(e,r,a){var l=nc.exec(r.slice(a,a+3));return l?(e.m=0,e.d=+l[0],a+l[0].length):-1}function bz(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.H=+l[0],a+l[0].length):-1}function Gae(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.M=+l[0],a+l[0].length):-1}function Hae(e,r,a){var l=nc.exec(r.slice(a,a+2));return l?(e.S=+l[0],a+l[0].length):-1}function qae(e,r,a){var l=nc.exec(r.slice(a,a+3));return l?(e.L=+l[0],a+l[0].length):-1}function Wae(e,r,a){var l=nc.exec(r.slice(a,a+6));return l?(e.L=Math.floor(l[0]/1e3),a+l[0].length):-1}function Zae(e,r,a){var l=Dae.exec(r.slice(a,a+1));return l?a+l[0].length:-1}function Xae(e,r,a){var l=nc.exec(r.slice(a));return l?(e.Q=+l[0],a+l[0].length):-1}function Yae(e,r,a){var l=nc.exec(r.slice(a));return l?(e.s=+l[0],a+l[0].length):-1}function wz(e,r){return la(e.getDate(),r,2)}function Qae(e,r){return la(e.getHours(),r,2)}function Kae(e,r){return la(e.getHours()%12||12,r,2)}function Jae(e,r){return la(1+Rx.count(Qm(e),e),r,3)}function C6(e,r){return la(e.getMilliseconds(),r,3)}function ese(e,r){return C6(e,r)+"000"}function tse(e,r){return la(e.getMonth()+1,r,2)}function rse(e,r){return la(e.getMinutes(),r,2)}function nse(e,r){return la(e.getSeconds(),r,2)}function ise(e){var r=e.getDay();return r===0?7:r}function ose(e,r){return la(b2.count(Qm(e)-1,e),r,2)}function M6(e){var r=e.getDay();return r>=4||r===0?q_(e):q_.ceil(e)}function ase(e,r){return e=M6(e),la(q_.count(Qm(e),e)+(Qm(e).getDay()===4),r,2)}function sse(e){return e.getDay()}function lse(e,r){return la(pw.count(Qm(e)-1,e),r,2)}function cse(e,r){return la(e.getFullYear()%100,r,2)}function use(e,r){return e=M6(e),la(e.getFullYear()%100,r,2)}function hse(e,r){return la(e.getFullYear()%1e4,r,4)}function fse(e,r){var a=e.getDay();return e=a>=4||a===0?q_(e):q_.ceil(e),la(e.getFullYear()%1e4,r,4)}function dse(e){var r=e.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+la(r/60|0,"0",2)+la(r%60,"0",2)}function Sz(e,r){return la(e.getUTCDate(),r,2)}function pse(e,r){return la(e.getUTCHours(),r,2)}function mse(e,r){return la(e.getUTCHours()%12||12,r,2)}function Ase(e,r){return la(1+x2.count(Km(e),e),r,3)}function I6(e,r){return la(e.getUTCMilliseconds(),r,3)}function gse(e,r){return I6(e,r)+"000"}function _se(e,r){return la(e.getUTCMonth()+1,r,2)}function yse(e,r){return la(e.getUTCMinutes(),r,2)}function vse(e,r){return la(e.getUTCSeconds(),r,2)}function xse(e){var r=e.getUTCDay();return r===0?7:r}function bse(e,r){return la(w2.count(Km(e)-1,e),r,2)}function P6(e){var r=e.getUTCDay();return r>=4||r===0?W_(e):W_.ceil(e)}function wse(e,r){return e=P6(e),la(W_.count(Km(e),e)+(Km(e).getUTCDay()===4),r,2)}function Sse(e){return e.getUTCDay()}function Tse(e,r){return la(mw.count(Km(e)-1,e),r,2)}function Ese(e,r){return la(e.getUTCFullYear()%100,r,2)}function Cse(e,r){return e=P6(e),la(e.getUTCFullYear()%100,r,2)}function Mse(e,r){return la(e.getUTCFullYear()%1e4,r,4)}function Ise(e,r){var a=e.getUTCDay();return e=a>=4||a===0?W_(e):W_.ceil(e),la(e.getUTCFullYear()%1e4,r,4)}function Pse(){return"+0000"}function Tz(){return"%"}function Ez(e){return+e}function Cz(e){return Math.floor(+e/1e3)}var C_,R6,D6;Rse({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Rse(e){return C_=Rae(e),R6=C_.format,C_.parse,D6=C_.utcFormat,C_.utcParse,C_}function Dse(e){return new Date(e)}function Ose(e){return e instanceof Date?+e:+new Date(+e)}function LM(e,r,a,l,m,y,T,i,z,B){var F=bM(),G=F.invert,Q=F.domain,te=B(".%L"),ne=B(":%S"),oe=B("%I:%M"),ue=B("%I %p"),ye=B("%a %d"),we=B("%b %d"),ve=B("%B"),Ce=B("%Y");function Ee(Be){return(z(Be)<Be?te:i(Be)<Be?ne:T(Be)<Be?oe:y(Be)<Be?ue:l(Be)<Be?m(Be)<Be?ye:we:a(Be)<Be?ve:Ce)(Be)}return F.invert=function(Be){return new Date(G(Be))},F.domain=function(Be){return arguments.length?Q(Array.from(Be,Ose)):Q().map(Dse)},F.ticks=function(Be){var Ke=Q();return e(Ke[0],Ke[Ke.length-1],Be??10)},F.tickFormat=function(Be,Ke){return Ke==null?Ee:B(Ke)},F.nice=function(Be){var Ke=Q();return(!Be||typeof Be.range!="function")&&(Be=r(Ke[0],Ke[Ke.length-1],Be??10)),Be?Q(_6(Ke,Be)):F},F.copy=function(){return Px(F,LM(e,r,a,l,m,y,T,i,z,B))},F}function kse(){return ud.apply(LM(Iae,Pae,Qm,kM,b2,Rx,DM,PM,cg,R6).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function zse(){return ud.apply(LM(Cae,Mae,Km,zM,w2,x2,OM,RM,cg,D6).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function S2(){var e=0,r=1,a,l,m,y,T=Gu,i=!1,z;function B(G){return G==null||isNaN(G=+G)?z:T(m===0?.5:(G=(y(G)-a)*m,i?Math.max(0,Math.min(1,G)):G))}B.domain=function(G){return arguments.length?([e,r]=G,a=y(e=+e),l=y(r=+r),m=a===l?0:1/(l-a),B):[e,r]},B.clamp=function(G){return arguments.length?(i=!!G,B):i},B.interpolator=function(G){return arguments.length?(T=G,B):T};function F(G){return function(Q){var te,ne;return arguments.length?([te,ne]=Q,T=G(te,ne),B):[T(0),T(1)]}}return B.range=F(cy),B.rangeRound=F(xM),B.unknown=function(G){return arguments.length?(z=G,B):z},function(G){return y=G,a=G(e),l=G(r),m=a===l?0:1/(l-a),B}}function f0(e,r){return r.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function O6(){var e=h0(S2()(Gu));return e.copy=function(){return f0(e,O6())},nA.apply(e,arguments)}function k6(){var e=TM(S2()).domain([1,10]);return e.copy=function(){return f0(e,k6()).base(e.base())},nA.apply(e,arguments)}function z6(){var e=EM(S2());return e.copy=function(){return f0(e,z6()).constant(e.constant())},nA.apply(e,arguments)}function BM(){var e=CM(S2());return e.copy=function(){return f0(e,BM()).exponent(e.exponent())},nA.apply(e,arguments)}function Lse(){return BM.apply(null,arguments).exponent(.5)}function L6(){var e=[],r=Gu;function a(l){if(l!=null&&!isNaN(l=+l))return r((Mx(e,l,1)-1)/(e.length-1))}return a.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let m of l)m!=null&&!isNaN(m=+m)&&e.push(m);return e.sort(n0),a},a.interpolator=function(l){return arguments.length?(r=l,a):r},a.range=function(){return e.map((l,m)=>r(m/(e.length-1)))},a.quantiles=function(l){return Array.from({length:l+1},(m,y)=>xoe(e,y/l))},a.copy=function(){return L6(r).domain(e)},nA.apply(a,arguments)}function T2(){var e=0,r=.5,a=1,l=1,m,y,T,i,z,B=Gu,F,G=!1,Q;function te(oe){return isNaN(oe=+oe)?Q:(oe=.5+((oe=+F(oe))-y)*(l*oe<l*y?i:z),B(G?Math.max(0,Math.min(1,oe)):oe))}te.domain=function(oe){return arguments.length?([e,r,a]=oe,m=F(e=+e),y=F(r=+r),T=F(a=+a),i=m===y?0:.5/(y-m),z=y===T?0:.5/(T-y),l=y<m?-1:1,te):[e,r,a]},te.clamp=function(oe){return arguments.length?(G=!!oe,te):G},te.interpolator=function(oe){return arguments.length?(B=oe,te):B};function ne(oe){return function(ue){var ye,we,ve;return arguments.length?([ye,we,ve]=ue,B=Zoe(oe,[ye,we,ve]),te):[B(0),B(.5),B(1)]}}return te.range=ne(cy),te.rangeRound=ne(xM),te.unknown=function(oe){return arguments.length?(Q=oe,te):Q},function(oe){return F=oe,m=oe(e),y=oe(r),T=oe(a),i=m===y?0:.5/(y-m),z=y===T?0:.5/(T-y),l=y<m?-1:1,te}}function B6(){var e=h0(T2()(Gu));return e.copy=function(){return f0(e,B6())},nA.apply(e,arguments)}function F6(){var e=TM(T2()).domain([.1,1,10]);return e.copy=function(){return f0(e,F6()).base(e.base())},nA.apply(e,arguments)}function N6(){var e=EM(T2());return e.copy=function(){return f0(e,N6()).constant(e.constant())},nA.apply(e,arguments)}function FM(){var e=CM(T2());return e.copy=function(){return f0(e,FM()).exponent(e.exponent())},nA.apply(e,arguments)}function Bse(){return FM.apply(null,arguments).exponent(.5)}const Ov=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:_M,scaleDiverging:B6,scaleDivergingLog:F6,scaleDivergingPow:FM,scaleDivergingSqrt:Bse,scaleDivergingSymlog:N6,scaleIdentity:g6,scaleImplicit:VC,scaleLinear:A6,scaleLog:y6,scaleOrdinal:gM,scalePoint:Soe,scalePow:MM,scaleQuantile:b6,scaleQuantize:w6,scaleRadial:x6,scaleSequential:O6,scaleSequentialLog:k6,scaleSequentialPow:BM,scaleSequentialQuantile:L6,scaleSequentialSqrt:Lse,scaleSequentialSymlog:z6,scaleSqrt:gae,scaleSymlog:v6,scaleThreshold:S6,scaleTime:kse,scaleUtc:zse,tickFormat:m6},Symbol.toStringTag,{value:"Module"}));var d0=e=>e.chartData,Fse=Pr([d0],e=>{var r=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:r,dataStartIndex:0}}),NM=(e,r,a,l)=>l?Fse(e):d0(e);function Z_(e){if(Array.isArray(e)&&e.length===2){var[r,a]=e;if(qu(r)&&qu(a))return!0}return!1}function Mz(e,r,a){return a?e:[Math.min(e[0],r[0]),Math.max(e[1],r[1])]}function Nse(e,r){if(r&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[a,l]=e,m,y;if(qu(a))m=a;else if(typeof a=="function")return;if(qu(l))y=l;else if(typeof l=="function")return;var T=[m,y];if(Z_(T))return T}}function jse(e,r,a){if(!(!a&&r==null)){if(typeof e=="function"&&r!=null)try{var l=e(r,a);if(Z_(l))return Mz(l,r,a)}catch{}if(Array.isArray(e)&&e.length===2){var[m,y]=e,T,i;if(m==="auto")r!=null&&(T=Math.min(...r));else if(oo(m))T=m;else if(typeof m=="function")try{r!=null&&(T=m(r?.[0]))}catch{}else if(typeof m=="string"&&v4.test(m)){var z=v4.exec(m);if(z==null||r==null)T=void 0;else{var B=+z[1];T=r[0]-B}}else T=r?.[0];if(y==="auto")r!=null&&(i=Math.max(...r));else if(oo(y))i=y;else if(typeof y=="function")try{r!=null&&(i=y(r?.[1]))}catch{}else if(typeof y=="string"&&x4.test(y)){var F=x4.exec(y);if(F==null||r==null)i=void 0;else{var G=+F[1];i=r[1]+G}}else i=r?.[1];var Q=[T,i];if(Z_(Q))return r==null?Q:Mz(Q,r,a)}}}var uy=1e9,Use={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},UM,ps=!0,ld="[DecimalError] ",mg=ld+"Invalid argument: ",jM=ld+"Exponent out of range: ",hy=Math.floor,ng=Math.pow,Vse=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,bf,tc=1e7,is=7,j6=9007199254740991,Aw=hy(j6/is),ti={};ti.absoluteValue=ti.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ti.comparedTo=ti.cmp=function(e){var r,a,l,m,y=this;if(e=new y.constructor(e),y.s!==e.s)return y.s||-e.s;if(y.e!==e.e)return y.e>e.e^y.s<0?1:-1;for(l=y.d.length,m=e.d.length,r=0,a=l<m?l:m;r<a;++r)if(y.d[r]!==e.d[r])return y.d[r]>e.d[r]^y.s<0?1:-1;return l===m?0:l>m^y.s<0?1:-1};ti.decimalPlaces=ti.dp=function(){var e=this,r=e.d.length-1,a=(r-e.e)*is;if(r=e.d[r],r)for(;r%10==0;r/=10)a--;return a<0?0:a};ti.dividedBy=ti.div=function(e){return Vm(this,new this.constructor(e))};ti.dividedToIntegerBy=ti.idiv=function(e){var r=this,a=r.constructor;return Ua(Vm(r,new a(e),0,1),a.precision)};ti.equals=ti.eq=function(e){return!this.cmp(e)};ti.exponent=function(){return gl(this)};ti.greaterThan=ti.gt=function(e){return this.cmp(e)>0};ti.greaterThanOrEqualTo=ti.gte=function(e){return this.cmp(e)>=0};ti.isInteger=ti.isint=function(){return this.e>this.d.length-2};ti.isNegative=ti.isneg=function(){return this.s<0};ti.isPositive=ti.ispos=function(){return this.s>0};ti.isZero=function(){return this.s===0};ti.lessThan=ti.lt=function(e){return this.cmp(e)<0};ti.lessThanOrEqualTo=ti.lte=function(e){return this.cmp(e)<1};ti.logarithm=ti.log=function(e){var r,a=this,l=a.constructor,m=l.precision,y=m+5;if(e===void 0)e=new l(10);else if(e=new l(e),e.s<1||e.eq(bf))throw Error(ld+"NaN");if(a.s<1)throw Error(ld+(a.s?"NaN":"-Infinity"));return a.eq(bf)?new l(0):(ps=!1,r=Vm(rx(a,y),rx(e,y),y),ps=!0,Ua(r,m))};ti.minus=ti.sub=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?$6(r,e):U6(r,(e.s=-e.s,e))};ti.modulo=ti.mod=function(e){var r,a=this,l=a.constructor,m=l.precision;if(e=new l(e),!e.s)throw Error(ld+"NaN");return a.s?(ps=!1,r=Vm(a,e,0,1).times(e),ps=!0,a.minus(r)):Ua(new l(a),m)};ti.naturalExponential=ti.exp=function(){return V6(this)};ti.naturalLogarithm=ti.ln=function(){return rx(this)};ti.negated=ti.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ti.plus=ti.add=function(e){var r=this;return e=new r.constructor(e),r.s==e.s?U6(r,e):$6(r,(e.s=-e.s,e))};ti.precision=ti.sd=function(e){var r,a,l,m=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(mg+e);if(r=gl(m)+1,l=m.d.length-1,a=l*is+1,l=m.d[l],l){for(;l%10==0;l/=10)a--;for(l=m.d[0];l>=10;l/=10)a++}return e&&r>a?r:a};ti.squareRoot=ti.sqrt=function(){var e,r,a,l,m,y,T,i=this,z=i.constructor;if(i.s<1){if(!i.s)return new z(0);throw Error(ld+"NaN")}for(e=gl(i),ps=!1,m=Math.sqrt(+i),m==0||m==1/0?(r=Up(i.d),(r.length+e)%2==0&&(r+="0"),m=Math.sqrt(r),e=hy((e+1)/2)-(e<0||e%2),m==1/0?r="5e"+e:(r=m.toExponential(),r=r.slice(0,r.indexOf("e")+1)+e),l=new z(r)):l=new z(m.toString()),a=z.precision,m=T=a+3;;)if(y=l,l=y.plus(Vm(i,y,T+2)).times(.5),Up(y.d).slice(0,T)===(r=Up(l.d)).slice(0,T)){if(r=r.slice(T-3,T+1),m==T&&r=="4999"){if(Ua(y,a+1,0),y.times(y).eq(i)){l=y;break}}else if(r!="9999")break;T+=4}return ps=!0,Ua(l,a)};ti.times=ti.mul=function(e){var r,a,l,m,y,T,i,z,B,F=this,G=F.constructor,Q=F.d,te=(e=new G(e)).d;if(!F.s||!e.s)return new G(0);for(e.s*=F.s,a=F.e+e.e,z=Q.length,B=te.length,z<B&&(y=Q,Q=te,te=y,T=z,z=B,B=T),y=[],T=z+B,l=T;l--;)y.push(0);for(l=B;--l>=0;){for(r=0,m=z+l;m>l;)i=y[m]+te[l]*Q[m-l-1]+r,y[m--]=i%tc|0,r=i/tc|0;y[m]=(y[m]+r)%tc|0}for(;!y[--T];)y.pop();return r?++a:y.shift(),e.d=y,e.e=a,ps?Ua(e,G.precision):e};ti.toDecimalPlaces=ti.todp=function(e,r){var a=this,l=a.constructor;return a=new l(a),e===void 0?a:(Wp(e,0,uy),r===void 0?r=l.rounding:Wp(r,0,8),Ua(a,e+gl(a)+1,r))};ti.toExponential=function(e,r){var a,l=this,m=l.constructor;return e===void 0?a=vg(l,!0):(Wp(e,0,uy),r===void 0?r=m.rounding:Wp(r,0,8),l=Ua(new m(l),e+1,r),a=vg(l,!0,e+1)),a};ti.toFixed=function(e,r){var a,l,m=this,y=m.constructor;return e===void 0?vg(m):(Wp(e,0,uy),r===void 0?r=y.rounding:Wp(r,0,8),l=Ua(new y(m),e+gl(m)+1,r),a=vg(l.abs(),!1,e+gl(l)+1),m.isneg()&&!m.isZero()?"-"+a:a)};ti.toInteger=ti.toint=function(){var e=this,r=e.constructor;return Ua(new r(e),gl(e)+1,r.rounding)};ti.toNumber=function(){return+this};ti.toPower=ti.pow=function(e){var r,a,l,m,y,T,i=this,z=i.constructor,B=12,F=+(e=new z(e));if(!e.s)return new z(bf);if(i=new z(i),!i.s){if(e.s<1)throw Error(ld+"Infinity");return i}if(i.eq(bf))return i;if(l=z.precision,e.eq(bf))return Ua(i,l);if(r=e.e,a=e.d.length-1,T=r>=a,y=i.s,T){if((a=F<0?-F:F)<=j6){for(m=new z(bf),r=Math.ceil(l/is+4),ps=!1;a%2&&(m=m.times(i),Pz(m.d,r)),a=hy(a/2),a!==0;)i=i.times(i),Pz(i.d,r);return ps=!0,e.s<0?new z(bf).div(m):Ua(m,l)}}else if(y<0)throw Error(ld+"NaN");return y=y<0&&e.d[Math.max(r,a)]&1?-1:1,i.s=1,ps=!1,m=e.times(rx(i,l+B)),ps=!0,m=V6(m),m.s=y,m};ti.toPrecision=function(e,r){var a,l,m=this,y=m.constructor;return e===void 0?(a=gl(m),l=vg(m,a<=y.toExpNeg||a>=y.toExpPos)):(Wp(e,1,uy),r===void 0?r=y.rounding:Wp(r,0,8),m=Ua(new y(m),e,r),a=gl(m),l=vg(m,e<=a||a<=y.toExpNeg,e)),l};ti.toSignificantDigits=ti.tosd=function(e,r){var a=this,l=a.constructor;return e===void 0?(e=l.precision,r=l.rounding):(Wp(e,1,uy),r===void 0?r=l.rounding:Wp(r,0,8)),Ua(new l(a),e,r)};ti.toString=ti.valueOf=ti.val=ti.toJSON=ti[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,r=gl(e),a=e.constructor;return vg(e,r<=a.toExpNeg||r>=a.toExpPos)};function U6(e,r){var a,l,m,y,T,i,z,B,F=e.constructor,G=F.precision;if(!e.s||!r.s)return r.s||(r=new F(e)),ps?Ua(r,G):r;if(z=e.d,B=r.d,T=e.e,m=r.e,z=z.slice(),y=T-m,y){for(y<0?(l=z,y=-y,i=B.length):(l=B,m=T,i=z.length),T=Math.ceil(G/is),i=T>i?T+1:i+1,y>i&&(y=i,l.length=1),l.reverse();y--;)l.push(0);l.reverse()}for(i=z.length,y=B.length,i-y<0&&(y=i,l=B,B=z,z=l),a=0;y;)a=(z[--y]=z[y]+B[y]+a)/tc|0,z[y]%=tc;for(a&&(z.unshift(a),++m),i=z.length;z[--i]==0;)z.pop();return r.d=z,r.e=m,ps?Ua(r,G):r}function Wp(e,r,a){if(e!==~~e||e<r||e>a)throw Error(mg+e)}function Up(e){var r,a,l,m=e.length-1,y="",T=e[0];if(m>0){for(y+=T,r=1;r<m;r++)l=e[r]+"",a=is-l.length,a&&(y+=JA(a)),y+=l;T=e[r],l=T+"",a=is-l.length,a&&(y+=JA(a))}else if(T===0)return"0";for(;T%10===0;)T/=10;return y+T}var Vm=(function(){function e(l,m){var y,T=0,i=l.length;for(l=l.slice();i--;)y=l[i]*m+T,l[i]=y%tc|0,T=y/tc|0;return T&&l.unshift(T),l}function r(l,m,y,T){var i,z;if(y!=T)z=y>T?1:-1;else for(i=z=0;i<y;i++)if(l[i]!=m[i]){z=l[i]>m[i]?1:-1;break}return z}function a(l,m,y){for(var T=0;y--;)l[y]-=T,T=l[y]<m[y]?1:0,l[y]=T*tc+l[y]-m[y];for(;!l[0]&&l.length>1;)l.shift()}return function(l,m,y,T){var i,z,B,F,G,Q,te,ne,oe,ue,ye,we,ve,Ce,Ee,Be,Ke,st,dt=l.constructor,bt=l.s==m.s?1:-1,ht=l.d,Re=m.d;if(!l.s)return new dt(l);if(!m.s)throw Error(ld+"Division by zero");for(z=l.e-m.e,Ke=Re.length,Ee=ht.length,te=new dt(bt),ne=te.d=[],B=0;Re[B]==(ht[B]||0);)++B;if(Re[B]>(ht[B]||0)&&--z,y==null?we=y=dt.precision:T?we=y+(gl(l)-gl(m))+1:we=y,we<0)return new dt(0);if(we=we/is+2|0,B=0,Ke==1)for(F=0,Re=Re[0],we++;(B<Ee||F)&&we--;B++)ve=F*tc+(ht[B]||0),ne[B]=ve/Re|0,F=ve%Re|0;else{for(F=tc/(Re[0]+1)|0,F>1&&(Re=e(Re,F),ht=e(ht,F),Ke=Re.length,Ee=ht.length),Ce=Ke,oe=ht.slice(0,Ke),ue=oe.length;ue<Ke;)oe[ue++]=0;st=Re.slice(),st.unshift(0),Be=Re[0],Re[1]>=tc/2&&++Be;do F=0,i=r(Re,oe,Ke,ue),i<0?(ye=oe[0],Ke!=ue&&(ye=ye*tc+(oe[1]||0)),F=ye/Be|0,F>1?(F>=tc&&(F=tc-1),G=e(Re,F),Q=G.length,ue=oe.length,i=r(G,oe,Q,ue),i==1&&(F--,a(G,Ke<Q?st:Re,Q))):(F==0&&(i=F=1),G=Re.slice()),Q=G.length,Q<ue&&G.unshift(0),a(oe,G,ue),i==-1&&(ue=oe.length,i=r(Re,oe,Ke,ue),i<1&&(F++,a(oe,Ke<ue?st:Re,ue))),ue=oe.length):i===0&&(F++,oe=[0]),ne[B++]=F,i&&oe[0]?oe[ue++]=ht[Ce]||0:(oe=[ht[Ce]],ue=1);while((Ce++<Ee||oe[0]!==void 0)&&we--)}return ne[0]||ne.shift(),te.e=z,Ua(te,T?y+gl(te)+1:y)}})();function V6(e,r){var a,l,m,y,T,i,z=0,B=0,F=e.constructor,G=F.precision;if(gl(e)>16)throw Error(jM+gl(e));if(!e.s)return new F(bf);for(ps=!1,i=G,T=new F(.03125);e.abs().gte(.1);)e=e.times(T),B+=5;for(l=Math.log(ng(2,B))/Math.LN10*2+5|0,i+=l,a=m=y=new F(bf),F.precision=i;;){if(m=Ua(m.times(e),i),a=a.times(++z),T=y.plus(Vm(m,a,i)),Up(T.d).slice(0,i)===Up(y.d).slice(0,i)){for(;B--;)y=Ua(y.times(y),i);return F.precision=G,r==null?(ps=!0,Ua(y,G)):y}y=T}}function gl(e){for(var r=e.e*is,a=e.d[0];a>=10;a/=10)r++;return r}function wE(e,r,a){if(r>e.LN10.sd())throw ps=!0,a&&(e.precision=a),Error(ld+"LN10 precision limit exceeded");return Ua(new e(e.LN10),r)}function JA(e){for(var r="";e--;)r+="0";return r}function rx(e,r){var a,l,m,y,T,i,z,B,F,G=1,Q=10,te=e,ne=te.d,oe=te.constructor,ue=oe.precision;if(te.s<1)throw Error(ld+(te.s?"NaN":"-Infinity"));if(te.eq(bf))return new oe(0);if(r==null?(ps=!1,B=ue):B=r,te.eq(10))return r==null&&(ps=!0),wE(oe,B);if(B+=Q,oe.precision=B,a=Up(ne),l=a.charAt(0),y=gl(te),Math.abs(y)<15e14){for(;l<7&&l!=1||l==1&&a.charAt(1)>3;)te=te.times(e),a=Up(te.d),l=a.charAt(0),G++;y=gl(te),l>1?(te=new oe("0."+a),y++):te=new oe(l+"."+a.slice(1))}else return z=wE(oe,B+2,ue).times(y+""),te=rx(new oe(l+"."+a.slice(1)),B-Q).plus(z),oe.precision=ue,r==null?(ps=!0,Ua(te,ue)):te;for(i=T=te=Vm(te.minus(bf),te.plus(bf),B),F=Ua(te.times(te),B),m=3;;){if(T=Ua(T.times(F),B),z=i.plus(Vm(T,new oe(m),B)),Up(z.d).slice(0,B)===Up(i.d).slice(0,B))return i=i.times(2),y!==0&&(i=i.plus(wE(oe,B+2,ue).times(y+""))),i=Vm(i,new oe(G),B),oe.precision=ue,r==null?(ps=!0,Ua(i,ue)):i;i=z,m+=2}}function Iz(e,r){var a,l,m;for((a=r.indexOf("."))>-1&&(r=r.replace(".","")),(l=r.search(/e/i))>0?(a<0&&(a=l),a+=+r.slice(l+1),r=r.substring(0,l)):a<0&&(a=r.length),l=0;r.charCodeAt(l)===48;)++l;for(m=r.length;r.charCodeAt(m-1)===48;)--m;if(r=r.slice(l,m),r){if(m-=l,a=a-l-1,e.e=hy(a/is),e.d=[],l=(a+1)%is,a<0&&(l+=is),l<m){for(l&&e.d.push(+r.slice(0,l)),m-=is;l<m;)e.d.push(+r.slice(l,l+=is));r=r.slice(l),l=is-r.length}else l-=m;for(;l--;)r+="0";if(e.d.push(+r),ps&&(e.e>Aw||e.e<-Aw))throw Error(jM+a)}else e.s=0,e.e=0,e.d=[0];return e}function Ua(e,r,a){var l,m,y,T,i,z,B,F,G=e.d;for(T=1,y=G[0];y>=10;y/=10)T++;if(l=r-T,l<0)l+=is,m=r,B=G[F=0];else{if(F=Math.ceil((l+1)/is),y=G.length,F>=y)return e;for(B=y=G[F],T=1;y>=10;y/=10)T++;l%=is,m=l-is+T}if(a!==void 0&&(y=ng(10,T-m-1),i=B/y%10|0,z=r<0||G[F+1]!==void 0||B%y,z=a<4?(i||z)&&(a==0||a==(e.s<0?3:2)):i>5||i==5&&(a==4||z||a==6&&(l>0?m>0?B/ng(10,T-m):0:G[F-1])%10&1||a==(e.s<0?8:7))),r<1||!G[0])return z?(y=gl(e),G.length=1,r=r-y-1,G[0]=ng(10,(is-r%is)%is),e.e=hy(-r/is)||0):(G.length=1,G[0]=e.e=e.s=0),e;if(l==0?(G.length=F,y=1,F--):(G.length=F+1,y=ng(10,is-l),G[F]=m>0?(B/ng(10,T-m)%ng(10,m)|0)*y:0),z)for(;;)if(F==0){(G[0]+=y)==tc&&(G[0]=1,++e.e);break}else{if(G[F]+=y,G[F]!=tc)break;G[F--]=0,y=1}for(l=G.length;G[--l]===0;)G.pop();if(ps&&(e.e>Aw||e.e<-Aw))throw Error(jM+gl(e));return e}function $6(e,r){var a,l,m,y,T,i,z,B,F,G,Q=e.constructor,te=Q.precision;if(!e.s||!r.s)return r.s?r.s=-r.s:r=new Q(e),ps?Ua(r,te):r;if(z=e.d,G=r.d,l=r.e,B=e.e,z=z.slice(),T=B-l,T){for(F=T<0,F?(a=z,T=-T,i=G.length):(a=G,l=B,i=z.length),m=Math.max(Math.ceil(te/is),i)+2,T>m&&(T=m,a.length=1),a.reverse(),m=T;m--;)a.push(0);a.reverse()}else{for(m=z.length,i=G.length,F=m<i,F&&(i=m),m=0;m<i;m++)if(z[m]!=G[m]){F=z[m]<G[m];break}T=0}for(F&&(a=z,z=G,G=a,r.s=-r.s),i=z.length,m=G.length-i;m>0;--m)z[i++]=0;for(m=G.length;m>T;){if(z[--m]<G[m]){for(y=m;y&&z[--y]===0;)z[y]=tc-1;--z[y],z[m]+=tc}z[m]-=G[m]}for(;z[--i]===0;)z.pop();for(;z[0]===0;z.shift())--l;return z[0]?(r.d=z,r.e=l,ps?Ua(r,te):r):new Q(0)}function vg(e,r,a){var l,m=gl(e),y=Up(e.d),T=y.length;return r?(a&&(l=a-T)>0?y=y.charAt(0)+"."+y.slice(1)+JA(l):T>1&&(y=y.charAt(0)+"."+y.slice(1)),y=y+(m<0?"e":"e+")+m):m<0?(y="0."+JA(-m-1)+y,a&&(l=a-T)>0&&(y+=JA(l))):m>=T?(y+=JA(m+1-T),a&&(l=a-m-1)>0&&(y=y+"."+JA(l))):((l=m+1)<T&&(y=y.slice(0,l)+"."+y.slice(l)),a&&(l=a-T)>0&&(m+1===T&&(y+="."),y+=JA(l))),e.s<0?"-"+y:y}function Pz(e,r){if(e.length>r)return e.length=r,!0}function G6(e){var r,a,l;function m(y){var T=this;if(!(T instanceof m))return new m(y);if(T.constructor=m,y instanceof m){T.s=y.s,T.e=y.e,T.d=(y=y.d)?y.slice():y;return}if(typeof y=="number"){if(y*0!==0)throw Error(mg+y);if(y>0)T.s=1;else if(y<0)y=-y,T.s=-1;else{T.s=0,T.e=0,T.d=[0];return}if(y===~~y&&y<1e7){T.e=0,T.d=[y];return}return Iz(T,y.toString())}else if(typeof y!="string")throw Error(mg+y);if(y.charCodeAt(0)===45?(y=y.slice(1),T.s=-1):T.s=1,Vse.test(y))Iz(T,y);else throw Error(mg+y)}if(m.prototype=ti,m.ROUND_UP=0,m.ROUND_DOWN=1,m.ROUND_CEIL=2,m.ROUND_FLOOR=3,m.ROUND_HALF_UP=4,m.ROUND_HALF_DOWN=5,m.ROUND_HALF_EVEN=6,m.ROUND_HALF_CEIL=7,m.ROUND_HALF_FLOOR=8,m.clone=G6,m.config=m.set=$se,e===void 0&&(e={}),e)for(l=["precision","rounding","toExpNeg","toExpPos","LN10"],r=0;r<l.length;)e.hasOwnProperty(a=l[r++])||(e[a]=this[a]);return m.config(e),m}function $se(e){if(!e||typeof e!="object")throw Error(ld+"Object expected");var r,a,l,m=["precision",1,uy,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(r=0;r<m.length;r+=3)if((l=e[a=m[r]])!==void 0)if(hy(l)===l&&l>=m[r+1]&&l<=m[r+2])this[a]=l;else throw Error(mg+a+": "+l);if((l=e[a="LN10"])!==void 0)if(l==Math.LN10)this[a]=new this(l);else throw Error(mg+a+": "+l);return this}var UM=G6(Use);bf=new UM(1);const Ea=UM;var Gse=e=>e,H6={},q6=e=>e===H6,Rz=e=>function r(){return arguments.length===0||arguments.length===1&&q6(arguments.length<=0?void 0:arguments[0])?r:e(...arguments)},W6=(e,r)=>e===1?r:Rz(function(){for(var a=arguments.length,l=new Array(a),m=0;m<a;m++)l[m]=arguments[m];var y=l.filter(T=>T!==H6).length;return y>=e?r(...l):W6(e-y,Rz(function(){for(var T=arguments.length,i=new Array(T),z=0;z<T;z++)i[z]=arguments[z];var B=l.map(F=>q6(F)?i.shift():F);return r(...B,...i)}))}),E2=e=>W6(e.length,e),qC=(e,r)=>{for(var a=[],l=e;l<r;++l)a[l-e]=l;return a},Hse=E2((e,r)=>Array.isArray(r)?r.map(e):Object.keys(r).map(a=>r[a]).map(e)),qse=function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];if(!a.length)return Gse;var m=a.reverse(),y=m[0],T=m.slice(1);return function(){return T.reduce((i,z)=>z(i),y(...arguments))}},WC=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),Z6=e=>{var r=null,a=null;return function(){for(var l=arguments.length,m=new Array(l),y=0;y<l;y++)m[y]=arguments[y];return r&&m.every((T,i)=>{var z;return T===((z=r)===null||z===void 0?void 0:z[i])})||(r=m,a=e(...m)),a}};function X6(e){var r;return e===0?r=1:r=Math.floor(new Ea(e).abs().log(10).toNumber())+1,r}function Y6(e,r,a){for(var l=new Ea(e),m=0,y=[];l.lt(r)&&m<1e5;)y.push(l.toNumber()),l=l.add(a),m++;return y}E2((e,r,a)=>{var l=+e,m=+r;return l+a*(m-l)});E2((e,r,a)=>{var l=r-+e;return l=l||1/0,(a-e)/l});E2((e,r,a)=>{var l=r-+e;return l=l||1/0,Math.max(0,Math.min(1,(a-e)/l))});var Q6=e=>{var[r,a]=e,[l,m]=[r,a];return r>a&&([l,m]=[a,r]),[l,m]},K6=(e,r,a)=>{if(e.lte(0))return new Ea(0);var l=X6(e.toNumber()),m=new Ea(10).pow(l),y=e.div(m),T=l!==1?.05:.1,i=new Ea(Math.ceil(y.div(T).toNumber())).add(a).mul(T),z=i.mul(m);return r?new Ea(z.toNumber()):new Ea(Math.ceil(z.toNumber()))},Wse=(e,r,a)=>{var l=new Ea(1),m=new Ea(e);if(!m.isint()&&a){var y=Math.abs(e);y<1?(l=new Ea(10).pow(X6(e)-1),m=new Ea(Math.floor(m.div(l).toNumber())).mul(l)):y>1&&(m=new Ea(Math.floor(e)))}else e===0?m=new Ea(Math.floor((r-1)/2)):a||(m=new Ea(Math.floor(e)));var T=Math.floor((r-1)/2),i=qse(Hse(z=>m.add(new Ea(z-T).mul(l)).toNumber()),qC);return i(0,r)},J6=function(r,a,l,m){var y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((a-r)/(l-1)))return{step:new Ea(0),tickMin:new Ea(0),tickMax:new Ea(0)};var T=K6(new Ea(a).sub(r).div(l-1),m,y),i;r<=0&&a>=0?i=new Ea(0):(i=new Ea(r).add(a).div(2),i=i.sub(new Ea(i).mod(T)));var z=Math.ceil(i.sub(r).div(T).toNumber()),B=Math.ceil(new Ea(a).sub(i).div(T).toNumber()),F=z+B+1;return F>l?J6(r,a,l,m,y+1):(F<l&&(B=a>0?B+(l-F):B,z=a>0?z:z+(l-F)),{step:T,tickMin:i.sub(new Ea(z).mul(T)),tickMax:i.add(new Ea(B).mul(T))})};function Zse(e){var[r,a]=e,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,y=Math.max(l,2),[T,i]=Q6([r,a]);if(T===-1/0||i===1/0){var z=i===1/0?[T,...qC(0,l-1).map(()=>1/0)]:[...qC(0,l-1).map(()=>-1/0),i];return r>a?WC(z):z}if(T===i)return Wse(T,l,m);var{step:B,tickMin:F,tickMax:G}=J6(T,i,y,m,0),Q=Y6(F,G.add(new Ea(.1).mul(B)),B);return r>a?WC(Q):Q}function Xse(e,r){var[a,l]=e,m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[y,T]=Q6([a,l]);if(y===-1/0||T===1/0)return[a,l];if(y===T)return[y];var i=Math.max(r,2),z=K6(new Ea(T).sub(y).div(i-1),m,0),B=[...Y6(new Ea(y),new Ea(T),z),T];return m===!1&&(B=B.map(F=>Math.round(F))),a>l?WC(B):B}var Yse=Z6(Zse),Qse=Z6(Xse),Kse=e=>e.rootProps.barCategoryGap,C2=e=>e.rootProps.stackOffset,VM=e=>e.options.chartName,$M=e=>e.rootProps.syncId,eN=e=>e.rootProps.syncMethod,GM=e=>e.options.eventEmitter,km={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},vf={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},M2=(e,r)=>{if(!(!e||!r))return e!=null&&e.reversed?[r[1],r[0]]:r},Jse={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:km.angleAxisId,includeHidden:!1,name:void 0,reversed:km.reversed,scale:km.scale,tick:km.tick,tickCount:void 0,ticks:void 0,type:km.type,unit:void 0},ele={allowDataOverflow:vf.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:vf.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:vf.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:vf.scale,tick:vf.tick,tickCount:vf.tickCount,ticks:void 0,type:vf.type,unit:void 0},tle={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:km.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:km.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:km.scale,tick:km.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},rle={allowDataOverflow:vf.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:vf.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:vf.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:vf.scale,tick:vf.tick,tickCount:vf.tickCount,ticks:void 0,type:"category",unit:void 0},HM=(e,r)=>e.polarAxis.angleAxis[r]!=null?e.polarAxis.angleAxis[r]:e.layout.layoutType==="radial"?tle:Jse,qM=(e,r)=>e.polarAxis.radiusAxis[r]!=null?e.polarAxis.radiusAxis[r]:e.layout.layoutType==="radial"?rle:ele,I2=e=>e.polarOptions,WM=Pr([tA,rA,vc],one),tN=Pr([I2,WM],(e,r)=>{if(e!=null)return s0(e.innerRadius,r,0)}),rN=Pr([I2,WM],(e,r)=>{if(e!=null)return s0(e.outerRadius,r,r*.8)}),nle=e=>{if(e==null)return[0,0];var{startAngle:r,endAngle:a}=e;return[r,a]},nN=Pr([I2],nle);Pr([HM,nN],M2);var iN=Pr([WM,tN,rN],(e,r,a)=>{if(!(e==null||r==null||a==null))return[r,a]});Pr([qM,iN],M2);var oN=Pr([Ya,I2,tN,rN,tA,rA],(e,r,a,l,m,y)=>{if(!(e!=="centric"&&e!=="radial"||r==null||a==null||l==null)){var{cx:T,cy:i,startAngle:z,endAngle:B}=r;return{cx:s0(T,m,m/2),cy:s0(i,y,y/2),innerRadius:a,outerRadius:l,startAngle:z,endAngle:B,clockWise:!1}}}),_l=(e,r)=>r,P2=(e,r,a)=>a;function ZM(e){return e?.id}var jl=e=>{var r=Ya(e);return r==="horizontal"?"xAxis":r==="vertical"?"yAxis":r==="centric"?"angleAxis":"radiusAxis"},fy=e=>e.tooltip.settings.axisId,ic=e=>{var r=jl(e),a=fy(e);return Dx(e,r,a)},aN=Pr([ic],e=>e?.dataKey);function sN(e,r,a){var{chartData:l=[]}=r,{allowDuplicatedCategory:m,dataKey:y}=a,T=new Map;return e.forEach(i=>{var z,B=(z=i.data)!==null&&z!==void 0?z:l;if(!(B==null||B.length===0)){var F=ZM(i);B.forEach((G,Q)=>{var te=y==null||m?Q:String(Hu(G,y,null)),ne=Hu(G,i.dataKey,0),oe;T.has(te)?oe=T.get(te):oe={},Object.assign(oe,{[F]:ne}),T.set(te,oe)})}}),Array.from(T.values())}function XM(e){return e.stackId!=null&&e.dataKey!=null}function Dz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function gw(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Dz(Object(a),!0).forEach(function(l){ile(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function ile(e,r,a){return(r=ole(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function ole(e){var r=ale(e,"string");return typeof r=="symbol"?r:r+""}function ale(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ZC=[0,"auto"],_f={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},lN=(e,r)=>e.cartesianAxis.xAxis[r],iA=(e,r)=>{var a=lN(e,r);return a??_f},yf={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ZC,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Cx},cN=(e,r)=>e.cartesianAxis.yAxis[r],oA=(e,r)=>{var a=cN(e,r);return a??yf},sle={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},YM=(e,r)=>{var a=e.cartesianAxis.zAxis[r];return a??sle},Oh=(e,r,a)=>{switch(r){case"xAxis":return iA(e,a);case"yAxis":return oA(e,a);case"zAxis":return YM(e,a);case"angleAxis":return HM(e,a);case"radiusAxis":return qM(e,a);default:throw new Error("Unexpected axis type: ".concat(r))}},lle=(e,r,a)=>{switch(r){case"xAxis":return iA(e,a);case"yAxis":return oA(e,a);default:throw new Error("Unexpected axis type: ".concat(r))}},Dx=(e,r,a)=>{switch(r){case"xAxis":return iA(e,a);case"yAxis":return oA(e,a);case"angleAxis":return HM(e,a);case"radiusAxis":return qM(e,a);default:throw new Error("Unexpected axis type: ".concat(r))}},uN=e=>e.graphicalItems.cartesianItems.some(r=>r.type==="bar")||e.graphicalItems.polarItems.some(r=>r.type==="radialBar");function hN(e,r){return a=>{switch(e){case"xAxis":return"xAxisId"in a&&a.xAxisId===r;case"yAxis":return"yAxisId"in a&&a.yAxisId===r;case"zAxis":return"zAxisId"in a&&a.zAxisId===r;case"angleAxis":return"angleAxisId"in a&&a.angleAxisId===r;case"radiusAxis":return"radiusAxisId"in a&&a.radiusAxisId===r;default:return!1}}}var fN=e=>e.graphicalItems.cartesianItems,cle=Pr([_l,P2],hN),dN=(e,r,a)=>e.filter(a).filter(l=>r?.includeHidden===!0?!0:!l.hide),Ox=Pr([fN,Oh,cle],dN),pN=Pr([Ox],e=>e.filter(r=>r.type==="area"||r.type==="bar").filter(XM)),mN=e=>e.filter(r=>!("stackId"in r)||r.stackId===void 0),AN=Pr([Ox],mN),gN=e=>e.map(r=>r.data).filter(Boolean).flat(1),ule=Pr([Ox],gN),_N=(e,r)=>{var{chartData:a=[],dataStartIndex:l,dataEndIndex:m}=r;return e.length>0?e:a.slice(l,m+1)},QM=Pr([ule,NM],_N),yN=(e,r,a)=>r?.dataKey!=null?e.map(l=>({value:Hu(l,r.dataKey)})):a.length>0?a.map(l=>l.dataKey).flatMap(l=>e.map(m=>({value:Hu(m,l)}))):e.map(l=>({value:l})),R2=Pr([QM,Oh,Ox],yN);function vN(e,r){switch(e){case"xAxis":return r.direction==="x";case"yAxis":return r.direction==="y";default:return!1}}function Eg(e){return e.filter(r=>qp(r)||r instanceof Date).map(Number).filter(r=>ad(r)===!1)}function hle(e,r,a){return!a||typeof r!="number"||ad(r)?[]:a.length?Eg(a.flatMap(l=>{var m=Hu(e,l.dataKey),y,T;if(Array.isArray(m)?[y,T]=m:y=T=m,!(!qu(y)||!qu(T)))return[r-y,r+T]})):[]}var fle=Pr([pN,NM,ic],sN),xN=(e,r,a)=>{var l={},m=r.reduce((y,T)=>(T.stackId==null||(y[T.stackId]==null&&(y[T.stackId]=[]),y[T.stackId].push(T)),y),l);return Object.fromEntries(Object.entries(m).map(y=>{var[T,i]=y,z=i.map(ZM);return[T,{stackedData:vne(e,z,a),graphicalItems:i}]}))},XC=Pr([fle,pN,C2],xN),bN=(e,r,a)=>{var{dataStartIndex:l,dataEndIndex:m}=r;if(a!=="zAxis"){var y=Sne(e,l,m);if(!(y!=null&&y[0]===0&&y[1]===0))return y}},dle=Pr([XC,d0,_l],bN),wN=(e,r,a,l,m)=>a.length>0?e.flatMap(y=>a.flatMap(T=>{var i,z,B=(i=l[T.id])===null||i===void 0?void 0:i.filter(G=>vN(m,G)),F=Hu(y,(z=r.dataKey)!==null&&z!==void 0?z:T.dataKey);return{value:F,errorDomain:hle(y,F,B)}})).filter(Boolean):r?.dataKey!=null?e.map(y=>({value:Hu(y,r.dataKey),errorDomain:[]})):e.map(y=>({value:y,errorDomain:[]})),D2=e=>e.errorBars,SN=(e,r,a)=>e.flatMap(l=>r[l.id]).filter(Boolean).filter(l=>vN(a,l));Pr([AN,D2,_l],SN);var ple=Pr([QM,Oh,AN,D2,_l],wN);function mle(e){var{value:r}=e;if(qp(r)||r instanceof Date)return r}var Oz=e=>{var r=e.flatMap(l=>[l.value,l.errorDomain]).flat(1),a=Eg(r);if(a.length!==0)return[Math.min(...a),Math.max(...a)]},Ale=(e,r,a)=>{var l=e.map(mle).filter(m=>m!=null);return a&&(r.dataKey==null||r.allowDuplicatedCategory&&H5(l))?o6(0,e.length):r.allowDuplicatedCategory?l:Array.from(new Set(l))},KM=e=>{var r;if(e==null||!("domain"in e))return ZC;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var a=Eg(e.ticks);return[Math.min(...a),Math.max(...a)]}if(e.type==="category")return e.ticks.map(String)}return(r=e?.domain)!==null&&r!==void 0?r:ZC},_w=function(){for(var r=arguments.length,a=new Array(r),l=0;l<r;l++)a[l]=arguments[l];var m=a.filter(Boolean);if(m.length!==0){var y=m.flat(),T=Math.min(...y),i=Math.max(...y);return[T,i]}},TN=e=>e.referenceElements.dots,dy=(e,r,a)=>e.filter(l=>l.ifOverflow==="extendDomain").filter(l=>r==="xAxis"?l.xAxisId===a:l.yAxisId===a),gle=Pr([TN,_l,P2],dy),EN=e=>e.referenceElements.areas,_le=Pr([EN,_l,P2],dy),CN=e=>e.referenceElements.lines,yle=Pr([CN,_l,P2],dy),MN=(e,r)=>{var a=Eg(e.map(l=>r==="xAxis"?l.x:l.y));if(a.length!==0)return[Math.min(...a),Math.max(...a)]},vle=Pr(gle,_l,MN),IN=(e,r)=>{var a=Eg(e.flatMap(l=>[r==="xAxis"?l.x1:l.y1,r==="xAxis"?l.x2:l.y2]));if(a.length!==0)return[Math.min(...a),Math.max(...a)]},xle=Pr([_le,_l],IN),PN=(e,r)=>{var a=Eg(e.map(l=>r==="xAxis"?l.x:l.y));if(a.length!==0)return[Math.min(...a),Math.max(...a)]},ble=Pr(yle,_l,PN),wle=Pr(vle,ble,xle,(e,r,a)=>_w(e,a,r)),Sle=Pr([Oh],KM),RN=(e,r,a,l,m,y,T)=>{var i=Nse(r,e.allowDataOverflow);if(i!=null)return i;var z=y==="vertical"&&T==="xAxis"||y==="horizontal"&&T==="yAxis",B=z?_w(a,m,Oz(l)):_w(m,Oz(l));return jse(r,B,e.allowDataOverflow)},Tle=Pr([Oh,Sle,dle,ple,wle,Ya,_l],RN),Ele=[0,1],DN=(e,r,a,l,m,y,T)=>{if(!((e==null||a==null||a.length===0)&&T===void 0)){var{dataKey:i,type:z}=e,B=eA(r,y);return B&&i==null?o6(0,a.length):z==="category"?Ale(l,e,B):m==="expand"?Ele:T}},JM=Pr([Oh,Ya,QM,R2,C2,_l,Tle],DN),ON=(e,r,a,l,m)=>{if(e!=null){var{scale:y,type:T}=e;if(y==="auto")return r==="radial"&&m==="radiusAxis"?"band":r==="radial"&&m==="angleAxis"?"linear":T==="category"&&l&&(l.indexOf("LineChart")>=0||l.indexOf("AreaChart")>=0||l.indexOf("ComposedChart")>=0&&!a)?"point":T==="category"?"band":"linear";if(typeof y=="string"){var i="scale".concat(rM(y));return i in Ov?i:"point"}}},kx=Pr([Oh,Ya,uN,VM,_l],ON);function Cle(e){if(e!=null){if(e in Ov)return Ov[e]();var r="scale".concat(rM(e));if(r in Ov)return Ov[r]()}}function eI(e,r,a,l){if(!(a==null||l==null)){if(typeof e.scale=="function")return e.scale.copy().domain(a).range(l);var m=Cle(r);if(m!=null){var y=m.domain(a).range(l);return Ane(y),y}}}var kN=(e,r,a)=>{var l=KM(r);if(!(a!=="auto"&&a!=="linear")){if(r!=null&&r.tickCount&&Array.isArray(l)&&(l[0]==="auto"||l[1]==="auto")&&Z_(e))return Yse(e,r.tickCount,r.allowDecimals);if(r!=null&&r.tickCount&&r.type==="number"&&Z_(e))return Qse(e,r.tickCount,r.allowDecimals)}},tI=Pr([JM,Dx,kx],kN),zN=(e,r,a,l)=>{if(l!=="angleAxis"&&e?.type==="number"&&Z_(r)&&Array.isArray(a)&&a.length>0){var m=r[0],y=a[0],T=r[1],i=a[a.length-1];return[Math.min(m,y),Math.max(T,i)]}return r},Mle=Pr([Oh,JM,tI,_l],zN),Ile=Pr(R2,Oh,(e,r)=>{if(!(!r||r.type!=="number")){var a=1/0,l=Array.from(Eg(e.map(i=>i.value))).sort((i,z)=>i-z);if(l.length<2)return 1/0;var m=l[l.length-1]-l[0];if(m===0)return 1/0;for(var y=0;y<l.length-1;y++){var T=l[y+1]-l[y];a=Math.min(a,T)}return a/m}}),LN=Pr(Ile,Ya,Kse,vc,(e,r,a,l)=>l,(e,r,a,l,m)=>{if(!qu(e))return 0;var y=r==="vertical"?l.height:l.width;if(m==="gap")return e*y/2;if(m==="no-gap"){var T=s0(a,e*y),i=e*y/2;return i-T-(i-T)/y*T}return 0}),Ple=(e,r)=>{var a=iA(e,r);return a==null||typeof a.padding!="string"?0:LN(e,"xAxis",r,a.padding)},Rle=(e,r)=>{var a=oA(e,r);return a==null||typeof a.padding!="string"?0:LN(e,"yAxis",r,a.padding)},Dle=Pr(iA,Ple,(e,r)=>{var a,l;if(e==null)return{left:0,right:0};var{padding:m}=e;return typeof m=="string"?{left:r,right:r}:{left:((a=m.left)!==null&&a!==void 0?a:0)+r,right:((l=m.right)!==null&&l!==void 0?l:0)+r}}),Ole=Pr(oA,Rle,(e,r)=>{var a,l;if(e==null)return{top:0,bottom:0};var{padding:m}=e;return typeof m=="string"?{top:r,bottom:r}:{top:((a=m.top)!==null&&a!==void 0?a:0)+r,bottom:((l=m.bottom)!==null&&l!==void 0?l:0)+r}}),kle=Pr([vc,Dle,y2,_2,(e,r,a)=>a],(e,r,a,l,m)=>{var{padding:y}=l;return m?[y.left,a.width-y.right]:[e.left+r.left,e.left+e.width-r.right]}),zle=Pr([vc,Ya,Ole,y2,_2,(e,r,a)=>a],(e,r,a,l,m,y)=>{var{padding:T}=m;return y?[l.height-T.bottom,T.top]:r==="horizontal"?[e.top+e.height-a.bottom,e.top+a.top]:[e.top+a.top,e.top+e.height-a.bottom]}),zx=(e,r,a,l)=>{var m;switch(r){case"xAxis":return kle(e,a,l);case"yAxis":return zle(e,a,l);case"zAxis":return(m=YM(e,a))===null||m===void 0?void 0:m.range;case"angleAxis":return nN(e);case"radiusAxis":return iN(e,a);default:return}},BN=Pr([Oh,zx],M2),py=Pr([Oh,kx,Mle,BN],eI);Pr([Ox,D2,_l],SN);function FN(e,r){return e.id<r.id?-1:e.id>r.id?1:0}var O2=(e,r)=>r,k2=(e,r,a)=>a,Lle=Pr(A2,O2,k2,(e,r,a)=>e.filter(l=>l.orientation===r).filter(l=>l.mirror===a).sort(FN)),Ble=Pr(g2,O2,k2,(e,r,a)=>e.filter(l=>l.orientation===r).filter(l=>l.mirror===a).sort(FN)),NN=(e,r)=>({width:e.width,height:r.height}),Fle=(e,r)=>{var a=typeof r.width=="number"?r.width:Cx;return{width:a,height:e.height}},Nle=Pr(vc,iA,NN),jle=(e,r,a)=>{switch(r){case"top":return e.top;case"bottom":return a-e.bottom;default:return 0}},Ule=(e,r,a)=>{switch(r){case"left":return e.left;case"right":return a-e.right;default:return 0}},Vle=Pr(rA,vc,Lle,O2,k2,(e,r,a,l,m)=>{var y={},T;return a.forEach(i=>{var z=NN(r,i);T==null&&(T=jle(r,l,e));var B=l==="top"&&!m||l==="bottom"&&m;y[i.id]=T-Number(B)*z.height,T+=(B?-1:1)*z.height}),y}),$le=Pr(tA,vc,Ble,O2,k2,(e,r,a,l,m)=>{var y={},T;return a.forEach(i=>{var z=Fle(r,i);T==null&&(T=Ule(r,l,e));var B=l==="left"&&!m||l==="right"&&m;y[i.id]=T-Number(B)*z.width,T+=(B?-1:1)*z.width}),y}),Gle=(e,r)=>{var a=iA(e,r);if(a!=null)return Vle(e,a.orientation,a.mirror)},Hle=Pr([vc,iA,Gle,(e,r)=>r],(e,r,a,l)=>{if(r!=null){var m=a?.[l];return m==null?{x:e.left,y:0}:{x:e.left,y:m}}}),qle=(e,r)=>{var a=oA(e,r);if(a!=null)return $le(e,a.orientation,a.mirror)},Wle=Pr([vc,oA,qle,(e,r)=>r],(e,r,a,l)=>{if(r!=null){var m=a?.[l];return m==null?{x:0,y:e.top}:{x:m,y:e.top}}}),Zle=Pr(vc,oA,(e,r)=>{var a=typeof r.width=="number"?r.width:Cx;return{width:a,height:e.height}}),jN=(e,r,a,l)=>{if(a!=null){var{allowDuplicatedCategory:m,type:y,dataKey:T}=a,i=eA(e,l),z=r.map(B=>B.value);if(T&&i&&y==="category"&&m&&H5(z))return z}},rI=Pr([Ya,R2,Oh,_l],jN),UN=(e,r,a,l)=>{if(!(a==null||a.dataKey==null)){var{type:m,scale:y}=a,T=eA(e,l);if(T&&(m==="number"||y!=="auto"))return r.map(i=>i.value)}},nI=Pr([Ya,R2,Dx,_l],UN);Pr([Ya,lle,kx,py,rI,nI,zx,tI,_l],(e,r,a,l,m,y,T,i,z)=>{if(r==null)return null;var B=eA(e,z);return{angle:r.angle,interval:r.interval,minTickGap:r.minTickGap,orientation:r.orientation,tick:r.tick,tickCount:r.tickCount,tickFormatter:r.tickFormatter,ticks:r.ticks,type:r.type,unit:r.unit,axisType:z,categoricalDomain:y,duplicateDomain:m,isCategorical:B,niceTicks:i,range:T,realScaleType:a,scale:l}});var Xle=(e,r,a,l,m,y,T,i,z)=>{if(!(r==null||l==null)){var B=eA(e,z),{type:F,ticks:G,tickCount:Q}=r,te=a==="scaleBand"&&typeof l.bandwidth=="function"?l.bandwidth()/2:2,ne=F==="category"&&l.bandwidth?l.bandwidth()/te:0;ne=z==="angleAxis"&&y!=null&&y.length>=2?qd(y[0]-y[1])*2*ne:ne;var oe=G||m;if(oe){var ue=oe.map((ye,we)=>{var ve=T?T.indexOf(ye):ye;return{index:we,coordinate:l(ve)+ne,value:ye,offset:ne}});return ue.filter(ye=>!ad(ye.coordinate))}return B&&i?i.map((ye,we)=>({coordinate:l(ye)+ne,value:ye,index:we,offset:ne})):l.ticks?l.ticks(Q).map(ye=>({coordinate:l(ye)+ne,value:ye,offset:ne})):l.domain().map((ye,we)=>({coordinate:l(ye)+ne,value:T?T[ye]:ye,index:we,offset:ne}))}},VN=Pr([Ya,Dx,kx,py,tI,zx,rI,nI,_l],Xle),Yle=(e,r,a,l,m,y,T)=>{if(!(r==null||a==null||l==null||l[0]===l[1])){var i=eA(e,T),{tickCount:z}=r,B=0;return B=T==="angleAxis"&&l?.length>=2?qd(l[0]-l[1])*2*B:B,i&&y?y.map((F,G)=>({coordinate:a(F)+B,value:F,index:G,offset:B})):a.ticks?a.ticks(z).map(F=>({coordinate:a(F)+B,value:F,offset:B})):a.domain().map((F,G)=>({coordinate:a(F)+B,value:m?m[F]:F,index:G,offset:B}))}},$N=Pr([Ya,Dx,py,zx,rI,nI,_l],Yle),GN=Pr(Oh,py,(e,r)=>{if(!(e==null||r==null))return gw(gw({},e),{},{scale:r})}),Qle=Pr([Oh,kx,JM,BN],eI);Pr((e,r,a)=>YM(e,a),Qle,(e,r)=>{if(!(e==null||r==null))return gw(gw({},e),{},{scale:r})});var Kle=Pr([Ya,A2,g2],(e,r,a)=>{switch(e){case"horizontal":return r.some(l=>l.reversed)?"right-to-left":"left-to-right";case"vertical":return a.some(l=>l.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),HN=e=>e.options.defaultTooltipEventType,qN=e=>e.options.validateTooltipEventTypes;function WN(e,r,a){if(e==null)return r;var l=e?"axis":"item";return a==null?r:a.includes(l)?l:r}function iI(e,r){var a=HN(e),l=qN(e);return WN(r,a,l)}function Jle(e){return ji(r=>iI(r,e))}var ZN=(e,r)=>{var a,l=Number(r);if(!(ad(l)||r==null))return l>=0?e==null||(a=e[l])===null||a===void 0?void 0:a.value:void 0},ece=e=>e.tooltip.settings,t0={active:!1,index:null,dataKey:void 0,coordinate:void 0},tce={itemInteraction:{click:t0,hover:t0},axisInteraction:{click:t0,hover:t0},keyboardInteraction:t0,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},XN=Mf({name:"tooltip",initialState:tce,reducers:{addTooltipEntrySettings(e,r){e.tooltipItemPayloads.push(r.payload)},removeTooltipEntrySettings(e,r){var a=Um(e).tooltipItemPayloads.indexOf(r.payload);a>-1&&e.tooltipItemPayloads.splice(a,1)},setTooltipSettingsState(e,r){e.settings=r.payload},setActiveMouseOverItemIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=r.payload.activeIndex,e.itemInteraction.hover.dataKey=r.payload.activeDataKey,e.itemInteraction.hover.coordinate=r.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,r){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=r.payload.activeIndex,e.itemInteraction.click.dataKey=r.payload.activeDataKey,e.itemInteraction.click.coordinate=r.payload.activeCoordinate},setMouseOverAxisIndex(e,r){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=r.payload.activeIndex,e.axisInteraction.hover.dataKey=r.payload.activeDataKey,e.axisInteraction.hover.coordinate=r.payload.activeCoordinate},setMouseClickAxisIndex(e,r){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=r.payload.activeIndex,e.axisInteraction.click.dataKey=r.payload.activeDataKey,e.axisInteraction.click.coordinate=r.payload.activeCoordinate},setSyncInteraction(e,r){e.syncInteraction=r.payload},setKeyboardInteraction(e,r){e.keyboardInteraction.active=r.payload.active,e.keyboardInteraction.index=r.payload.activeIndex,e.keyboardInteraction.coordinate=r.payload.activeCoordinate,e.keyboardInteraction.dataKey=r.payload.activeDataKey}}}),{addTooltipEntrySettings:rce,removeTooltipEntrySettings:nce,setTooltipSettingsState:ice,setActiveMouseOverItemIndex:oce,mouseLeaveItem:xAe,mouseLeaveChart:YN,setActiveClickItemIndex:bAe,setMouseOverAxisIndex:QN,setMouseClickAxisIndex:ace,setSyncInteraction:YC,setKeyboardInteraction:QC}=XN.actions,sce=XN.reducer;function kz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function yb(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?kz(Object(a),!0).forEach(function(l){lce(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):kz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function lce(e,r,a){return(r=cce(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function cce(e){var r=uce(e,"string");return typeof r=="symbol"?r:r+""}function uce(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function hce(e,r,a){return r==="axis"?a==="click"?e.axisInteraction.click:e.axisInteraction.hover:a==="click"?e.itemInteraction.click:e.itemInteraction.hover}function fce(e){return e.index!=null}var KN=(e,r,a,l)=>{if(r==null)return t0;var m=hce(e,r,a);if(m==null)return t0;if(m.active)return m;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var y=e.settings.active===!0;if(fce(m)){if(y)return yb(yb({},m),{},{active:!0})}else if(l!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:l};return yb(yb({},t0),{},{coordinate:m.coordinate})},oI=(e,r)=>{var a=e?.index;if(a==null)return null;var l=Number(a);if(!qu(l))return a;var m=0,y=1/0;return r.length>0&&(y=r.length-1),String(Math.max(m,Math.min(l,y)))},JN=(e,r,a,l,m,y,T,i)=>{if(!(y==null||i==null)){var z=T[0],B=z==null?void 0:i(z.positions,y);if(B!=null)return B;var F=m?.[Number(y)];if(F)switch(a){case"horizontal":return{x:F.coordinate,y:(l.top+r)/2};default:return{x:(l.left+e)/2,y:F.coordinate}}}},e8=(e,r,a,l)=>{if(r==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var m;return a==="hover"?m=e.itemInteraction.hover.dataKey:m=e.itemInteraction.click.dataKey,m==null&&l!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(y=>{var T;return((T=y.settings)===null||T===void 0?void 0:T.dataKey)===m})},Lx=e=>e.options.tooltipPayloadSearcher,my=e=>e.tooltip;function zz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Lz(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?zz(Object(a),!0).forEach(function(l){dce(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):zz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function dce(e,r,a){return(r=pce(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function pce(e){var r=mce(e,"string");return typeof r=="symbol"?r:r+""}function mce(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ace(e,r){return e??r}var t8=(e,r,a,l,m,y,T)=>{if(!(r==null||y==null)){var{chartData:i,computedData:z,dataStartIndex:B,dataEndIndex:F}=a,G=[];return e.reduce((Q,te)=>{var ne,{dataDefinedOnItem:oe,settings:ue}=te,ye=Ace(oe,i),we=Array.isArray(ye)?qF(ye,B,F):ye,ve=(ne=ue?.dataKey)!==null&&ne!==void 0?ne:l,Ce=ue?.nameKey,Ee;if(l&&Array.isArray(we)&&!Array.isArray(we[0])&&T==="axis"?Ee=q5(we,l,m):Ee=y(we,r,z,Ce),Array.isArray(Ee))Ee.forEach(Ke=>{var st=Lz(Lz({},ue),{},{name:Ke.name,unit:Ke.unit,color:void 0,fill:void 0});Q.push(b4({tooltipEntrySettings:st,dataKey:Ke.dataKey,payload:Ke.payload,value:Hu(Ke.payload,Ke.dataKey),name:Ke.name}))});else{var Be;Q.push(b4({tooltipEntrySettings:ue,dataKey:ve,payload:Ee,value:Hu(Ee,ve),name:(Be=Hu(Ee,Ce))!==null&&Be!==void 0?Be:ue?.name}))}return Q},G)}},aI=Pr([ic,Ya,uN,VM,jl],ON),gce=Pr([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,r)=>[...e,...r]),_ce=Pr([jl,fy],hN),Bx=Pr([gce,ic,_ce],dN),yce=Pr([Bx],e=>e.filter(XM)),vce=Pr([Bx],gN),Ay=Pr([vce,d0],_N),xce=Pr([yce,d0,ic],sN),sI=Pr([Ay,ic,Bx],yN),bce=Pr([ic],KM),wce=Pr([Bx],e=>e.filter(XM)),Sce=Pr([xce,wce,C2],xN),Tce=Pr([Sce,d0,jl],bN),Ece=Pr([Bx],mN),Cce=Pr([Ay,ic,Ece,D2,jl],wN),Mce=Pr([TN,jl,fy],dy),Ice=Pr([Mce,jl],MN),Pce=Pr([EN,jl,fy],dy),Rce=Pr([Pce,jl],IN),Dce=Pr([CN,jl,fy],dy),Oce=Pr([Dce,jl],PN),kce=Pr([Ice,Oce,Rce],_w),zce=Pr([ic,bce,Tce,Cce,kce,Ya,jl],RN),r8=Pr([ic,Ya,Ay,sI,C2,jl,zce],DN),Lce=Pr([r8,ic,aI],kN),Bce=Pr([ic,r8,Lce,jl],zN),n8=e=>{var r=jl(e),a=fy(e),l=!1;return zx(e,r,a,l)},i8=Pr([ic,n8],M2),o8=Pr([ic,aI,Bce,i8],eI),Fce=Pr([Ya,sI,ic,jl],jN),Nce=Pr([Ya,sI,ic,jl],UN),jce=(e,r,a,l,m,y,T,i)=>{if(r){var{type:z}=r,B=eA(e,i);if(l){var F=a==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,G=z==="category"&&l.bandwidth?l.bandwidth()/F:0;return G=i==="angleAxis"&&m!=null&&m?.length>=2?qd(m[0]-m[1])*2*G:G,B&&T?T.map((Q,te)=>({coordinate:l(Q)+G,value:Q,index:te,offset:G})):l.domain().map((Q,te)=>({coordinate:l(Q)+G,value:y?y[Q]:Q,index:te,offset:G}))}}},aA=Pr([Ya,ic,aI,o8,n8,Fce,Nce,jl],jce),lI=Pr([HN,qN,ece],(e,r,a)=>WN(a.shared,e,r)),a8=e=>e.tooltip.settings.trigger,cI=e=>e.tooltip.settings.defaultIndex,z2=Pr([my,lI,a8,cI],KN),nx=Pr([z2,Ay],oI),s8=Pr([aA,nx],ZN),Uce=Pr([z2],e=>{if(e)return e.dataKey}),l8=Pr([my,lI,a8,cI],e8),Vce=Pr([tA,rA,Ya,vc,aA,cI,l8,Lx],JN),$ce=Pr([z2,Vce],(e,r)=>e!=null&&e.coordinate?e.coordinate:r),Gce=Pr([z2],e=>e.active),Hce=Pr([l8,nx,d0,aN,s8,Lx,lI],t8),qce=Pr([Hce],e=>{if(e!=null){var r=e.map(a=>a.payload).filter(a=>a!=null);return Array.from(new Set(r))}});function Bz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Fz(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Bz(Object(a),!0).forEach(function(l){Wce(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Bz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Wce(e,r,a){return(r=Zce(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Zce(e){var r=Xce(e,"string");return typeof r=="symbol"?r:r+""}function Xce(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Yce=()=>ji(ic),Qce=()=>{var e=Yce(),r=ji(aA),a=ji(o8);return DC(Fz(Fz({},e),{},{scale:a}),r)},c8=()=>ji(VM),uI=(e,r)=>r,u8=(e,r,a)=>a,hI=(e,r,a,l)=>l,Kce=Pr(aA,e=>u2(e,r=>r.coordinate)),fI=Pr([my,uI,u8,hI],KN),h8=Pr([fI,Ay],oI),Jce=(e,r,a)=>{if(r!=null){var l=my(e);return r==="axis"?a==="hover"?l.axisInteraction.hover.dataKey:l.axisInteraction.click.dataKey:a==="hover"?l.itemInteraction.hover.dataKey:l.itemInteraction.click.dataKey}},f8=Pr([my,uI,u8,hI],e8),yw=Pr([tA,rA,Ya,vc,aA,hI,f8,Lx],JN),eue=Pr([fI,yw],(e,r)=>{var a;return(a=e.coordinate)!==null&&a!==void 0?a:r}),d8=Pr(aA,h8,ZN),tue=Pr([f8,h8,d0,aN,d8,Lx,uI],t8),rue=Pr([fI],e=>({isActive:e.active,activeIndex:e.index})),nue=(e,r,a,l,m,y,T,i)=>{if(!(!e||!r||!l||!m||!y)){var z=Tne(e.chartX,e.chartY,r,a,i);if(z){var B=Cne(z,r),F=pne(B,T,y,l,m),G=Ene(r,y,F,z);return{activeIndex:String(F),activeCoordinate:G}}}};function KC(){return KC=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},KC.apply(null,arguments)}function Nz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function vb(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Nz(Object(a),!0).forEach(function(l){iue(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Nz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function iue(e,r,a){return(r=oue(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function oue(e){var r=aue(e,"string");return typeof r=="symbol"?r:r+""}function aue(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function sue(e){var{coordinate:r,payload:a,index:l,offset:m,tooltipAxisBandSize:y,layout:T,cursor:i,tooltipEventType:z,chartName:B}=e,F=r,G=a,Q=l;if(!i||!F||B!=="ScatterChart"&&z!=="axis")return null;var te,ne;if(B==="ScatterChart")te=F,ne=xie;else if(B==="BarChart")te=bie(T,F,m,y),ne=Jie;else if(T==="radial"){var{cx:oe,cy:ue,radius:ye,startAngle:we,endAngle:ve}=n6(F);te={cx:oe,cy:ue,startAngle:we,endAngle:ve,innerRadius:ye,outerRadius:ye},ne=noe}else te={points:ioe(T,F,m)},ne=Rb;var Ce=typeof i=="object"&&"className"in i?i.className:void 0,Ee=vb(vb(vb(vb({stroke:"#ccc",pointerEvents:"none"},m),te),Jc(i,!1)),{},{payload:G,payloadIndex:Q,className:on("recharts-tooltip-cursor",Ce)});return ae.isValidElement(i)?ae.cloneElement(i,Ee):ae.createElement(ne,Ee)}function lue(e){var r=Qce(),a=Vne(),l=mM(),m=c8();return ae.createElement(sue,KC({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:a,layout:l,tooltipAxisBandSize:r,chartName:m}))}var p8=ae.createContext(null),cue=()=>ae.useContext(p8),SE={exports:{}},jz;function uue(){return jz||(jz=1,(function(e){var r=Object.prototype.hasOwnProperty,a="~";function l(){}Object.create&&(l.prototype=Object.create(null),new l().__proto__||(a=!1));function m(z,B,F){this.fn=z,this.context=B,this.once=F||!1}function y(z,B,F,G,Q){if(typeof F!="function")throw new TypeError("The listener must be a function");var te=new m(F,G||z,Q),ne=a?a+B:B;return z._events[ne]?z._events[ne].fn?z._events[ne]=[z._events[ne],te]:z._events[ne].push(te):(z._events[ne]=te,z._eventsCount++),z}function T(z,B){--z._eventsCount===0?z._events=new l:delete z._events[B]}function i(){this._events=new l,this._eventsCount=0}i.prototype.eventNames=function(){var B=[],F,G;if(this._eventsCount===0)return B;for(G in F=this._events)r.call(F,G)&&B.push(a?G.slice(1):G);return Object.getOwnPropertySymbols?B.concat(Object.getOwnPropertySymbols(F)):B},i.prototype.listeners=function(B){var F=a?a+B:B,G=this._events[F];if(!G)return[];if(G.fn)return[G.fn];for(var Q=0,te=G.length,ne=new Array(te);Q<te;Q++)ne[Q]=G[Q].fn;return ne},i.prototype.listenerCount=function(B){var F=a?a+B:B,G=this._events[F];return G?G.fn?1:G.length:0},i.prototype.emit=function(B,F,G,Q,te,ne){var oe=a?a+B:B;if(!this._events[oe])return!1;var ue=this._events[oe],ye=arguments.length,we,ve;if(ue.fn){switch(ue.once&&this.removeListener(B,ue.fn,void 0,!0),ye){case 1:return ue.fn.call(ue.context),!0;case 2:return ue.fn.call(ue.context,F),!0;case 3:return ue.fn.call(ue.context,F,G),!0;case 4:return ue.fn.call(ue.context,F,G,Q),!0;case 5:return ue.fn.call(ue.context,F,G,Q,te),!0;case 6:return ue.fn.call(ue.context,F,G,Q,te,ne),!0}for(ve=1,we=new Array(ye-1);ve<ye;ve++)we[ve-1]=arguments[ve];ue.fn.apply(ue.context,we)}else{var Ce=ue.length,Ee;for(ve=0;ve<Ce;ve++)switch(ue[ve].once&&this.removeListener(B,ue[ve].fn,void 0,!0),ye){case 1:ue[ve].fn.call(ue[ve].context);break;case 2:ue[ve].fn.call(ue[ve].context,F);break;case 3:ue[ve].fn.call(ue[ve].context,F,G);break;case 4:ue[ve].fn.call(ue[ve].context,F,G,Q);break;default:if(!we)for(Ee=1,we=new Array(ye-1);Ee<ye;Ee++)we[Ee-1]=arguments[Ee];ue[ve].fn.apply(ue[ve].context,we)}}return!0},i.prototype.on=function(B,F,G){return y(this,B,F,G,!1)},i.prototype.once=function(B,F,G){return y(this,B,F,G,!0)},i.prototype.removeListener=function(B,F,G,Q){var te=a?a+B:B;if(!this._events[te])return this;if(!F)return T(this,te),this;var ne=this._events[te];if(ne.fn)ne.fn===F&&(!Q||ne.once)&&(!G||ne.context===G)&&T(this,te);else{for(var oe=0,ue=[],ye=ne.length;oe<ye;oe++)(ne[oe].fn!==F||Q&&!ne[oe].once||G&&ne[oe].context!==G)&&ue.push(ne[oe]);ue.length?this._events[te]=ue.length===1?ue[0]:ue:T(this,te)}return this},i.prototype.removeAllListeners=function(B){var F;return B?(F=a?a+B:B,this._events[F]&&T(this,F)):(this._events=new l,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=a,i.EventEmitter=i,e.exports=i})(SE)),SE.exports}var hue=uue();const fue=Zp(hue);var ix=new fue,JC="recharts.syncEvent.tooltip",Uz="recharts.syncEvent.brush";function due(e,r){if(r){var a=Number.parseInt(r,10);if(!ad(a))return e?.[a]}}var pue={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},m8=Mf({name:"options",initialState:pue,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),mue=m8.reducer,{createEventEmitter:Aue}=m8.actions;function gue(e){return e.tooltip.syncInteraction}var _ue={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},A8=Mf({name:"chartData",initialState:_ue,reducers:{setChartData(e,r){if(e.chartData=r.payload,r.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}r.payload.length>0&&e.dataEndIndex!==r.payload.length-1&&(e.dataEndIndex=r.payload.length-1)},setComputedData(e,r){e.computedData=r.payload},setDataStartEndIndexes(e,r){var{startIndex:a,endIndex:l}=r.payload;a!=null&&(e.dataStartIndex=a),l!=null&&(e.dataEndIndex=l)}}}),{setChartData:Vz,setDataStartEndIndexes:yue,setComputedData:wAe}=A8.actions,vue=A8.reducer,xue=["x","y"];function $z(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function K0(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?$z(Object(a),!0).forEach(function(l){bue(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$z(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function bue(e,r,a){return(r=wue(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function wue(e){var r=Sue(e,"string");return typeof r=="symbol"?r:r+""}function Sue(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Tue(e,r){if(e==null)return{};var a,l,m=Eue(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Eue(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var g8=()=>{};function Cue(){var e=ji($M),r=ji(GM),a=Wu(),l=ji(eN),m=ji(aA),y=mM(),T=pM(),i=ji(z=>z.rootProps.className);ae.useEffect(()=>{if(e==null)return g8;var z=(B,F,G)=>{if(r!==G&&e===B){if(l==="index"){var Q;if(T&&F!==null&&F!==void 0&&(Q=F.payload)!==null&&Q!==void 0&&Q.coordinate){var te=F.payload.coordinate,{x:ne,y:oe}=te,ue=Tue(te,xue),ye=K0(K0(K0({},ue),typeof ne=="number"&&{x:Math.max(T.x,Math.min(ne,T.x+T.width))}),typeof oe=="number"&&{y:Math.max(T.y,Math.min(oe,T.y+T.height))}),we=K0(K0({},F),{},{payload:K0(K0({},F.payload),{},{coordinate:ye})});a(we)}else a(F);return}if(m!=null){var ve;if(typeof l=="function"){var Ce={activeTooltipIndex:F.payload.index==null?void 0:Number(F.payload.index),isTooltipActive:F.payload.active,activeIndex:F.payload.index==null?void 0:Number(F.payload.index),activeLabel:F.payload.label,activeDataKey:F.payload.dataKey,activeCoordinate:F.payload.coordinate},Ee=l(m,Ce);ve=m[Ee]}else l==="value"&&(ve=m.find(Pt=>String(Pt.value)===F.payload.label));var{coordinate:Be}=F.payload;if(ve==null||F.payload.active===!1||Be==null||T==null){a(YC({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:Ke,y:st}=Be,dt=Math.min(Ke,T.x+T.width),bt=Math.min(st,T.y+T.height),ht={x:y==="horizontal"?ve.coordinate:dt,y:y==="horizontal"?bt:ve.coordinate},Re=YC({active:F.payload.active,coordinate:ht,dataKey:F.payload.dataKey,index:String(ve.index),label:F.payload.label});a(Re)}}};return ix.on(JC,z),()=>{ix.off(JC,z)}},[i,a,r,e,l,m,y,T])}function Mue(){var e=ji($M),r=ji(GM),a=Wu();ae.useEffect(()=>{if(e==null)return g8;var l=(m,y,T)=>{r!==T&&e===m&&a(yue(y))};return ix.on(Uz,l),()=>{ix.off(Uz,l)}},[a,r,e])}function Iue(){var e=Wu();ae.useEffect(()=>{e(Aue())},[e]),Cue(),Mue()}function Pue(e,r,a,l,m,y){var T=ji(Q=>Jce(Q,e,r)),i=ji(GM),z=ji($M),B=ji(eN),F=ji(gue),G=F?.active;ae.useEffect(()=>{if(!G&&z!=null&&i!=null){var Q=YC({active:y,coordinate:a,dataKey:T,index:m,label:typeof l=="number"?String(l):l});ix.emit(JC,z,Q,i)}},[G,a,T,m,l,i,z,B,y])}function Gz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Hz(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Gz(Object(a),!0).forEach(function(l){Rue(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Gz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Rue(e,r,a){return(r=Due(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Due(e){var r=Oue(e,"string");return typeof r=="symbol"?r:r+""}function Oue(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function kue(e){return e.dataKey}function zue(e,r){return ae.isValidElement(e)?ae.cloneElement(e,r):typeof e=="function"?ae.createElement(e,r):ae.createElement(Jne,r)}var qz=[],Lue={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!ly.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Bue(e){var r=tp(e,Lue),{active:a,allowEscapeViewBox:l,animationDuration:m,animationEasing:y,content:T,filterNull:i,isAnimationActive:z,offset:B,payloadUniqBy:F,position:G,reverseDirection:Q,useTranslate3d:te,wrapperStyle:ne,cursor:oe,shared:ue,trigger:ye,defaultIndex:we,portal:ve,axisId:Ce}=r,Ee=Wu(),Be=typeof we=="number"?String(we):we;ae.useEffect(()=>{Ee(ice({shared:ue,trigger:ye,axisId:Ce,active:a,defaultIndex:Be}))},[Ee,ue,ye,Ce,a,Be]);var Ke=pM(),st=QF(),dt=Jle(ue),{activeIndex:bt,isActive:ht}=ji(tn=>rue(tn,dt,ye,Be)),Re=ji(tn=>tue(tn,dt,ye,Be)),Pt=ji(tn=>d8(tn,dt,ye,Be)),wt=ji(tn=>eue(tn,dt,ye,Be)),Et=Re,et=cue(),Zt=a??ht,[ir,or]=nre([Et,Zt]),ft=dt==="axis"?Pt:void 0;Pue(dt,ye,wt,ft,bt,Zt);var Vt=ve??et;if(Vt==null)return null;var Jt=Et??qz;Zt||(Jt=qz),i&&Jt.length&&(Jt=Ite(Et.filter(tn=>tn.value!=null&&(tn.hide!==!0||r.includeHidden)),F,kue));var Cr=Jt.length>0,ln=ae.createElement(aie,{allowEscapeViewBox:l,animationDuration:m,animationEasing:y,isAnimationActive:z,active:Zt,coordinate:wt,hasPayload:Cr,offset:B,position:G,reverseDirection:Q,useTranslate3d:te,viewBox:Ke,wrapperStyle:ne,lastBoundingBox:ir,innerRef:or,hasPortalFromProps:!!ve},zue(T,Hz(Hz({},r),{},{payload:Jt,label:ft,active:Zt,coordinate:wt,accessibilityLayer:st})));return ae.createElement(ae.Fragment,null,M3.createPortal(ln,Vt),Zt&&ae.createElement(lue,{cursor:oe,tooltipEventType:dt,coordinate:wt,payload:Et,index:bt}))}var TE={},EE={},CE={},Wz;function Fue(){return Wz||(Wz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a,l,{signal:m,edges:y}={}){let T,i=null;const z=y!=null&&y.includes("leading"),B=y==null||y.includes("trailing"),F=()=>{i!==null&&(a.apply(T,i),T=void 0,i=null)},G=()=>{B&&F(),oe()};let Q=null;const te=()=>{Q!=null&&clearTimeout(Q),Q=setTimeout(()=>{Q=null,G()},l)},ne=()=>{Q!==null&&(clearTimeout(Q),Q=null)},oe=()=>{ne(),T=void 0,i=null},ue=()=>{F()},ye=function(...we){if(m?.aborted)return;T=this,i=we;const ve=Q==null;te(),z&&ve&&F()};return ye.schedule=te,ye.cancel=oe,ye.flush=ue,m?.addEventListener("abort",oe,{once:!0}),ye}e.debounce=r})(CE)),CE}var Zz;function Nue(){return Zz||(Zz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Fue();function a(l,m=0,y={}){typeof y!="object"&&(y={});const{leading:T=!1,trailing:i=!0,maxWait:z}=y,B=Array(2);T&&(B[0]="leading"),i&&(B[1]="trailing");let F,G=null;const Q=r.debounce(function(...oe){F=l.apply(this,oe),G=null},m,{edges:B}),te=function(...oe){return z!=null&&(G===null&&(G=Date.now()),Date.now()-G>=z)?(F=l.apply(this,oe),G=Date.now(),Q.cancel(),Q.schedule(),F):(Q.apply(this,oe),F)},ne=()=>(Q.flush(),F);return te.cancel=Q.cancel,te.flush=ne,te}e.debounce=a})(EE)),EE}var Xz;function jue(){return Xz||(Xz=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=Nue();function a(l,m=0,y={}){const{leading:T=!0,trailing:i=!0}=y;return r.debounce(l,m,{leading:T,maxWait:m,trailing:i})}e.throttle=a})(TE)),TE}var ME,Yz;function Uue(){return Yz||(Yz=1,ME=jue().throttle),ME}var Vue=Uue();const $ue=Zp(Vue);var IE=function(r,a){for(var l=arguments.length,m=new Array(l>2?l-2:0),y=2;y<l;y++)m[y-2]=arguments[y]};function Qz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function PE(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Qz(Object(a),!0).forEach(function(l){Gue(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Gue(e,r,a){return(r=Hue(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Hue(e){var r=que(e,"string");return typeof r=="symbol"?r:r+""}function que(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Wue=ae.forwardRef((e,r)=>{var{aspect:a,initialDimension:l={width:-1,height:-1},width:m="100%",height:y="100%",minWidth:T=0,minHeight:i,maxHeight:z,children:B,debounce:F=0,id:G,className:Q,onResize:te,style:ne={}}=e,oe=ae.useRef(null),ue=ae.useRef();ue.current=te,ae.useImperativeHandle(r,()=>oe.current);var[ye,we]=ae.useState({containerWidth:l.width,containerHeight:l.height}),ve=ae.useCallback((Ee,Be)=>{we(Ke=>{var st=Math.round(Ee),dt=Math.round(Be);return Ke.containerWidth===st&&Ke.containerHeight===dt?Ke:{containerWidth:st,containerHeight:dt}})},[]);ae.useEffect(()=>{var Ee=dt=>{var bt,{width:ht,height:Re}=dt[0].contentRect;ve(ht,Re),(bt=ue.current)===null||bt===void 0||bt.call(ue,ht,Re)};F>0&&(Ee=$ue(Ee,F,{trailing:!0,leading:!1}));var Be=new ResizeObserver(Ee),{width:Ke,height:st}=oe.current.getBoundingClientRect();return ve(Ke,st),Be.observe(oe.current),()=>{Be.disconnect()}},[ve,F]);var Ce=ae.useMemo(()=>{var{containerWidth:Ee,containerHeight:Be}=ye;if(Ee<0||Be<0)return null;IE(sg(m)||sg(y),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,m,y),IE(!a||a>0,"The aspect(%s) must be greater than zero.",a);var Ke=sg(m)?Ee:m,st=sg(y)?Be:y;return a&&a>0&&(Ke?st=Ke/a:st&&(Ke=st*a),z&&st>z&&(st=z)),IE(Ke>0||st>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,Ke,st,m,y,T,i,a),ae.Children.map(B,dt=>ae.cloneElement(dt,{width:Ke,height:st,style:PE({width:Ke,height:st},dt.props.style)}))},[a,B,y,z,i,T,ye,m]);return ae.createElement("div",{id:G?"".concat(G):void 0,className:on("recharts-responsive-container",Q),style:PE(PE({},ne),{},{width:m,height:y,minWidth:T,minHeight:i,maxHeight:z}),ref:oe},ae.createElement("div",{style:{width:0,height:0,overflow:"visible"}},Ce))});function Zue(e,r,a){return(r=Xue(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Xue(e){var r=Yue(e,"string");return typeof r=="symbol"?r:r+""}function Yue(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class Que{constructor(r){Zue(this,"cache",new Map),this.maxSize=r}get(r){var a=this.cache.get(r);return a!==void 0&&(this.cache.delete(r),this.cache.set(r,a)),a}set(r,a){if(this.cache.has(r))this.cache.delete(r);else if(this.cache.size>=this.maxSize){var l=this.cache.keys().next().value;this.cache.delete(l)}this.cache.set(r,a)}clear(){this.cache.clear()}size(){return this.cache.size}}function Kz(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Kue(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?Kz(Object(a),!0).forEach(function(l){Jue(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Kz(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Jue(e,r,a){return(r=ehe(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function ehe(e){var r=the(e,"string");return typeof r=="symbol"?r:r+""}function the(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var rhe={cacheSize:2e3,enableCache:!0},_8=Kue({},rhe),Jz=new Que(_8.cacheSize),nhe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},eL="recharts_measurement_span";function ihe(e,r){var a=r.fontSize||"",l=r.fontFamily||"",m=r.fontWeight||"",y=r.fontStyle||"",T=r.letterSpacing||"",i=r.textTransform||"";return"".concat(e,"|").concat(a,"|").concat(l,"|").concat(m,"|").concat(y,"|").concat(T,"|").concat(i)}var tL=(e,r)=>{try{var a=document.getElementById(eL);a||(a=document.createElement("span"),a.setAttribute("id",eL),a.setAttribute("aria-hidden","true"),document.body.appendChild(a)),Object.assign(a.style,nhe,r),a.textContent="".concat(e);var l=a.getBoundingClientRect();return{width:l.width,height:l.height}}catch{return{width:0,height:0}}},Nv=function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r==null||ly.isSsr)return{width:0,height:0};if(!_8.enableCache)return tL(r,a);var l=ihe(r,a),m=Jz.get(l);if(m)return m;var y=tL(r,a);return Jz.set(l,y),y},rL=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,nL=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,ohe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,ahe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,y8={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},she=Object.keys(y8),P_="NaN";function lhe(e,r){return e*y8[r]}class Mh{static parse(r){var a,[,l,m]=(a=ahe.exec(r))!==null&&a!==void 0?a:[];return new Mh(parseFloat(l),m??"")}constructor(r,a){this.num=r,this.unit=a,this.num=r,this.unit=a,ad(r)&&(this.unit=""),a!==""&&!ohe.test(a)&&(this.num=NaN,this.unit=""),she.includes(a)&&(this.num=lhe(r,a),this.unit="px")}add(r){return this.unit!==r.unit?new Mh(NaN,""):new Mh(this.num+r.num,this.unit)}subtract(r){return this.unit!==r.unit?new Mh(NaN,""):new Mh(this.num-r.num,this.unit)}multiply(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new Mh(NaN,""):new Mh(this.num*r.num,this.unit||r.unit)}divide(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new Mh(NaN,""):new Mh(this.num/r.num,this.unit||r.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ad(this.num)}}function v8(e){if(e.includes(P_))return P_;for(var r=e;r.includes("*")||r.includes("/");){var a,[,l,m,y]=(a=rL.exec(r))!==null&&a!==void 0?a:[],T=Mh.parse(l??""),i=Mh.parse(y??""),z=m==="*"?T.multiply(i):T.divide(i);if(z.isNaN())return P_;r=r.replace(rL,z.toString())}for(;r.includes("+")||/.-\d+(?:\.\d+)?/.test(r);){var B,[,F,G,Q]=(B=nL.exec(r))!==null&&B!==void 0?B:[],te=Mh.parse(F??""),ne=Mh.parse(Q??""),oe=G==="+"?te.add(ne):te.subtract(ne);if(oe.isNaN())return P_;r=r.replace(nL,oe.toString())}return r}var iL=/\(([^()]*)\)/;function che(e){for(var r=e,a;(a=iL.exec(r))!=null;){var[,l]=a;r=r.replace(iL,v8(l))}return r}function uhe(e){var r=e.replace(/\s+/g,"");return r=che(r),r=v8(r),r}function hhe(e){try{return uhe(e)}catch{return P_}}function RE(e){var r=hhe(e.slice(5,-1));return r===P_?"":r}var fhe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],dhe=["dx","dy","angle","className","breakAll"];function e3(){return e3=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},e3.apply(null,arguments)}function oL(e,r){if(e==null)return{};var a,l,m=phe(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function phe(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var x8=/[ \f\n\r\t\v\u2028\u2029]+/,b8=e=>{var{children:r,breakAll:a,style:l}=e;try{var m=[];yc(r)||(a?m=r.toString().split(""):m=r.toString().split(x8));var y=m.map(i=>({word:i,width:Nv(i,l).width})),T=a?0:Nv("",l).width;return{wordsWithComputedWidth:y,spaceWidth:T}}catch{return null}},mhe=(e,r,a,l,m)=>{var{maxLines:y,children:T,style:i,breakAll:z}=e,B=oo(y),F=T,G=function(){var ht=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ht.reduce((Re,Pt)=>{var{word:wt,width:Et}=Pt,et=Re[Re.length-1];if(et&&(l==null||m||et.width+Et+a<Number(l)))et.words.push(wt),et.width+=Et+a;else{var Zt={words:[wt],width:Et};Re.push(Zt)}return Re},[])},Q=G(r),te=bt=>bt.reduce((ht,Re)=>ht.width>Re.width?ht:Re);if(!B||m)return Q;var ne=Q.length>y||te(Q).width>Number(l);if(!ne)return Q;for(var oe="",ue=bt=>{var ht=F.slice(0,bt),Re=b8({breakAll:z,style:i,children:ht+oe}).wordsWithComputedWidth,Pt=G(Re),wt=Pt.length>y||te(Pt).width>Number(l);return[wt,Pt]},ye=0,we=F.length-1,ve=0,Ce;ye<=we&&ve<=F.length-1;){var Ee=Math.floor((ye+we)/2),Be=Ee-1,[Ke,st]=ue(Be),[dt]=ue(Ee);if(!Ke&&!dt&&(ye=Ee+1),Ke&&dt&&(we=Ee-1),!Ke&&dt){Ce=st;break}ve++}return Ce||Q},aL=e=>{var r=yc(e)?[]:e.toString().split(x8);return[{words:r}]},Ahe=e=>{var{width:r,scaleToFit:a,children:l,style:m,breakAll:y,maxLines:T}=e;if((r||a)&&!ly.isSsr){var i,z,B=b8({breakAll:y,children:l,style:m});if(B){var{wordsWithComputedWidth:F,spaceWidth:G}=B;i=F,z=G}else return aL(l);return mhe({breakAll:y,children:l,maxLines:T,style:m},i,z,r,a)}return aL(l)},sL="#808080",dI=ae.forwardRef((e,r)=>{var{x:a=0,y:l=0,lineHeight:m="1em",capHeight:y="0.71em",scaleToFit:T=!1,textAnchor:i="start",verticalAnchor:z="end",fill:B=sL}=e,F=oL(e,fhe),G=ae.useMemo(()=>Ahe({breakAll:F.breakAll,children:F.children,maxLines:F.maxLines,scaleToFit:T,style:F.style,width:F.width}),[F.breakAll,F.children,F.maxLines,T,F.style,F.width]),{dx:Q,dy:te,angle:ne,className:oe,breakAll:ue}=F,ye=oL(F,dhe);if(!qp(a)||!qp(l)||G.length===0)return null;var we=a+(oo(Q)?Q:0),ve=l+(oo(te)?te:0),Ce;switch(z){case"start":Ce=RE("calc(".concat(y,")"));break;case"middle":Ce=RE("calc(".concat((G.length-1)/2," * -").concat(m," + (").concat(y," / 2))"));break;default:Ce=RE("calc(".concat(G.length-1," * -").concat(m,")"));break}var Ee=[];if(T){var Be=G[0].width,{width:Ke}=F;Ee.push("scale(".concat(oo(Ke)?Ke/Be:1,")"))}return ne&&Ee.push("rotate(".concat(ne,", ").concat(we,", ").concat(ve,")")),Ee.length&&(ye.transform=Ee.join(" ")),ae.createElement("text",e3({},Jc(ye,!0),{ref:r,x:we,y:ve,className:on("recharts-text",oe),textAnchor:i,fill:B.includes("url")?sL:B}),G.map((st,dt)=>{var bt=st.words.join(ue?"":" ");return ae.createElement("tspan",{x:we,dy:dt===0?Ce:m,key:"".concat(bt,"-").concat(dt)},bt)}))});dI.displayName="Text";var ghe=["labelRef"];function _he(e,r){if(e==null)return{};var a,l,m=yhe(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function yhe(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}function lL(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Ks(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?lL(Object(a),!0).forEach(function(l){vhe(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):lL(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function vhe(e,r,a){return(r=xhe(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function xhe(e){var r=bhe(e,"string");return typeof r=="symbol"?r:r+""}function bhe(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function zm(){return zm=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},zm.apply(null,arguments)}var w8=ae.createContext(null),whe=e=>{var{x:r,y:a,width:l,height:m,children:y}=e,T=ae.useMemo(()=>({x:r,y:a,width:l,height:m}),[r,a,l,m]);return ae.createElement(w8.Provider,{value:T},y)},S8=()=>{var e=ae.useContext(w8),r=pM();return e||r},She=ae.createContext(null),The=()=>{var e=ae.useContext(She),r=ji(oN);return e||r},Ehe=e=>{var{value:r,formatter:a}=e,l=yc(e.children)?r:e.children;return typeof a=="function"?a(l):l},pI=e=>e!=null&&typeof e=="function",Che=(e,r)=>{var a=qd(r-e),l=Math.min(Math.abs(r-e),360);return a*l},Mhe=(e,r,a,l,m)=>{var{offset:y,className:T}=e,{cx:i,cy:z,innerRadius:B,outerRadius:F,startAngle:G,endAngle:Q,clockWise:te}=m,ne=(B+F)/2,oe=Che(G,Q),ue=oe>=0?1:-1,ye,we;switch(r){case"insideStart":ye=G+ue*y,we=te;break;case"insideEnd":ye=Q-ue*y,we=!te;break;case"end":ye=Q+ue*y,we=te;break;default:throw new Error("Unsupported position ".concat(r))}we=oe<=0?we:!we;var ve=_c(i,z,ne,ye),Ce=_c(i,z,ne,ye+(we?1:-1)*359),Ee="M".concat(ve.x,",").concat(ve.y,`
    A`).concat(ne,",").concat(ne,",0,1,").concat(we?0:1,`,
    `).concat(Ce.x,",").concat(Ce.y),Be=yc(e.id)?Zv("recharts-radial-line-"):e.id;return ae.createElement("text",zm({},l,{dominantBaseline:"central",className:on("recharts-radial-bar-label",T)}),ae.createElement("defs",null,ae.createElement("path",{id:Be,d:Ee})),ae.createElement("textPath",{xlinkHref:"#".concat(Be)},a))},Ihe=(e,r,a)=>{var{cx:l,cy:m,innerRadius:y,outerRadius:T,startAngle:i,endAngle:z}=e,B=(i+z)/2;if(a==="outside"){var{x:F,y:G}=_c(l,m,T+r,B);return{x:F,y:G,textAnchor:F>=l?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:l,y:m,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:l,y:m,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:l,y:m,textAnchor:"middle",verticalAnchor:"end"};var Q=(y+T)/2,{x:te,y:ne}=_c(l,m,Q,B);return{x:te,y:ne,textAnchor:"middle",verticalAnchor:"middle"}},T8=e=>"cx"in e&&oo(e.cx),Phe=(e,r)=>{var{parentViewBox:a,offset:l,position:m}=e,y;a!=null&&!T8(a)&&(y=a);var{x:T,y:i,width:z,height:B}=r,F=B>=0?1:-1,G=F*l,Q=F>0?"end":"start",te=F>0?"start":"end",ne=z>=0?1:-1,oe=ne*l,ue=ne>0?"end":"start",ye=ne>0?"start":"end";if(m==="top"){var we={x:T+z/2,y:i-F*l,textAnchor:"middle",verticalAnchor:Q};return Ks(Ks({},we),y?{height:Math.max(i-y.y,0),width:z}:{})}if(m==="bottom"){var ve={x:T+z/2,y:i+B+G,textAnchor:"middle",verticalAnchor:te};return Ks(Ks({},ve),y?{height:Math.max(y.y+y.height-(i+B),0),width:z}:{})}if(m==="left"){var Ce={x:T-oe,y:i+B/2,textAnchor:ue,verticalAnchor:"middle"};return Ks(Ks({},Ce),y?{width:Math.max(Ce.x-y.x,0),height:B}:{})}if(m==="right"){var Ee={x:T+z+oe,y:i+B/2,textAnchor:ye,verticalAnchor:"middle"};return Ks(Ks({},Ee),y?{width:Math.max(y.x+y.width-Ee.x,0),height:B}:{})}var Be=y?{width:z,height:B}:{};return m==="insideLeft"?Ks({x:T+oe,y:i+B/2,textAnchor:ye,verticalAnchor:"middle"},Be):m==="insideRight"?Ks({x:T+z-oe,y:i+B/2,textAnchor:ue,verticalAnchor:"middle"},Be):m==="insideTop"?Ks({x:T+z/2,y:i+G,textAnchor:"middle",verticalAnchor:te},Be):m==="insideBottom"?Ks({x:T+z/2,y:i+B-G,textAnchor:"middle",verticalAnchor:Q},Be):m==="insideTopLeft"?Ks({x:T+oe,y:i+G,textAnchor:ye,verticalAnchor:te},Be):m==="insideTopRight"?Ks({x:T+z-oe,y:i+G,textAnchor:ue,verticalAnchor:te},Be):m==="insideBottomLeft"?Ks({x:T+oe,y:i+B-G,textAnchor:ye,verticalAnchor:Q},Be):m==="insideBottomRight"?Ks({x:T+z-oe,y:i+B-G,textAnchor:ue,verticalAnchor:Q},Be):m&&typeof m=="object"&&(oo(m.x)||sg(m.x))&&(oo(m.y)||sg(m.y))?Ks({x:T+s0(m.x,z),y:i+s0(m.y,B),textAnchor:"end",verticalAnchor:"end"},Be):Ks({x:T+z/2,y:i+B/2,textAnchor:"middle",verticalAnchor:"middle"},Be)},Rhe={offset:5};function e0(e){var r=tp(e,Rhe),{viewBox:a,position:l,value:m,children:y,content:T,className:i="",textBreakAll:z,labelRef:B}=r,F=The(),G=S8(),Q=l==="center"?G:F??G,te=a||Q;if(!te||yc(m)&&yc(y)&&!ae.isValidElement(T)&&typeof T!="function")return null;var ne=Ks(Ks({},r),{},{viewBox:te});if(ae.isValidElement(T)){var{labelRef:oe}=ne,ue=_he(ne,ghe);return ae.cloneElement(T,ue)}var ye;if(typeof T=="function"){if(ye=ae.createElement(T,ne),ae.isValidElement(ye))return ye}else ye=Ehe(r);var we=T8(te),ve=Jc(r,!0);if(we&&(l==="insideStart"||l==="insideEnd"||l==="end"))return Mhe(r,l,ye,ve,te);var Ce=we?Ihe(te,r.offset,r.position):Phe(r,te);return ae.createElement(dI,zm({ref:B,className:on("recharts-label",i)},ve,Ce,{breakAll:z}),ye)}e0.displayName="Label";var Dhe=(e,r,a)=>{if(!e)return null;var l={viewBox:r,labelRef:a};return e===!0?ae.createElement(e0,zm({key:"label-implicit"},l)):qp(e)?ae.createElement(e0,zm({key:"label-implicit",value:e},l)):ae.isValidElement(e)?e.type===e0?ae.cloneElement(e,Ks({key:"label-implicit"},l)):ae.createElement(e0,zm({key:"label-implicit",content:e},l)):pI(e)?ae.createElement(e0,zm({key:"label-implicit",content:e},l)):e&&typeof e=="object"?ae.createElement(e0,zm({},e,{key:"label-implicit"},l)):null};function Ohe(e){var{label:r}=e,a=S8();return Dhe(r,a)||null}var DE={},OE={},cL;function khe(){return cL||(cL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return a[a.length-1]}e.last=r})(OE)),OE}var kE={},uL;function zhe(){return uL||(uL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function r(a){return Array.isArray(a)?a:Array.from(a)}e.toArray=r})(kE)),kE}var hL;function Lhe(){return hL||(hL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const r=khe(),a=zhe(),l=aM();function m(y){if(l.isArrayLike(y))return r.last(a.toArray(y))}e.last=m})(DE)),DE}var zE,fL;function Bhe(){return fL||(fL=1,zE=Lhe().last),zE}var Fhe=Bhe();const Nhe=Zp(Fhe);var jhe=["valueAccessor"],Uhe=["dataKey","clockWise","id","textBreakAll"];function vw(){return vw=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},vw.apply(null,arguments)}function dL(e,r){if(e==null)return{};var a,l,m=Vhe(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Vhe(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var $he=e=>Array.isArray(e.value)?Nhe(e.value):e.value,E8=ae.createContext(void 0),Ghe=E8.Provider,C8=ae.createContext(void 0);C8.Provider;function Hhe(){return ae.useContext(E8)}function qhe(){return ae.useContext(C8)}function Db(e){var{valueAccessor:r=$he}=e,a=dL(e,jhe),{dataKey:l,clockWise:m,id:y,textBreakAll:T}=a,i=dL(a,Uhe),z=Hhe(),B=qhe(),F=z||B;return!F||!F.length?null:ae.createElement(Zm,{className:"recharts-label-list"},F.map((G,Q)=>{var te,ne=yc(l)?r(G,Q):Hu(G&&G.payload,l),oe=yc(y)?{}:{id:"".concat(y,"-").concat(Q)};return ae.createElement(e0,vw({},Jc(G,!0),i,oe,{fill:(te=a.fill)!==null&&te!==void 0?te:G.fill,parentViewBox:G.parentViewBox,value:ne,textBreakAll:T,viewBox:G.viewBox,key:"label-".concat(Q),index:Q}))}))}Db.displayName="LabelList";function Whe(e){var{label:r}=e;return r?r===!0?ae.createElement(Db,{key:"labelList-implicit"}):ae.isValidElement(r)||pI(r)?ae.createElement(Db,{key:"labelList-implicit",content:r}):typeof r=="object"?ae.createElement(Db,vw({key:"labelList-implicit"},r,{type:String(r.type)})):null:null}function t3(){return t3=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},t3.apply(null,arguments)}var M8=e=>{var{cx:r,cy:a,r:l,className:m}=e,y=on("recharts-dot",m);return r===+r&&a===+a&&l===+l?ae.createElement("circle",t3({},wg(e),iM(e),{className:y,cx:r,cy:a,r:l})):null},Zhe={radiusAxis:{},angleAxis:{}},I8=Mf({name:"polarAxis",initialState:Zhe,reducers:{addRadiusAxis(e,r){e.radiusAxis[r.payload.id]=r.payload},removeRadiusAxis(e,r){delete e.radiusAxis[r.payload.id]},addAngleAxis(e,r){e.angleAxis[r.payload.id]=r.payload},removeAngleAxis(e,r){delete e.angleAxis[r.payload.id]}}}),{addRadiusAxis:SAe,removeRadiusAxis:TAe,addAngleAxis:EAe,removeAngleAxis:CAe}=I8.actions,Xhe=I8.reducer;function Yhe(e){var{fn:r,args:a}=e,l=Wu(),m=ep();return ae.useEffect(()=>{if(!m){var y=r(a);return l(rce(y)),()=>{l(nce(y))}}},[r,a,l,m]),null}var Qhe=()=>{};function Khe(e){var{legendPayload:r}=e,a=Wu(),l=ep();return ae.useEffect(()=>l?Qhe:(a(qne(r)),()=>{a(Wne(r))}),[a,l,r]),null}var LE,Jhe=()=>{var[e]=ae.useState(()=>Zv("uid-"));return e},efe=(LE=zb.useId)!==null&&LE!==void 0?LE:Jhe;function tfe(e,r){var a=efe();return r||(e?"".concat(e,"-").concat(a):a)}var rfe=ae.createContext(void 0),nfe=e=>{var{id:r,type:a,children:l}=e,m=tfe("recharts-".concat(a),r);return ae.createElement(rfe.Provider,{value:m},l(m))},ife={cartesianItems:[],polarItems:[]},P8=Mf({name:"graphicalItems",initialState:ife,reducers:{addCartesianGraphicalItem(e,r){e.cartesianItems.push(r.payload)},replaceCartesianGraphicalItem(e,r){var{prev:a,next:l}=r.payload,m=Um(e).cartesianItems.indexOf(a);m>-1&&(e.cartesianItems[m]=l)},removeCartesianGraphicalItem(e,r){var a=Um(e).cartesianItems.indexOf(r.payload);a>-1&&e.cartesianItems.splice(a,1)},addPolarGraphicalItem(e,r){e.polarItems.push(r.payload)},removePolarGraphicalItem(e,r){var a=Um(e).polarItems.indexOf(r.payload);a>-1&&e.polarItems.splice(a,1)}}}),{addCartesianGraphicalItem:ofe,replaceCartesianGraphicalItem:afe,removeCartesianGraphicalItem:sfe,addPolarGraphicalItem:MAe,removePolarGraphicalItem:IAe}=P8.actions,lfe=P8.reducer;function cfe(e){var r=Wu(),a=ae.useRef(null);return ae.useEffect(()=>{a.current===null?r(ofe(e)):a.current!==e&&r(afe({prev:a.current,next:e})),a.current=e},[r,e]),ae.useEffect(()=>()=>{a.current&&(r(sfe(a.current)),a.current=null)},[r]),null}function pL(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function mL(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?pL(Object(a),!0).forEach(function(l){ufe(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):pL(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function ufe(e,r,a){return(r=hfe(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function hfe(e){var r=ffe(e,"string");return typeof r=="symbol"?r:r+""}function ffe(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var dfe={xAxis:{},yAxis:{},zAxis:{}},R8=Mf({name:"cartesianAxis",initialState:dfe,reducers:{addXAxis(e,r){e.xAxis[r.payload.id]=r.payload},removeXAxis(e,r){delete e.xAxis[r.payload.id]},addYAxis(e,r){e.yAxis[r.payload.id]=r.payload},removeYAxis(e,r){delete e.yAxis[r.payload.id]},addZAxis(e,r){e.zAxis[r.payload.id]=r.payload},removeZAxis(e,r){delete e.zAxis[r.payload.id]},updateYAxisWidth(e,r){var{id:a,width:l}=r.payload;e.yAxis[a]&&(e.yAxis[a]=mL(mL({},e.yAxis[a]),{},{width:l}))}}}),{addXAxis:pfe,removeXAxis:mfe,addYAxis:Afe,removeYAxis:gfe,addZAxis:PAe,removeZAxis:RAe,updateYAxisWidth:_fe}=R8.actions,yfe=R8.reducer,vfe=Pr([vc],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),xfe=Pr([vfe,tA,rA],(e,r,a)=>{if(!(!e||r==null||a==null))return{x:e.left,y:e.top,width:Math.max(0,r-e.left-e.right),height:Math.max(0,a-e.top-e.bottom)}}),mI=()=>ji(xfe),bfe=()=>ji(qce);function AL(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function gL(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?AL(Object(a),!0).forEach(function(l){wfe(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):AL(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function wfe(e,r,a){return(r=Sfe(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Sfe(e){var r=Tfe(e,"string");return typeof r=="symbol"?r:r+""}function Tfe(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Efe=e=>{var{point:r,childIndex:a,mainColor:l,activeDot:m,dataKey:y}=e;if(m===!1||r.x==null||r.y==null)return null;var T=gL(gL({index:a,dataKey:y,cx:r.x,cy:r.y,r:4,fill:l??"none",strokeWidth:2,stroke:"#fff",payload:r.payload,value:r.value},Jc(m,!1)),iM(m)),i;return ae.isValidElement(m)?i=ae.cloneElement(m,T):typeof m=="function"?i=m(T):i=ae.createElement(M8,T),ae.createElement(Zm,{className:"recharts-active-dot"},i)};function _L(e){var{points:r,mainColor:a,activeDot:l,itemDataKey:m}=e,y=ji(nx),T=bfe();if(r==null||T==null)return null;var i=r.find(z=>T.includes(z.payload));return yc(i)?null:Efe({point:i,childIndex:Number(y),mainColor:a,dataKey:m,activeDot:l})}var Cfe={},D8=Mf({name:"errorBars",initialState:Cfe,reducers:{addErrorBar:(e,r)=>{var{itemId:a,errorBar:l}=r.payload;e[a]||(e[a]=[]),e[a].push(l)},replaceErrorBar:(e,r)=>{var{itemId:a,prev:l,next:m}=r.payload;e[a]&&(e[a]=e[a].map(y=>y.dataKey===l.dataKey&&y.direction===l.direction?m:y))},removeErrorBar:(e,r)=>{var{itemId:a,errorBar:l}=r.payload;e[a]&&(e[a]=e[a].filter(m=>m.dataKey!==l.dataKey||m.direction!==l.direction))}}}),{addErrorBar:DAe,replaceErrorBar:OAe,removeErrorBar:kAe}=D8.actions,Mfe=D8.reducer;function O8(e,r){var a,l,m=ji(B=>iA(B,e)),y=ji(B=>oA(B,r)),T=(a=m?.allowDataOverflow)!==null&&a!==void 0?a:_f.allowDataOverflow,i=(l=y?.allowDataOverflow)!==null&&l!==void 0?l:yf.allowDataOverflow,z=T||i;return{needClip:z,needClipX:T,needClipY:i}}function Ife(e){var{xAxisId:r,yAxisId:a,clipPathId:l}=e,m=mI(),{needClipX:y,needClipY:T,needClip:i}=O8(r,a);if(!i)return null;var{x:z,y:B,width:F,height:G}=m;return ae.createElement("clipPath",{id:"clipPath-".concat(l)},ae.createElement("rect",{x:y?z:z-F/2,y:T?B:B-G/2,width:y?F:F*2,height:T?G:G*2}))}var Pfe=e=>{var{chartData:r}=e,a=Wu(),l=ep();return ae.useEffect(()=>l?()=>{}:(a(Vz(r)),()=>{a(Vz(void 0))}),[r,a,l]),null},yL={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},k8=Mf({name:"brush",initialState:yL,reducers:{setBrushSettings(e,r){return r.payload==null?yL:r.payload}}}),{setBrushSettings:zAe}=k8.actions,Rfe=k8.reducer;function Dfe(e,r,a){return(r=Ofe(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function Ofe(e){var r=kfe(e,"string");return typeof r=="symbol"?r:r+""}function kfe(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}class AI{static create(r){return new AI(r)}constructor(r){this.scale=r}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(r){var{bandAware:a,position:l}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r!==void 0){if(l)switch(l){case"start":return this.scale(r);case"middle":{var m=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+m}case"end":{var y=this.bandwidth?this.bandwidth():0;return this.scale(r)+y}default:return this.scale(r)}if(a){var T=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+T}return this.scale(r)}}isInRange(r){var a=this.range(),l=a[0],m=a[a.length-1];return l<=m?r>=l&&r<=m:r>=m&&r<=l}}Dfe(AI,"EPS",1e-4);function zfe(e){return(e%180+180)%180}var Lfe=function(r){var{width:a,height:l}=r,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,y=zfe(m),T=y*Math.PI/180,i=Math.atan(l/a),z=T>i&&T<Math.PI-i?l/Math.sin(T):a/Math.cos(T);return Math.abs(z)},Bfe={dots:[],areas:[],lines:[]},z8=Mf({name:"referenceElements",initialState:Bfe,reducers:{addDot:(e,r)=>{e.dots.push(r.payload)},removeDot:(e,r)=>{var a=Um(e).dots.findIndex(l=>l===r.payload);a!==-1&&e.dots.splice(a,1)},addArea:(e,r)=>{e.areas.push(r.payload)},removeArea:(e,r)=>{var a=Um(e).areas.findIndex(l=>l===r.payload);a!==-1&&e.areas.splice(a,1)},addLine:(e,r)=>{e.lines.push(r.payload)},removeLine:(e,r)=>{var a=Um(e).lines.findIndex(l=>l===r.payload);a!==-1&&e.lines.splice(a,1)}}}),{addDot:LAe,removeDot:BAe,addArea:FAe,removeArea:NAe,addLine:jAe,removeLine:UAe}=z8.actions,Ffe=z8.reducer,Nfe=ae.createContext(void 0),jfe=e=>{var{children:r}=e,[a]=ae.useState("".concat(Zv("recharts"),"-clip")),l=mI();if(l==null)return null;var{x:m,y,width:T,height:i}=l;return ae.createElement(Nfe.Provider,{value:a},ae.createElement("defs",null,ae.createElement("clipPath",{id:a},ae.createElement("rect",{x:m,y,height:i,width:T}))),r)};function X_(e,r){for(var a in e)if({}.hasOwnProperty.call(e,a)&&(!{}.hasOwnProperty.call(r,a)||e[a]!==r[a]))return!1;for(var l in r)if({}.hasOwnProperty.call(r,l)&&!{}.hasOwnProperty.call(e,l))return!1;return!0}function L8(e,r,a){if(r<1)return[];if(r===1&&a===void 0)return e;for(var l=[],m=0;m<e.length;m+=r)l.push(e[m]);return l}function Ufe(e,r,a){var l={width:e.width+r.width,height:e.height+r.height};return Lfe(l,a)}function Vfe(e,r,a){var l=a==="width",{x:m,y,width:T,height:i}=e;return r===1?{start:l?m:y,end:l?m+T:y+i}:{start:l?m+T:y+i,end:l?m:y}}function xw(e,r,a,l,m){if(e*r<e*l||e*r>e*m)return!1;var y=a();return e*(r-e*y/2-l)>=0&&e*(r+e*y/2-m)<=0}function $fe(e,r){return L8(e,r+1)}function Gfe(e,r,a,l,m){for(var y=(l||[]).slice(),{start:T,end:i}=r,z=0,B=1,F=T,G=function(){var ne=l?.[z];if(ne===void 0)return{v:L8(l,B)};var oe=z,ue,ye=()=>(ue===void 0&&(ue=a(ne,oe)),ue),we=ne.coordinate,ve=z===0||xw(e,we,ye,F,i);ve||(z=0,F=T,B+=1),ve&&(F=we+e*(ye()/2+m),z+=B)},Q;B<=y.length;)if(Q=G(),Q)return Q.v;return[]}function vL(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Yc(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?vL(Object(a),!0).forEach(function(l){Hfe(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vL(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Hfe(e,r,a){return(r=qfe(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function qfe(e){var r=Wfe(e,"string");return typeof r=="symbol"?r:r+""}function Wfe(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Zfe(e,r,a,l,m){for(var y=(l||[]).slice(),T=y.length,{start:i}=r,{end:z}=r,B=function(Q){var te=y[Q],ne,oe=()=>(ne===void 0&&(ne=a(te,Q)),ne);if(Q===T-1){var ue=e*(te.coordinate+e*oe()/2-z);y[Q]=te=Yc(Yc({},te),{},{tickCoord:ue>0?te.coordinate-ue*e:te.coordinate})}else y[Q]=te=Yc(Yc({},te),{},{tickCoord:te.coordinate});var ye=xw(e,te.tickCoord,oe,i,z);ye&&(z=te.tickCoord-e*(oe()/2+m),y[Q]=Yc(Yc({},te),{},{isShow:!0}))},F=T-1;F>=0;F--)B(F);return y}function Xfe(e,r,a,l,m,y){var T=(l||[]).slice(),i=T.length,{start:z,end:B}=r;if(y){var F=l[i-1],G=a(F,i-1),Q=e*(F.coordinate+e*G/2-B);T[i-1]=F=Yc(Yc({},F),{},{tickCoord:Q>0?F.coordinate-Q*e:F.coordinate});var te=xw(e,F.tickCoord,()=>G,z,B);te&&(B=F.tickCoord-e*(G/2+m),T[i-1]=Yc(Yc({},F),{},{isShow:!0}))}for(var ne=y?i-1:i,oe=function(we){var ve=T[we],Ce,Ee=()=>(Ce===void 0&&(Ce=a(ve,we)),Ce);if(we===0){var Be=e*(ve.coordinate-e*Ee()/2-z);T[we]=ve=Yc(Yc({},ve),{},{tickCoord:Be<0?ve.coordinate-Be*e:ve.coordinate})}else T[we]=ve=Yc(Yc({},ve),{},{tickCoord:ve.coordinate});var Ke=xw(e,ve.tickCoord,Ee,z,B);Ke&&(z=ve.tickCoord+e*(Ee()/2+m),T[we]=Yc(Yc({},ve),{},{isShow:!0}))},ue=0;ue<ne;ue++)oe(ue);return T}function Yfe(e,r,a){var{tick:l,ticks:m,viewBox:y,minTickGap:T,orientation:i,interval:z,tickFormatter:B,unit:F,angle:G}=e;if(!m||!m.length||!l)return[];if(oo(z)||ly.isSsr){var Q;return(Q=$fe(m,oo(z)?z:0))!==null&&Q!==void 0?Q:[]}var te=[],ne=i==="top"||i==="bottom"?"width":"height",oe=F&&ne==="width"?Nv(F,{fontSize:r,letterSpacing:a}):{width:0,height:0},ue=(ve,Ce)=>{var Ee=typeof B=="function"?B(ve.value,Ce):ve.value;return ne==="width"?Ufe(Nv(Ee,{fontSize:r,letterSpacing:a}),oe,G):Nv(Ee,{fontSize:r,letterSpacing:a})[ne]},ye=m.length>=2?qd(m[1].coordinate-m[0].coordinate):1,we=Vfe(y,ye,ne);return z==="equidistantPreserveStart"?Gfe(ye,we,ue,m,T):(z==="preserveStart"||z==="preserveStartEnd"?te=Xfe(ye,we,ue,m,T,z==="preserveStartEnd"):te=Zfe(ye,we,ue,m,T),te.filter(ve=>ve.isShow))}var Qfe=e=>{var{ticks:r,label:a,labelGapWithTick:l=5,tickSize:m=0,tickMargin:y=0}=e,T=0;if(r){r.forEach(F=>{if(F){var G=F.getBoundingClientRect();G.width>T&&(T=G.width)}});var i=a?a.getBoundingClientRect().width:0,z=m+y,B=T+z+i+(a?l:0);return Math.round(B)}return 0},Kfe=["axisLine","width","height","className","hide","ticks"],Jfe=["viewBox"],ede=["viewBox"];function r3(e,r){if(e==null)return{};var a,l,m=tde(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function tde(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}function xg(){return xg=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},xg.apply(null,arguments)}function xL(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Bl(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?xL(Object(a),!0).forEach(function(l){rde(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xL(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function rde(e,r,a){return(r=nde(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function nde(e){var r=ide(e,"string");return typeof r=="symbol"?r:r+""}function ide(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var ode={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function ade(e){var{x:r,y:a,width:l,height:m,orientation:y,mirror:T,axisLine:i,otherSvgProps:z}=e;if(!i)return null;var B=Bl(Bl(Bl({},z),Jc(i,!1)),{},{fill:"none"});if(y==="top"||y==="bottom"){var F=+(y==="top"&&!T||y==="bottom"&&T);B=Bl(Bl({},B),{},{x1:r,y1:a+F*m,x2:r+l,y2:a+F*m})}else{var G=+(y==="left"&&!T||y==="right"&&T);B=Bl(Bl({},B),{},{x1:r+G*l,y1:a,x2:r+G*l,y2:a+m})}return ae.createElement("line",xg({},B,{className:on("recharts-cartesian-axis-line",s2(i,"className"))}))}function sde(e,r,a,l,m,y,T,i,z){var B,F,G,Q,te,ne,oe=i?-1:1,ue=e.tickSize||T,ye=oo(e.tickCoord)?e.tickCoord:e.coordinate;switch(y){case"top":B=F=e.coordinate,Q=a+ +!i*m,G=Q-oe*ue,ne=G-oe*z,te=ye;break;case"left":G=Q=e.coordinate,F=r+ +!i*l,B=F-oe*ue,te=B-oe*z,ne=ye;break;case"right":G=Q=e.coordinate,F=r+ +i*l,B=F+oe*ue,te=B+oe*z,ne=ye;break;default:B=F=e.coordinate,Q=a+ +i*m,G=Q+oe*ue,ne=G+oe*z,te=ye;break}return{line:{x1:B,y1:G,x2:F,y2:Q},tick:{x:te,y:ne}}}function lde(e,r){switch(e){case"left":return r?"start":"end";case"right":return r?"end":"start";default:return"middle"}}function cde(e,r){switch(e){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}function ude(e){var{option:r,tickProps:a,value:l}=e,m,y=on(a.className,"recharts-cartesian-axis-tick-value");if(ae.isValidElement(r))m=ae.cloneElement(r,Bl(Bl({},a),{},{className:y}));else if(typeof r=="function")m=r(Bl(Bl({},a),{},{className:y}));else{var T="recharts-cartesian-axis-tick-value";typeof r!="boolean"&&(T=on(T,r?.className)),m=ae.createElement(dI,xg({},a,{className:T}),l)}return m}function hde(e){var{ticks:r=[],tick:a,tickLine:l,stroke:m,tickFormatter:y,unit:T,padding:i,tickTextProps:z,orientation:B,mirror:F,x:G,y:Q,width:te,height:ne,tickSize:oe,tickMargin:ue,fontSize:ye,letterSpacing:we,getTicksConfig:ve,events:Ce}=e,Ee=Yfe(Bl(Bl({},ve),{},{ticks:r}),ye,we),Be=lde(B,F),Ke=cde(B,F),st=wg(ve),dt=Jc(a,!1),bt=Bl(Bl({},st),{},{fill:"none"},Jc(l,!1)),ht=Ee.map((Re,Pt)=>{var{line:wt,tick:Et}=sde(Re,G,Q,te,ne,B,oe,F,ue),et=Bl(Bl(Bl(Bl({textAnchor:Be,verticalAnchor:Ke},st),{},{stroke:"none",fill:m},dt),Et),{},{index:Pt,payload:Re,visibleTicksCount:Ee.length,tickFormatter:y,padding:i},z);return ae.createElement(Zm,xg({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Re.value,"-").concat(Re.coordinate,"-").concat(Re.tickCoord)},Oee(Ce,Re,Pt)),l&&ae.createElement("line",xg({},bt,wt,{className:on("recharts-cartesian-axis-tick-line",s2(l,"className"))})),a&&ae.createElement(ude,{option:a,tickProps:et,value:"".concat(typeof y=="function"?y(Re.value,Pt):Re.value).concat(T||"")}))});return ht.length>0?ae.createElement("g",{className:"recharts-cartesian-axis-ticks"},ht):null}var fde=ae.forwardRef((e,r)=>{var{axisLine:a,width:l,height:m,className:y,hide:T,ticks:i}=e,z=r3(e,Kfe),[B,F]=ae.useState(""),[G,Q]=ae.useState(""),te=ae.useRef([]);ae.useImperativeHandle(r,()=>({getCalculatedWidth:()=>{var oe;return Qfe({ticks:te.current,label:(oe=e.labelRef)===null||oe===void 0?void 0:oe.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var ne=ae.useCallback(oe=>{if(oe){var ue=oe.getElementsByClassName("recharts-cartesian-axis-tick-value");te.current=Array.from(ue);var ye=ue[0];if(ye){var we=window.getComputedStyle(ye),ve=we.fontSize,Ce=we.letterSpacing;(ve!==B||Ce!==G)&&(F(ve),Q(Ce))}}},[B,G]);return T||l!=null&&l<=0||m!=null&&m<=0?null:ae.createElement(Zm,{className:on("recharts-cartesian-axis",y),ref:ne},ae.createElement(ade,{x:e.x,y:e.y,width:l,height:m,orientation:e.orientation,mirror:e.mirror,axisLine:a,otherSvgProps:wg(e)}),ae.createElement(hde,{ticks:i,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:B,letterSpacing:G,getTicksConfig:e,events:z}),ae.createElement(whe,{x:e.x,y:e.y,width:e.width,height:e.height},ae.createElement(Ohe,{label:e.label}),e.children))}),dde=ae.memo(fde,(e,r)=>{var{viewBox:a}=e,l=r3(e,Jfe),{viewBox:m}=r,y=r3(r,ede);return X_(a,m)&&X_(l,y)}),gI=ae.forwardRef((e,r)=>{var a=tp(e,ode);return ae.createElement(dde,xg({},a,{ref:r}))});gI.displayName="CartesianAxis";var B8=(e,r,a,l)=>GN(e,"xAxis",r,l),F8=(e,r,a,l)=>$N(e,"xAxis",r,l),N8=(e,r,a,l)=>GN(e,"yAxis",a,l),j8=(e,r,a,l)=>$N(e,"yAxis",a,l),pde=Pr([Ya,B8,N8,F8,j8],(e,r,a,l,m)=>eA(e,"xAxis")?DC(r,l,!1):DC(a,m,!1)),mde=(e,r,a,l,m)=>m,U8=Pr([fN,mde],(e,r)=>e.filter(a=>a.type==="area").find(a=>a.id===r)),Ade=(e,r,a,l,m)=>{var y,T=U8(e,r,a,l,m);if(T!=null){var i=Ya(e),z=eA(i,"xAxis"),B;if(z?B=XC(e,"yAxis",a,l):B=XC(e,"xAxis",r,l),B!=null){var{stackId:F}=T,G=ZM(T);if(!(F==null||G==null)){var Q=(y=B[F])===null||y===void 0?void 0:y.stackedData;return Q?.find(te=>te.key===G)}}}},gde=Pr([Ya,B8,N8,F8,j8,Ade,NM,pde,U8],(e,r,a,l,m,y,T,i,z)=>{var{chartData:B,dataStartIndex:F,dataEndIndex:G}=T;if(!(z==null||e!=="horizontal"&&e!=="vertical"||r==null||a==null||l==null||m==null||l.length===0||m.length===0||i==null)){var{data:Q}=z,te;if(Q&&Q.length>0?te=Q:te=B?.slice(F,G+1),te!=null){var ne=void 0;return Fde({layout:e,xAxis:r,yAxis:a,xAxisTicks:l,yAxisTicks:m,dataStartIndex:F,areaSettings:z,stackedData:y,displayedData:te,chartBaseValue:ne,bandSize:i})}}}),_de=["id"],yde=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function V8(e,r){if(e==null)return{};var a,l,m=vde(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function vde(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}function bL(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Fm(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?bL(Object(a),!0).forEach(function(l){xde(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):bL(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function xde(e,r,a){return(r=bde(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function bde(e){var r=wde(e,"string");return typeof r=="symbol"?r:r+""}function wde(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function $m(){return $m=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},$m.apply(null,arguments)}function bw(e,r){return e&&e!=="none"?e:r}var Sde=e=>{var{dataKey:r,name:a,stroke:l,fill:m,legendType:y,hide:T}=e;return[{inactive:T,dataKey:r,type:y,color:bw(l,m),value:WF(a,r),payload:e}]};function Tde(e){var{dataKey:r,data:a,stroke:l,strokeWidth:m,fill:y,name:T,hide:i,unit:z}=e;return{dataDefinedOnItem:a,positions:void 0,settings:{stroke:l,strokeWidth:m,fill:y,dataKey:r,nameKey:void 0,name:WF(T,r),hide:i,type:e.tooltipType,color:bw(l,y),unit:z}}}var Ede=(e,r)=>{var a;if(ae.isValidElement(e))a=ae.cloneElement(e,r);else if(typeof e=="function")a=e(r);else{var l=on("recharts-area-dot",typeof e!="boolean"?e.className:"");a=ae.createElement(M8,$m({},r,{className:l}))}return a};function Cde(e,r){return e==null?!1:r?!0:e.length===1}function Mde(e){var{clipPathId:r,points:a,props:l}=e,{needClip:m,dot:y,dataKey:T}=l;if(!Cde(a,y))return null;var i=Z5(y),z=wg(l),B=Jc(y,!0),F=a.map((Q,te)=>{var ne=Fm(Fm(Fm({key:"dot-".concat(te),r:3},z),B),{},{index:te,cx:Q.x,cy:Q.y,dataKey:T,value:Q.value,payload:Q.payload,points:a});return Ede(y,ne)}),G={clipPath:m?"url(#clipPath-".concat(i?"":"dots-").concat(r,")"):void 0};return ae.createElement(Zm,$m({className:"recharts-area-dots"},G),F)}function Ide(e){var{showLabels:r,children:a,points:l}=e,m=l.map(y=>{var T={x:y.x,y:y.y,width:0,height:0};return Fm(Fm({},T),{},{value:y.value,payload:y.payload,parentViewBox:void 0,viewBox:T,fill:void 0})});return ae.createElement(Ghe,{value:r?m:null},a)}function wL(e){var{points:r,baseLine:a,needClip:l,clipPathId:m,props:y}=e,{layout:T,type:i,stroke:z,connectNulls:B,isRange:F}=y,{id:G}=y,Q=V8(y,_de),te=wg(Q);return ae.createElement(ae.Fragment,null,r?.length>1&&ae.createElement(Zm,{clipPath:l?"url(#clipPath-".concat(m,")"):void 0},ae.createElement(Rb,$m({},te,{id:G,points:r,connectNulls:B,type:i,baseLine:a,layout:T,stroke:"none",className:"recharts-area-area"})),z!=="none"&&ae.createElement(Rb,$m({},te,{className:"recharts-area-curve",layout:T,type:i,connectNulls:B,fill:"none",points:r})),z!=="none"&&F&&ae.createElement(Rb,$m({},te,{className:"recharts-area-curve",layout:T,type:i,connectNulls:B,fill:"none",points:a}))),ae.createElement(Mde,{points:r,props:Q,clipPathId:m}))}function Pde(e){var{alpha:r,baseLine:a,points:l,strokeWidth:m}=e,y=l[0].y,T=l[l.length-1].y;if(!qu(y)||!qu(T))return null;var i=r*Math.abs(y-T),z=Math.max(...l.map(B=>B.x||0));return oo(a)?z=Math.max(a,z):a&&Array.isArray(a)&&a.length&&(z=Math.max(...a.map(B=>B.x||0),z)),oo(z)?ae.createElement("rect",{x:0,y:y<T?y:y-i,width:z+(m?parseInt("".concat(m),10):1),height:Math.floor(i)}):null}function Rde(e){var{alpha:r,baseLine:a,points:l,strokeWidth:m}=e,y=l[0].x,T=l[l.length-1].x;if(!qu(y)||!qu(T))return null;var i=r*Math.abs(y-T),z=Math.max(...l.map(B=>B.y||0));return oo(a)?z=Math.max(a,z):a&&Array.isArray(a)&&a.length&&(z=Math.max(...a.map(B=>B.y||0),z)),oo(z)?ae.createElement("rect",{x:y<T?y:y-i,y:0,width:i,height:Math.floor(z+(m?parseInt("".concat(m),10):1))}):null}function Dde(e){var{alpha:r,layout:a,points:l,baseLine:m,strokeWidth:y}=e;return a==="vertical"?ae.createElement(Pde,{alpha:r,points:l,baseLine:m,strokeWidth:y}):ae.createElement(Rde,{alpha:r,points:l,baseLine:m,strokeWidth:y})}function Ode(e){var{needClip:r,clipPathId:a,props:l,previousPointsRef:m,previousBaselineRef:y}=e,{points:T,baseLine:i,isAnimationActive:z,animationBegin:B,animationDuration:F,animationEasing:G,onAnimationStart:Q,onAnimationEnd:te}=l,ne=r6(l,"recharts-area-"),[oe,ue]=ae.useState(!1),ye=!oe,we=ae.useCallback(()=>{typeof te=="function"&&te(),ue(!1)},[te]),ve=ae.useCallback(()=>{typeof Q=="function"&&Q(),ue(!0)},[Q]),Ce=m.current,Ee=y.current;return ae.createElement(Ide,{showLabels:ye,points:T},l.children,ae.createElement(t6,{animationId:ne,begin:B,duration:F,isActive:z,easing:G,onAnimationEnd:we,onAnimationStart:ve,key:ne},Be=>{if(Ce){var Ke=Ce.length/T.length,st=Be===1?T:T.map((bt,ht)=>{var Re=Math.floor(ht*Ke);if(Ce[Re]){var Pt=Ce[Re];return Fm(Fm({},bt),{},{x:Np(Pt.x,bt.x,Be),y:Np(Pt.y,bt.y,Be)})}return bt}),dt;return oo(i)?dt=Np(Ee,i,Be):yc(i)||ad(i)?dt=Np(Ee,0,Be):dt=i.map((bt,ht)=>{var Re=Math.floor(ht*Ke);if(Array.isArray(Ee)&&Ee[Re]){var Pt=Ee[Re];return Fm(Fm({},bt),{},{x:Np(Pt.x,bt.x,Be),y:Np(Pt.y,bt.y,Be)})}return bt}),Be>0&&(m.current=st,y.current=dt),ae.createElement(wL,{points:st,baseLine:dt,needClip:r,clipPathId:a,props:l})}return Be>0&&(m.current=T,y.current=i),ae.createElement(Zm,null,z&&ae.createElement("defs",null,ae.createElement("clipPath",{id:"animationClipPath-".concat(a)},ae.createElement(Dde,{alpha:Be,points:T,baseLine:i,layout:l.layout,strokeWidth:l.strokeWidth}))),ae.createElement(Zm,{clipPath:"url(#animationClipPath-".concat(a,")")},ae.createElement(wL,{points:T,baseLine:i,needClip:r,clipPathId:a,props:l})))}),ae.createElement(Whe,{label:l.label}))}function kde(e){var{needClip:r,clipPathId:a,props:l}=e,m=ae.useRef(null),y=ae.useRef();return ae.createElement(Ode,{needClip:r,clipPathId:a,props:l,previousPointsRef:m,previousBaselineRef:y})}class zde extends ae.PureComponent{render(){var r,{hide:a,dot:l,points:m,className:y,top:T,left:i,needClip:z,xAxisId:B,yAxisId:F,width:G,height:Q,id:te,baseLine:ne}=this.props;if(a)return null;var oe=on("recharts-area",y),ue=te,{r:ye=3,strokeWidth:we=2}=(r=Jc(l,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},ve=Z5(l),Ce=ye*2+we;return ae.createElement(ae.Fragment,null,ae.createElement(Zm,{className:oe},z&&ae.createElement("defs",null,ae.createElement(Ife,{clipPathId:ue,xAxisId:B,yAxisId:F}),!ve&&ae.createElement("clipPath",{id:"clipPath-dots-".concat(ue)},ae.createElement("rect",{x:i-Ce/2,y:T-Ce/2,width:G+Ce,height:Q+Ce}))),ae.createElement(kde,{needClip:z,clipPathId:ue,props:this.props})),ae.createElement(_L,{points:m,mainColor:bw(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(ne)&&ae.createElement(_L,{points:ne,mainColor:bw(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var $8={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!ly.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function Lde(e){var r,a=tp(e,$8),{activeDot:l,animationBegin:m,animationDuration:y,animationEasing:T,connectNulls:i,dot:z,fill:B,fillOpacity:F,hide:G,isAnimationActive:Q,legendType:te,stroke:ne,xAxisId:oe,yAxisId:ue}=a,ye=V8(a,yde),we=mM(),ve=c8(),{needClip:Ce}=O8(oe,ue),Ee=ep(),{points:Be,isRange:Ke,baseLine:st}=(r=ji(wt=>gde(wt,oe,ue,Ee,e.id)))!==null&&r!==void 0?r:{},dt=mI();if(we!=="horizontal"&&we!=="vertical"||dt==null||ve!=="AreaChart"&&ve!=="ComposedChart")return null;var{height:bt,width:ht,x:Re,y:Pt}=dt;return!Be||!Be.length?null:ae.createElement(zde,$m({},ye,{activeDot:l,animationBegin:m,animationDuration:y,animationEasing:T,baseLine:st,connectNulls:i,dot:z,fill:B,fillOpacity:F,height:bt,hide:G,layout:we,isAnimationActive:Q,isRange:Ke,legendType:te,needClip:Ce,points:Be,stroke:ne,width:ht,left:Re,top:Pt,xAxisId:oe,yAxisId:ue}))}var Bde=(e,r,a,l,m)=>{var y=a??r;if(oo(y))return y;var T=e==="horizontal"?m:l,i=T.scale.domain();if(T.type==="number"){var z=Math.max(i[0],i[1]),B=Math.min(i[0],i[1]);return y==="dataMin"?B:y==="dataMax"||z<0?z:Math.max(Math.min(i[0],i[1]),0)}return y==="dataMin"?i[0]:y==="dataMax"?i[1]:i[0]};function Fde(e){var{areaSettings:{connectNulls:r,baseValue:a,dataKey:l},stackedData:m,layout:y,chartBaseValue:T,xAxis:i,yAxis:z,displayedData:B,dataStartIndex:F,xAxisTicks:G,yAxisTicks:Q,bandSize:te}=e,ne=m&&m.length,oe=Bde(y,T,a,i,z),ue=y==="horizontal",ye=!1,we=B.map((Ce,Ee)=>{var Be;ne?Be=m[F+Ee]:(Be=Hu(Ce,l),Array.isArray(Be)?ye=!0:Be=[oe,Be]);var Ke=Be[1]==null||ne&&!r&&Hu(Ce,l)==null;return ue?{x:y4({axis:i,ticks:G,bandSize:te,entry:Ce,index:Ee}),y:Ke?null:z.scale(Be[1]),value:Be,payload:Ce}:{x:Ke?null:i.scale(Be[1]),y:y4({axis:z,ticks:Q,bandSize:te,entry:Ce,index:Ee}),value:Be,payload:Ce}}),ve;return ne||ye?ve=we.map(Ce=>{var Ee=Array.isArray(Ce.value)?Ce.value[0]:null;return ue?{x:Ce.x,y:Ee!=null&&Ce.y!=null?z.scale(Ee):null,payload:Ce.payload}:{x:Ee!=null?i.scale(Ee):null,y:Ce.y,payload:Ce.payload}}):ve=ue?z.scale(oe):i.scale(oe),{points:we,baseLine:ve,isRange:ye}}function Nde(e){var r=tp(e,$8),a=ep();return ae.createElement(nfe,{id:r.id,type:"area"},l=>ae.createElement(ae.Fragment,null,ae.createElement(Khe,{legendPayload:Sde(r)}),ae.createElement(Yhe,{fn:Tde,args:r}),ae.createElement(cfe,{type:"area",id:l,data:r.data,dataKey:r.dataKey,xAxisId:r.xAxisId,yAxisId:r.yAxisId,zAxisId:0,stackId:xne(r.stackId),hide:r.hide,barSize:void 0,baseValue:r.baseValue,isPanorama:a,connectNulls:r.connectNulls}),ae.createElement(Lde,$m({},r,{id:l}))))}var G8=ae.memo(Nde);G8.displayName="Area";var jde=["dangerouslySetInnerHTML","ticks"],Ude=["id"],Vde=["domain"],$de=["domain"];function n3(){return n3=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},n3.apply(null,arguments)}function ww(e,r){if(e==null)return{};var a,l,m=Gde(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Gde(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}function Hde(e){var r=Wu();return ae.useEffect(()=>(r(pfe(e)),()=>{r(mfe(e))}),[e,r]),null}var qde=e=>{var{xAxisId:r,className:a}=e,l=ji(XF),m=ep(),y="xAxis",T=ji(ue=>py(ue,y,r,m)),i=ji(ue=>VN(ue,y,r,m)),z=ji(ue=>Nle(ue,r)),B=ji(ue=>Hle(ue,r)),F=ji(ue=>lN(ue,r));if(z==null||B==null||F==null)return null;var{dangerouslySetInnerHTML:G,ticks:Q}=e,te=ww(e,jde),{id:ne}=F,oe=ww(F,Ude);return ae.createElement(gI,n3({},te,oe,{scale:T,x:B.x,y:B.y,width:z.width,height:z.height,className:on("recharts-".concat(y," ").concat(y),a),viewBox:l,ticks:i}))},Wde={allowDataOverflow:_f.allowDataOverflow,allowDecimals:_f.allowDecimals,allowDuplicatedCategory:_f.allowDuplicatedCategory,height:_f.height,hide:!1,mirror:_f.mirror,orientation:_f.orientation,padding:_f.padding,reversed:_f.reversed,scale:_f.scale,tickCount:_f.tickCount,type:_f.type,xAxisId:0},Zde=e=>{var r,a,l,m,y,T=tp(e,Wde);return ae.createElement(ae.Fragment,null,ae.createElement(Hde,{interval:(r=T.interval)!==null&&r!==void 0?r:"preserveEnd",id:T.xAxisId,scale:T.scale,type:T.type,padding:T.padding,allowDataOverflow:T.allowDataOverflow,domain:T.domain,dataKey:T.dataKey,allowDuplicatedCategory:T.allowDuplicatedCategory,allowDecimals:T.allowDecimals,tickCount:T.tickCount,includeHidden:(a=T.includeHidden)!==null&&a!==void 0?a:!1,reversed:T.reversed,ticks:T.ticks,height:T.height,orientation:T.orientation,mirror:T.mirror,hide:T.hide,unit:T.unit,name:T.name,angle:(l=T.angle)!==null&&l!==void 0?l:0,minTickGap:(m=T.minTickGap)!==null&&m!==void 0?m:5,tick:(y=T.tick)!==null&&y!==void 0?y:!0,tickFormatter:T.tickFormatter}),ae.createElement(qde,T))},Xde=(e,r)=>{var{domain:a}=e,l=ww(e,Vde),{domain:m}=r,y=ww(r,$de);return X_(l,y)?Array.isArray(a)&&a.length===2&&Array.isArray(m)&&m.length===2?a[0]===m[0]&&a[1]===m[1]:X_({domain:a},{domain:m}):!1},H8=ae.memo(Zde,Xde);H8.displayName="XAxis";var Yde=["dangerouslySetInnerHTML","ticks"],Qde=["id"],Kde=["domain"],Jde=["domain"];function i3(){return i3=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},i3.apply(null,arguments)}function Sw(e,r){if(e==null)return{};var a,l,m=epe(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function epe(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}function tpe(e){var r=Wu();return ae.useEffect(()=>(r(Afe(e)),()=>{r(gfe(e))}),[e,r]),null}var rpe=e=>{var{yAxisId:r,className:a,width:l,label:m}=e,y=ae.useRef(null),T=ae.useRef(null),i=ji(XF),z=ep(),B=Wu(),F="yAxis",G=ji(Ee=>py(Ee,F,r,z)),Q=ji(Ee=>Zle(Ee,r)),te=ji(Ee=>Wle(Ee,r)),ne=ji(Ee=>VN(Ee,F,r,z)),oe=ji(Ee=>cN(Ee,r));if(ae.useLayoutEffect(()=>{if(!(l!=="auto"||!Q||pI(m)||ae.isValidElement(m)||oe==null)){var Ee=y.current;if(Ee){var Be=Ee.getCalculatedWidth();Math.round(Q.width)!==Math.round(Be)&&B(_fe({id:r,width:Be}))}}},[ne,Q,B,m,r,l,oe]),Q==null||te==null||oe==null)return null;var{dangerouslySetInnerHTML:ue,ticks:ye}=e,we=Sw(e,Yde),{id:ve}=oe,Ce=Sw(oe,Qde);return ae.createElement(gI,i3({},we,Ce,{ref:y,labelRef:T,scale:G,x:te.x,y:te.y,tickTextProps:l==="auto"?{width:void 0}:{width:l},width:Q.width,height:Q.height,className:on("recharts-".concat(F," ").concat(F),a),viewBox:i,ticks:ne}))},npe={allowDataOverflow:yf.allowDataOverflow,allowDecimals:yf.allowDecimals,allowDuplicatedCategory:yf.allowDuplicatedCategory,hide:!1,mirror:yf.mirror,orientation:yf.orientation,padding:yf.padding,reversed:yf.reversed,scale:yf.scale,tickCount:yf.tickCount,type:yf.type,width:yf.width,yAxisId:0},ipe=e=>{var r,a,l,m,y,T=tp(e,npe);return ae.createElement(ae.Fragment,null,ae.createElement(tpe,{interval:(r=T.interval)!==null&&r!==void 0?r:"preserveEnd",id:T.yAxisId,scale:T.scale,type:T.type,domain:T.domain,allowDataOverflow:T.allowDataOverflow,dataKey:T.dataKey,allowDuplicatedCategory:T.allowDuplicatedCategory,allowDecimals:T.allowDecimals,tickCount:T.tickCount,padding:T.padding,includeHidden:(a=T.includeHidden)!==null&&a!==void 0?a:!1,reversed:T.reversed,ticks:T.ticks,width:T.width,orientation:T.orientation,mirror:T.mirror,hide:T.hide,unit:T.unit,name:T.name,angle:(l=T.angle)!==null&&l!==void 0?l:0,minTickGap:(m=T.minTickGap)!==null&&m!==void 0?m:5,tick:(y=T.tick)!==null&&y!==void 0?y:!0,tickFormatter:T.tickFormatter}),ae.createElement(rpe,T))},ope=(e,r)=>{var{domain:a}=e,l=Sw(e,Kde),{domain:m}=r,y=Sw(r,Jde);return X_(l,y)?Array.isArray(a)&&a.length===2&&Array.isArray(m)&&m.length===2?a[0]===m[0]&&a[1]===m[1]:X_({domain:a},{domain:m}):!1},q8=ae.memo(ipe,ope);q8.displayName="YAxis";var BE={exports:{}},FE={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SL;function ape(){if(SL)return FE;SL=1;var e=Y_();function r(z,B){return z===B&&(z!==0||1/z===1/B)||z!==z&&B!==B}var a=typeof Object.is=="function"?Object.is:r,l=e.useSyncExternalStore,m=e.useRef,y=e.useEffect,T=e.useMemo,i=e.useDebugValue;return FE.useSyncExternalStoreWithSelector=function(z,B,F,G,Q){var te=m(null);if(te.current===null){var ne={hasValue:!1,value:null};te.current=ne}else ne=te.current;te=T(function(){function ue(Ee){if(!ye){if(ye=!0,we=Ee,Ee=G(Ee),Q!==void 0&&ne.hasValue){var Be=ne.value;if(Q(Be,Ee))return ve=Be}return ve=Ee}if(Be=ve,a(we,Ee))return Be;var Ke=G(Ee);return Q!==void 0&&Q(Be,Ke)?(we=Ee,Be):(we=Ee,ve=Ke)}var ye=!1,we,ve,Ce=F===void 0?null:F;return[function(){return ue(B())},Ce===null?void 0:function(){return ue(Ce())}]},[B,F,G,Q]);var oe=l(z,te[0],te[1]);return y(function(){ne.hasValue=!0,ne.value=oe},[oe]),i(oe),oe},FE}var TL;function spe(){return TL||(TL=1,BE.exports=ape()),BE.exports}spe();function lpe(e){e()}function cpe(){let e=null,r=null;return{clear(){e=null,r=null},notify(){lpe(()=>{let a=e;for(;a;)a.callback(),a=a.next})},get(){const a=[];let l=e;for(;l;)a.push(l),l=l.next;return a},subscribe(a){let l=!0;const m=r={callback:a,next:null,prev:r};return m.prev?m.prev.next=m:e=m,function(){!l||e===null||(l=!1,m.next?m.next.prev=m.prev:r=m.prev,m.prev?m.prev.next=m.next:e=m.next)}}}}var EL={notify(){},get:()=>[]};function upe(e,r){let a,l=EL,m=0,y=!1;function T(oe){F();const ue=l.subscribe(oe);let ye=!1;return()=>{ye||(ye=!0,ue(),G())}}function i(){l.notify()}function z(){ne.onStateChange&&ne.onStateChange()}function B(){return y}function F(){m++,a||(a=e.subscribe(z),l=cpe())}function G(){m--,a&&m===0&&(a(),a=void 0,l.clear(),l=EL)}function Q(){y||(y=!0,F())}function te(){y&&(y=!1,G())}const ne={addNestedSub:T,notifyNestedSubs:i,handleChangeWrapper:z,isSubscribed:B,trySubscribe:Q,tryUnsubscribe:te,getListeners:()=>l};return ne}var hpe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fpe=hpe(),dpe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",ppe=dpe(),mpe=()=>fpe||ppe?ae.useLayoutEffect:ae.useEffect,Ape=mpe(),gpe=Symbol.for("react-redux-context"),_pe=typeof globalThis<"u"?globalThis:{};function ype(){if(!ae.createContext)return{};const e=_pe[gpe]??=new Map;let r=e.get(ae.createContext);return r||(r=ae.createContext(null),e.set(ae.createContext,r)),r}var vpe=ype();function xpe(e){const{children:r,context:a,serverState:l,store:m}=e,y=ae.useMemo(()=>{const z=upe(m);return{store:m,subscription:z,getServerState:l?()=>l:void 0}},[m,l]),T=ae.useMemo(()=>m.getState(),[m]);Ape(()=>{const{subscription:z}=y;return z.onStateChange=z.notifyNestedSubs,z.trySubscribe(),T!==m.getState()&&z.notifyNestedSubs(),()=>{z.tryUnsubscribe(),z.onStateChange=void 0}},[y,T]);const i=a||vpe;return ae.createElement(i.Provider,{value:y},r)}var bpe=xpe,wpe=(e,r)=>r,_I=Pr([wpe,Ya,oN,jl,i8,aA,Kce,vc],nue),yI=e=>{var r=e.currentTarget.getBoundingClientRect(),a=r.width/e.currentTarget.offsetWidth,l=r.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-r.left)/a),chartY:Math.round((e.clientY-r.top)/l)}},W8=sd("mouseClick"),Z8=Ex();Z8.startListening({actionCreator:W8,effect:(e,r)=>{var a=e.payload,l=_I(r.getState(),yI(a));l?.activeIndex!=null&&r.dispatch(ace({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate}))}});var o3=sd("mouseMove"),X8=Ex();X8.startListening({actionCreator:o3,effect:(e,r)=>{var a=e.payload,l=r.getState(),m=iI(l,l.tooltip.settings.shared),y=_I(l,yI(a));m==="axis"&&(y?.activeIndex!=null?r.dispatch(QN({activeIndex:y.activeIndex,activeDataKey:void 0,activeCoordinate:y.activeCoordinate})):r.dispatch(YN()))}});var CL={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Y8=Mf({name:"rootProps",initialState:CL,reducers:{updateOptions:(e,r)=>{var a;e.accessibilityLayer=r.payload.accessibilityLayer,e.barCategoryGap=r.payload.barCategoryGap,e.barGap=(a=r.payload.barGap)!==null&&a!==void 0?a:CL.barGap,e.barSize=r.payload.barSize,e.maxBarSize=r.payload.maxBarSize,e.stackOffset=r.payload.stackOffset,e.syncId=r.payload.syncId,e.syncMethod=r.payload.syncMethod,e.className=r.payload.className}}}),Spe=Y8.reducer,{updateOptions:Tpe}=Y8.actions,Q8=Mf({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,r)=>r.payload}}),{updatePolarOptions:VAe}=Q8.actions,Epe=Q8.reducer,K8=sd("keyDown"),J8=sd("focus"),vI=Ex();vI.startListening({actionCreator:K8,effect:(e,r)=>{var a=r.getState(),l=a.rootProps.accessibilityLayer!==!1;if(l){var{keyboardInteraction:m}=a.tooltip,y=e.payload;if(!(y!=="ArrowRight"&&y!=="ArrowLeft"&&y!=="Enter")){var T=Number(oI(m,Ay(a))),i=aA(a);if(y==="Enter"){var z=yw(a,"axis","hover",String(m.index));r.dispatch(QC({active:!m.active,activeIndex:m.index,activeDataKey:m.dataKey,activeCoordinate:z}));return}var B=Kle(a),F=B==="left-to-right"?1:-1,G=y==="ArrowRight"?1:-1,Q=T+G*F;if(!(i==null||Q>=i.length||Q<0)){var te=yw(a,"axis","hover",String(Q));r.dispatch(QC({active:!0,activeIndex:Q.toString(),activeDataKey:void 0,activeCoordinate:te}))}}}}});vI.startListening({actionCreator:J8,effect:(e,r)=>{var a=r.getState(),l=a.rootProps.accessibilityLayer!==!1;if(l){var{keyboardInteraction:m}=a.tooltip;if(!m.active&&m.index==null){var y="0",T=yw(a,"axis","hover",String(y));r.dispatch(QC({activeDataKey:void 0,active:!0,activeIndex:y,activeCoordinate:T}))}}}});var td=sd("externalEvent"),ej=Ex();ej.startListening({actionCreator:td,effect:(e,r)=>{if(e.payload.handler!=null){var a=r.getState(),l={activeCoordinate:$ce(a),activeDataKey:Uce(a),activeIndex:nx(a),activeLabel:s8(a),activeTooltipIndex:nx(a),isTooltipActive:Gce(a)};e.payload.handler(l,e.payload.reactEvent)}}});var Cpe=Pr([my],e=>e.tooltipItemPayloads),Mpe=Pr([Cpe,Lx,(e,r,a)=>r,(e,r,a)=>a],(e,r,a,l)=>{var m=e.find(i=>i.settings.dataKey===l);if(m!=null){var{positions:y}=m;if(y!=null){var T=r(y,a);return T}}}),tj=sd("touchMove"),rj=Ex();rj.startListening({actionCreator:tj,effect:(e,r)=>{var a=e.payload,l=r.getState(),m=iI(l,l.tooltip.settings.shared);if(m==="axis"){var y=_I(l,yI({clientX:a.touches[0].clientX,clientY:a.touches[0].clientY,currentTarget:a.currentTarget}));y?.activeIndex!=null&&r.dispatch(QN({activeIndex:y.activeIndex,activeDataKey:void 0,activeCoordinate:y.activeCoordinate}))}else if(m==="item"){var T,i=a.touches[0],z=document.elementFromPoint(i.clientX,i.clientY);if(!z||!z.getAttribute)return;var B=z.getAttribute(Ine),F=(T=z.getAttribute(Pne))!==null&&T!==void 0?T:void 0,G=Mpe(r.getState(),B,F);r.dispatch(oce({activeDataKey:F,activeIndex:B,activeCoordinate:G}))}}});var Ipe=wF({brush:Rfe,cartesianAxis:yfe,chartData:vue,errorBars:Mfe,graphicalItems:lfe,layout:ene,legend:Zne,options:mue,polarAxis:Xhe,polarOptions:Epe,referenceElements:Ffe,rootProps:Spe,tooltip:sce}),Ppe=function(r){return Tre({reducer:Ipe,preloadedState:r,middleware:a=>a({serializableCheck:!1}).concat([Z8.middleware,X8.middleware,vI.middleware,ej.middleware,rj.middleware]),devTools:ly.devToolsEnabled})};function Rpe(e){var{preloadedState:r,children:a,reduxStoreName:l}=e,m=ep(),y=ae.useRef(null);if(m)return a;y.current==null&&(y.current=Ppe(r));var T=lM;return ae.createElement(bpe,{context:T,store:y.current},a)}function Dpe(e){var{layout:r,width:a,height:l,margin:m}=e,y=Wu(),T=ep();return ae.useEffect(()=>{T||(y(Qre(r)),y(Kre({width:a,height:l})),y(Yre(m)))},[y,T,r,a,l,m]),null}function Ope(e){var r=Wu();return ae.useEffect(()=>{r(Tpe(e))},[r,e]),null}var kpe=["children"];function zpe(e,r){if(e==null)return{};var a,l,m=Lpe(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Lpe(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}function Tw(){return Tw=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},Tw.apply(null,arguments)}var Bpe={width:"100%",height:"100%"},Fpe=ae.forwardRef((e,r)=>{var a=$ne(),l=Gne(),m=QF();if(!nw(a)||!nw(l))return null;var{children:y,otherAttributes:T,title:i,desc:z}=e,B,F;return typeof T.tabIndex=="number"?B=T.tabIndex:B=m?0:void 0,typeof T.role=="string"?F=T.role:F=m?"application":void 0,ae.createElement(X5,Tw({},T,{title:i,desc:z,role:F,tabIndex:B,width:a,height:l,style:Bpe,ref:r}),y)}),Npe=e=>{var{children:r}=e,a=ji(y2);if(!a)return null;var{width:l,height:m,y,x:T}=a;return ae.createElement(X5,{width:l,height:m,x:T,y},r)},ML=ae.forwardRef((e,r)=>{var{children:a}=e,l=zpe(e,kpe),m=ep();return m?ae.createElement(Npe,null,a):ae.createElement(Fpe,Tw({ref:r},l),a)});function jpe(){var e=Wu(),[r,a]=ae.useState(null),l=ji(Mne);return ae.useEffect(()=>{if(r!=null){var m=r.getBoundingClientRect(),y=m.width/r.offsetWidth;qu(y)&&y!==l&&e(Jre(y))}},[r,e,l]),a}function IL(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);r&&(l=l.filter(function(m){return Object.getOwnPropertyDescriptor(e,m).enumerable})),a.push.apply(a,l)}return a}function Upe(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?IL(Object(a),!0).forEach(function(l){Vpe(e,l,a[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):IL(Object(a)).forEach(function(l){Object.defineProperty(e,l,Object.getOwnPropertyDescriptor(a,l))})}return e}function Vpe(e,r,a){return(r=$pe(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function $pe(e){var r=Gpe(e,"string");return typeof r=="symbol"?r:r+""}function Gpe(e,r){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var l=a.call(e,r);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}var Hpe=ae.forwardRef((e,r)=>{var{children:a,className:l,height:m,onClick:y,onContextMenu:T,onDoubleClick:i,onMouseDown:z,onMouseEnter:B,onMouseLeave:F,onMouseMove:G,onMouseUp:Q,onTouchEnd:te,onTouchMove:ne,onTouchStart:oe,style:ue,width:ye}=e,we=Wu(),[ve,Ce]=ae.useState(null),[Ee,Be]=ae.useState(null);Iue();var Ke=jpe(),st=ae.useCallback(Jt=>{Ke(Jt),typeof r=="function"&&r(Jt),Ce(Jt),Be(Jt)},[Ke,r,Ce,Be]),dt=ae.useCallback(Jt=>{we(W8(Jt)),we(td({handler:y,reactEvent:Jt}))},[we,y]),bt=ae.useCallback(Jt=>{we(o3(Jt)),we(td({handler:B,reactEvent:Jt}))},[we,B]),ht=ae.useCallback(Jt=>{we(YN()),we(td({handler:F,reactEvent:Jt}))},[we,F]),Re=ae.useCallback(Jt=>{we(o3(Jt)),we(td({handler:G,reactEvent:Jt}))},[we,G]),Pt=ae.useCallback(()=>{we(J8())},[we]),wt=ae.useCallback(Jt=>{we(K8(Jt.key))},[we]),Et=ae.useCallback(Jt=>{we(td({handler:T,reactEvent:Jt}))},[we,T]),et=ae.useCallback(Jt=>{we(td({handler:i,reactEvent:Jt}))},[we,i]),Zt=ae.useCallback(Jt=>{we(td({handler:z,reactEvent:Jt}))},[we,z]),ir=ae.useCallback(Jt=>{we(td({handler:Q,reactEvent:Jt}))},[we,Q]),or=ae.useCallback(Jt=>{we(td({handler:oe,reactEvent:Jt}))},[we,oe]),ft=ae.useCallback(Jt=>{we(tj(Jt)),we(td({handler:ne,reactEvent:Jt}))},[we,ne]),Vt=ae.useCallback(Jt=>{we(td({handler:te,reactEvent:Jt}))},[we,te]);return ae.createElement(p8.Provider,{value:ve},ae.createElement(Vee.Provider,{value:Ee},ae.createElement("div",{className:on("recharts-wrapper",l),style:Upe({position:"relative",cursor:"default",width:ye,height:m},ue),onClick:dt,onContextMenu:Et,onDoubleClick:et,onFocus:Pt,onKeyDown:wt,onMouseDown:Zt,onMouseEnter:bt,onMouseLeave:ht,onMouseMove:Re,onMouseUp:ir,onTouchEnd:Vt,onTouchMove:ft,onTouchStart:or,ref:st},a)))}),qpe=["children","className","width","height","style","compact","title","desc"];function Wpe(e,r){if(e==null)return{};var a,l,m=Zpe(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Zpe(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var Xpe=ae.forwardRef((e,r)=>{var{children:a,className:l,width:m,height:y,style:T,compact:i,title:z,desc:B}=e,F=Wpe(e,qpe),G=wg(F);return i?ae.createElement(ML,{otherAttributes:G,title:z,desc:B},a):ae.createElement(Hpe,{className:l,style:T,width:m,height:y,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},ae.createElement(ML,{otherAttributes:G,title:z,desc:B,ref:r},ae.createElement(jfe,null,a)))}),Ype=["width","height"];function a3(){return a3=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var l in a)({}).hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},a3.apply(null,arguments)}function Qpe(e,r){if(e==null)return{};var a,l,m=Kpe(e,r);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(e);for(l=0;l<y.length;l++)a=y[l],r.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(m[a]=e[a])}return m}function Kpe(e,r){if(e==null)return{};var a={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(r.indexOf(l)!==-1)continue;a[l]=e[l]}return a}var Jpe={top:5,right:5,bottom:5,left:5},eme={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Jpe,reverseStackOrder:!1,syncMethod:"index"},tme=ae.forwardRef(function(r,a){var l,m=tp(r.categoricalChartProps,eme),{width:y,height:T}=m,i=Qpe(m,Ype);if(!nw(y)||!nw(T))return null;var{chartName:z,defaultTooltipEventType:B,validateTooltipEventTypes:F,tooltipPayloadSearcher:G,categoricalChartProps:Q}=r,te={chartName:z,defaultTooltipEventType:B,validateTooltipEventTypes:F,tooltipPayloadSearcher:G,eventEmitter:void 0};return ae.createElement(Rpe,{preloadedState:{options:te},reduxStoreName:(l=Q.id)!==null&&l!==void 0?l:z},ae.createElement(Pfe,{chartData:Q.data}),ae.createElement(Dpe,{width:y,height:T,layout:m.layout,margin:m.margin}),ae.createElement(Ope,{accessibilityLayer:m.accessibilityLayer,barCategoryGap:m.barCategoryGap,maxBarSize:m.maxBarSize,stackOffset:m.stackOffset,barGap:m.barGap,barSize:m.barSize,syncId:m.syncId,syncMethod:m.syncMethod,className:m.className}),ae.createElement(Xpe,a3({},i,{width:y,height:T,ref:a})))}),rme=["axis"],nme=ae.forwardRef((e,r)=>ae.createElement(tme,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:rme,tooltipPayloadSearcher:due,categoricalChartProps:e,ref:r}));const ime=async()=>(await ol.get("/stats")).data,ome={orders:"- ",avgPrice:"  ",turnover:" (  )",revenue:" ( )",drivers:" ",clients:" "};function ame(){const[e,r]=ae.useState([]),[a,l]=ae.useState("drivers"),[m,y]=ae.useState(!0);ae.useEffect(()=>{y(!0),ime().then(z=>{r(z),y(!1)}).catch(()=>y(!1))},[]);const i=e.find(z=>z.key===a)?.data??[];return be.jsxs(bo,{sx:{width:"calc(100vw - 300px)",margin:"0 auto",padding:2},children:[be.jsx(tl,{variant:"h5",gutterBottom:!0,children:""}),be.jsxs(z3,{fullWidth:!0,size:"small",sx:{mb:3},disabled:m,children:[be.jsx(FB,{id:"metric-select-label",children:""}),be.jsx(U3,{labelId:"metric-select-label",value:a,label:"",onChange:z=>l(z.target.value),children:e.map(z=>be.jsx(KA,{value:z.key,children:ome[z.key]??z.key},z.key))})]}),be.jsx(bo,{sx:{height:300,display:"flex",alignItems:"center",justifyContent:"center"},children:m?be.jsx(c0,{}):be.jsx(Wue,{width:"100%",height:"100%",children:be.jsxs(nme,{data:i,children:[be.jsx("defs",{children:be.jsxs("linearGradient",{id:"yellowFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[be.jsx("stop",{offset:"5%",stopColor:"#FFEB3B",stopOpacity:.8}),be.jsx("stop",{offset:"95%",stopColor:"#FFEB3B",stopOpacity:0})]})}),be.jsx(H8,{dataKey:"date",tickFormatter:z=>new Date(z).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"})}),be.jsx(q8,{}),be.jsx(Bue,{labelFormatter:z=>`: ${new Date(z).toLocaleDateString("ru-RU",{day:"2-digit",month:"long",year:"numeric"})}`,formatter:z=>[`${z}`,""]}),be.jsx(G8,{type:"monotone",dataKey:"value",stroke:"#FFC107",fill:"url(#yellowFill)",strokeWidth:3,dot:{r:4}})]})})})]})}const sme=async()=>(await ol.get("/tariff/all")).data,lme=async(e,r,a)=>(await ol.put(`/tariff/${e}`,{basePrice:r,pricePerKm:a})).data,cme={start:"",comfort:"",business:"",damas:"",scooter:"",passengerCar:" ( )",labo:""},ume=()=>{const[e,r]=ae.useState([]),[a,l]=ae.useState(!0),[m,y]=ae.useState(!1);ae.useEffect(()=>{(async()=>{try{const B=await sme();r(B)}catch(B){console.error("   :",B)}finally{l(!1)}})()},[]);const T=(z,B,F)=>{r(G=>G.map(Q=>Q.id===z?{...Q,[B]:B==="id"?F:Number(F)}:Q))},i=async()=>{try{y(!0);for(const z of e)await lme(z.id,z.basePrice,z.pricePerKm);Zo.success("  ")}finally{y(!1)}};return a?be.jsx(bo,{sx:{textAlign:"center",mt:4},children:be.jsx(c0,{})}):be.jsxs(bo,{children:[be.jsx(tl,{variant:"h6",gutterBottom:!0,children:" "}),be.jsx(QB,{children:be.jsxs(XB,{sx:{minWidth:650},children:[be.jsx(YX,{children:be.jsxs($b,{children:[be.jsx(Vs,{children:" "}),be.jsx(Vs,{align:"right",children:"  "}),be.jsx(Vs,{align:"right",children:" "})]})}),be.jsx(YB,{children:e.map(z=>be.jsxs($b,{children:[be.jsx(Vs,{children:cme[z.id]??""}),be.jsx(Vs,{align:"right",children:be.jsx(ds,{type:"number",value:z.pricePerKm,onChange:B=>T(z.id,"pricePerKm",B.target.value),size:"small"})}),be.jsx(Vs,{align:"right",children:be.jsx(ds,{type:"number",value:z.basePrice,onChange:B=>T(z.id,"basePrice",B.target.value),size:"small"})})]},z.id))})]})}),be.jsx(bo,{sx:{textAlign:"right",mt:2},children:be.jsx(Tf,{variant:"contained",onClick:i,disabled:m,children:m?"...":""})}),be.jsx(Xp,{})]})},PL=()=>{const[e,r]=ae.useState(""),[a,l]=ae.useState(0),m=async()=>{const y=await cee("+998"+e);await uee(y.id,a),Zo.success(`  ${a} `)};return be.jsxs(bo,{sx:{display:"flex",flexDirection:"column",gap:2},children:[be.jsx(tl,{variant:"h6",children:"  ()"}),be.jsx(sy,{value:e,onChange:y=>r(y.target.value)}),be.jsx(ds,{size:"small",label:"",type:"number",value:a,onChange:y=>l(+y.target.value)}),be.jsx(Tf,{variant:"contained",onClick:m,children:""}),be.jsx(Xp,{})]})};var Vu=(function(e){e=e||{};var r=typeof e<"u"?e:{},a={},l;for(l in r)r.hasOwnProperty(l)&&(a[l]=r[l]);var m="";function y(le){return r.locateFile?r.locateFile(le,m):m+le}var T;typeof document<"u"&&document.currentScript&&(m=document.currentScript.src),m.indexOf("blob:")!==0?m=m.substr(0,m.lastIndexOf("/")+1):m="",T=function(ge,Me,ze){var g=new XMLHttpRequest;g.open("GET",ge,!0),g.responseType="arraybuffer",g.onload=function(){if(g.status==200||g.status==0&&g.response){Me(g.response);return}var At=Qi(ge);if(At){Me(At.buffer);return}ze()},g.onerror=ze,g.send(null)};var i=r.print||console.log.bind(console),z=r.printErr||console.warn.bind(console);for(l in a)a.hasOwnProperty(l)&&(r[l]=a[l]);a=null,r.arguments&&r.arguments;var B=0,F=function(le){B=le},G=function(){return B},Q=8;function te(le,ge,Me,ze){switch(Me=Me||"i8",Me.charAt(Me.length-1)==="*"&&(Me="i32"),Me){case"i1":Re[le>>0]=ge;break;case"i8":Re[le>>0]=ge;break;case"i16":wt[le>>1]=ge;break;case"i32":Et[le>>2]=ge;break;case"i64":Qa=[ge>>>0,(Io=ge,+Zi(Io)>=1?Io>0?(mo(+Rn(Io/4294967296),4294967295)|0)>>>0:~~+wn((Io-+(~~Io>>>0))/4294967296)>>>0:0)],Et[le>>2]=Qa[0],Et[le+4>>2]=Qa[1];break;case"float":et[le>>2]=ge;break;case"double":Zt[le>>3]=ge;break;default:ut("invalid type for setValue: "+Me)}}function ne(le,ge,Me){switch(ge=ge||"i8",ge.charAt(ge.length-1)==="*"&&(ge="i32"),ge){case"i1":return Re[le>>0];case"i8":return Re[le>>0];case"i16":return wt[le>>1];case"i32":return Et[le>>2];case"i64":return Et[le>>2];case"float":return et[le>>2];case"double":return Zt[le>>3];default:ut("invalid type for getValue: "+ge)}return null}var oe=!1;function ue(le,ge){le||ut("Assertion failed: "+ge)}function ye(le){var ge=r["_"+le];return ue(ge,"Cannot call unknown function "+le+", make sure it is exported"),ge}function we(le,ge,Me,ze,g){var ce={string:function(wr){var zn=0;if(wr!=null&&wr!==0){var Un=(wr.length<<2)+1;zn=bc(Un),st(wr,zn,Un)}return zn},array:function(wr){var zn=bc(wr.length);return dt(wr,zn),zn}};function At(wr){return ge==="string"?Be(wr):ge==="boolean"?!!wr:wr}var Je=ye(le),vt=[],Lt=0;if(ze)for(var kt=0;kt<ze.length;kt++){var Fr=ce[Me[kt]];Fr?(Lt===0&&(Lt=hd()),vt[kt]=Fr(ze[kt])):vt[kt]=ze[kt]}var Dr=Je.apply(null,vt);return Dr=At(Dr),Lt!==0&&Gs(Lt),Dr}function ve(le,ge,Me,ze){Me=Me||[];var g=Me.every(function(At){return At==="number"}),ce=ge!=="string";return ce&&g&&!ze?ye(le):function(){return we(le,ge,Me,arguments)}}var Ce=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Ee(le,ge,Me){for(var ze=ge+Me,g=ge;le[g]&&!(g>=ze);)++g;if(g-ge>16&&le.subarray&&Ce)return Ce.decode(le.subarray(ge,g));for(var ce="";ge<g;){var At=le[ge++];if(!(At&128)){ce+=String.fromCharCode(At);continue}var Je=le[ge++]&63;if((At&224)==192){ce+=String.fromCharCode((At&31)<<6|Je);continue}var vt=le[ge++]&63;if((At&240)==224?At=(At&15)<<12|Je<<6|vt:At=(At&7)<<18|Je<<12|vt<<6|le[ge++]&63,At<65536)ce+=String.fromCharCode(At);else{var Lt=At-65536;ce+=String.fromCharCode(55296|Lt>>10,56320|Lt&1023)}}return ce}function Be(le,ge){return le?Ee(Pt,le,ge):""}function Ke(le,ge,Me,ze){if(!(ze>0))return 0;for(var g=Me,ce=Me+ze-1,At=0;At<le.length;++At){var Je=le.charCodeAt(At);if(Je>=55296&&Je<=57343){var vt=le.charCodeAt(++At);Je=65536+((Je&1023)<<10)|vt&1023}if(Je<=127){if(Me>=ce)break;ge[Me++]=Je}else if(Je<=2047){if(Me+1>=ce)break;ge[Me++]=192|Je>>6,ge[Me++]=128|Je&63}else if(Je<=65535){if(Me+2>=ce)break;ge[Me++]=224|Je>>12,ge[Me++]=128|Je>>6&63,ge[Me++]=128|Je&63}else{if(Me+3>=ce)break;ge[Me++]=240|Je>>18,ge[Me++]=128|Je>>12&63,ge[Me++]=128|Je>>6&63,ge[Me++]=128|Je&63}}return ge[Me]=0,Me-g}function st(le,ge,Me){return Ke(le,Pt,ge,Me)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function dt(le,ge){Re.set(le,ge)}function bt(le,ge){return le%ge>0&&(le+=ge-le%ge),le}var ht,Re,Pt,wt,Et,et,Zt;function ir(le){ht=le,r.HEAP8=Re=new Int8Array(le),r.HEAP16=wt=new Int16Array(le),r.HEAP32=Et=new Int32Array(le),r.HEAPU8=Pt=new Uint8Array(le),r.HEAPU16=new Uint16Array(le),r.HEAPU32=new Uint32Array(le),r.HEAPF32=et=new Float32Array(le),r.HEAPF64=Zt=new Float64Array(le)}var or=5271520,ft=28608,Vt=r.TOTAL_MEMORY||33554432;r.buffer?ht=r.buffer:ht=new ArrayBuffer(Vt),Vt=ht.byteLength,ir(ht),Et[ft>>2]=or;function Jt(le){for(;le.length>0;){var ge=le.shift();if(typeof ge=="function"){ge();continue}var Me=ge.func;typeof Me=="number"?ge.arg===void 0?r.dynCall_v(Me):r.dynCall_vi(Me,ge.arg):Me(ge.arg===void 0?null:ge.arg)}}var Cr=[],ln=[],tn=[],Hr=[];function Nn(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Sn(r.preRun.shift());Jt(Cr)}function jn(){Jt(ln)}function Ur(){Jt(tn)}function Gr(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Tr(r.postRun.shift());Jt(Hr)}function Sn(le){Cr.unshift(le)}function Tr(le){Hr.unshift(le)}var Zi=Math.abs,wn=Math.ceil,Rn=Math.floor,mo=Math.min,di=0,Ao=null;function eo(le){di++,r.monitorRunDependencies&&r.monitorRunDependencies(di)}function $o(le){if(di--,r.monitorRunDependencies&&r.monitorRunDependencies(di),di==0&&Ao){var ge=Ao;Ao=null,ge()}}r.preloadedImages={},r.preloadedAudios={};var _i=null,Bn="data:application/octet-stream;base64,";function Ca(le){return String.prototype.startsWith?le.startsWith(Bn):le.indexOf(Bn)===0}var Io,Qa;_i="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAEAAAAAAAAAAAEAAAAAAQAAAAAAAAAAAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAABAAAAAAAAAAAAAQAAAAAAAAAAAAA6B6FaUp9QQTPXMuL4myJBraiDfBwx9UBYJseitzTIQOL5if9jqZtAnXX+Z+ycb0C3pucbhRBCQG8wJBYqpRRAlWbDCzCY5z/eFWBUEve6P/+qo4Q50Y4/D9YM3iCcYT8fcA2QJSA0P4ADxu0qAAc/BNcGolVJ2j5d9FACqwquPh9z7MthtI9CSUSYJke/YUJQ/64OyjU0Qpi0+HCmFQdCm3GfIVdh2kHsJ11kAyauQYC3UDFJOoFBSJsFV1OwU0FK5fcxX4AmQWhy/zZIt/lACqaCPsBjzUDbdUNIScugQMYQlVJ4MXNANiuq8GTvRUDxTXnulxEZQFZ8QX5kpuw/qmG/JwYFlEAluh3Q6DB+QKn4vyNq0GZAKOXekas+UUB8xabXXhI6QG63C2pLtSNAdDBtyNfLDUDyOcu67ID2P0rCMvRXAeE/Ki2TSVyzyT9Dk+8Sz2uzP5J+w5ARWp0/NQAoOiMuhj9YnP+RyMJwPxgW7TvQVFk/KgsLYF0kQz9g5dAC6IwzQcgHPVvDex1B1XjppodHBkHJq3OMM9fwQNvcmJ7wddlAInGPpQs/w0BRobq5EBmtQJZ2ai7n+ZVAtv2G5E+bgECG+gIfKBlpQK5f8jdI91JAL39sL/WpPEB8rGxhDqklQK6yUf43XhBAxL9y/tK8+D86XyZpgrHiPwAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAP////8AAAAAAAAAAAAAAAABAAAAAAAAAAAAAAD/////AAAAAAAAAAABAAAAAQAAAAAAAAAAAAAA/////wAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8FAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQAAAAAAAQABAAABAQAAAAAAAQAAAAEAAAABAAEAAAAAAAAAAAAAAAAAAAAAquJYWJZl+D9jaeZNtj/zPwwdI9KqaeO/qGefXwdHdz+q4lhYlmX4P+OrlPMN3PI/DB0j0qpp47+7SQLV4VIEQKriWFiWZfg/r2kma3tz8T82eQmLqNIGwMRIWXMqSvo/fcCszPux9j+jara6ozTwP6hnn18HR3c/MSoKLequ8r+SabgA2nj0P7jBLbDOHO8/1Ym/ICfH4T+6lxjvlFXHv73m373LRPU/0vXyDVxo7T+ToKRHJXMAQF/33578aPE/pAyy64tD9T8+U/hCvyruPwxv8Y7YYwLAuXYr8NAiCEB4+LDK0Sn0P1Qeuy4j+eo/OMx50n7K7L+TrGB/nyf8v5ehC2fbYPM/aXMKexiT6z8mFRIMjg/zP7yUVwGGBNw/E6opHERf8z/z0wR2g9DqPw4pBpcOhvu/NbA29uWAA8DMaTExyXzyP02biiQ+Ruk/S8jz2/FKBEB1pzZnpbb9P7pQU4wLfPI//7ZcQXeG6D9CqEQvAYoIwDB2VB6sSgRAVyv8H5We8T+EHWF8XNPmPzB2wT8Nrrg/SEi+cX+w4L8of+GtdSDxP1sjk5AdouU/6ZjOVru13r8K0obqI6bxvwVbdNXyhfA/w5GG024n5z+rwmtMzP8BwLw9pSX49QXABe/2uQxP8D+b6wCzCvXkP7uGT87fK+Q/pz/JWw4coj+qoBf2J0nwP/yE3PUo0+I/vFJeHcaC+D96luSIqvntP/bf8sHUYu8/gZNN41mL4z9bhOqVOF4FwO6lmAh1hQhAbCVxbdhk7z+1C8NdDcfiPwG36x/0OQBAx0WJ76c2+D9nlSHXANfuP2HlfZ3gqOE/EwnVlVPg9r96+oHzEH//v5bXzdT1Auw/DM3GwLsA4D9p/8uoKcr+v+U9x5DQVAPAehjSdghb7D9sc1IetODgP8MVwwB1pu6/azPk6OGe978W8t/TUc3rP+0QMvYfP+A/RsG/QpSE8D+l3uwScxzgPwQaifgujuw/k1Vti1I43z8MAwLnSh0GQH5nYnwwZgJAiGUzWC5s6j8WyyI/BbLgPw4iUapGeQJAB3W+imnp/j9BLWR4ssrpP2t+gG5Pstk/cpBsfm6DCMCOpU9dOZsFQEv8nFypHeo/ehJ6i+6S2D9jqlGEmarLv7STC5TRiOa/bC+x8WZD6D9H3yUkWpDZP8gZvmCMuQLAreY19/eRBsCoPOc8UzzpP6KI/QV+y9g/t/MoboyWzT+Hv5q3Zu3Mvy2xROCT4uY/9gQitMMg1T9abAqhWMDkv1oLTavoUfG/PMUJP9CD5j+fHRX3t6fSPz7W2gk6bvs/WRnuHwqN9D8YFturGCTmP1EZczv0b9I/5t4exabB5D/1ESLh5fTEP9X2z6SYweQ/6lv3I2zT0D9zkRGNUNMAQKoSvc4EIfs/Xggt8wQI5T+mJHHg/w/SP4lhT/9t8vQ/DrZ/DbwH7D+XlhbYZrjkP34LIpFt6c4/lwfp8fLX9L+j96CTTf76v3WdNhEv9uM/d8c3o4lV0D/vFdCHVcsFwAHeDq0F1QhApbYqcZiN5D9KoilqByXLPwX0/diA0vq/0fo0GxnxAMBbaTkvlCzjP/RrFrWXrMs/UYTrky7jA0DB9f4FiZYAQEGAk/3QzeE/r/TeqE8t0D/OqjlsnPbvvz8RKU8JOfW/smSEbK/O4T8MzuyPm3DDP/rFtctq9gZAfb1EVEaSA0Dts5dVInnhP18SFMc79MM/7y34cw6LAMDFrRJsZO0DwC2KLvLSYuA/hx5wcUHewz+49SnK/4ruPyeS0PX9a+E/ZxaaLvvZ3z8WPu5T2QS8Pygo4RIvMqa/BJ0Kqsd0279cKW4ay8jdP3b05bmZ364/10/qtdxk2r+Bcz6CDMvpv54qOw+Amdw/qLV71pW7sT/YKc80nIPUP8OfIaBJ77G/LyTuD1un2z+diYu8efWzP1wU7ACkfwjAZroyPL1yBkAmv3lKJJbbPysKSE4W+p0/dIgqY79TA8ATLTOQ3tsGwJ2zweD/Xdg/XO/jXeFUaL8VW2qLFKfov1cA9Aa6XfK/tIa7YGgI2T+f3hu/sxqPv2nXdPpf3Pc/jkw8Jbda8j+tT/z8tGPVP1yBHpJd35k/KYvYOy1s8j/yz+kCQjPrP9+agH7x59g/PZfJ9aBhpr/rDKzvYBb+PwtkiaGCt/c/vb1mVr+f1T/JIHwHc8Govw7aeF6+9vG/Xv7kD6fp979isYioQYHVP7AIQZuSFrG/3z1AdUTnAUDN3XY9O7f9P0AdQ9ljYNQ/dJANJPTOrb8kLECUiiPlP4yF7UgmStA/9xGmXxCG1T9qZzix4W2zv2SGJRJVrPe/Fh9a2M/B/b8IexzFCoPSP9y1QFD2bLe/Q86cWLJe/b+mOOfYm78BwOTjkPAGE9E/8aPCUKu/ub9pPZyLCiUGwBA7Mev/BQlALOmrlRi+0j+AMJ/dKULBv7iLtL6a6QRAEMDV/yajAUDa62dE3crJP1P70RgBUbq/38hVnR6esT/s1tG10Z/Ov/zLwalHPss/dTS9NKTXx78nMcRzCIEHQAabxDsAmQRA0tyLK3gSyT+Aui7nOhDGv5Gs58z3WgHATN3forJuBMCAui7nOhDGP9Lciyt4Esm/WAJyHQ4c7z8UP5HFIs3iP3U0vTSk18c//MvBqUc+y7+cvv8HLg/Kvy1I/mHsI+K/U/vRGAFRuj/a62dE3crJv8p+WV8KlQjAuQ/nOP43B0CAMJ/dKULBPyzpq5UYvtK/ZoU+VoLh4L9etLlRUfvtv/GjwlCrv7k/5OOQ8AYT0b9DfT9FhufXPwUX8hJp+4u/3LVAUPZstz8IexzFCoPSv9+L609E5fQ/q9Fz7X2J7T9qZzix4W2zP/cRpl8QhtW/vtNilqGX+j8MOy7QJoL0P3SQDST0zq0/QB1D2WNg1L8IIjSvGNkDwGB8Jou2GAfAsAhBm5IWsT9isYioQYHVvyS9D3zb6uy/gnwRa7uM9L/JIHwHc8GoP729Zla/n9W/CsAHJZwmAEDEW6OYT1r6Pz2XyfWgYaY/35qAfvHn2L83Tdy4lS30vxf2/gZ0jPq/XIEekl3fmb+tT/z8tGPVvybPr2zJ1/+/K7mJ0ypVAsCf3hu/sxqPPwCGu2BoCNm/5oITrpZn+r+UDUyDP+n/v1zv413hVGg/nbPB4P9d2L9MlmkxNvgCQMtZlKE85v8/KwpIThb6nb8mv3lKJJbbv8+SZsTvOOc/pQCIIOYw0j+diYu8efWzvy8k7g9bp9u/kxYDa+pKtD9XlYvA8HnVv6i1e9aVu7G/nio7D4CZ3L/WR6rNh5EGwCkgQweBkghAdvTluZnfrr9cKW4ay8jdvxbjhr1f1QVAR5C0MzivAkAWPu5T2QS8v2cWmi772d+/cKj4lzLJCEBx2QJfYrMFQIcecHFB3sO/LYou8tJi4L+jr7lhO38BwIcI0Nb7xgTAXxIUxzv0w7/ts5dVInnhv0T+l8DZLfE/MP3FoFvS5D8MzuyPm3DDv7JkhGyvzuG/tzhzRIRc0b9Ovv3/0z7mv6/03qhPLdC/m4CT/dDN4b9dwjU5VCQBQBBJX1ntCv0/9GsWtZesy79baTkvlCzjv1mjYgEz++S/oW6KnOQW8b9KoilqByXLv6W2KnGYjeS/SmaKz3Vx9z+BZB5yxGHwP3fHN6OJVdC/dZ02ES/2478PuaBjLrXaP4/JU81pPaO/fgsikW3pzr+XlhbYZrjkv4tSn7YDbP0/f2LnFKlF9z+mJHHg/w/Sv14ILfMECOW/mfg4qYhR/b+OP+RQDCACwOpb9yNs09C/1fbPpJjB5L9pN2WOVZ3wv3hHy9nxIve/URlzO/Rv0r8YFturGCTmv1d1/KKR8QPA8gsy9qzSB8CfHRX3t6fSvzzFCT/Qg+a/EYStnrzV9r/2QJqI7Lb9v/YEIrTDINW/LbFE4JPi5r/7kQEs5fEDQHunnf4GeQBAooj9BX7L2L+oPOc8Uzzpv+ydYY2SSAfAL4HK6CRTB0BH3yUkWpDZv2wvsfFmQ+i/Ik0Yzruh6T8fM3LoGoDUP3oSeovukti/S/ycXKkd6r9rEv+7UWcHQCRIQe/GfwNAa36Abk+y2b9BLWR4ssrpv9KT87qa0bM/FTyktw823L8WyyI/BbLgv4hlM1gubOq/DizMp9Ki6r8b5ckdjVrzv5NVbYtSON+/BBqJ+C6O7L/dUBFqgyXYv00Wh18r7+q/7RAy9h8/4L8W8t/TUc3rv4RM5DKx3wDAfvWIj94aBcBsc1IetODgv3oY0nYIW+y/oGcTFF54AUDkJqS/FKX6PwzNxsC7AOC/ltfN1PUC7L+5Wrz/zHnzP6688w2rNOc/YeV9neCo4b9nlSHXANfuvw9RsxKjY/s/1V8GteXE8j+1C8NdDcfiv2wlcW3YZO+/IOywaA7Q8b9bFP+4Tg36v4GTTeNZi+O/9t/ywdRi77+tRc3yFR7eP2bkcHXJkLO//ITc9SjT4r+qoBf2J0nwv2YHKoswwfm/iQcLspCjAcCb6wCzCvXkvwXv9rkMT/C/YkuwYAMXBMApCNUai9kIwMORhtNuJ+e/BVt01fKF8L+ZqWEfvIjsP6h693QZYNk/WyOTkB2i5b8of+GtdSDxvwpaaulDSwVADMQAX+lOAECEHWF8XNPmv1cr/B+VnvG/XyFG6opcCMD/mtR32/UEQP+2XEF3hui/ulBTjAt88r/imfCfRP+yP9zbvtc8XeO/TZuKJD5G6b/MaTExyXzyvxiTQeElXOO/rbJRQVGN9L/z0wR2g9DqvxOqKRxEX/O/FDGCEei99j9x8zV4VYTmP2lzCnsYk+u/l6ELZ9tg878pRXacaDT/v3k6GZRqoQXAVB67LiP56r94+LDK0Sn0vwO6pZ9b7wFAvK0nKVcc9j8+U/hCvyruv6QMsuuLQ/W/FPhKFYv46j8MyxaDTOW/v9L18g1caO2/vebfvctE9b/7GD8ZrF3xv3gx1AR9bQDAuMEtsM4c77+SabgA2nj0v5xKFIwxsATArKNSBaKsB0Cjara6ozTwv33ArMz7sfa/dF2U0FcWCcDxL357DJX/P69pJmt7c/G/quJYWJZl+L/YntVJlnrSP4sRLzXM+fe/46uU8w3c8r+q4lhYlmX4v85lu5+QRwRAsI0H/WU8479jaeZNtj/zv6riWFiWZfi/sI0H/WU847/OZbufkEcEQHAoPUBrnss/9exKzDtFtT88wM8kax+gP9OqeKeAYog/MW0ItiZvcj+ph+smvt5bP2lCaV5dEUU/StaUmQDaLz+kK9y22BMYP0O3whZuMwI/IIbgZGWE6z7UkjYaEM3UPuezxwa9cr8+LybxRMnFpz6E1N8DbPiRPsYjySMvK3s+//////8fAAj//////zMQCP////9/MiAI/////28yMAj/////YzJACP///z9iMlAI////N2IyYAj///8zYjJwCP//vzNiMoAI//+rM2IykAj/f6szYjKgCP8PqzNiMrAI/wOrM2IywAi/A6szYjLQCJ8DqzNiMuAImQOrM2Iy8Aj//////z8PCP//////Kx8I/////38pLwj/////Pyk/CP////85KU8I////PzgpXwj///8POClvCP///w44KX8I//8fDjgpjwj//w8OOCmfCP9/DQ44Ka8I/w8NDjgpvwj/DQ0OOCnPCP8MDQ44Kd8IxwwNDjgp7wjEDA0OOCn/CAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAABgtRFT7Ifk/GC1EVPsh+b8YLURU+yEJQBgtRFT7IQnAYWxnb3MuYwBoM05laWdoYm9yUm90YXRpb25zAGNvb3JkaWprLmMAX3VwQXA3Q2hlY2tlZABfdXBBcDdyQ2hlY2tlZABkaXJlY3RlZEVkZ2UuYwBkaXJlY3RlZEVkZ2VUb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpclt0bXBGaWprLmZhY2VdW2ZpamsuZmFjZV0gPT0gS0kAZmFjZWlqay5jAF9mYWNlSWprUGVudFRvQ2VsbEJvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9DZWxsQm91bmRhcnkAaDNJbmRleC5jAGNvbXBhY3RDZWxscwBsYXRMbmdUb0NlbGwAY2VsbFRvQ2hpbGRQb3MAdmFsaWRhdGVDaGlsZFBvcwBsYXRMbmcuYwBjZWxsQXJlYVJhZHMyAHBvbHlnb24tPm5leHQgPT0gTlVMTABsaW5rZWRHZW8uYwBhZGROZXdMaW5rZWRQb2x5Z29uAG5leHQgIT0gTlVMTABsb29wICE9IE5VTEwAYWRkTmV3TGlua2VkTG9vcABwb2x5Z29uLT5maXJzdCA9PSBOVUxMAGFkZExpbmtlZExvb3AAY29vcmQgIT0gTlVMTABhZGRMaW5rZWRDb29yZABsb29wLT5maXJzdCA9PSBOVUxMAGlubmVyTG9vcHMgIT0gTlVMTABub3JtYWxpemVNdWx0aVBvbHlnb24AYmJveGVzICE9IE5VTEwAY2FuZGlkYXRlcyAhPSBOVUxMAGZpbmRQb2x5Z29uRm9ySG9sZQBjYW5kaWRhdGVCQm94ZXMgIT0gTlVMTAByZXZEaXIgIT0gSU5WQUxJRF9ESUdJVABsb2NhbGlqLmMAY2VsbFRvTG9jYWxJamsAYmFzZUNlbGwgIT0gb3JpZ2luQmFzZUNlbGwAIShvcmlnaW5PblBlbnQgJiYgaW5kZXhPblBlbnQpAGJhc2VDZWxsID09IG9yaWdpbkJhc2VDZWxsAGJhc2VDZWxsICE9IElOVkFMSURfQkFTRV9DRUxMAGxvY2FsSWprVG9DZWxsACFfaXNCYXNlQ2VsbFBlbnRhZ29uKGJhc2VDZWxsKQBiYXNlQ2VsbFJvdGF0aW9ucyA+PSAwAGdyaWRQYXRoQ2VsbHMAcG9seWZpbGwuYwBpdGVyU3RlcFBvbHlnb25Db21wYWN0ADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var ao=28624;function ai(le,ge,Me,ze){ut("Assertion failed: "+Be(le)+", at: "+[ge?Be(ge):"unknown filename",Me,ze?Be(ze):"unknown function"])}function Po(){return Re.length}function to(le,ge,Me){Pt.set(Pt.subarray(ge,ge+Me),le)}function Va(le){return r.___errno_location&&(Et[r.___errno_location()>>2]=le),le}function Mi(le){ut("OOM")}function os(le){try{var ge=new ArrayBuffer(le);return ge.byteLength!=le?void 0:(new Int8Array(ge).set(Re),If(ge),ir(ge),1)}catch{}}function yl(le){var ge=Po(),Me=16777216,ze=2147483648-Me;if(le>ze)return!1;for(var g=16777216,ce=Math.max(ge,g);ce<le;)ce<=536870912?ce=bt(2*ce,Me):ce=Math.min(bt((3*ce+2147483648)/4,Me),ze);var At=os(ce);return!!At}var al=typeof atob=="function"?atob:function(le){var ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Me="",ze,g,ce,At,Je,vt,Lt,kt=0;le=le.replace(/[^A-Za-z0-9\+\/\=]/g,"");do At=ge.indexOf(le.charAt(kt++)),Je=ge.indexOf(le.charAt(kt++)),vt=ge.indexOf(le.charAt(kt++)),Lt=ge.indexOf(le.charAt(kt++)),ze=At<<2|Je>>4,g=(Je&15)<<4|vt>>2,ce=(vt&3)<<6|Lt,Me=Me+String.fromCharCode(ze),vt!==64&&(Me=Me+String.fromCharCode(g)),Lt!==64&&(Me=Me+String.fromCharCode(ce));while(kt<le.length);return Me};function $n(le){try{for(var ge=al(le),Me=new Uint8Array(ge.length),ze=0;ze<ge.length;++ze)Me[ze]=ge.charCodeAt(ze);return Me}catch{throw new Error("Converting base64 string to bytes failed.")}}function Qi(le){if(Ca(le))return $n(le.slice(Bn.length))}var Xo={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},ro={b:F,c:G,d:ai,e:Va,f:Po,g:to,h:yl,i:Mi,o:ao,p:ft},Ir=(function(le,ge,Me){"almost asm";var ze=new le.Int8Array(Me),g=new le.Int32Array(Me);new le.Uint8Array(Me),new le.Float32Array(Me);var ce=new le.Float64Array(Me),At=ge.o|0,Je=ge.p|0,vt=le.Math.floor,Lt=le.Math.abs,kt=le.Math.sqrt,Fr=le.Math.pow,Dr=le.Math.cos,wr=le.Math.sin,zn=le.Math.tan,Un=le.Math.acos,Yn=le.Math.asin,Ii=le.Math.atan,Fn=le.Math.atan2,go=le.Math.ceil,wo=le.Math.imul,ia=le.Math.min,Ui=le.Math.max,ri=le.Math.clz32,yn=ge.b,He=ge.c,mn=ge.d,ca=ge.e,as=ge.f,Hs=ge.g,tu=ge.h,ss=ge.i,Fe=28640;function Qp(b){return ze=new Int8Array(b),g=new Int32Array(b),ce=new Float64Array(b),Me=b,!0}function Yu(b){b=b|0;var w=0;return w=Fe,Fe=Fe+b|0,Fe=Fe+15&-16,w|0}function ru(){return Fe|0}function Rf(b){b=b|0,Fe=b}function Qu(b,w){b=b|0,Fe=b}function Ku(b,w){b=b|0,w=w|0;var S=0,R=0,O=0;return(b|0)<0?(w=2,w|0):(b|0)>13780509?(w=es(15,w)|0,w|0):(S=((b|0)<0)<<31>>31,O=La(b|0,S|0,3,0)|0,R=He()|0,S=qn(b|0,S|0,1,0)|0,S=La(O|0,R|0,S|0,He()|0)|0,S=qn(S|0,He()|0,1,0)|0,b=He()|0,g[w>>2]=S,g[w+4>>2]=b,w=0,w|0)}function As(b,w,S,R){return b=b|0,w=w|0,S=S|0,R=R|0,Df(b,w,S,R,0)|0}function Df(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0;if(re=Fe,Fe=Fe+16|0,V=re,!(Vl(b,w,S,R,O)|0))return R=0,Fe=re,R|0;do if((S|0)>=0){if((S|0)>13780509){if(j=es(15,V)|0,j|0)break;Z=V,V=g[Z>>2]|0,Z=g[Z+4>>2]|0}else j=((S|0)<0)<<31>>31,pe=La(S|0,j|0,3,0)|0,Z=He()|0,j=qn(S|0,j|0,1,0)|0,j=La(pe|0,Z|0,j|0,He()|0)|0,j=qn(j|0,He()|0,1,0)|0,Z=He()|0,g[V>>2]=j,g[V+4>>2]=Z,V=j;if(Pu(R|0,0,V<<3|0)|0,O|0){Pu(O|0,0,V<<2|0)|0,j=sl(b,w,S,R,O,V,Z,0)|0;break}j=Pa(V,4)|0,j?(pe=sl(b,w,S,R,j,V,Z,0)|0,xn(j),j=pe):j=13}else j=2;while(!1);return pe=j,Fe=re,pe|0}function Vl(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0;if(Rt=Fe,Fe=Fe+16|0,ot=Rt,at=Rt+8|0,nt=ot,g[nt>>2]=b,g[nt+4>>2]=w,(S|0)<0)return at=2,Fe=Rt,at|0;if(j=R,g[j>>2]=b,g[j+4>>2]=w,j=(O|0)!=0,j&&(g[O>>2]=0),So(b,w)|0)return at=9,Fe=Rt,at|0;g[at>>2]=0;e:do if((S|0)>=1)if(j)for(xe=1,pe=0,qe=0,nt=1,j=b;;){if(!(pe|qe)){if(j=oa(j,w,4,at,ot)|0,j|0)break e;if(w=ot,j=g[w>>2]|0,w=g[w+4>>2]|0,So(j,w)|0){j=9;break e}}if(j=oa(j,w,g[26800+(qe<<2)>>2]|0,at,ot)|0,j|0)break e;if(w=ot,j=g[w>>2]|0,w=g[w+4>>2]|0,b=R+(xe<<3)|0,g[b>>2]=j,g[b+4>>2]=w,g[O+(xe<<2)>>2]=nt,b=pe+1|0,V=(b|0)==(nt|0),Z=qe+1|0,re=(Z|0)==6,So(j,w)|0){j=9;break e}if(nt=nt+(re&V&1)|0,(nt|0)>(S|0)){j=0;break}else xe=xe+1|0,pe=V?0:b,qe=V?re?0:Z:qe}else for(xe=1,pe=0,qe=0,nt=1,j=b;;){if(!(pe|qe)){if(j=oa(j,w,4,at,ot)|0,j|0)break e;if(w=ot,j=g[w>>2]|0,w=g[w+4>>2]|0,So(j,w)|0){j=9;break e}}if(j=oa(j,w,g[26800+(qe<<2)>>2]|0,at,ot)|0,j|0)break e;if(w=ot,j=g[w>>2]|0,w=g[w+4>>2]|0,b=R+(xe<<3)|0,g[b>>2]=j,g[b+4>>2]=w,b=pe+1|0,V=(b|0)==(nt|0),Z=qe+1|0,re=(Z|0)==6,So(j,w)|0){j=9;break e}if(nt=nt+(re&V&1)|0,(nt|0)>(S|0)){j=0;break}else xe=xe+1|0,pe=V?0:b,qe=V?re?0:Z:qe}else j=0;while(!1);return at=j,Fe=Rt,at|0}function sl(b,w,S,R,O,j,V,Z){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0,j=j|0,V=V|0,Z=Z|0;var re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0;if(Rt=Fe,Fe=Fe+16|0,ot=Rt+8|0,at=Rt,re=cc(b|0,w|0,j|0,V|0)|0,xe=He()|0,qe=R+(re<<3)|0,jt=qe,fr=g[jt>>2]|0,jt=g[jt+4>>2]|0,pe=(fr|0)==(b|0)&(jt|0)==(w|0),!((fr|0)==0&(jt|0)==0|pe))do re=qn(re|0,xe|0,1,0)|0,re=Iu(re|0,He()|0,j|0,V|0)|0,xe=He()|0,qe=R+(re<<3)|0,fr=qe,jt=g[fr>>2]|0,fr=g[fr+4>>2]|0,pe=(jt|0)==(b|0)&(fr|0)==(w|0);while(!((jt|0)==0&(fr|0)==0|pe));if(re=O+(re<<2)|0,pe&&(g[re>>2]|0)<=(Z|0)||(fr=qe,g[fr>>2]=b,g[fr+4>>2]=w,g[re>>2]=Z,(Z|0)>=(S|0)))return fr=0,Fe=Rt,fr|0;switch(pe=Z+1|0,g[ot>>2]=0,re=oa(b,w,2,ot,at)|0,re|0){case 9:{nt=9;break}case 0:{re=at,re=sl(g[re>>2]|0,g[re+4>>2]|0,S,R,O,j,V,pe)|0,re||(nt=9);break}}e:do if((nt|0)==9){switch(g[ot>>2]=0,re=oa(b,w,3,ot,at)|0,re|0){case 9:break;case 0:{if(re=at,re=sl(g[re>>2]|0,g[re+4>>2]|0,S,R,O,j,V,pe)|0,re|0)break e;break}default:break e}switch(g[ot>>2]=0,re=oa(b,w,1,ot,at)|0,re|0){case 9:break;case 0:{if(re=at,re=sl(g[re>>2]|0,g[re+4>>2]|0,S,R,O,j,V,pe)|0,re|0)break e;break}default:break e}switch(g[ot>>2]=0,re=oa(b,w,5,ot,at)|0,re|0){case 9:break;case 0:{if(re=at,re=sl(g[re>>2]|0,g[re+4>>2]|0,S,R,O,j,V,pe)|0,re|0)break e;break}default:break e}switch(g[ot>>2]=0,re=oa(b,w,4,ot,at)|0,re|0){case 9:break;case 0:{if(re=at,re=sl(g[re>>2]|0,g[re+4>>2]|0,S,R,O,j,V,pe)|0,re|0)break e;break}default:break e}switch(g[ot>>2]=0,re=oa(b,w,6,ot,at)|0,re|0){case 9:break;case 0:{if(re=at,re=sl(g[re>>2]|0,g[re+4>>2]|0,S,R,O,j,V,pe)|0,re|0)break e;break}default:break e}return fr=0,Fe=Rt,fr|0}while(!1);return fr=re,Fe=Rt,fr|0}function oa(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0;if(S>>>0>6)return O=1,O|0;if(qe=(g[R>>2]|0)%6|0,g[R>>2]=qe,(qe|0)>0){j=0;do S=du(S)|0,j=j+1|0;while((j|0)<(g[R>>2]|0))}if(qe=Vr(b|0,w|0,45)|0,He()|0,xe=qe&127,xe>>>0>121)return O=5,O|0;re=Ki(b,w)|0,j=Vr(b|0,w|0,52)|0,He()|0,j=j&15;e:do if(!j)pe=8;else{for(;;){if(V=(15-j|0)*3|0,Z=Vr(b|0,w|0,V|0)|0,He()|0,Z=Z&7,(Z|0)==7){w=5;break}if(at=(ua(j)|0)==0,j=j+-1|0,nt=Jr(7,0,V|0)|0,w=w&~(He()|0),ot=Jr(g[(at?432:16)+(Z*28|0)+(S<<2)>>2]|0,0,V|0)|0,V=He()|0,S=g[(at?640:224)+(Z*28|0)+(S<<2)>>2]|0,b=ot|b&~nt,w=V|w,!S){S=0;break e}if(!j){pe=8;break e}}return w|0}while(!1);(pe|0)==8&&(at=g[848+(xe*28|0)+(S<<2)>>2]|0,ot=Jr(at|0,0,45)|0,b=ot|b,w=He()|0|w&-1040385,S=g[4272+(xe*28|0)+(S<<2)>>2]|0,(at&127|0)==127&&(at=Jr(g[848+(xe*28|0)+20>>2]|0,0,45)|0,w=He()|0|w&-1040385,S=g[4272+(xe*28|0)+20>>2]|0,b=Zs(at|b,w)|0,w=He()|0,g[R>>2]=(g[R>>2]|0)+1)),Z=Vr(b|0,w|0,45)|0,He()|0,Z=Z&127;e:do if(Fo(Z)|0){t:do if((Ki(b,w)|0)==1){if((xe|0)!=(Z|0))if(au(Z,g[7696+(xe*28|0)>>2]|0)|0){b=Ec(b,w)|0,V=1,w=He()|0;break}else mn(27795,26864,533,26872);switch(re|0){case 3:{b=Zs(b,w)|0,w=He()|0,g[R>>2]=(g[R>>2]|0)+1,V=0;break t}case 5:{b=Ec(b,w)|0,w=He()|0,g[R>>2]=(g[R>>2]|0)+5,V=0;break t}case 0:return at=9,at|0;default:return at=1,at|0}}else V=0;while(!1);if((S|0)>0){j=0;do b=wd(b,w)|0,w=He()|0,j=j+1|0;while((j|0)!=(S|0))}if((xe|0)!=(Z|0)){if(!(iu(Z)|0)){if((V|0)!=0|(Ki(b,w)|0)!=5)break;g[R>>2]=(g[R>>2]|0)+1;break}switch(qe&127){case 8:case 118:break e}(Ki(b,w)|0)!=3&&(g[R>>2]=(g[R>>2]|0)+1)}}else if((S|0)>0){j=0;do b=Zs(b,w)|0,w=He()|0,j=j+1|0;while((j|0)!=(S|0))}while(!1);return g[R>>2]=((g[R>>2]|0)+S|0)%6|0,at=O,g[at>>2]=b,g[at+4>>2]=w,at=0,at|0}function ll(b,w,S,R){return b=b|0,w=w|0,S=S|0,R=R|0,vl(b,w,S,R)|0?(Pu(R|0,0,S*48|0)|0,R=cl(b,w,S,R)|0,R|0):(R=0,R|0)}function vl(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0;if(at=Fe,Fe=Fe+16|0,nt=at,ot=at+8|0,qe=nt,g[qe>>2]=b,g[qe+4>>2]=w,(S|0)<0)return ot=2,Fe=at,ot|0;if(!S)return ot=R,g[ot>>2]=b,g[ot+4>>2]=w,ot=0,Fe=at,ot|0;g[ot>>2]=0;e:do if(So(b,w)|0)b=9;else{O=0,qe=b;do{if(b=oa(qe,w,4,ot,nt)|0,b|0)break e;if(w=nt,qe=g[w>>2]|0,w=g[w+4>>2]|0,O=O+1|0,So(qe,w)|0){b=9;break e}}while((O|0)<(S|0));xe=R,g[xe>>2]=qe,g[xe+4>>2]=w,xe=S+-1|0,pe=0,b=1;do{if(O=26800+(pe<<2)|0,(pe|0)==5)for(V=g[O>>2]|0,j=0,O=b;;){if(b=nt,b=oa(g[b>>2]|0,g[b+4>>2]|0,V,ot,nt)|0,b|0)break e;if((j|0)!=(xe|0))if(re=nt,Z=g[re>>2]|0,re=g[re+4>>2]|0,b=R+(O<<3)|0,g[b>>2]=Z,g[b+4>>2]=re,!(So(Z,re)|0))b=O+1|0;else{b=9;break e}else b=O;if(j=j+1|0,(j|0)>=(S|0))break;O=b}else for(V=nt,re=g[O>>2]|0,Z=0,O=b,j=g[V>>2]|0,V=g[V+4>>2]|0;;){if(b=oa(j,V,re,ot,nt)|0,b|0)break e;if(V=nt,j=g[V>>2]|0,V=g[V+4>>2]|0,b=R+(O<<3)|0,g[b>>2]=j,g[b+4>>2]=V,b=O+1|0,So(j,V)|0){b=9;break e}if(Z=Z+1|0,(Z|0)>=(S|0))break;O=b}pe=pe+1|0}while(pe>>>0<6);b=nt,b=(qe|0)==(g[b>>2]|0)&&(w|0)==(g[b+4>>2]|0)?0:9}while(!1);return ot=b,Fe=at,ot|0}function cl(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0;if(qe=Fe,Fe=Fe+16|0,V=qe,!S)return g[R>>2]=b,g[R+4>>2]=w,R=0,Fe=qe,R|0;do if((S|0)>=0){if((S|0)>13780509){if(O=es(15,V)|0,O|0)break;j=V,O=g[j>>2]|0,j=g[j+4>>2]|0}else O=((S|0)<0)<<31>>31,xe=La(S|0,O|0,3,0)|0,j=He()|0,O=qn(S|0,O|0,1,0)|0,O=La(xe|0,j|0,O|0,He()|0)|0,O=qn(O|0,He()|0,1,0)|0,j=He()|0,xe=V,g[xe>>2]=O,g[xe+4>>2]=j;if(pe=Pa(O,8)|0,!pe)O=13;else{if(xe=Pa(O,4)|0,!xe){xn(pe),O=13;break}if(O=sl(b,w,S,pe,xe,O,j,0)|0,O|0){xn(pe),xn(xe);break}if(w=g[V>>2]|0,V=g[V+4>>2]|0,(V|0)>0|(V|0)==0&w>>>0>0){O=0,Z=0,re=0;do b=pe+(Z<<3)|0,j=g[b>>2]|0,b=g[b+4>>2]|0,!((j|0)==0&(b|0)==0)&&(g[xe+(Z<<2)>>2]|0)==(S|0)&&(nt=R+(O<<3)|0,g[nt>>2]=j,g[nt+4>>2]=b,O=O+1|0),Z=qn(Z|0,re|0,1,0)|0,re=He()|0;while((re|0)<(V|0)|(re|0)==(V|0)&Z>>>0<w>>>0)}xn(pe),xn(xe),O=0}}else O=2;while(!1);return nt=O,Fe=qe,nt|0}function xl(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0;for(Z=Fe,Fe=Fe+16|0,j=Z,V=Z+8|0,O=(So(b,w)|0)==0,O=O?1:2;;){if(g[V>>2]=0,pe=(oa(b,w,O,V,j)|0)==0,re=j,pe&((g[re>>2]|0)==(S|0)?(g[re+4>>2]|0)==(R|0):0)){b=4;break}if(O=O+1|0,O>>>0>=7){O=7,b=4;break}}return(b|0)==4?(Fe=Z,O|0):0}function gs(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0;if(Z=Fe,Fe=Fe+48|0,O=Z+16|0,j=Z+8|0,V=Z,S=Ds(S)|0,S|0)return V=S,Fe=Z,V|0;if(pe=b,re=g[pe+4>>2]|0,S=j,g[S>>2]=g[pe>>2],g[S+4>>2]=re,hh(j,O),S=Ms(O,w,V)|0,!S){if(w=g[j>>2]|0,j=g[b+8>>2]|0,(j|0)>0){O=g[b+12>>2]|0,S=0;do w=(g[O+(S<<3)>>2]|0)+w|0,S=S+1|0;while((S|0)<(j|0))}S=V,O=g[S>>2]|0,S=g[S+4>>2]|0,j=((w|0)<0)<<31>>31,(S|0)<(j|0)|(S|0)==(j|0)&O>>>0<w>>>0?(S=V,g[S>>2]=w,g[S+4>>2]=j,S=j):w=O,re=qn(w|0,S|0,12,0)|0,pe=He()|0,S=V,g[S>>2]=re,g[S+4>>2]=pe,S=R,g[S>>2]=re,g[S+4>>2]=pe,S=0}return pe=S,Fe=Z,pe|0}function nu(b,w,S,R,O,j,V){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0,j=j|0,V=V|0;var Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0,ui=0,yi=0,ni=0,Tn=0,Wr=0,pi=0,hi=0,mi=0,Eo=0,Ha=0,Uf=0;if(hi=Fe,Fe=Fe+64|0,ni=hi+48|0,Tn=hi+32|0,Wr=hi+24|0,yr=hi+8|0,fn=hi,re=g[b>>2]|0,(re|0)<=0)return pi=0,Fe=hi,pi|0;for(an=b+4|0,ci=ni+8|0,ui=Tn+8|0,yi=yr+8|0,Z=0,qt=0;;){pe=g[an>>2]|0,Qt=pe+(qt<<4)|0,g[ni>>2]=g[Qt>>2],g[ni+4>>2]=g[Qt+4>>2],g[ni+8>>2]=g[Qt+8>>2],g[ni+12>>2]=g[Qt+12>>2],(qt|0)==(re+-1|0)?(g[Tn>>2]=g[pe>>2],g[Tn+4>>2]=g[pe+4>>2],g[Tn+8>>2]=g[pe+8>>2],g[Tn+12>>2]=g[pe+12>>2]):(Qt=pe+(qt+1<<4)|0,g[Tn>>2]=g[Qt>>2],g[Tn+4>>2]=g[Qt+4>>2],g[Tn+8>>2]=g[Qt+8>>2],g[Tn+12>>2]=g[Qt+12>>2]),re=bl(ni,Tn,R,Wr)|0;e:do if(re)pe=0,Z=re;else if(re=Wr,pe=g[re>>2]|0,re=g[re+4>>2]|0,(re|0)>0|(re|0)==0&pe>>>0>0){fr=0,Qt=0;t:for(;;){if(Eo=1/(+(pe>>>0)+4294967296*+(re|0)),Uf=+ce[ni>>3],re=Ro(pe|0,re|0,fr|0,Qt|0)|0,Ha=+(re>>>0)+4294967296*+(He()|0),mi=+(fr>>>0)+4294967296*+(Qt|0),ce[yr>>3]=Eo*(Uf*Ha)+Eo*(+ce[Tn>>3]*mi),ce[yi>>3]=Eo*(+ce[ci>>3]*Ha)+Eo*(+ce[ui>>3]*mi),re=sc(yr,R,fn)|0,re|0){Z=re;break}jt=fn,Rt=g[jt>>2]|0,jt=g[jt+4>>2]|0,nt=cc(Rt|0,jt|0,w|0,S|0)|0,xe=He()|0,re=V+(nt<<3)|0,qe=re,pe=g[qe>>2]|0,qe=g[qe+4>>2]|0;r:do if((pe|0)==0&(qe|0)==0)Dt=re,pi=16;else for(ot=0,at=0;;){if((ot|0)>(S|0)|(ot|0)==(S|0)&at>>>0>w>>>0){Z=1;break t}if((pe|0)==(Rt|0)&(qe|0)==(jt|0))break r;if(re=qn(nt|0,xe|0,1,0)|0,nt=Iu(re|0,He()|0,w|0,S|0)|0,xe=He()|0,at=qn(at|0,ot|0,1,0)|0,ot=He()|0,re=V+(nt<<3)|0,qe=re,pe=g[qe>>2]|0,qe=g[qe+4>>2]|0,(pe|0)==0&(qe|0)==0){Dt=re,pi=16;break}}while(!1);if((pi|0)==16&&(pi=0,!((Rt|0)==0&(jt|0)==0))&&(at=Dt,g[at>>2]=Rt,g[at+4>>2]=jt,at=j+(g[O>>2]<<3)|0,g[at>>2]=Rt,g[at+4>>2]=jt,at=O,at=qn(g[at>>2]|0,g[at+4>>2]|0,1,0)|0,Rt=He()|0,jt=O,g[jt>>2]=at,g[jt+4>>2]=Rt),fr=qn(fr|0,Qt|0,1,0)|0,Qt=He()|0,re=Wr,pe=g[re>>2]|0,re=g[re+4>>2]|0,!((re|0)>(Qt|0)|(re|0)==(Qt|0)&pe>>>0>fr>>>0)){pe=1;break e}}pe=0}else pe=1;while(!1);if(qt=qt+1|0,!pe){pi=21;break}if(re=g[b>>2]|0,(qt|0)>=(re|0)){Z=0,pi=21;break}}return(pi|0)==21?(Fe=hi,Z|0):0}function fd(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0,ui=0,yi=0,ni=0,Tn=0,Wr=0,pi=0,hi=0,mi=0,Eo=0,Ha=0;if(Ha=Fe,Fe=Fe+112|0,pi=Ha+80|0,re=Ha+72|0,hi=Ha,mi=Ha+56|0,O=Ds(S)|0,O|0)return Eo=O,Fe=Ha,Eo|0;if(pe=b+8|0,Eo=Bc((g[pe>>2]<<5)+32|0)|0,!Eo)return Eo=13,Fe=Ha,Eo|0;if(lc(b,Eo),O=Ds(S)|0,!O){if(Tn=b,Wr=g[Tn+4>>2]|0,O=re,g[O>>2]=g[Tn>>2],g[O+4>>2]=Wr,hh(re,pi),O=Ms(pi,w,hi)|0,O)Tn=0,Wr=0;else{if(O=g[re>>2]|0,j=g[pe>>2]|0,(j|0)>0){V=g[b+12>>2]|0,S=0;do O=(g[V+(S<<3)>>2]|0)+O|0,S=S+1|0;while((S|0)!=(j|0));S=O}else S=O;O=hi,j=g[O>>2]|0,O=g[O+4>>2]|0,V=((S|0)<0)<<31>>31,(O|0)<(V|0)|(O|0)==(V|0)&j>>>0<S>>>0?(O=hi,g[O>>2]=S,g[O+4>>2]=V,O=V):S=j,Tn=qn(S|0,O|0,12,0)|0,Wr=He()|0,O=hi,g[O>>2]=Tn,g[O+4>>2]=Wr,O=0}if(!O){if(S=Pa(Tn,8)|0,!S)return xn(Eo),Eo=13,Fe=Ha,Eo|0;if(Z=Pa(Tn,8)|0,!Z)return xn(Eo),xn(S),Eo=13,Fe=Ha,Eo|0;yi=pi,g[yi>>2]=0,g[yi+4>>2]=0,yi=b,ni=g[yi+4>>2]|0,O=re,g[O>>2]=g[yi>>2],g[O+4>>2]=ni,O=nu(re,Tn,Wr,w,pi,S,Z)|0;e:do if(O)xn(S),xn(Z),xn(Eo);else{t:do if((g[pe>>2]|0)>0){for(V=b+12|0,j=0;O=nu((g[V>>2]|0)+(j<<3)|0,Tn,Wr,w,pi,S,Z)|0,j=j+1|0,!(O|0);)if((j|0)>=(g[pe>>2]|0))break t;xn(S),xn(Z),xn(Eo);break e}while(!1);(Wr|0)>0|(Wr|0)==0&Tn>>>0>0&&Pu(Z|0,0,Tn<<3|0)|0,ni=pi,yi=g[ni+4>>2]|0;t:do if((yi|0)>0|(yi|0)==0&(g[ni>>2]|0)>>>0>0){an=S,ci=Z,ui=S,yi=Z,ni=S,O=S,Dt=S,yr=Z,fn=Z,S=Z;r:for(;;){for(jt=0,fr=0,Qt=0,qt=0,j=0,V=0;;){Z=hi,re=Z+56|0;do g[Z>>2]=0,Z=Z+4|0;while((Z|0)<(re|0));if(w=an+(jt<<3)|0,pe=g[w>>2]|0,w=g[w+4>>2]|0,Vl(pe,w,1,hi,0)|0){Z=hi,re=Z+56|0;do g[Z>>2]=0,Z=Z+4|0;while((Z|0)<(re|0));Z=Pa(7,4)|0,Z|0&&(sl(pe,w,1,hi,Z,7,0,0)|0,xn(Z))}for(Rt=0;;){at=hi+(Rt<<3)|0,ot=g[at>>2]|0,at=g[at+4>>2]|0;n:do if((ot|0)==0&(at|0)==0)Z=j,re=V;else{if(xe=cc(ot|0,at|0,Tn|0,Wr|0)|0,pe=He()|0,Z=R+(xe<<3)|0,w=Z,re=g[w>>2]|0,w=g[w+4>>2]|0,!((re|0)==0&(w|0)==0)){qe=0,nt=0;do{if((qe|0)>(Wr|0)|(qe|0)==(Wr|0)&nt>>>0>Tn>>>0)break r;if((re|0)==(ot|0)&(w|0)==(at|0)){Z=j,re=V;break n}Z=qn(xe|0,pe|0,1,0)|0,xe=Iu(Z|0,He()|0,Tn|0,Wr|0)|0,pe=He()|0,nt=qn(nt|0,qe|0,1,0)|0,qe=He()|0,Z=R+(xe<<3)|0,w=Z,re=g[w>>2]|0,w=g[w+4>>2]|0}while(!((re|0)==0&(w|0)==0))}if((ot|0)==0&(at|0)==0){Z=j,re=V;break}Sl(ot,at,mi)|0,Oc(b,Eo,mi)|0&&(nt=qn(j|0,V|0,1,0)|0,V=He()|0,qe=Z,g[qe>>2]=ot,g[qe+4>>2]=at,j=ci+(j<<3)|0,g[j>>2]=ot,g[j+4>>2]=at,j=nt),Z=j,re=V}while(!1);if(Rt=Rt+1|0,Rt>>>0>=7)break;j=Z,V=re}if(jt=qn(jt|0,fr|0,1,0)|0,fr=He()|0,Qt=qn(Qt|0,qt|0,1,0)|0,qt=He()|0,V=pi,j=g[V>>2]|0,V=g[V+4>>2]|0,(qt|0)<(V|0)|(qt|0)==(V|0)&Qt>>>0<j>>>0)j=Z,V=re;else break}if((V|0)>0|(V|0)==0&j>>>0>0){j=0,V=0;do qt=an+(j<<3)|0,g[qt>>2]=0,g[qt+4>>2]=0,j=qn(j|0,V|0,1,0)|0,V=He()|0,qt=pi,Qt=g[qt+4>>2]|0;while((V|0)<(Qt|0)|((V|0)==(Qt|0)?j>>>0<(g[qt>>2]|0)>>>0:0))}if(qt=pi,g[qt>>2]=Z,g[qt+4>>2]=re,(re|0)>0|(re|0)==0&Z>>>0>0)Rt=S,jt=fn,fr=ni,Qt=yr,qt=ci,S=Dt,fn=O,yr=ui,Dt=Rt,O=jt,ni=yi,yi=fr,ui=Qt,ci=an,an=qt;else break t}xn(ui),xn(yi),xn(Eo),O=1;break e}else O=Z;while(!1);xn(Eo),xn(S),xn(O),O=0}while(!1);return Eo=O,Fe=Ha,Eo|0}}return xn(Eo),Eo=O,Fe=Ha,Eo|0}function dd(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(xe=Fe,Fe=Fe+176|0,re=xe,(w|0)<1)return Cd(S,0,0),pe=0,Fe=xe,pe|0;for(Z=b,Z=Vr(g[Z>>2]|0,g[Z+4>>2]|0,52)|0,He()|0,Cd(S,(w|0)>6?w:6,Z&15),Z=0;R=b+(Z<<3)|0,R=vs(g[R>>2]|0,g[R+4>>2]|0,re)|0,!(R|0);){if(R=g[re>>2]|0,(R|0)>0){V=0;do j=re+8+(V<<4)|0,V=V+1|0,R=re+8+(((V|0)%(R|0)|0)<<4)|0,O=Qh(S,R,j)|0,O?zc(S,O)|0:ts(S,j,R)|0,R=g[re>>2]|0;while((V|0)<(R|0))}if(Z=Z+1|0,(Z|0)>=(w|0)){R=0,pe=13;break}}return(pe|0)==13?(Fe=xe,R|0):(jf(S),pe=R,Fe=xe,pe|0)}function Ju(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0;if(j=Fe,Fe=Fe+32|0,R=j,O=j+16|0,b=dd(b,w,O)|0,b|0)return S=b,Fe=j,S|0;if(g[S>>2]=0,g[S+4>>2]=0,g[S+8>>2]=0,b=Md(O)|0,b|0)do{w=lh(S)|0;do Rc(w,b)|0,V=b+16|0,g[R>>2]=g[V>>2],g[R+4>>2]=g[V+4>>2],g[R+8>>2]=g[V+8>>2],g[R+12>>2]=g[V+12>>2],zc(O,b)|0,b=Mu(O,R)|0;while((b|0)!=0);b=Md(O)|0}while((b|0)!=0);return jf(O),b=El(S)|0,b?(qh(S),V=b,Fe=j,V|0):(V=0,Fe=j,V|0)}function Fo(b){return b=b|0,b>>>0>121?(b=0,b|0):(b=g[7696+(b*28|0)+16>>2]|0,b|0)}function iu(b){return b=b|0,(b|0)==4|(b|0)==117|0}function ou(b){return b=b|0,g[11120+((g[b>>2]|0)*216|0)+((g[b+4>>2]|0)*72|0)+((g[b+8>>2]|0)*24|0)+(g[b+12>>2]<<3)>>2]|0}function ls(b){return b=b|0,g[11120+((g[b>>2]|0)*216|0)+((g[b+4>>2]|0)*72|0)+((g[b+8>>2]|0)*24|0)+(g[b+12>>2]<<3)+4>>2]|0}function eh(b,w){b=b|0,w=w|0,b=7696+(b*28|0)|0,g[w>>2]=g[b>>2],g[w+4>>2]=g[b+4>>2],g[w+8>>2]=g[b+8>>2],g[w+12>>2]=g[b+12>>2]}function pd(b,w){b=b|0,w=w|0;var S=0,R=0;if(w>>>0>20)return w=-1,w|0;do if((g[11120+(w*216|0)>>2]|0)!=(b|0))if((g[11120+(w*216|0)+8>>2]|0)!=(b|0))if((g[11120+(w*216|0)+16>>2]|0)!=(b|0))if((g[11120+(w*216|0)+24>>2]|0)!=(b|0))if((g[11120+(w*216|0)+32>>2]|0)!=(b|0))if((g[11120+(w*216|0)+40>>2]|0)!=(b|0))if((g[11120+(w*216|0)+48>>2]|0)!=(b|0))if((g[11120+(w*216|0)+56>>2]|0)!=(b|0))if((g[11120+(w*216|0)+64>>2]|0)!=(b|0))if((g[11120+(w*216|0)+72>>2]|0)!=(b|0))if((g[11120+(w*216|0)+80>>2]|0)!=(b|0))if((g[11120+(w*216|0)+88>>2]|0)!=(b|0))if((g[11120+(w*216|0)+96>>2]|0)!=(b|0))if((g[11120+(w*216|0)+104>>2]|0)!=(b|0))if((g[11120+(w*216|0)+112>>2]|0)!=(b|0))if((g[11120+(w*216|0)+120>>2]|0)!=(b|0))if((g[11120+(w*216|0)+128>>2]|0)!=(b|0))if((g[11120+(w*216|0)+136>>2]|0)==(b|0))b=2,S=1,R=2;else{if((g[11120+(w*216|0)+144>>2]|0)==(b|0)){b=0,S=2,R=0;break}if((g[11120+(w*216|0)+152>>2]|0)==(b|0)){b=0,S=2,R=1;break}if((g[11120+(w*216|0)+160>>2]|0)==(b|0)){b=0,S=2,R=2;break}if((g[11120+(w*216|0)+168>>2]|0)==(b|0)){b=1,S=2,R=0;break}if((g[11120+(w*216|0)+176>>2]|0)==(b|0)){b=1,S=2,R=1;break}if((g[11120+(w*216|0)+184>>2]|0)==(b|0)){b=1,S=2,R=2;break}if((g[11120+(w*216|0)+192>>2]|0)==(b|0)){b=2,S=2,R=0;break}if((g[11120+(w*216|0)+200>>2]|0)==(b|0)){b=2,S=2,R=1;break}if((g[11120+(w*216|0)+208>>2]|0)==(b|0)){b=2,S=2,R=2;break}else b=-1;return b|0}else b=2,S=1,R=1;else b=2,S=1,R=0;else b=1,S=1,R=2;else b=1,S=1,R=1;else b=1,S=1,R=0;else b=0,S=1,R=2;else b=0,S=1,R=1;else b=0,S=1,R=0;else b=2,S=0,R=2;else b=2,S=0,R=1;else b=2,S=0,R=0;else b=1,S=0,R=2;else b=1,S=0,R=1;else b=1,S=0,R=0;else b=0,S=0,R=2;else b=0,S=0,R=1;else b=0,S=0,R=0;while(!1);return w=g[11120+(w*216|0)+(S*72|0)+(b*24|0)+(R<<3)+4>>2]|0,w|0}function au(b,w){return b=b|0,w=w|0,(g[7696+(b*28|0)+20>>2]|0)==(w|0)?(w=1,w|0):(w=(g[7696+(b*28|0)+24>>2]|0)==(w|0),w|0)}function zh(b,w){return b=b|0,w=w|0,g[848+(b*28|0)+(w<<2)>>2]|0}function su(b,w){return b=b|0,w=w|0,(g[848+(b*28|0)>>2]|0)==(w|0)?(w=0,w|0):(g[848+(b*28|0)+4>>2]|0)==(w|0)?(w=1,w|0):(g[848+(b*28|0)+8>>2]|0)==(w|0)?(w=2,w|0):(g[848+(b*28|0)+12>>2]|0)==(w|0)?(w=3,w|0):(g[848+(b*28|0)+16>>2]|0)==(w|0)?(w=4,w|0):(g[848+(b*28|0)+20>>2]|0)==(w|0)?(w=5,w|0):((g[848+(b*28|0)+24>>2]|0)==(w|0)?6:7)|0}function $l(){return 122}function oi(b){b=b|0;var w=0,S=0,R=0;w=0;do Jr(w|0,0,45)|0,R=He()|0|134225919,S=b+(w<<3)|0,g[S>>2]=-1,g[S+4>>2]=R,w=w+1|0;while((w|0)!=122);return 0}function wc(b){b=b|0;var w=0,S=0,R=0;return R=+ce[b+16>>3],S=+ce[b+24>>3],w=R-S,+(R<S?w+6.283185307179586:w)}function Sc(b){return b=b|0,+ce[b+16>>3]<+ce[b+24>>3]|0}function rp(b){return b=b|0,+(+ce[b>>3]-+ce[b+8>>3])}function lu(b,w){b=b|0,w=w|0;var S=0,R=0,O=0;return S=+ce[w>>3],!(S>=+ce[b+8>>3])||!(S<=+ce[b>>3])?(w=0,w|0):(R=+ce[b+16>>3],S=+ce[b+24>>3],O=+ce[w+8>>3],w=O>=S,b=O<=R&1,R<S?w&&(b=1):w||(b=0),w=(b|0)!=0,w|0)}function oc(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;return+ce[b>>3]<+ce[w+8>>3]||+ce[b+8>>3]>+ce[w>>3]?(R=0,R|0):(j=+ce[b+16>>3],S=b+24|0,xe=+ce[S>>3],V=j<xe,R=w+16|0,pe=+ce[R>>3],O=w+24|0,re=+ce[O>>3],Z=pe<re,w=xe-pe<re-j,b=V?Z|w?1:2:0,w=Z?V?1:w?2:1:0,j=+Ia(j,b),j<+Ia(+ce[O>>3],w)||(xe=+Ia(+ce[S>>3],b),xe>+Ia(+ce[R>>3],w))?(Z=0,Z|0):(Z=1,Z|0))}function cu(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0;j=+ce[b+16>>3],re=+ce[b+24>>3],b=j<re,Z=+ce[w+16>>3],V=+ce[w+24>>3],O=Z<V,w=re-Z<V-j,g[S>>2]=b?O|w?1:2:0,g[R>>2]=O?b?1:w?2:1:0}function uu(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;return+ce[b>>3]<+ce[w>>3]||+ce[b+8>>3]>+ce[w+8>>3]?(R=0,R|0):(R=b+16|0,re=+ce[R>>3],j=+ce[b+24>>3],V=re<j,S=w+16|0,xe=+ce[S>>3],O=w+24|0,pe=+ce[O>>3],Z=xe<pe,w=j-xe<pe-re,b=V?Z|w?1:2:0,w=Z?V?1:w?2:1:0,j=+Ia(j,b),j<=+Ia(+ce[O>>3],w)?(xe=+Ia(+ce[R>>3],b),Z=xe>=+Ia(+ce[S>>3],w),Z|0):(Z=0,Z|0))}function Of(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0;O=Fe,Fe=Fe+176|0,R=O,g[R>>2]=4,Z=+ce[w>>3],ce[R+8>>3]=Z,j=+ce[w+16>>3],ce[R+16>>3]=j,ce[R+24>>3]=Z,Z=+ce[w+24>>3],ce[R+32>>3]=Z,V=+ce[w+8>>3],ce[R+40>>3]=V,ce[R+48>>3]=Z,ce[R+56>>3]=V,ce[R+64>>3]=j,w=R+72|0,S=w+96|0;do g[w>>2]=0,w=w+4|0;while((w|0)<(S|0));dh(b|0,R|0,168)|0,Fe=O}function Ms(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0;at=Fe,Fe=Fe+288|0,xe=at+264|0,qe=at+96|0,pe=at,Z=pe,re=Z+96|0;do g[Z>>2]=0,Z=Z+4|0;while((Z|0)<(re|0));return w=rh(w,pe)|0,w|0?(ot=w,Fe=at,ot|0):(re=pe,pe=g[re>>2]|0,re=g[re+4>>2]|0,Sl(pe,re,xe)|0,vs(pe,re,qe)|0,V=+Gh(xe,qe+8|0),ce[xe>>3]=+ce[b>>3],re=xe+8|0,ce[re>>3]=+ce[b+16>>3],ce[qe>>3]=+ce[b+8>>3],pe=qe+8|0,ce[pe>>3]=+ce[b+24>>3],O=+Gh(xe,qe),jt=+ce[re>>3]-+ce[pe>>3],j=+Lt(+jt),Rt=+ce[xe>>3]-+ce[qe>>3],R=+Lt(+Rt),!(jt==0|Rt==0)&&(jt=+Jh(+j,+R),jt=+go(+(O*O/+ef(+(jt/+ef(+j,+R)),3)/(V*(V*2.59807621135)*.8))),ce[At>>3]=jt,nt=~~jt>>>0,ot=+Lt(jt)>=1?jt>0?~~+ia(+vt(jt/4294967296),4294967295)>>>0:~~+go((jt-+(~~jt>>>0))/4294967296)>>>0:0,(g[At+4>>2]&2146435072|0)!=2146435072)?(qe=(nt|0)==0&(ot|0)==0,w=S,g[w>>2]=qe?1:nt,g[w+4>>2]=qe?0:ot,w=0):w=1,ot=w,Fe=at,ot|0)}function bl(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;pe=Fe,Fe=Fe+288|0,V=pe+264|0,Z=pe+96|0,re=pe,O=re,j=O+96|0;do g[O>>2]=0,O=O+4|0;while((O|0)<(j|0));return S=rh(S,re)|0,S|0?(R=S,Fe=pe,R|0):(S=re,O=g[S>>2]|0,S=g[S+4>>2]|0,Sl(O,S,V)|0,vs(O,S,Z)|0,xe=+Gh(V,Z+8|0),xe=+go(+(+Gh(b,w)/(xe*2))),ce[At>>3]=xe,S=~~xe>>>0,O=+Lt(xe)>=1?xe>0?~~+ia(+vt(xe/4294967296),4294967295)>>>0:~~+go((xe-+(~~xe>>>0))/4294967296)>>>0:0,(g[At+4>>2]&2146435072|0)==2146435072?(R=1,Fe=pe,R|0):(re=(S|0)==0&(O|0)==0,g[R>>2]=re?1:S,g[R+4>>2]=re?0:O,R=0,Fe=pe,R|0))}function md(b,w){b=b|0,w=+w;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;j=b+16|0,V=+ce[j>>3],S=b+24|0,O=+ce[S>>3],R=V-O,R=V<O?R+6.283185307179586:R,pe=+ce[b>>3],Z=b+8|0,re=+ce[Z>>3],xe=pe-re,R=(R*w-R)*.5,w=(xe*w-xe)*.5,pe=pe+w,ce[b>>3]=pe>1.5707963267948966?1.5707963267948966:pe,w=re-w,ce[Z>>3]=w<-1.5707963267948966?-1.5707963267948966:w,w=V+R,w=w>3.141592653589793?w+-6.283185307179586:w,ce[j>>3]=w<-3.141592653589793?w+6.283185307179586:w,w=O-R,w=w>3.141592653589793?w+-6.283185307179586:w,ce[S>>3]=w<-3.141592653589793?w+6.283185307179586:w}function Lh(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0,g[b>>2]=w,g[b+4>>2]=S,g[b+8>>2]=R}function kf(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0;qe=w+8|0,g[qe>>2]=0,re=+ce[b>>3],V=+Lt(+re),pe=+ce[b+8>>3],Z=+Lt(+pe)*1.1547005383792515,V=V+Z*.5,S=~~V,b=~~Z,V=V-+(S|0),Z=Z-+(b|0);do if(V<.5)if(V<.3333333333333333)if(g[w>>2]=S,Z<(V+1)*.5){g[w+4>>2]=b;break}else{b=b+1|0,g[w+4>>2]=b;break}else if(nt=1-V,b=(!(Z<nt)&1)+b|0,g[w+4>>2]=b,nt<=Z&Z<V*2){S=S+1|0,g[w>>2]=S;break}else{g[w>>2]=S;break}else{if(!(V<.6666666666666666))if(S=S+1|0,g[w>>2]=S,Z<V*.5){g[w+4>>2]=b;break}else{b=b+1|0,g[w+4>>2]=b;break}if(Z<1-V){if(g[w+4>>2]=b,V*2+-1<Z){g[w>>2]=S;break}}else b=b+1|0,g[w+4>>2]=b;S=S+1|0,g[w>>2]=S}while(!1);do if(re<0)if(b&1){xe=(b+1|0)/2|0,xe=Ro(S|0,((S|0)<0)<<31>>31|0,xe|0,((xe|0)<0)<<31>>31|0)|0,S=~~(+(S|0)-((+(xe>>>0)+4294967296*+(He()|0))*2+1)),g[w>>2]=S;break}else{xe=(b|0)/2|0,xe=Ro(S|0,((S|0)<0)<<31>>31|0,xe|0,((xe|0)<0)<<31>>31|0)|0,S=~~(+(S|0)-(+(xe>>>0)+4294967296*+(He()|0))*2),g[w>>2]=S;break}while(!1);xe=w+4|0,pe<0&&(S=S-((b<<1|1|0)/2|0)|0,g[w>>2]=S,b=0-b|0,g[xe>>2]=b),R=b-S|0,(S|0)<0?(O=0-S|0,g[xe>>2]=R,g[qe>>2]=O,g[w>>2]=0,b=R,S=0):O=0,(b|0)<0&&(S=S-b|0,g[w>>2]=S,O=O-b|0,g[qe>>2]=O,g[xe>>2]=0,b=0),j=S-O|0,R=b-O|0,(O|0)<0&&(g[w>>2]=j,g[xe>>2]=R,g[qe>>2]=0,b=R,S=j,O=0),R=(b|0)<(S|0)?b:S,R=(O|0)<(R|0)?O:R,!((R|0)<=0)&&(g[w>>2]=S-R,g[xe>>2]=b-R,g[qe>>2]=O-R)}function Oa(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0;w=g[b>>2]|0,V=b+4|0,S=g[V>>2]|0,(w|0)<0&&(S=S-w|0,g[V>>2]=S,j=b+8|0,g[j>>2]=(g[j>>2]|0)-w,g[b>>2]=0,w=0),(S|0)<0?(w=w-S|0,g[b>>2]=w,j=b+8|0,O=(g[j>>2]|0)-S|0,g[j>>2]=O,g[V>>2]=0,S=0):(O=b+8|0,j=O,O=g[O>>2]|0),(O|0)<0&&(w=w-O|0,g[b>>2]=w,S=S-O|0,g[V>>2]=S,g[j>>2]=0,O=0),R=(S|0)<(w|0)?S:w,R=(O|0)<(R|0)?O:R,!((R|0)<=0)&&(g[b>>2]=w-R,g[V>>2]=S-R,g[j>>2]=O-R)}function Ka(b,w){b=b|0,w=w|0;var S=0,R=0;R=g[b+8>>2]|0,S=+((g[b+4>>2]|0)-R|0),ce[w>>3]=+((g[b>>2]|0)-R|0)-S*.5,ce[w+8>>3]=S*.8660254037844386}function ya(b,w,S){b=b|0,w=w|0,S=S|0,g[S>>2]=(g[w>>2]|0)+(g[b>>2]|0),g[S+4>>2]=(g[w+4>>2]|0)+(g[b+4>>2]|0),g[S+8>>2]=(g[w+8>>2]|0)+(g[b+8>>2]|0)}function hu(b,w,S){b=b|0,w=w|0,S=S|0,g[S>>2]=(g[b>>2]|0)-(g[w>>2]|0),g[S+4>>2]=(g[b+4>>2]|0)-(g[w+4>>2]|0),g[S+8>>2]=(g[b+8>>2]|0)-(g[w+8>>2]|0)}function qs(b,w){b=b|0,w=w|0;var S=0,R=0;S=wo(g[b>>2]|0,w)|0,g[b>>2]=S,S=b+4|0,R=wo(g[S>>2]|0,w)|0,g[S>>2]=R,b=b+8|0,w=wo(g[b>>2]|0,w)|0,g[b>>2]=w}function Tc(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;V=g[b>>2]|0,Z=(V|0)<0,R=(g[b+4>>2]|0)-(Z?V:0)|0,j=(R|0)<0,O=(j?0-R|0:0)+((g[b+8>>2]|0)-(Z?V:0))|0,S=(O|0)<0,b=S?0:O,w=(j?0:R)-(S?O:0)|0,O=(Z?0:V)-(j?R:0)-(S?O:0)|0,S=(w|0)<(O|0)?w:O,S=(b|0)<(S|0)?b:S,R=(S|0)>0,b=b-(R?S:0)|0,w=w-(R?S:0)|0;e:do switch(O-(R?S:0)|0){case 0:switch(w|0){case 0:return Z=(b|0)==0?0:(b|0)==1?1:7,Z|0;case 1:return Z=(b|0)==0?2:(b|0)==1?3:7,Z|0;default:break e}case 1:switch(w|0){case 0:return Z=(b|0)==0?4:(b|0)==1?5:7,Z|0;case 1:{if(!b)b=6;else break e;return b|0}default:break e}}while(!1);return Z=7,Z|0}function wl(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0;if(re=b+8|0,V=g[re>>2]|0,Z=(g[b>>2]|0)-V|0,pe=b+4|0,V=(g[pe>>2]|0)-V|0,Z>>>0>715827881|V>>>0>715827881){if(R=(Z|0)>0,O=2147483647-Z|0,j=-2147483648-Z|0,(R?(O|0)<(Z|0):(j|0)>(Z|0))||(S=Z<<1,R?(2147483647-S|0)<(Z|0):(-2147483648-S|0)>(Z|0))||((V|0)>0?(2147483647-V|0)<(V|0):(-2147483648-V|0)>(V|0))||(w=Z*3|0,S=V<<1,(R?(O|0)<(S|0):(j|0)>(S|0))||((Z|0)>-1?(w|-2147483648|0)>=(V|0):(w^-2147483648|0)<(V|0))))return pe=1,pe|0}else S=V<<1,w=Z*3|0;return R=Lc(+(w-V|0)*.14285714285714285)|0,g[b>>2]=R,O=Lc(+(S+Z|0)*.14285714285714285)|0,g[pe>>2]=O,g[re>>2]=0,S=(O|0)<(R|0),w=S?R:O,S=S?O:R,(S|0)<0&&(((S|0)==-2147483648||((w|0)>0?(2147483647-w|0)<(S|0):(-2147483648-w|0)>(S|0)))&&mn(27795,26892,354,26903),((w|0)>-1?(w|-2147483648|0)>=(S|0):(w^-2147483648|0)<(S|0))&&mn(27795,26892,354,26903)),w=O-R|0,(R|0)<0?(S=0-R|0,g[pe>>2]=w,g[re>>2]=S,g[b>>2]=0,R=0):(w=O,S=0),(w|0)<0&&(R=R-w|0,g[b>>2]=R,S=S-w|0,g[re>>2]=S,g[pe>>2]=0,w=0),j=R-S|0,O=w-S|0,(S|0)<0?(g[b>>2]=j,g[pe>>2]=O,g[re>>2]=0,w=O,O=j,S=0):O=R,R=(w|0)<(O|0)?w:O,R=(S|0)<(R|0)?S:R,(R|0)<=0?(pe=0,pe|0):(g[b>>2]=O-R,g[pe>>2]=w-R,g[re>>2]=S-R,pe=0,pe|0)}function Kp(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0,re=0;if(V=b+8|0,O=g[V>>2]|0,j=(g[b>>2]|0)-O|0,Z=b+4|0,O=(g[Z>>2]|0)-O|0,j>>>0>715827881|O>>>0>715827881){if(S=(j|0)>0,(S?(2147483647-j|0)<(j|0):(-2147483648-j|0)>(j|0))||(w=j<<1,R=(O|0)>0,R?(2147483647-O|0)<(O|0):(-2147483648-O|0)>(O|0)))return Z=1,Z|0;if(re=O<<1,(R?(2147483647-re|0)<(O|0):(-2147483648-re|0)>(O|0))||(S?(2147483647-w|0)<(O|0):(-2147483648-w|0)>(O|0))||(S=O*3|0,(O|0)>-1?(S|-2147483648|0)>=(j|0):(S^-2147483648|0)<(j|0)))return re=1,re|0}else S=O*3|0,w=j<<1;return R=Lc(+(w+O|0)*.14285714285714285)|0,g[b>>2]=R,O=Lc(+(S-j|0)*.14285714285714285)|0,g[Z>>2]=O,g[V>>2]=0,S=(O|0)<(R|0),w=S?R:O,S=S?O:R,(S|0)<0&&(((S|0)==-2147483648||((w|0)>0?(2147483647-w|0)<(S|0):(-2147483648-w|0)>(S|0)))&&mn(27795,26892,402,26917),((w|0)>-1?(w|-2147483648|0)>=(S|0):(w^-2147483648|0)<(S|0))&&mn(27795,26892,402,26917)),w=O-R|0,(R|0)<0?(S=0-R|0,g[Z>>2]=w,g[V>>2]=S,g[b>>2]=0,R=0):(w=O,S=0),(w|0)<0&&(R=R-w|0,g[b>>2]=R,S=S-w|0,g[V>>2]=S,g[Z>>2]=0,w=0),j=R-S|0,O=w-S|0,(S|0)<0?(g[b>>2]=j,g[Z>>2]=O,g[V>>2]=0,w=O,O=j,S=0):O=R,R=(w|0)<(O|0)?w:O,R=(S|0)<(R|0)?S:R,(R|0)<=0?(re=0,re|0):(g[b>>2]=O-R,g[Z>>2]=w-R,g[V>>2]=S-R,re=0,re|0)}function zf(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;V=b+8|0,S=g[V>>2]|0,w=(g[b>>2]|0)-S|0,Z=b+4|0,S=(g[Z>>2]|0)-S|0,R=Lc(+((w*3|0)-S|0)*.14285714285714285)|0,g[b>>2]=R,w=Lc(+((S<<1)+w|0)*.14285714285714285)|0,g[Z>>2]=w,g[V>>2]=0,S=w-R|0,(R|0)<0?(j=0-R|0,g[Z>>2]=S,g[V>>2]=j,g[b>>2]=0,w=S,R=0,S=j):S=0,(w|0)<0&&(R=R-w|0,g[b>>2]=R,S=S-w|0,g[V>>2]=S,g[Z>>2]=0,w=0),j=R-S|0,O=w-S|0,(S|0)<0?(g[b>>2]=j,g[Z>>2]=O,g[V>>2]=0,w=O,O=j,S=0):O=R,R=(w|0)<(O|0)?w:O,R=(S|0)<(R|0)?S:R,!((R|0)<=0)&&(g[b>>2]=O-R,g[Z>>2]=w-R,g[V>>2]=S-R)}function np(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;V=b+8|0,S=g[V>>2]|0,w=(g[b>>2]|0)-S|0,Z=b+4|0,S=(g[Z>>2]|0)-S|0,R=Lc(+((w<<1)+S|0)*.14285714285714285)|0,g[b>>2]=R,w=Lc(+((S*3|0)-w|0)*.14285714285714285)|0,g[Z>>2]=w,g[V>>2]=0,S=w-R|0,(R|0)<0?(j=0-R|0,g[Z>>2]=S,g[V>>2]=j,g[b>>2]=0,w=S,R=0,S=j):S=0,(w|0)<0&&(R=R-w|0,g[b>>2]=R,S=S-w|0,g[V>>2]=S,g[Z>>2]=0,w=0),j=R-S|0,O=w-S|0,(S|0)<0?(g[b>>2]=j,g[Z>>2]=O,g[V>>2]=0,w=O,O=j,S=0):O=R,R=(w|0)<(O|0)?w:O,R=(S|0)<(R|0)?S:R,!((R|0)<=0)&&(g[b>>2]=O-R,g[Z>>2]=w-R,g[V>>2]=S-R)}function vi(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;w=g[b>>2]|0,V=b+4|0,S=g[V>>2]|0,Z=b+8|0,R=g[Z>>2]|0,O=S+(w*3|0)|0,g[b>>2]=O,S=R+(S*3|0)|0,g[V>>2]=S,w=(R*3|0)+w|0,g[Z>>2]=w,R=S-O|0,(O|0)<0?(w=w-O|0,g[V>>2]=R,g[Z>>2]=w,g[b>>2]=0,S=R,R=0):R=O,(S|0)<0&&(R=R-S|0,g[b>>2]=R,w=w-S|0,g[Z>>2]=w,g[V>>2]=0,S=0),j=R-w|0,O=S-w|0,(w|0)<0?(g[b>>2]=j,g[V>>2]=O,g[Z>>2]=0,R=j,w=0):O=S,S=(O|0)<(R|0)?O:R,S=(w|0)<(S|0)?w:S,!((S|0)<=0)&&(g[b>>2]=R-S,g[V>>2]=O-S,g[Z>>2]=w-S)}function fu(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;O=g[b>>2]|0,V=b+4|0,w=g[V>>2]|0,Z=b+8|0,S=g[Z>>2]|0,R=(w*3|0)+O|0,O=S+(O*3|0)|0,g[b>>2]=O,g[V>>2]=R,w=(S*3|0)+w|0,g[Z>>2]=w,S=R-O|0,(O|0)<0?(w=w-O|0,g[V>>2]=S,g[Z>>2]=w,g[b>>2]=0,O=0):S=R,(S|0)<0&&(O=O-S|0,g[b>>2]=O,w=w-S|0,g[Z>>2]=w,g[V>>2]=0,S=0),j=O-w|0,R=S-w|0,(w|0)<0?(g[b>>2]=j,g[V>>2]=R,g[Z>>2]=0,O=j,w=0):R=S,S=(R|0)<(O|0)?R:O,S=(w|0)<(S|0)?w:S,!((S|0)<=0)&&(g[b>>2]=O-S,g[V>>2]=R-S,g[Z>>2]=w-S)}function Jp(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0;(w+-1|0)>>>0>=6||(O=(g[15440+(w*12|0)>>2]|0)+(g[b>>2]|0)|0,g[b>>2]=O,Z=b+4|0,R=(g[15440+(w*12|0)+4>>2]|0)+(g[Z>>2]|0)|0,g[Z>>2]=R,V=b+8|0,w=(g[15440+(w*12|0)+8>>2]|0)+(g[V>>2]|0)|0,g[V>>2]=w,S=R-O|0,(O|0)<0?(w=w-O|0,g[Z>>2]=S,g[V>>2]=w,g[b>>2]=0,R=0):(S=R,R=O),(S|0)<0&&(R=R-S|0,g[b>>2]=R,w=w-S|0,g[V>>2]=w,g[Z>>2]=0,S=0),j=R-w|0,O=S-w|0,(w|0)<0?(g[b>>2]=j,g[Z>>2]=O,g[V>>2]=0,R=j,w=0):O=S,S=(O|0)<(R|0)?O:R,S=(w|0)<(S|0)?w:S,!((S|0)<=0)&&(g[b>>2]=R-S,g[Z>>2]=O-S,g[V>>2]=w-S))}function Ad(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;O=g[b>>2]|0,V=b+4|0,w=g[V>>2]|0,Z=b+8|0,S=g[Z>>2]|0,R=w+O|0,O=S+O|0,g[b>>2]=O,g[V>>2]=R,w=S+w|0,g[Z>>2]=w,S=R-O|0,(O|0)<0?(w=w-O|0,g[V>>2]=S,g[Z>>2]=w,g[b>>2]=0,R=0):(S=R,R=O),(S|0)<0&&(R=R-S|0,g[b>>2]=R,w=w-S|0,g[Z>>2]=w,g[V>>2]=0,S=0),j=R-w|0,O=S-w|0,(w|0)<0?(g[b>>2]=j,g[V>>2]=O,g[Z>>2]=0,R=j,w=0):O=S,S=(O|0)<(R|0)?O:R,S=(w|0)<(S|0)?w:S,!((S|0)<=0)&&(g[b>>2]=R-S,g[V>>2]=O-S,g[Z>>2]=w-S)}function hn(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;w=g[b>>2]|0,V=b+4|0,R=g[V>>2]|0,Z=b+8|0,S=g[Z>>2]|0,O=R+w|0,g[b>>2]=O,R=S+R|0,g[V>>2]=R,w=S+w|0,g[Z>>2]=w,S=R-O|0,(O|0)<0?(w=w-O|0,g[V>>2]=S,g[Z>>2]=w,g[b>>2]=0,R=0):(S=R,R=O),(S|0)<0&&(R=R-S|0,g[b>>2]=R,w=w-S|0,g[Z>>2]=w,g[V>>2]=0,S=0),j=R-w|0,O=S-w|0,(w|0)<0?(g[b>>2]=j,g[V>>2]=O,g[Z>>2]=0,R=j,w=0):O=S,S=(O|0)<(R|0)?O:R,S=(w|0)<(S|0)?w:S,!((S|0)<=0)&&(g[b>>2]=R-S,g[V>>2]=O-S,g[Z>>2]=w-S)}function du(b){switch(b=b|0,b|0){case 1:{b=5;break}case 5:{b=4;break}case 4:{b=6;break}case 6:{b=2;break}case 2:{b=3;break}case 3:{b=1;break}}return b|0}function $a(b){switch(b=b|0,b|0){case 1:{b=3;break}case 3:{b=2;break}case 2:{b=6;break}case 6:{b=4;break}case 4:{b=5;break}case 5:{b=1;break}}return b|0}function Gl(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;w=g[b>>2]|0,V=b+4|0,S=g[V>>2]|0,Z=b+8|0,R=g[Z>>2]|0,O=S+(w<<1)|0,g[b>>2]=O,S=R+(S<<1)|0,g[V>>2]=S,w=(R<<1)+w|0,g[Z>>2]=w,R=S-O|0,(O|0)<0?(w=w-O|0,g[V>>2]=R,g[Z>>2]=w,g[b>>2]=0,S=R,R=0):R=O,(S|0)<0&&(R=R-S|0,g[b>>2]=R,w=w-S|0,g[Z>>2]=w,g[V>>2]=0,S=0),j=R-w|0,O=S-w|0,(w|0)<0?(g[b>>2]=j,g[V>>2]=O,g[Z>>2]=0,R=j,w=0):O=S,S=(O|0)<(R|0)?O:R,S=(w|0)<(S|0)?w:S,!((S|0)<=0)&&(g[b>>2]=R-S,g[V>>2]=O-S,g[Z>>2]=w-S)}function gd(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;O=g[b>>2]|0,V=b+4|0,w=g[V>>2]|0,Z=b+8|0,S=g[Z>>2]|0,R=(w<<1)+O|0,O=S+(O<<1)|0,g[b>>2]=O,g[V>>2]=R,w=(S<<1)+w|0,g[Z>>2]=w,S=R-O|0,(O|0)<0?(w=w-O|0,g[V>>2]=S,g[Z>>2]=w,g[b>>2]=0,O=0):S=R,(S|0)<0&&(O=O-S|0,g[b>>2]=O,w=w-S|0,g[Z>>2]=w,g[V>>2]=0,S=0),j=O-w|0,R=S-w|0,(w|0)<0?(g[b>>2]=j,g[V>>2]=R,g[Z>>2]=0,O=j,w=0):R=S,S=(R|0)<(O|0)?R:O,S=(w|0)<(S|0)?w:S,!((S|0)<=0)&&(g[b>>2]=O-S,g[V>>2]=R-S,g[Z>>2]=w-S)}function ul(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0;return V=(g[b>>2]|0)-(g[w>>2]|0)|0,Z=(V|0)<0,R=(g[b+4>>2]|0)-(g[w+4>>2]|0)-(Z?V:0)|0,j=(R|0)<0,O=(Z?0-V|0:0)+(g[b+8>>2]|0)-(g[w+8>>2]|0)+(j?0-R|0:0)|0,b=(O|0)<0,w=b?0:O,S=(j?0:R)-(b?O:0)|0,O=(Z?0:V)-(j?R:0)-(b?O:0)|0,b=(S|0)<(O|0)?S:O,b=(w|0)<(b|0)?w:b,R=(b|0)>0,w=w-(R?b:0)|0,S=S-(R?b:0)|0,b=O-(R?b:0)|0,b=(b|0)>-1?b:0-b|0,S=(S|0)>-1?S:0-S|0,w=(w|0)>-1?w:0-w|0,w=(S|0)>(w|0)?S:w,((b|0)>(w|0)?b:w)|0}function Kr(b,w){b=b|0,w=w|0;var S=0;S=g[b+8>>2]|0,g[w>>2]=(g[b>>2]|0)-S,g[w+4>>2]=(g[b+4>>2]|0)-S}function Di(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0;return R=g[b>>2]|0,g[w>>2]=R,O=g[b+4>>2]|0,V=w+4|0,g[V>>2]=O,Z=w+8|0,g[Z>>2]=0,S=(O|0)<(R|0),b=S?R:O,S=S?O:R,(S|0)<0&&((S|0)==-2147483648||((b|0)>0?(2147483647-b|0)<(S|0):(-2147483648-b|0)>(S|0))||((b|0)>-1?(b|-2147483648|0)>=(S|0):(b^-2147483648|0)<(S|0)))?(w=1,w|0):(b=O-R|0,(R|0)<0?(S=0-R|0,g[V>>2]=b,g[Z>>2]=S,g[w>>2]=0,R=0):(b=O,S=0),(b|0)<0&&(R=R-b|0,g[w>>2]=R,S=S-b|0,g[Z>>2]=S,g[V>>2]=0,b=0),j=R-S|0,O=b-S|0,(S|0)<0?(g[w>>2]=j,g[V>>2]=O,g[Z>>2]=0,b=O,O=j,S=0):O=R,R=(b|0)<(O|0)?b:O,R=(S|0)<(R|0)?S:R,(R|0)<=0?(w=0,w|0):(g[w>>2]=O-R,g[V>>2]=b-R,g[Z>>2]=S-R,w=0,w|0))}function Oi(b){b=b|0;var w=0,S=0,R=0,O=0;w=b+8|0,O=g[w>>2]|0,S=O-(g[b>>2]|0)|0,g[b>>2]=S,R=b+4|0,b=(g[R>>2]|0)-O|0,g[R>>2]=b,g[w>>2]=0-(b+S)}function Ws(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;S=g[b>>2]|0,w=0-S|0,g[b>>2]=w,V=b+8|0,g[V>>2]=0,Z=b+4|0,R=g[Z>>2]|0,O=R+S|0,(S|0)>0?(g[Z>>2]=O,g[V>>2]=S,g[b>>2]=0,w=0,R=O):S=0,(R|0)<0?(j=w-R|0,g[b>>2]=j,S=S-R|0,g[V>>2]=S,g[Z>>2]=0,O=j-S|0,w=0-S|0,(S|0)<0?(g[b>>2]=O,g[Z>>2]=w,g[V>>2]=0,R=w,S=0):(R=0,O=j)):O=w,w=(R|0)<(O|0)?R:O,w=(S|0)<(w|0)?S:w,!((w|0)<=0)&&(g[b>>2]=O-w,g[Z>>2]=R-w,g[V>>2]=S-w)}function Bh(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0;if(qe=Fe,Fe=Fe+64|0,xe=qe,Z=qe+56|0,!(!0&(w&2013265920|0)==134217728&(!0&(R&2013265920|0)==134217728)))return O=5,Fe=qe,O|0;if((b|0)==(S|0)&(w|0)==(R|0))return g[O>>2]=0,O=0,Fe=qe,O|0;if(V=Vr(b|0,w|0,52)|0,He()|0,V=V&15,pe=Vr(S|0,R|0,52)|0,He()|0,(V|0)!=(pe&15|0))return O=12,Fe=qe,O|0;if(j=V+-1|0,V>>>0>1){ac(b,w,j,xe)|0,ac(S,R,j,Z)|0,pe=xe,re=g[pe>>2]|0,pe=g[pe+4>>2]|0;e:do if((re|0)==(g[Z>>2]|0)&&(pe|0)==(g[Z+4>>2]|0)){V=(V^15)*3|0,j=Vr(b|0,w|0,V|0)|0,He()|0,j=j&7,V=Vr(S|0,R|0,V|0)|0,He()|0,V=V&7;do if((j|0)==0|(V|0)==0)g[O>>2]=1,j=0;else if((j|0)==7)j=5;else{if((j|0)==1|(V|0)==1&&So(re,pe)|0){j=5;break}if((g[15536+(j<<2)>>2]|0)!=(V|0)&&(g[15568+(j<<2)>>2]|0)!=(V|0))break e;g[O>>2]=1,j=0}while(!1);return O=j,Fe=qe,O|0}while(!1)}j=xe,V=j+56|0;do g[j>>2]=0,j=j+4|0;while((j|0)<(V|0));return As(b,w,1,xe)|0,w=xe,!((g[w>>2]|0)==(S|0)&&(g[w+4>>2]|0)==(R|0))&&(w=xe+8|0,!((g[w>>2]|0)==(S|0)&&(g[w+4>>2]|0)==(R|0)))&&(w=xe+16|0,!((g[w>>2]|0)==(S|0)&&(g[w+4>>2]|0)==(R|0)))&&(w=xe+24|0,!((g[w>>2]|0)==(S|0)&&(g[w+4>>2]|0)==(R|0)))&&(w=xe+32|0,!((g[w>>2]|0)==(S|0)&&(g[w+4>>2]|0)==(R|0)))&&(w=xe+40|0,!((g[w>>2]|0)==(S|0)&&(g[w+4>>2]|0)==(R|0)))?(j=xe+48|0,j=((g[j>>2]|0)==(S|0)?(g[j+4>>2]|0)==(R|0):0)&1):j=1,g[O>>2]=j,O=0,Fe=qe,O|0}function Ti(b,w,S,R,O){return b=b|0,w=w|0,S=S|0,R=R|0,O=O|0,S=xl(b,w,S,R)|0,(S|0)==7?(O=11,O|0):(R=Jr(S|0,0,56)|0,w=w&-2130706433|(He()|0)|268435456,g[O>>2]=b|R,g[O+4>>2]=w,O=0,O|0)}function ip(b,w,S){return b=b|0,w=w|0,S=S|0,!0&(w&2013265920|0)==268435456?(g[S>>2]=b,g[S+4>>2]=w&-2130706433|134217728,S=0,S|0):(S=6,S|0)}function th(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;return O=Fe,Fe=Fe+16|0,R=O,g[R>>2]=0,!0&(w&2013265920|0)==268435456?(j=Vr(b|0,w|0,56)|0,He()|0,R=oa(b,w&-2130706433|134217728,j&7,R,S)|0,Fe=O,R|0):(R=6,Fe=O,R|0)}function _d(b,w){b=b|0,w=w|0;var S=0;switch(S=Vr(b|0,w|0,56)|0,He()|0,S&7){case 0:case 7:return S=0,S|0}return S=w&-2130706433|134217728,!(!0&(w&2013265920|0)==268435456)||!0&(w&117440512|0)==16777216&(So(b,S)|0)!=0?(S=0,S|0):(S=Mn(b,S)|0,S|0)}function _s(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0;return O=Fe,Fe=Fe+16|0,R=O,!0&(w&2013265920|0)==268435456?(j=w&-2130706433|134217728,V=S,g[V>>2]=b,g[V+4>>2]=j,g[R>>2]=0,w=Vr(b|0,w|0,56)|0,He()|0,R=oa(b,j,w&7,R,S+8|0)|0,Fe=O,R|0):(R=6,Fe=O,R|0)}function ma(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0;return O=(So(b,w)|0)==0,w=w&-2130706433,R=S,g[R>>2]=O?b:0,g[R+4>>2]=O?w|285212672:0,R=S+8|0,g[R>>2]=b,g[R+4>>2]=w|301989888,R=S+16|0,g[R>>2]=b,g[R+4>>2]=w|318767104,R=S+24|0,g[R>>2]=b,g[R+4>>2]=w|335544320,R=S+32|0,g[R>>2]=b,g[R+4>>2]=w|352321536,S=S+40|0,g[S>>2]=b,g[S+4>>2]=w|369098752,0}function op(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0;return V=Fe,Fe=Fe+16|0,O=V,j=w&-2130706433|134217728,!0&(w&2013265920|0)==268435456?(R=Vr(b|0,w|0,56)|0,He()|0,R=Yh(b,j,R&7)|0,(R|0)==-1?(g[S>>2]=0,j=6,Fe=V,j|0):(Cc(b,j,O)|0&&mn(27795,26932,282,26947),w=Vr(b|0,w|0,52)|0,He()|0,w=w&15,So(b,j)|0?Fh(O,w,R,2,S):gu(O,w,R,2,S),j=0,Fe=V,j|0)):(j=6,Fe=V,j|0)}function yd(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0;R=Fe,Fe=Fe+16|0,O=R,vd(b,w,S,O),kf(O,S+4|0),Fe=R}function vd(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0;if(Z=Fe,Fe=Fe+16|0,re=Z,pu(b,S,re),j=+Un(+(1-+ce[re>>3]*.5)),j<1e-16){g[R>>2]=0,g[R+4>>2]=0,g[R+8>>2]=0,g[R+12>>2]=0,Fe=Z;return}if(re=g[S>>2]|0,O=+ce[15920+(re*24|0)>>3],O=+Pc(O-+Pc(+sA(15600+(re<<4)|0,b))),ua(w)|0?V=+Pc(O+-.3334731722518321):V=O,O=+zn(+j)*2.618033988749896,(w|0)>0){b=0;do O=O*2.6457513110645907,b=b+1|0;while((b|0)!=(w|0))}j=+Dr(+V)*O,ce[R>>3]=j,V=+wr(+V)*O,ce[R+8>>3]=V,Fe=Z}function pu(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;if(j=Fe,Fe=Fe+32|0,O=j,fh(b,O),g[w>>2]=0,ce[S>>3]=5,R=+va(16400,O),R<+ce[S>>3]&&(g[w>>2]=0,ce[S>>3]=R),R=+va(16424,O),R<+ce[S>>3]&&(g[w>>2]=1,ce[S>>3]=R),R=+va(16448,O),R<+ce[S>>3]&&(g[w>>2]=2,ce[S>>3]=R),R=+va(16472,O),R<+ce[S>>3]&&(g[w>>2]=3,ce[S>>3]=R),R=+va(16496,O),R<+ce[S>>3]&&(g[w>>2]=4,ce[S>>3]=R),R=+va(16520,O),R<+ce[S>>3]&&(g[w>>2]=5,ce[S>>3]=R),R=+va(16544,O),R<+ce[S>>3]&&(g[w>>2]=6,ce[S>>3]=R),R=+va(16568,O),R<+ce[S>>3]&&(g[w>>2]=7,ce[S>>3]=R),R=+va(16592,O),R<+ce[S>>3]&&(g[w>>2]=8,ce[S>>3]=R),R=+va(16616,O),R<+ce[S>>3]&&(g[w>>2]=9,ce[S>>3]=R),R=+va(16640,O),R<+ce[S>>3]&&(g[w>>2]=10,ce[S>>3]=R),R=+va(16664,O),R<+ce[S>>3]&&(g[w>>2]=11,ce[S>>3]=R),R=+va(16688,O),R<+ce[S>>3]&&(g[w>>2]=12,ce[S>>3]=R),R=+va(16712,O),R<+ce[S>>3]&&(g[w>>2]=13,ce[S>>3]=R),R=+va(16736,O),R<+ce[S>>3]&&(g[w>>2]=14,ce[S>>3]=R),R=+va(16760,O),R<+ce[S>>3]&&(g[w>>2]=15,ce[S>>3]=R),R=+va(16784,O),R<+ce[S>>3]&&(g[w>>2]=16,ce[S>>3]=R),R=+va(16808,O),R<+ce[S>>3]&&(g[w>>2]=17,ce[S>>3]=R),R=+va(16832,O),R<+ce[S>>3]&&(g[w>>2]=18,ce[S>>3]=R),R=+va(16856,O),!(R<+ce[S>>3])){Fe=j;return}g[w>>2]=19,ce[S>>3]=R,Fe=j}function mu(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0;if(j=+Xh(b),j<1e-16){w=15600+(w<<4)|0,g[O>>2]=g[w>>2],g[O+4>>2]=g[w+4>>2],g[O+8>>2]=g[w+8>>2],g[O+12>>2]=g[w+12>>2];return}if(V=+Fn(+ +ce[b+8>>3],+ +ce[b>>3]),(S|0)>0){b=0;do j=j*.37796447300922725,b=b+1|0;while((b|0)!=(S|0))}Z=j*.3333333333333333,R?(S=(ua(S)|0)==0,j=+Ii(+((S?Z:Z*.37796447300922725)*.381966011250105))):(j=+Ii(+(j*.381966011250105)),ua(S)|0&&(V=+Pc(V+.3334731722518321))),Hh(15600+(w<<4)|0,+Pc(+ce[15920+(w*24|0)>>3]-V),j,O)}function Au(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0;R=Fe,Fe=Fe+16|0,O=R,Ka(b+4|0,O),mu(O,g[b>>2]|0,w,0,S),Fe=R}function Fh(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0,ui=0,yi=0,ni=0,Tn=0,Wr=0,pi=0,hi=0,mi=0;if(pi=Fe,Fe=Fe+272|0,j=pi+256|0,Qt=pi+240|0,ni=pi,Tn=pi+224|0,Wr=pi+208|0,qt=pi+176|0,Dt=pi+160|0,yr=pi+192|0,fn=pi+144|0,an=pi+128|0,ci=pi+112|0,ui=pi+96|0,yi=pi+80|0,g[j>>2]=w,g[Qt>>2]=g[b>>2],g[Qt+4>>2]=g[b+4>>2],g[Qt+8>>2]=g[b+8>>2],g[Qt+12>>2]=g[b+12>>2],cs(Qt,j,ni),g[O>>2]=0,Qt=R+S+((R|0)==5&1)|0,(Qt|0)<=(S|0)){Fe=pi;return}re=g[j>>2]|0,pe=Tn+4|0,xe=qt+4|0,qe=S+5|0,nt=16880+(re<<2)|0,ot=16960+(re<<2)|0,at=an+8|0,Rt=ci+8|0,jt=ui+8|0,fr=Wr+4|0,Z=S;e:for(;;){V=ni+(((Z|0)%5|0)<<4)|0,g[Wr>>2]=g[V>>2],g[Wr+4>>2]=g[V+4>>2],g[Wr+8>>2]=g[V+8>>2],g[Wr+12>>2]=g[V+12>>2];do;while((ys(Wr,re,0,1)|0)==2);if((Z|0)>(S|0)&(ua(w)|0)!=0){if(g[qt>>2]=g[Wr>>2],g[qt+4>>2]=g[Wr+4>>2],g[qt+8>>2]=g[Wr+8>>2],g[qt+12>>2]=g[Wr+12>>2],Ka(pe,Dt),R=g[qt>>2]|0,j=g[17040+(R*80|0)+(g[Tn>>2]<<2)>>2]|0,g[qt>>2]=g[18640+(R*80|0)+(j*20|0)>>2],V=g[18640+(R*80|0)+(j*20|0)+16>>2]|0,(V|0)>0){b=0;do Ad(xe),b=b+1|0;while((b|0)<(V|0))}switch(V=18640+(R*80|0)+(j*20|0)+4|0,g[yr>>2]=g[V>>2],g[yr+4>>2]=g[V+4>>2],g[yr+8>>2]=g[V+8>>2],qs(yr,(g[nt>>2]|0)*3|0),ya(xe,yr,xe),Oa(xe),Ka(xe,fn),hi=+(g[ot>>2]|0),ce[an>>3]=hi*3,ce[at>>3]=0,mi=hi*-1.5,ce[ci>>3]=mi,ce[Rt>>3]=hi*2.598076211353316,ce[ui>>3]=mi,ce[jt>>3]=hi*-2.598076211353316,g[17040+((g[qt>>2]|0)*80|0)+(g[Wr>>2]<<2)>>2]|0){case 1:{b=ci,R=an;break}case 3:{b=ui,R=ci;break}case 2:{b=an,R=ui;break}default:{b=12;break e}}Tu(Dt,fn,R,b,yi),mu(yi,g[qt>>2]|0,re,1,O+8+(g[O>>2]<<4)|0),g[O>>2]=(g[O>>2]|0)+1}if((Z|0)<(qe|0)&&(Ka(fr,qt),mu(qt,g[Wr>>2]|0,re,1,O+8+(g[O>>2]<<4)|0),g[O>>2]=(g[O>>2]|0)+1),g[Tn>>2]=g[Wr>>2],g[Tn+4>>2]=g[Wr+4>>2],g[Tn+8>>2]=g[Wr+8>>2],g[Tn+12>>2]=g[Wr+12>>2],Z=Z+1|0,(Z|0)>=(Qt|0)){b=3;break}}if((b|0)==3){Fe=pi;return}else(b|0)==12&&mn(26970,27017,572,27027)}function cs(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0;re=Fe,Fe=Fe+128|0,R=re+64|0,O=re,j=R,V=20240,Z=j+60|0;do g[j>>2]=g[V>>2],j=j+4|0,V=V+4|0;while((j|0)<(Z|0));j=O,V=20304,Z=j+60|0;do g[j>>2]=g[V>>2],j=j+4|0,V=V+4|0;while((j|0)<(Z|0));Z=(ua(g[w>>2]|0)|0)==0,R=Z?R:O,O=b+4|0,Gl(O),gd(O),ua(g[w>>2]|0)|0&&(fu(O),g[w>>2]=(g[w>>2]|0)+1),g[S>>2]=g[b>>2],w=S+4|0,ya(O,R,w),Oa(w),g[S+16>>2]=g[b>>2],w=S+20|0,ya(O,R+12|0,w),Oa(w),g[S+32>>2]=g[b>>2],w=S+36|0,ya(O,R+24|0,w),Oa(w),g[S+48>>2]=g[b>>2],w=S+52|0,ya(O,R+36|0,w),Oa(w),g[S+64>>2]=g[b>>2],S=S+68|0,ya(O,R+48|0,S),Oa(S),Fe=re}function ys(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0;if(at=Fe,Fe=Fe+32|0,nt=at+12|0,Z=at,ot=b+4|0,qe=g[16960+(w<<2)>>2]|0,xe=(R|0)!=0,qe=xe?qe*3|0:qe,O=g[ot>>2]|0,pe=b+8|0,V=g[pe>>2]|0,xe){if(j=b+12|0,R=g[j>>2]|0,O=V+O+R|0,(O|0)==(qe|0))return ot=1,Fe=at,ot|0;re=j}else re=b+12|0,R=g[re>>2]|0,O=V+O+R|0;if((O|0)<=(qe|0))return ot=0,Fe=at,ot|0;do if((R|0)>0){if(R=g[b>>2]|0,(V|0)>0){j=18640+(R*80|0)+60|0,R=b;break}R=18640+(R*80|0)+40|0,S?(Lh(nt,qe,0,0),hu(ot,nt,Z),hn(Z),ya(Z,nt,ot),j=R,R=b):(j=R,R=b)}else j=18640+((g[b>>2]|0)*80|0)+20|0,R=b;while(!1);if(g[R>>2]=g[j>>2],O=j+16|0,(g[O>>2]|0)>0){R=0;do Ad(ot),R=R+1|0;while((R|0)<(g[O>>2]|0))}return b=j+4|0,g[nt>>2]=g[b>>2],g[nt+4>>2]=g[b+4>>2],g[nt+8>>2]=g[b+8>>2],w=g[16880+(w<<2)>>2]|0,qs(nt,xe?w*3|0:w),ya(ot,nt,ot),Oa(ot),xe?R=((g[pe>>2]|0)+(g[ot>>2]|0)+(g[re>>2]|0)|0)==(qe|0)?1:2:R=2,ot=R,Fe=at,ot|0}function Is(b,w){b=b|0,w=w|0;var S=0;do S=ys(b,w,0,1)|0;while((S|0)==2);return S|0}function gu(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0,ui=0,yi=0,ni=0;if(ui=Fe,Fe=Fe+240|0,j=ui+224|0,yr=ui+208|0,fn=ui,an=ui+192|0,ci=ui+176|0,jt=ui+160|0,fr=ui+144|0,Qt=ui+128|0,qt=ui+112|0,Dt=ui+96|0,g[j>>2]=w,g[yr>>2]=g[b>>2],g[yr+4>>2]=g[b+4>>2],g[yr+8>>2]=g[b+8>>2],g[yr+12>>2]=g[b+12>>2],Nh(yr,j,fn),g[O>>2]=0,Rt=R+S+((R|0)==6&1)|0,(Rt|0)<=(S|0)){Fe=ui;return}re=g[j>>2]|0,pe=S+6|0,xe=16960+(re<<2)|0,qe=fr+8|0,nt=Qt+8|0,ot=qt+8|0,at=an+4|0,V=0,Z=S,R=-1;e:for(;;){if(j=(Z|0)%6|0,b=fn+(j<<4)|0,g[an>>2]=g[b>>2],g[an+4>>2]=g[b+4>>2],g[an+8>>2]=g[b+8>>2],g[an+12>>2]=g[b+12>>2],b=V,V=ys(an,re,0,1)|0,(Z|0)>(S|0)&(ua(w)|0)!=0&&(b|0)!=1&&(g[an>>2]|0)!=(R|0)){switch(Ka(fn+(((j+5|0)%6|0)<<4)+4|0,ci),Ka(fn+(j<<4)+4|0,jt),yi=+(g[xe>>2]|0),ce[fr>>3]=yi*3,ce[qe>>3]=0,ni=yi*-1.5,ce[Qt>>3]=ni,ce[nt>>3]=yi*2.598076211353316,ce[qt>>3]=ni,ce[ot>>3]=yi*-2.598076211353316,j=g[yr>>2]|0,g[17040+(j*80|0)+(((R|0)==(j|0)?g[an>>2]|0:R)<<2)>>2]|0){case 1:{b=Qt,R=fr;break}case 3:{b=qt,R=Qt;break}case 2:{b=fr,R=qt;break}default:{b=8;break e}}Tu(ci,jt,R,b,Dt),!(Eu(ci,Dt)|0)&&!(Eu(jt,Dt)|0)&&(mu(Dt,g[yr>>2]|0,re,1,O+8+(g[O>>2]<<4)|0),g[O>>2]=(g[O>>2]|0)+1)}if((Z|0)<(pe|0)&&(Ka(at,ci),mu(ci,g[an>>2]|0,re,1,O+8+(g[O>>2]<<4)|0),g[O>>2]=(g[O>>2]|0)+1),Z=Z+1|0,(Z|0)>=(Rt|0)){b=3;break}else R=g[an>>2]|0}if((b|0)==3){Fe=ui;return}else(b|0)==8&&mn(27054,27017,737,27099)}function Nh(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0;re=Fe,Fe=Fe+160|0,R=re+80|0,O=re,j=R,V=20368,Z=j+72|0;do g[j>>2]=g[V>>2],j=j+4|0,V=V+4|0;while((j|0)<(Z|0));j=O,V=20448,Z=j+72|0;do g[j>>2]=g[V>>2],j=j+4|0,V=V+4|0;while((j|0)<(Z|0));Z=(ua(g[w>>2]|0)|0)==0,R=Z?R:O,O=b+4|0,Gl(O),gd(O),ua(g[w>>2]|0)|0&&(fu(O),g[w>>2]=(g[w>>2]|0)+1),g[S>>2]=g[b>>2],w=S+4|0,ya(O,R,w),Oa(w),g[S+16>>2]=g[b>>2],w=S+20|0,ya(O,R+12|0,w),Oa(w),g[S+32>>2]=g[b>>2],w=S+36|0,ya(O,R+24|0,w),Oa(w),g[S+48>>2]=g[b>>2],w=S+52|0,ya(O,R+36|0,w),Oa(w),g[S+64>>2]=g[b>>2],w=S+68|0,ya(O,R+48|0,w),Oa(w),g[S+80>>2]=g[b>>2],S=S+84|0,ya(O,R+60|0,S),Oa(S),Fe=re}function Ma(b,w){return b=b|0,w=w|0,w=Vr(b|0,w|0,52)|0,He()|0,w&15|0}function Ps(b,w){return b=b|0,w=w|0,w=Vr(b|0,w|0,45)|0,He()|0,w&127|0}function Mn(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0;return!(!0&(w&-16777216|0)==134217728)||(R=Vr(b|0,w|0,52)|0,He()|0,R=R&15,S=Vr(b|0,w|0,45)|0,He()|0,S=S&127,S>>>0>121)?(b=0,b|0):(V=(R^15)*3|0,O=Vr(b|0,w|0,V|0)|0,V=Jr(O|0,He()|0,V|0)|0,O=He()|0,j=Ro(-1227133514,-1171,V|0,O|0)|0,!((V&613566756&j|0)==0&(O&4681&(He()|0)|0)==0)||(V=(R*3|0)+19|0,j=Jr(~b|0,~w|0,V|0)|0,V=Vr(j|0,He()|0,V|0)|0,!((R|0)==15|(V|0)==0&(He()|0)==0))?(V=0,V|0):!(ze[20528+S>>0]|0)||(w=w&8191,(b|0)==0&(w|0)==0)?(V=1,V|0):(V=Id(b|0,w|0)|0,He()|0,((63-V|0)%3|0|0)!=0|0))}function Mr(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0;if(O=Jr(w|0,0,52)|0,j=He()|0,S=Jr(S|0,0,45)|0,S=j|(He()|0)|134225919,(w|0)<1){j=-1,R=S,w=b,g[w>>2]=j,b=b+4|0,g[b>>2]=R;return}for(j=1,O=-1;V=(15-j|0)*3|0,Z=Jr(7,0,V|0)|0,S=S&~(He()|0),V=Jr(R|0,0,V|0)|0,O=O&~Z|V,S=S|(He()|0),(j|0)!=(w|0);)j=j+1|0;Z=b,V=Z,g[V>>2]=O,Z=Z+4|0,g[Z>>2]=S}function ac(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0;if(j=Vr(b|0,w|0,52)|0,He()|0,j=j&15,S>>>0>15)return R=4,R|0;if((j|0)<(S|0))return R=12,R|0;if((j|0)==(S|0))return g[R>>2]=b,g[R+4>>2]=w,R=0,R|0;if(O=Jr(S|0,0,52)|0,O=O|b,b=He()|0|w&-15728641,(j|0)>(S|0))do w=Jr(7,0,(14-S|0)*3|0)|0,S=S+1|0,O=w|O,b=He()|0|b;while((S|0)<(j|0));return g[R>>2]=O,g[R+4>>2]=b,R=0,R|0}function cn(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0;if(j=Vr(b|0,w|0,52)|0,He()|0,j=j&15,!((S|0)<16&(j|0)<=(S|0)))return R=4,R|0;O=S-j|0,S=Vr(b|0,w|0,45)|0,He()|0;e:do if(!(Fo(S&127)|0))S=$i(7,0,O,((O|0)<0)<<31>>31)|0,O=He()|0;else{t:do if(j|0){for(S=1;V=Jr(7,0,(15-S|0)*3|0)|0,!!((V&b|0)==0&((He()|0)&w|0)==0);)if(S>>>0<j>>>0)S=S+1|0;else break t;S=$i(7,0,O,((O|0)<0)<<31>>31)|0,O=He()|0;break e}while(!1);S=$i(7,0,O,((O|0)<0)<<31>>31)|0,S=La(S|0,He()|0,5,0)|0,S=qn(S|0,He()|0,-5,-1)|0,S=ks(S|0,He()|0,6,0)|0,S=qn(S|0,He()|0,1,0)|0,O=He()|0}while(!1);return V=R,g[V>>2]=S,g[V+4>>2]=O,V=0,V|0}function So(b,w){b=b|0,w=w|0;var S=0,R=0,O=0;if(O=Vr(b|0,w|0,45)|0,He()|0,!(Fo(O&127)|0))return O=0,O|0;O=Vr(b|0,w|0,52)|0,He()|0,O=O&15;e:do if(!O)S=0;else for(R=1;;){if(S=Vr(b|0,w|0,(15-R|0)*3|0)|0,He()|0,S=S&7,S|0)break e;if(R>>>0<O>>>0)R=R+1|0;else{S=0;break}}while(!1);return O=(S|0)==0&1,O|0}function _u(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0;if(V=Fe,Fe=Fe+16|0,j=V,Ic(j,b,w,S),w=j,b=g[w>>2]|0,w=g[w+4>>2]|0,(b|0)==0&(w|0)==0)return Fe=V,0;O=0,S=0;do Z=R+(O<<3)|0,g[Z>>2]=b,g[Z+4>>2]=w,O=qn(O|0,S|0,1,0)|0,S=He()|0,oh(j),Z=j,b=g[Z>>2]|0,w=g[Z+4>>2]|0;while(!((b|0)==0&(w|0)==0));return Fe=V,0}function gn(b,w,S,R){return b=b|0,w=w|0,S=S|0,R=R|0,(R|0)<(S|0)?(S=w,R=b,yn(S|0),R|0):(S=Jr(-1,-1,((R-S|0)*3|0)+3|0)|0,R=Jr(~S|0,~(He()|0)|0,(15-R|0)*3|0)|0,S=~(He()|0)&w,R=~R&b,yn(S|0),R|0)}function xd(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0;return O=Vr(b|0,w|0,52)|0,He()|0,O=O&15,(S|0)<16&(O|0)<=(S|0)?((O|0)<(S|0)&&(O=Jr(-1,-1,((S+-1-O|0)*3|0)+3|0)|0,O=Jr(~O|0,~(He()|0)|0,(15-S|0)*3|0)|0,w=~(He()|0)&w,b=~O&b),O=Jr(S|0,0,52)|0,S=w&-15728641|(He()|0),g[R>>2]=b|O,g[R+4>>2]=S,R=0,R|0):(R=4,R|0)}function jh(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0,ui=0,yi=0,ni=0,Tn=0,Wr=0;if((S|0)==0&(R|0)==0)return Wr=0,Wr|0;if(O=b,j=g[O>>2]|0,O=g[O+4>>2]|0,!0&(O&15728640|0)==0){if(!((R|0)>0|(R|0)==0&S>>>0>0)||(Wr=w,g[Wr>>2]=j,g[Wr+4>>2]=O,(S|0)==1&(R|0)==0))return Wr=0,Wr|0;O=1,j=0;do ni=b+(O<<3)|0,Tn=g[ni+4>>2]|0,Wr=w+(O<<3)|0,g[Wr>>2]=g[ni>>2],g[Wr+4>>2]=Tn,O=qn(O|0,j|0,1,0)|0,j=He()|0;while((j|0)<(R|0)|(j|0)==(R|0)&O>>>0<S>>>0);return O=0,O|0}if(yi=S<<3,Tn=Bc(yi)|0,!Tn)return Wr=13,Wr|0;if(dh(Tn|0,b|0,yi|0)|0,ni=Pa(S,8)|0,!ni)return xn(Tn),Wr=13,Wr|0;e:for(;;){O=Tn,pe=g[O>>2]|0,O=g[O+4>>2]|0,ci=Vr(pe|0,O|0,52)|0,He()|0,ci=ci&15,ui=ci+-1|0,an=(ci|0)!=0,fn=(R|0)>0|(R|0)==0&S>>>0>0;t:do if(an&fn){if(Qt=Jr(ui|0,0,52)|0,qt=He()|0,ui>>>0>15){if(!((pe|0)==0&(O|0)==0)){Wr=16;break e}for(j=0,b=0;;){if(j=qn(j|0,b|0,1,0)|0,b=He()|0,!((b|0)<(R|0)|(b|0)==(R|0)&j>>>0<S>>>0))break t;if(V=Tn+(j<<3)|0,yr=g[V>>2]|0,V=g[V+4>>2]|0,!((yr|0)==0&(V|0)==0)){O=V,Wr=16;break e}}}for(Z=pe,b=O,j=0,V=0;;){if(!((Z|0)==0&(b|0)==0)){if(!(!0&(b&117440512|0)==0)){Wr=21;break e}if(xe=Vr(Z|0,b|0,52)|0,He()|0,xe=xe&15,(xe|0)<(ui|0)){O=12,Wr=27;break e}if((xe|0)!=(ui|0)&&(Z=Z|Qt,b=b&-15728641|qt,xe>>>0>=ci>>>0)){re=ui;do yr=Jr(7,0,(14-re|0)*3|0)|0,re=re+1|0,Z=yr|Z,b=He()|0|b;while(re>>>0<xe>>>0)}if(nt=cc(Z|0,b|0,S|0,R|0)|0,ot=He()|0,re=ni+(nt<<3)|0,xe=re,qe=g[xe>>2]|0,xe=g[xe+4>>2]|0,!((qe|0)==0&(xe|0)==0)){jt=0,fr=0;do{if((jt|0)>(R|0)|(jt|0)==(R|0)&fr>>>0>S>>>0){Wr=31;break e}if((qe|0)==(Z|0)&(xe&-117440513|0)==(b|0)){at=Vr(qe|0,xe|0,56)|0,He()|0,at=at&7,Rt=at+1|0,yr=Vr(qe|0,xe|0,45)|0,He()|0;r:do if(!(Fo(yr&127)|0))xe=7;else{if(qe=Vr(qe|0,xe|0,52)|0,He()|0,qe=qe&15,!qe){xe=6;break}for(xe=1;;){if(yr=Jr(7,0,(15-xe|0)*3|0)|0,!((yr&Z|0)==0&((He()|0)&b|0)==0)){xe=7;break r}if(xe>>>0<qe>>>0)xe=xe+1|0;else{xe=6;break}}}while(!1);if((at+2|0)>>>0>xe>>>0){Wr=41;break e}yr=Jr(Rt|0,0,56)|0,b=He()|0|b&-117440513,Dt=re,g[Dt>>2]=0,g[Dt+4>>2]=0,Z=yr|Z}else nt=qn(nt|0,ot|0,1,0)|0,nt=Iu(nt|0,He()|0,S|0,R|0)|0,ot=He()|0;fr=qn(fr|0,jt|0,1,0)|0,jt=He()|0,re=ni+(nt<<3)|0,xe=re,qe=g[xe>>2]|0,xe=g[xe+4>>2]|0}while(!((qe|0)==0&(xe|0)==0))}yr=re,g[yr>>2]=Z,g[yr+4>>2]=b}if(j=qn(j|0,V|0,1,0)|0,V=He()|0,!((V|0)<(R|0)|(V|0)==(R|0)&j>>>0<S>>>0))break t;b=Tn+(j<<3)|0,Z=g[b>>2]|0,b=g[b+4>>2]|0}}while(!1);if(yr=qn(S|0,R|0,5,0)|0,Dt=He()|0,Dt>>>0<0|(Dt|0)==0&yr>>>0<11){Wr=85;break}if(yr=ks(S|0,R|0,6,0)|0,He()|0,yr=Pa(yr,8)|0,!yr){Wr=48;break}do if(fn){for(Rt=0,b=0,at=0,jt=0;;){if(xe=ni+(Rt<<3)|0,V=xe,j=g[V>>2]|0,V=g[V+4>>2]|0,(j|0)==0&(V|0)==0)Dt=at;else{qe=Vr(j|0,V|0,56)|0,He()|0,qe=qe&7,Z=qe+1|0,nt=V&-117440513,Dt=Vr(j|0,V|0,45)|0,He()|0;t:do if(Fo(Dt&127)|0){if(ot=Vr(j|0,V|0,52)|0,He()|0,ot=ot&15,ot|0)for(re=1;;){if(Dt=Jr(7,0,(15-re|0)*3|0)|0,!((j&Dt|0)==0&(nt&(He()|0)|0)==0))break t;if(re>>>0<ot>>>0)re=re+1|0;else break}V=Jr(Z|0,0,56)|0,j=V|j,V=He()|0|nt,Z=xe,g[Z>>2]=j,g[Z+4>>2]=V,Z=qe+2|0}while(!1);(Z|0)==7?(Dt=yr+(b<<3)|0,g[Dt>>2]=j,g[Dt+4>>2]=V&-117440513,b=qn(b|0,at|0,1,0)|0,Dt=He()|0):Dt=at}if(Rt=qn(Rt|0,jt|0,1,0)|0,jt=He()|0,(jt|0)<(R|0)|(jt|0)==(R|0)&Rt>>>0<S>>>0)at=Dt;else break}if(fn){if(fr=ui>>>0>15,Qt=Jr(ui|0,0,52)|0,qt=He()|0,!an){for(j=0,re=0,Z=0,V=0;(pe|0)==0&(O|0)==0||(ui=w+(j<<3)|0,g[ui>>2]=pe,g[ui+4>>2]=O,j=qn(j|0,re|0,1,0)|0,re=He()|0),Z=qn(Z|0,V|0,1,0)|0,V=He()|0,!!((V|0)<(R|0)|(V|0)==(R|0)&Z>>>0<S>>>0);)O=Tn+(Z<<3)|0,pe=g[O>>2]|0,O=g[O+4>>2]|0;O=Dt;break}for(j=0,re=0,V=0,Z=0;;){do if(!((pe|0)==0&(O|0)==0)){if(ot=Vr(pe|0,O|0,52)|0,He()|0,ot=ot&15,fr|(ot|0)<(ui|0)){Wr=80;break e}if((ot|0)!=(ui|0)){if(xe=pe|Qt,qe=O&-15728641|qt,ot>>>0>=ci>>>0){nt=ui;do an=Jr(7,0,(14-nt|0)*3|0)|0,nt=nt+1|0,xe=an|xe,qe=He()|0|qe;while(nt>>>0<ot>>>0)}}else xe=pe,qe=O;at=cc(xe|0,qe|0,S|0,R|0)|0,nt=0,ot=0,jt=He()|0;do{if((nt|0)>(R|0)|(nt|0)==(R|0)&ot>>>0>S>>>0){Wr=81;break e}if(an=ni+(at<<3)|0,Rt=g[an+4>>2]|0,(Rt&-117440513|0)==(qe|0)&&(g[an>>2]|0)==(xe|0)){Wr=65;break}an=qn(at|0,jt|0,1,0)|0,at=Iu(an|0,He()|0,S|0,R|0)|0,jt=He()|0,ot=qn(ot|0,nt|0,1,0)|0,nt=He()|0,an=ni+(at<<3)|0}while(!((g[an>>2]|0)==(xe|0)&&(g[an+4>>2]|0)==(qe|0)));if((Wr|0)==65&&(Wr=0,!0&(Rt&117440512|0)==100663296))break;an=w+(j<<3)|0,g[an>>2]=pe,g[an+4>>2]=O,j=qn(j|0,re|0,1,0)|0,re=He()|0}while(!1);if(V=qn(V|0,Z|0,1,0)|0,Z=He()|0,!((Z|0)<(R|0)|(Z|0)==(R|0)&V>>>0<S>>>0))break;O=Tn+(V<<3)|0,pe=g[O>>2]|0,O=g[O+4>>2]|0}O=Dt}else j=0,O=Dt}else j=0,b=0,O=0;while(!1);if(Pu(ni|0,0,yi|0)|0,dh(Tn|0,yr|0,b<<3|0)|0,xn(yr),(b|0)==0&(O|0)==0){Wr=89;break}else w=w+(j<<3)|0,R=O,S=b}if((Wr|0)==16)!0&(O&117440512|0)==0?(O=4,Wr=27):Wr=21;else if((Wr|0)==31)mn(27795,27122,529,27132);else{if((Wr|0)==41)return xn(Tn),xn(ni),Wr=10,Wr|0;if((Wr|0)==48)return xn(Tn),xn(ni),Wr=13,Wr|0;(Wr|0)==80?mn(27795,27122,620,27132):(Wr|0)==81?mn(27795,27122,632,27132):(Wr|0)==85&&(dh(w|0,Tn|0,S<<3|0)|0,Wr=89)}return(Wr|0)==21?(xn(Tn),xn(ni),Wr=5,Wr|0):(Wr|0)==27?(xn(Tn),xn(ni),Wr=O,Wr|0):(Wr|0)==89?(xn(Tn),xn(ni),Wr=0,Wr|0):0}function Uh(b,w,S,R,O,j,V){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0,j=j|0,V=V|0;var Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0;if(Rt=Fe,Fe=Fe+16|0,at=Rt,!((S|0)>0|(S|0)==0&w>>>0>0))return at=0,Fe=Rt,at|0;if((V|0)>=16)return at=12,Fe=Rt,at|0;nt=0,ot=0,qe=0,Z=0;e:for(;;){if(pe=b+(nt<<3)|0,re=g[pe>>2]|0,pe=g[pe+4>>2]|0,xe=Vr(re|0,pe|0,52)|0,He()|0,(xe&15|0)>(V|0)){Z=12,re=11;break}if(Ic(at,re,pe,V),xe=at,pe=g[xe>>2]|0,xe=g[xe+4>>2]|0,(pe|0)==0&(xe|0)==0)re=qe;else{re=qe;do{if(!((Z|0)<(j|0)|(Z|0)==(j|0)&re>>>0<O>>>0)){re=10;break e}qe=R+(re<<3)|0,g[qe>>2]=pe,g[qe+4>>2]=xe,re=qn(re|0,Z|0,1,0)|0,Z=He()|0,oh(at),qe=at,pe=g[qe>>2]|0,xe=g[qe+4>>2]|0}while(!((pe|0)==0&(xe|0)==0))}if(nt=qn(nt|0,ot|0,1,0)|0,ot=He()|0,(ot|0)<(S|0)|(ot|0)==(S|0)&nt>>>0<w>>>0)qe=re;else{Z=0,re=11;break}}return(re|0)==10?(at=14,Fe=Rt,at|0):(re|0)==11?(Fe=Rt,Z|0):0}function ap(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0;nt=Fe,Fe=Fe+16|0,qe=nt;e:do if((S|0)>0|(S|0)==0&w>>>0>0){for(pe=0,V=0,j=0,xe=0;;){if(re=b+(pe<<3)|0,Z=g[re>>2]|0,re=g[re+4>>2]|0,!((Z|0)==0&(re|0)==0)&&(re=(cn(Z,re,R,qe)|0)==0,Z=qe,V=qn(g[Z>>2]|0,g[Z+4>>2]|0,V|0,j|0)|0,j=He()|0,!re)){j=12;break}if(pe=qn(pe|0,xe|0,1,0)|0,xe=He()|0,!((xe|0)<(S|0)|(xe|0)==(S|0)&pe>>>0<w>>>0))break e}return Fe=nt,j|0}else V=0,j=0;while(!1);return g[O>>2]=V,g[O+4>>2]=j,O=0,Fe=nt,O|0}function bd(b,w){return b=b|0,w=w|0,w=Vr(b|0,w|0,52)|0,He()|0,w&1|0}function Ki(b,w){b=b|0,w=w|0;var S=0,R=0,O=0;if(O=Vr(b|0,w|0,52)|0,He()|0,O=O&15,!O)return O=0,O|0;for(R=1;;){if(S=Vr(b|0,w|0,(15-R|0)*3|0)|0,He()|0,S=S&7,S|0){R=5;break}if(R>>>0<O>>>0)R=R+1|0;else{S=0,R=5;break}}return(R|0)==5?S|0:0}function wd(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0;if(re=Vr(b|0,w|0,52)|0,He()|0,re=re&15,!re)return Z=w,re=b,yn(Z|0),re|0;for(Z=1,S=0;;){j=(15-Z|0)*3|0,R=Jr(7,0,j|0)|0,O=He()|0,V=Vr(b|0,w|0,j|0)|0,He()|0,j=Jr(du(V&7)|0,0,j|0)|0,V=He()|0,b=j|b&~R,w=V|w&~O;e:do if(!S)if((j&R|0)==0&(V&O|0)==0)S=0;else if(R=Vr(b|0,w|0,52)|0,He()|0,R=R&15,!R)S=1;else{S=1;t:for(;;){switch(V=Vr(b|0,w|0,(15-S|0)*3|0)|0,He()|0,V&7){case 1:break t;case 0:break;default:{S=1;break e}}if(S>>>0<R>>>0)S=S+1|0;else{S=1;break e}}for(S=1;;)if(V=(15-S|0)*3|0,O=Vr(b|0,w|0,V|0)|0,He()|0,j=Jr(7,0,V|0)|0,w=w&~(He()|0),V=Jr(du(O&7)|0,0,V|0)|0,b=b&~j|V,w=w|(He()|0),S>>>0<R>>>0)S=S+1|0;else{S=1;break}}while(!1);if(Z>>>0<re>>>0)Z=Z+1|0;else break}return yn(w|0),b|0}function Zs(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0;if(R=Vr(b|0,w|0,52)|0,He()|0,R=R&15,!R)return S=w,R=b,yn(S|0),R|0;for(S=1;j=(15-S|0)*3|0,V=Vr(b|0,w|0,j|0)|0,He()|0,O=Jr(7,0,j|0)|0,w=w&~(He()|0),j=Jr(du(V&7)|0,0,j|0)|0,b=j|b&~O,w=He()|0|w,S>>>0<R>>>0;)S=S+1|0;return yn(w|0),b|0}function Rs(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0;if(re=Vr(b|0,w|0,52)|0,He()|0,re=re&15,!re)return Z=w,re=b,yn(Z|0),re|0;for(Z=1,S=0;;){j=(15-Z|0)*3|0,R=Jr(7,0,j|0)|0,O=He()|0,V=Vr(b|0,w|0,j|0)|0,He()|0,j=Jr($a(V&7)|0,0,j|0)|0,V=He()|0,b=j|b&~R,w=V|w&~O;e:do if(!S)if((j&R|0)==0&(V&O|0)==0)S=0;else if(R=Vr(b|0,w|0,52)|0,He()|0,R=R&15,!R)S=1;else{S=1;t:for(;;){switch(V=Vr(b|0,w|0,(15-S|0)*3|0)|0,He()|0,V&7){case 1:break t;case 0:break;default:{S=1;break e}}if(S>>>0<R>>>0)S=S+1|0;else{S=1;break e}}for(S=1;;)if(O=(15-S|0)*3|0,j=Jr(7,0,O|0)|0,V=w&~(He()|0),w=Vr(b|0,w|0,O|0)|0,He()|0,w=Jr($a(w&7)|0,0,O|0)|0,b=b&~j|w,w=V|(He()|0),S>>>0<R>>>0)S=S+1|0;else{S=1;break}}while(!1);if(Z>>>0<re>>>0)Z=Z+1|0;else break}return yn(w|0),b|0}function Ec(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0;if(R=Vr(b|0,w|0,52)|0,He()|0,R=R&15,!R)return S=w,R=b,yn(S|0),R|0;for(S=1;V=(15-S|0)*3|0,j=Jr(7,0,V|0)|0,O=w&~(He()|0),w=Vr(b|0,w|0,V|0)|0,He()|0,w=Jr($a(w&7)|0,0,V|0)|0,b=w|b&~j,w=He()|0|O,S>>>0<R>>>0;)S=S+1|0;return yn(w|0),b|0}function Ja(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(re=Fe,Fe=Fe+64|0,Z=re+40|0,R=re+24|0,O=re+12|0,j=re,Jr(w|0,0,52)|0,S=He()|0|134225919,!w)return(g[b+4>>2]|0)>2||(g[b+8>>2]|0)>2||(g[b+12>>2]|0)>2?(V=0,Z=0,yn(V|0),Fe=re,Z|0):(Jr(ou(b)|0,0,45)|0,V=He()|0|S,Z=-1,yn(V|0),Fe=re,Z|0);if(g[Z>>2]=g[b>>2],g[Z+4>>2]=g[b+4>>2],g[Z+8>>2]=g[b+8>>2],g[Z+12>>2]=g[b+12>>2],V=Z+4|0,(w|0)>0)for(b=-1;g[R>>2]=g[V>>2],g[R+4>>2]=g[V+4>>2],g[R+8>>2]=g[V+8>>2],w&1?(zf(V),g[O>>2]=g[V>>2],g[O+4>>2]=g[V+4>>2],g[O+8>>2]=g[V+8>>2],vi(O)):(np(V),g[O>>2]=g[V>>2],g[O+4>>2]=g[V+4>>2],g[O+8>>2]=g[V+8>>2],fu(O)),hu(R,O,j),Oa(j),xe=(15-w|0)*3|0,pe=Jr(7,0,xe|0)|0,S=S&~(He()|0),xe=Jr(Tc(j)|0,0,xe|0)|0,b=xe|b&~pe,S=He()|0|S,(w|0)>1;)w=w+-1|0;else b=-1;e:do if((g[V>>2]|0)<=2&&(g[Z+8>>2]|0)<=2&&(g[Z+12>>2]|0)<=2){if(R=ou(Z)|0,w=Jr(R|0,0,45)|0,w=w|b,b=He()|0|S&-1040385,j=ls(Z)|0,!(Fo(R)|0)){if((j|0)<=0)break;for(O=0;;){if(R=Vr(w|0,b|0,52)|0,He()|0,R=R&15,R)for(S=1;xe=(15-S|0)*3|0,Z=Vr(w|0,b|0,xe|0)|0,He()|0,pe=Jr(7,0,xe|0)|0,b=b&~(He()|0),xe=Jr(du(Z&7)|0,0,xe|0)|0,w=w&~pe|xe,b=b|(He()|0),S>>>0<R>>>0;)S=S+1|0;if(O=O+1|0,(O|0)==(j|0))break e}}O=Vr(w|0,b|0,52)|0,He()|0,O=O&15;t:do if(O){S=1;r:for(;;){switch(xe=Vr(w|0,b|0,(15-S|0)*3|0)|0,He()|0,xe&7){case 1:break r;case 0:break;default:break t}if(S>>>0<O>>>0)S=S+1|0;else break t}if(au(R,g[Z>>2]|0)|0)for(S=1;Z=(15-S|0)*3|0,pe=Jr(7,0,Z|0)|0,xe=b&~(He()|0),b=Vr(w|0,b|0,Z|0)|0,He()|0,b=Jr($a(b&7)|0,0,Z|0)|0,w=w&~pe|b,b=xe|(He()|0),S>>>0<O>>>0;)S=S+1|0;else for(S=1;xe=(15-S|0)*3|0,Z=Vr(w|0,b|0,xe|0)|0,He()|0,pe=Jr(7,0,xe|0)|0,b=b&~(He()|0),xe=Jr(du(Z&7)|0,0,xe|0)|0,w=w&~pe|xe,b=b|(He()|0),S>>>0<O>>>0;)S=S+1|0}while(!1);if((j|0)>0){S=0;do w=wd(w,b)|0,b=He()|0,S=S+1|0;while((S|0)!=(j|0))}}else w=0,b=0;while(!1);return pe=b,xe=w,yn(pe|0),Fe=re,xe|0}function ua(b){return b=b|0,(b|0)%2|0|0}function sc(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0;return O=Fe,Fe=Fe+16|0,R=O,w>>>0>15?(R=4,Fe=O,R|0):(g[b+4>>2]&2146435072|0)==2146435072||(g[b+8+4>>2]&2146435072|0)==2146435072?(R=3,Fe=O,R|0):(yd(b,w,R),w=Ja(R,w)|0,R=He()|0,g[S>>2]=w,g[S+4>>2]=R,(w|0)==0&(R|0)==0&&mn(27795,27122,959,27145),R=0,Fe=O,R|0)}function sp(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0;if(O=S+4|0,j=Vr(b|0,w|0,52)|0,He()|0,j=j&15,V=Vr(b|0,w|0,45)|0,He()|0,R=(j|0)==0,Fo(V&127)|0){if(R)return V=1,V|0;R=1}else{if(R)return V=0,V|0;(g[O>>2]|0)==0&&(g[S+8>>2]|0)==0?R=(g[S+12>>2]|0)!=0&1:R=1}for(S=1;S&1?vi(O):fu(O),V=Vr(b|0,w|0,(15-S|0)*3|0)|0,He()|0,Jp(O,V&7),S>>>0<j>>>0;)S=S+1|0;return R|0}function Cc(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(xe=Fe,Fe=Fe+16|0,re=xe,pe=Vr(b|0,w|0,45)|0,He()|0,pe=pe&127,pe>>>0>121)return g[S>>2]=0,g[S+4>>2]=0,g[S+8>>2]=0,g[S+12>>2]=0,pe=5,Fe=xe,pe|0;e:do if((Fo(pe)|0)!=0&&(j=Vr(b|0,w|0,52)|0,He()|0,j=j&15,(j|0)!=0)){R=1;t:for(;;){switch(Z=Vr(b|0,w|0,(15-R|0)*3|0)|0,He()|0,Z&7){case 5:break t;case 0:break;default:{R=w;break e}}if(R>>>0<j>>>0)R=R+1|0;else{R=w;break e}}for(O=1,R=w;w=(15-O|0)*3|0,V=Jr(7,0,w|0)|0,Z=R&~(He()|0),R=Vr(b|0,R|0,w|0)|0,He()|0,R=Jr($a(R&7)|0,0,w|0)|0,b=b&~V|R,R=Z|(He()|0),O>>>0<j>>>0;)O=O+1|0}else R=w;while(!1);if(Z=7696+(pe*28|0)|0,g[S>>2]=g[Z>>2],g[S+4>>2]=g[Z+4>>2],g[S+8>>2]=g[Z+8>>2],g[S+12>>2]=g[Z+12>>2],!(sp(b,R,S)|0))return pe=0,Fe=xe,pe|0;if(V=S+4|0,g[re>>2]=g[V>>2],g[re+4>>2]=g[V+4>>2],g[re+8>>2]=g[V+8>>2],j=Vr(b|0,R|0,52)|0,He()|0,Z=j&15,j&1?(fu(V),j=Z+1|0):j=Z,!(Fo(pe)|0))R=0;else{e:do if(!Z)R=0;else for(w=1;;){if(O=Vr(b|0,R|0,(15-w|0)*3|0)|0,He()|0,O=O&7,O|0){R=O;break e}if(w>>>0<Z>>>0)w=w+1|0;else{R=0;break}}while(!1);R=(R|0)==4&1}if(!(ys(S,j,R,0)|0))(j|0)!=(Z|0)&&(g[V>>2]=g[re>>2],g[V+4>>2]=g[re+4>>2],g[V+8>>2]=g[re+8>>2]);else{if(Fo(pe)|0)do;while((ys(S,j,0,0)|0)!=0);(j|0)!=(Z|0)&&np(V)}return pe=0,Fe=xe,pe|0}function Sl(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;return j=Fe,Fe=Fe+16|0,R=j,O=Cc(b,w,R)|0,O|0?(Fe=j,O|0):(O=Vr(b|0,w|0,52)|0,He()|0,Au(R,O&15,S),O=0,Fe=j,O|0)}function vs(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0;if(V=Fe,Fe=Fe+16|0,j=V,R=Cc(b,w,j)|0,R|0)return j=R,Fe=V,j|0;R=Vr(b|0,w|0,45)|0,He()|0,R=(Fo(R&127)|0)==0,O=Vr(b|0,w|0,52)|0,He()|0,O=O&15;e:do if(!R){if(O|0)for(R=1;;){if(Z=Jr(7,0,(15-R|0)*3|0)|0,!((Z&b|0)==0&((He()|0)&w|0)==0))break e;if(R>>>0<O>>>0)R=R+1|0;else break}return Fh(j,O,0,5,S),Z=0,Fe=V,Z|0}while(!1);return gu(j,O,0,6,S),Z=0,Fe=V,Z|0}function em(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;if(O=Vr(b|0,w|0,45)|0,He()|0,!(Fo(O&127)|0))return O=2,g[S>>2]=O,0;if(O=Vr(b|0,w|0,52)|0,He()|0,O=O&15,!O)return O=5,g[S>>2]=O,0;for(R=1;;){if(j=Jr(7,0,(15-R|0)*3|0)|0,!((j&b|0)==0&((He()|0)&w|0)==0)){R=2,b=6;break}if(R>>>0<O>>>0)R=R+1|0;else{R=5,b=6;break}}return(b|0)==6&&(g[S>>2]=R),0}function Vh(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0;qe=Fe,Fe=Fe+128|0,pe=qe+112|0,j=qe+96|0,xe=qe,O=Vr(b|0,w|0,52)|0,He()|0,Z=O&15,g[pe>>2]=Z,V=Vr(b|0,w|0,45)|0,He()|0,V=V&127;e:do if(Fo(V)|0){if(Z|0)for(R=1;;){if(re=Jr(7,0,(15-R|0)*3|0)|0,!((re&b|0)==0&((He()|0)&w|0)==0)){O=0;break e}if(R>>>0<Z>>>0)R=R+1|0;else break}if(O&1)O=1;else return re=Jr(Z+1|0,0,52)|0,xe=He()|0|w&-15728641,pe=Jr(7,0,(14-Z|0)*3|0)|0,xe=Vh((re|b)&~pe,xe&~(He()|0),S)|0,Fe=qe,xe|0}else O=0;while(!1);if(R=Cc(b,w,j)|0,!R){O?(cs(j,pe,xe),re=5):(Nh(j,pe,xe),re=6);e:do if(Fo(V)|0)if(!Z)b=5;else for(R=1;;){if(V=Jr(7,0,(15-R|0)*3|0)|0,!((V&b|0)==0&((He()|0)&w|0)==0)){b=2;break e}if(R>>>0<Z>>>0)R=R+1|0;else{b=5;break}}else b=2;while(!1);Pu(S|0,-1,b<<2|0)|0;e:do if(O)for(j=0;;){if(V=xe+(j<<4)|0,Is(V,g[pe>>2]|0)|0,V=g[V>>2]|0,Z=g[S>>2]|0,(Z|0)==-1|(Z|0)==(V|0))R=S;else{O=0;do{if(O=O+1|0,O>>>0>=b>>>0){R=1;break e}R=S+(O<<2)|0,Z=g[R>>2]|0}while(!((Z|0)==-1|(Z|0)==(V|0)))}if(g[R>>2]=V,j=j+1|0,j>>>0>=re>>>0){R=0;break}}else for(j=0;;){if(V=xe+(j<<4)|0,ys(V,g[pe>>2]|0,0,1)|0,V=g[V>>2]|0,Z=g[S>>2]|0,(Z|0)==-1|(Z|0)==(V|0))R=S;else{O=0;do{if(O=O+1|0,O>>>0>=b>>>0){R=1;break e}R=S+(O<<2)|0,Z=g[R>>2]|0}while(!((Z|0)==-1|(Z|0)==(V|0)))}if(g[R>>2]=V,j=j+1|0,j>>>0>=re>>>0){R=0;break}}while(!1)}return xe=R,Fe=qe,xe|0}function $h(){return 12}function rh(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0;if(b>>>0>15)return Z=4,Z|0;if(Jr(b|0,0,52)|0,Z=He()|0|134225919,!b){S=0,R=0;do Fo(R)|0&&(Jr(R|0,0,45)|0,V=Z|(He()|0),b=w+(S<<3)|0,g[b>>2]=-1,g[b+4>>2]=V,S=S+1|0),R=R+1|0;while((R|0)!=122);return S=0,S|0}S=0,V=0;do{if(Fo(V)|0){for(Jr(V|0,0,45)|0,R=1,O=-1,j=Z|(He()|0);re=Jr(7,0,(15-R|0)*3|0)|0,O=O&~re,j=j&~(He()|0),(R|0)!=(b|0);)R=R+1|0;re=w+(S<<3)|0,g[re>>2]=O,g[re+4>>2]=j,S=S+1|0}V=V+1|0}while((V|0)!=122);return S=0,S|0}function nh(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0;if(Qt=Fe,Fe=Fe+16|0,jt=Qt,fr=Vr(b|0,w|0,52)|0,He()|0,fr=fr&15,S>>>0>15)return fr=4,Fe=Qt,fr|0;if((fr|0)<(S|0))return fr=12,Fe=Qt,fr|0;if((fr|0)!=(S|0))if(j=Jr(S|0,0,52)|0,j=j|b,Z=He()|0|w&-15728641,(fr|0)>(S|0)){re=S;do Rt=Jr(7,0,(14-re|0)*3|0)|0,re=re+1|0,j=Rt|j,Z=He()|0|Z;while((re|0)<(fr|0));Rt=j}else Rt=j;else Rt=b,Z=w;at=Vr(Rt|0,Z|0,45)|0,He()|0;e:do if(Fo(at&127)|0){if(re=Vr(Rt|0,Z|0,52)|0,He()|0,re=re&15,re|0)for(j=1;;){if(at=Jr(7,0,(15-j|0)*3|0)|0,!((at&Rt|0)==0&((He()|0)&Z|0)==0)){pe=33;break e}if(j>>>0<re>>>0)j=j+1|0;else break}if(at=R,g[at>>2]=0,g[at+4>>2]=0,(fr|0)>(S|0)){for(at=w&-15728641,ot=fr;;){if(nt=ot,ot=ot+-1|0,ot>>>0>15|(fr|0)<(ot|0)){pe=19;break}if((fr|0)!=(ot|0))if(j=Jr(ot|0,0,52)|0,j=j|b,re=He()|0|at,(fr|0)<(nt|0))qe=j;else{pe=ot;do qe=Jr(7,0,(14-pe|0)*3|0)|0,pe=pe+1|0,j=qe|j,re=He()|0|re;while((pe|0)<(fr|0));qe=j}else qe=b,re=w;if(xe=Vr(qe|0,re|0,45)|0,He()|0,!(Fo(xe&127)|0))j=0;else{xe=Vr(qe|0,re|0,52)|0,He()|0,xe=xe&15;t:do if(!xe)j=0;else for(pe=1;;){if(j=Vr(qe|0,re|0,(15-pe|0)*3|0)|0,He()|0,j=j&7,j|0)break t;if(pe>>>0<xe>>>0)pe=pe+1|0;else{j=0;break}}while(!1);j=(j|0)==0&1}if(re=Vr(b|0,w|0,(15-nt|0)*3|0)|0,He()|0,re=re&7,(re|0)==7){O=5,pe=42;break}if(j=(j|0)!=0,(re|0)==1&j){O=5,pe=42;break}if(qe=re+(((re|0)!=0&j)<<31>>31)|0,qe|0&&(pe=fr-nt|0,pe=$i(7,0,pe,((pe|0)<0)<<31>>31)|0,xe=He()|0,j?(j=La(pe|0,xe|0,5,0)|0,j=qn(j|0,He()|0,-5,-1)|0,j=ks(j|0,He()|0,6,0)|0,j=qn(j|0,He()|0,1,0)|0,re=He()|0):(j=pe,re=xe),nt=qe+-1|0,nt=La(pe|0,xe|0,nt|0,((nt|0)<0)<<31>>31|0)|0,nt=qn(j|0,re|0,nt|0,He()|0)|0,qe=He()|0,xe=R,xe=qn(nt|0,qe|0,g[xe>>2]|0,g[xe+4>>2]|0)|0,qe=He()|0,nt=R,g[nt>>2]=xe,g[nt+4>>2]=qe),(ot|0)<=(S|0)){pe=37;break}}if((pe|0)==19)mn(27795,27122,1276,27158);else if((pe|0)==37){V=R,O=g[V+4>>2]|0,V=g[V>>2]|0;break}else if((pe|0)==42)return Fe=Qt,O|0}else O=0,V=0}else pe=33;while(!1);e:do if((pe|0)==33)if(at=R,g[at>>2]=0,g[at+4>>2]=0,(fr|0)>(S|0)){for(j=fr;;){if(O=Vr(b|0,w|0,(15-j|0)*3|0)|0,He()|0,O=O&7,(O|0)==7){O=5;break}if(V=fr-j|0,V=$i(7,0,V,((V|0)<0)<<31>>31)|0,O=La(V|0,He()|0,O|0,0)|0,V=He()|0,at=R,V=qn(g[at>>2]|0,g[at+4>>2]|0,O|0,V|0)|0,O=He()|0,at=R,g[at>>2]=V,g[at+4>>2]=O,j=j+-1|0,(j|0)<=(S|0))break e}return Fe=Qt,O|0}else O=0,V=0;while(!1);return cn(Rt,Z,fr,jt)|0&&mn(27795,27122,1236,27173),fr=jt,jt=g[fr+4>>2]|0,((O|0)>-1|(O|0)==-1&V>>>0>4294967295)&((jt|0)>(O|0)|((jt|0)==(O|0)?(g[fr>>2]|0)>>>0>V>>>0:0))?(fr=0,Fe=Qt,fr|0):(mn(27795,27122,1316,27158),0)}function Mc(b,w,S,R,O,j){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0,j=j|0;var V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0;if(qe=Fe,Fe=Fe+16|0,V=qe,O>>>0>15)return j=4,Fe=qe,j|0;if(Z=Vr(S|0,R|0,52)|0,He()|0,Z=Z&15,(Z|0)>(O|0))return j=12,Fe=qe,j|0;if(cn(S,R,O,V)|0&&mn(27795,27122,1236,27173),xe=V,pe=g[xe+4>>2]|0,!(((w|0)>-1|(w|0)==-1&b>>>0>4294967295)&((pe|0)>(w|0)|((pe|0)==(w|0)?(g[xe>>2]|0)>>>0>b>>>0:0))))return j=2,Fe=qe,j|0;xe=O-Z|0,O=Jr(O|0,0,52)|0,re=He()|0|R&-15728641,pe=j,g[pe>>2]=O|S,g[pe+4>>2]=re,pe=Vr(S|0,R|0,45)|0,He()|0;e:do if(Fo(pe&127)|0){if(Z|0)for(V=1;;){if(pe=Jr(7,0,(15-V|0)*3|0)|0,!((pe&S|0)==0&((He()|0)&R|0)==0))break e;if(V>>>0<Z>>>0)V=V+1|0;else break}if((xe|0)<1)return j=0,Fe=qe,j|0;for(pe=Z^15,R=-1,re=1,V=1;;){Z=xe-re|0,Z=$i(7,0,Z,((Z|0)<0)<<31>>31)|0,S=He()|0;do if(V)if(V=La(Z|0,S|0,5,0)|0,V=qn(V|0,He()|0,-5,-1)|0,V=ks(V|0,He()|0,6,0)|0,O=He()|0,(w|0)>(O|0)|(w|0)==(O|0)&b>>>0>V>>>0){w=qn(b|0,w|0,-1,-1)|0,w=Ro(w|0,He()|0,V|0,O|0)|0,V=He()|0,nt=j,at=g[nt>>2]|0,nt=g[nt+4>>2]|0,Rt=(pe+R|0)*3|0,ot=Jr(7,0,Rt|0)|0,nt=nt&~(He()|0),R=ks(w|0,V|0,Z|0,S|0)|0,b=He()|0,O=qn(R|0,b|0,2,0)|0,Rt=Jr(O|0,He()|0,Rt|0)|0,nt=He()|0|nt,O=j,g[O>>2]=Rt|at&~ot,g[O+4>>2]=nt,b=La(R|0,b|0,Z|0,S|0)|0,b=Ro(w|0,V|0,b|0,He()|0)|0,V=0,w=He()|0;break}else{Rt=j,ot=g[Rt>>2]|0,Rt=g[Rt+4>>2]|0,at=Jr(7,0,(pe+R|0)*3|0)|0,Rt=Rt&~(He()|0),V=j,g[V>>2]=ot&~at,g[V+4>>2]=Rt,V=1;break}else ot=j,O=g[ot>>2]|0,ot=g[ot+4>>2]|0,R=(pe+R|0)*3|0,nt=Jr(7,0,R|0)|0,ot=ot&~(He()|0),Rt=ks(b|0,w|0,Z|0,S|0)|0,V=He()|0,R=Jr(Rt|0,V|0,R|0)|0,ot=He()|0|ot,at=j,g[at>>2]=R|O&~nt,g[at+4>>2]=ot,V=La(Rt|0,V|0,Z|0,S|0)|0,b=Ro(b|0,w|0,V|0,He()|0)|0,V=0,w=He()|0;while(!1);if((xe|0)>(re|0))R=~re,re=re+1|0;else{w=0;break}}return Fe=qe,w|0}while(!1);if((xe|0)<1)return Rt=0,Fe=qe,Rt|0;for(O=Z^15,V=1;;)if(at=xe-V|0,at=$i(7,0,at,((at|0)<0)<<31>>31)|0,Rt=He()|0,re=j,S=g[re>>2]|0,re=g[re+4>>2]|0,Z=(O-V|0)*3|0,R=Jr(7,0,Z|0)|0,re=re&~(He()|0),nt=ks(b|0,w|0,at|0,Rt|0)|0,ot=He()|0,Z=Jr(nt|0,ot|0,Z|0)|0,re=He()|0|re,pe=j,g[pe>>2]=Z|S&~R,g[pe+4>>2]=re,Rt=La(nt|0,ot|0,at|0,Rt|0)|0,b=Ro(b|0,w|0,Rt|0,He()|0)|0,w=He()|0,(xe|0)<=(V|0)){w=0;break}else V=V+1|0;return Fe=qe,w|0}function Ic(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0;O=Vr(w|0,S|0,52)|0,He()|0,O=O&15,(w|0)==0&(S|0)==0|((R|0)>15|(O|0)>(R|0))?(j=-1,w=-1,S=0,O=0):(w=gn(w,S,O+1|0,R)|0,V=(He()|0)&-15728641,S=Jr(R|0,0,52)|0,S=w|S,V=V|(He()|0),w=(So(S,V)|0)==0,j=O,w=w?-1:R,O=V),V=b,g[V>>2]=S,g[V+4>>2]=O,g[b+8>>2]=j,g[b+12>>2]=w}function ih(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0;if(O=Vr(b|0,w|0,52)|0,He()|0,O=O&15,j=R+8|0,g[j>>2]=O,(b|0)==0&(w|0)==0|((S|0)>15|(O|0)>(S|0))){S=R,g[S>>2]=0,g[S+4>>2]=0,g[j>>2]=-1,g[R+12>>2]=-1;return}if(b=gn(b,w,O+1|0,S)|0,j=(He()|0)&-15728641,O=Jr(S|0,0,52)|0,O=b|O,j=j|(He()|0),b=R,g[b>>2]=O,g[b+4>>2]=j,b=R+12|0,So(O,j)|0){g[b>>2]=S;return}else{g[b>>2]=-1;return}}function oh(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0;if(S=b,w=g[S>>2]|0,S=g[S+4>>2]|0,!((w|0)==0&(S|0)==0)&&(R=Vr(w|0,S|0,52)|0,He()|0,R=R&15,Z=Jr(1,0,(R^15)*3|0)|0,w=qn(Z|0,He()|0,w|0,S|0)|0,S=He()|0,Z=b,g[Z>>2]=w,g[Z+4>>2]=S,Z=b+8|0,V=g[Z>>2]|0,!((R|0)<(V|0)))){for(re=b+12|0,j=R;;){if((j|0)==(V|0)){R=5;break}if(pe=(j|0)==(g[re>>2]|0),O=(15-j|0)*3|0,R=Vr(w|0,S|0,O|0)|0,He()|0,R=R&7,pe&((R|0)==1&!0)){R=7;break}if(!((R|0)==7&!0)){R=10;break}if(pe=Jr(1,0,O|0)|0,w=qn(w|0,S|0,pe|0,He()|0)|0,S=He()|0,pe=b,g[pe>>2]=w,g[pe+4>>2]=S,(j|0)>(V|0))j=j+-1|0;else{R=10;break}}if((R|0)==5){pe=b,g[pe>>2]=0,g[pe+4>>2]=0,g[Z>>2]=-1,g[re>>2]=-1;return}else if((R|0)==7){V=Jr(1,0,O|0)|0,V=qn(w|0,S|0,V|0,He()|0)|0,Z=He()|0,pe=b,g[pe>>2]=V,g[pe+4>>2]=Z,g[re>>2]=j+-1;return}else if((R|0)==10)return}}function Pc(b){b=+b;var w=0;return w=b<0?b+6.283185307179586:b,+(b>=6.283185307179586?w+-6.283185307179586:w)}function ah(b,w){return b=b|0,w=w|0,+Lt(+(+ce[b>>3]-+ce[w>>3]))<17453292519943298e-27?(w=+Lt(+(+ce[b+8>>3]-+ce[w+8>>3]))<17453292519943298e-27,w|0):(w=0,w|0)}function Ia(b,w){switch(b=+b,w=w|0,w|0){case 1:{b=b<0?b+6.283185307179586:b;break}case 2:{b=b>0?b+-6.283185307179586:b;break}}return+b}function Tl(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0;return O=+ce[w>>3],R=+ce[b>>3],j=+wr(+((O-R)*.5)),S=+wr(+((+ce[w+8>>3]-+ce[b+8>>3])*.5)),S=j*j+S*(+Dr(+O)*+Dr(+R)*S),+(+Fn(+ +kt(+S),+ +kt(+(1-S)))*2)}function Gh(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0;return O=+ce[w>>3],R=+ce[b>>3],j=+wr(+((O-R)*.5)),S=+wr(+((+ce[w+8>>3]-+ce[b+8>>3])*.5)),S=j*j+S*(+Dr(+O)*+Dr(+R)*S),+(+Fn(+ +kt(+S),+ +kt(+(1-S)))*2*6371.007180918475)}function tm(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0;return O=+ce[w>>3],R=+ce[b>>3],j=+wr(+((O-R)*.5)),S=+wr(+((+ce[w+8>>3]-+ce[b+8>>3])*.5)),S=j*j+S*(+Dr(+O)*+Dr(+R)*S),+(+Fn(+ +kt(+S),+ +kt(+(1-S)))*2*6371.007180918475*1e3)}function sA(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0;return j=+ce[w>>3],R=+Dr(+j),O=+ce[w+8>>3]-+ce[b+8>>3],V=R*+wr(+O),S=+ce[b>>3],+ +Fn(+V,+(+wr(+j)*+Dr(+S)-+Dr(+O)*(R*+wr(+S))))}function Hh(b,w,S,R){b=b|0,w=+w,S=+S,R=R|0;var O=0,j=0,V=0,Z=0;if(S<1e-16){g[R>>2]=g[b>>2],g[R+4>>2]=g[b+4>>2],g[R+8>>2]=g[b+8>>2],g[R+12>>2]=g[b+12>>2];return}j=w<0?w+6.283185307179586:w,j=w>=6.283185307179586?j+-6.283185307179586:j;do if(j<1e-16)w=+ce[b>>3]+S,ce[R>>3]=w,O=R;else{if(O=+Lt(+(j+-3.141592653589793))<1e-16,w=+ce[b>>3],O){w=w-S,ce[R>>3]=w,O=R;break}if(V=+Dr(+S),S=+wr(+S),w=V*+wr(+w)+ +Dr(+j)*(S*+Dr(+w)),w=w>1?1:w,w=+Yn(+(w<-1?-1:w)),ce[R>>3]=w,+Lt(+(w+-1.5707963267948966))<1e-16){ce[R>>3]=1.5707963267948966,ce[R+8>>3]=0;return}if(+Lt(+(w+1.5707963267948966))<1e-16){ce[R>>3]=-1.5707963267948966,ce[R+8>>3]=0;return}if(Z=1/+Dr(+w),j=S*+wr(+j)*Z,S=+ce[b>>3],w=Z*((V-+wr(+w)*+wr(+S))/+Dr(+S)),V=j>1?1:j,w=w>1?1:w,w=+ce[b+8>>3]+ +Fn(+(V<-1?-1:V),+(w<-1?-1:w)),w>3.141592653589793)do w=w+-6.283185307179586;while(w>3.141592653589793);if(w<-3.141592653589793)do w=w+6.283185307179586;while(w<-3.141592653589793);ce[R+8>>3]=w;return}while(!1);if(+Lt(+(w+-1.5707963267948966))<1e-16){ce[O>>3]=1.5707963267948966,ce[R+8>>3]=0;return}if(+Lt(+(w+1.5707963267948966))<1e-16){ce[O>>3]=-1.5707963267948966,ce[R+8>>3]=0;return}if(w=+ce[b+8>>3],w>3.141592653589793)do w=w+-6.283185307179586;while(w>3.141592653589793);if(w<-3.141592653589793)do w=w+6.283185307179586;while(w<-3.141592653589793);ce[R+8>>3]=w}function Lf(b,w){return b=b|0,w=w|0,b>>>0>15?(w=4,w|0):(ce[w>>3]=+ce[20656+(b<<3)>>3],w=0,w|0)}function lp(b,w){return b=b|0,w=w|0,b>>>0>15?(w=4,w|0):(ce[w>>3]=+ce[20784+(b<<3)>>3],w=0,w|0)}function cp(b,w){return b=b|0,w=w|0,b>>>0>15?(w=4,w|0):(ce[w>>3]=+ce[20912+(b<<3)>>3],w=0,w|0)}function sh(b,w){return b=b|0,w=w|0,b>>>0>15?(w=4,w|0):(ce[w>>3]=+ce[21040+(b<<3)>>3],w=0,w|0)}function es(b,w){b=b|0,w=w|0;var S=0;return b>>>0>15?(w=4,w|0):(S=$i(7,0,b,((b|0)<0)<<31>>31)|0,S=La(S|0,He()|0,120,0)|0,b=He()|0,g[w>>2]=S|2,g[w+4>>2]=b,w=0,w|0)}function Sd(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0;return nt=+ce[w>>3],xe=+ce[b>>3],re=+wr(+((nt-xe)*.5)),j=+ce[w+8>>3],pe=+ce[b+8>>3],V=+wr(+((j-pe)*.5)),Z=+Dr(+xe),qe=+Dr(+nt),V=re*re+V*(qe*Z*V),V=+Fn(+ +kt(+V),+ +kt(+(1-V)))*2,re=+ce[S>>3],nt=+wr(+((re-nt)*.5)),R=+ce[S+8>>3],j=+wr(+((R-j)*.5)),O=+Dr(+re),j=nt*nt+j*(qe*O*j),j=+Fn(+ +kt(+j),+ +kt(+(1-j)))*2,re=+wr(+((xe-re)*.5)),R=+wr(+((pe-R)*.5)),R=re*re+R*(Z*O*R),R=+Fn(+ +kt(+R),+ +kt(+(1-R)))*2,O=(V+j+R)*.5,+(+Ii(+ +kt(+(+zn(+(O*.5))*+zn(+((O-V)*.5))*+zn(+((O-j)*.5))*+zn(+((O-R)*.5)))))*4)}function xs(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0;if(Z=Fe,Fe=Fe+192|0,j=Z+168|0,V=Z,O=Sl(b,w,j)|0,O|0)return S=O,Fe=Z,S|0;if(vs(b,w,V)|0&&mn(27795,27190,415,27199),w=g[V>>2]|0,(w|0)>0){if(R=+Sd(V+8|0,V+8+(((w|0)!=1&1)<<4)|0,j)+0,(w|0)!=1){b=1;do O=b,b=b+1|0,R=R+ +Sd(V+8+(O<<4)|0,V+8+(((b|0)%(w|0)|0)<<4)|0,j);while((b|0)<(w|0))}}else R=0;return ce[S>>3]=R,S=0,Fe=Z,S|0}function Aa(b,w,S){return b=b|0,w=w|0,S=S|0,b=xs(b,w,S)|0,b|0||(ce[S>>3]=+ce[S>>3]*6371.007180918475*6371.007180918475),b|0}function yu(b,w,S){return b=b|0,w=w|0,S=S|0,b=xs(b,w,S)|0,b|0||(ce[S>>3]=+ce[S>>3]*6371.007180918475*6371.007180918475*1e3*1e3),b|0}function mr(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(Z=Fe,Fe=Fe+176|0,V=Z,b=op(b,w,V)|0,b|0)return V=b,Fe=Z,V|0;if(ce[S>>3]=0,b=g[V>>2]|0,(b|0)<=1)return V=0,Fe=Z,V|0;w=b+-1|0,b=0,R=+ce[V+8>>3],O=+ce[V+16>>3],j=0;do b=b+1|0,pe=R,R=+ce[V+8+(b<<4)>>3],xe=+wr(+((R-pe)*.5)),re=O,O=+ce[V+8+(b<<4)+8>>3],re=+wr(+((O-re)*.5)),re=xe*xe+re*(+Dr(+R)*+Dr(+pe)*re),j=j+ +Fn(+ +kt(+re),+ +kt(+(1-re)))*2;while((b|0)<(w|0));return ce[S>>3]=j,V=0,Fe=Z,V|0}function Bf(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(Z=Fe,Fe=Fe+176|0,V=Z,b=op(b,w,V)|0,b|0)return V=b,j=+ce[S>>3],j=j*6371.007180918475,ce[S>>3]=j,Fe=Z,V|0;if(ce[S>>3]=0,b=g[V>>2]|0,(b|0)<=1)return V=0,j=0,j=j*6371.007180918475,ce[S>>3]=j,Fe=Z,V|0;w=b+-1|0,b=0,R=+ce[V+8>>3],O=+ce[V+16>>3],j=0;do b=b+1|0,pe=R,R=+ce[V+8+(b<<4)>>3],xe=+wr(+((R-pe)*.5)),re=O,O=+ce[V+8+(b<<4)+8>>3],re=+wr(+((O-re)*.5)),re=xe*xe+re*(+Dr(+pe)*+Dr(+R)*re),j=j+ +Fn(+ +kt(+re),+ +kt(+(1-re)))*2;while((b|0)!=(w|0));return ce[S>>3]=j,V=0,xe=j,xe=xe*6371.007180918475,ce[S>>3]=xe,Fe=Z,V|0}function vu(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(Z=Fe,Fe=Fe+176|0,V=Z,b=op(b,w,V)|0,b|0)return V=b,j=+ce[S>>3],j=j*6371.007180918475,j=j*1e3,ce[S>>3]=j,Fe=Z,V|0;if(ce[S>>3]=0,b=g[V>>2]|0,(b|0)<=1)return V=0,j=0,j=j*6371.007180918475,j=j*1e3,ce[S>>3]=j,Fe=Z,V|0;w=b+-1|0,b=0,R=+ce[V+8>>3],O=+ce[V+16>>3],j=0;do b=b+1|0,pe=R,R=+ce[V+8+(b<<4)>>3],xe=+wr(+((R-pe)*.5)),re=O,O=+ce[V+8+(b<<4)+8>>3],re=+wr(+((O-re)*.5)),re=xe*xe+re*(+Dr(+pe)*+Dr(+R)*re),j=j+ +Fn(+ +kt(+re),+ +kt(+(1-re)))*2;while((b|0)!=(w|0));return ce[S>>3]=j,V=0,xe=j,xe=xe*6371.007180918475,xe=xe*1e3,ce[S>>3]=xe,Fe=Z,V|0}function lh(b){b=b|0;var w=0,S=0,R=0;return w=Pa(1,12)|0,w||mn(27280,27235,49,27293),S=b+4|0,R=g[S>>2]|0,R|0?(R=R+8|0,g[R>>2]=w,g[S>>2]=w,w|0):(g[b>>2]|0&&mn(27310,27235,61,27333),R=b,g[R>>2]=w,g[S>>2]=w,w|0)}function Rc(b,w){b=b|0,w=w|0;var S=0,R=0;return R=Bc(24)|0,R||mn(27347,27235,78,27361),g[R>>2]=g[w>>2],g[R+4>>2]=g[w+4>>2],g[R+8>>2]=g[w+8>>2],g[R+12>>2]=g[w+12>>2],g[R+16>>2]=0,w=b+4|0,S=g[w>>2]|0,S|0?(g[S+16>>2]=R,g[w>>2]=R,R|0):(g[b>>2]|0&&mn(27376,27235,82,27361),g[b>>2]=R,g[w>>2]=R,R|0)}function qh(b){b=b|0;var w=0,S=0,R=0,O=0;if(b)for(R=1;;){if(w=g[b>>2]|0,w|0)do{if(S=g[w>>2]|0,S|0)do O=S,S=g[S+16>>2]|0,xn(O);while((S|0)!=0);O=w,w=g[w+8>>2]|0,xn(O)}while((w|0)!=0);if(w=b,b=g[b+8>>2]|0,R||xn(w),b)R=0;else break}}function El(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0,ui=0,yi=0,ni=0,Tn=0,Wr=0,pi=0,hi=0,mi=0;if(O=b+8|0,g[O>>2]|0)return mi=1,mi|0;if(R=g[b>>2]|0,!R)return mi=0,mi|0;w=R,S=0;do S=S+1|0,w=g[w+8>>2]|0;while((w|0)!=0);if(S>>>0<2)return mi=0,mi|0;pi=Bc(S<<2)|0,pi||mn(27396,27235,317,27415),Wr=Bc(S<<5)|0,Wr||mn(27437,27235,321,27415),g[b>>2]=0,fn=b+4|0,g[fn>>2]=0,g[O>>2]=0,S=0,Tn=0,yr=0,qe=0;e:for(;;){if(xe=g[R>>2]|0,xe){j=0,V=xe;do{if(re=+ce[V+8>>3],w=V,V=g[V+16>>2]|0,pe=(V|0)==0,O=pe?xe:V,Z=+ce[O+8>>3],+Lt(+(re-Z))>3.141592653589793){mi=14;break}j=j+(Z-re)*(+ce[w>>3]+ +ce[O>>3])}while(!pe);if((mi|0)==14){mi=0,j=0,w=xe;do Dt=+ce[w+8>>3],ni=w+16|0,yi=g[ni>>2]|0,yi=(yi|0)==0?xe:yi,qt=+ce[yi+8>>3],j=j+(+ce[w>>3]+ +ce[yi>>3])*((qt<0?qt+6.283185307179586:qt)-(Dt<0?Dt+6.283185307179586:Dt)),w=g[((w|0)==0?R:ni)>>2]|0;while((w|0)!=0)}j>0?(g[pi+(Tn<<2)>>2]=R,Tn=Tn+1|0,O=yr,w=qe):mi=19}else mi=19;if((mi|0)==19){mi=0;do if(S){if(w=S+8|0,g[w>>2]|0){mi=21;break e}if(S=Pa(1,12)|0,!S){mi=23;break e}g[w>>2]=S,O=S+4|0,V=S,w=qe}else if(qe){O=fn,V=qe+8|0,w=R,S=b;break}else if(g[b>>2]|0){mi=27;break e}else{O=fn,V=b,w=R,S=b;break}while(!1);if(g[V>>2]=R,g[O>>2]=R,V=Wr+(yr<<5)|0,pe=g[R>>2]|0,pe){for(xe=Wr+(yr<<5)+8|0,ce[xe>>3]=17976931348623157e292,qe=Wr+(yr<<5)+24|0,ce[qe>>3]=17976931348623157e292,ce[V>>3]=-17976931348623157e292,nt=Wr+(yr<<5)+16|0,ce[nt>>3]=-17976931348623157e292,fr=17976931348623157e292,Qt=-17976931348623157e292,O=0,ot=pe,re=17976931348623157e292,Rt=17976931348623157e292,jt=-17976931348623157e292,Z=-17976931348623157e292;j=+ce[ot>>3],Dt=+ce[ot+8>>3],ot=g[ot+16>>2]|0,at=(ot|0)==0,qt=+ce[(at?pe:ot)+8>>3],j<re&&(ce[xe>>3]=j,re=j),Dt<Rt&&(ce[qe>>3]=Dt,Rt=Dt),j>jt?ce[V>>3]=j:j=jt,Dt>Z&&(ce[nt>>3]=Dt,Z=Dt),fr=Dt>0&Dt<fr?Dt:fr,Qt=Dt<0&Dt>Qt?Dt:Qt,O=O|+Lt(+(Dt-qt))>3.141592653589793,!at;)jt=j;O&&(ce[nt>>3]=Qt,ce[qe>>3]=fr)}else g[V>>2]=0,g[V+4>>2]=0,g[V+8>>2]=0,g[V+12>>2]=0,g[V+16>>2]=0,g[V+20>>2]=0,g[V+24>>2]=0,g[V+28>>2]=0;O=yr+1|0}if(ni=R+8|0,R=g[ni>>2]|0,g[ni>>2]=0,R)yr=O,qe=w;else{mi=45;break}}if((mi|0)==21)mn(27213,27235,35,27247);else if((mi|0)==23)mn(27267,27235,37,27247);else if((mi|0)==27)mn(27310,27235,61,27333);else if((mi|0)==45){e:do if((Tn|0)>0){for(ni=(O|0)==0,ui=O<<2,yi=(b|0)==0,ci=0,w=0;;){if(an=g[pi+(ci<<2)>>2]|0,ni)mi=73;else{if(yr=Bc(ui)|0,!yr){mi=50;break}if(fn=Bc(ui)|0,!fn){mi=52;break}t:do if(yi)S=0;else{for(O=0,S=0,V=b;R=Wr+(O<<5)|0,Dc(g[V>>2]|0,R,g[an>>2]|0)|0?(g[yr+(S<<2)>>2]=V,g[fn+(S<<2)>>2]=R,at=S+1|0):at=S,V=g[V+8>>2]|0,V;)O=O+1|0,S=at;if((at|0)>0)if(R=g[yr>>2]|0,(at|0)==1)S=R;else for(nt=0,ot=-1,S=R,qe=R;;){for(pe=g[qe>>2]|0,R=0,V=0;O=g[g[yr+(V<<2)>>2]>>2]|0,(O|0)==(pe|0)?xe=R:xe=R+((Dc(O,g[fn+(V<<2)>>2]|0,g[pe>>2]|0)|0)&1)|0,V=V+1|0,(V|0)!=(at|0);)R=xe;if(O=(xe|0)>(ot|0),S=O?qe:S,R=nt+1|0,(R|0)==(at|0))break t;nt=R,ot=O?xe:ot,qe=g[yr+(R<<2)>>2]|0}else S=0}while(!1);if(xn(yr),xn(fn),S){if(O=S+4|0,R=g[O>>2]|0,R)S=R+8|0;else if(g[S>>2]|0){mi=70;break}g[S>>2]=an,g[O>>2]=an}else mi=73}if((mi|0)==73){if(mi=0,w=g[an>>2]|0,w|0)do fn=w,w=g[w+16>>2]|0,xn(fn);while((w|0)!=0);xn(an),w=1}if(ci=ci+1|0,(ci|0)>=(Tn|0)){hi=w;break e}}(mi|0)==50?mn(27452,27235,249,27471):(mi|0)==52?mn(27490,27235,252,27471):(mi|0)==70&&mn(27310,27235,61,27333)}else hi=0;while(!1);return xn(pi),xn(Wr),mi=hi,mi|0}return 0}function Dc(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(!(lu(w,S)|0)||(w=Sc(w)|0,R=+ce[S>>3],O=+ce[S+8>>3],O=w&O<0?O+6.283185307179586:O,b=g[b>>2]|0,!b))return b=0,b|0;if(w){w=0,pe=O,S=b;e:for(;;){for(;V=+ce[S>>3],O=+ce[S+8>>3],S=S+16|0,xe=g[S>>2]|0,xe=(xe|0)==0?b:xe,j=+ce[xe>>3],Z=+ce[xe+8>>3],V>j?(re=V,V=Z):(re=j,j=V,V=O,O=Z),R=R==j|R==re?R+2220446049250313e-31:R,!!(R<j|R>re);)if(S=g[S>>2]|0,!S){S=22;break e}if(Z=V<0?V+6.283185307179586:V,V=O<0?O+6.283185307179586:O,pe=Z==pe|V==pe?pe+-2220446049250313e-31:pe,re=Z+(V-Z)*((R-j)/(re-j)),(re<0?re+6.283185307179586:re)>pe&&(w=w^1),S=g[S>>2]|0,!S){S=22;break}}if((S|0)==22)return w|0}else{w=0,pe=O,S=b;e:for(;;){for(;V=+ce[S>>3],O=+ce[S+8>>3],S=S+16|0,xe=g[S>>2]|0,xe=(xe|0)==0?b:xe,j=+ce[xe>>3],Z=+ce[xe+8>>3],V>j?(re=V,V=Z):(re=j,j=V,V=O,O=Z),R=R==j|R==re?R+2220446049250313e-31:R,!!(R<j|R>re);)if(S=g[S>>2]|0,!S){S=22;break e}if(pe=V==pe|O==pe?pe+-2220446049250313e-31:pe,V+(O-V)*((R-j)/(re-j))>pe&&(w=w^1),S=g[S>>2]|0,!S){S=22;break}}if((S|0)==22)return w|0}return 0}function Ga(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0;if(Qt=Fe,Fe=Fe+32|0,fr=Qt+16|0,jt=Qt,j=Vr(b|0,w|0,52)|0,He()|0,j=j&15,ot=Vr(S|0,R|0,52)|0,He()|0,(j|0)!=(ot&15|0))return fr=12,Fe=Qt,fr|0;if(pe=Vr(b|0,w|0,45)|0,He()|0,pe=pe&127,xe=Vr(S|0,R|0,45)|0,He()|0,xe=xe&127,pe>>>0>121|xe>>>0>121)return fr=5,Fe=Qt,fr|0;if(ot=(pe|0)!=(xe|0),ot){if(Z=su(pe,xe)|0,(Z|0)==7)return fr=1,Fe=Qt,fr|0;re=su(xe,pe)|0,(re|0)==7?mn(27514,27538,161,27548):(at=Z,V=re)}else at=0,V=0;qe=Fo(pe)|0,nt=Fo(xe)|0,g[fr>>2]=0,g[fr+4>>2]=0,g[fr+8>>2]=0,g[fr+12>>2]=0;do if(at){if(xe=g[4272+(pe*28|0)+(at<<2)>>2]|0,Z=(xe|0)>0,nt)if(Z){pe=0,re=S,Z=R;do re=Rs(re,Z)|0,Z=He()|0,V=$a(V)|0,(V|0)==1&&(V=$a(1)|0),pe=pe+1|0;while((pe|0)!=(xe|0));xe=V,pe=re,re=Z}else xe=V,pe=S,re=R;else if(Z){pe=0,re=S,Z=R;do re=Ec(re,Z)|0,Z=He()|0,V=$a(V)|0,pe=pe+1|0;while((pe|0)!=(xe|0));xe=V,pe=re,re=Z}else xe=V,pe=S,re=R;if(sp(pe,re,fr)|0,ot||mn(27563,27538,191,27548),Z=(qe|0)!=0,V=(nt|0)!=0,Z&V&&mn(27590,27538,192,27548),Z){if(V=Ki(b,w)|0,(V|0)==7){j=5;break}if(ze[22e3+(V*7|0)+at>>0]|0){j=1;break}re=g[21168+(V*28|0)+(at<<2)>>2]|0,pe=re}else if(V){if(V=Ki(pe,re)|0,(V|0)==7){j=5;break}if(ze[22e3+(V*7|0)+xe>>0]|0){j=1;break}pe=0,re=g[21168+(xe*28|0)+(V<<2)>>2]|0}else pe=0,re=0;if((pe|re|0)<0)j=5;else{if((re|0)>0){Z=fr+4|0,V=0;do hn(Z),V=V+1|0;while((V|0)!=(re|0))}if(g[jt>>2]=0,g[jt+4>>2]=0,g[jt+8>>2]=0,Jp(jt,at),j|0)for(;ua(j)|0?vi(jt):fu(jt),(j|0)>1;)j=j+-1|0;if((pe|0)>0){j=0;do hn(jt),j=j+1|0;while((j|0)!=(pe|0))}Rt=fr+4|0,ya(Rt,jt,Rt),Oa(Rt),Rt=51}}else if(sp(S,R,fr)|0,(qe|0)!=0&(nt|0)!=0)if((xe|0)!=(pe|0)&&mn(27621,27538,261,27548),V=Ki(b,w)|0,j=Ki(S,R)|0,(V|0)==7|(j|0)==7)j=5;else if(ze[22e3+(V*7|0)+j>>0]|0)j=1;else if(V=g[21168+(V*28|0)+(j<<2)>>2]|0,(V|0)>0){Z=fr+4|0,j=0;do hn(Z),j=j+1|0;while((j|0)!=(V|0));Rt=51}else Rt=51;else Rt=51;while(!1);return(Rt|0)==51&&(j=fr+4|0,g[O>>2]=g[j>>2],g[O+4>>2]=g[j+4>>2],g[O+8>>2]=g[j+8>>2],j=0),fr=j,Fe=Qt,fr|0}function Dn(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0;if(Rt=Fe,Fe=Fe+48|0,pe=Rt+36|0,V=Rt+24|0,Z=Rt+12|0,re=Rt,O=Vr(b|0,w|0,52)|0,He()|0,O=O&15,nt=Vr(b|0,w|0,45)|0,He()|0,nt=nt&127,nt>>>0>121)return R=5,Fe=Rt,R|0;if(xe=Fo(nt)|0,Jr(O|0,0,52)|0,jt=He()|0|134225919,j=R,g[j>>2]=-1,g[j+4>>2]=jt,!O)return O=Tc(S)|0,(O|0)==7||(O=zh(nt,O)|0,(O|0)==127)?(jt=1,Fe=Rt,jt|0):(ot=Jr(O|0,0,45)|0,at=He()|0,nt=R,at=g[nt+4>>2]&-1040385|at,jt=R,g[jt>>2]=g[nt>>2]|ot,g[jt+4>>2]=at,jt=0,Fe=Rt,jt|0);for(g[pe>>2]=g[S>>2],g[pe+4>>2]=g[S+4>>2],g[pe+8>>2]=g[S+8>>2],S=O;;){if(j=S,S=S+-1|0,g[V>>2]=g[pe>>2],g[V+4>>2]=g[pe+4>>2],g[V+8>>2]=g[pe+8>>2],ua(j)|0){if(O=wl(pe)|0,O|0){S=13;break}g[Z>>2]=g[pe>>2],g[Z+4>>2]=g[pe+4>>2],g[Z+8>>2]=g[pe+8>>2],vi(Z)}else{if(O=Kp(pe)|0,O|0){S=13;break}g[Z>>2]=g[pe>>2],g[Z+4>>2]=g[pe+4>>2],g[Z+8>>2]=g[pe+8>>2],fu(Z)}if(hu(V,Z,re),Oa(re),O=R,Qt=g[O>>2]|0,O=g[O+4>>2]|0,qt=(15-j|0)*3|0,fr=Jr(7,0,qt|0)|0,O=O&~(He()|0),qt=Jr(Tc(re)|0,0,qt|0)|0,O=He()|0|O,jt=R,g[jt>>2]=qt|Qt&~fr,g[jt+4>>2]=O,(j|0)<=1){S=14;break}}e:do if((S|0)!=13&&(S|0)==14)if((g[pe>>2]|0)<=1&&(g[pe+4>>2]|0)<=1&&(g[pe+8>>2]|0)<=1){S=Tc(pe)|0,O=zh(nt,S)|0,(O|0)==127?re=0:re=Fo(O)|0;t:do if(S){if(xe){if(O=Ki(b,w)|0,(O|0)==7){O=5;break e}if(j=g[21376+(O*28|0)+(S<<2)>>2]|0,(j|0)>0){O=S,S=0;do O=du(O)|0,S=S+1|0;while((S|0)!=(j|0))}else O=S;if((O|0)==1){O=9;break e}S=zh(nt,O)|0,(S|0)==127&&mn(27648,27538,411,27678),Fo(S)|0?mn(27693,27538,412,27678):(at=S,ot=j,qe=O)}else at=O,ot=0,qe=S;if(Z=g[4272+(nt*28|0)+(qe<<2)>>2]|0,(Z|0)<=-1&&mn(27724,27538,419,27678),!re){if((ot|0)<0){O=5;break e}if(ot|0){j=R,O=0,S=g[j>>2]|0,j=g[j+4>>2]|0;do S=Zs(S,j)|0,j=He()|0,qt=R,g[qt>>2]=S,g[qt+4>>2]=j,O=O+1|0;while((O|0)<(ot|0))}if((Z|0)<=0){O=at,S=58;break}for(j=R,O=0,S=g[j>>2]|0,j=g[j+4>>2]|0;;)if(S=Zs(S,j)|0,j=He()|0,qt=R,g[qt>>2]=S,g[qt+4>>2]=j,O=O+1|0,(O|0)==(Z|0)){O=at,S=58;break t}}if(V=su(at,nt)|0,(V|0)==7&&mn(27514,27538,428,27678),O=R,S=g[O>>2]|0,O=g[O+4>>2]|0,(Z|0)>0){j=0;do S=Zs(S,O)|0,O=He()|0,qt=R,g[qt>>2]=S,g[qt+4>>2]=O,j=j+1|0;while((j|0)!=(Z|0))}if(O=Ki(S,O)|0,(O|0)==7&&mn(27795,27538,440,27678),S=iu(at)|0,S=g[(S?21792:21584)+(V*28|0)+(O<<2)>>2]|0,(S|0)<0&&mn(27795,27538,454,27678),!S)O=at,S=58;else{V=R,O=0,j=g[V>>2]|0,V=g[V+4>>2]|0;do j=wd(j,V)|0,V=He()|0,qt=R,g[qt>>2]=j,g[qt+4>>2]=V,O=O+1|0;while((O|0)<(S|0));O=at,S=58}}else if((xe|0)!=0&(re|0)!=0){if(S=Ki(b,w)|0,j=R,j=Ki(g[j>>2]|0,g[j+4>>2]|0)|0,(S|0)==7|(j|0)==7){O=5;break e}if(j=g[21376+(S*28|0)+(j<<2)>>2]|0,(j|0)<0){O=5;break e}if(!j)S=59;else{Z=R,S=0,V=g[Z>>2]|0,Z=g[Z+4>>2]|0;do V=Zs(V,Z)|0,Z=He()|0,qt=R,g[qt>>2]=V,g[qt+4>>2]=Z,S=S+1|0;while((S|0)<(j|0));S=58}}else S=58;while(!1);if((S|0)==58&&re&&(S=59),(S|0)==59&&(qt=R,(Ki(g[qt>>2]|0,g[qt+4>>2]|0)|0)==1)){O=9;break}qt=R,fr=g[qt>>2]|0,qt=g[qt+4>>2]&-1040385,Qt=Jr(O|0,0,45)|0,qt=qt|(He()|0),O=R,g[O>>2]=fr|Qt,g[O+4>>2]=qt,O=0}else O=1;while(!1);return qt=O,Fe=Rt,qt|0}function ch(b,w,S,R,O,j){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0,j=j|0;var V=0,Z=0;return Z=Fe,Fe=Fe+16|0,V=Z,O?b=15:(b=Ga(b,w,S,R,V)|0,b||(Kr(V,j),b=0)),Fe=Z,b|0}function xu(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0;return V=Fe,Fe=Fe+16|0,j=V,R?S=15:(S=Di(S,j)|0,S||(S=Dn(b,w,j,O)|0)),Fe=V,S|0}function lA(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0;return re=Fe,Fe=Fe+32|0,V=re+12|0,Z=re,j=Ga(b,w,b,w,V)|0,j|0?(Z=j,Fe=re,Z|0):(b=Ga(b,w,S,R,Z)|0,b|0?(Z=b,Fe=re,Z|0):(V=ul(V,Z)|0,Z=O,g[Z>>2]=V,g[Z+4>>2]=((V|0)<0)<<31>>31,Z=0,Fe=re,Z|0))}function Wh(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0;return re=Fe,Fe=Fe+32|0,V=re+12|0,Z=re,j=Ga(b,w,b,w,V)|0,!j&&(j=Ga(b,w,S,R,Z)|0,!j)?(R=ul(V,Z)|0,R=qn(R|0,((R|0)<0)<<31>>31|0,1,0)|0,V=He()|0,Z=O,g[Z>>2]=R,g[Z+4>>2]=V,Z=0,Fe=re,Z|0):(Z=j,Fe=re,Z|0)}function Zh(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0;if(an=Fe,Fe=Fe+48|0,yr=an+24|0,V=an+12|0,fn=an,j=Ga(b,w,b,w,yr)|0,!j&&(j=Ga(b,w,S,R,V)|0,!j)){qt=ul(yr,V)|0,Dt=((qt|0)<0)<<31>>31,g[yr>>2]=0,g[yr+4>>2]=0,g[yr+8>>2]=0,g[V>>2]=0,g[V+4>>2]=0,g[V+8>>2]=0,Ga(b,w,b,w,yr)|0&&mn(27795,27538,692,27747),Ga(b,w,S,R,V)|0&&mn(27795,27538,697,27747),Oi(yr),Oi(V),xe=(qt|0)==0?0:1/+(qt|0),S=g[yr>>2]|0,Rt=xe*+((g[V>>2]|0)-S|0),jt=yr+4|0,R=g[jt>>2]|0,fr=xe*+((g[V+4>>2]|0)-R|0),Qt=yr+8|0,j=g[Qt>>2]|0,xe=xe*+((g[V+8>>2]|0)-j|0),g[fn>>2]=S,qe=fn+4|0,g[qe>>2]=R,nt=fn+8|0,g[nt>>2]=j;e:do if((qt|0)<0)j=0;else for(ot=0,at=0;;){re=+(at>>>0)+4294967296*+(ot|0),ci=Rt*re+ +(S|0),Z=fr*re+ +(R|0),re=xe*re+ +(j|0),S=~~+Ml(+ci),V=~~+Ml(+Z),j=~~+Ml(+re),ci=+Lt(+(+(S|0)-ci)),Z=+Lt(+(+(V|0)-Z)),re=+Lt(+(+(j|0)-re));do if(ci>Z&ci>re)S=0-(V+j)|0,R=V;else if(pe=0-S|0,Z>re){R=pe-j|0;break}else{R=V,j=pe-V|0;break}while(!1);if(g[fn>>2]=S,g[qe>>2]=R,g[nt>>2]=j,Ws(fn),j=Dn(b,w,fn,O+(at<<3)|0)|0,j|0)break e;if(!((ot|0)<(Dt|0)|(ot|0)==(Dt|0)&at>>>0<qt>>>0)){j=0;break e}S=qn(at|0,ot|0,1,0)|0,R=He()|0,ot=R,at=S,S=g[yr>>2]|0,R=g[jt>>2]|0,j=g[Qt>>2]|0}while(!1);return fn=j,Fe=an,fn|0}return fn=j,Fe=an,fn|0}function $i(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0;if((S|0)==0&(R|0)==0)return O=0,j=1,yn(O|0),j|0;j=b,O=w,b=1,w=0;do V=(S&1|0)==0&!0,b=La((V?1:j)|0,(V?0:O)|0,b|0,w|0)|0,w=He()|0,S=Cl(S|0,R|0,1)|0,R=He()|0,j=La(j|0,O|0,j|0,O|0)|0,O=He()|0;while(!((S|0)==0&(R|0)==0));return yn(w|0),b|0}function Ff(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;Z=Fe,Fe=Fe+16|0,j=Z,V=Vr(b|0,w|0,52)|0,He()|0,V=V&15;do if(V){if(O=Sl(b,w,j)|0,!O){pe=+ce[j>>3],re=1/+Dr(+pe),xe=+ce[25968+(V<<3)>>3],ce[S>>3]=pe+xe,ce[S+8>>3]=pe-xe,pe=+ce[j+8>>3],re=xe*re,ce[S+16>>3]=re+pe,ce[S+24>>3]=pe-re;break}return V=O,Fe=Z,V|0}else{if(O=Vr(b|0,w|0,45)|0,He()|0,O=O&127,O>>>0>121)return V=5,Fe=Z,V|0;j=22064+(O<<5)|0,g[S>>2]=g[j>>2],g[S+4>>2]=g[j+4>>2],g[S+8>>2]=g[j+8>>2],g[S+12>>2]=g[j+12>>2],g[S+16>>2]=g[j+16>>2],g[S+20>>2]=g[j+20>>2],g[S+24>>2]=g[j+24>>2],g[S+28>>2]=g[j+28>>2];break}while(!1);return md(S,R?1.4:1.1),R=26096+(V<<3)|0,(g[R>>2]|0)==(b|0)&&(g[R+4>>2]|0)==(w|0)&&(ce[S>>3]=1.5707963267948966),V=26224+(V<<3)|0,(g[V>>2]|0)==(b|0)&&(g[V+4>>2]|0)==(w|0)&&(ce[S+8>>3]=-1.5707963267948966),+ce[S>>3]!=1.5707963267948966&&+ce[S+8>>3]!=-1.5707963267948966?(V=0,Fe=Z,V|0):(ce[S+16>>3]=3.141592653589793,ce[S+24>>3]=-3.141592653589793,V=0,Fe=Z,V|0)}function uh(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;pe=Fe,Fe=Fe+48|0,V=pe+32|0,j=pe+40|0,Z=pe,Mr(V,0,0,0),re=g[V>>2]|0,V=g[V+4>>2]|0;do if(S>>>0<=15){if(O=Ds(R)|0,O|0){R=Z,g[R>>2]=0,g[R+4>>2]=0,g[Z+8>>2]=O,g[Z+12>>2]=-1,R=Z+16|0,re=Z+29|0,g[R>>2]=0,g[R+4>>2]=0,g[R+8>>2]=0,ze[R+12>>0]=0,ze[re>>0]=ze[j>>0]|0,ze[re+1>>0]=ze[j+1>>0]|0,ze[re+2>>0]=ze[j+2>>0]|0;break}if(O=Pa((g[w+8>>2]|0)+1|0,32)|0,O){lc(w,O),xe=Z,g[xe>>2]=re,g[xe+4>>2]=V,g[Z+8>>2]=0,g[Z+12>>2]=S,g[Z+16>>2]=R,g[Z+20>>2]=w,g[Z+24>>2]=O,ze[Z+28>>0]=0,re=Z+29|0,ze[re>>0]=ze[j>>0]|0,ze[re+1>>0]=ze[j+1>>0]|0,ze[re+2>>0]=ze[j+2>>0]|0;break}else{R=Z,g[R>>2]=0,g[R+4>>2]=0,g[Z+8>>2]=13,g[Z+12>>2]=-1,R=Z+16|0,re=Z+29|0,g[R>>2]=0,g[R+4>>2]=0,g[R+8>>2]=0,ze[R+12>>0]=0,ze[re>>0]=ze[j>>0]|0,ze[re+1>>0]=ze[j+1>>0]|0,ze[re+2>>0]=ze[j+2>>0]|0;break}}else re=Z,g[re>>2]=0,g[re+4>>2]=0,g[Z+8>>2]=4,g[Z+12>>2]=-1,re=Z+16|0,xe=Z+29|0,g[re>>2]=0,g[re+4>>2]=0,g[re+8>>2]=0,ze[re+12>>0]=0,ze[xe>>0]=ze[j>>0]|0,ze[xe+1>>0]=ze[j+1>>0]|0,ze[xe+2>>0]=ze[j+2>>0]|0;while(!1);bu(Z),g[b>>2]=g[Z>>2],g[b+4>>2]=g[Z+4>>2],g[b+8>>2]=g[Z+8>>2],g[b+12>>2]=g[Z+12>>2],g[b+16>>2]=g[Z+16>>2],g[b+20>>2]=g[Z+20>>2],g[b+24>>2]=g[Z+24>>2],g[b+28>>2]=g[Z+28>>2],Fe=pe}function bu(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0;if(Dt=Fe,Fe=Fe+336|0,ot=Dt+168|0,at=Dt,R=b,S=g[R>>2]|0,R=g[R+4>>2]|0,(S|0)==0&(R|0)==0){Fe=Dt;return}if(w=b+28|0,ze[w>>0]|0?(S=Td(S,R)|0,R=He()|0):ze[w>>0]=1,qt=b+20|0,!(g[g[qt>>2]>>2]|0)){w=b+24|0,S=g[w>>2]|0,S|0&&xn(S),Qt=b,g[Qt>>2]=0,g[Qt+4>>2]=0,g[b+8>>2]=0,g[qt>>2]=0,g[b+12>>2]=-1,g[b+16>>2]=0,g[w>>2]=0,Fe=Dt;return}Qt=b+16|0,w=g[Qt>>2]|0,O=w&15;e:do if((S|0)==0&(R|0)==0)fr=b+24|0;else{Rt=b+12|0,qe=(O|0)==3,xe=w&255,re=(O|1|0)==3,nt=b+24|0,pe=(O+-1|0)>>>0<3,V=(O|2|0)==3,Z=at+8|0;t:for(;;){if(j=Vr(S|0,R|0,52)|0,He()|0,j=j&15,(j|0)==(g[Rt>>2]|0)){switch(xe&15){case 0:case 2:case 3:{if(O=Sl(S,R,ot)|0,O|0){jt=15;break t}if(Oc(g[qt>>2]|0,g[nt>>2]|0,ot)|0){jt=19;break t}break}}if(re&&(O=g[(g[qt>>2]|0)+4>>2]|0,g[ot>>2]=g[O>>2],g[ot+4>>2]=g[O+4>>2],g[ot+8>>2]=g[O+8>>2],g[ot+12>>2]=g[O+12>>2],lu(26832,ot)|0)){if(sc(g[(g[qt>>2]|0)+4>>2]|0,j,at)|0){jt=25;break}if(O=at,(g[O>>2]|0)==(S|0)&&(g[O+4>>2]|0)==(R|0)){jt=29;break}}if(pe){if(O=vs(S,R,ot)|0,O|0){jt=32;break}if(Ff(S,R,at,0)|0){jt=36;break}if(V&&Ed(g[qt>>2]|0,g[nt>>2]|0,ot,at)|0){jt=42;break}if(re&&Nf(g[qt>>2]|0,g[nt>>2]|0,ot,at)|0){jt=42;break}}if(qe){if(w=Ff(S,R,ot,1)|0,O=g[nt>>2]|0,w|0){jt=45;break}if(oc(O,ot)|0){if(Of(at,ot),uu(ot,g[nt>>2]|0)|0){jt=53;break}if(Oc(g[qt>>2]|0,g[nt>>2]|0,Z)|0){jt=53;break}if(Nf(g[qt>>2]|0,g[nt>>2]|0,at,ot)|0){jt=53;break}}}}do if((j|0)<(g[Rt>>2]|0)){if(w=Ff(S,R,ot,1)|0,O=g[nt>>2]|0,w|0){jt=58;break t}if(!(oc(O,ot)|0)){jt=73;break}if(uu(g[nt>>2]|0,ot)|0&&(Of(at,ot),Ed(g[qt>>2]|0,g[nt>>2]|0,at,ot)|0)){jt=65;break t}if(S=xd(S,R,j+1|0,at)|0,S|0){jt=67;break t}R=at,S=g[R>>2]|0,R=g[R+4>>2]|0}else jt=73;while(!1);if((jt|0)==73&&(jt=0,S=Td(S,R)|0,R=He()|0),(S|0)==0&(R|0)==0){fr=nt;break e}}switch(jt|0){case 15:{w=g[nt>>2]|0,w|0&&xn(w),jt=b,g[jt>>2]=0,g[jt+4>>2]=0,g[qt>>2]=0,g[Rt>>2]=-1,g[Qt>>2]=0,g[nt>>2]=0,g[b+8>>2]=O,jt=20;break}case 19:{g[b>>2]=S,g[b+4>>2]=R,jt=20;break}case 25:{mn(27795,27761,470,27772);break}case 29:{g[b>>2]=S,g[b+4>>2]=R,Fe=Dt;return}case 32:{w=g[nt>>2]|0,w|0&&xn(w),fr=b,g[fr>>2]=0,g[fr+4>>2]=0,g[qt>>2]=0,g[Rt>>2]=-1,g[Qt>>2]=0,g[nt>>2]=0,g[b+8>>2]=O,Fe=Dt;return}case 36:{mn(27795,27761,493,27772);break}case 42:{g[b>>2]=S,g[b+4>>2]=R,Fe=Dt;return}case 45:{O|0&&xn(O),jt=b,g[jt>>2]=0,g[jt+4>>2]=0,g[qt>>2]=0,g[Rt>>2]=-1,g[Qt>>2]=0,g[nt>>2]=0,g[b+8>>2]=w,jt=55;break}case 53:{g[b>>2]=S,g[b+4>>2]=R,jt=55;break}case 58:{O|0&&xn(O),jt=b,g[jt>>2]=0,g[jt+4>>2]=0,g[qt>>2]=0,g[Rt>>2]=-1,g[Qt>>2]=0,g[nt>>2]=0,g[b+8>>2]=w,jt=71;break}case 65:{g[b>>2]=S,g[b+4>>2]=R,jt=71;break}case 67:{w=g[nt>>2]|0,w|0&&xn(w),fr=b,g[fr>>2]=0,g[fr+4>>2]=0,g[qt>>2]=0,g[Rt>>2]=-1,g[Qt>>2]=0,g[nt>>2]=0,g[b+8>>2]=S,Fe=Dt;return}}if((jt|0)==20){Fe=Dt;return}else if((jt|0)==55){Fe=Dt;return}else if((jt|0)==71){Fe=Dt;return}}while(!1);w=g[fr>>2]|0,w|0&&xn(w),jt=b,g[jt>>2]=0,g[jt+4>>2]=0,g[b+8>>2]=0,g[qt>>2]=0,g[b+12>>2]=-1,g[Qt>>2]=0,g[fr>>2]=0,Fe=Dt}function Td(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0;qe=Fe,Fe=Fe+16|0,xe=qe,R=Vr(b|0,w|0,52)|0,He()|0,R=R&15,S=Vr(b|0,w|0,45)|0,He()|0;do if(R){for(;S=Jr(R+4095|0,0,52)|0,O=He()|0|w&-15728641,j=(15-R|0)*3|0,V=Jr(7,0,j|0)|0,Z=He()|0,S=S|b|V,O=O|Z,re=Vr(b|0,w|0,j|0)|0,He()|0,re=re&7,R=R+-1|0,!(re>>>0<6);)if(R)w=O,b=S;else{pe=4;break}if((pe|0)==4){S=Vr(S|0,O|0,45)|0,He()|0;break}return xe=(re|0)==0&(So(S,O)|0)!=0,xe=Jr((xe?2:1)+re|0,0,j|0)|0,pe=He()|0|w&~Z,xe=xe|b&~V,yn(pe|0),Fe=qe,xe|0}while(!1);return S=S&127,S>>>0>120?(pe=0,xe=0,yn(pe|0),Fe=qe,xe|0):(Mr(xe,0,S+1|0,0),pe=g[xe+4>>2]|0,xe=g[xe>>2]|0,yn(pe|0),Fe=qe,xe|0)}function up(b,w,S,R,O,j){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0,j=j|0;var V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0;jt=Fe,Fe=Fe+160|0,qe=jt+80|0,Z=jt+64|0,nt=jt+112|0,Rt=jt,uh(qe,b,w,S),pe=qe,Ic(Z,g[pe>>2]|0,g[pe+4>>2]|0,w),pe=Z,re=g[pe>>2]|0,pe=g[pe+4>>2]|0,V=g[qe+8>>2]|0,ot=nt+4|0,g[ot>>2]=g[qe>>2],g[ot+4>>2]=g[qe+4>>2],g[ot+8>>2]=g[qe+8>>2],g[ot+12>>2]=g[qe+12>>2],g[ot+16>>2]=g[qe+16>>2],g[ot+20>>2]=g[qe+20>>2],g[ot+24>>2]=g[qe+24>>2],g[ot+28>>2]=g[qe+28>>2],ot=Rt,g[ot>>2]=re,g[ot+4>>2]=pe,ot=Rt+8|0,g[ot>>2]=V,b=Rt+12|0,w=nt,S=b+36|0;do g[b>>2]=g[w>>2],b=b+4|0,w=w+4|0;while((b|0)<(S|0));if(nt=Rt+48|0,g[nt>>2]=g[Z>>2],g[nt+4>>2]=g[Z+4>>2],g[nt+8>>2]=g[Z+8>>2],g[nt+12>>2]=g[Z+12>>2],(re|0)==0&(pe|0)==0)return Rt=V,Fe=jt,Rt|0;S=Rt+16|0,xe=Rt+24|0,qe=Rt+28|0,V=0,Z=0,w=re,b=pe;do{if(!((V|0)<(O|0)|(V|0)==(O|0)&Z>>>0<R>>>0)){at=4;break}if(pe=Z,Z=qn(Z|0,V|0,1,0)|0,V=He()|0,pe=j+(pe<<3)|0,g[pe>>2]=w,g[pe+4>>2]=b,oh(nt),b=nt,w=g[b>>2]|0,b=g[b+4>>2]|0,(w|0)==0&(b|0)==0){if(bu(S),w=S,b=g[w>>2]|0,w=g[w+4>>2]|0,(b|0)==0&(w|0)==0){at=10;break}ih(b,w,g[qe>>2]|0,nt),b=nt,w=g[b>>2]|0,b=g[b+4>>2]|0}pe=Rt,g[pe>>2]=w,g[pe+4>>2]=b}while(!((w|0)==0&(b|0)==0));return(at|0)==4?(b=Rt+40|0,w=g[b>>2]|0,w|0&&xn(w),at=Rt+16|0,g[at>>2]=0,g[at+4>>2]=0,g[xe>>2]=0,g[Rt+36>>2]=0,g[qe>>2]=-1,g[Rt+32>>2]=0,g[b>>2]=0,ih(0,0,0,nt),g[Rt>>2]=0,g[Rt+4>>2]=0,g[ot>>2]=0,Rt=14,Fe=jt,Rt|0):((at|0)==10&&(g[Rt>>2]=0,g[Rt+4>>2]=0,g[ot>>2]=g[xe>>2]),Rt=g[ot>>2]|0,Fe=jt,Rt|0)}function Hl(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0;if(qe=Fe,Fe=Fe+48|0,re=qe+32|0,Z=qe+40|0,pe=qe,!(g[b>>2]|0))return xe=R,g[xe>>2]=0,g[xe+4>>2]=0,xe=0,Fe=qe,xe|0;Mr(re,0,0,0),V=re,O=g[V>>2]|0,V=g[V+4>>2]|0;do if(w>>>0>15)xe=pe,g[xe>>2]=0,g[xe+4>>2]=0,g[pe+8>>2]=4,g[pe+12>>2]=-1,xe=pe+16|0,S=pe+29|0,g[xe>>2]=0,g[xe+4>>2]=0,g[xe+8>>2]=0,ze[xe+12>>0]=0,ze[S>>0]=ze[Z>>0]|0,ze[S+1>>0]=ze[Z+1>>0]|0,ze[S+2>>0]=ze[Z+2>>0]|0,S=4,xe=9;else{if(S=Ds(S)|0,S|0){re=pe,g[re>>2]=0,g[re+4>>2]=0,g[pe+8>>2]=S,g[pe+12>>2]=-1,re=pe+16|0,xe=pe+29|0,g[re>>2]=0,g[re+4>>2]=0,g[re+8>>2]=0,ze[re+12>>0]=0,ze[xe>>0]=ze[Z>>0]|0,ze[xe+1>>0]=ze[Z+1>>0]|0,ze[xe+2>>0]=ze[Z+2>>0]|0,xe=9;break}if(S=Pa((g[b+8>>2]|0)+1|0,32)|0,!S){xe=pe,g[xe>>2]=0,g[xe+4>>2]=0,g[pe+8>>2]=13,g[pe+12>>2]=-1,xe=pe+16|0,S=pe+29|0,g[xe>>2]=0,g[xe+4>>2]=0,g[xe+8>>2]=0,ze[xe+12>>0]=0,ze[S>>0]=ze[Z>>0]|0,ze[S+1>>0]=ze[Z+1>>0]|0,ze[S+2>>0]=ze[Z+2>>0]|0,S=13,xe=9;break}lc(b,S),ot=pe,g[ot>>2]=O,g[ot+4>>2]=V,V=pe+8|0,g[V>>2]=0,g[pe+12>>2]=w,g[pe+20>>2]=b,g[pe+24>>2]=S,ze[pe+28>>0]=0,O=pe+29|0,ze[O>>0]=ze[Z>>0]|0,ze[O+1>>0]=ze[Z+1>>0]|0,ze[O+2>>0]=ze[Z+2>>0]|0,g[pe+16>>2]=3,nt=+rp(S),nt=nt*+wc(S),j=+Lt(+ +ce[S>>3]),j=nt/+Dr(+ +ef(+j,+ +Lt(+ +ce[S+8>>3])))*6371.007180918475*6371.007180918475,O=pe+12|0,S=g[O>>2]|0;e:do if((S|0)>0)do{if(Lf(S+-1|0,re)|0,!(j/+ce[re>>3]>10))break e;ot=g[O>>2]|0,S=ot+-1|0,g[O>>2]=S}while((ot|0)>1);while(!1);if(bu(pe),O=R,g[O>>2]=0,g[O+4>>2]=0,O=pe,S=g[O>>2]|0,O=g[O+4>>2]|0,!((S|0)==0&(O|0)==0))do cn(S,O,w,re)|0,Z=re,b=R,Z=qn(g[b>>2]|0,g[b+4>>2]|0,g[Z>>2]|0,g[Z+4>>2]|0)|0,b=He()|0,ot=R,g[ot>>2]=Z,g[ot+4>>2]=b,bu(pe),ot=pe,S=g[ot>>2]|0,O=g[ot+4>>2]|0;while(!((S|0)==0&(O|0)==0));S=g[V>>2]|0}while(!1);return ot=S,Fe=qe,ot|0}function bs(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0;if(!(lu(w,S)|0)||(w=Sc(w)|0,R=+ce[S>>3],O=+ce[S+8>>3],O=w&O<0?O+6.283185307179586:O,nt=g[b>>2]|0,(nt|0)<=0))return nt=0,nt|0;if(qe=g[b+4>>2]|0,w){w=0,xe=O,S=-1,b=0;e:for(;;){for(pe=b;V=+ce[qe+(pe<<4)>>3],O=+ce[qe+(pe<<4)+8>>3],b=(S+2|0)%(nt|0)|0,j=+ce[qe+(b<<4)>>3],Z=+ce[qe+(b<<4)+8>>3],V>j?(re=V,V=Z):(re=j,j=V,V=O,O=Z),R=R==j|R==re?R+2220446049250313e-31:R,!!(R<j|R>re);)if(S=pe+1|0,(S|0)>=(nt|0)){S=22;break e}else b=pe,pe=S,S=b;if(Z=V<0?V+6.283185307179586:V,V=O<0?O+6.283185307179586:O,xe=Z==xe|V==xe?xe+-2220446049250313e-31:xe,re=Z+(V-Z)*((R-j)/(re-j)),(re<0?re+6.283185307179586:re)>xe&&(w=w^1),b=pe+1|0,(b|0)>=(nt|0)){S=22;break}else S=pe}if((S|0)==22)return w|0}else{w=0,xe=O,S=-1,b=0;e:for(;;){for(pe=b;V=+ce[qe+(pe<<4)>>3],O=+ce[qe+(pe<<4)+8>>3],b=(S+2|0)%(nt|0)|0,j=+ce[qe+(b<<4)>>3],Z=+ce[qe+(b<<4)+8>>3],V>j?(re=V,V=Z):(re=j,j=V,V=O,O=Z),R=R==j|R==re?R+2220446049250313e-31:R,!!(R<j|R>re);)if(S=pe+1|0,(S|0)>=(nt|0)){S=22;break e}else b=pe,pe=S,S=b;if(xe=V==xe|O==xe?xe+-2220446049250313e-31:xe,V+(O-V)*((R-j)/(re-j))>xe&&(w=w^1),b=pe+1|0,(b|0)>=(nt|0)){S=22;break}else S=pe}if((S|0)==22)return w|0}return 0}function hh(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0;if(at=g[b>>2]|0,!at){g[w>>2]=0,g[w+4>>2]=0,g[w+8>>2]=0,g[w+12>>2]=0,g[w+16>>2]=0,g[w+20>>2]=0,g[w+24>>2]=0,g[w+28>>2]=0;return}if(Rt=w+8|0,ce[Rt>>3]=17976931348623157e292,jt=w+24|0,ce[jt>>3]=17976931348623157e292,ce[w>>3]=-17976931348623157e292,fr=w+16|0,ce[fr>>3]=-17976931348623157e292,!((at|0)<=0)){for(nt=g[b+4>>2]|0,pe=17976931348623157e292,xe=-17976931348623157e292,qe=0,b=-1,j=17976931348623157e292,V=17976931348623157e292,re=-17976931348623157e292,R=-17976931348623157e292,ot=0;S=+ce[nt+(ot<<4)>>3],Z=+ce[nt+(ot<<4)+8>>3],b=b+2|0,O=+ce[nt+(((b|0)==(at|0)?0:b)<<4)+8>>3],S<j&&(ce[Rt>>3]=S,j=S),Z<V&&(ce[jt>>3]=Z,V=Z),S>re?ce[w>>3]=S:S=re,Z>R&&(ce[fr>>3]=Z,R=Z),pe=Z>0&Z<pe?Z:pe,xe=Z<0&Z>xe?Z:xe,qe=qe|+Lt(+(Z-O))>3.141592653589793,b=ot+1|0,(b|0)!=(at|0);)Qt=ot,re=S,ot=b,b=Qt;qe&&(ce[fr>>3]=xe,ce[jt>>3]=pe)}}function Ds(b){return b=b|0,(b>>>0<4?0:15)|0}function lc(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0;if(at=g[b>>2]|0,at){if(Rt=w+8|0,ce[Rt>>3]=17976931348623157e292,jt=w+24|0,ce[jt>>3]=17976931348623157e292,ce[w>>3]=-17976931348623157e292,fr=w+16|0,ce[fr>>3]=-17976931348623157e292,(at|0)>0){for(O=g[b+4>>2]|0,nt=17976931348623157e292,ot=-17976931348623157e292,R=0,S=-1,re=17976931348623157e292,pe=17976931348623157e292,qe=-17976931348623157e292,V=-17976931348623157e292,Qt=0;j=+ce[O+(Qt<<4)>>3],xe=+ce[O+(Qt<<4)+8>>3],fn=S+2|0,Z=+ce[O+(((fn|0)==(at|0)?0:fn)<<4)+8>>3],j<re&&(ce[Rt>>3]=j,re=j),xe<pe&&(ce[jt>>3]=xe,pe=xe),j>qe?ce[w>>3]=j:j=qe,xe>V&&(ce[fr>>3]=xe,V=xe),nt=xe>0&xe<nt?xe:nt,ot=xe<0&xe>ot?xe:ot,R=R|+Lt(+(xe-Z))>3.141592653589793,S=Qt+1|0,(S|0)!=(at|0);)fn=Qt,qe=j,Qt=S,S=fn;R&&(ce[fr>>3]=ot,ce[jt>>3]=nt)}}else g[w>>2]=0,g[w+4>>2]=0,g[w+8>>2]=0,g[w+12>>2]=0,g[w+16>>2]=0,g[w+20>>2]=0,g[w+24>>2]=0,g[w+28>>2]=0;if(fn=b+8|0,S=g[fn>>2]|0,!((S|0)<=0)){yr=b+12|0,Dt=0;do if(O=g[yr>>2]|0,R=Dt,Dt=Dt+1|0,jt=w+(Dt<<5)|0,fr=g[O+(R<<3)>>2]|0,fr){if(Qt=w+(Dt<<5)+8|0,ce[Qt>>3]=17976931348623157e292,b=w+(Dt<<5)+24|0,ce[b>>3]=17976931348623157e292,ce[jt>>3]=-17976931348623157e292,qt=w+(Dt<<5)+16|0,ce[qt>>3]=-17976931348623157e292,(fr|0)>0){for(at=g[O+(R<<3)+4>>2]|0,nt=17976931348623157e292,ot=-17976931348623157e292,O=0,R=-1,Rt=0,re=17976931348623157e292,pe=17976931348623157e292,xe=-17976931348623157e292,V=-17976931348623157e292;j=+ce[at+(Rt<<4)>>3],qe=+ce[at+(Rt<<4)+8>>3],R=R+2|0,Z=+ce[at+(((R|0)==(fr|0)?0:R)<<4)+8>>3],j<re&&(ce[Qt>>3]=j,re=j),qe<pe&&(ce[b>>3]=qe,pe=qe),j>xe?ce[jt>>3]=j:j=xe,qe>V&&(ce[qt>>3]=qe,V=qe),nt=qe>0&qe<nt?qe:nt,ot=qe<0&qe>ot?qe:ot,O=O|+Lt(+(qe-Z))>3.141592653589793,R=Rt+1|0,(R|0)!=(fr|0);)an=Rt,Rt=R,xe=j,R=an;O&&(ce[qt>>3]=ot,ce[b>>3]=nt)}}else g[jt>>2]=0,g[jt+4>>2]=0,g[jt+8>>2]=0,g[jt+12>>2]=0,g[jt+16>>2]=0,g[jt+20>>2]=0,g[jt+24>>2]=0,g[jt+28>>2]=0,S=g[fn>>2]|0;while((Dt|0)<(S|0))}}function Oc(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;if(!(bs(b,w,S)|0))return O=0,O|0;if(O=b+8|0,(g[O>>2]|0)<=0)return O=1,O|0;for(R=b+12|0,b=0;;){if(j=b,b=b+1|0,bs((g[R>>2]|0)+(j<<3)|0,w+(b<<5)|0,S)|0){b=0,R=6;break}if((b|0)>=(g[O>>2]|0)){b=1,R=6;break}}return(R|0)==6?b|0:0}function Ed(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0;if(pe=Fe,Fe=Fe+16|0,Z=pe,V=S+8|0,!(bs(b,w,V)|0))return re=0,Fe=pe,re|0;re=b+8|0;e:do if((g[re>>2]|0)>0){for(j=b+12|0,O=0;;){if(xe=O,O=O+1|0,bs((g[j>>2]|0)+(xe<<3)|0,w+(O<<5)|0,V)|0){O=0;break}if((O|0)>=(g[re>>2]|0))break e}return Fe=pe,O|0}while(!1);if(wu(b,w,S,R)|0)return xe=0,Fe=pe,xe|0;g[Z>>2]=g[S>>2],g[Z+4>>2]=V,O=g[re>>2]|0;e:do if((O|0)>0)for(b=b+12|0,V=0,j=O;;){if(O=g[b>>2]|0,(g[O+(V<<3)>>2]|0)>0){if(bs(Z,R,g[O+(V<<3)+4>>2]|0)|0){O=0;break e}if(O=V+1|0,wu((g[b>>2]|0)+(V<<3)|0,w+(O<<5)|0,S,R)|0){O=0;break e}j=g[re>>2]|0}else O=V+1|0;if((O|0)<(j|0))V=O;else{O=1;break}}else O=1;while(!1);return xe=O,Fe=pe,xe|0}function wu(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0,fn=0,an=0,ci=0;if(fn=Fe,Fe=Fe+176|0,Qt=fn+172|0,O=fn+168|0,qt=fn,!(oc(w,R)|0))return b=0,Fe=fn,b|0;if(cu(w,R,Qt,O),dh(qt|0,S|0,168)|0,(g[S>>2]|0)>0){w=0;do an=qt+8+(w<<4)+8|0,fr=+Ia(+ce[an>>3],g[O>>2]|0),ce[an>>3]=fr,w=w+1|0;while((w|0)<(g[S>>2]|0))}Rt=+ce[R>>3],jt=+ce[R+8>>3],fr=+Ia(+ce[R+16>>3],g[O>>2]|0),ot=+Ia(+ce[R+24>>3],g[O>>2]|0);e:do if((g[b>>2]|0)>0){if(R=b+4|0,O=g[qt>>2]|0,(O|0)<=0){for(w=0;;)if(w=w+1|0,(w|0)>=(g[b>>2]|0)){w=0;break e}}for(S=0;;){if(w=g[R>>2]|0,nt=+ce[w+(S<<4)>>3],at=+Ia(+ce[w+(S<<4)+8>>3],g[Qt>>2]|0),w=g[R>>2]|0,S=S+1|0,an=(S|0)%(g[b>>2]|0)|0,j=+ce[w+(an<<4)>>3],V=+Ia(+ce[w+(an<<4)+8>>3],g[Qt>>2]|0),!(nt>=Rt)|!(j>=Rt)&&!(nt<=jt)|!(j<=jt)&&!(at<=ot)|!(V<=ot)&&!(at>=fr)|!(V>=fr)){qe=j-nt,pe=V-at,w=0;do if(ci=w,w=w+1|0,an=(w|0)==(O|0)?0:w,j=+ce[qt+8+(ci<<4)+8>>3],V=+ce[qt+8+(an<<4)+8>>3]-j,Z=+ce[qt+8+(ci<<4)>>3],re=+ce[qt+8+(an<<4)>>3]-Z,xe=qe*V-pe*re,xe!=0&&(Dt=at-j,yr=nt-Z,re=(Dt*re-V*yr)/xe,!(re<0|re>1))&&(xe=(qe*Dt-pe*yr)/xe,xe>=0&xe<=1)){w=1;break e}while((w|0)<(O|0))}if((S|0)>=(g[b>>2]|0)){w=0;break}}}else w=0;while(!1);return ci=w,Fe=fn,ci|0}function Nf(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0;if(wu(b,w,S,R)|0)return j=1,j|0;if(j=b+8|0,(g[j>>2]|0)<=0)return j=0,j|0;for(O=b+12|0,b=0;;){if(V=b,b=b+1|0,wu((g[O>>2]|0)+(V<<3)|0,w+(b<<5)|0,S,R)|0){b=1,O=6;break}if((b|0)>=(g[j>>2]|0)){b=0,O=6;break}}return(O|0)==6?b|0:0}function ka(){return 8}function Jo(){return 16}function To(){return 168}function kc(){return 8}function Xs(){return 16}function hp(){return 12}function Su(){return 8}function rm(b){return b=b|0,+(+((g[b>>2]|0)>>>0)+4294967296*+(g[b+4>>2]|0))}function Xh(b){b=b|0;var w=0,S=0;return S=+ce[b>>3],w=+ce[b+8>>3],+ +kt(+(S*S+w*w))}function Tu(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0;pe=+ce[b>>3],re=+ce[w>>3]-pe,Z=+ce[b+8>>3],V=+ce[w+8>>3]-Z,qe=+ce[S>>3],j=+ce[R>>3]-qe,nt=+ce[S+8>>3],xe=+ce[R+8>>3]-nt,j=(j*(Z-nt)-(pe-qe)*xe)/(re*xe-V*j),ce[O>>3]=pe+re*j,ce[O+8>>3]=Z+V*j}function Eu(b,w){return b=b|0,w=w|0,+Lt(+(+ce[b>>3]-+ce[w>>3]))<11920928955078125e-23?(w=+Lt(+(+ce[b+8>>3]-+ce[w+8>>3]))<11920928955078125e-23,w|0):(w=0,w|0)}function va(b,w){b=b|0,w=w|0;var S=0,R=0,O=0;return O=+ce[b>>3]-+ce[w>>3],R=+ce[b+8>>3]-+ce[w+8>>3],S=+ce[b+16>>3]-+ce[w+16>>3],+(O*O+R*R+S*S)}function fh(b,w){b=b|0,w=w|0;var S=0,R=0,O=0;S=+ce[b>>3],R=+Dr(+S),S=+wr(+S),ce[w+16>>3]=S,S=+ce[b+8>>3],O=R*+Dr(+S),ce[w>>3]=O,S=R*+wr(+S),ce[w+8>>3]=S}function Yh(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;if(j=Fe,Fe=Fe+16|0,O=j,R=So(b,w)|0,(S+-1|0)>>>0>5||(R=(R|0)!=0,(S|0)==1&R))return O=-1,Fe=j,O|0;do if(ql(b,w,O)|0)R=-1;else if(R){R=((g[26352+(S<<2)>>2]|0)+5-(g[O>>2]|0)|0)%5|0;break}else{R=((g[26384+(S<<2)>>2]|0)+6-(g[O>>2]|0)|0)%6|0;break}while(!1);return O=R,Fe=j,O|0}function ql(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0,pe=0;if(pe=Fe,Fe=Fe+32|0,V=pe+16|0,Z=pe,R=Cc(b,w,V)|0,R|0)return S=R,Fe=pe,S|0;j=Ps(b,w)|0,re=Ki(b,w)|0,eh(j,Z),R=pd(j,g[V>>2]|0)|0;e:do if(Fo(j)|0){do switch(j|0){case 4:{b=0;break}case 14:{b=1;break}case 24:{b=2;break}case 38:{b=3;break}case 49:{b=4;break}case 58:{b=5;break}case 63:{b=6;break}case 72:{b=7;break}case 83:{b=8;break}case 97:{b=9;break}case 107:{b=10;break}case 117:{b=11;break}default:{R=1;break e}}while(!1);if(O=g[26416+(b*24|0)+8>>2]|0,w=g[26416+(b*24|0)+16>>2]|0,b=g[V>>2]|0,(b|0)!=(g[Z>>2]|0)&&(Z=iu(j)|0,b=g[V>>2]|0,Z|(b|0)==(w|0)&&(R=(R+1|0)%6|0)),(re|0)==3&(b|0)==(w|0)){R=(R+5|0)%6|0,O=22;break}(re|0)==5&(b|0)==(O|0)&&(R=(R+1|0)%6|0),O=22}else O=22;while(!1);return(O|0)==22&&(g[S>>2]=R,R=0),S=R,Fe=pe,S|0}function za(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0;if(qt=Fe,Fe=Fe+32|0,Qt=qt+24|0,jt=qt+20|0,at=qt+8|0,ot=qt+16|0,nt=qt,re=(So(b,w)|0)==0,re=re?6:5,xe=Vr(b|0,w|0,52)|0,He()|0,xe=xe&15,re>>>0<=S>>>0)return R=2,Fe=qt,R|0;qe=(xe|0)==0,!qe&&(Rt=Jr(7,0,(xe^15)*3|0)|0,(Rt&b|0)==0&((He()|0)&w|0)==0)?O=S:j=4;e:do if((j|0)==4){if(O=(So(b,w)|0)!=0,((O?4:5)|0)<(S|0)||ql(b,w,Qt)|0||(j=(g[Qt>>2]|0)+S|0,O?O=26704+(((j|0)%5|0)<<2)|0:O=26736+(((j|0)%6|0)<<2)|0,Rt=g[O>>2]|0,(Rt|0)==7))return R=1,Fe=qt,R|0;g[jt>>2]=0,O=oa(b,w,Rt,jt,at)|0;do if(!O){if(Z=at,pe=g[Z>>2]|0,Z=g[Z+4>>2]|0,V=Z>>>0<w>>>0|(Z|0)==(w|0)&pe>>>0<b>>>0,j=V?pe:b,V=V?Z:w,!qe&&(qe=Jr(7,0,(xe^15)*3|0)|0,(pe&qe|0)==0&(Z&(He()|0)|0)==0))O=S;else{if(Z=(S+-1+re|0)%(re|0)|0,O=So(b,w)|0,(Z|0)<0&&mn(27795,27797,246,27806),re=(O|0)!=0,((re?4:5)|0)<(Z|0)&&mn(27795,27797,246,27806),ql(b,w,Qt)|0&&mn(27795,27797,246,27806),O=(g[Qt>>2]|0)+Z|0,re?O=26704+(((O|0)%5|0)<<2)|0:O=26736+(((O|0)%6|0)<<2)|0,Z=g[O>>2]|0,(Z|0)==7&&mn(27795,27797,246,27806),g[ot>>2]=0,O=oa(b,w,Z,ot,nt)|0,O|0)break;pe=nt,re=g[pe>>2]|0,pe=g[pe+4>>2]|0;do if(pe>>>0<V>>>0|(pe|0)==(V|0)&re>>>0<j>>>0){if(So(re,pe)|0?j=xl(re,pe,b,w)|0:j=g[26800+((((g[ot>>2]|0)+(g[26768+(Z<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,O=So(re,pe)|0,(j+-1|0)>>>0>5){O=-1,j=re,V=pe;break}if(O=(O|0)!=0,(j|0)==1&O){O=-1,j=re,V=pe;break}do if(ql(re,pe,Qt)|0)O=-1;else if(O){O=((g[26352+(j<<2)>>2]|0)+5-(g[Qt>>2]|0)|0)%5|0;break}else{O=((g[26384+(j<<2)>>2]|0)+6-(g[Qt>>2]|0)|0)%6|0;break}while(!1);j=re,V=pe}else O=S;while(!1);Z=at,pe=g[Z>>2]|0,Z=g[Z+4>>2]|0}if((j|0)==(pe|0)&(V|0)==(Z|0)){if(re=(So(pe,Z)|0)!=0,re?b=xl(pe,Z,b,w)|0:b=g[26800+((((g[jt>>2]|0)+(g[26768+(Rt<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,O=So(pe,Z)|0,(b+-1|0)>>>0<=5&&(fr=(O|0)!=0,!((b|0)==1&fr)))do if(ql(pe,Z,Qt)|0)O=-1;else if(fr){O=((g[26352+(b<<2)>>2]|0)+5-(g[Qt>>2]|0)|0)%5|0;break}else{O=((g[26384+(b<<2)>>2]|0)+6-(g[Qt>>2]|0)|0)%6|0;break}while(!1);else O=-1;O=O+1|0,O=(O|0)==6|re&(O|0)==5?0:O}w=V,b=j;break e}while(!1);return R=O,Fe=qt,R|0}while(!1);return fr=Jr(O|0,0,56)|0,Qt=He()|0|w&-2130706433|536870912,g[R>>2]=fr|b,g[R+4>>2]=Qt,R=0,Fe=qt,R|0}function Cu(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;return j=(So(b,w)|0)==0,R=za(b,w,0,S)|0,O=(R|0)==0,j?!O||(R=za(b,w,1,S+8|0)|0,R|0)||(R=za(b,w,2,S+16|0)|0,R|0)||(R=za(b,w,3,S+24|0)|0,R|0)||(R=za(b,w,4,S+32|0)|0,R)?(j=R,j|0):za(b,w,5,S+40|0)|0:!O||(R=za(b,w,1,S+8|0)|0,R|0)||(R=za(b,w,2,S+16|0)|0,R|0)||(R=za(b,w,3,S+24|0)|0,R|0)||(R=za(b,w,4,S+32|0)|0,R|0)?(j=R,j|0):(j=S+40|0,g[j>>2]=0,g[j+4>>2]=0,j=0,j|0)}function Os(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0,Z=0,re=0;return re=Fe,Fe=Fe+192|0,O=re,j=re+168|0,V=Vr(b|0,w|0,56)|0,He()|0,V=V&7,Z=w&-2130706433|134217728,R=Cc(b,Z,j)|0,R|0?(Z=R,Fe=re,Z|0):(w=Vr(b|0,w|0,52)|0,He()|0,w=w&15,So(b,Z)|0?Fh(j,w,V,1,O):gu(j,w,V,1,O),Z=O+8|0,g[S>>2]=g[Z>>2],g[S+4>>2]=g[Z+4>>2],g[S+8>>2]=g[Z+8>>2],g[S+12>>2]=g[Z+12>>2],Z=0,Fe=re,Z|0)}function fp(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0;return O=Fe,Fe=Fe+16|0,S=O,!(!0&(w&2013265920|0)==536870912)||(R=w&-2130706433|134217728,!(Mn(b,R)|0))?(R=0,Fe=O,R|0):(j=Vr(b|0,w|0,56)|0,He()|0,j=(za(b,R,j&7,S)|0)==0,R=S,R=j&((g[R>>2]|0)==(b|0)?(g[R+4>>2]|0)==(w|0):0)&1,Fe=O,R|0)}function Cd(b,w,S){b=b|0,w=w|0,S=S|0;var R=0;(w|0)>0?(R=Pa(w,4)|0,g[b>>2]=R,R||mn(27819,27842,40,27856)):g[b>>2]=0,g[b+4>>2]=w,g[b+8>>2]=0,g[b+12>>2]=S}function jf(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0;O=b+4|0,j=b+12|0,V=b+8|0;e:for(;;){for(S=g[O>>2]|0,w=0;;){if((w|0)>=(S|0))break e;if(R=g[b>>2]|0,Z=g[R+(w<<2)>>2]|0,!Z)w=w+1|0;else break}w=R+(~~(+Lt(+(+Fr(10,+ +(15-(g[j>>2]|0)|0))*(+ce[Z>>3]+ +ce[Z+8>>3])))%+(S|0))>>>0<<2)|0,S=g[w>>2]|0;t:do if(S|0){if(R=Z+32|0,(S|0)==(Z|0))g[w>>2]=g[R>>2];else{if(S=S+32|0,w=g[S>>2]|0,!w)break;for(;(w|0)!=(Z|0);)if(S=w+32|0,w=g[S>>2]|0,!w)break t;g[S>>2]=g[R>>2]}xn(Z),g[V>>2]=(g[V>>2]|0)+-1}while(!1)}xn(g[b>>2]|0)}function Md(b){b=b|0;var w=0,S=0,R=0;for(R=g[b+4>>2]|0,S=0;;){if((S|0)>=(R|0)){w=0,S=4;break}if(w=g[(g[b>>2]|0)+(S<<2)>>2]|0,!w)S=S+1|0;else{S=4;break}}return(S|0)==4?w|0:0}function zc(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0;if(S=~~(+Lt(+(+Fr(10,+ +(15-(g[b+12>>2]|0)|0))*(+ce[w>>3]+ +ce[w+8>>3])))%+(g[b+4>>2]|0))>>>0,S=(g[b>>2]|0)+(S<<2)|0,R=g[S>>2]|0,!R)return j=1,j|0;j=w+32|0;do if((R|0)!=(w|0)){if(S=g[R+32>>2]|0,!S)return j=1,j|0;for(O=S;;){if((O|0)==(w|0)){O=8;break}if(S=g[O+32>>2]|0,S)R=O,O=S;else{S=1,O=10;break}}if((O|0)==8){g[R+32>>2]=g[j>>2];break}else if((O|0)==10)return S|0}else g[S>>2]=g[j>>2];while(!1);return xn(w),j=b+8|0,g[j>>2]=(g[j>>2]|0)+-1,j=0,j|0}function ts(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0;j=Bc(40)|0,j||mn(27872,27842,98,27885),g[j>>2]=g[w>>2],g[j+4>>2]=g[w+4>>2],g[j+8>>2]=g[w+8>>2],g[j+12>>2]=g[w+12>>2],O=j+16|0,g[O>>2]=g[S>>2],g[O+4>>2]=g[S+4>>2],g[O+8>>2]=g[S+8>>2],g[O+12>>2]=g[S+12>>2],g[j+32>>2]=0,O=~~(+Lt(+(+Fr(10,+ +(15-(g[b+12>>2]|0)|0))*(+ce[w>>3]+ +ce[w+8>>3])))%+(g[b+4>>2]|0))>>>0,O=(g[b>>2]|0)+(O<<2)|0,R=g[O>>2]|0;do if(!R)g[O>>2]=j;else{for(;!(ah(R,w)|0&&ah(R+16|0,S)|0);)if(O=g[R+32>>2]|0,R=(O|0)==0?R:O,!(g[R+32>>2]|0)){V=10;break}if((V|0)==10){g[R+32>>2]=j;break}return xn(j),V=R,V|0}while(!1);return V=b+8|0,g[V>>2]=(g[V>>2]|0)+1,V=j,V|0}function Qh(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0;if(O=~~(+Lt(+(+Fr(10,+ +(15-(g[b+12>>2]|0)|0))*(+ce[w>>3]+ +ce[w+8>>3])))%+(g[b+4>>2]|0))>>>0,O=g[(g[b>>2]|0)+(O<<2)>>2]|0,!O)return S=0,S|0;if(!S){for(b=O;;){if(ah(b,w)|0){R=10;break}if(b=g[b+32>>2]|0,!b){b=0,R=10;break}}if((R|0)==10)return b|0}for(b=O;;){if(ah(b,w)|0&&ah(b+16|0,S)|0){R=10;break}if(b=g[b+32>>2]|0,!b){b=0,R=10;break}}return(R|0)==10?b|0:0}function Mu(b,w){b=b|0,w=w|0;var S=0;if(S=~~(+Lt(+(+Fr(10,+ +(15-(g[b+12>>2]|0)|0))*(+ce[w>>3]+ +ce[w+8>>3])))%+(g[b+4>>2]|0))>>>0,b=g[(g[b>>2]|0)+(S<<2)>>2]|0,!b)return S=0,S|0;for(;;){if(ah(b,w)|0){w=5;break}if(b=g[b+32>>2]|0,!b){b=0,w=5;break}}return(w|0)==5?b|0:0}function nm(){return 27904}function Lc(b){return b=+b,~~+Pd(+b)|0}function Bc(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0,Rt=0,jt=0,fr=0,Qt=0,qt=0,Dt=0,yr=0;yr=Fe,Fe=Fe+16|0,nt=yr;do if(b>>>0<245){if(pe=b>>>0<11?16:b+11&-8,b=pe>>>3,qe=g[6977]|0,S=qe>>>b,S&3|0)return w=(S&1^1)+b|0,b=27948+(w<<1<<2)|0,S=b+8|0,R=g[S>>2]|0,O=R+8|0,j=g[O>>2]|0,(j|0)==(b|0)?g[6977]=qe&~(1<<w):(g[j+12>>2]=b,g[S>>2]=j),Dt=w<<3,g[R+4>>2]=Dt|3,Dt=R+Dt+4|0,g[Dt>>2]=g[Dt>>2]|1,Dt=O,Fe=yr,Dt|0;if(xe=g[6979]|0,pe>>>0>xe>>>0){if(S|0)return w=2<<b,w=S<<b&(w|0-w),w=(w&0-w)+-1|0,Z=w>>>12&16,w=w>>>Z,S=w>>>5&8,w=w>>>S,j=w>>>2&4,w=w>>>j,b=w>>>1&2,w=w>>>b,R=w>>>1&1,R=(S|Z|j|b|R)+(w>>>R)|0,w=27948+(R<<1<<2)|0,b=w+8|0,j=g[b>>2]|0,Z=j+8|0,S=g[Z>>2]|0,(S|0)==(w|0)?(b=qe&~(1<<R),g[6977]=b):(g[S+12>>2]=w,g[b>>2]=S,b=qe),Dt=R<<3,V=Dt-pe|0,g[j+4>>2]=pe|3,O=j+pe|0,g[O+4>>2]=V|1,g[j+Dt>>2]=V,xe|0&&(R=g[6982]|0,w=xe>>>3,S=27948+(w<<1<<2)|0,w=1<<w,b&w?(b=S+8|0,w=g[b>>2]|0):(g[6977]=b|w,w=S,b=S+8|0),g[b>>2]=R,g[w+12>>2]=R,g[R+8>>2]=w,g[R+12>>2]=S),g[6979]=V,g[6982]=O,Dt=Z,Fe=yr,Dt|0;if(j=g[6978]|0,j){for(S=(j&0-j)+-1|0,O=S>>>12&16,S=S>>>O,R=S>>>5&8,S=S>>>R,V=S>>>2&4,S=S>>>V,Z=S>>>1&2,S=S>>>Z,re=S>>>1&1,re=g[28212+((R|O|V|Z|re)+(S>>>re)<<2)>>2]|0,S=re,Z=re,re=(g[re+4>>2]&-8)-pe|0;b=g[S+16>>2]|0,!(!b&&(b=g[S+20>>2]|0,!b));)V=(g[b+4>>2]&-8)-pe|0,O=V>>>0<re>>>0,S=b,Z=O?b:Z,re=O?V:re;if(V=Z+pe|0,V>>>0>Z>>>0){O=g[Z+24>>2]|0,w=g[Z+12>>2]|0;do if((w|0)==(Z|0)){if(b=Z+20|0,w=g[b>>2]|0,!w&&(b=Z+16|0,w=g[b>>2]|0,!w)){S=0;break}for(;;)if(R=w+20|0,S=g[R>>2]|0,S)w=S,b=R;else if(R=w+16|0,S=g[R>>2]|0,S)w=S,b=R;else break;g[b>>2]=0,S=w}else S=g[Z+8>>2]|0,g[S+12>>2]=w,g[w+8>>2]=S,S=w;while(!1);do if(O|0){if(w=g[Z+28>>2]|0,b=28212+(w<<2)|0,(Z|0)==(g[b>>2]|0)){if(g[b>>2]=S,!S){g[6978]=j&~(1<<w);break}}else if(Dt=O+16|0,g[((g[Dt>>2]|0)==(Z|0)?Dt:O+20|0)>>2]=S,!S)break;g[S+24>>2]=O,w=g[Z+16>>2]|0,w|0&&(g[S+16>>2]=w,g[w+24>>2]=S),w=g[Z+20>>2]|0,w|0&&(g[S+20>>2]=w,g[w+24>>2]=S)}while(!1);return re>>>0<16?(Dt=re+pe|0,g[Z+4>>2]=Dt|3,Dt=Z+Dt+4|0,g[Dt>>2]=g[Dt>>2]|1):(g[Z+4>>2]=pe|3,g[V+4>>2]=re|1,g[V+re>>2]=re,xe|0&&(R=g[6982]|0,w=xe>>>3,S=27948+(w<<1<<2)|0,w=1<<w,w&qe?(b=S+8|0,w=g[b>>2]|0):(g[6977]=w|qe,w=S,b=S+8|0),g[b>>2]=R,g[w+12>>2]=R,g[R+8>>2]=w,g[R+12>>2]=S),g[6979]=re,g[6982]=V),Dt=Z+8|0,Fe=yr,Dt|0}else qe=pe}else qe=pe}else qe=pe}else if(b>>>0<=4294967231)if(b=b+11|0,pe=b&-8,R=g[6978]|0,R){O=0-pe|0,b=b>>>8,b?pe>>>0>16777215?re=31:(qe=(b+1048320|0)>>>16&8,Rt=b<<qe,Z=(Rt+520192|0)>>>16&4,Rt=Rt<<Z,re=(Rt+245760|0)>>>16&2,re=14-(Z|qe|re)+(Rt<<re>>>15)|0,re=pe>>>(re+7|0)&1|re<<1):re=0,S=g[28212+(re<<2)>>2]|0;e:do if(!S)S=0,b=0,Rt=61;else for(b=0,Z=pe<<((re|0)==31?0:25-(re>>>1)|0),j=0;;){if(V=(g[S+4>>2]&-8)-pe|0,V>>>0<O>>>0)if(V)b=S,O=V;else{b=S,O=0,Rt=65;break e}if(Rt=g[S+20>>2]|0,S=g[S+16+(Z>>>31<<2)>>2]|0,j=(Rt|0)==0|(Rt|0)==(S|0)?j:Rt,S)Z=Z<<1;else{S=j,Rt=61;break}}while(!1);if((Rt|0)==61){if((S|0)==0&(b|0)==0){if(b=2<<re,b=(b|0-b)&R,!b){qe=pe;break}qe=(b&0-b)+-1|0,V=qe>>>12&16,qe=qe>>>V,j=qe>>>5&8,qe=qe>>>j,Z=qe>>>2&4,qe=qe>>>Z,re=qe>>>1&2,qe=qe>>>re,S=qe>>>1&1,b=0,S=g[28212+((j|V|Z|re|S)+(qe>>>S)<<2)>>2]|0}S?Rt=65:(Z=b,V=O)}if((Rt|0)==65)for(j=S;;)if(qe=(g[j+4>>2]&-8)-pe|0,S=qe>>>0<O>>>0,O=S?qe:O,b=S?j:b,S=g[j+16>>2]|0,S||(S=g[j+20>>2]|0),S)j=S;else{Z=b,V=O;break}if((Z|0)!=0&&V>>>0<((g[6979]|0)-pe|0)>>>0&&(xe=Z+pe|0,xe>>>0>Z>>>0)){j=g[Z+24>>2]|0,w=g[Z+12>>2]|0;do if((w|0)==(Z|0)){if(b=Z+20|0,w=g[b>>2]|0,!w&&(b=Z+16|0,w=g[b>>2]|0,!w)){w=0;break}for(;;)if(O=w+20|0,S=g[O>>2]|0,S)w=S,b=O;else if(O=w+16|0,S=g[O>>2]|0,S)w=S,b=O;else break;g[b>>2]=0}else Dt=g[Z+8>>2]|0,g[Dt+12>>2]=w,g[w+8>>2]=Dt;while(!1);do if(j){if(b=g[Z+28>>2]|0,S=28212+(b<<2)|0,(Z|0)==(g[S>>2]|0)){if(g[S>>2]=w,!w){R=R&~(1<<b),g[6978]=R;break}}else if(Dt=j+16|0,g[((g[Dt>>2]|0)==(Z|0)?Dt:j+20|0)>>2]=w,!w)break;g[w+24>>2]=j,b=g[Z+16>>2]|0,b|0&&(g[w+16>>2]=b,g[b+24>>2]=w),b=g[Z+20>>2]|0,b&&(g[w+20>>2]=b,g[b+24>>2]=w)}while(!1);e:do if(V>>>0<16)Dt=V+pe|0,g[Z+4>>2]=Dt|3,Dt=Z+Dt+4|0,g[Dt>>2]=g[Dt>>2]|1;else{if(g[Z+4>>2]=pe|3,g[xe+4>>2]=V|1,g[xe+V>>2]=V,w=V>>>3,V>>>0<256){S=27948+(w<<1<<2)|0,b=g[6977]|0,w=1<<w,b&w?(b=S+8|0,w=g[b>>2]|0):(g[6977]=b|w,w=S,b=S+8|0),g[b>>2]=xe,g[w+12>>2]=xe,g[xe+8>>2]=w,g[xe+12>>2]=S;break}if(w=V>>>8,w?V>>>0>16777215?S=31:(qt=(w+1048320|0)>>>16&8,Dt=w<<qt,Qt=(Dt+520192|0)>>>16&4,Dt=Dt<<Qt,S=(Dt+245760|0)>>>16&2,S=14-(Qt|qt|S)+(Dt<<S>>>15)|0,S=V>>>(S+7|0)&1|S<<1):S=0,w=28212+(S<<2)|0,g[xe+28>>2]=S,b=xe+16|0,g[b+4>>2]=0,g[b>>2]=0,b=1<<S,!(R&b)){g[6978]=R|b,g[w>>2]=xe,g[xe+24>>2]=w,g[xe+12>>2]=xe,g[xe+8>>2]=xe;break}w=g[w>>2]|0;t:do if((g[w+4>>2]&-8|0)!=(V|0)){for(R=V<<((S|0)==31?0:25-(S>>>1)|0);S=w+16+(R>>>31<<2)|0,b=g[S>>2]|0,!!b;)if((g[b+4>>2]&-8|0)==(V|0)){w=b;break t}else R=R<<1,w=b;g[S>>2]=xe,g[xe+24>>2]=w,g[xe+12>>2]=xe,g[xe+8>>2]=xe;break e}while(!1);qt=w+8|0,Dt=g[qt>>2]|0,g[Dt+12>>2]=xe,g[qt>>2]=xe,g[xe+8>>2]=Dt,g[xe+12>>2]=w,g[xe+24>>2]=0}while(!1);return Dt=Z+8|0,Fe=yr,Dt|0}else qe=pe}else qe=pe;else qe=-1;while(!1);if(S=g[6979]|0,S>>>0>=qe>>>0)return w=S-qe|0,b=g[6982]|0,w>>>0>15?(Dt=b+qe|0,g[6982]=Dt,g[6979]=w,g[Dt+4>>2]=w|1,g[b+S>>2]=w,g[b+4>>2]=qe|3):(g[6979]=0,g[6982]=0,g[b+4>>2]=S|3,Dt=b+S+4|0,g[Dt>>2]=g[Dt>>2]|1),Dt=b+8|0,Fe=yr,Dt|0;if(V=g[6980]|0,V>>>0>qe>>>0)return Qt=V-qe|0,g[6980]=Qt,Dt=g[6983]|0,qt=Dt+qe|0,g[6983]=qt,g[qt+4>>2]=Qt|1,g[Dt+4>>2]=qe|3,Dt=Dt+8|0,Fe=yr,Dt|0;if(g[7095]|0?b=g[7097]|0:(g[7097]=4096,g[7096]=4096,g[7098]=-1,g[7099]=-1,g[7100]=0,g[7088]=0,g[7095]=nt&-16^1431655768,b=4096),Z=qe+48|0,re=qe+47|0,j=b+re|0,O=0-b|0,pe=j&O,pe>>>0<=qe>>>0||(b=g[7087]|0,b|0&&(xe=g[7085]|0,nt=xe+pe|0,nt>>>0<=xe>>>0|nt>>>0>b>>>0)))return Dt=0,Fe=yr,Dt|0;e:do if(g[7088]&4)w=0,Rt=143;else{S=g[6983]|0;t:do if(S){for(R=28356;nt=g[R>>2]|0,!(nt>>>0<=S>>>0&&(nt+(g[R+4>>2]|0)|0)>>>0>S>>>0);)if(b=g[R+8>>2]|0,b)R=b;else{Rt=128;break t}if(w=j-V&O,w>>>0<2147483647)if(b=Zl(w|0)|0,(b|0)==((g[R>>2]|0)+(g[R+4>>2]|0)|0)){if((b|0)!=-1){V=w,j=b,Rt=145;break e}}else R=b,Rt=136;else w=0}else Rt=128;while(!1);do if((Rt|0)==128)if(S=Zl(0)|0,(S|0)!=-1&&(w=S,ot=g[7096]|0,at=ot+-1|0,w=((at&w|0)==0?0:(at+w&0-ot)-w|0)+pe|0,ot=g[7085]|0,at=w+ot|0,w>>>0>qe>>>0&w>>>0<2147483647)){if(nt=g[7087]|0,nt|0&&at>>>0<=ot>>>0|at>>>0>nt>>>0){w=0;break}if(b=Zl(w|0)|0,(b|0)==(S|0)){V=w,j=S,Rt=145;break e}else R=b,Rt=136}else w=0;while(!1);do if((Rt|0)==136){if(S=0-w|0,!(Z>>>0>w>>>0&(w>>>0<2147483647&(R|0)!=-1)))if((R|0)==-1){w=0;break}else{V=w,j=R,Rt=145;break e}if(b=g[7097]|0,b=re-w+b&0-b,b>>>0>=2147483647){V=w,j=R,Rt=145;break e}if((Zl(b|0)|0)==-1){Zl(S|0)|0,w=0;break}else{V=b+w|0,j=R,Rt=145;break e}}while(!1);g[7088]=g[7088]|4,Rt=143}while(!1);if((Rt|0)==143&&pe>>>0<2147483647&&(Qt=Zl(pe|0)|0,at=Zl(0)|0,jt=at-Qt|0,fr=jt>>>0>(qe+40|0)>>>0,!((Qt|0)==-1|fr^1|Qt>>>0<at>>>0&((Qt|0)!=-1&(at|0)!=-1)^1))&&(V=fr?jt:w,j=Qt,Rt=145),(Rt|0)==145){w=(g[7085]|0)+V|0,g[7085]=w,w>>>0>(g[7086]|0)>>>0&&(g[7086]=w),re=g[6983]|0;e:do if(re){for(w=28356;;){if(b=g[w>>2]|0,S=g[w+4>>2]|0,(j|0)==(b+S|0)){Rt=154;break}if(R=g[w+8>>2]|0,R)w=R;else break}if((Rt|0)==154&&(qt=w+4|0,(g[w+12>>2]&8|0)==0)&&j>>>0>re>>>0&b>>>0<=re>>>0){g[qt>>2]=S+V,Dt=(g[6980]|0)+V|0,Qt=re+8|0,Qt=(Qt&7|0)==0?0:0-Qt&7,qt=re+Qt|0,Qt=Dt-Qt|0,g[6983]=qt,g[6980]=Qt,g[qt+4>>2]=Qt|1,g[re+Dt+4>>2]=40,g[6984]=g[7099];break}for(j>>>0<(g[6981]|0)>>>0&&(g[6981]=j),S=j+V|0,w=28356;;){if((g[w>>2]|0)==(S|0)){Rt=162;break}if(b=g[w+8>>2]|0,b)w=b;else break}if((Rt|0)==162&&(g[w+12>>2]&8|0)==0){g[w>>2]=j,xe=w+4|0,g[xe>>2]=(g[xe>>2]|0)+V,xe=j+8|0,xe=j+((xe&7|0)==0?0:0-xe&7)|0,w=S+8|0,w=S+((w&7|0)==0?0:0-w&7)|0,pe=xe+qe|0,Z=w-xe-qe|0,g[xe+4>>2]=qe|3;t:do if((re|0)==(w|0))Dt=(g[6980]|0)+Z|0,g[6980]=Dt,g[6983]=pe,g[pe+4>>2]=Dt|1;else{if((g[6982]|0)==(w|0)){Dt=(g[6979]|0)+Z|0,g[6979]=Dt,g[6982]=pe,g[pe+4>>2]=Dt|1,g[pe+Dt>>2]=Dt;break}if(b=g[w+4>>2]|0,(b&3|0)==1){V=b&-8,R=b>>>3;r:do if(b>>>0<256)if(b=g[w+8>>2]|0,S=g[w+12>>2]|0,(S|0)==(b|0)){g[6977]=g[6977]&~(1<<R);break}else{g[b+12>>2]=S,g[S+8>>2]=b;break}else{j=g[w+24>>2]|0,b=g[w+12>>2]|0;do if((b|0)==(w|0)){if(S=w+16|0,R=S+4|0,b=g[R>>2]|0,b)S=R;else if(b=g[S>>2]|0,!b){b=0;break}for(;;)if(O=b+20|0,R=g[O>>2]|0,R)b=R,S=O;else if(O=b+16|0,R=g[O>>2]|0,R)b=R,S=O;else break;g[S>>2]=0}else Dt=g[w+8>>2]|0,g[Dt+12>>2]=b,g[b+8>>2]=Dt;while(!1);if(!j)break;S=g[w+28>>2]|0,R=28212+(S<<2)|0;do if((g[R>>2]|0)!=(w|0)){if(Dt=j+16|0,g[((g[Dt>>2]|0)==(w|0)?Dt:j+20|0)>>2]=b,!b)break r}else{if(g[R>>2]=b,b|0)break;g[6978]=g[6978]&~(1<<S);break r}while(!1);if(g[b+24>>2]=j,S=w+16|0,R=g[S>>2]|0,R|0&&(g[b+16>>2]=R,g[R+24>>2]=b),S=g[S+4>>2]|0,!S)break;g[b+20>>2]=S,g[S+24>>2]=b}while(!1);w=w+V|0,O=V+Z|0}else O=Z;if(w=w+4|0,g[w>>2]=g[w>>2]&-2,g[pe+4>>2]=O|1,g[pe+O>>2]=O,w=O>>>3,O>>>0<256){S=27948+(w<<1<<2)|0,b=g[6977]|0,w=1<<w,b&w?(b=S+8|0,w=g[b>>2]|0):(g[6977]=b|w,w=S,b=S+8|0),g[b>>2]=pe,g[w+12>>2]=pe,g[pe+8>>2]=w,g[pe+12>>2]=S;break}w=O>>>8;do if(!w)R=0;else{if(O>>>0>16777215){R=31;break}qt=(w+1048320|0)>>>16&8,Dt=w<<qt,Qt=(Dt+520192|0)>>>16&4,Dt=Dt<<Qt,R=(Dt+245760|0)>>>16&2,R=14-(Qt|qt|R)+(Dt<<R>>>15)|0,R=O>>>(R+7|0)&1|R<<1}while(!1);if(w=28212+(R<<2)|0,g[pe+28>>2]=R,b=pe+16|0,g[b+4>>2]=0,g[b>>2]=0,b=g[6978]|0,S=1<<R,!(b&S)){g[6978]=b|S,g[w>>2]=pe,g[pe+24>>2]=w,g[pe+12>>2]=pe,g[pe+8>>2]=pe;break}w=g[w>>2]|0;r:do if((g[w+4>>2]&-8|0)!=(O|0)){for(R=O<<((R|0)==31?0:25-(R>>>1)|0);S=w+16+(R>>>31<<2)|0,b=g[S>>2]|0,!!b;)if((g[b+4>>2]&-8|0)==(O|0)){w=b;break r}else R=R<<1,w=b;g[S>>2]=pe,g[pe+24>>2]=w,g[pe+12>>2]=pe,g[pe+8>>2]=pe;break t}while(!1);qt=w+8|0,Dt=g[qt>>2]|0,g[Dt+12>>2]=pe,g[qt>>2]=pe,g[pe+8>>2]=Dt,g[pe+12>>2]=w,g[pe+24>>2]=0}while(!1);return Dt=xe+8|0,Fe=yr,Dt|0}for(w=28356;b=g[w>>2]|0,!(b>>>0<=re>>>0&&(Dt=b+(g[w+4>>2]|0)|0,Dt>>>0>re>>>0));)w=g[w+8>>2]|0;O=Dt+-47|0,b=O+8|0,b=O+((b&7|0)==0?0:0-b&7)|0,O=re+16|0,b=b>>>0<O>>>0?re:b,w=b+8|0,S=V+-40|0,Qt=j+8|0,Qt=(Qt&7|0)==0?0:0-Qt&7,qt=j+Qt|0,Qt=S-Qt|0,g[6983]=qt,g[6980]=Qt,g[qt+4>>2]=Qt|1,g[j+S+4>>2]=40,g[6984]=g[7099],S=b+4|0,g[S>>2]=27,g[w>>2]=g[7089],g[w+4>>2]=g[7090],g[w+8>>2]=g[7091],g[w+12>>2]=g[7092],g[7089]=j,g[7090]=V,g[7092]=0,g[7091]=w,w=b+24|0;do qt=w,w=w+4|0,g[w>>2]=7;while((qt+8|0)>>>0<Dt>>>0);if((b|0)!=(re|0)){if(j=b-re|0,g[S>>2]=g[S>>2]&-2,g[re+4>>2]=j|1,g[b>>2]=j,w=j>>>3,j>>>0<256){S=27948+(w<<1<<2)|0,b=g[6977]|0,w=1<<w,b&w?(b=S+8|0,w=g[b>>2]|0):(g[6977]=b|w,w=S,b=S+8|0),g[b>>2]=re,g[w+12>>2]=re,g[re+8>>2]=w,g[re+12>>2]=S;break}if(w=j>>>8,w?j>>>0>16777215?R=31:(qt=(w+1048320|0)>>>16&8,Dt=w<<qt,Qt=(Dt+520192|0)>>>16&4,Dt=Dt<<Qt,R=(Dt+245760|0)>>>16&2,R=14-(Qt|qt|R)+(Dt<<R>>>15)|0,R=j>>>(R+7|0)&1|R<<1):R=0,S=28212+(R<<2)|0,g[re+28>>2]=R,g[re+20>>2]=0,g[O>>2]=0,w=g[6978]|0,b=1<<R,!(w&b)){g[6978]=w|b,g[S>>2]=re,g[re+24>>2]=S,g[re+12>>2]=re,g[re+8>>2]=re;break}w=g[S>>2]|0;t:do if((g[w+4>>2]&-8|0)!=(j|0)){for(R=j<<((R|0)==31?0:25-(R>>>1)|0);S=w+16+(R>>>31<<2)|0,b=g[S>>2]|0,!!b;)if((g[b+4>>2]&-8|0)==(j|0)){w=b;break t}else R=R<<1,w=b;g[S>>2]=re,g[re+24>>2]=w,g[re+12>>2]=re,g[re+8>>2]=re;break e}while(!1);qt=w+8|0,Dt=g[qt>>2]|0,g[Dt+12>>2]=re,g[qt>>2]=re,g[re+8>>2]=Dt,g[re+12>>2]=w,g[re+24>>2]=0}}else Dt=g[6981]|0,(Dt|0)==0|j>>>0<Dt>>>0&&(g[6981]=j),g[7089]=j,g[7090]=V,g[7092]=0,g[6986]=g[7095],g[6985]=-1,g[6990]=27948,g[6989]=27948,g[6992]=27956,g[6991]=27956,g[6994]=27964,g[6993]=27964,g[6996]=27972,g[6995]=27972,g[6998]=27980,g[6997]=27980,g[7e3]=27988,g[6999]=27988,g[7002]=27996,g[7001]=27996,g[7004]=28004,g[7003]=28004,g[7006]=28012,g[7005]=28012,g[7008]=28020,g[7007]=28020,g[7010]=28028,g[7009]=28028,g[7012]=28036,g[7011]=28036,g[7014]=28044,g[7013]=28044,g[7016]=28052,g[7015]=28052,g[7018]=28060,g[7017]=28060,g[7020]=28068,g[7019]=28068,g[7022]=28076,g[7021]=28076,g[7024]=28084,g[7023]=28084,g[7026]=28092,g[7025]=28092,g[7028]=28100,g[7027]=28100,g[7030]=28108,g[7029]=28108,g[7032]=28116,g[7031]=28116,g[7034]=28124,g[7033]=28124,g[7036]=28132,g[7035]=28132,g[7038]=28140,g[7037]=28140,g[7040]=28148,g[7039]=28148,g[7042]=28156,g[7041]=28156,g[7044]=28164,g[7043]=28164,g[7046]=28172,g[7045]=28172,g[7048]=28180,g[7047]=28180,g[7050]=28188,g[7049]=28188,g[7052]=28196,g[7051]=28196,Dt=V+-40|0,Qt=j+8|0,Qt=(Qt&7|0)==0?0:0-Qt&7,qt=j+Qt|0,Qt=Dt-Qt|0,g[6983]=qt,g[6980]=Qt,g[qt+4>>2]=Qt|1,g[j+Dt+4>>2]=40,g[6984]=g[7099];while(!1);if(w=g[6980]|0,w>>>0>qe>>>0)return Qt=w-qe|0,g[6980]=Qt,Dt=g[6983]|0,qt=Dt+qe|0,g[6983]=qt,g[qt+4>>2]=Qt|1,g[Dt+4>>2]=qe|3,Dt=Dt+8|0,Fe=yr,Dt|0}return Dt=nm()|0,g[Dt>>2]=12,Dt=0,Fe=yr,Dt|0}function xn(b){b=b|0;var w=0,S=0,R=0,O=0,j=0,V=0,Z=0,re=0;if(b){S=b+-8|0,O=g[6981]|0,b=g[b+-4>>2]|0,w=b&-8,re=S+w|0;do if(b&1)Z=S,V=S;else{if(R=g[S>>2]|0,!(b&3)||(V=S+(0-R)|0,j=R+w|0,V>>>0<O>>>0))return;if((g[6982]|0)==(V|0)){if(b=re+4|0,w=g[b>>2]|0,(w&3|0)!=3){Z=V,w=j;break}g[6979]=j,g[b>>2]=w&-2,g[V+4>>2]=j|1,g[V+j>>2]=j;return}if(S=R>>>3,R>>>0<256)if(b=g[V+8>>2]|0,w=g[V+12>>2]|0,(w|0)==(b|0)){g[6977]=g[6977]&~(1<<S),Z=V,w=j;break}else{g[b+12>>2]=w,g[w+8>>2]=b,Z=V,w=j;break}O=g[V+24>>2]|0,b=g[V+12>>2]|0;do if((b|0)==(V|0)){if(w=V+16|0,S=w+4|0,b=g[S>>2]|0,b)w=S;else if(b=g[w>>2]|0,!b){b=0;break}for(;;)if(R=b+20|0,S=g[R>>2]|0,S)b=S,w=R;else if(R=b+16|0,S=g[R>>2]|0,S)b=S,w=R;else break;g[w>>2]=0}else Z=g[V+8>>2]|0,g[Z+12>>2]=b,g[b+8>>2]=Z;while(!1);if(O){if(w=g[V+28>>2]|0,S=28212+(w<<2)|0,(g[S>>2]|0)==(V|0)){if(g[S>>2]=b,!b){g[6978]=g[6978]&~(1<<w),Z=V,w=j;break}}else if(Z=O+16|0,g[((g[Z>>2]|0)==(V|0)?Z:O+20|0)>>2]=b,!b){Z=V,w=j;break}g[b+24>>2]=O,w=V+16|0,S=g[w>>2]|0,S|0&&(g[b+16>>2]=S,g[S+24>>2]=b),w=g[w+4>>2]|0,w?(g[b+20>>2]=w,g[w+24>>2]=b,Z=V,w=j):(Z=V,w=j)}else Z=V,w=j}while(!1);if(!(V>>>0>=re>>>0)&&(b=re+4|0,R=g[b>>2]|0,!!(R&1))){if(R&2)g[b>>2]=R&-2,g[Z+4>>2]=w|1,g[V+w>>2]=w,O=w;else{if((g[6983]|0)==(re|0)){if(re=(g[6980]|0)+w|0,g[6980]=re,g[6983]=Z,g[Z+4>>2]=re|1,(Z|0)!=(g[6982]|0))return;g[6982]=0,g[6979]=0;return}if((g[6982]|0)==(re|0)){re=(g[6979]|0)+w|0,g[6979]=re,g[6982]=V,g[Z+4>>2]=re|1,g[V+re>>2]=re;return}O=(R&-8)+w|0,S=R>>>3;do if(R>>>0<256)if(w=g[re+8>>2]|0,b=g[re+12>>2]|0,(b|0)==(w|0)){g[6977]=g[6977]&~(1<<S);break}else{g[w+12>>2]=b,g[b+8>>2]=w;break}else{j=g[re+24>>2]|0,b=g[re+12>>2]|0;do if((b|0)==(re|0)){if(w=re+16|0,S=w+4|0,b=g[S>>2]|0,b)w=S;else if(b=g[w>>2]|0,!b){S=0;break}for(;;)if(R=b+20|0,S=g[R>>2]|0,S)b=S,w=R;else if(R=b+16|0,S=g[R>>2]|0,S)b=S,w=R;else break;g[w>>2]=0,S=b}else S=g[re+8>>2]|0,g[S+12>>2]=b,g[b+8>>2]=S,S=b;while(!1);if(j|0){if(b=g[re+28>>2]|0,w=28212+(b<<2)|0,(g[w>>2]|0)==(re|0)){if(g[w>>2]=S,!S){g[6978]=g[6978]&~(1<<b);break}}else if(R=j+16|0,g[((g[R>>2]|0)==(re|0)?R:j+20|0)>>2]=S,!S)break;g[S+24>>2]=j,b=re+16|0,w=g[b>>2]|0,w|0&&(g[S+16>>2]=w,g[w+24>>2]=S),b=g[b+4>>2]|0,b|0&&(g[S+20>>2]=b,g[b+24>>2]=S)}}while(!1);if(g[Z+4>>2]=O|1,g[V+O>>2]=O,(Z|0)==(g[6982]|0)){g[6979]=O;return}}if(b=O>>>3,O>>>0<256){S=27948+(b<<1<<2)|0,w=g[6977]|0,b=1<<b,w&b?(w=S+8|0,b=g[w>>2]|0):(g[6977]=w|b,b=S,w=S+8|0),g[w>>2]=Z,g[b+12>>2]=Z,g[Z+8>>2]=b,g[Z+12>>2]=S;return}b=O>>>8,b?O>>>0>16777215?R=31:(V=(b+1048320|0)>>>16&8,re=b<<V,j=(re+520192|0)>>>16&4,re=re<<j,R=(re+245760|0)>>>16&2,R=14-(j|V|R)+(re<<R>>>15)|0,R=O>>>(R+7|0)&1|R<<1):R=0,b=28212+(R<<2)|0,g[Z+28>>2]=R,g[Z+20>>2]=0,g[Z+16>>2]=0,w=g[6978]|0,S=1<<R;e:do if(!(w&S))g[6978]=w|S,g[b>>2]=Z,g[Z+24>>2]=b,g[Z+12>>2]=Z,g[Z+8>>2]=Z;else{b=g[b>>2]|0;t:do if((g[b+4>>2]&-8|0)!=(O|0)){for(R=O<<((R|0)==31?0:25-(R>>>1)|0);S=b+16+(R>>>31<<2)|0,w=g[S>>2]|0,!!w;)if((g[w+4>>2]&-8|0)==(O|0)){b=w;break t}else R=R<<1,b=w;g[S>>2]=Z,g[Z+24>>2]=b,g[Z+12>>2]=Z,g[Z+8>>2]=Z;break e}while(!1);V=b+8|0,re=g[V>>2]|0,g[re+12>>2]=Z,g[V>>2]=Z,g[Z+8>>2]=re,g[Z+12>>2]=b,g[Z+24>>2]=0}while(!1);if(re=(g[6985]|0)+-1|0,g[6985]=re,!(re|0)){for(b=28364;b=g[b>>2]|0,b;)b=b+8|0;g[6985]=-1}}}}function Pa(b,w){b=b|0,w=w|0;var S=0;return b?(S=wo(w,b)|0,(w|b)>>>0>65535&&(S=((S>>>0)/(b>>>0)|0|0)==(w|0)?S:-1)):S=0,b=Bc(S)|0,!b||!(g[b+-4>>2]&3)||Pu(b|0,0,S|0)|0,b|0}function qn(b,w,S,R){return b=b|0,w=w|0,S=S|0,R=R|0,S=b+S>>>0,yn(w+R+(S>>>0<b>>>0|0)>>>0|0),S|0|0}function Ro(b,w,S,R){return b=b|0,w=w|0,S=S|0,R=R|0,R=w-R-(S>>>0>b>>>0|0)>>>0,yn(R|0),b-S>>>0|0|0}function Kh(b){return b=b|0,(b?31-(ri(b^b-1)|0)|0:32)|0}function Wl(b,w,S,R,O){b=b|0,w=w|0,S=S|0,R=R|0,O=O|0;var j=0,V=0,Z=0,re=0,pe=0,xe=0,qe=0,nt=0,ot=0,at=0;if(xe=b,re=w,pe=re,V=S,nt=R,Z=nt,!pe)return j=(O|0)!=0,Z?j?(g[O>>2]=b|0,g[O+4>>2]=w&0,nt=0,O=0,yn(nt|0),O|0):(nt=0,O=0,yn(nt|0),O|0):(j&&(g[O>>2]=(xe>>>0)%(V>>>0),g[O+4>>2]=0),nt=0,O=(xe>>>0)/(V>>>0)>>>0,yn(nt|0),O|0);j=(Z|0)==0;do if(V){if(!j){if(j=(ri(Z|0)|0)-(ri(pe|0)|0)|0,j>>>0<=31){qe=j+1|0,Z=31-j|0,w=j-31>>31,V=qe,b=xe>>>(qe>>>0)&w|pe<<Z,w=pe>>>(qe>>>0)&w,j=0,Z=xe<<Z;break}return O?(g[O>>2]=b|0,g[O+4>>2]=re|w&0,nt=0,O=0,yn(nt|0),O|0):(nt=0,O=0,yn(nt|0),O|0)}if(j=V-1|0,j&V|0){Z=(ri(V|0)|0)+33-(ri(pe|0)|0)|0,at=64-Z|0,qe=32-Z|0,re=qe>>31,ot=Z-32|0,w=ot>>31,V=Z,b=qe-1>>31&pe>>>(ot>>>0)|(pe<<qe|xe>>>(Z>>>0))&w,w=w&pe>>>(Z>>>0),j=xe<<at&re,Z=(pe<<at|xe>>>(ot>>>0))&re|xe<<qe&Z-33>>31;break}return O|0&&(g[O>>2]=j&xe,g[O+4>>2]=0),(V|0)==1?(ot=re|w&0,at=b|0|0,yn(ot|0),at|0):(at=Kh(V|0)|0,ot=pe>>>(at>>>0)|0,at=pe<<32-at|xe>>>(at>>>0)|0,yn(ot|0),at|0)}else{if(j)return O|0&&(g[O>>2]=(pe>>>0)%(V>>>0),g[O+4>>2]=0),ot=0,at=(pe>>>0)/(V>>>0)>>>0,yn(ot|0),at|0;if(!xe)return O|0&&(g[O>>2]=0,g[O+4>>2]=(pe>>>0)%(Z>>>0)),ot=0,at=(pe>>>0)/(Z>>>0)>>>0,yn(ot|0),at|0;if(j=Z-1|0,!(j&Z))return O|0&&(g[O>>2]=b|0,g[O+4>>2]=j&pe|w&0),ot=0,at=pe>>>((Kh(Z|0)|0)>>>0),yn(ot|0),at|0;if(j=(ri(Z|0)|0)-(ri(pe|0)|0)|0,j>>>0<=30){w=j+1|0,Z=31-j|0,V=w,b=pe<<Z|xe>>>(w>>>0),w=pe>>>(w>>>0),j=0,Z=xe<<Z;break}return O?(g[O>>2]=b|0,g[O+4>>2]=re|w&0,ot=0,at=0,yn(ot|0),at|0):(ot=0,at=0,yn(ot|0),at|0)}while(!1);if(!V)pe=Z,re=0,Z=0;else{qe=S|0|0,xe=nt|R&0,pe=qn(qe|0,xe|0,-1,-1)|0,S=He()|0,re=Z,Z=0;do R=re,re=j>>>31|re<<1,j=Z|j<<1,R=b<<1|R>>>31|0,nt=b>>>31|w<<1|0,Ro(pe|0,S|0,R|0,nt|0)|0,at=He()|0,ot=at>>31|((at|0)<0?-1:0)<<1,Z=ot&1,b=Ro(R|0,nt|0,ot&qe|0,(((at|0)<0?-1:0)>>31|((at|0)<0?-1:0)<<1)&xe|0)|0,w=He()|0,V=V-1|0;while((V|0)!=0);pe=re,re=0}return V=0,O|0&&(g[O>>2]=b,g[O+4>>2]=w),ot=(j|0)>>>31|(pe|V)<<1|(V<<1|j>>>31)&0|re,at=(j<<1|0)&-2|Z,yn(ot|0),at|0}function ks(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0;return pe=w>>31|((w|0)<0?-1:0)<<1,re=((w|0)<0?-1:0)>>31|((w|0)<0?-1:0)<<1,j=R>>31|((R|0)<0?-1:0)<<1,O=((R|0)<0?-1:0)>>31|((R|0)<0?-1:0)<<1,Z=Ro(pe^b|0,re^w|0,pe|0,re|0)|0,V=He()|0,b=j^pe,w=O^re,Ro((Wl(Z,V,Ro(j^S|0,O^R|0,j|0,O|0)|0,He()|0,0)|0)^b|0,(He()|0)^w|0,b|0,w|0)|0}function im(b,w){b=b|0,w=w|0;var S=0,R=0,O=0,j=0;return j=b&65535,O=w&65535,S=wo(O,j)|0,R=b>>>16,b=(S>>>16)+(wo(O,R)|0)|0,O=w>>>16,w=wo(O,j)|0,yn((b>>>16)+(wo(O,R)|0)+(((b&65535)+w|0)>>>16)|0),b+w<<16|S&65535|0|0}function La(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0;return O=b,j=S,S=im(O,j)|0,b=He()|0,yn((wo(w,j)|0)+(wo(R,O)|0)+b|b&0|0),S|0|0|0}function Iu(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0,V=0,Z=0,re=0,pe=0;return O=Fe,Fe=Fe+16|0,Z=O|0,V=w>>31|((w|0)<0?-1:0)<<1,j=((w|0)<0?-1:0)>>31|((w|0)<0?-1:0)<<1,pe=R>>31|((R|0)<0?-1:0)<<1,re=((R|0)<0?-1:0)>>31|((R|0)<0?-1:0)<<1,b=Ro(V^b|0,j^w|0,V|0,j|0)|0,w=He()|0,Wl(b,w,Ro(pe^S|0,re^R|0,pe|0,re|0)|0,He()|0,Z)|0,R=Ro(g[Z>>2]^V|0,g[Z+4>>2]^j|0,V|0,j|0)|0,S=He()|0,Fe=O,yn(S|0),R|0}function cc(b,w,S,R){b=b|0,w=w|0,S=S|0,R=R|0;var O=0,j=0;return j=Fe,Fe=Fe+16|0,O=j|0,Wl(b,w,S,R,O)|0,Fe=j,yn(g[O+4>>2]|0),g[O>>2]|0|0}function Cl(b,w,S){return b=b|0,w=w|0,S=S|0,(S|0)<32?(yn(w>>S|0),b>>>S|(w&(1<<S)-1)<<32-S):(yn(((w|0)<0?-1:0)|0),w>>S-32|0)}function Vr(b,w,S){return b=b|0,w=w|0,S=S|0,(S|0)<32?(yn(w>>>S|0),b>>>S|(w&(1<<S)-1)<<32-S):(yn(0),w>>>S-32|0)}function Jr(b,w,S){return b=b|0,w=w|0,S=S|0,(S|0)<32?(yn(w<<S|(b&(1<<S)-1<<32-S)>>>32-S|0),b<<S):(yn(b<<S-32|0),0)}function Id(b,w,S){return b=b|0,w=w|0,w=ri(w)|0,(w|0)==32&&(w=w+(ri(b)|0)|0),yn(0),w|0}function Jh(b,w){return b=+b,w=+w,b!=b?+w:w!=w?+b:+Ui(+b,+w)}function ef(b,w){return b=+b,w=+w,b!=b?+w:w!=w?+b:+ia(+b,+w)}function Ml(b){return b=+b,b>=0?+vt(b+.5):+go(b-.5)}function dh(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0;if((S|0)>=8192)return Hs(b|0,w|0,S|0)|0,b|0;if(j=b|0,O=b+S|0,(b&3)==(w&3)){for(;b&3;){if(!S)return j|0;ze[b>>0]=ze[w>>0]|0,b=b+1|0,w=w+1|0,S=S-1|0}for(S=O&-4|0,R=S-64|0;(b|0)<=(R|0);)g[b>>2]=g[w>>2],g[b+4>>2]=g[w+4>>2],g[b+8>>2]=g[w+8>>2],g[b+12>>2]=g[w+12>>2],g[b+16>>2]=g[w+16>>2],g[b+20>>2]=g[w+20>>2],g[b+24>>2]=g[w+24>>2],g[b+28>>2]=g[w+28>>2],g[b+32>>2]=g[w+32>>2],g[b+36>>2]=g[w+36>>2],g[b+40>>2]=g[w+40>>2],g[b+44>>2]=g[w+44>>2],g[b+48>>2]=g[w+48>>2],g[b+52>>2]=g[w+52>>2],g[b+56>>2]=g[w+56>>2],g[b+60>>2]=g[w+60>>2],b=b+64|0,w=w+64|0;for(;(b|0)<(S|0);)g[b>>2]=g[w>>2],b=b+4|0,w=w+4|0}else for(S=O-4|0;(b|0)<(S|0);)ze[b>>0]=ze[w>>0]|0,ze[b+1>>0]=ze[w+1>>0]|0,ze[b+2>>0]=ze[w+2>>0]|0,ze[b+3>>0]=ze[w+3>>0]|0,b=b+4|0,w=w+4|0;for(;(b|0)<(O|0);)ze[b>>0]=ze[w>>0]|0,b=b+1|0,w=w+1|0;return j|0}function Pu(b,w,S){b=b|0,w=w|0,S=S|0;var R=0,O=0,j=0,V=0;if(j=b+S|0,w=w&255,(S|0)>=67){for(;b&3;)ze[b>>0]=w,b=b+1|0;for(R=j&-4|0,V=w|w<<8|w<<16|w<<24,O=R-64|0;(b|0)<=(O|0);)g[b>>2]=V,g[b+4>>2]=V,g[b+8>>2]=V,g[b+12>>2]=V,g[b+16>>2]=V,g[b+20>>2]=V,g[b+24>>2]=V,g[b+28>>2]=V,g[b+32>>2]=V,g[b+36>>2]=V,g[b+40>>2]=V,g[b+44>>2]=V,g[b+48>>2]=V,g[b+52>>2]=V,g[b+56>>2]=V,g[b+60>>2]=V,b=b+64|0;for(;(b|0)<(R|0);)g[b>>2]=V,b=b+4|0}for(;(b|0)<(j|0);)ze[b>>0]=w,b=b+1|0;return j-S|0}function Pd(b){return b=+b,b>=0?+vt(b+.5):+go(b-.5)}function Zl(b){b=b|0;var w=0,S=0,R=0;return R=as()|0,S=g[Je>>2]|0,w=S+b|0,(b|0)>0&(w|0)<(S|0)|(w|0)<0?(ss(w|0)|0,ca(12),-1):(w|0)>(R|0)&&!(tu(w|0)|0)?(ca(12),-1):(g[Je>>2]=w,S|0)}return{___divdi3:ks,___muldi3:La,___remdi3:Iu,___uremdi3:cc,_areNeighborCells:Bh,_bitshift64Ashr:Cl,_bitshift64Lshr:Vr,_bitshift64Shl:Jr,_calloc:Pa,_cellAreaKm2:Aa,_cellAreaM2:yu,_cellAreaRads2:xs,_cellToBoundary:vs,_cellToCenterChild:xd,_cellToChildPos:nh,_cellToChildren:_u,_cellToChildrenSize:cn,_cellToLatLng:Sl,_cellToLocalIj:ch,_cellToParent:ac,_cellToVertex:za,_cellToVertexes:Cu,_cellsToDirectedEdge:Ti,_cellsToLinkedMultiPolygon:Ju,_childPosToCell:Mc,_compactCells:jh,_destroyLinkedMultiPolygon:qh,_directedEdgeToBoundary:op,_directedEdgeToCells:_s,_edgeLengthKm:Bf,_edgeLengthM:vu,_edgeLengthRads:mr,_emscripten_replace_memory:Qp,_free:xn,_getBaseCellNumber:Ps,_getDirectedEdgeDestination:th,_getDirectedEdgeOrigin:ip,_getHexagonAreaAvgKm2:Lf,_getHexagonAreaAvgM2:lp,_getHexagonEdgeLengthAvgKm:cp,_getHexagonEdgeLengthAvgM:sh,_getIcosahedronFaces:Vh,_getNumCells:es,_getPentagons:rh,_getRes0Cells:oi,_getResolution:Ma,_greatCircleDistanceKm:Gh,_greatCircleDistanceM:tm,_greatCircleDistanceRads:Tl,_gridDisk:As,_gridDiskDistances:Df,_gridDistance:lA,_gridPathCells:Zh,_gridPathCellsSize:Wh,_gridRing:ll,_gridRingUnsafe:vl,_i64Add:qn,_i64Subtract:Ro,_isPentagon:So,_isResClassIII:bd,_isValidCell:Mn,_isValidDirectedEdge:_d,_isValidVertex:fp,_latLngToCell:sc,_llvm_ctlz_i64:Id,_llvm_maxnum_f64:Jh,_llvm_minnum_f64:ef,_llvm_round_f64:Ml,_localIjToCell:xu,_malloc:Bc,_maxFaceCount:em,_maxGridDiskSize:Ku,_maxPolygonToCellsSize:gs,_maxPolygonToCellsSizeExperimental:Hl,_memcpy:dh,_memset:Pu,_originToDirectedEdges:ma,_pentagonCount:$h,_polygonToCells:fd,_polygonToCellsExperimental:up,_readInt64AsDoubleFromPointer:rm,_res0CellCount:$l,_round:Pd,_sbrk:Zl,_sizeOfCellBoundary:To,_sizeOfCoordIJ:Su,_sizeOfGeoLoop:kc,_sizeOfGeoPolygon:Xs,_sizeOfH3Index:ka,_sizeOfLatLng:Jo,_sizeOfLinkedGeoPolygon:hp,_uncompactCells:Uh,_uncompactCellsSize:ap,_vertexToLatLng:Os,establishStackSpace:Qu,stackAlloc:Yu,stackRestore:Rf,stackSave:ru}})(Xo,ro,ht);r.___divdi3=Ir.___divdi3,r.___muldi3=Ir.___muldi3,r.___remdi3=Ir.___remdi3,r.___uremdi3=Ir.___uremdi3,r._areNeighborCells=Ir._areNeighborCells,r._bitshift64Ashr=Ir._bitshift64Ashr,r._bitshift64Lshr=Ir._bitshift64Lshr,r._bitshift64Shl=Ir._bitshift64Shl,r._calloc=Ir._calloc,r._cellAreaKm2=Ir._cellAreaKm2,r._cellAreaM2=Ir._cellAreaM2,r._cellAreaRads2=Ir._cellAreaRads2,r._cellToBoundary=Ir._cellToBoundary,r._cellToCenterChild=Ir._cellToCenterChild,r._cellToChildPos=Ir._cellToChildPos,r._cellToChildren=Ir._cellToChildren,r._cellToChildrenSize=Ir._cellToChildrenSize,r._cellToLatLng=Ir._cellToLatLng,r._cellToLocalIj=Ir._cellToLocalIj,r._cellToParent=Ir._cellToParent,r._cellToVertex=Ir._cellToVertex,r._cellToVertexes=Ir._cellToVertexes,r._cellsToDirectedEdge=Ir._cellsToDirectedEdge,r._cellsToLinkedMultiPolygon=Ir._cellsToLinkedMultiPolygon,r._childPosToCell=Ir._childPosToCell,r._compactCells=Ir._compactCells,r._destroyLinkedMultiPolygon=Ir._destroyLinkedMultiPolygon,r._directedEdgeToBoundary=Ir._directedEdgeToBoundary,r._directedEdgeToCells=Ir._directedEdgeToCells,r._edgeLengthKm=Ir._edgeLengthKm,r._edgeLengthM=Ir._edgeLengthM,r._edgeLengthRads=Ir._edgeLengthRads;var If=r._emscripten_replace_memory=Ir._emscripten_replace_memory;r._free=Ir._free,r._getBaseCellNumber=Ir._getBaseCellNumber,r._getDirectedEdgeDestination=Ir._getDirectedEdgeDestination,r._getDirectedEdgeOrigin=Ir._getDirectedEdgeOrigin,r._getHexagonAreaAvgKm2=Ir._getHexagonAreaAvgKm2,r._getHexagonAreaAvgM2=Ir._getHexagonAreaAvgM2,r._getHexagonEdgeLengthAvgKm=Ir._getHexagonEdgeLengthAvgKm,r._getHexagonEdgeLengthAvgM=Ir._getHexagonEdgeLengthAvgM,r._getIcosahedronFaces=Ir._getIcosahedronFaces,r._getNumCells=Ir._getNumCells,r._getPentagons=Ir._getPentagons,r._getRes0Cells=Ir._getRes0Cells,r._getResolution=Ir._getResolution,r._greatCircleDistanceKm=Ir._greatCircleDistanceKm,r._greatCircleDistanceM=Ir._greatCircleDistanceM,r._greatCircleDistanceRads=Ir._greatCircleDistanceRads,r._gridDisk=Ir._gridDisk,r._gridDiskDistances=Ir._gridDiskDistances,r._gridDistance=Ir._gridDistance,r._gridPathCells=Ir._gridPathCells,r._gridPathCellsSize=Ir._gridPathCellsSize,r._gridRing=Ir._gridRing,r._gridRingUnsafe=Ir._gridRingUnsafe,r._i64Add=Ir._i64Add,r._i64Subtract=Ir._i64Subtract,r._isPentagon=Ir._isPentagon,r._isResClassIII=Ir._isResClassIII,r._isValidCell=Ir._isValidCell,r._isValidDirectedEdge=Ir._isValidDirectedEdge,r._isValidVertex=Ir._isValidVertex,r._latLngToCell=Ir._latLngToCell,r._llvm_ctlz_i64=Ir._llvm_ctlz_i64,r._llvm_maxnum_f64=Ir._llvm_maxnum_f64,r._llvm_minnum_f64=Ir._llvm_minnum_f64,r._llvm_round_f64=Ir._llvm_round_f64,r._localIjToCell=Ir._localIjToCell,r._malloc=Ir._malloc,r._maxFaceCount=Ir._maxFaceCount,r._maxGridDiskSize=Ir._maxGridDiskSize,r._maxPolygonToCellsSize=Ir._maxPolygonToCellsSize,r._maxPolygonToCellsSizeExperimental=Ir._maxPolygonToCellsSizeExperimental,r._memcpy=Ir._memcpy,r._memset=Ir._memset,r._originToDirectedEdges=Ir._originToDirectedEdges,r._pentagonCount=Ir._pentagonCount,r._polygonToCells=Ir._polygonToCells,r._polygonToCellsExperimental=Ir._polygonToCellsExperimental,r._readInt64AsDoubleFromPointer=Ir._readInt64AsDoubleFromPointer,r._res0CellCount=Ir._res0CellCount,r._round=Ir._round,r._sbrk=Ir._sbrk,r._sizeOfCellBoundary=Ir._sizeOfCellBoundary,r._sizeOfCoordIJ=Ir._sizeOfCoordIJ,r._sizeOfGeoLoop=Ir._sizeOfGeoLoop,r._sizeOfGeoPolygon=Ir._sizeOfGeoPolygon,r._sizeOfH3Index=Ir._sizeOfH3Index,r._sizeOfLatLng=Ir._sizeOfLatLng,r._sizeOfLinkedGeoPolygon=Ir._sizeOfLinkedGeoPolygon,r._uncompactCells=Ir._uncompactCells,r._uncompactCellsSize=Ir._uncompactCellsSize,r._vertexToLatLng=Ir._vertexToLatLng,r.establishStackSpace=Ir.establishStackSpace;var bc=r.stackAlloc=Ir.stackAlloc,Gs=r.stackRestore=Ir.stackRestore,hd=r.stackSave=Ir.stackSave;if(r.asm=Ir,r.cwrap=ve,r.setValue=te,r.getValue=ne,_i){Ca(_i)||(_i=y(_i));{eo();var Zu=function(le){le.byteLength&&(le=new Uint8Array(le)),Pt.set(le,Q),r.memoryInitializerRequest&&delete r.memoryInitializerRequest.response,$o()},Pf=function(){T(_i,Zu,function(){throw"could not load memory initializer "+_i})},rr=Qi(_i);if(rr)Zu(rr.buffer);else if(r.memoryInitializerRequest){var Ul=function(){var le=r.memoryInitializerRequest,ge=le.response;if(le.status!==200&&le.status!==0){var Me=Qi(r.memoryInitializerRequestURL);if(Me)ge=Me.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+le.status+", retrying "+_i),Pf();return}}Zu(ge)};r.memoryInitializerRequest.response?setTimeout(Ul,0):r.memoryInitializerRequest.addEventListener("load",Ul)}else Pf()}}var kh;Ao=function le(){kh||Xu(),kh||(Ao=le)};function Xu(le){if(di>0||(Nn(),di>0))return;function ge(){kh||(kh=!0,!oe&&(jn(),Ur(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Gr()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),ge()},1)):ge()}r.run=Xu;function ut(le){throw r.onAbort&&r.onAbort(le),le+="",i(le),z(le),oe=!0,"abort("+le+"). Build with -s ASSERTIONS=1 for more info."}if(r.abort=ut,r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Xu(),e})(typeof Vu=="object"?Vu:{}),qi="number",Ri=qi,Ev=qi,Gi=qi,Hi=qi,Jl=qi,Xn=qi,hme=[["sizeOfH3Index",qi],["sizeOfLatLng",qi],["sizeOfCellBoundary",qi],["sizeOfGeoLoop",qi],["sizeOfGeoPolygon",qi],["sizeOfLinkedGeoPolygon",qi],["sizeOfCoordIJ",qi],["readInt64AsDoubleFromPointer",qi],["isValidCell",Ev,[Gi,Hi]],["latLngToCell",Ri,[qi,qi,Jl,Xn]],["cellToLatLng",Ri,[Gi,Hi,Xn]],["cellToBoundary",Ri,[Gi,Hi,Xn]],["maxGridDiskSize",Ri,[qi,Xn]],["gridDisk",Ri,[Gi,Hi,qi,Xn]],["gridDiskDistances",Ri,[Gi,Hi,qi,Xn,Xn]],["gridRing",Ri,[Gi,Hi,qi,Xn]],["gridRingUnsafe",Ri,[Gi,Hi,qi,Xn]],["maxPolygonToCellsSize",Ri,[Xn,Jl,qi,Xn]],["polygonToCells",Ri,[Xn,Jl,qi,Xn]],["maxPolygonToCellsSizeExperimental",Ri,[Xn,Jl,qi,Xn]],["polygonToCellsExperimental",Ri,[Xn,Jl,qi,qi,qi,Xn]],["cellsToLinkedMultiPolygon",Ri,[Xn,qi,Xn]],["destroyLinkedMultiPolygon",null,[Xn]],["compactCells",Ri,[Xn,Xn,qi,qi]],["uncompactCells",Ri,[Xn,qi,qi,Xn,qi,Jl]],["uncompactCellsSize",Ri,[Xn,qi,qi,Jl,Xn]],["isPentagon",Ev,[Gi,Hi]],["isResClassIII",Ev,[Gi,Hi]],["getBaseCellNumber",qi,[Gi,Hi]],["getResolution",qi,[Gi,Hi]],["maxFaceCount",Ri,[Gi,Hi,Xn]],["getIcosahedronFaces",Ri,[Gi,Hi,Xn]],["cellToParent",Ri,[Gi,Hi,Jl,Xn]],["cellToChildren",Ri,[Gi,Hi,Jl,Xn]],["cellToCenterChild",Ri,[Gi,Hi,Jl,Xn]],["cellToChildrenSize",Ri,[Gi,Hi,Jl,Xn]],["cellToChildPos",Ri,[Gi,Hi,Jl,Xn]],["childPosToCell",Ri,[qi,qi,Gi,Hi,Jl,Xn]],["areNeighborCells",Ri,[Gi,Hi,Gi,Hi,Xn]],["cellsToDirectedEdge",Ri,[Gi,Hi,Gi,Hi,Xn]],["getDirectedEdgeOrigin",Ri,[Gi,Hi,Xn]],["getDirectedEdgeDestination",Ri,[Gi,Hi,Xn]],["isValidDirectedEdge",Ev,[Gi,Hi]],["directedEdgeToCells",Ri,[Gi,Hi,Xn]],["originToDirectedEdges",Ri,[Gi,Hi,Xn]],["directedEdgeToBoundary",Ri,[Gi,Hi,Xn]],["gridDistance",Ri,[Gi,Hi,Gi,Hi,Xn]],["gridPathCells",Ri,[Gi,Hi,Gi,Hi,Xn]],["gridPathCellsSize",Ri,[Gi,Hi,Gi,Hi,Xn]],["cellToLocalIj",Ri,[Gi,Hi,Gi,Hi,qi,Xn]],["localIjToCell",Ri,[Gi,Hi,Xn,qi,Xn]],["getHexagonAreaAvgM2",Ri,[Jl,Xn]],["getHexagonAreaAvgKm2",Ri,[Jl,Xn]],["getHexagonEdgeLengthAvgM",Ri,[Jl,Xn]],["getHexagonEdgeLengthAvgKm",Ri,[Jl,Xn]],["greatCircleDistanceM",qi,[Xn,Xn]],["greatCircleDistanceKm",qi,[Xn,Xn]],["greatCircleDistanceRads",qi,[Xn,Xn]],["cellAreaM2",Ri,[Gi,Hi,Xn]],["cellAreaKm2",Ri,[Gi,Hi,Xn]],["cellAreaRads2",Ri,[Gi,Hi,Xn]],["edgeLengthM",Ri,[Gi,Hi,Xn]],["edgeLengthKm",Ri,[Gi,Hi,Xn]],["edgeLengthRads",Ri,[Gi,Hi,Xn]],["getNumCells",Ri,[Jl,Xn]],["getRes0Cells",Ri,[Xn]],["res0CellCount",qi],["getPentagons",Ri,[qi,Xn]],["pentagonCount",qi],["cellToVertex",Ri,[Gi,Hi,qi,Xn]],["cellToVertexes",Ri,[Gi,Hi,Xn]],["vertexToLatLng",Ri,[Gi,Hi,Xn]],["isValidVertex",Ev,[Gi,Hi]]],fme=0,dme=1,pme=2,mme=3,Ame=4,gme=5,_me=6,yme=7,vme=8,xme=9,bme=10,wme=11,Sme=12,Tme=13,Eme=14,Cme=15,xc={};xc[fme]="Success";xc[dme]="The operation failed but a more specific error is not available";xc[pme]="Argument was outside of acceptable range";xc[mme]="Latitude or longitude arguments were outside of acceptable range";xc[Ame]="Resolution argument was outside of acceptable range";xc[gme]="Cell argument was not valid";xc[_me]="Directed edge argument was not valid";xc[yme]="Undirected edge argument was not valid";xc[vme]="Vertex argument was not valid";xc[xme]="Pentagon distortion was encountered";xc[bme]="Duplicate input";xc[wme]="Cell arguments were not neighbors";xc[Sme]="Cell arguments had incompatible resolutions";xc[Tme]="Memory allocation failed";xc[Eme]="Bounds of provided memory were insufficient";xc[Cme]="Mode or flags argument was not valid";var Mme=1e3,Ime=1001,nj=1002,L2={};L2[Mme]="Unknown unit";L2[Ime]="Array length out of bounds";L2[nj]="Got unexpected null value for H3 index";var Pme="Unknown error";function ij(e,r,a){var l=a&&"value"in a,m=new Error((e[r]||Pme)+" (code: "+r+(l?", value: "+a.value:"")+")");return m.code=r,m}function Rme(e,r){var a=arguments.length===2?{value:r}:{};return ij(xc,e,a)}function Dme(e,r){var a=arguments.length===2?{value:r}:{};return ij(L2,e,a)}function oj(e){if(e!==0)throw Rme(e)}var Yp={};hme.forEach(function(r){Yp[r[0]]=Vu.cwrap.apply(Vu,r)});var R_=16,Ome=4,Ew=8,s3=Yp.sizeOfH3Index(),kme=Yp.sizeOfLatLng(),zme=Yp.sizeOfCellBoundary();Yp.sizeOfGeoPolygon();Yp.sizeOfGeoLoop();Yp.sizeOfLinkedGeoPolygon();Yp.sizeOfCoordIJ();function Lme(e){if(!e)throw Dme(nj);return e}var Bme=/[^0-9a-fA-F]/;function Fme(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||Bme.test(e))return[0,0];var r=parseInt(e.substring(0,e.length-8),R_),a=parseInt(e.substring(e.length-8),R_);return[a,r]}function RL(e){if(e>=0)return e.toString(R_);e=e&2147483647;var r=aj(8,e.toString(R_)),a=(parseInt(r[0],R_)+8).toString(R_);return r=a+r.substring(1),r}function Nme(e,r){return RL(r)+aj(8,RL(e))}function aj(e,r){for(var a=e-r.length,l="",m=0;m<a;m++)l+="0";return l=l+r,l}function jme(e,r){r===void 0&&(r=0);var a=Vu.getValue(e+s3*r,"i32"),l=Vu.getValue(e+s3*r+Ome,"i32");return l?Nme(a,l):null}function DL(e){return qme(Vu.getValue(e,"double"))}function Ume(e){return[DL(e+Ew),DL(e)]}function Vme(e,r,a){for(var l=Vu.getValue(e,"i32"),m=e+Ew,y=[],T=Ume,i=0;i<l*2;i+=2)y.push(T(m+Ew*i));return y.push(y[0]),y}function $me(e,r,a){var l=Vu._malloc(kme);Vu.HEAPF64.set([e,r].map(Hme),l/Ew);var m=Vu._malloc(s3);try{return oj(Yp.latLngToCell(l,a,m)),Lme(jme(m))}finally{Vu._free(m),Vu._free(l)}}function Gme(e,r){var a=Vu._malloc(zme),l=Fme(e),m=l[0],y=l[1];try{return oj(Yp.cellToBoundary(m,y,a)),Vme(a,r,r)}finally{Vu._free(a)}}function Hme(e){return e*Math.PI/180}function qme(e){return e*180/Math.PI}var Ob={exports:{}},Wme=Ob.exports,OL;function Zme(){return OL||(OL=1,(function(e,r){(function(a,l){e.exports=l()})(Wme,(function(){var a,l,m;function y(i,z){if(!a)a=z;else if(!l)l=z;else{var B="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+l+")(sharedChunk); self.onerror = null;",F={};a(F),m=z(F),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([B],{type:"text/javascript"})))}}y(["exports"],(function(i){var z=1e-6,B=typeof Float32Array<"u"?Float32Array:Array;function F(s,t){var o=t[0],u=t[1],f=t[2],A=t[3],v=o*A-f*u;return v?(s[0]=A*(v=1/v),s[1]=-u*v,s[2]=-f*v,s[3]=o*v,s):null}function G(){var s=new B(9);return B!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function Q(s,t){var o=t[0],u=t[1],f=t[2],A=t[3],v=t[4],C=t[5],P=t[6],k=t[7],U=t[8];return s[0]=v*U-C*k,s[1]=f*k-u*U,s[2]=u*C-f*v,s[3]=C*P-A*U,s[4]=o*U-f*P,s[5]=f*A-o*C,s[6]=A*k-v*P,s[7]=u*P-o*k,s[8]=o*v-u*A,s}function te(s,t,o){var u=t[0],f=t[1],A=t[2],v=t[3],C=t[4],P=t[5],k=t[6],U=t[7],$=t[8],q=o[0],K=o[1],J=o[2],de=o[3],Ae=o[4],_e=o[5],Ie=o[6],Pe=o[7],ke=o[8];return s[0]=q*u+K*v+J*k,s[1]=q*f+K*C+J*U,s[2]=q*A+K*P+J*$,s[3]=de*u+Ae*v+_e*k,s[4]=de*f+Ae*C+_e*U,s[5]=de*A+Ae*P+_e*$,s[6]=Ie*u+Pe*v+ke*k,s[7]=Ie*f+Pe*C+ke*U,s[8]=Ie*A+Pe*P+ke*$,s}function ne(){var s=new B(16);return B!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s}function oe(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function ue(s,t){var o=t[0],u=t[1],f=t[2],A=t[3],v=t[4],C=t[5],P=t[6],k=t[7],U=t[8],$=t[9],q=t[10],K=t[11],J=t[12],de=t[13],Ae=t[14],_e=t[15],Ie=o*C-u*v,Pe=o*P-f*v,ke=o*k-A*v,Ye=u*P-f*C,Qe=u*k-A*C,tt=f*k-A*P,it=U*de-$*J,ct=U*Ae-q*J,$t=U*_e-K*J,mt=$*Ae-q*de,Wt=$*_e-K*de,sr=q*_e-K*Ae,Kt=Ie*sr-Pe*Wt+ke*mt+Ye*$t-Qe*ct+tt*it;return Kt?(s[0]=(C*sr-P*Wt+k*mt)*(Kt=1/Kt),s[1]=(f*Wt-u*sr-A*mt)*Kt,s[2]=(de*tt-Ae*Qe+_e*Ye)*Kt,s[3]=(q*Qe-$*tt-K*Ye)*Kt,s[4]=(P*$t-v*sr-k*ct)*Kt,s[5]=(o*sr-f*$t+A*ct)*Kt,s[6]=(Ae*ke-J*tt-_e*Pe)*Kt,s[7]=(U*tt-q*ke+K*Pe)*Kt,s[8]=(v*Wt-C*$t+k*it)*Kt,s[9]=(u*$t-o*Wt-A*it)*Kt,s[10]=(J*Qe-de*ke+_e*Ie)*Kt,s[11]=($*ke-U*Qe-K*Ie)*Kt,s[12]=(C*ct-v*mt-P*it)*Kt,s[13]=(o*mt-u*ct+f*it)*Kt,s[14]=(de*Pe-J*Ye-Ae*Ie)*Kt,s[15]=(U*Ye-$*Pe+q*Ie)*Kt,s):null}function ye(s,t,o){var u=t[0],f=t[1],A=t[2],v=t[3],C=t[4],P=t[5],k=t[6],U=t[7],$=t[8],q=t[9],K=t[10],J=t[11],de=t[12],Ae=t[13],_e=t[14],Ie=t[15],Pe=o[0],ke=o[1],Ye=o[2],Qe=o[3];return s[0]=Pe*u+ke*C+Ye*$+Qe*de,s[1]=Pe*f+ke*P+Ye*q+Qe*Ae,s[2]=Pe*A+ke*k+Ye*K+Qe*_e,s[3]=Pe*v+ke*U+Ye*J+Qe*Ie,s[4]=(Pe=o[4])*u+(ke=o[5])*C+(Ye=o[6])*$+(Qe=o[7])*de,s[5]=Pe*f+ke*P+Ye*q+Qe*Ae,s[6]=Pe*A+ke*k+Ye*K+Qe*_e,s[7]=Pe*v+ke*U+Ye*J+Qe*Ie,s[8]=(Pe=o[8])*u+(ke=o[9])*C+(Ye=o[10])*$+(Qe=o[11])*de,s[9]=Pe*f+ke*P+Ye*q+Qe*Ae,s[10]=Pe*A+ke*k+Ye*K+Qe*_e,s[11]=Pe*v+ke*U+Ye*J+Qe*Ie,s[12]=(Pe=o[12])*u+(ke=o[13])*C+(Ye=o[14])*$+(Qe=o[15])*de,s[13]=Pe*f+ke*P+Ye*q+Qe*Ae,s[14]=Pe*A+ke*k+Ye*K+Qe*_e,s[15]=Pe*v+ke*U+Ye*J+Qe*Ie,s}function we(s,t,o){var u,f,A,v,C,P,k,U,$,q,K,J,de=o[0],Ae=o[1],_e=o[2];return t===s?(s[12]=t[0]*de+t[4]*Ae+t[8]*_e+t[12],s[13]=t[1]*de+t[5]*Ae+t[9]*_e+t[13],s[14]=t[2]*de+t[6]*Ae+t[10]*_e+t[14],s[15]=t[3]*de+t[7]*Ae+t[11]*_e+t[15]):(f=t[1],A=t[2],v=t[3],C=t[4],P=t[5],k=t[6],U=t[7],$=t[8],q=t[9],K=t[10],J=t[11],s[0]=u=t[0],s[1]=f,s[2]=A,s[3]=v,s[4]=C,s[5]=P,s[6]=k,s[7]=U,s[8]=$,s[9]=q,s[10]=K,s[11]=J,s[12]=u*de+C*Ae+$*_e+t[12],s[13]=f*de+P*Ae+q*_e+t[13],s[14]=A*de+k*Ae+K*_e+t[14],s[15]=v*de+U*Ae+J*_e+t[15]),s}function ve(s,t,o){var u=o[0],f=o[1],A=o[2];return s[0]=t[0]*u,s[1]=t[1]*u,s[2]=t[2]*u,s[3]=t[3]*u,s[4]=t[4]*f,s[5]=t[5]*f,s[6]=t[6]*f,s[7]=t[7]*f,s[8]=t[8]*A,s[9]=t[9]*A,s[10]=t[10]*A,s[11]=t[11]*A,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s}function Ce(s,t,o){var u=Math.sin(o),f=Math.cos(o),A=t[4],v=t[5],C=t[6],P=t[7],k=t[8],U=t[9],$=t[10],q=t[11];return t!==s&&(s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[4]=A*f+k*u,s[5]=v*f+U*u,s[6]=C*f+$*u,s[7]=P*f+q*u,s[8]=k*f-A*u,s[9]=U*f-v*u,s[10]=$*f-C*u,s[11]=q*f-P*u,s}function Ee(s,t,o){var u=Math.sin(o),f=Math.cos(o),A=t[0],v=t[1],C=t[2],P=t[3],k=t[8],U=t[9],$=t[10],q=t[11];return t!==s&&(s[4]=t[4],s[5]=t[5],s[6]=t[6],s[7]=t[7],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=A*f-k*u,s[1]=v*f-U*u,s[2]=C*f-$*u,s[3]=P*f-q*u,s[8]=A*u+k*f,s[9]=v*u+U*f,s[10]=C*u+$*f,s[11]=P*u+q*f,s}function Be(s,t,o){var u=Math.sin(o),f=Math.cos(o),A=t[0],v=t[1],C=t[2],P=t[3],k=t[4],U=t[5],$=t[6],q=t[7];return t!==s&&(s[8]=t[8],s[9]=t[9],s[10]=t[10],s[11]=t[11],s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15]),s[0]=A*f+k*u,s[1]=v*f+U*u,s[2]=C*f+$*u,s[3]=P*f+q*u,s[4]=k*f-A*u,s[5]=U*f-v*u,s[6]=$*f-C*u,s[7]=q*f-P*u,s}function Ke(s,t){return s[0]=t[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=t[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=t[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function st(s,t,o){var u,f,A,v=o[0],C=o[1],P=o[2],k=Math.sqrt(v*v+C*C+P*P);return k<z?null:(v*=k=1/k,C*=k,P*=k,u=Math.sin(t),f=Math.cos(t),s[0]=v*v*(A=1-f)+f,s[1]=C*v*A+P*u,s[2]=P*v*A-C*u,s[3]=0,s[4]=v*C*A-P*u,s[5]=C*C*A+f,s[6]=P*C*A+v*u,s[7]=0,s[8]=v*P*A+C*u,s[9]=C*P*A-v*u,s[10]=P*P*A+f,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}function dt(s,t){var o=t[0],u=t[1],f=t[2],A=t[3],v=o+o,C=u+u,P=f+f,k=o*v,U=u*v,$=u*C,q=f*v,K=f*C,J=f*P,de=A*v,Ae=A*C,_e=A*P;return s[0]=1-$-J,s[1]=U+_e,s[2]=q-Ae,s[3]=0,s[4]=U-_e,s[5]=1-k-J,s[6]=K+de,s[7]=0,s[8]=q+Ae,s[9]=K-de,s[10]=1-k-$,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}var bt=ye;function ht(){var s=new B(3);return B!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function Re(s){var t=new B(3);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t}function Pt(s){var t=s[0],o=s[1],u=s[2];return Math.sqrt(t*t+o*o+u*u)}function wt(s,t,o){var u=new B(3);return u[0]=s,u[1]=t,u[2]=o,u}function Et(s,t,o,u){return s[0]=t,s[1]=o,s[2]=u,s}function et(s,t,o){return s[0]=t[0]+o[0],s[1]=t[1]+o[1],s[2]=t[2]+o[2],s}function Zt(s,t,o){return s[0]=t[0]-o[0],s[1]=t[1]-o[1],s[2]=t[2]-o[2],s}function ir(s,t,o){return s[0]=t[0]*o[0],s[1]=t[1]*o[1],s[2]=t[2]*o[2],s}function or(s,t,o){return s[0]=Math.min(t[0],o[0]),s[1]=Math.min(t[1],o[1]),s[2]=Math.min(t[2],o[2]),s}function ft(s,t,o){return s[0]=Math.max(t[0],o[0]),s[1]=Math.max(t[1],o[1]),s[2]=Math.max(t[2],o[2]),s}function Vt(s,t,o){return s[0]=t[0]*o,s[1]=t[1]*o,s[2]=t[2]*o,s}function Jt(s,t,o,u){return s[0]=t[0]+o[0]*u,s[1]=t[1]+o[1]*u,s[2]=t[2]+o[2]*u,s}function Cr(s,t){var o=t[0]-s[0],u=t[1]-s[1],f=t[2]-s[2];return o*o+u*u+f*f}function ln(s){var t=s[0],o=s[1],u=s[2];return t*t+o*o+u*u}function tn(s,t){return s[0]=-t[0],s[1]=-t[1],s[2]=-t[2],s}function Hr(s,t){var o=t[0],u=t[1],f=t[2],A=o*o+u*u+f*f;return A>0&&(A=1/Math.sqrt(A)),s[0]=t[0]*A,s[1]=t[1]*A,s[2]=t[2]*A,s}function Nn(s,t){return s[0]*t[0]+s[1]*t[1]+s[2]*t[2]}function jn(s,t,o){var u=t[0],f=t[1],A=t[2],v=o[0],C=o[1],P=o[2];return s[0]=f*P-A*C,s[1]=A*v-u*P,s[2]=u*C-f*v,s}function Ur(s,t,o,u){var f=t[0],A=t[1],v=t[2];return s[0]=f+u*(o[0]-f),s[1]=A+u*(o[1]-A),s[2]=v+u*(o[2]-v),s}function Gr(s,t,o){var u=t[0],f=t[1],A=t[2],v=o[3]*u+o[7]*f+o[11]*A+o[15];return s[0]=(o[0]*u+o[4]*f+o[8]*A+o[12])/(v=v||1),s[1]=(o[1]*u+o[5]*f+o[9]*A+o[13])/v,s[2]=(o[2]*u+o[6]*f+o[10]*A+o[14])/v,s}function Sn(s,t,o){var u=t[0],f=t[1],A=t[2];return s[0]=u*o[0]+f*o[3]+A*o[6],s[1]=u*o[1]+f*o[4]+A*o[7],s[2]=u*o[2]+f*o[5]+A*o[8],s}function Tr(s,t,o){var u=o[0],f=o[1],A=o[2],v=o[3],C=t[0],P=t[1],k=t[2],U=f*k-A*P,$=A*C-u*k,q=u*P-f*C;return s[0]=C+v*(U+=U)+f*(q+=q)-A*($+=$),s[1]=P+v*$+A*U-u*q,s[2]=k+v*q+u*$-f*U,s}function Zi(s){return s[0]=0,s[1]=0,s[2]=0,s}function wn(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]}var Rn=Zt,mo=ir,di=Pt;function Ao(){var s=new B(4);return B!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0,s[3]=0),s}function eo(s,t,o){return s[0]=t[0]*o,s[1]=t[1]*o,s[2]=t[2]*o,s[3]=t[3]*o,s}function $o(s,t){var o=t[0],u=t[1],f=t[2],A=t[3],v=o*o+u*u+f*f+A*A;return v>0&&(v=1/Math.sqrt(v)),s[0]=o*v,s[1]=u*v,s[2]=f*v,s[3]=A*v,s}function _i(s,t,o){var u=t[0],f=t[1],A=t[2],v=t[3];return s[0]=o[0]*u+o[4]*f+o[8]*A+o[12]*v,s[1]=o[1]*u+o[5]*f+o[9]*A+o[13]*v,s[2]=o[2]*u+o[6]*f+o[10]*A+o[14]*v,s[3]=o[3]*u+o[7]*f+o[11]*A+o[15]*v,s}function Bn(){var s=new B(4);return B!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function Ca(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function Io(s,t,o){o*=.5;var u=t[0],f=t[1],A=t[2],v=t[3],C=Math.sin(o),P=Math.cos(o);return s[0]=u*P+v*C,s[1]=f*P+A*C,s[2]=A*P-f*C,s[3]=v*P-u*C,s}function Qa(s,t,o){o*=.5;var u=t[0],f=t[1],A=t[2],v=t[3],C=Math.sin(o),P=Math.cos(o);return s[0]=u*P-A*C,s[1]=f*P+v*C,s[2]=A*P+u*C,s[3]=v*P-f*C,s}ht(),Ao();var ao,ai,Po,to=$o,Va=(ao=ht(),ai=wt(1,0,0),Po=wt(0,1,0),function(s,t,o){var u=Nn(t,o);return u<-.999999?(jn(ao,ai,t),di(ao)<1e-6&&jn(ao,Po,t),Hr(ao,ao),(function(f,A,v){v*=.5;var C=Math.sin(v);f[0]=C*A[0],f[1]=C*A[1],f[2]=C*A[2],f[3]=Math.cos(v)})(s,ao,Math.PI),s):u>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(jn(ao,t,o),s[0]=ao[0],s[1]=ao[1],s[2]=ao[2],s[3]=1+u,to(s,s))});function Mi(){var s=new B(2);return B!=Float32Array&&(s[0]=0,s[1]=0),s}function os(s,t){var o=new B(2);return o[0]=s,o[1]=t,o}function yl(s,t,o){return s[0]=t,s[1]=o,s}function al(s,t,o){return s[0]=t[0]+o[0],s[1]=t[1]+o[1],s}function $n(s,t,o){return s[0]=t[0]-o[0],s[1]=t[1]-o[1],s}function Qi(s,t,o){return s[0]=t[0]*o,s[1]=t[1]*o,s}function Xo(s){var t=s[0],o=s[1];return Math.sqrt(t*t+o*o)}function ro(s,t){var o=t[0],u=t[1],f=o*o+u*u;return f>0&&(f=1/Math.sqrt(f)),s[0]=t[0]*f,s[1]=t[1]*f,s}function Ir(s,t){return s[0]*t[0]+s[1]*t[1]}Bn(),Bn(),G();var If,bc,Gs=$n;function hd(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}Mi();var Zu=(function(){if(bc)return If;function s(t,o,u,f){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(f-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=o,this.p2x=u,this.p2y=f}return bc=1,If=s,s.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,o){if(o===void 0&&(o=1e-6),t<0)return 0;if(t>1)return 1;for(var u=t,f=0;f<8;f++){var A=this.sampleCurveX(u)-t;if(Math.abs(A)<o)return u;var v=this.sampleCurveDerivativeX(u);if(Math.abs(v)<1e-6)break;u-=A/v}var C=0,P=1;for(u=t,f=0;f<20&&(A=this.sampleCurveX(u),!(Math.abs(A-t)<o));f++)t>A?C=u:P=u,u=.5*(P-C)+C;return u},solve:function(t,o){return this.sampleCurveY(this.solveCurveX(t,o))}},If})(),Pf=hd(Zu);function rr(s,t){this.x=s,this.y=t}function Ul(s,t){if(Array.isArray(s)){if(!Array.isArray(t)||s.length!==t.length)return!1;for(let o=0;o<s.length;o++)if(!Ul(s[o],t[o]))return!1;return!0}if(typeof s=="object"&&s!==null&&t!==null){if(typeof t!="object"||Object.keys(s).length!==Object.keys(t).length)return!1;for(const o in s)if(!Ul(s[o],t[o]))return!1;return!0}return s===t}rr.prototype={clone(){return new rr(this.x,this.y)},add(s){return this.clone()._add(s)},sub(s){return this.clone()._sub(s)},multByPoint(s){return this.clone()._multByPoint(s)},divByPoint(s){return this.clone()._divByPoint(s)},mult(s){return this.clone()._mult(s)},div(s){return this.clone()._div(s)},rotate(s){return this.clone()._rotate(s)},rotateAround(s,t){return this.clone()._rotateAround(s,t)},matMult(s){return this.clone()._matMult(s)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(s){return this.x===s.x&&this.y===s.y},dist(s){return Math.sqrt(this.distSqr(s))},distSqr(s){const t=s.x-this.x,o=s.y-this.y;return t*t+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith(s){return this.angleWithSep(s.x,s.y)},angleWithSep(s,t){return Math.atan2(this.x*t-this.y*s,this.x*s+this.y*t)},_matMult(s){const t=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=t,this},_add(s){return this.x+=s.x,this.y+=s.y,this},_sub(s){return this.x-=s.x,this.y-=s.y,this},_mult(s){return this.x*=s,this.y*=s,this},_div(s){return this.x/=s,this.y/=s,this},_multByPoint(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint(s){return this.x/=s.x,this.y/=s.y,this},_unit(){return this._div(this.mag()),this},_perp(){const s=this.y;return this.y=this.x,this.x=-s,this},_rotate(s){const t=Math.cos(s),o=Math.sin(s),u=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=u,this},_rotateAround(s,t){const o=Math.cos(s),u=Math.sin(s),f=t.y+u*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-u*(this.y-t.y),this.y=f,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:rr},rr.convert=function(s){if(s instanceof rr)return s;if(Array.isArray(s))return new rr(+s[0],+s[1]);if(s.x!==void 0&&s.y!==void 0)return new rr(+s.x,+s.y);throw new Error("Expected [x, y] or {x, y} point format")};const kh=Math.PI/180,Xu=180/Math.PI;function ut(s){return s*kh}function le(s){return s*Xu}const ge=[[0,0],[1,0],[1,1],[0,1]];function Me(s){if(s<=0)return 0;if(s>=1)return 1;const t=s*s,o=t*s;return 4*(s<.5?o:3*(s-t)+o-.75)}function ze(s,t,o,u){const f=new Pf(s,t,o,u);return function(A){return f.solve(A)}}const g=ze(.25,.1,.25,1);function ce(s,t,o){return Math.min(o,Math.max(t,s))}function At(s,t,o){return(o=ce((o-s)/(t-s),0,1))*o*(3-2*o)}function Je(s,t,o){const u=o-t,f=((s-t)%u+u)%u+t;return f===t?o:f}function vt(s,t,o){if(!s.length)return o(null,[]);let u=s.length;const f=new Array(s.length);let A=null;s.forEach(((v,C)=>{t(v,((P,k)=>{P&&(A=P),f[C]=k,--u==0&&o(A,f)}))}))}let Lt=1;function kt(){return Lt++}function Fr(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log2(s)))}function Dr(s,t){s.forEach((o=>{t[o]&&(t[o]=t[o].bind(t))}))}function wr(s,t,o){const u={};for(const f in s)u[f]=t.call(this,s[f],f,s);return u}function zn(s,t,o){const u={};for(const f in s)t.call(this,s[f],f,s)&&(u[f]=s[f]);return u}function Un(s){return Array.isArray(s)?s.map(Un):typeof s=="object"&&s?wr(s,Un):s}function Yn(s,t){for(let o=0;o<s.length;o++)if(t.indexOf(s[o])>=0)return!0;return!1}const Ii={};function Fn(s){Ii[s]||(typeof console<"u"&&console.warn(s),Ii[s]=!0)}function go(s,t,o){return(o.y-s.y)*(t.x-s.x)>(t.y-s.y)*(o.x-s.x)}function wo(s){let t=0;for(let o,u,f=0,A=s.length,v=A-1;f<A;v=f++)o=s[f],u=s[v],t+=(u.x-o.x)*(o.y+u.y);return t}function ia([s,t,o]){const u=ut(t+90),f=ut(o);return{x:s*Math.cos(u)*Math.sin(f),y:s*Math.sin(u)*Math.sin(f),z:s*Math.cos(f),azimuthal:t,polar:o}}function Ui(s){return(typeof self<"u"||s!==void 0)&&typeof WorkerGlobalScope<"u"&&(s!==void 0?s:self)instanceof WorkerGlobalScope}function ri(s){const t={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((o,u,f,A)=>{const v=f||A;return t[u]=!v||v.toLowerCase(),""})),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let yn=null;function He(s,t){return[s[4*t],s[4*t+1],s[4*t+2],s[4*t+3]]}function mn(s,t,o,u){for(;t<o;){const f=t+o>>1;s[f]<u?t=f+1:o=f}return t}function ca(s,t,o,u){for(;t<o;){const f=t+o>>1;s[f]<=u?t=f+1:o=f}return t}function as(s){return s>0?1/(1.001-s):1+s}function Hs(s){return s>0?1-1/(1.001-s):-s}function tu(s,t,o){return(s-t.min)*(o.max-o.min)/(t.max-t.min)+o.min}const ss={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ss.API_URL)return null;try{const s=new URL(ss.API_URL);return s.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":s.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.3.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Fe(s){return ss.API_URL_REGEX.test(s)}function Qp(s){return ss.API_SPRITE_REGEX.test(s)}let Yu,ru,Rf,Qu,Ku,As;function Df(){return Yu==null&&(Yu=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Yu}const Vl={now:()=>Qu!==void 0?Qu:performance.now(),setNow(s){Qu=s},restoreNow(){Qu=void 0},frame(s){const t=requestAnimationFrame(s);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(s,t=0){const{width:o,height:u}=s;Ku||(Ku=document.createElement("canvas"));const f=Ku.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(o>Ku.width||u>Ku.height)&&(Ku.width=o,Ku.height=u),f.clearRect(-t,-t,o+2*t,u+2*t),f.drawImage(s,0,0,o,u),f.getImageData(-t,-t,o+2*t,u+2*t)},resolveURL:s=>(ru||(ru=document.createElement("a")),ru.href=s,ru.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Rf==null&&(Rf=window.matchMedia("(prefers-reduced-motion: reduce)")),Rf.matches)},hasCanvasFingerprintNoise(){if(As!==void 0)return As;if(!Df())return As=!1,!1;const s=new OffscreenCanvas(85,1),t=s.getContext("2d",{willReadFrequently:!0});let o=0;for(let f=0;f<s.width;++f)t.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,t.fillRect(f,0,1,1);const u=t.getImageData(0,0,s.width,s.height);o=0;for(let f=0;f<u.data.length;++f)if(f%4!=3&&o++!==u.data[f])return As=!0,!0;return As=!1,!1}};function sl(s,t){const o=s.indexOf("?");if(o<0)return`${s}?${new URLSearchParams(t).toString()}`;const u=new URLSearchParams(s.slice(o));for(const f in t)u.set(f,t[f]);return`${s.slice(0,o)}?${u.toString()}`}function oa(s,t={persistentParams:[]}){const o=s.indexOf("?");if(o<0)return s;const u=new URLSearchParams,f=new URLSearchParams(s.slice(o));for(const v of t.persistentParams){const C=f.get(v);C&&u.set(v,C)}const A=u.toString();return`${s.slice(0,o)}${A.length>0?`?${A}`:""}`}const ll="mapbox-tiles";let vl=500,cl=50;const xl=["language","worldview","jobid"];let gs,nu;function fd(){try{return caches}catch{}}function dd(){const s=fd();s&&gs==null&&(gs=s.open(ll))}let Ju=1/0;const Fo={supported:!1,testSupport:function(s){!ls&&ou&&(eh?au(s):iu=s)}};let iu,ou,ls=!1,eh=!1;const pd=typeof self<"u"?self:{};function au(s){const t=s.createTexture();s.bindTexture(s.TEXTURE_2D,t);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,ou),s.isContextLost())return;Fo.supported=!0}catch{}s.deleteTexture(t),ls=!0}pd.document&&(ou=pd.document.createElement("img"),ou.onload=function(){iu&&au(iu),iu=null,eh=!0},ou.onerror=function(){ls=!0,iu=null},ou.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const zh={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(zh);class su extends Error{constructor(t,o,u){o===401&&Fe(u)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=o,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const $l=Ui()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,oi=function(s,t){if(!(/^file:/.test(o=s.url)||/^file:/.test($l())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return(function(u,f){const A=new AbortController,v=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:$l(),referrerPolicy:u.referrerPolicy,signal:A.signal});let C=!1,P=!1;const k=(U=v.url).indexOf("sku=")>0&&Fe(U);var U;u.type==="json"&&v.headers.set("Accept","application/json");const $=(K,J,de)=>{if(P)return;if(K&&K.message!=="SecurityError"&&Fn(K.toString()),J&&de)return q(J);const Ae=Date.now();fetch(v).then((_e=>{if(_e.ok){const Ie=k?_e.clone():null;return q(_e,Ie,Ae)}return f(new su(_e.statusText,_e.status,u.url))})).catch((_e=>{_e.name!=="AbortError"&&f(new Error(`${_e.message} ${u.url}`))}))},q=(K,J,de)=>{(u.type==="arrayBuffer"?K.arrayBuffer():u.type==="json"?K.json():K.text()).then((Ae=>{P||(J&&de&&(function(_e,Ie,Pe){if(dd(),gs==null)return;const ke=ri(Ie.headers.get("Cache-Control")||"");if(ke["no-store"])return;const Ye={status:Ie.status,statusText:Ie.statusText,headers:new Headers};Ie.headers.forEach(((it,ct)=>Ye.headers.set(ct,it))),ke["max-age"]&&Ye.headers.set("Expires",new Date(Pe+1e3*ke["max-age"]).toUTCString());const Qe=Ye.headers.get("Expires");if(!Qe||new Date(Qe).getTime()-Pe<42e4)return;let tt=oa(_e.url,{persistentParams:xl});if(Ie.status===206){const it=_e.headers.get("Range");if(!it)return;Ye.status=200,tt=sl(tt,{range:it})}(function(it,ct){if(nu===void 0)try{new Response(new ReadableStream),nu=!0}catch{nu=!1}nu?ct(it.body):it.blob().then(ct).catch(($t=>Fn($t.message)))})(Ie,(it=>{const ct=new Response(($t=Ie.status)!==200&&$t!==404&&[101,103,204,205,304].includes($t)?null:it,Ye);var $t;dd(),gs?.then((mt=>mt.put(tt,ct))).catch((mt=>Fn(mt.message)))}))})(v,J,de),C=!0,f(null,Ae,K.headers.get("Cache-Control"),K.headers.get("Expires")))})).catch((Ae=>{P||f(new Error(Ae.message))}))};return k?(function(K,J){if(dd(),gs==null)return J(null);gs.then((de=>{let Ae=oa(K.url,{persistentParams:xl});const _e=K.headers.get("Range");_e&&(Ae=sl(Ae,{range:_e})),de.match(Ae).then((Ie=>{const Pe=(function(ke){if(!ke)return!1;const Ye=new Date(ke.headers.get("Expires")||0),Qe=ri(ke.headers.get("Cache-Control")||"");return Number(Ye)>Date.now()&&!Qe["no-cache"]})(Ie);de.delete(Ae).catch(J),Pe&&de.put(Ae,Ie.clone()).catch(J),J(null,Ie,Pe)})).catch(J)})).catch(J)})(v,$):$(null,null),{cancel:()=>{P=!0,C||A.abort()}}})(s,t);if(Ui(self)&&self.worker.actor)return self.worker.actor.send("getResource",s,t,void 0,!0)}var o;return(function(u,f){const A=new XMLHttpRequest;A.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(A.responseType="arraybuffer");for(const v in u.headers)A.setRequestHeader(v,u.headers[v]);return u.type==="json"&&(A.responseType="text",A.setRequestHeader("Accept","application/json")),A.withCredentials=u.credentials==="include",A.onerror=()=>{f(new Error(A.statusText))},A.onload=()=>{if((A.status>=200&&A.status<300||A.status===0)&&A.response!==null){let v=A.response;if(u.type==="json")try{v=JSON.parse(A.response)}catch(C){return f(C)}f(null,v,A.getResponseHeader("Cache-Control"),A.getResponseHeader("Expires"))}else f(new su(A.statusText,A.status,u.url))},A.send(u.body),{cancel:()=>A.abort()}})(s,t)},wc=function(s,t){return oi(Object.assign(s,{type:"arrayBuffer"}),t)};function Sc(s){const t=document.createElement("a");return t.href=s,t.protocol===location.protocol&&t.host===location.host}const rp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let lu,oc;lu=[],oc=0;const cu=function(s,t){if(Fo.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),oc>=ss.MAX_PARALLEL_IMAGE_REQUESTS){const A={requestParameters:s,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return lu.push(A),A}oc++;let o=!1;const u=()=>{if(!o)for(o=!0,oc--;lu.length&&oc<ss.MAX_PARALLEL_IMAGE_REQUESTS;){const A=lu.shift(),{requestParameters:v,callback:C,cancelled:P}=A;P||(A.cancel=cu(v,C).cancel)}},f=wc(s,((A,v,C,P)=>{u(),A?t(A):v&&(self.createImageBitmap?(function(k,U){const $=new Blob([new Uint8Array(k)],{type:"image/png"});createImageBitmap($).then((q=>{U(null,q)})).catch((q=>{U(new Error(`Could not load image because of ${q.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(v,((k,U)=>t(k,U,C,P))):(function(k,U){const $=new Image;$.onload=()=>{U(null,$),URL.revokeObjectURL($.src),$.onload=null,requestAnimationFrame((()=>{$.src=rp}))},$.onerror=()=>U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new Blob([new Uint8Array(k)],{type:"image/png"});$.src=k.byteLength?URL.createObjectURL(q):rp})(v,((k,U)=>t(k,U,C,P))))}));return{cancel:()=>{f.cancel(),u()}}};var uu,Of,Ms,bl={exports:{}},md={exports:{}},Lh={exports:{}},kf=(function(){if(Ms)return bl.exports;Ms=1;var s=(uu||(uu=1,md.exports=function(o,u){var f,A,v,C,P,k,U,$;for(A=o.length-(f=3&o.length),v=u,P=3432918353,k=461845907,$=0;$<A;)U=255&o.charCodeAt($)|(255&o.charCodeAt(++$))<<8|(255&o.charCodeAt(++$))<<16|(255&o.charCodeAt(++$))<<24,++$,v=27492+(65535&(C=5*(65535&(v=(v^=U=(65535&(U=(U=(65535&U)*P+(((U>>>16)*P&65535)<<16)&4294967295)<<15|U>>>17))*k+(((U>>>16)*k&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(U=0,f){case 3:U^=(255&o.charCodeAt($+2))<<16;case 2:U^=(255&o.charCodeAt($+1))<<8;case 1:v^=U=(65535&(U=(U=(65535&(U^=255&o.charCodeAt($)))*P+(((U>>>16)*P&65535)<<16)&4294967295)<<15|U>>>17))*k+(((U>>>16)*k&65535)<<16)&4294967295}return v^=o.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0}),md.exports),t=(Of||(Of=1,Lh.exports=function(o,u){for(var f,A=o.length,v=u^A,C=0;A>=4;)f=1540483477*(65535&(f=255&o.charCodeAt(C)|(255&o.charCodeAt(++C))<<8|(255&o.charCodeAt(++C))<<16|(255&o.charCodeAt(++C))<<24))+((1540483477*(f>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),A-=4,++C;switch(A){case 3:v^=(255&o.charCodeAt(C+2))<<16;case 2:v^=(255&o.charCodeAt(C+1))<<8;case 1:v=1540483477*(65535&(v^=255&o.charCodeAt(C)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0}),Lh.exports);return bl.exports=s,bl.exports.murmur3=s,bl.exports.murmur2=t,bl.exports})(),Oa=hd(kf);class Ka{constructor(t,...o){Object.assign(this,o[0]||{}),this.type=t}}class ya extends Ka{constructor(t,o={}){super("error",Object.assign({error:t},o))}}function hu(s,t,o){o[s]&&o[s].indexOf(t)!==-1||(o[s]=o[s]||[],o[s].push(t))}function qs(s,t,o){if(o&&o[s]){const u=o[s].indexOf(t);u!==-1&&o[s].splice(u,1)}}class Tc{on(t,o){return this._listeners=this._listeners||{},hu(t,o,this._listeners),this}off(t,o){return qs(t,o,this._listeners),qs(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},hu(t,o,this._oneTimeListeners),this):new Promise((u=>{this.once(t,u)}))}fire(t,o){const u=typeof t=="string"?new Ka(t,o):t,f=u.type;if(this.listens(f)){u.target=this;const A=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const P of A)P.call(this,u);const v=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const P of v)qs(f,P,this._oneTimeListeners),P.call(this,u);const C=this._eventedParent;if(C){const P=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(u,P),C.fire(u)}}else u instanceof ya&&console.error(u.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}class wl{constructor(t){typeof t=="string"?this.name=t:(this.name=t.name,this.iconsetId=t.iconsetId)}static from(t){return new wl(t)}static toString(t){return t.iconsetId?`${t.name}${t.iconsetId}`:t.name}static parse(t){const[o,u]=t.split("");return new wl({name:o,iconsetId:u})}static isEqual(t,o){return t.name===o.name&&t.iconsetId===o.iconsetId}toString(){return wl.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Kp,zf={},np=(function(){if(Kp)return zf;Kp=1;var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(A){return(A=Math.round(A))<0?0:A>255?255:A}function o(A){return t(A[A.length-1]==="%"?parseFloat(A)/100*255:parseInt(A))}function u(A){return(v=A[A.length-1]==="%"?parseFloat(A)/100:parseFloat(A))<0?0:v>1?1:v;var v}function f(A,v,C){return C<0?C+=1:C>1&&(C-=1),6*C<1?A+(v-A)*C*6:2*C<1?v:3*C<2?A+(v-A)*(2/3-C)*6:A}try{zf.parseCSSColor=function(A){var v,C=A.replace(/ /g,"").toLowerCase();if(C in s)return s[C].slice();if(C[0]==="#")return C.length===4?(v=parseInt(C.substr(1),16))>=0&&v<=4095?[(3840&v)>>4|(3840&v)>>8,240&v|(240&v)>>4,15&v|(15&v)<<4,1]:null:C.length===7&&(v=parseInt(C.substr(1),16))>=0&&v<=16777215?[(16711680&v)>>16,(65280&v)>>8,255&v,1]:null;var P=C.indexOf("("),k=C.indexOf(")");if(P!==-1&&k+1===C.length){var U=C.substr(0,P),$=C.substr(P+1,k-(P+1)).split(","),q=1;switch(U){case"rgba":if($.length!==4)return null;q=u($.pop());case"rgb":return $.length!==3?null:[o($[0]),o($[1]),o($[2]),q];case"hsla":if($.length!==4)return null;q=u($.pop());case"hsl":if($.length!==3)return null;var K=(parseFloat($[0])%360+360)%360/360,J=u($[1]),de=u($[2]),Ae=de<=.5?de*(J+1):de+J-de*J,_e=2*de-Ae;return[t(255*f(_e,Ae,K+1/3)),t(255*f(_e,Ae,K)),t(255*f(_e,Ae,K-1/3)),q];default:return null}}return null}}catch{}return zf})();class vi{constructor(t,o,u,f=1){this.r=t,this.g=o,this.b=u,this.a=f}static parse(t){if(!t)return;if(t instanceof vi)return t;if(typeof t!="string")return;const o=np.parseCSSColor(t);return o?new vi(o[0]/255,o[1]/255,o[2]/255,o[3]):void 0}toString(){const[t,o,u,f]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*t)},${Math.round(255*o)},${Math.round(255*u)},${f})`}toNonPremultipliedRenderColor(t){const{r:o,g:u,b:f,a:A}=this;return new Jp(t,o,u,f,A)}toPremultipliedRenderColor(t){const{r:o,g:u,b:f,a:A}=this;return new Ad(t,o*A,u*A,f*A,A)}clone(){return new vi(this.r,this.g,this.b,this.a)}}class fu{constructor(t,o,u,f,A,v=!1){if(this.premultiplied=!1,this.premultiplied=v,t){const C=t.image.height,P=C*C;this.premultiplied?(o=A===0?0:o/A*(C-1),u=A===0?0:u/A*(C-1),f=A===0?0:f/A*(C-1)):(o*=C-1,u*=C-1,f*=C-1);const k=Math.floor(o),U=Math.floor(u),$=Math.floor(f),q=Math.ceil(o),K=Math.ceil(u),J=Math.ceil(f),de=o-k,Ae=u-U,_e=f-$,Ie=t.image.data,Pe=4*(k+U*P+$*C),ke=4*(k+U*P+J*C),Ye=4*(k+K*P+$*C),Qe=4*(k+K*P+J*C),tt=4*(q+U*P+$*C),it=4*(q+U*P+J*C),ct=4*(q+K*P+$*C),$t=4*(q+K*P+J*C);if(Pe<0||$t>=Ie.length)throw new Error("out of range");this.r=hn(hn(hn(Ie[Pe],Ie[ke],_e),hn(Ie[Ye],Ie[Qe],_e),Ae),hn(hn(Ie[tt],Ie[it],_e),hn(Ie[ct],Ie[$t],_e),Ae),de)/255*(this.premultiplied?A:1),this.g=hn(hn(hn(Ie[Pe+1],Ie[ke+1],_e),hn(Ie[Ye+1],Ie[Qe+1],_e),Ae),hn(hn(Ie[tt+1],Ie[it+1],_e),hn(Ie[ct+1],Ie[$t+1],_e),Ae),de)/255*(this.premultiplied?A:1),this.b=hn(hn(hn(Ie[Pe+2],Ie[ke+2],_e),hn(Ie[Ye+2],Ie[Qe+2],_e),Ae),hn(hn(Ie[tt+2],Ie[it+2],_e),hn(Ie[ct+2],Ie[$t+2],_e),Ae),de)/255*(this.premultiplied?A:1),this.a=A}else this.r=o,this.g=u,this.b=f,this.a=A}toArray(){const{r:t,g:o,b:u,a:f}=this;return[255*t,255*o,255*u,f]}toHslaArray(){let{r:t,g:o,b:u,a:f}=this;if(this.premultiplied){if(f===0)return[0,0,0,0];const J=1/f;t*=J,o*=J,u*=J}const A=Math.min(Math.max(t,0),1),v=Math.min(Math.max(o,0),1),C=Math.min(Math.max(u,0),1),P=Math.min(A,v,C),k=Math.max(A,v,C),U=k-P,$=.5*(P+k);if(U===0)return[0,0,100*$,f];const q=$>.5?U/(2-k-P):U/(k+P);let K;switch(k){case A:K=60*((v-C)/U+(v<C?6:0));break;case v:K=60*((C-A)/U+2);break;default:K=60*((A-v)/U+4)}return[K,100*q,100*$,f]}toArray01(){const{r:t,g:o,b:u,a:f}=this;return[t,o,u,f]}toArray01Scaled(t){const{r:o,g:u,b:f}=this;return[o*t,u*t,f*t]}toArray01Linear(){const{r:t,g:o,b:u,a:f}=this;return[Math.pow(t,2.2),Math.pow(o,2.2),Math.pow(u,2.2),f]}}class Jp extends fu{constructor(t,o,u,f,A){super(t,o,u,f,A,!1)}}class Ad extends fu{constructor(t,o,u,f,A){super(t,o,u,f,A,!0)}}function hn(s,t,o){return s*(1-o)+t*o}function du(s,t,o){return s.map(((u,f)=>hn(u,t[f],o)))}vi.black=new vi(0,0,0,1),vi.white=new vi(1,1,1,1),vi.transparent=new vi(0,0,0,0),vi.red=new vi(1,0,0,1),vi.blue=new vi(0,0,1,1);var $a=Object.freeze({__proto__:null,array:du,color:function(s,t,o){return new vi(hn(s.r,t.r,o),hn(s.g,t.g,o),hn(s.b,t.b,o),hn(s.a,t.a,o))},number:hn});class Gl extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class gd{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[u,f]of o)this.bindings[u]=f}concat(t){return new gd(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ul={kind:"null"},Kr={kind:"number"},Di={kind:"string"},Oi={kind:"boolean"},Ws={kind:"color"},Bh={kind:"object"},Ti={kind:"value"},ip={kind:"collator"},th={kind:"formatted"},_d={kind:"resolvedImage"};function _s(s,t){return{kind:"array",itemType:s,N:t}}function ma(s){if(s.kind==="array"){const t=ma(s.itemType);return typeof s.N=="number"?`array<${t}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${t}>`}return s.kind}const op=[ul,Kr,Di,Oi,Ws,th,Bh,_s(Ti),_d];function yd(s,t){if(t.kind==="error")return null;if(s.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!yd(s.itemType,t.itemType))&&(typeof s.N!="number"||s.N===t.N))return null}else{if(s.kind===t.kind)return null;if(s.kind==="value"){for(const o of op)if(!yd(o,t))return null}}return`Expected ${ma(s)} but found ${ma(t)} instead.`}function vd(s,t){return t.some((o=>o.kind===s.kind))}function pu(s,t){return t.some((o=>o==="null"?s===null:o==="array"?Array.isArray(s):o==="object"?s&&!Array.isArray(s)&&typeof s=="object":o===typeof s))}function mu(s,t){return s.kind==="array"&&t.kind==="array"?s.N===t.N&&mu(s.itemType,t.itemType):s.kind===t.kind}class Au{constructor(t,o,u){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Fh{constructor(t,o,u,f,A){this.text=t.normalize?t.normalize():t,this.image=o,this.scale=u,this.fontStack=f,this.textColor=A}}class cs{constructor(t){this.sections=t}static fromString(t){return new cs([new Fh(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||!!t.image&&t.image.hasPrimary()))}static factory(t){return t instanceof cs?t:cs.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}serialize(){const t=["format"];for(const o of this.sections){if(o.image){const f=o.image.getPrimary().id.toString();t.push(["image",f]);continue}t.push(o.text);const u={};o.fontStack&&(u["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(u["font-scale"]=o.scale),o.textColor&&(u["text-color"]=["rgba"].concat(o.textColor.toNonPremultipliedRenderColor(null).toArray())),t.push(u)}return t}}class ys{constructor(t,o={}){if(this.id=wl.from(t),this.options=Object.assign({},o),o.transform){const{a:u,b:f,c:A,d:v,e:C,f:P}=o.transform;this.options.transform=new DOMMatrix([u,f,A,v,C,P])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:t,b:o,c:u,d:f,e:A,f:v}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:t,b:o,c:u,d:f,e:A,f:v}})}static parse(t){let o,u,f,A;try{({name:o,iconsetId:u,params:f,transform:A}=JSON.parse(t)||{})}catch{return null}if(!o)return null;const{a:v,b:C,c:P,d:k,e:U,f:$}=A||{};return new ys({name:o,iconsetId:u},{params:f,transform:new DOMMatrix([v,C,P,k,U,$])})}scaleSelf(t,o){return this.options.transform.scaleSelf(t,o),this}}class Is{constructor(t,o,u,f,A=!1){this.primaryId=wl.from(t),this.primaryOptions=o,u&&(this.secondaryId=wl.from(u)),this.secondaryOptions=f,this.available=A}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new ys(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new ys(this.secondaryId,this.secondaryOptions):null}static from(t){return typeof t=="string"?Is.build({name:t}):t}static build(t,o,u,f){return!t||typeof t=="object"&&!("name"in t)?null:new Is(t,u,o,f)}}function gu(s,t,o,u){return typeof s=="number"&&s>=0&&s<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[s,t,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[s,t,o,u]:[s,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Nh(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof vi||s instanceof Au||s instanceof cs||s instanceof Is)return!0;if(Array.isArray(s)){for(const t of s)if(!Nh(t))return!1;return!0}if(typeof s=="object"){for(const t in s)if(!Nh(s[t]))return!1;return!0}return!1}function Ma(s){if(s===null)return ul;if(typeof s=="string")return Di;if(typeof s=="boolean")return Oi;if(typeof s=="number")return Kr;if(s instanceof vi)return Ws;if(s instanceof Au)return ip;if(s instanceof cs)return th;if(s instanceof Is)return _d;if(Array.isArray(s)){const t=s.length;let o;for(const u of s){const f=Ma(u);if(o){if(o===f)continue;o=Ti;break}o=f}return _s(o||Ti,t)}return Bh}function Ps(s){const t=typeof s;return s===null?"":t==="string"||t==="number"||t==="boolean"?String(s):s instanceof cs||s instanceof Is||s instanceof vi?s.toString():JSON.stringify(s)}class Mn{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Nh(t[1]))return o.error("invalid value");const u=t[1];let f=Ma(u);const A=o.expectedType;return f.kind!=="array"||f.N!==0||!A||A.kind!=="array"||typeof A.N=="number"&&A.N!==0||(f=A),new Mn(f,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof vi?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof cs?this.value.serialize():this.value}}class Mr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const ac={string:Di,number:Kr,boolean:Oi,object:Bh};class cn{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let u,f=1;const A=t[0];if(A==="array"){let C,P;if(t.length>2){const k=t[1];if(typeof k!="string"||!(k in ac)||k==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);C=ac[k],f++}else C=Ti;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);P=t[2],f++}u=_s(C,P)}else u=ac[A];const v=[];for(;f<t.length;f++){const C=o.parse(t[f],f,Ti);if(!C)return null;v.push(C)}return new cn(u,v)}evaluate(t){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(t);if(!yd(this.type,Ma(u)))return u;if(o===this.args.length-1)throw new Mr(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${ma(Ma(u))} but was expected to be of type ${ma(this.type)}.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=this.type,o=[t.kind];if(t.kind==="array"){const u=t.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);const f=t.N;(typeof f=="number"||this.args.length>1)&&o.push(f)}}return o.concat(this.args.map((u=>u.serialize())))}}class So{constructor(t){this.type=th,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const u=t[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const f=[];let A=!1;for(let v=1;v<=t.length-1;++v){const C=t[v];if(A&&typeof C=="object"&&!Array.isArray(C)){A=!1;let P=null;if(C["font-scale"]&&(P=o.parseObjectValue(C["font-scale"],v,"font-scale",Kr),!P))return null;let k=null;if(C["text-font"]&&(k=o.parseObjectValue(C["text-font"],v,"text-font",_s(Di)),!k))return null;let U=null;if(C["text-color"]&&(U=o.parseObjectValue(C["text-color"],v,"text-color",Ws),!U))return null;const $=f[f.length-1];$.scale=P,$.font=k,$.textColor=U}else{const P=o.parse(t[v],v,Ti);if(!P)return null;const k=P.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");A=!0,f.push({content:P,scale:null,font:null,textColor:null})}}return new So(f)}evaluate(t){return new cs(this.sections.map((o=>{const u=o.content.evaluate(t);return mu(Ma(u),_d)?new Fh("",u,null,null,null):new Fh(Ps(u),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)})))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const o of this.sections){t.push(o.content.serialize());const u={};o.scale&&(u["font-scale"]=o.scale.serialize()),o.font&&(u["text-font"]=o.font.serialize()),o.textColor&&(u["text-color"]=o.textColor.serialize()),t.push(u)}return t}}class _u{constructor(t,o,u,f){this._imageWarnHistory={},this.type=_d,this.namePrimary=t,this.nameSecondary=o,u&&(this.paramsPrimary=u.params,this.iconsetIdPrimary=u.iconset?u.iconset.id:void 0),f&&(this.paramsSecondary=f.params,this.iconsetIdSecondary=f.iconset?f.iconset.id:void 0)}static parse(t,o){if(t.length<2)return o.error("Expected two or more arguments.");let u=1;const f=[];function A(){if(u<t.length){const C=o.parse(t[u],u++,Di);return C?(f.push({image:C,options:{}}),!0):(o.error(f.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function v(){if(u<t.length){const P=t[u];if((C=P)===null||typeof C!="object"||Array.isArray(C))return!0;const k=P.params,U=P.iconset,$=o.concat(u);if(!k&&!U)return u++,!0;if(k){if(typeof k!="object"||k.constructor!==Object)return $.error('Image options "params" should be an object'),!1;const q={},K=$.concat(void 0,"params");for(const J in k){if(!J)return K.error("Image parameter name should be non-empty"),!1;const de=K.concat(void 0,J).parse(k[J],void 0,Ws,void 0,{typeAnnotation:"coerce"});if(!de)return!1;q[J]=de}f[f.length-1].options.params=q}if(U){if(typeof U!="object"||U.constructor!==Object)return $.error('Image options "iconset" should be an object'),!1;if(!U.id)return $.error('Image options "iconset" should have an "id" property'),!1;f[f.length-1].options.iconset=U}return u++,!0}var C;return!0}for(let C=0;C<2;C++)if(!A()||!v())return;return new _u(f[0].image,f[1]?f[1].image:void 0,f[0].options,f[1]?f[1].options:void 0)}evaluateParams(t,o){const u={};if(o){for(const f in o)if(o[f])try{u[f]=o[f].evaluate(t)}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(t){const o={name:this.namePrimary.evaluate(t),iconsetId:this.iconsetIdPrimary},u=this.nameSecondary?{name:this.nameSecondary.evaluate(t),iconsetId:this.iconsetIdSecondary}:void 0,f=Is.build(o,u,this.paramsPrimary?this.evaluateParams(t,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(t,this.paramsSecondary):void 0);if(f&&t.availableImages){const A=f.getPrimary().id;if(f.available=t.availableImages.some((v=>wl.isEqual(v,A))),f.available){const v=f.getSecondary()?f.getSecondary().id:null;v&&(f.available=t.availableImages.some((C=>wl.isEqual(C,v))))}}return f}eachChild(t){if(t(this.namePrimary),this.paramsPrimary)for(const o in this.paramsPrimary)this.paramsPrimary[o]&&t(this.paramsPrimary[o]);if(this.nameSecondary&&(t(this.nameSecondary),this.paramsSecondary))for(const o in this.paramsSecondary)this.paramsSecondary[o]&&t(this.paramsSecondary[o])}outputDefined(){return!1}serializeOptions(t,o){const u={};if(o&&(u.iconset={id:o}),t){u.params={};for(const f in t)t[f]&&(u.params[f]=t[f].serialize())}return Object.keys(u).length>0?u:void 0}serialize(){const t=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const o=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);o&&t.push(o)}if(this.nameSecondary&&(t.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const o=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);o&&t.push(o)}return t}}function gn(s){return jh(s)?"string":Uh(s)?"number":ap(s)?"boolean":Array.isArray(s)?"array":s===null?"null":xd(s)?"object":typeof s}function xd(s){return s!=null&&!Array.isArray(s)&&typeof s!="function"&&!(s instanceof String||s instanceof Number||s instanceof Boolean)&&typeof s=="object"}function jh(s){return typeof s=="string"||s instanceof String}function Uh(s){return typeof s=="number"||s instanceof Number}function ap(s){return typeof s=="boolean"||s instanceof Boolean}const bd={"to-boolean":Oi,"to-color":Ws,"to-number":Kr,"to-string":Di};class Ki{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const u=t[0],f=[];let A=ul;if(u==="to-array"){if(!Array.isArray(t[1]))return null;const v=t[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);A=_s(o.expectedType.itemType,v)}else{if(!(v>0&&Nh(t[1][0])))return null;A=_s(Ma(t[1][0]),v)}for(let C=0;C<v;C++){const P=t[1][C];let k;if(Array.isArray(P))k=o.parse(P,void 0,A.itemType);else{const U=gn(P);if(U!==A.itemType.kind)return o.error(`Expected ${A.itemType.kind} but found ${U}.`);k=o.registry.literal.parse(["literal",P===void 0?null:P],o)}if(!k)return null;f.push(k)}}else{if((u==="to-boolean"||u==="to-string")&&t.length!==2)return o.error("Expected one argument.");A=bd[u];for(let v=1;v<t.length;v++){const C=o.parse(t[v],v,Ti);if(!C)return null;f.push(C)}}return new Ki(A,f)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let o,u;for(const f of this.args){if(o=f.evaluate(t),u=null,o instanceof vi)return o;if(typeof o=="string"){const A=t.parseColor(o);if(A)return A}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:gu(o[0],o[1],o[2],o[3]),!u))return new vi(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Mr(u||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(t),o===null)return 0;const f=Number(o);if(!isNaN(f))return f}throw new Mr(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?cs.fromString(Ps(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Is.build(Ps(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map((o=>o.evaluate(t))):Ps(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new So([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new _u(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild((o=>{t.push(o.serialize())})),t}}const wd=["Unknown","Point","LineString","Polygon"];class Zs{constructor(t,o,u){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=o,this.iconImageUseTheme=u}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?wd[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:u,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*o-t[0])+this.featureDistanceData.bearing[1]*(f*o-t[1])}return 0}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=vi.parse(t)),o}getConfig(t){return this.options?this.options.get(t):null}}class Rs{constructor(t,o,u,f,A){this.name=t,this.type=o,this._evaluate=u,this.args=f,this._overloadIndex=A}evaluate(t){if(!this._evaluate){const o=Rs.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((t=>t.serialize())))}static parse(t,o){const u=t[0],f=Rs.definitions[u];if(!f)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const A=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,C=[];let P=null,k=-1;for(const[U,$]of v){if(Array.isArray(U)&&U.length!==t.length-1)continue;C.push(U),k++,P=new Eu(o.registry,o.path,null,o.scope,void 0,o._scope,o.options,o.iconImageUseTheme);const q=[];let K=!1;for(let J=1;J<t.length;J++){const de=t[J],Ae=Array.isArray(U)?U[J-1]:U.type,_e=P.parse(de,1+q.length,Ae);if(!_e){K=!0;break}q.push(_e)}if(!K)if(Array.isArray(U)&&U.length!==q.length)P.error(`Expected ${U.length} arguments, but found ${q.length} instead.`);else{for(let J=0;J<q.length;J++){const de=Array.isArray(U)?U[J]:U.type,Ae=q[J];P.concat(J+1).checkSubtype(de,Ae.type)}if(P.errors.length===0)return new Rs(u,A,$,q,k)}}if(C.length===1)o.errors.push(...P.errors);else{const U=(C.length?C:v.map((([q])=>q))).map(Ec).join(" | "),$=[];for(let q=1;q<t.length;q++){const K=o.parse(t[q],1+$.length);if(!K)return null;$.push(ma(K.type))}o.error(`Expected arguments of type ${U}, but found (${$.join(", ")}) instead.`)}return null}static register(t,o){Rs.definitions=o;for(const u in o)t[u]=Rs}}function Ec(s){return Array.isArray(s)?`(${s.map(ma).join(", ")})`:`(${ma(s.type)}...)`}class Ja{constructor(t,o,u){this.type=ip,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const u=t[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const f=u["case-sensitive"]===void 0?o.parse(!1,1,Oi):o.parseObjectValue(u["case-sensitive"],1,"case-sensitive",Oi);if(!f)return null;const A=u["diacritic-sensitive"]===void 0?o.parse(!1,1,Oi):o.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",Oi);if(!A)return null;let v=null;return u.locale&&(v=o.parseObjectValue(u.locale,1,"locale",Di),!v)?null:new Ja(f,A,v)}evaluate(t){return new Au(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}function ua(s,t,o=0,u=s.length-1,f=sp){for(;u>o;){if(u-o>600){const P=u-o+1,k=t-o+1,U=Math.log(P),$=.5*Math.exp(2*U/3),q=.5*Math.sqrt(U*$*(P-$)/P)*(k-P/2<0?-1:1);ua(s,t,Math.max(o,Math.floor(t-k*$/P+q)),Math.min(u,Math.floor(t+(P-k)*$/P+q)),f)}const A=s[t];let v=o,C=u;for(sc(s,o,t),f(s[u],A)>0&&sc(s,o,u);v<C;){for(sc(s,v,C),v++,C--;f(s[v],A)<0;)v++;for(;f(s[C],A)>0;)C--}f(s[o],A)===0?sc(s,o,C):(C++,sc(s,C,u)),C<=t&&(o=C+1),t<=C&&(u=C-1)}}function sc(s,t,o){const u=s[t];s[t]=s[o],s[o]=u}function sp(s,t){return s<t?-1:s>t?1:0}function Cc(s){let t=0;for(let o,u,f=0,A=s.length,v=A-1;f<A;v=f++)o=s[f],u=s[v],t+=(u.x-o.x)*(o.y+u.y);return t}function Sl(s,t){s[0]=Math.min(s[0],t[0]),s[1]=Math.min(s[1],t[1]),s[2]=Math.max(s[2],t[0]),s[3]=Math.max(s[3],t[1])}function vs(s,t){return!(s[0]<=t[0]||s[2]>=t[2]||s[1]<=t[1]||s[3]>=t[3])}function em(s,t,o){const u=s[0]-t[0],f=s[1]-t[1],A=s[0]-o[0],v=s[1]-o[1];return u*v-A*f==0&&u*A<=0&&f*v<=0}function Vh(s,t,o=!1){let u=!1;for(let C=0,P=t.length;C<P;C++){const k=t[C];for(let U=0,$=k.length,q=$-1;U<$;q=U++){const K=k[q],J=k[U];if(em(s,K,J))return o;(A=K)[1]>(f=s)[1]!=(v=J)[1]>f[1]&&f[0]<(v[0]-A[0])*(f[1]-A[1])/(v[1]-A[1])+A[0]&&(u=!u)}}var f,A,v;return u}function $h(s,t,o,u){const f=u[0]-o[0],A=u[1]-o[1],v=(s[0]-o[0])*A-f*(s[1]-o[1]),C=(t[0]-o[0])*A-f*(t[1]-o[1]);return v>0&&C<0||v<0&&C>0}function rh(s,t,o,u){return(f=[u[0]-o[0],u[1]-o[1]])[0]*(A=[t[0]-s[0],t[1]-s[1]])[1]-f[1]*A[0]!=0&&!(!$h(s,t,o,u)||!$h(o,u,s,t));var f,A}function nh(s){const t=new rr(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o=new rr(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const u of s[0])t.x>u.x&&(t.x=u.x),t.y>u.y&&(t.y=u.y),o.x<u.x&&(o.x=u.x),o.y<u.y&&(o.y=u.y);return{min:t,max:o}}const Mc=8192;function Ic(s,t){const o=(180+s[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(o*f*Mc),Math.round(u*f*Mc)]}function ih(s,t){for(let o=0;o<t.length;o++)if(Vh(s,t[o]))return!0;return!1}function oh(s,t,o){for(const u of o)for(let f=0,A=u.length,v=A-1;f<A;v=f++)if(rh(s,t,u[v],u[f]))return!0;return!1}function Pc(s,t){for(let o=0;o<s.length;++o)if(!Vh(s[o],t))return!1;for(let o=0;o<s.length-1;++o)if(oh(s[o],s[o+1],t))return!1;return!0}function ah(s,t){for(let o=0;o<t.length;o++)if(Pc(s,t[o]))return!0;return!1}function Ia(s,t,o){const u=[];for(let f=0;f<s.length;f++){const A=[];for(let v=0;v<s[f].length;v++){const C=Ic(s[f][v],o);Sl(t,C),A.push(C)}u.push(A)}return u}function Tl(s,t,o){const u=[];for(let f=0;f<s.length;f++){const A=Ia(s[f],t,o);u.push(A)}return u}function Gh(s,t,o,u){if(s[0]<o[0]||s[0]>o[2]){const f=.5*u;let A=s[0]-o[0]>f?-u:o[0]-s[0]>f?u:0;A===0&&(A=s[0]-o[2]>f?-u:o[2]-s[0]>f?u:0),s[0]+=A}Sl(t,s)}function tm(s,t,o,u){const f=Math.pow(2,u.z)*Mc,A=[u.x*Mc,u.y*Mc],v=[];if(!s)return v;for(const C of s)for(const P of C){const k=[P.x+A[0],P.y+A[1]];Gh(k,t,o,f),v.push(k)}return v}function sA(s,t,o,u){const f=Math.pow(2,u.z)*Mc,A=[u.x*Mc,u.y*Mc],v=[];if(!s)return v;for(const P of s){const k=[];for(const U of P){const $=[U.x+A[0],U.y+A[1]];Sl(t,$),k.push($)}v.push(k)}if(t[2]-t[0]<=f/2){(C=t)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const P of v)for(const k of P)Gh(k,t,o,f)}var C;return v}class Hh{constructor(t,o){this.type=Oi,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Nh(t[1])){const u=t[1];if(u.type==="FeatureCollection")for(let f=0;f<u.features.length;++f){const A=u.features[f].geometry.type;if(A==="Polygon"||A==="MultiPolygon")return new Hh(u,u.features[f].geometry)}else if(u.type==="Feature"){const f=u.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Hh(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Hh(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(o,u){const f=[1/0,1/0,-1/0,-1/0],A=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const C=Ia(u.coordinates,A,v),P=tm(o.geometry(),f,A,v);if(!vs(f,A))return!1;for(const k of P)if(!Vh(k,C))return!1}if(u.type==="MultiPolygon"){const C=Tl(u.coordinates,A,v),P=tm(o.geometry(),f,A,v);if(!vs(f,A))return!1;for(const k of P)if(!ih(k,C))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(o,u){const f=[1/0,1/0,-1/0,-1/0],A=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if(u.type==="Polygon"){const C=Ia(u.coordinates,A,v),P=sA(o.geometry(),f,A,v);if(!vs(f,A))return!1;for(const k of P)if(!Pc(k,C))return!1}if(u.type==="MultiPolygon"){const C=Tl(u.coordinates,A,v),P=sA(o.geometry(),f,A,v);if(!vs(f,A))return!1;for(const k of P)if(!ah(k,C))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const Lf={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},lp=1/298.257223563,cp=lp*(2-lp),sh=Math.PI/180;class es{static fromTile(t,o,u){const f=Math.PI*(1-2*(t+.5)/Math.pow(2,o)),A=Math.atan(.5*(Math.exp(f)-Math.exp(-f)))/sh;return new es(A,u)}static get units(){return Lf}constructor(t,o){if(t===void 0)throw new Error("No latitude given.");if(o&&!Lf[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(Lf).join(", ")}`);const u=6378.137*sh*(o?Lf[o]:1),f=Math.cos(t*sh),A=1/(1-cp*(1-f*f)),v=Math.sqrt(A);this.kx=u*v*f,this.ky=u*v*A*(1-cp)}distance(t,o){const u=Aa(t[0]-o[0])*this.kx,f=(t[1]-o[1])*this.ky;return Math.sqrt(u*u+f*f)}bearing(t,o){const u=Aa(o[0]-t[0])*this.kx;return Math.atan2(u,(o[1]-t[1])*this.ky)/sh}destination(t,o,u){const f=u*sh;return this.offset(t,Math.sin(f)*o,Math.cos(f)*o)}offset(t,o,u){return[t[0]+o/this.kx,t[1]+u/this.ky]}lineDistance(t){let o=0;for(let u=0;u<t.length-1;u++)o+=this.distance(t[u],t[u+1]);return o}area(t){let o=0;for(let u=0;u<t.length;u++){const f=t[u];for(let A=0,v=f.length,C=v-1;A<v;C=A++)o+=Aa(f[A][0]-f[C][0])*(f[A][1]+f[C][1])*(u?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(t,o){let u=0;if(o<=0)return t[0];for(let f=0;f<t.length-1;f++){const A=t[f],v=t[f+1],C=this.distance(A,v);if(u+=C,u>o)return xs(A,v,(o-(u-C))/C)}return t[t.length-1]}pointToSegmentDistance(t,o,u){let[f,A]=o,v=Aa(u[0]-f)*this.kx,C=(u[1]-A)*this.ky;if(v!==0||C!==0){const P=(Aa(t[0]-f)*this.kx*v+(t[1]-A)*this.ky*C)/(v*v+C*C);P>1?(f=u[0],A=u[1]):P>0&&(f+=v/this.kx*P,A+=C/this.ky*P)}return v=Aa(t[0]-f)*this.kx,C=(t[1]-A)*this.ky,Math.sqrt(v*v+C*C)}pointOnLine(t,o){let u=1/0,f=t[0][0],A=t[0][1],v=0,C=0;for(let P=0;P<t.length-1;P++){let k=t[P][0],U=t[P][1],$=Aa(t[P+1][0]-k)*this.kx,q=(t[P+1][1]-U)*this.ky,K=0;$===0&&q===0||(K=(Aa(o[0]-k)*this.kx*$+(o[1]-U)*this.ky*q)/($*$+q*q),K>1?(k=t[P+1][0],U=t[P+1][1]):K>0&&(k+=$/this.kx*K,U+=q/this.ky*K)),$=Aa(o[0]-k)*this.kx,q=(o[1]-U)*this.ky;const J=$*$+q*q;J<u&&(u=J,f=k,A=U,v=P,C=K)}return{point:[f,A],index:v,t:Math.max(0,Math.min(1,C))}}lineSlice(t,o,u){let f=this.pointOnLine(u,t),A=this.pointOnLine(u,o);if(f.index>A.index||f.index===A.index&&f.t>A.t){const k=f;f=A,A=k}const v=[f.point],C=f.index+1,P=A.index;!Sd(u[C],v[0])&&C<=P&&v.push(u[C]);for(let k=C+1;k<=P;k++)v.push(u[k]);return Sd(u[P],A.point)||v.push(A.point),v}lineSliceAlong(t,o,u){let f=0;const A=[];for(let v=0;v<u.length-1;v++){const C=u[v],P=u[v+1],k=this.distance(C,P);if(f+=k,f>t&&A.length===0&&A.push(xs(C,P,(t-(f-k))/k)),f>=o)return A.push(xs(C,P,(o-(f-k))/k)),A;f>t&&A.push(P)}return A}bufferPoint(t,o){const u=o/this.ky,f=o/this.kx;return[t[0]-f,t[1]-u,t[0]+f,t[1]+u]}bufferBBox(t,o){const u=o/this.ky,f=o/this.kx;return[t[0]-f,t[1]-u,t[2]+f,t[3]+u]}insideBBox(t,o){return Aa(t[0]-o[0])>=0&&Aa(t[0]-o[2])<=0&&t[1]>=o[1]&&t[1]<=o[3]}}function Sd(s,t){return s[0]===t[0]&&s[1]===t[1]}function xs(s,t,o){const u=Aa(t[0]-s[0]);return[s[0]+u*o,s[1]+(t[1]-s[1])*o]}function Aa(s){for(;s<-180;)s+=360;for(;s>180;)s-=360;return s}class yu{constructor(t=[],o=((u,f)=>u<f?-1:u>f?1:0)){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:u}=this,f=o[t];for(;t>0;){const A=t-1>>1,v=o[A];if(u(f,v)>=0)break;o[t]=v,t=A}o[t]=f}_down(t){const{data:o,compare:u}=this,f=this.length>>1,A=o[t];for(;t<f;){let v=1+(t<<1);const C=v+1;if(C<this.length&&u(o[C],o[v])<0&&(v=C),u(o[v],A)>=0)break;o[t]=o[v],t=v}o[t]=A}}var mr=8192;function Bf(s,t){return t.dist-s.dist}const vu=100,lh=50;function Rc(s){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==s.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==s[o])return!1;return!0}function qh(s){return s[1]-s[0]+1}function El(s,t){const o=s[1]>=s[0]&&s[1]<t;return o||console.warn("Distance Expression: Index is out of range"),o}function Dc(s,t){if(s[0]>s[1])return[null,null];const o=qh(s);if(t){if(o===2)return[s,null];const u=Math.floor(o/2);return[[s[0],s[0]+u],[s[0]+u,s[1]]]}{if(o===1)return[s,null];const u=Math.floor(o/2)-1;return[[s[0],s[0]+u],[s[0]+u+1,s[1]]]}}function Ga(s,t){const o=[1/0,1/0,-1/0,-1/0];if(!El(t,s.length))return o;for(let u=t[0];u<=t[1];++u)Sl(o,s[u]);return o}function Dn(s){const t=[1/0,1/0,-1/0,-1/0];for(let o=0;o<s.length;++o)for(let u=0;u<s[o].length;++u)Sl(t,s[o][u]);return t}function ch(s,t,o){if(Rc(s)||Rc(t))return NaN;let u=0,f=0;return s[2]<t[0]&&(u=t[0]-s[2]),s[0]>t[2]&&(u=s[0]-t[2]),s[1]>t[3]&&(f=s[1]-t[3]),s[3]<t[1]&&(f=t[1]-s[3]),o.distance([0,0],[u,f])}function xu(s){return 360*s-180}function lA(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Wh(s,t){const o=Math.pow(2,t.z),u=(s.y/mr+t.y)/o;return[xu((s.x/mr+t.x)/o),lA(u)]}function Zh(s,t){const o=[];for(let u=0;u<s.length;++u)o.push(Wh(s[u],t));return o}function $i(s,t,o){const u=o.pointOnLine(t,s).point;return o.distance(s,u)}function Ff(s,t,o,u,f){const A=o.slice(u[0],u[1]+1);let v=1/0;for(let C=t[0];C<=t[1];++C)if((v=Math.min(v,$i(s[C],A,f)))===0)return 0;return v}function uh(s,t,o,u,f){const A=Math.min(f.pointToSegmentDistance(s,o,u),f.pointToSegmentDistance(t,o,u)),v=Math.min(f.pointToSegmentDistance(o,s,t),f.pointToSegmentDistance(u,s,t));return Math.min(A,v)}function bu(s,t,o,u,f){if(!El(t,s.length)||!El(u,o.length))return NaN;let A=1/0;for(let v=t[0];v<t[1];++v)for(let C=u[0];C<u[1];++C){if(rh(s[v],s[v+1],o[C],o[C+1]))return 0;A=Math.min(A,uh(s[v],s[v+1],o[C],o[C+1],f))}return A}function Td(s,t,o,u,f){if(!El(t,s.length)||!El(u,o.length))return NaN;let A=1/0;for(let v=t[0];v<=t[1];++v)for(let C=u[0];C<=u[1];++C)if((A=Math.min(A,f.distance(s[v],o[C])))===0)return A;return A}function up(s,t,o){if(Vh(s,t,!0))return 0;let u=1/0;for(const f of t){const A=f.length;if(A<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(f[0]!==f[A-1]&&(u=Math.min(u,o.pointToSegmentDistance(s,f[A-1],f[0])))===0||(u=Math.min(u,$i(s,f,o)))===0)return u}return u}function Hl(s,t,o,u){if(!El(t,s.length))return NaN;for(let A=t[0];A<=t[1];++A)if(Vh(s[A],o,!0))return 0;let f=1/0;for(let A=t[0];A<t[1];++A)for(const v of o)for(let C=0,P=v.length,k=P-1;C<P;k=C++){if(rh(s[A],s[A+1],v[k],v[C]))return 0;f=Math.min(f,uh(s[A],s[A+1],v[k],v[C],u))}return f}function bs(s,t){for(const o of s)for(let u=0;u<=o.length-1;++u)if(Vh(o[u],t,!0))return!0;return!1}function hh(s,t,o,u=1/0){const f=Dn(s),A=Dn(t);if(u!==1/0&&ch(f,A,o)>=u)return u;if(vs(f,A)){if(bs(s,t))return 0}else if(bs(t,s))return 0;let v=u;for(const C of s)for(let P=0,k=C.length,U=k-1;P<k;U=P++)for(const $ of t)for(let q=0,K=$.length,J=K-1;q<K;J=q++){if(rh(C[U],C[P],$[J],$[q]))return 0;v=Math.min(v,uh(C[U],C[P],$[J],$[q],o))}return v}function Ds(s,t,o,u,f,A,v){if(A===null||v===null)return;const C=ch(Ga(u,A),Ga(f,v),o);C<t&&s.push({dist:C,range1:A,range2:v})}function lc(s,t,o,u,f=1/0){let A=Math.min(u.distance(s[0],o[0][0]),f);if(A===0)return A;const v=new yu([{dist:0,range1:[0,s.length-1],range2:[0,0]}],Bf),C=t?lh:vu,P=Dn(o);for(;v.length;){const k=v.pop();if(k.dist>=A)continue;const U=k.range1;if(qh(U)<=C){if(!El(U,s.length))return NaN;if(t){const $=Hl(s,U,o,u);if((A=Math.min(A,$))===0)return A}else for(let $=U[0];$<=U[1];++$){const q=up(s[$],o,u);if((A=Math.min(A,q))===0)return A}}else{const $=Dc(U,t);if($[0]!==null){const q=ch(Ga(s,$[0]),P,u);q<A&&v.push({dist:q,range1:$[0],range2:[0,0]})}if($[1]!==null){const q=ch(Ga(s,$[1]),P,u);q<A&&v.push({dist:q,range1:$[1],range2:[0,0]})}}}return A}function Oc(s,t,o,u,f,A=1/0){let v=Math.min(A,f.distance(s[0],o[0]));if(v===0)return v;const C=new yu([{dist:0,range1:[0,s.length-1],range2:[0,o.length-1]}],Bf),P=t?lh:vu,k=u?lh:vu;for(;C.length;){const U=C.pop();if(U.dist>=v)continue;const $=U.range1,q=U.range2;if(qh($)<=P&&qh(q)<=k){if(!El($,s.length)||!El(q,o.length))return NaN;if(t&&u?v=Math.min(v,bu(s,$,o,q,f)):t||u?t&&!u?v=Math.min(v,Ff(o,q,s,$,f)):!t&&u&&(v=Math.min(v,Ff(s,$,o,q,f))):v=Math.min(v,Td(s,$,o,q,f)),v===0)return v}else{const K=Dc($,t),J=Dc(q,u);Ds(C,v,f,s,o,K[0],J[0]),Ds(C,v,f,s,o,K[0],J[1]),Ds(C,v,f,s,o,K[1],J[0]),Ds(C,v,f,s,o,K[1],J[1])}}return v}function Ed(s,t,o,u,f=1/0){let A=f;const v=Ga(s,[0,s.length-1]);for(const C of o)if(!(A!==1/0&&ch(v,Ga(C,[0,C.length-1]),u)>=A)&&(A=Math.min(A,Oc(s,t,C,!0,u,A)),A===0))return A;return A}function wu(s,t,o,u,f=1/0){let A=f;const v=Ga(s,[0,s.length-1]);for(const C of o){if(A!==1/0&&ch(v,Dn(C),u)>=A)continue;const P=lc(s,t,C,u,A);if(isNaN(P))return P;if((A=Math.min(A,P))===0)return A}return A}function Nf(s){return s==="Point"||s==="MultiPoint"||s==="LineString"||s==="MultiLineString"||s==="Polygon"||s==="MultiPolygon"}class ka{constructor(t,o){this.type=Kr,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Nh(t[1])){const u=t[1];if(u.type==="FeatureCollection"){for(let f=0;f<u.features.length;++f)if(Nf(u.features[f].geometry.type))return new ka(u,u.features[f].geometry)}else if(u.type==="Feature"){if(Nf(u.geometry.type))return new ka(u,u.geometry)}else if(Nf(u.type))return new ka(u,u)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const o=t.geometry(),u=t.canonicalID();if(o!=null&&u!=null){if(t.geometryType()==="Point")return(function(f,A,v){const C=[];for(const k of f)for(const U of k)C.push(Wh(U,A));const P=new es(C[0][1],"meters");return v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString"?Oc(C,!1,v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",P):v.type==="MultiLineString"?Ed(C,!1,v.coordinates,P):v.type==="Polygon"||v.type==="MultiPolygon"?wu(C,!1,v.type==="Polygon"?[v.coordinates]:v.coordinates,P):null})(o,u,this.geometries);if(t.geometryType()==="LineString")return(function(f,A,v){const C=[];for(const k of f){const U=[];for(const $ of k)U.push(Wh($,A));C.push(U)}const P=new es(C[0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return Ed(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",C,P);if(v.type==="MultiLineString"){let k=1/0;for(let U=0;U<v.coordinates.length;U++){const $=Ed(v.coordinates[U],!0,C,P,k);if(isNaN($))return $;if((k=Math.min(k,$))===0)return k}return k}if(v.type==="Polygon"||v.type==="MultiPolygon"){let k=1/0;for(let U=0;U<C.length;U++){const $=wu(C[U],!0,v.type==="Polygon"?[v.coordinates]:v.coordinates,P,k);if(isNaN($))return $;if((k=Math.min(k,$))===0)return k}return k}return null})(o,u,this.geometries);if(t.geometryType()==="Polygon")return(function(f,A,v){const C=[];for(const k of(function(U,$){const q=U.length;if(q<=1)return[U];const K=[];let J,de;for(let Ae=0;Ae<q;Ae++){const _e=Cc(U[Ae]);_e!==0&&(U[Ae].area=Math.abs(_e),de===void 0&&(de=_e<0),de===_e<0?(J&&K.push(J),J=[U[Ae]]):J.push(U[Ae]))}return J&&K.push(J),K})(f)){const U=[];for(let $=0;$<k.length;++$)U.push(Zh(k[$],A));C.push(U)}const P=new es(C[0][0][0][1],"meters");if(v.type==="Point"||v.type==="MultiPoint"||v.type==="LineString")return wu(v.type==="Point"?[v.coordinates]:v.coordinates,v.type==="LineString",C,P);if(v.type==="MultiLineString"){let k=1/0;for(let U=0;U<v.coordinates.length;U++){const $=wu(v.coordinates[U],!0,C,P,k);if(isNaN($))return $;if((k=Math.min(k,$))===0)return k}return k}return v.type==="Polygon"||v.type==="MultiPolygon"?(function(k,U,$){let q=1/0;for(const K of k)for(const J of U){const de=hh(K,J,$,q);if(isNaN(de))return de;if((q=Math.min(q,de))===0)return q}return q})(v.type==="Polygon"?[v.coordinates]:v.coordinates,C,P):null})(o,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Jo(s){if(s instanceof Rs&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Hh||s instanceof ka)return!1;if(s instanceof Xh)return s.featureConstant;let t=!0;return s.eachChild((o=>{t&&!Jo(o)&&(t=!1)})),t}function To(s){if(s instanceof Rs&&s.name==="feature-state")return!1;let t=!0;return s.eachChild((o=>{t&&!To(o)&&(t=!1)})),t}function kc(s){if(s instanceof Xh)return new Set([s.key]);let t=new Set;return s.eachChild((o=>{t=new Set([...t,...kc(o)])})),t}function Xs(s,t){if(s instanceof Rs&&t.indexOf(s.name)>=0)return!1;let o=!0;return s.eachChild((u=>{o&&!Xs(u,t)&&(o=!1)})),o}function hp(s,t,o){return[s,t,o].filter(Boolean).join("")}function Su(s,t){switch(s){case"string":return Ps(t);case"number":return+t;case"boolean":return!!t;case"color":return vi.parse(t);case"formatted":return cs.fromString(Ps(t));case"resolvedImage":return Is.build(Ps(t))}return t}function rm(s,t,o,u){return u!==void 0&&(s=u*Math.round(s/u)),t!==void 0&&s<t&&(s=t),o!==void 0&&s>o&&(s=o),s}class Xh{constructor(t,o,u,f=!1){this.type=t,this.key=o,this.scope=u,this.featureConstant=f}static parse(t,o){let u=o.expectedType;if(u==null&&(u=Ti),t.length<2||t.length>3)return o.error("Invalid number of arguments for 'config' expression.");const f=o.parse(t[1],1);if(!(f instanceof Mn))return o.error("Key name of 'config' expression must be a string literal.");let A,v=!0;const C=Ps(f.value);if(t.length>=3){const P=o.parse(t[2],2);if(!(P instanceof Mn))return o.error("Scope of 'config' expression must be a string literal.");A=Ps(P.value)}if(o.options){const P=hp(C,A,o._scope),k=o.options.get(P);k&&(v=Jo(k.value||k.default))}return new Xh(u,C,A,v)}evaluate(t){const o=hp(this.key,this.scope,t.scope),u=t.getConfig(o);if(!u)return null;const{type:f,value:A,values:v,minValue:C,maxValue:P,stepValue:k}=u,U=u.default.evaluate(t);let $=U;if(A){const q=t.scope;t.scope=(q||"").split("").slice(1).join(""),$=A.evaluate(t),t.scope=q}return f&&($=Su(f,$)),$===void 0||C===void 0&&P===void 0&&k===void 0||(typeof $=="number"?$=rm($,C,P,k):Array.isArray($)&&($=$.map((q=>typeof q=="number"?rm(q,C,P,k):q)))),A!==void 0&&$!==void 0&&v&&!v.includes($)&&($=U,f&&($=Su(f,$))),(f&&f!==this.type||$!==void 0&&!mu(Ma($),this.type))&&($=Su(this.type.kind,$)),$}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.scope),t}}class Tu{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=t[1];return o.scope.has(u)?new Tu(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Eu{constructor(t,o=[],u,f=new gd,A=[],v,C,P){this.registry=t,this.path=o,this.key=o.map((k=>typeof k=="string"?`['${k}']`:`[${k}]`)).join(""),this.scope=f,this.errors=A,this.expectedType=u,this._scope=v,this.options=C,this.iconImageUseTheme=P}parse(t,o,u,f,A={}){return o||u?this.concat(o,null,u,f)._parse(t,A):this._parse(t,A)}parseObjectValue(t,o,u,f,A,v={}){return this.concat(o,u,f,A)._parse(t,v)}_parse(t,o){function u(f,A,v){return v==="assert"?new cn(A,[f]):v==="coerce"?new Ki(A,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(f){let A=f.parse(t,this);if(!A)return null;if(this.expectedType){const v=this.expectedType,C=A.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||C.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||C.kind!=="value"&&C.kind!=="string"){if(this.checkSubtype(v,C))return null}else A=u(A,v,o.typeAnnotation||"coerce");else A=u(A,v,o.typeAnnotation||"assert")}if(!(A instanceof Mn)&&A.type.kind!=="resolvedImage"&&va(A)){const v=new Zs(this._scope,this.options,this.iconImageUseTheme);try{A=new Mn(A.type,A.evaluate(v))}catch(C){return this.error(C.message),null}}return A}return Ki.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,u,f){let A=typeof t=="number"?this.path.concat(t):this.path;A=typeof o=="string"?A.concat(o):A;const v=f?this.scope.concat(f):this.scope;return new Eu(this.registry,A,u||null,v,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(t,...o){const u=`${this.key}${o.map((f=>`[${f}]`)).join("")}`;this.errors.push(new Gl(u,t))}checkSubtype(t,o){const u=yd(t,o);return u&&this.error(u),u}}function va(s){if(s instanceof Tu)return va(s.boundExpression);if(s instanceof Rs&&s.name==="error"||s instanceof Ja||s instanceof Hh||s instanceof ka||s instanceof Xh)return!1;const t=s instanceof Ki||s instanceof cn;let o=!0;return s.eachChild((u=>{o=t?o&&va(u):o&&u instanceof Mn})),!!o&&Jo(s)&&Xs(s,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function fh(s,t){const o=s.length-1;let u,f,A=0,v=o,C=0;for(;A<=v;)if(C=Math.floor((A+v)/2),u=s[C],f=s[C+1],u<=t){if(C===o||t<f)return C;A=C+1}else{if(!(u>t))throw new Mr("Input is not a number.");v=C-1}return 0}class Yh{constructor(t,o,u){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[f,A]of u)this.labels.push(f),this.outputs.push(A)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(t[1],1,Kr);if(!u)return null;const f=[];let A=null;o.expectedType&&o.expectedType.kind!=="value"&&(A=o.expectedType);for(let v=1;v<t.length;v+=2){const C=v===1?-1/0:t[v],P=t[v+1],k=v,U=v+1;if(typeof C!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(f.length&&f[f.length-1][0]>=C)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const $=o.parse(P,U,A);if(!$)return null;A=A||$.type,f.push([C,$])}return new Yh(A,u,f)}evaluate(t){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return u[0].evaluate(t);const A=o.length;return f>=o[A-1]?u[A-1].evaluate(t):u[fh(o,f)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){const t=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t}}const ql=.95047,za=1.08883,Cu=4/29,Os=6/29,fp=3*Os*Os,Cd=Os*Os*Os,jf=Math.PI/180,Md=180/Math.PI;function zc(s){return s>Cd?Math.pow(s,1/3):s/fp+Cu}function ts(s){return s>Os?s*s*s:fp*(s-Cu)}function Qh(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Mu(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function nm(s){const t=Mu(s.r),o=Mu(s.g),u=Mu(s.b),f=zc((.4124564*t+.3575761*o+.1804375*u)/ql),A=zc((.2126729*t+.7151522*o+.072175*u)/1);return{l:116*A-16,a:500*(f-A),b:200*(A-zc((.0193339*t+.119192*o+.9503041*u)/za)),alpha:s.a}}function Lc(s){let t=(s.l+16)/116,o=isNaN(s.a)?t:t+s.a/500,u=isNaN(s.b)?t:t-s.b/200;return t=1*ts(t),o=ql*ts(o),u=za*ts(u),new vi(Qh(3.2404542*o-1.5371385*t-.4985314*u),Qh(-.969266*o+1.8760108*t+.041556*u),Qh(.0556434*o-.2040259*t+1.0572252*u),s.alpha)}function Bc(s,t,o){const u=t-s;return s+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const xn={forward:nm,reverse:Lc,interpolate:function(s,t,o){return{l:hn(s.l,t.l,o),a:hn(s.a,t.a,o),b:hn(s.b,t.b,o),alpha:hn(s.alpha,t.alpha,o)}}},Pa={forward:function(s){const{l:t,a:o,b:u}=nm(s),f=Math.atan2(u,o)*Md;return{h:f<0?f+360:f,c:Math.sqrt(o*o+u*u),l:t,alpha:s.a}},reverse:function(s){const t=s.h*jf,o=s.c;return Lc({l:s.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:s.alpha})},interpolate:function(s,t,o){return{h:Bc(s.h,t.h,o),c:hn(s.c,t.c,o),l:hn(s.l,t.l,o),alpha:hn(s.alpha,t.alpha,o)}}};var qn=Object.freeze({__proto__:null,hcl:Pa,lab:xn});class Ro{constructor(t,o,u,f,A){this.type=t,this.operator=o,this.interpolation=u,this.input=f,this.labels=[],this.outputs=[];for(const[v,C]of A)this.labels.push(v),this.outputs.push(C)}static interpolationFactor(t,o,u,f){let A=0;if(t.name==="exponential")A=Kh(o,t.base,u,f);else if(t.name==="linear")A=Kh(o,1,u,f);else if(t.name==="cubic-bezier"){const v=t.controlPoints;A=new Pf(v[0],v[1],v[2],v[3]).solve(Kh(o,1,u,f))}return A}static parse(t,o){let[u,f,A,...v]=t;if(!Array.isArray(f)||f.length===0)return o.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const k=f[1];if(typeof k!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:k}}else{if(f[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const k=f.slice(1);if(k.length!==4||k.some((U=>typeof U!="number"||U<0||U>1)))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:k}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length-1>3&&(t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(A=o.parse(A,2,Kr),!A)return null;const C=[];let P=null;u==="interpolate-hcl"||u==="interpolate-lab"?P=Ws:o.expectedType&&o.expectedType.kind!=="value"&&(P=o.expectedType);for(let k=0;k<v.length;k+=2){const U=v[k],$=v[k+1],q=k+3,K=k+4;if(typeof U!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(C.length&&C[C.length-1][0]>=U)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const J=o.parse($,K,P);if(!J)return null;P=P||J.type,C.push([U,J])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Ro(P,u,f,A,C):o.error(`Type ${ma(P)} is not interpolatable.`)}evaluate(t){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);const f=this.input.evaluate(t);if(f<=o[0])return u[0].evaluate(t);const A=o.length;if(f>=o[A-1])return u[A-1].evaluate(t);const v=fh(o,f),C=Ro.interpolationFactor(this.interpolation,f,o[v],o[v+1]),P=u[v].evaluate(t),k=u[v+1].evaluate(t);return this.operator==="interpolate"?$a[this.type.kind.toLowerCase()](P,k,C):this.operator==="interpolate-hcl"?Pa.reverse(Pa.interpolate(Pa.forward(P),Pa.forward(k),C)):xn.reverse(xn.interpolate(xn.forward(P),xn.forward(k),C))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const o=[this.operator,t,this.input.serialize()];for(let u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o}}function Kh(s,t,o,u){const f=u-o,A=s-o;return f===0?0:t===1?A/f:(Math.pow(t,A)-1)/(Math.pow(t,f)-1)}class Wl{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let u=null;const f=o.expectedType;f&&f.kind!=="value"&&(u=f);const A=[];for(const C of t.slice(1)){const P=o.parse(C,1+A.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,A.push(P)}const v=f&&A.some((C=>yd(f,C.type)));return new Wl(v?Ti:u,A)}evaluate(t){let o,u=null,f=0;for(const A of this.args){if(f++,u=A.evaluate(t),u&&u instanceof Is&&!u.available&&(o||(o=u),u=null,f===this.args.length))return o;if(u!==null)break}return u}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}serialize(){const t=["coalesce"];return this.eachChild((o=>{t.push(o.serialize())})),t}}class ks{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const u=[];for(let A=1;A<t.length-1;A+=2){const v=t[A];if(typeof v!="string")return o.error(`Expected string, but found ${typeof v} instead.`,A);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",A);const C=o.parse(t[A+1],A+1);if(!C)return null;u.push([v,C])}const f=o.parse(t[t.length-1],t.length-1,o.expectedType,u);return f?new ks(u,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[o,u]of this.bindings)t.push(o,u.serialize());return t.push(this.result.serialize()),t}}class im{constructor(t,o,u){this.type=t,this.index=o,this.input=u}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Kr),f=o.parse(t[2],2,_s(o.expectedType||Ti));return u&&f?new im(f.type.itemType,u,f):null}evaluate(t){const o=this.index.evaluate(t),u=this.input.evaluate(t);if(o<0)throw new Mr("Array index out of bounds: negative index");if(o>=u.length)throw new Mr("Array index out of bounds: index exceeds array size");if(o!==Math.floor(o))throw new Mr("Array index must be an integer. Use at-interpolated for fractional indices");return u[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class La{constructor(t,o,u){this.type=t,this.index=o,this.input=u}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Kr),f=o.parse(t[2],2,_s(o.expectedType||Ti));return u&&f?new La(f.type.itemType,u,f):null}evaluate(t){const o=this.index.evaluate(t),u=this.input.evaluate(t);if(o<0)throw new Mr(`Array index out of bounds: ${o} < 0.`);if(o>u.length-1)throw new Mr(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o===Math.floor(o))return u[o];const f=Math.floor(o),A=Math.ceil(o),v=u[f],C=u[A];if(typeof v!="number"||typeof C!="number")throw new Mr(`Cannot interpolate between non-number values at index ${o}.`);const P=o-f;return v*(1-P)+C*P}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class Iu{constructor(t,o){this.type=Oi,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Ti),f=o.parse(t[2],2,Ti);return u&&f?vd(u.type,[Oi,Di,Kr,ul,Ti])?new Iu(u,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ma(u.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(u==null)return!1;if(!pu(o,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${ma(Ma(o))} instead.`);if(!pu(u,["string","array"]))throw new Mr(`Expected second argument to be of type array or string, but found ${ma(Ma(u))} instead.`);return u.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class cc{constructor(t,o,u){this.type=Kr,this.needle=t,this.haystack=o,this.fromIndex=u}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Ti),f=o.parse(t[2],2,Ti);if(!u||!f)return null;if(!vd(u.type,[Oi,Di,Kr,ul,Ti]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${ma(u.type)} instead`);if(t.length===4){const A=o.parse(t[3],3,Kr);return A?new cc(u,f,A):null}return new cc(u,f)}evaluate(t){const o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!pu(o,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${ma(Ma(o))} instead.`);if(!pu(u,["string","array"]))throw new Mr(`Expected second argument to be of type array or string, but found ${ma(Ma(u))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(t);return u.indexOf(o,f)}return u.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Cl{constructor(t,o,u,f,A,v){this.inputType=t,this.type=o,this.input=u,this.cases=f,this.outputs=A,this.otherwise=v}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let u,f;o.expectedType&&o.expectedType.kind!=="value"&&(f=o.expectedType);const A={},v=[];for(let k=2;k<t.length-1;k+=2){let U=t[k];const $=t[k+1];Array.isArray(U)||(U=[U]);const q=o.concat(k);if(U.length===0)return q.error("Expected at least one branch label.");for(const J of U){if(typeof J!="number"&&typeof J!="string")return q.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return q.error("Numeric branch labels must be integer values.");if(u){if(q.checkSubtype(u,Ma(J)))return null}else u=Ma(J);if(A[String(J)]!==void 0)return q.error("Branch labels must be unique.");A[String(J)]=v.length}const K=o.parse($,k,f);if(!K)return null;f=f||K.type,v.push(K)}const C=o.parse(t[1],1,Ti);if(!C)return null;const P=o.parse(t[t.length-1],t.length-1,f);return P?C.type.kind!=="value"&&o.concat(1).checkSubtype(u,C.type)?null:new Cl(u,f,C,A,v,P):null}evaluate(t){const o=this.input.evaluate(t);return(mu(Ma(o),this.inputType)&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),u=[],f={};for(const v of o){const C=f[this.cases[v]];C===void 0?(f[this.cases[v]]=u.length,u.push([this.cases[v],[v]])):u[C][1].push(v)}const A=v=>this.inputType.kind==="number"?Number(v):v;for(const[v,C]of u)t.push(C.length===1?A(C[0]):C.map(A)),t.push(this.outputs[v].serialize());return t.push(this.otherwise.serialize()),t}}class Vr{constructor(t,o,u){this.type=t,this.branches=o,this.otherwise=u}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const f=[];for(let v=1;v<t.length-1;v+=2){const C=o.parse(t[v],v,Oi);if(!C)return null;const P=o.parse(t[v+1],v+1,u);if(!P)return null;f.push([C,P]),u=u||P.type}const A=o.parse(t[t.length-1],t.length-1,u);return A?new Vr(u,f,A):null}evaluate(t){for(const[o,u]of this.branches)if(o.evaluate(t))return u.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,u]of this.branches)t(o),t(u);t(this.otherwise)}outputDefined(){return this.branches.every((([t,o])=>o.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild((o=>{t.push(o.serialize())})),t}}class Jr{constructor(t,o,u,f){this.type=t,this.input=o,this.beginIndex=u,this.endIndex=f}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Ti),f=o.parse(t[2],2,Kr);if(!u||!f)return null;if(!vd(u.type,[_s(Ti),Di,Ti]))return o.error(`Expected first argument to be of type array or string, but found ${ma(u.type)} instead`);if(t.length===4){const A=o.parse(t[3],3,Kr);return A?new Jr(u.type,u,f,A):null}return new Jr(u.type,u,f)}evaluate(t){const o=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!pu(o,["string","array"]))throw new Mr(`Expected first argument to be of type array or string, but found ${ma(Ma(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(t);return o.slice(u,f)}return o.slice(u)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class Id{constructor(t,o){this.type=_s(Di),this.str=t,this.delimiter=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Di),f=o.parse(t[2],2,Di);return u&&f?new Id(u,f):void 0}evaluate(t){const o=this.str.evaluate(t),u=this.delimiter.evaluate(t);return o.split(u)}eachChild(t){t(this.str),t(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function Jh(s,t){return s==="=="||s==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function ef(s,t,o,u){return u.compare(t,o)===0}function Ml(s,t,o){const u=s!=="=="&&s!=="!=";return class sj{constructor(A,v,C){this.type=Oi,this.lhs=A,this.rhs=v,this.collator=C,this.hasUntypedArgument=A.type.kind==="value"||v.type.kind==="value"}static parse(A,v){if(A.length!==3&&A.length!==4)return v.error("Expected two or three arguments.");const C=A[0];let P=v.parse(A[1],1,Ti);if(!P)return null;if(!Jh(C,P.type))return v.concat(1).error(`"${C}" comparisons are not supported for type '${ma(P.type)}'.`);let k=v.parse(A[2],2,Ti);if(!k)return null;if(!Jh(C,k.type))return v.concat(2).error(`"${C}" comparisons are not supported for type '${ma(k.type)}'.`);if(P.type.kind!==k.type.kind&&P.type.kind!=="value"&&k.type.kind!=="value")return v.error(`Cannot compare types '${ma(P.type)}' and '${ma(k.type)}'.`);u&&(P.type.kind==="value"&&k.type.kind!=="value"?P=new cn(k.type,[P]):P.type.kind!=="value"&&k.type.kind==="value"&&(k=new cn(P.type,[k])));let U=null;if(A.length===4){if(P.type.kind!=="string"&&k.type.kind!=="string"&&P.type.kind!=="value"&&k.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(U=v.parse(A[3],3,ip),!U)return null}return new sj(P,k,U)}evaluate(A){const v=this.lhs.evaluate(A),C=this.rhs.evaluate(A);if(u&&this.hasUntypedArgument){const P=Ma(v),k=Ma(C);if(P.kind!==k.kind||P.kind!=="string"&&P.kind!=="number")throw new Mr(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${P.kind}, ${k.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=Ma(v),k=Ma(C);if(P.kind!=="string"||k.kind!=="string")return t(A,v,C)}return this.collator?o(A,v,C,this.collator.evaluate(A)):t(A,v,C)}eachChild(A){A(this.lhs),A(this.rhs),this.collator&&A(this.collator)}outputDefined(){return!0}serialize(){const A=[s];return this.eachChild((v=>{A.push(v.serialize())})),A}}}const dh=Ml("==",(function(s,t,o){return t===o}),ef),Pu=Ml("!=",(function(s,t,o){return t!==o}),(function(s,t,o,u){return!ef(0,t,o,u)})),Pd=Ml("<",(function(s,t,o){return t<o}),(function(s,t,o,u){return u.compare(t,o)<0})),Zl=Ml(">",(function(s,t,o){return t>o}),(function(s,t,o,u){return u.compare(t,o)>0})),b=Ml("<=",(function(s,t,o){return t<=o}),(function(s,t,o,u){return u.compare(t,o)<=0})),w=Ml(">=",(function(s,t,o){return t>=o}),(function(s,t,o,u){return u.compare(t,o)>=0}));class S{constructor(t,o,u,f,A,v){this.type=Di,this.number=t,this.locale=o,this.currency=u,this.unit=f,this.minFractionDigits=A,this.maxFractionDigits=v}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const u=o.parse(t[1],1,Kr);if(!u)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let A=null;if(f.locale&&(A=o.parseObjectValue(f.locale,2,"locale",Di),!A))return null;let v=null;if(f.currency&&(v=o.parseObjectValue(f.currency,2,"currency",Di),!v))return null;let C=null;if(f.unit&&(C=o.parseObjectValue(f.unit,2,"unit",Di),!C))return null;let P=null;if(f["min-fraction-digits"]&&(P=o.parseObjectValue(f["min-fraction-digits"],2,"min-fraction-digits",Kr),!P))return null;let k=null;return f["max-fraction-digits"]&&(k=o.parseObjectValue(f["max-fraction-digits"],2,"max-fraction-digits",Kr),!k)?null:new S(u,A,v,C,P,k)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class R{constructor(t){this.type=Kr,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const u=o.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${ma(u.type)} instead.`):new R(u):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Mr(`Expected value to be of type string or array, but found ${ma(Ma(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild((o=>{t.push(o.serialize())})),t}}function O(s){return function(){s=1831565813+(s|=0)|0;let t=Math.imul(s^s>>>15,1|s);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const j={"==":dh,"!=":Pu,">":Zl,"<":Pd,">=":w,"<=":b,array:cn,at:im,"at-interpolated":La,boolean:cn,case:Vr,coalesce:Wl,collator:Ja,format:So,image:_u,in:Iu,"index-of":cc,interpolate:Ro,"interpolate-hcl":Ro,"interpolate-lab":Ro,length:R,let:ks,literal:Mn,match:Cl,number:cn,"number-format":S,object:cn,slice:Jr,step:Yh,string:cn,"to-boolean":Ki,"to-color":Ki,"to-number":Ki,"to-string":Ki,var:Tu,within:Hh,distance:ka,config:Xh,split:Id};function V(s,[t,o,u,f]){t=t.evaluate(s),o=o.evaluate(s),u=u.evaluate(s);const A=f?f.evaluate(s):1,v=gu(t,o,u,A);if(v)throw new Mr(v);return new vi(t/255,o/255,u/255,A)}function Z(s,[t,o,u,f]){t=t.evaluate(s),o=o.evaluate(s),u=u.evaluate(s);const A=f?f.evaluate(s):1,v=(function(k,U,$,q){return typeof k=="number"&&k>=0&&k<=360?typeof U=="number"&&U>=0&&U<=100&&typeof $=="number"&&$>=0&&$<=100?q===void 0||typeof q=="number"&&q>=0&&q<=1?null:`Invalid hsla value [${[k,U,$,q].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof q=="number"?[k,U,$,q]:[k,U,$]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof q=="number"?[k,U,$,q]:[k,U,$]).join(", ")}]: 'h' must be between 0 and 360.`})(t,o,u,A);if(v)throw new Mr(v);const C=`hsla(${t}, ${o}%, ${u}%, ${A})`,P=vi.parse(C);if(!P)throw new Mr(`Failed to parse HSLA color: ${C}`);return P}function re(s,t){return s in t}function pe(s,t){const o=t[s];return o===void 0?null:o}function xe(s){return{type:s}}function qe(s){return{result:"success",value:s}}function nt(s){return{result:"error",value:s}}function ot(s,t){return!!s&&!!s.parameters&&s.parameters.indexOf(t)>-1}function at(s){return s["property-type"]==="data-driven"}function Rt(s){return ot(s.expression,"measure-light")}function jt(s){return ot(s.expression,"zoom")}function fr(s){return!!s.expression&&s.expression.interpolated}function Qt(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function qt(s){return s}function Dt(s,t){const o=t.type==="color",u=s.stops&&typeof s.stops[0][0]=="object",f=u||!(u||s.property!==void 0),A=s.type||(fr(t)?"exponential":"interval");if(o&&((s=Object.assign({},s)).stops&&(s.stops=s.stops.map((k=>[k[0],vi.parse(k[1])]))),s.default=vi.parse(s.default?s.default:t.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!qn[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let v,C,P;if(A==="exponential")v=ci;else if(A==="interval")v=an;else if(A==="categorical"){v=fn,C=Object.create(null);for(const k of s.stops)C[k[0]]=k[1];P=typeof s.stops[0][0]}else{if(A!=="identity")throw new Error(`Unknown function type "${A}"`);v=ui}if(u){const k={},U=[];for(let K=0;K<s.stops.length;K++){const J=s.stops[K],de=J[0].zoom;k[de]===void 0&&(k[de]={zoom:de,type:s.type,property:s.property,default:s.default,stops:[]},U.push(de)),k[de].stops.push([J[0].value,J[1]])}const $=[];for(const K of U)$.push([k[K].zoom,Dt(k[K],t)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:Ro.interpolationFactor.bind(void 0,q),zoomStops:$.map((K=>K[0])),evaluate:({zoom:K},J)=>ci({stops:$,base:s.base},t,K).evaluate(K,J)}}if(f){const k=A==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Ro.interpolationFactor.bind(void 0,k),zoomStops:s.stops.map((U=>U[0])),evaluate:({zoom:U})=>v(s,t,U,C,P)}}return{kind:"source",evaluate(k,U){const $=U&&U.properties?U.properties[s.property]:void 0;return $===void 0?yr(s.default,t.default):v(s,t,$,C,P)}}}function yr(s,t,o){return s!==void 0?s:t!==void 0?t:o!==void 0?o:void 0}function fn(s,t,o,u,f){return yr(typeof o===f?u[o]:void 0,s.default,t.default)}function an(s,t,o){if(!Uh(o))return yr(s.default,t.default);const u=s.stops.length;if(u===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[u-1][0])return s.stops[u-1][1];const f=fh(s.stops.map((A=>A[0])),o);return s.stops[f][1]}function ci(s,t,o){const u=s.base!==void 0?s.base:1;if(!Uh(o))return yr(s.default,t.default);const f=s.stops.length;if(f===1||o<=s.stops[0][0])return s.stops[0][1];if(o>=s.stops[f-1][0])return s.stops[f-1][1];const A=fh(s.stops.map((U=>U[0])),o),v=(function(U,$,q,K){const J=K-q,de=U-q;return J===0?0:$===1?de/J:(Math.pow($,de)-1)/(Math.pow($,J)-1)})(o,u,s.stops[A][0],s.stops[A+1][0]),C=s.stops[A][1],P=s.stops[A+1][1];let k=$a[t.type]||qt;if(s.colorSpace&&s.colorSpace!=="rgb"){const U=qn[s.colorSpace];k=($,q)=>U.reverse(U.interpolate(U.forward($),U.forward(q),v))}return typeof C.evaluate=="function"?{evaluate(...U){const $=C.evaluate.apply(void 0,U),q=P.evaluate.apply(void 0,U);if($!==void 0&&q!==void 0)return k($,q,v)}}:k(C,P,v)}function ui(s,t,o){return t.type==="color"?o=vi.parse(o):t.type==="formatted"?o=cs.fromString(o.toString()):t.type==="resolvedImage"?o=Is.build(o.toString()):gn(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0),yr(o,s.default,t.default)}Rs.register(j,{error:[{kind:"error"},[Di],(s,[t])=>{throw new Mr(t.evaluate(s))}],typeof:[Di,[Ti],(s,[t])=>ma(Ma(t.evaluate(s)))],"to-rgba":[_s(Kr,4),[Ws],(s,[t])=>t.evaluate(s).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[_s(Kr,4),[Ws],(s,[t])=>t.evaluate(s).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Ws,[Kr,Kr,Kr],V],rgba:[Ws,[Kr,Kr,Kr,Kr],V],hsl:[Ws,[Kr,Kr,Kr],Z],hsla:[Ws,[Kr,Kr,Kr,Kr],Z],has:{type:Oi,overloads:[[[Di],(s,[t])=>re(t.evaluate(s),s.properties())],[[Di,Bh],(s,[t,o])=>re(t.evaluate(s),o.evaluate(s))]]},get:{type:Ti,overloads:[[[Di],(s,[t])=>pe(t.evaluate(s),s.properties())],[[Di,Bh],(s,[t,o])=>pe(t.evaluate(s),o.evaluate(s))]]},"feature-state":[Ti,[Di],(s,[t])=>pe(t.evaluate(s),s.featureState||{})],properties:[Bh,[],s=>s.properties()],"geometry-type":[Di,[],s=>s.geometryType()],worldview:[Di,[],s=>s.globals.worldview||""],id:[Ti,[],s=>s.id()],zoom:[Kr,[],s=>s.globals.zoom],pitch:[Kr,[],s=>s.globals.pitch||0],"distance-from-center":[Kr,[],s=>s.distanceFromCenter()],"measure-light":[Kr,[Di],(s,[t])=>s.measureLight(t.evaluate(s))],"heatmap-density":[Kr,[],s=>s.globals.heatmapDensity||0],"line-progress":[Kr,[],s=>s.globals.lineProgress||0],"raster-value":[Kr,[],s=>s.globals.rasterValue||0],"raster-particle-speed":[Kr,[],s=>s.globals.rasterParticleSpeed||0],"sky-radial-progress":[Kr,[],s=>s.globals.skyRadialProgress||0],accumulated:[Ti,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[Kr,xe(Kr),(s,t)=>{let o=0;for(const u of t)o+=u.evaluate(s);return o}],"*":[Kr,xe(Kr),(s,t)=>{let o=1;for(const u of t)o*=u.evaluate(s);return o}],"-":{type:Kr,overloads:[[[Kr,Kr],(s,[t,o])=>t.evaluate(s)-o.evaluate(s)],[[Kr],(s,[t])=>-t.evaluate(s)]]},"/":[Kr,[Kr,Kr],(s,[t,o])=>t.evaluate(s)/o.evaluate(s)],"%":[Kr,[Kr,Kr],(s,[t,o])=>t.evaluate(s)%o.evaluate(s)],ln2:[Kr,[],()=>Math.LN2],pi:[Kr,[],()=>Math.PI],e:[Kr,[],()=>Math.E],"^":[Kr,[Kr,Kr],(s,[t,o])=>Math.pow(t.evaluate(s),o.evaluate(s))],sqrt:[Kr,[Kr],(s,[t])=>Math.sqrt(t.evaluate(s))],log10:[Kr,[Kr],(s,[t])=>Math.log(t.evaluate(s))/Math.LN10],ln:[Kr,[Kr],(s,[t])=>Math.log(t.evaluate(s))],log2:[Kr,[Kr],(s,[t])=>Math.log2(t.evaluate(s))],sin:[Kr,[Kr],(s,[t])=>Math.sin(t.evaluate(s))],cos:[Kr,[Kr],(s,[t])=>Math.cos(t.evaluate(s))],tan:[Kr,[Kr],(s,[t])=>Math.tan(t.evaluate(s))],asin:[Kr,[Kr],(s,[t])=>Math.asin(t.evaluate(s))],acos:[Kr,[Kr],(s,[t])=>Math.acos(t.evaluate(s))],atan:[Kr,[Kr],(s,[t])=>Math.atan(t.evaluate(s))],min:[Kr,xe(Kr),(s,t)=>Math.min(...t.map((o=>o.evaluate(s))))],max:[Kr,xe(Kr),(s,t)=>Math.max(...t.map((o=>o.evaluate(s))))],abs:[Kr,[Kr],(s,[t])=>Math.abs(t.evaluate(s))],round:[Kr,[Kr],(s,[t])=>{const o=t.evaluate(s);return o<0?-Math.round(-o):Math.round(o)}],floor:[Kr,[Kr],(s,[t])=>Math.floor(t.evaluate(s))],ceil:[Kr,[Kr],(s,[t])=>Math.ceil(t.evaluate(s))],"filter-==":[Oi,[Di,Ti],(s,[t,o])=>s.properties()[t.value]===o.value],"filter-id-==":[Oi,[Ti],(s,[t])=>s.id()===t.value],"filter-type-==":[Oi,[Di],(s,[t])=>s.geometryType()===t.value],"filter-<":[Oi,[Di,Ti],(s,[t,o])=>{const u=s.properties()[t.value],f=o.value;return typeof u==typeof f&&u<f}],"filter-id-<":[Oi,[Ti],(s,[t])=>{const o=s.id(),u=t.value;return typeof o==typeof u&&o<u}],"filter->":[Oi,[Di,Ti],(s,[t,o])=>{const u=s.properties()[t.value],f=o.value;return typeof u==typeof f&&u>f}],"filter-id->":[Oi,[Ti],(s,[t])=>{const o=s.id(),u=t.value;return typeof o==typeof u&&o>u}],"filter-<=":[Oi,[Di,Ti],(s,[t,o])=>{const u=s.properties()[t.value],f=o.value;return typeof u==typeof f&&u<=f}],"filter-id-<=":[Oi,[Ti],(s,[t])=>{const o=s.id(),u=t.value;return typeof o==typeof u&&o<=u}],"filter->=":[Oi,[Di,Ti],(s,[t,o])=>{const u=s.properties()[t.value],f=o.value;return typeof u==typeof f&&u>=f}],"filter-id->=":[Oi,[Ti],(s,[t])=>{const o=s.id(),u=t.value;return typeof o==typeof u&&o>=u}],"filter-has":[Oi,[Ti],(s,[t])=>t.value in s.properties()],"filter-has-id":[Oi,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[Oi,[_s(Di)],(s,[t])=>t.value.indexOf(s.geometryType())>=0],"filter-id-in":[Oi,[_s(Ti)],(s,[t])=>t.value.indexOf(s.id())>=0],"filter-in-small":[Oi,[Di,_s(Ti)],(s,[t,o])=>o.value.indexOf(s.properties()[t.value])>=0],"filter-in-large":[Oi,[Di,_s(Ti)],(s,[t,o])=>(function(u,f,A,v){for(;A<=v;){const C=A+v>>1;if(f[C]===u)return!0;f[C]>u?v=C-1:A=C+1}return!1})(s.properties()[t.value],o.value,0,o.value.length-1)],all:{type:Oi,overloads:[[[Oi,Oi],(s,[t,o])=>t.evaluate(s)&&o.evaluate(s)],[xe(Oi),(s,t)=>{for(const o of t)if(!o.evaluate(s))return!1;return!0}]]},any:{type:Oi,overloads:[[[Oi,Oi],(s,[t,o])=>t.evaluate(s)||o.evaluate(s)],[xe(Oi),(s,t)=>{for(const o of t)if(o.evaluate(s))return!0;return!1}]]},"!":[Oi,[Oi],(s,[t])=>!t.evaluate(s)],"is-supported-script":[Oi,[Di],(s,[t])=>{const o=s.globals&&s.globals.isSupportedScript;return!o||o(t.evaluate(s))}],upcase:[Di,[Di],(s,[t])=>t.evaluate(s).toUpperCase()],downcase:[Di,[Di],(s,[t])=>t.evaluate(s).toLowerCase()],concat:[Di,xe(Ti),(s,t)=>t.map((o=>Ps(o.evaluate(s)))).join("")],"resolved-locale":[Di,[ip],(s,[t])=>t.evaluate(s).resolvedLocale()],random:[Kr,[Kr,Kr,Ti],(s,t)=>{const[o,u,f]=t.map((v=>v.evaluate(s)));if(o>u||o===u)return o;let A;if(typeof f=="string")A=(function(v){let C=0;if(v.length===0)return C;for(let P=0;P<v.length;P++)C=(C<<5)-C+v.charCodeAt(P),C|=0;return C})(f);else{if(typeof f!="number")throw new Mr(`Invalid seed input: ${f}`);A=f}return o+O(A)()*(u-o)}]});class yi{constructor(t,o,u,f,A){this.expression=t,this._warningHistory={},this._evaluator=new Zs(u,f,A),this._defaultValue=o?(function(v){return v.type==="color"&&(Qt(v.default)||Array.isArray(v.default))?new vi(0,0,0,0):v.type==="color"?vi.parse(v.default)||null:v.default===void 0?null:v.default})(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=kc(t)}evaluateWithoutErrorHandling(t,o,u,f,A,v,C,P){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=f||null,this._evaluator.availableImages=A||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=P||null,this.expression.evaluate(this._evaluator)}evaluate(t,o,u,f,A,v,C,P,k){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=A||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=C||null,this._evaluator.featureDistanceData=P||null,this._evaluator.iconImageUseTheme=k||null;try{const U=this.expression.evaluate(this._evaluator);if(U==null||typeof U=="number"&&U!=U)return this._defaultValue;if(this._enumValues&&!(U in this._enumValues))throw new Mr(`Expected value to be one of ${Object.keys(this._enumValues).map(($=>JSON.stringify($))).join(", ")}, but found ${JSON.stringify(U)} instead.`);return U}catch(U){return this._warningHistory[U.message]||(this._warningHistory[U.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${U.message}`)),this._defaultValue}}}function ni(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in j}function Tn(s,t,o,u,f){const A=new Eu(j,[],t?(function(C){const P={color:Ws,string:Di,number:Kr,enum:Di,boolean:Oi,formatted:th,resolvedImage:_d};return C.type==="array"?_s(P[C.value]||Ti,C.length):P[C.type]})(t):void 0,void 0,void 0,o,u,f),v=A.parse(s,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return v?qe(new yi(v,t,o,u,f)):nt(A.errors)}class Wr{constructor(t,o,u,f){this.kind=t,this._styleExpression=o,this.isLightConstant=u,this.isLineProgressConstant=f,this.isStateDependent=t!=="constant"&&!To(o.expression),this.configDependencies=kc(o.expression)}evaluateWithoutErrorHandling(t,o,u,f,A,v){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,f,A,v)}evaluate(t,o,u,f,A,v,C){return this._styleExpression.evaluate(t,o,u,f,A,v,void 0,void 0,C)}}class pi{constructor(t,o,u,f,A,v){this.kind=t,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!To(o.expression),this.isLightConstant=A,this.isLineProgressConstant=v,this.configDependencies=kc(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,o,u,f,A,v){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,f,A,v)}evaluate(t,o,u,f,A,v){return this._styleExpression.evaluate(t,o,u,f,A,v)}interpolationFactor(t,o,u){return this.interpolationType?Ro.interpolationFactor(this.interpolationType,t,o,u):0}}function hi(s,t,o,u,f){if((s=Tn(s,t,o,u,f)).result==="error")return s;const A=s.value.expression,v=Jo(A);if(!v&&!at(t))return nt([new Gl("","data expressions not supported")]);const C=Xs(A,["zoom","pitch","distance-from-center"]);if(!C&&!jt(t))return nt([new Gl("","zoom expressions not supported")]);const P=Xs(A,["measure-light"]);if(!P&&!Rt(t))return nt([new Gl("","measure-light expression not supported")]);const k=Xs(A,["line-progress"]);if(!k&&!(function(q){return ot(q.expression,"line-progress")})(t))return nt([new Gl("","line-progress expression not supported")]);const U=t.expression&&t.expression.relaxZoomRestriction,$=Eo(A);return $||C||U?$ instanceof Gl?nt([$]):$ instanceof Ro&&!fr(t)?nt([new Gl("",'"interpolate" expressions cannot be used with this property')]):qe($?new pi(v&&k?"camera":"composite",s.value,$.labels,$ instanceof Ro?$.interpolation:void 0,P,k):new Wr(v&&k?"constant":"source",s.value,P,k)):nt([new Gl("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class mi{constructor(t,o){this._parameters=t,this._specification=o,Object.assign(this,Dt(this._parameters,this._specification))}static deserialize(t){return new mi(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Eo(s){let t=null;if(s instanceof ks)t=Eo(s.result);else if(s instanceof Wl){for(const o of s.args)if(t=Eo(o),t)break}else(s instanceof Yh||s instanceof Ro)&&s.input instanceof Rs&&s.input.name==="zoom"&&(t=s);return t instanceof Gl||s.eachChild((o=>{const u=Eo(o);u instanceof Gl?t=u:t&&u&&t!==u&&(t=new Gl("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}var Ha,Uf,Cg=(function(){if(Uf)return Ha;Uf=1,Ha=t;var s=3;function t(o,u,f){var A=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var v=new Int32Array(this.arrayBuffer);o=v[0],this.d=(u=v[1])+2*(f=v[2]);for(var C=0;C<this.d*this.d;C++){var P=v[s+C],k=v[s+C+1];A.push(P===k?null:v.subarray(P,k))}var U=v[s+A.length+1];this.keys=v.subarray(v[s+A.length],U),this.bboxes=v.subarray(U),this.insert=this._insertReadonly}else{this.d=u+2*f;for(var $=0;$<this.d*this.d;$++)A.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=f,this.scale=u/o,this.uid=0;var q=f/u*o;this.min=-q,this.max=o+q}return t.prototype.insert=function(o,u,f,A,v){this._forEachCell(u,f,A,v,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(A),this.bboxes.push(v)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(o,u,f,A,v,C){this.cells[v].push(C)},t.prototype.query=function(o,u,f,A,v){var C=this.min,P=this.max;if(o<=C&&u<=C&&P<=f&&P<=A&&!v)return Array.prototype.slice.call(this.keys);var k=[];return this._forEachCell(o,u,f,A,this._queryCell,k,{},v),k},t.prototype._queryCell=function(o,u,f,A,v,C,P,k){var U=this.cells[v];if(U!==null)for(var $=this.keys,q=this.bboxes,K=0;K<U.length;K++){var J=U[K];if(P[J]===void 0){var de=4*J;(k?k(q[de+0],q[de+1],q[de+2],q[de+3]):o<=q[de+2]&&u<=q[de+3]&&f>=q[de+0]&&A>=q[de+1])?(P[J]=!0,C.push($[J])):P[J]=!1}}},t.prototype._forEachCell=function(o,u,f,A,v,C,P,k){for(var U=this._convertToCellCoord(o),$=this._convertToCellCoord(u),q=this._convertToCellCoord(f),K=this._convertToCellCoord(A),J=U;J<=q;J++)for(var de=$;de<=K;de++){var Ae=this.d*de+J;if((!k||k(this._convertFromCellCoord(J),this._convertFromCellCoord(de),this._convertFromCellCoord(J+1),this._convertFromCellCoord(de+1)))&&v.call(this,o,u,f,A,Ae,C,P,k))return}},t.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},t.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,u=s+this.cells.length+1+1,f=0,A=0;A<this.cells.length;A++)f+=this.cells[A].length;var v=new Int32Array(u+f+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;for(var C=u,P=0;P<o.length;P++){var k=o[P];v[s+P]=C,v.set(k,C),C+=k.length}return v[s+o.length]=C,v.set(this.keys,C),v[s+o.length+1]=C+=this.keys.length,v.set(this.bboxes,C),C+=this.bboxes.length,v.buffer},Ha})(),tf=hd(Cg);const Vf={};function Rr(s,t,o={}){Object.defineProperty(s,"_classRegistryKey",{value:t,writable:!1}),Vf[t]={klass:s,omit:o.omit||[]}}Rr(Object,"Object"),tf.serialize=function(s,t){const o=s.toArrayBuffer();return t&&t.add(o),{buffer:o}},tf.deserialize=function(s){return new tf(s.buffer)},Object.defineProperty(tf,"name",{value:"Grid"}),Rr(tf,"Grid"),delete rr.prototype.constructor,typeof DOMMatrix<"u"&&Rr(DOMMatrix,"DOMMatrix"),Rr(vi,"Color"),Rr(Error,"Error"),Rr(cs,"Formatted"),Rr(Fh,"FormattedSection"),Rr(su,"AJAXError"),Rr(Is,"ResolvedImage"),Rr(mi,"StylePropertyFunction"),Rr(yi,"StyleExpression",{omit:["_evaluator"]}),Rr(wl,"ImageId"),Rr(ys,"ImageVariant"),Rr(pi,"ZoomDependentExpression"),Rr(Wr,"ZoomConstantExpression"),Rr(Rs,"CompoundExpression",{omit:["_evaluate"]});for(const s in j)Vf[j[s]._classRegistryKey]||Rr(j[s],`Expression${s}`);function hl(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function aa(s){return self.ImageBitmap&&s instanceof ImageBitmap}function ph(s,t){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(hl(s)||aa(s))return t&&t.add(s),s;if(ArrayBuffer.isView(s))return t&&t.add(s.buffer),s;if(s instanceof ImageData)return t&&t.add(s.data.buffer),s;if(Array.isArray(s)){const o=[];for(const u of s)o.push(ph(u,t));return o}if(s instanceof Map){const o={$name:"Map",entries:[]};for(const[u,f]of s.entries())o.entries.push(ph(u),ph(f,t));return o}if(s instanceof Set){const o={$name:"Set"};let u=0;for(const f of s.values())o[++u]=ph(f);return o}if(s instanceof DOMMatrix){const o={$name:"DOMMatrix"},u=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const f of u)o[f]=s[f];return o}if(typeof s=="bigint")return{$name:"BigInt",value:s.toString()};if(typeof s=="object"){const o=s.constructor,u=o._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${o.name}".`);const f=o.serialize?o.serialize(s,t):{};if(!o.serialize){for(const A in s)s.hasOwnProperty(A)&&(Vf[u].omit.indexOf(A)>=0||(f[A]=ph(s[A],t)));s instanceof Error&&(f.message=s.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(f.$name=u),f}throw new Error("can't serialize object of type "+typeof s)}function Fc(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||hl(s)||aa(s)||ArrayBuffer.isView(s)||s instanceof ImageData)return s;if(Array.isArray(s))return s.map(Fc);if(typeof s=="object"){const t=s.$name||"Object";if(t==="Map"){const f=s.entries||[],A=new Map;for(let v=0;v<f.length;v+=2)A.set(Fc(f[v]),Fc(f[v+1]));return A}if(t==="Set"){const f=new Set;for(const A of Object.keys(s))A!=="$name"&&f.add(Fc(s[A]));return f}if(t==="DOMMatrix"){let f;return f=s.is2D?[s.a,s.b,s.c,s.d,s.e,s.f]:[s.m11,s.m12,s.m13,s.m14,s.m21,s.m22,s.m23,s.m24,s.m31,s.m32,s.m33,s.m34,s.m41,s.m42,s.m43,s.m44],new DOMMatrix(f)}if(t==="BigInt")return BigInt(s.value);const{klass:o}=Vf[t];if(!o)throw new Error(`Can't deserialize unregistered class "${t}".`);if(o.deserialize)return o.deserialize(s);const u=Object.create(o.prototype);for(const f of Object.keys(s))f!=="$name"&&(u[f]=Fc(s[f]));return u}throw new Error("can't deserialize object of type "+typeof s)}const dn={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519,Osage:s=>s>=66736&&s<=66815,"CJK Unified Ideographs Extension B":s=>s>=131072&&s<=173791};function om(s){for(const t of s)if(dp(t.charCodeAt(0)))return!0;return!1}function mh(s){for(const t of s)if(!Rd(t.charCodeAt(0)))return!1;return!0}function Rd(s){return!(dn.Arabic(s)||dn["Arabic Supplement"](s)||dn["Arabic Extended-A"](s)||dn["Arabic Presentation Forms-A"](s)||dn["Arabic Presentation Forms-B"](s))}function dp(s){return!(s!==746&&s!==747&&(s<4352||!(dn["Bopomofo Extended"](s)||dn.Bopomofo(s)||dn["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||dn["CJK Compatibility Ideographs"](s)||dn["CJK Compatibility"](s)||dn["CJK Radicals Supplement"](s)||dn["CJK Strokes"](s)||!(!dn["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||dn["CJK Unified Ideographs Extension A"](s)||dn["CJK Unified Ideographs"](s)||dn["Enclosed CJK Letters and Months"](s)||dn["Hangul Compatibility Jamo"](s)||dn["Hangul Jamo Extended-A"](s)||dn["Hangul Jamo Extended-B"](s)||dn["Hangul Jamo"](s)||dn["Hangul Syllables"](s)||dn.Hiragana(s)||dn["Ideographic Description Characters"](s)||dn.Kanbun(s)||dn["Kangxi Radicals"](s)||dn["Katakana Phonetic Extensions"](s)||dn.Katakana(s)&&s!==12540||!(!dn["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!dn["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||dn["Unified Canadian Aboriginal Syllabics"](s)||dn["Unified Canadian Aboriginal Syllabics Extended"](s)||dn["Vertical Forms"](s)||dn["Yijing Hexagram Symbols"](s)||dn["Yi Syllables"](s)||dn["Yi Radicals"](s))))}function pp(s){return!(dp(s)||(function(t){return!!(dn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||dn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||dn["Letterlike Symbols"](t)||dn["Number Forms"](t)||dn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||dn["Control Pictures"](t)&&t!==9251||dn["Optical Character Recognition"](t)||dn["Enclosed Alphanumerics"](t)||dn["Geometric Shapes"](t)||dn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||dn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||dn["CJK Symbols and Punctuation"](t)||dn.Katakana(t)||dn["Private Use Area"](t)||dn["CJK Compatibility Forms"](t)||dn["Small Form Variants"](t)||dn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(s))}function Mg(s){return dn.Arabic(s)||dn["Arabic Supplement"](s)||dn["Arabic Extended-A"](s)||dn["Arabic Presentation Forms-A"](s)||dn["Arabic Presentation Forms-B"](s)}function p0(s){return s>=1424&&s<=2303||dn["Arabic Presentation Forms-A"](s)||dn["Arabic Presentation Forms-B"](s)}function Ig(s,t){return!(!t&&p0(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||dn.Khmer(s))}function Pg(s){for(const t of s)if(p0(t.charCodeAt(0)))return!0;return!1}const Il={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let cA=null,zs=Il.unavailable,rf=null;const Rg=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(zs=Il.error),cA&&cA(s)};function uA(){hA.fire(new Ka("pluginStateChange",{pluginStatus:zs,pluginURL:rf}))}const hA=new Tc,am=function(){return zs},nf=function(){if(zs!==Il.deferred||!rf)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");zs=Il.loading,uA(),rf&&wc({url:rf},(s=>{s?Rg(s):(zs=Il.loaded,uA())}))},Ru={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>zs===Il.loaded||Ru.applyArabicShaping!=null,isLoading:()=>zs===Il.loading,setState(s){zs=s.pluginStatus,rf=s.pluginURL},isParsing:()=>zs===Il.parsing,isParsed:()=>zs===Il.parsed,getPluginURL:()=>rf};class co{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness,this.worldview=o.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return(function(o,u){for(const f of o)if(!Ig(f.charCodeAt(0),u))return!1;return!0})(t,Ru.isLoaded())}}class $f{constructor(t,o,u,f,A){this.property=t,this.value=o,this.expression=(function(v,C,P,k,U){if(Qt(v))return new mi(v,C);if(ni(v)||Array.isArray(v)&&v.length>0){const $=hi(v,C,P,k,U);if($.result==="error")throw new Error($.value.map((q=>`${q.key}: ${q.message}`)).join(", "));return $.value}{let $=v;return typeof v=="string"&&C.type==="color"&&($=vi.parse(v)),{kind:"constant",configDependencies:new Set,evaluate:()=>$}}})(o===void 0?t.specification.default:o,t.specification,u,f,A)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,u,f){return this.property.possiblyEvaluate(this,t,o,u,f)}}class fA{constructor(t,o,u,f){this.property=t,this.value=new $f(t,void 0,o,u,f)}transitioned(t,o){return new of(this.property,this.value,o,Object.assign({},t.transition,this.transition),t.now)}untransitioned(){return new of(this.property,this.value,null,{},0)}}class m0{constructor(t,o,u,f){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=o,this._options=u,this._iconImageUseTheme=f,this.configDependencies=new Set}getValue(t){return Un(this._values[t].value.value)}setValue(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new fA(this._values[t].property,this._scope,this._options,this._iconImageUseTheme)),this._values[t].value=new $f(this._values[t].property,o===null?void 0:Un(o),this._scope,this._options,this._iconImageUseTheme),this._values[t].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].value.expression.configDependencies]))}setTransitionOrValue(t,o){o&&(this._options=o);const u=this._properties.properties;if(t)for(const f in t){const A=t[f];if(f.endsWith("-transition")){const v=f.slice(0,-11);u[v]&&this.setTransition(v,A)}else u.hasOwnProperty(f)&&this.setValue(f,A)}}getTransition(t){return Un(this._values[t].transition)}setTransition(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new fA(this._values[t].property)),this._values[t].transition=Un(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(t[o]=u);const f=this.getTransition(o);f!==void 0&&(t[`${o}-transition`]=f)}return t}transitioned(t,o){const u=new dA(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].transitioned(t,o._values[f]);return u}untransitioned(){const t=new dA(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class of{constructor(t,o,u,f,A){const v=f.delay||0,C=f.duration||0;A=A||0,this.property=t,this.value=o,this.begin=A+v,this.end=this.begin+C,t.specification.transition&&(f.delay||f.duration)&&(this.prior=u)}possiblyEvaluate(t,o,u){const f=t.now||0,A=this.value.possiblyEvaluate(t,o,u),v=this.prior;if(v){if(f>this.end)return this.prior=null,A;if(this.value.isDataDriven())return this.prior=null,A;if(f<this.begin)return v.possiblyEvaluate(t,o,u);{const C=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(t,o,u),A,Me(C))}}return A}}class dA{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,u){const f=new Gf(this._properties);for(const A of Object.keys(this._values))f._values[A]=this._values[A].possiblyEvaluate(t,o,u);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Nc{constructor(t,o,u,f){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=o,this._options=u,this._iconImageUseTheme=f,this.configDependencies=new Set}getValue(t){return Un(this._values[t].value)}setValue(t,o){this._values[t]=new $f(this._values[t].property,o===null?void 0:Un(o),this._scope,this._options,this._iconImageUseTheme),this._values[t].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].expression.configDependencies]))}serialize(){const t={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(t[o]=u)}return t}possiblyEvaluate(t,o,u,f){const A=new Gf(this._properties);for(const v of Object.keys(this._values))A._values[v]=this._values[v].possiblyEvaluate(t,o,u,f);return A}}class Ah{constructor(t,o,u,f){this.property=t,this.value=o,this.parameters=u,this.iconImageUseTheme=f}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,u,f){return this.property.evaluate(this.value,this.parameters,t,o,u,f,this.iconImageUseTheme)}}class Gf{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class lr{constructor(t){this.specification=t}possiblyEvaluate(t,o){return t.expression.evaluate(o)}interpolate(t,o,u){const f=$a[this.specification.type];return f?f(t,o,u):t}}class xr{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,u,f,A){return t.expression.kind==="constant"||t.expression.kind==="camera"?new Ah(this,{kind:"constant",value:t.expression.evaluate(o,null,{},u,f,void 0,A)},o):new Ah(this,t.expression,o,A)}interpolate(t,o,u){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new Ah(this,{kind:"constant",value:void 0},t.parameters);const f=$a[this.specification.type];return f?new Ah(this,{kind:"constant",value:f(t.value.value,o.value.value,u)},t.parameters):t}evaluate(t,o,u,f,A,v,C){return t.kind==="constant"?t.value:t.evaluate(o,u,f,A,v,void 0,C)}}class Dd{constructor(t){this.specification=t}possiblyEvaluate(t,o,u,f){return!!t.expression.evaluate(o,null,{},u,f)}interpolate(){return!1}}class Go{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new co(0,{});for(const u in t){const f=t[u];f.specification.overridable&&this.overridableProperties.push(u);const A=this.defaultPropertyValues[u]=new $f(f,void 0),v=this.defaultTransitionablePropertyValues[u]=new fA(f);this.defaultTransitioningPropertyValues[u]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=A.possiblyEvaluate(o)}}}Rr(xr,"DataDrivenProperty"),Rr(lr,"DataConstantProperty"),Rr(Dd,"ColorRampProperty");var pt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function sm(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Hf(s){if(Array.isArray(s))return s.map(Hf);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const t={};for(const o in s)t[o]=Hf(s[o]);return t}return sm(s)}function lm(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const t of s.slice(1))if(!lm(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function Od(s,t="",o=null,u="fill"){if(s==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};lm(s)||(s=mp(s));const f=s;let A=!0;try{A=(function(U){if(!qf(U))return U;let $=Hf(U);return jc($),$=A0($),$})(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}let v=null,C=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){C=pt[`filter_${u}`];const U=Tn(A,C,t,o);if(U.result==="error")throw new Error(U.value.map(($=>`${$.key}: ${$.message}`)).join(", "));v=($,q,K)=>U.value.evaluate($,q,{},K)}let P=null,k=null;if(A!==f){const U=Tn(f,C,t,o);if(U.result==="error")throw new Error(U.value.map(($=>`${$.key}: ${$.message}`)).join(", "));P=($,q,K,J,de)=>U.value.evaluate($,q,{},K,void 0,void 0,J,de),k=!Jo(U.value.expression)}return{filter:v,dynamicFilter:P||void 0,needGeometry:Og(A),needFeature:!!k}}function A0(s){if(!Array.isArray(s))return s;const t=(function(o){if(g0.has(o[0])){for(let u=1;u<o.length;u++)if(qf(o[u]))return!0}return o})(s);return t===!0?t:t.map((o=>A0(o)))}function jc(s){let t=!1;const o=[];if(s[0]==="case"){for(let u=1;u<s.length-1;u+=2)t=t||qf(s[u]),o.push(s[u+1]);o.push(s[s.length-1])}else if(s[0]==="match"){t=t||qf(s[1]);for(let u=2;u<s.length-1;u+=2)o.push(s[u+1]);o.push(s[s.length-1])}else if(s[0]==="step"){t=t||qf(s[1]);for(let u=1;u<s.length-1;u+=2)o.push(s[u+1])}t&&(s.length=0,s.push("any",...o));for(let u=1;u<s.length;u++)jc(s[u])}function qf(s){if(!Array.isArray(s))return!1;if((t=s[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let o=1;o<s.length;o++)if(qf(s[o]))return!0;return!1}const g0=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Dg(s,t){return s<t?-1:s>t?1:0}function Og(s){if(!Array.isArray(s))return!1;if(s[0]==="within"||s[0]==="distance")return!0;for(let t=1;t<s.length;t++)if(Og(s[t]))return!0;return!1}function mp(s){if(!s)return!0;const t=s[0];return s.length<=1?t!=="any":t==="=="?pA(s[1],s[2],"=="):t==="!="?cm(pA(s[1],s[2],"==")):t==="<"||t===">"||t==="<="||t===">="?pA(s[1],s[2],t):t==="any"?(o=s.slice(1),["any"].concat(o.map(mp))):t==="all"?["all"].concat(s.slice(1).map(mp)):t==="none"?["all"].concat(s.slice(1).map(mp).map(cm)):t==="in"?_0(s[1],s.slice(2)):t==="!in"?cm(_0(s[1],s.slice(2))):t==="has"?mA(s[1]):t!=="!has"||cm(mA(s[1]));var o}function pA(s,t,o){switch(s){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,s,t]}}function _0(s,t){if(t.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((o=>typeof o!=typeof t[0]))?["filter-in-large",s,["literal",t.sort(Dg)]]:["filter-in-small",s,["literal",t]]}}function mA(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function cm(s){return["!",s]}const Ap="";function gp(s,t){return t?`${s}${Ap}${t}`:s}let y0;const v0=()=>y0||(y0=new Go({"icon-size":new xr(pt.layout_symbol["icon-size"]),"icon-image":new xr(pt.layout_symbol["icon-image"]),"icon-rotate":new xr(pt.layout_symbol["icon-rotate"]),"icon-offset":new xr(pt.layout_symbol["icon-offset"])}));class um{constructor(t,o,u,f,A,v){const C=Tn(t,pt.appearance.condition);if(C.result==="success"&&(this.condition=C.value),this.name=o,u){this.properties=new Gf(v0()),this.unevaluatedLayout=new Nc(v0(),f,A,v);for(const P in u)this.unevaluatedLayout.setValue(P,u[P])}}isActive(t){return!(this.condition||!t.isHidden||this.name!=="hidden")||this.condition.evaluate(t.globals,t.feature,t.featureState,t.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(t){return this.properties.get(t)}getUnevaluatedProperties(){return this.unevaluatedLayout}serialize(){const t={};return t.condition=this.condition.expression.serialize(),this.name&&(t.name=this.name),this.properties&&(t.properties=this.properties),t}}const AA="-transition",hm=new Set(["fill","line","background","hillshade","raster"]);class Ls extends Tc{constructor(t,o,u,f,A,v){if(super(),this.id=t.id,this.fqid=gp(this.id,u),this.type=t.type,this.scope=u,this.lut=f,this.options=A,this.iconImageUseTheme=v,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,t.type!=="custom"){if(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type&&t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"){this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter;const C=Tn(this.filter,pt[`filter_${t.type}`]);C.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...C.value.configDependencies]))}if(t.slot&&(this.slot=t.slot),t.appearances&&t.appearances.forEach((C=>{this.appearances.push(new um(C.condition,C.name,C.properties,this.scope,A,this.iconImageUseTheme))})),o.layout&&(this._unevaluatedLayout=new Nc(o.layout,this.scope,A,this.iconImageUseTheme),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new m0(o.paint,this.scope,A);for(const C in t.paint)this.setPaintProperty(C,t.paint[C]);for(const C in t.layout)this.setLayoutProperty(C,t.layout[C]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Gf(o.paint)}}}onAdd(t){}onRemove(t){}isDraped(t){return!this.is3D(!0)&&hm.has(this.type)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o){if(this.type==="custom"&&t==="visibility")return void(this.visibility=o);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(t){return t.endsWith(AA)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o){const u=this._transitionablePaint,f=u._properties.properties;if(t.endsWith(AA)){const $=t.slice(0,-11);return f[$]&&u.setTransition($,o||void 0),!1}if(!f[t])return!1;const A=u._values[t],v=A.value.isDataDriven(),C=A.value;u.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(t);const P=u._values[t].value,k=P.isDataDriven(),U=t.endsWith("pattern")||t==="line-dasharray";return k||v||U||this._handleOverridablePaintPropertyUpdate(t,C,P)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,o,u){return null}_handleOverridablePaintPropertyUpdate(t,o,u){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){const t={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(t.appearances=this.appearances.map((o=>o.serialize()))),zn(t,((o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length)))}is3D(t){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof Ah&&at(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(t){this._filterCompiled||(this._featureFilter=Od(this.filter,this.scope,t),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&(t.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRadius(t){}queryIntersectsFeature(t,o,u,f,A,v,C,P,k){}}const af={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class sf{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class _o{constructor(){this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&o.add(t.arrayBuffer),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ii(s,t=1){let o=0,u=0;return{members:s.map((f=>{const A=af[f.type].BYTES_PER_ELEMENT,v=o=kg(o,Math.max(t,A)),C=f.components||1;return u=Math.max(u,A),o+=A*C,{name:f.name,type:f.type,components:C,offset:v}})),size:kg(o,Math.max(u,t)),alignment:t}}function kg(s,t){return Math.ceil(s/t)*t}class uc extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const f=2*t;return this.int16[f+0]=o,this.int16[f+1]=u,t}}uc.prototype.bytesPerElement=4,Rr(uc,"StructArrayLayout2i4");class Du extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,u)}emplace(t,o,u,f){const A=3*t;return this.int16[A+0]=o,this.int16[A+1]=u,this.int16[A+2]=f,t}}Du.prototype.bytesPerElement=6,Rr(Du,"StructArrayLayout3i6");class gh extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,f){const A=this.length;return this.resize(A+1),this.emplace(A,t,o,u,f)}emplace(t,o,u,f,A){const v=4*t;return this.int16[v+0]=o,this.int16[v+1]=u,this.int16[v+2]=f,this.int16[v+3]=A,t}}gh.prototype.bytesPerElement=8,Rr(gh,"StructArrayLayout4i8");class Uc extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}Uc.prototype.bytesPerElement=4,Rr(Uc,"StructArrayLayout1f4");class _p extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,u)}emplace(t,o,u,f){const A=4*t,v=2*t;return this.int16[A+0]=o,this.int16[A+1]=u,this.float32[v+1]=f,t}}_p.prototype.bytesPerElement=8,Rr(_p,"StructArrayLayout2i1f8");class fm extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,u)}emplace(t,o,u,f){const A=4*t;return this.int16[A+0]=o,this.int16[A+1]=u,this.int16[A+2]=f,t}}fm.prototype.bytesPerElement=8,Rr(fm,"StructArrayLayout3i8");class gA extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,u,f,A)}emplace(t,o,u,f,A,v){const C=5*t;return this.int16[C+0]=o,this.int16[C+1]=u,this.int16[C+2]=f,this.int16[C+3]=A,this.int16[C+4]=v,t}}gA.prototype.bytesPerElement=10,Rr(gA,"StructArrayLayout5i10");class lf extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,u,f,A,v,C)}emplace(t,o,u,f,A,v,C,P){const k=6*t,U=12*t,$=3*t;return this.int16[k+0]=o,this.int16[k+1]=u,this.uint8[U+4]=f,this.uint8[U+5]=A,this.uint8[U+6]=v,this.uint8[U+7]=C,this.float32[$+2]=P,t}}lf.prototype.bytesPerElement=12,Rr(lf,"StructArrayLayout2i4ub1f12");class fl extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,u)}emplace(t,o,u,f){const A=3*t;return this.float32[A+0]=o,this.float32[A+1]=u,this.float32[A+2]=f,t}}fl.prototype.bytesPerElement=12,Rr(fl,"StructArrayLayout3f12");class ws extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,u,f,A)}emplace(t,o,u,f,A,v){const C=6*t,P=3*t;return this.uint16[C+0]=o,this.uint16[C+1]=u,this.uint16[C+2]=f,this.uint16[C+3]=A,this.float32[P+2]=v,t}}ws.prototype.bytesPerElement=12,Rr(ws,"StructArrayLayout4ui1f12");class Pl extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,f){const A=this.length;return this.resize(A+1),this.emplace(A,t,o,u,f)}emplace(t,o,u,f,A){const v=4*t;return this.uint16[v+0]=o,this.uint16[v+1]=u,this.uint16[v+2]=f,this.uint16[v+3]=A,t}}Pl.prototype.bytesPerElement=8,Rr(Pl,"StructArrayLayout4ui8");class Ou extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,u,f,A,v)}emplace(t,o,u,f,A,v,C){const P=6*t;return this.int16[P+0]=o,this.int16[P+1]=u,this.int16[P+2]=f,this.int16[P+3]=A,this.int16[P+4]=v,this.int16[P+5]=C,t}}Ou.prototype.bytesPerElement=12,Rr(Ou,"StructArrayLayout6i12");class _A extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C,P,k,U,$,q){const K=this.length;return this.resize(K+1),this.emplace(K,t,o,u,f,A,v,C,P,k,U,$,q)}emplace(t,o,u,f,A,v,C,P,k,U,$,q,K){const J=12*t;return this.int16[J+0]=o,this.int16[J+1]=u,this.int16[J+2]=f,this.int16[J+3]=A,this.uint16[J+4]=v,this.uint16[J+5]=C,this.uint16[J+6]=P,this.uint16[J+7]=k,this.int16[J+8]=U,this.int16[J+9]=$,this.int16[J+10]=q,this.int16[J+11]=K,t}}_A.prototype.bytesPerElement=24,Rr(_A,"StructArrayLayout4i4ui4i24");class _h extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,u,f,A,v)}emplace(t,o,u,f,A,v,C){const P=10*t,k=5*t;return this.int16[P+0]=o,this.int16[P+1]=u,this.int16[P+2]=f,this.float32[k+2]=A,this.float32[k+3]=v,this.float32[k+4]=C,t}}_h.prototype.bytesPerElement=20,Rr(_h,"StructArrayLayout3i3f20");class Ss extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f){const A=this.length;return this.resize(A+1),this.emplace(A,t,o,u,f)}emplace(t,o,u,f,A){const v=4*t;return this.float32[v+0]=o,this.float32[v+1]=u,this.float32[v+2]=f,this.float32[v+3]=A,t}}Ss.prototype.bytesPerElement=16,Rr(Ss,"StructArrayLayout4f16");class Ra extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}Ra.prototype.bytesPerElement=4,Rr(Ra,"StructArrayLayout1ul4");class ha extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const f=2*t;return this.uint16[f+0]=o,this.uint16[f+1]=u,t}}ha.prototype.bytesPerElement=4,Rr(ha,"StructArrayLayout2ui4");class Wf extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C,P,k,U,$,q,K){const J=this.length;return this.resize(J+1),this.emplace(J,t,o,u,f,A,v,C,P,k,U,$,q,K)}emplace(t,o,u,f,A,v,C,P,k,U,$,q,K,J){const de=20*t,Ae=10*t;return this.int16[de+0]=o,this.int16[de+1]=u,this.int16[de+2]=f,this.int16[de+3]=A,this.int16[de+4]=v,this.float32[Ae+3]=C,this.float32[Ae+4]=P,this.float32[Ae+5]=k,this.float32[Ae+6]=U,this.int16[de+14]=$,this.uint32[Ae+8]=q,this.uint16[de+18]=K,this.uint16[de+19]=J,t}}Wf.prototype.bytesPerElement=40,Rr(Wf,"StructArrayLayout5i4f1i1ul2ui40");class yp extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,u,f,A,v,C)}emplace(t,o,u,f,A,v,C,P){const k=8*t;return this.int16[k+0]=o,this.int16[k+1]=u,this.int16[k+2]=f,this.int16[k+4]=A,this.int16[k+5]=v,this.int16[k+6]=C,this.int16[k+7]=P,t}}yp.prototype.bytesPerElement=16,Rr(yp,"StructArrayLayout3i2i2i16");class yA extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,u,f,A)}emplace(t,o,u,f,A,v){const C=4*t,P=8*t;return this.float32[C+0]=o,this.float32[C+1]=u,this.float32[C+2]=f,this.int16[P+6]=A,this.int16[P+7]=v,t}}yA.prototype.bytesPerElement=16,Rr(yA,"StructArrayLayout2f1f2i16");class vA extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,u,f,A,v)}emplace(t,o,u,f,A,v,C){const P=20*t,k=5*t;return this.uint8[P+0]=o,this.uint8[P+1]=u,this.float32[k+1]=f,this.float32[k+2]=A,this.float32[k+3]=v,this.float32[k+4]=C,t}}vA.prototype.bytesPerElement=20,Rr(vA,"StructArrayLayout2ub4f20");class ea extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u){const f=this.length;return this.resize(f+1),this.emplace(f,t,o,u)}emplace(t,o,u,f){const A=3*t;return this.uint16[A+0]=o,this.uint16[A+1]=u,this.uint16[A+2]=f,t}}ea.prototype.bytesPerElement=6,Rr(ea,"StructArrayLayout3ui6");class Zf extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e,Ie,Pe,ke,Ye){const Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e,Ie,Pe,ke,Ye)}emplace(t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e,Ie,Pe,ke,Ye,Qe){const tt=30*t,it=15*t,ct=60*t;return this.int16[tt+0]=o,this.int16[tt+1]=u,this.int16[tt+2]=f,this.float32[it+2]=A,this.float32[it+3]=v,this.uint16[tt+8]=C,this.uint16[tt+9]=P,this.uint32[it+5]=k,this.uint32[it+6]=U,this.uint32[it+7]=$,this.uint16[tt+16]=q,this.uint16[tt+17]=K,this.uint16[tt+18]=J,this.float32[it+10]=de,this.float32[it+11]=Ae,this.uint8[ct+48]=_e,this.uint8[ct+49]=Ie,this.uint8[ct+50]=Pe,this.uint32[it+13]=ke,this.int16[tt+28]=Ye,this.uint8[ct+58]=Qe,t}}Zf.prototype.bytesPerElement=60,Rr(Zf,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class xA extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e,Ie,Pe,ke,Ye,Qe,tt,it,ct,$t,mt,Wt,sr,Kt,er,hr,Nt){const tr=this.length;return this.resize(tr+1),this.emplace(tr,t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e,Ie,Pe,ke,Ye,Qe,tt,it,ct,$t,mt,Wt,sr,Kt,er,hr,Nt)}emplace(t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e,Ie,Pe,ke,Ye,Qe,tt,it,ct,$t,mt,Wt,sr,Kt,er,hr,Nt,tr){const Mt=20*t,St=40*t,pr=80*t;return this.float32[Mt+0]=o,this.float32[Mt+1]=u,this.int16[St+4]=f,this.int16[St+5]=A,this.int16[St+6]=v,this.int16[St+7]=C,this.int16[St+8]=P,this.int16[St+9]=k,this.int16[St+10]=U,this.int16[St+11]=$,this.int16[St+12]=q,this.uint16[St+13]=K,this.uint16[St+14]=J,this.uint16[St+15]=de,this.uint16[St+16]=Ae,this.uint16[St+17]=_e,this.uint16[St+18]=Ie,this.uint16[St+19]=Pe,this.uint16[St+20]=ke,this.uint16[St+21]=Ye,this.uint16[St+22]=Qe,this.uint16[St+23]=tt,this.uint16[St+24]=it,this.uint16[St+25]=ct,this.uint16[St+26]=$t,this.uint16[St+27]=mt,this.uint32[Mt+14]=Wt,this.float32[Mt+15]=sr,this.float32[Mt+16]=Kt,this.float32[Mt+17]=er,this.float32[Mt+18]=hr,this.uint8[pr+76]=Nt,this.uint16[St+39]=tr,t}}xA.prototype.bytesPerElement=80,Rr(xA,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class vp extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v){const C=this.length;return this.resize(C+1),this.emplace(C,t,o,u,f,A,v)}emplace(t,o,u,f,A,v,C){const P=6*t;return this.float32[P+0]=o,this.float32[P+1]=u,this.float32[P+2]=f,this.float32[P+3]=A,this.float32[P+4]=v,this.float32[P+5]=C,t}}vp.prototype.bytesPerElement=24,Rr(vp,"StructArrayLayout6f24");class Xf extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,u,f,A)}emplace(t,o,u,f,A,v){const C=5*t;return this.float32[C+0]=o,this.float32[C+1]=u,this.float32[C+2]=f,this.float32[C+3]=A,this.float32[C+4]=v,t}}Xf.prototype.bytesPerElement=20,Rr(Xf,"StructArrayLayout5f20");class xp extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,u,f,A,v,C)}emplace(t,o,u,f,A,v,C,P){const k=7*t;return this.float32[k+0]=o,this.float32[k+1]=u,this.float32[k+2]=f,this.float32[k+3]=A,this.float32[k+4]=v,this.float32[k+5]=C,this.float32[k+6]=P,t}}xp.prototype.bytesPerElement=28,Rr(xp,"StructArrayLayout7f28");class dm extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C,P,k,U,$){const q=this.length;return this.resize(q+1),this.emplace(q,t,o,u,f,A,v,C,P,k,U,$)}emplace(t,o,u,f,A,v,C,P,k,U,$,q){const K=11*t;return this.float32[K+0]=o,this.float32[K+1]=u,this.float32[K+2]=f,this.float32[K+3]=A,this.float32[K+4]=v,this.float32[K+5]=C,this.float32[K+6]=P,this.float32[K+7]=k,this.float32[K+8]=U,this.float32[K+9]=$,this.float32[K+10]=q,t}}dm.prototype.bytesPerElement=44,Rr(dm,"StructArrayLayout11f44");class kd extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C,P,k){const U=this.length;return this.resize(U+1),this.emplace(U,t,o,u,f,A,v,C,P,k)}emplace(t,o,u,f,A,v,C,P,k,U){const $=9*t;return this.float32[$+0]=o,this.float32[$+1]=u,this.float32[$+2]=f,this.float32[$+3]=A,this.float32[$+4]=v,this.float32[$+5]=C,this.float32[$+6]=P,this.float32[$+7]=k,this.float32[$+8]=U,t}}kd.prototype.bytesPerElement=36,Rr(kd,"StructArrayLayout9f36");class zd extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const f=2*t;return this.float32[f+0]=o,this.float32[f+1]=u,t}}zd.prototype.bytesPerElement=8,Rr(zd,"StructArrayLayout2f8");class pm extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,f){const A=this.length;return this.resize(A+1),this.emplace(A,t,o,u,f)}emplace(t,o,u,f,A){const v=6*t;return this.uint32[3*t+0]=o,this.uint16[v+2]=u,this.uint16[v+3]=f,this.uint16[v+4]=A,t}}pm.prototype.bytesPerElement=12,Rr(pm,"StructArrayLayout1ul3ui12");class bA extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}bA.prototype.bytesPerElement=2,Rr(bA,"StructArrayLayout1ui2");class wA extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae){const _e=this.length;return this.resize(_e+1),this.emplace(_e,t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae)}emplace(t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e){const Ie=16*t;return this.float32[Ie+0]=o,this.float32[Ie+1]=u,this.float32[Ie+2]=f,this.float32[Ie+3]=A,this.float32[Ie+4]=v,this.float32[Ie+5]=C,this.float32[Ie+6]=P,this.float32[Ie+7]=k,this.float32[Ie+8]=U,this.float32[Ie+9]=$,this.float32[Ie+10]=q,this.float32[Ie+11]=K,this.float32[Ie+12]=J,this.float32[Ie+13]=de,this.float32[Ie+14]=Ae,this.float32[Ie+15]=_e,t}}wA.prototype.bytesPerElement=64,Rr(wA,"StructArrayLayout16f64");class Ba extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,f,A,v,C){const P=this.length;return this.resize(P+1),this.emplace(P,t,o,u,f,A,v,C)}emplace(t,o,u,f,A,v,C,P){const k=10*t,U=5*t;return this.uint16[k+0]=o,this.uint16[k+1]=u,this.uint16[k+2]=f,this.uint16[k+3]=A,this.float32[U+2]=v,this.float32[U+3]=C,this.float32[U+4]=P,t}}Ba.prototype.bytesPerElement=20,Rr(Ba,"StructArrayLayout4ui3f20");class qa extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.int16[1*t+0]=o,t}}qa.prototype.bytesPerElement=2,Rr(qa,"StructArrayLayout1i2");class mm extends _o{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint8[1*t+0]=o,t}}mm.prototype.bytesPerElement=1,Rr(mm,"StructArrayLayout1ub1");class x0 extends sf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}x0.prototype.size=40;class SA extends Wf{get(t){return new x0(this,t)}}Rr(SA,"CollisionBoxArray");class b0 extends sf{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}b0.prototype.size=60;class Am extends Zf{get(t){return new b0(this,t)}}Rr(Am,"PlacedSymbolArray");class gm extends sf{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}gm.prototype.size=80;class TA extends xA{get(t){return new gm(this,t)}}Rr(TA,"SymbolInstanceArray");class w0 extends Uc{getoffsetX(t){return this.float32[1*t+0]}}Rr(w0,"GlyphOffsetArray");class S0 extends uc{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Rr(S0,"SymbolLineVertexArray");class EA extends sf{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}EA.prototype.size=12;class CA extends pm{get(t){return new EA(this,t)}}Rr(CA,"FeatureIndexArray");class MA extends ha{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Rr(MA,"FillExtrusionCentroidArray");class IA extends sf{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}IA.prototype.size=6;class T0 extends Du{get(t){return new IA(this,t)}}Rr(T0,"FillExtrusionWallArray");const E0=ii([{name:"a_pos",components:2,type:"Int16"}],4),PA=ii([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),C0=ii([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class No{constructor(t=[]){this.segments=t}_prepareSegment(t,o,u,f){let A=this.segments[this.segments.length-1];return t>No.MAX_VERTEX_ARRAY_LENGTH&&Fn(`Max vertices per segment is ${No.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!A||A.vertexLength+t>No.MAX_VERTEX_ARRAY_LENGTH||A.sortKey!==f)&&(A={vertexOffset:o,primitiveOffset:u,vertexLength:0,primitiveLength:0},f!==void 0&&(A.sortKey=f),this.segments.push(A)),A}prepareSegment(t,o,u,f){return this._prepareSegment(t,o.length,u.length,f)}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,u,f){return new No([{vertexOffset:t,primitiveOffset:o,vertexLength:u,primitiveLength:f,vaos:{},sortKey:0}])}}function Ld(s,t){return 256*(s=ce(Math.floor(s),0,255))+ce(Math.floor(t),0,255)}No.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rr(No,"SegmentVector");const zg=ii([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),cf=ii([{name:"a_pattern_b",components:4,type:"Uint16"}]),bp=ii([{name:"a_dash",components:4,type:"Uint16"}]);class _m{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,o,u,f){this.ids.push(RA(t)),this.positions.push(o,u,f)}eachPosition(t,o){const u=RA(t);let f=0,A=this.ids.length-1;for(;f<A;){const v=f+A>>1;this.ids[v]>=u?A=v:f=v+1}for(;this.ids[f]===u;)o(this.positions[3*f],this.positions[3*f+1],this.positions[3*f+2]),f++}static serialize(t,o){const u=new Float64Array(t.ids),f=new Uint32Array(t.positions);return ku(u,f,0,u.length-1),o&&(o.add(u.buffer),o.add(f.buffer)),{ids:u,positions:f}}static deserialize(t){const o=new _m;let u;o.ids=t.ids,o.positions=t.positions;for(const f of o.ids)f!==u&&o.uniqueIds.push(f),u=f;return o.indexed=!0,o}}function RA(s){const t=+s;return Number.isSafeInteger(t)?t:Oa(String(s))}function ku(s,t,o,u){for(;o<u;){const f=s[o+u>>1];let A=o-1,v=u+1;for(;;){do A++;while(s[A]<f);do v--;while(s[v]>f);if(A>=v)break;wp(s,A,v),wp(t,3*A,3*v),wp(t,3*A+1,3*v+1),wp(t,3*A+2,3*v+2)}v-o<u-v?(ku(s,t,o,v),o=v+1):(ku(s,t,v+1,u),u=v)}}function wp(s,t,o){const u=s[t];s[t]=s[o],s[o]=u}Rr(_m,"FeaturePositionMap");class hc{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,o),this.initialized=!0),!!this.location}set(t,o,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class uf extends hc{constructor(t){super(t),this.current=0}set(t,o,u){this.fetchUniformLocation(t,o)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class Ei extends hc{constructor(t){super(t),this.current=0}set(t,o,u){this.fetchUniformLocation(t,o)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class yh extends hc{constructor(t){super(t),this.current=[0,0]}set(t,o,u){this.fetchUniformLocation(t,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class ym extends hc{constructor(t){super(t),this.current=[0,0,0]}set(t,o,u){this.fetchUniformLocation(t,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Sp extends hc{constructor(t){super(t),this.current=[0,0,0,0]}set(t,o,u){this.fetchUniformLocation(t,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class Tp extends hc{constructor(t){super(t),this.current=vi.transparent.toPremultipliedRenderColor(null)}set(t,o,u){this.fetchUniformLocation(t,o)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const Yf=new Float32Array(16);class Ep extends hc{constructor(t){super(t),this.current=Yf}set(t,o,u){if(this.fetchUniformLocation(t,o)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let f=1;f<16;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const Lg=new Float32Array(9),vm=new Float32Array(4);class fc extends hc{constructor(t){super(t),this.current=vm}set(t,o,u){if(this.fetchUniformLocation(t,o)){for(let f=0;f<4;f++)if(u[f]!==this.current[f]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function Cp(s){return[Ld(255*s.r,255*s.g),Ld(255*s.b,255*s.a)]}class Rl{constructor(t,o,u,f){this.value=t,this.uniformNames=o.map((A=>`u_${A}`)),this.type=u,this.context=f}setUniform(t,o,u,f,A){const v=f.constantOr(this.value);o.set(t,A,v instanceof vi?v.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):v)}getBinding(t,o){return this.type==="color"?new Tp(t):new Ei(t)}}class Qf{constructor(t,o){this.uniformNames=o.map((u=>`u_${u}`)),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(t,o){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br),this.patternTransition=o?o.tl.concat(o.br):this.pattern}setUniform(t,o,u,f,A){let v=null;A!=="u_pattern"&&A!=="u_dash"||(v=this.pattern),A==="u_pattern_b"&&(v=this.patternTransition),A==="u_pixel_ratio"&&(v=this.pixelRatio),v&&o.set(t,A,v)}getBinding(t,o){return o==="u_pattern"||o==="u_pattern_b"||o==="u_dash"?new Sp(t):new Ei(t)}}class vh{constructor(t,o,u,f){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map((A=>({name:`a_${A}`,type:"Float32",components:u==="color"?2:1,offset:0}))),this.paintVertexArray=new f}populatePaintArray(t,o,u,f,A,v,C,P){const k=this.paintVertexArray.length,U=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new co(0,{brightness:v,worldview:P}),o,{},A,f,C):this.expression.kind==="constant"&&this.expression.value,$=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new co(0,{brightness:v,worldview:P}),o,{},A,f,C):this.lutExpression.value)==="none";this.paintVertexArray.resize(t),this._setPaintValue(k,t,U,$?null:this.context.lut)}updatePaintArray(t,o,u,f,A,v,C,P){const k=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:C,worldview:P},u,f,void 0,A):this.expression.kind==="constant"&&this.expression.value,U=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new co(0,{brightness:C,worldview:P}),u,f,void 0,A):this.lutExpression.value)==="none";this._setPaintValue(t,o,k,U?null:this.context.lut)}_setPaintValue(t,o,u,f){if(this.type==="color"){const A=Cp(u.toPremultipliedRenderColor(f));for(let v=t;v<o;v++)this.paintVertexArray.emplace(v,A[0],A[1])}else{for(let A=t;A<o;A++)this.paintVertexArray.emplace(A,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zu{constructor(t,o,u,f,A,v){this.expression=t,this.uniformNames=o.map((C=>`u_${C}_t`)),this.type=u,this.useIntegerZoom=f,this.context=A,this.maxValue=0,this.paintVertexAttributes=o.map((C=>({name:`a_${C}`,type:"Float32",components:u==="color"?4:2,offset:0}))),this.paintVertexArray=new v}populatePaintArray(t,o,u,f,A,v,C,P){const k=this.expression.evaluate(new co(this.context.zoom,{brightness:v,worldview:P}),o,{},A,f,C),U=this.expression.evaluate(new co(this.context.zoom+1,{brightness:v,worldview:P}),o,{},A,f,C),$=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new co(0,{brightness:v,worldview:P}),o,{},A,f,C):this.lutExpression.value)==="none",q=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(q,t,k,U,$?null:this.context.lut)}updatePaintArray(t,o,u,f,A,v,C,P){const k=this.expression.evaluate({zoom:this.context.zoom,brightness:C,worldview:P},u,f,void 0,A),U=this.expression.evaluate({zoom:this.context.zoom+1,brightness:C,worldview:P},u,f,void 0,A),$=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new co(0,{brightness:C,worldview:P}),u,f,void 0,A):this.lutExpression.value)==="none";this._setPaintValue(t,o,k,U,$?null:this.context.lut)}_setPaintValue(t,o,u,f,A){if(this.type==="color"){const v=Cp(u.toPremultipliedRenderColor(A)),C=Cp(u.toPremultipliedRenderColor(A));for(let P=t;P<o;P++)this.paintVertexArray.emplace(P,v[0],v[1],C[0],C[1])}else{for(let v=t;v<o;v++)this.paintVertexArray.emplace(v,u,f);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o,u,f,A){const v=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,C=ce(this.expression.interpolationFactor(v,this.context.zoom,this.context.zoom+1),0,1);o.set(t,A,C)}getBinding(t,o){return new Ei(t)}}class Vc{constructor(t,o,u,f,A){this.expression=t,this.layerId=A,this.paintVertexAttributes=(u==="array"?bp:zg).members;for(let v=0;v<o.length;++v);this.paintVertexArray=new f,this.paintTransitionVertexArray=new Pl}populatePaintArray(t,o,u,f){const A=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(A,t,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(t,o,u,f,A,v,C){this._setPaintValues(t,o,u.patterns&&u.patterns[this.layerId],v)}_setPaintValues(t,o,u,f){if(!f||!u)return;const A=f[u[0]],v=f[u[1]];if(A){if(A){const{tl:C,br:P,pixelRatio:k}=A;for(let U=t;U<o;U++)this.paintVertexArray.emplace(U,C[0],C[1],P[0],P[1],k)}if(v){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:C,br:P}=v;for(let k=t;k<o;k++)this.paintTransitionVertexArray.emplace(k,C[0],C[1],P[0],P[1])}}}upload(t){const o=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,o)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=t.createVertexBuffer(this.paintTransitionVertexArray,cf.members,o))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Kf{constructor(t,o,u=(()=>!0)){this.binders={},this._buffers=[],this.context=o;const f=[];for(const A in t.paint._values){const v=t.paint.get(A);if(A.endsWith("-use-theme")||!u(A)||!(v instanceof Ah&&at(v.property.specification)))continue;const C=Bg(A,t.type),P=v.value,k=v.property.specification.type,U=!!v.property.useIntegerZoom,$=A==="line-dasharray"||A.endsWith("pattern"),q=t.paint.get(`${A}-use-theme`),K=A==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant"||q&&q.value.kind!=="constant";if(P.kind!=="constant"||K)if(P.kind==="source"||K||$){const J=c(A,k,"source");this.binders[A]=$?new Vc(P,C,k,J,t.id):new vh(P,C,k,J),f.push(`/a_${A}`)}else{const J=c(A,k,"composite");this.binders[A]=new zu(P,C,k,U,o,J),f.push(`/z_${A}`)}else this.binders[A]=$?new Qf(P.value,C):new Rl(P.value,C,k,o),f.push(`/u_${A}`);q&&(this.binders[A].lutExpression=q.value)}this.cacheKey=f.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof vh||o instanceof zu?o.maxValue:0}populatePaintArrays(t,o,u,f,A,v,C,P){for(const k in this.binders){const U=this.binders[k];U.context=this.context,(U instanceof vh||U instanceof zu||U instanceof Vc)&&U.populatePaintArray(t,o,u,f,A,v,C,P)}}setConstantPatternPositions(t,o){for(const u in this.binders){const f=this.binders[u];f instanceof Qf&&f.setConstantPatternPositions(t,o)}}getPatternTransitionVertexBuffer(t){const o=this.binders[t];return o instanceof Vc?o.paintTransitionVertexBuffer:null}updatePaintArrays(t,o,u,f,A,v,C,P,k,U){let $=!1;const q=Object.keys(t),K=q.length!==0&&!P,J=K?q:o.uniqueIds;this.context.lut=A.lut;for(const de in this.binders){const Ae=this.binders[de];if(Ae.context=this.context,(Ae instanceof vh||Ae instanceof zu||Ae instanceof Vc)&&Ae.expression&&Ae.expression.kind&&Ae.expression.kind!=="constant"&&(Ae.expression.isStateDependent===!0||Ae.expression.isLightConstant===!1)){const _e=A.paint.get(de);Ae.expression=_e.value;for(const Ie of J){const Pe=t[Ie.toString()];o.eachPosition(Ie,((ke,Ye,Qe)=>{const tt=f.feature(ke);Ae.updatePaintArray(Ye,Qe,tt,Pe,v,C,k,U)}))}if(!K)for(const Ie of u.uniqueIds){const Pe=t[Ie.toString()];u.eachPosition(Ie,((ke,Ye,Qe)=>{const tt=f.feature(ke);Ae.updatePaintArray(Ye,Qe,tt,Pe,v,C,k,U)}))}$=!0}}return $}defines(){const t=[];for(const o in this.binders){const u=this.binders[o];(u instanceof Rl||u instanceof Qf)&&t.push(...u.uniformNames.map((f=>`#define HAS_UNIFORM_${f}`)))}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const o=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof Rl||f instanceof Qf||f instanceof zu)for(const A of f.uniformNames)o.push({name:A,property:u,binding:f.getBinding(t,A)})}return o}setUniforms(t,o,u,f,A){for(const{name:v,property:C,binding:P}of u)this.binders[C].setUniform(t,P,A,f.get(C),v)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const o=this.binders[t];(o instanceof vh||o instanceof zu||o instanceof Vc)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer),o instanceof Vc&&o.paintTransitionVertexBuffer&&this._buffers.push(o.paintTransitionVertexBuffer)}}upload(t){for(const o in this.binders){const u=this.binders[o];(u instanceof vh||u instanceof zu||u instanceof Vc)&&u.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof vh||o instanceof zu||o instanceof Vc)&&o.destroy()}}}class Ts{constructor(t,o,u=(()=>!0)){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new Kf(f,o,u);this.needsUpload=!1,this._featureMap=new _m,this._featureMapWithoutIds=new _m,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,o,u,f,A,v,C,P,k){for(const U in this.programConfigurations)this.programConfigurations[U].populatePaintArrays(t,o,f,A,v,C,P,k);o.id!==void 0?this._featureMap.add(o.id,u,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,u,f,A,v,C,P){for(const k of u)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,o,k,f,A,v,C||0,P)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const Wa={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function Bg(s,t){return Wa[s]||[s.replace(`${t}-`,"").replace(/-/g,"_")]}const p={"line-pattern":{source:ws,composite:ws},"fill-pattern":{source:ws,composite:ws},"fill-extrusion-pattern":{source:ws,composite:ws},"line-dasharray":{source:Pl,composite:Pl}},n={color:{source:zd,composite:Ss},number:{source:Uc,composite:zd}};function c(s,t,o){const u=p[s];return u&&u[o]||n[t][o]}Rr(Rl,"ConstantBinder"),Rr(Qf,"PatternConstantBinder"),Rr(vh,"SourceExpressionBinder"),Rr(Vc,"PatternCompositeBinder"),Rr(zu,"CompositeExpressionBinder"),Rr(Kf,"ProgramConfiguration",{omit:["_buffers"]}),Rr(Ts,"ProgramConfigurationSet");const d=mr/Math.PI/2,x=5,E=6,I=16383,D=64,N=[D,32,16],H=-d,W=d;function ee(s,t,o,u=d){return o=ut(o),[s*Math.sin(o)*u,-t*u,s*Math.cos(o)*u]}function Y(s,t,o){return ee(Math.cos(ut(s)),Math.sin(ut(s)),t,o)}const se=63710088e-1,fe=2*Math.PI*se;class he{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new he(Je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,u=this.lat*o,f=t.lat*o,A=Math.sin(u)*Math.sin(f)+Math.cos(u)*Math.cos(f)*Math.cos((t.lng-this.lng)*o);return se*Math.acos(Math.min(A,1))}toBounds(t=0){const o=360*t/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new Se({lng:this.lng-u,lat:this.lat-o},{lng:this.lng+u,lat:this.lat+o})}toEcef(t){return Y(this.lat,this.lng,d+t*d/se)}static convert(t){if(t instanceof he)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new he(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new he(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Se{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):Array.isArray(t)&&t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof he?new he(t.lng,t.lat):he.convert(t),this}setSouthWest(t){return this._sw=t instanceof he?new he(t.lng,t.lat):he.convert(t),this}extend(t){const o=this._sw,u=this._ne;let f,A;if(t instanceof he)f=t,A=t;else{if(!(t instanceof Se))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Se.convert(t)):this.extend(he.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(he.convert(t)):this;if(f=t._sw,A=t._ne,!f||!A)return this}return o||u?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),u.lng=Math.max(A.lng,u.lng),u.lat=Math.max(A.lat,u.lat)):(this._sw=new he(f.lng,f.lat),this._ne=new he(A.lng,A.lat)),this}getCenter(){return new he((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new he(this.getWest(),this.getNorth())}getSouthEast(){return new he(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:u}=he.convert(t);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&f}static convert(t){if(t)return t instanceof Se?t:new Se(t)}}const me=0,Te=25.5;function Oe(s){return fe*Math.cos(s*Math.PI/180)}function Le(s){return(180+s)/360}function Ge(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Ue(s,t){return s/Oe(t)}function Ze(s){return 360*s-180}function $e(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Ve(s,t){return s*Oe($e(t))}const We=85.051129;function yt(s){return Math.cos(ut(ce(s,-We,We)))}function lt(s,t){const o=ce(t,me,Te),u=Math.pow(2,o);return yt(s)*fe/(512*u)}function Ot(s){return 1/Math.cos(s*Math.PI/180)}function _t(s,t=0){const o=Math.exp(Math.PI*(1-(s.y+t/mr)/(1<<s.z)*2));return 80150034*o/(o*o+1)/mr/(1<<s.z)}class It{constructor(t,o,u=0){this.x=+t,this.y=+o,this.z=+u}static fromLngLat(t,o=0){const u=he.convert(t);return new It(Le(u.lng),Ge(u.lat),Ue(o,u.lat))}toLngLat(){return new he(Ze(this.x),$e(this.y))}toAltitude(){return Ve(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/fe*Ot($e(this.y))}}function ur(s,t,o,u,f,A,v,C,P){const k=(t+u)/2,U=(o+f)/2,$=new rr(k,U);C($),(function(q,K,J,de,Ae,_e){const Ie=J-Ae,Pe=de-_e;return Math.abs((de-K)*Ie-(J-q)*Pe)/Math.hypot(Ie,Pe)})($.x,$.y,A.x,A.y,v.x,v.y)>=P?(ur(s,t,o,k,U,A,$,C,P),ur(s,k,U,u,f,$,v,C,P)):s.push(v)}function xt(s,t,o){let u=s[0],f=u.x,A=u.y;t(u);const v=[u];for(let C=1;C<s.length;C++){const P=s[C],{x:k,y:U}=P;t(P),ur(v,f,A,k,U,u,P,t,o),f=k,A=U,u=P}return v}function rt(s,t,o,u){if(u(t,o)){const f=t.add(o)._mult(.5);rt(s,t,f,u),rt(s,f,o,u)}else s.push(o)}function zt(s,t){let o=s[0];const u=[o];for(let f=1;f<s.length;f++){const A=s[f];rt(u,o,A,t),o=A}return u}const gt=Math.pow(2,14)-1,Bt=-gt-1;function Gt(s,t){const o=Math.round(s.x*t),u=Math.round(s.y*t);return s.x=ce(o,Bt,gt),s.y=ce(u,Bt,gt),(o<s.x||o>s.x+1||u<s.y||u>s.y+1)&&Fn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function ar(s,t,o){const u=s.loadGeometry(),f=s.extent,A=mr/f;if(t&&o&&o.projection.isReprojectedInTileSpace){const v=1<<t.z,{scale:C,x:P,y:k,projection:U}=o,$=q=>{const K=Ze((t.x+q.x/f)/v),J=$e((t.y+q.y/f)/v),de=U.project(K,J);q.x=(de.x*C-P)*f,q.y=(de.y*C-k)*f};for(let q=0;q<u.length;q++)if(s.type!==1)u[q]=xt(u[q],$,1);else{const K=[];for(const J of u[q])J.x<0||J.x>=f||J.y<0||J.y>=f||($(J),K.push(J));u[q]=K}}for(const v of u)for(const C of v)Gt(C,A);return u}function Ht(s,t){return{type:s.type,id:s.id,properties:s.properties,geometry:t?ar(s):[]}}class Xt{constructor(t,o,u,f,A){this.properties={},this.extent=u,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=f,this._values=A,t.readFields(qr,this,o)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const o=t.readVarint()+t.pos,u=[];let f,A=1,v=0,C=0,P=0;for(;t.pos<o;){if(v<=0){const k=t.readVarint();A=7&k,v=k>>3}if(v--,A===1||A===2)C+=t.readSVarint(),P+=t.readSVarint(),A===1&&(f&&u.push(f),f=[]),f&&f.push(new rr(C,P));else{if(A!==7)throw new Error(`unknown command ${A}`);f&&f.push(f[0].clone())}}return f&&u.push(f),u}bbox(){const t=this._pbf;t.pos=this._geometry;const o=t.readVarint()+t.pos;let u=1,f=0,A=0,v=0,C=1/0,P=-1/0,k=1/0,U=-1/0;for(;t.pos<o;){if(f<=0){const $=t.readVarint();u=7&$,f=$>>3}if(f--,u===1||u===2)A+=t.readSVarint(),v+=t.readSVarint(),A<C&&(C=A),A>P&&(P=A),v<k&&(k=v),v>U&&(U=v);else if(u!==7)throw new Error(`unknown command ${u}`)}return[C,k,P,U]}toGeoJSON(t,o,u){const f=this.extent*Math.pow(2,u),A=this.extent*t,v=this.extent*o,C=this.loadGeometry();function P(q){return[360*(q.x+A)/f-180,360/Math.PI*Math.atan(Math.exp((1-2*(q.y+v)/f)*Math.PI))-90]}function k(q){return q.map(P)}let U;if(this.type===1){const q=[];for(const J of C)q.push(J[0]);const K=k(q);U=q.length===1?{type:"Point",coordinates:K[0]}:{type:"MultiPoint",coordinates:K}}else if(this.type===2){const q=C.map(k);U=q.length===1?{type:"LineString",coordinates:q[0]}:{type:"MultiLineString",coordinates:q}}else{if(this.type!==3)throw new Error("unknown feature type");{const q=(function(J){const de=J.length;if(de<=1)return[J];const Ae=[];let _e,Ie;for(let Pe=0;Pe<de;Pe++){const ke=$r(J[Pe]);ke!==0&&(Ie===void 0&&(Ie=ke<0),Ie===ke<0?(_e&&Ae.push(_e),_e=[J[Pe]]):_e&&_e.push(J[Pe]))}return _e&&Ae.push(_e),Ae})(C),K=[];for(const J of q)K.push(J.map(k));U=K.length===1?{type:"Polygon",coordinates:K[0]}:{type:"MultiPolygon",coordinates:K}}}const $={type:"Feature",geometry:U,properties:this.properties};return this.id!=null&&($.id=this.id),$}}function qr(s,t,o){s===1?t.id=o.readVarint():s===2?(function(u,f){const A=u.readVarint()+u.pos;for(;u.pos<A;){const v=f._keys[u.readVarint()],C=f._values[u.readVarint()];f.properties[v]=C}})(o,t):s===3?t.type=o.readVarint():s===4&&(t._geometry=o.pos)}function $r(s){let t=0;for(let o,u,f=0,A=s.length,v=A-1;f<A;v=f++)o=s[f],u=s[v],t+=(u.x-o.x)*(o.y+u.y);return t}Xt.types=["Unknown","Point","LineString","Polygon"];class Yr{constructor(t,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Lr,this,o),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const o=this._pbf.readVarint()+this._pbf.pos;return new Xt(this._pbf,o,this.extent,this._keys,this._values)}}function Lr(s,t,o){s===15?t.version=o.readVarint():s===1?t.name=o.readString():s===5?t.extent=o.readVarint():s===2?t._features.push(o.pos):s===3?t._keys.push(o.readString()):s===4&&t._values.push((function(u){let f=null;const A=u.readVarint()+u.pos;for(;u.pos<A;){const v=u.readVarint()>>3;f=v===1?u.readString():v===2?u.readFloat():v===3?u.readDouble():v===4?u.readVarint64():v===5?u.readVarint():v===6?u.readSVarint():v===7?u.readBoolean():null}if(f==null)throw new Error("unknown feature value");return f})(o))}class rn{constructor(t,o){this.layers=t.readFields(En,{},o)}}function En(s,t,o){if(s===3){const u=new Yr(o,o.readVarint()+o.pos);u.length&&(t[u.name]=u)}}const In="3d_elevation_id",ki="level";class _n{constructor(){this._valid=!1}reset(t){return this.feature=t,this._valid=!0,this._geometry=t.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(t,o){return this._valid&&t(o(this._geometry)),this}require(t,o,u){return this.get(t,!0,o,u)}optional(t,o,u){return this.get(t,!1,o,u)}success(){return this._valid}get(t,o,u,f){const A=this.feature.properties.hasOwnProperty(t)?+this.feature.properties[t]:void 0;return this._valid&&A!==void 0&&!Number.isNaN(A)?u(f?f(A):A):o&&(this._valid=!1),this}}class si{constructor(t,o){this.featureFunc=t,this.vertexFunc=o}parseFeature(t,o,u){return this.featureFunc(t,o,u)}parseVertex(t,o,u){return this.vertexFunc(t,o,u)}}const xi=new si(((s,t,o)=>s.reset(t).require(In,(u=>{o.id=u})).optional("fixed_height_relative",(u=>{o.constantHeight=u}),On.decodeRelativeHeight).geometry((u=>{o.bounds=u}),nh).success()),((s,t,o)=>s.reset(t).require(In,(u=>{o.id=u})).require("elevation_idx",(u=>{o.idx=u})).require("extent",(u=>{o.extent=u})).require("height_relative",(u=>{o.height=u}),On.decodeRelativeHeight).geometry((u=>{o.position=u}),On.getPoint).success())),Ci=new si(((s,t,o)=>s.reset(t).require(In,(u=>{o.id=u})).optional("fixed_height",(u=>{o.constantHeight=u}),On.decodeMetricHeight).geometry((u=>{o.bounds=u}),nh).success()),((s,t,o)=>s.reset(t).require(In,(u=>{o.id=u})).require("elevation_idx",(u=>{o.idx=u})).require("extent",(u=>{o.extent=u})).require("height",(u=>{o.height=u}),On.decodeMetricHeight).geometry((u=>{o.position=u}),On.getPoint).success()));class On{static getPoint(t){return os(t[0][0].x,t[0][0].y)}static decodeRelativeHeight(t){return 1e-4*t*5}static decodeMetricHeight(t){return 1e-4*t}static getVersionSchema(t){return t?t==="1.0.1"?Ci:void 0:xi}static parse(t){const o=[],u=[],f=t.length,A=new _n;for(let v=0;v<f;v++){const C=t.feature(v),P=C.properties.version,k=On.getVersionSchema(P);if(k===void 0){Fn(`Unknown elevation feature version number ${P||"(unknown)"}`);continue}const U=C.properties.type;if(!U)continue;const $=Xt.types[C.type];if($==="Point"&&U==="curve_point"){const q={};k.parseVertex(A,C,q)&&o.push(q)}else if($==="Polygon"&&U==="curve_meta"){const q={};k.parseFeature(A,C,q)&&u.push(q)}}return{vertices:o,features:u}}}class bi{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,u){const f=Ir(o,this.dir);if(Math.abs(f)<1e-6)return!1;const A=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1])/f;return u[0]=this.pos[0]+this.dir[0]*A,u[1]=this.pos[1]+this.dir[1]*A,!0}}class Ai{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,u){const f=Nn(o,this.dir);if(Math.abs(f)<1e-6)return!1;const A=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1]+(t[2]-this.pos[2])*o[2])/f;return u[0]=this.pos[0]+this.dir[0]*A,u[1]=this.pos[1]+this.dir[1]*A,u[2]=this.pos[2]+this.dir[2]*A,!0}closestPointOnSphere(t,o,u){if((function(K,J){var de=K[0],Ae=K[1],_e=K[2],Ie=J[0],Pe=J[1],ke=J[2];return Math.abs(de-Ie)<=z*Math.max(1,Math.abs(de),Math.abs(Ie))&&Math.abs(Ae-Pe)<=z*Math.max(1,Math.abs(Ae),Math.abs(Pe))&&Math.abs(_e-ke)<=z*Math.max(1,Math.abs(_e),Math.abs(ke))})(this.pos,t)||o===0)return u[0]=u[1]=u[2]=0,!1;const[f,A,v]=this.dir,C=this.pos[0]-t[0],P=this.pos[1]-t[1],k=this.pos[2]-t[2],U=f*f+A*A+v*v,$=2*(C*f+P*A+k*v),q=$*$-4*U*(C*C+P*P+k*k-o*o);if(q<0){const K=Math.max(-$/2,0),J=C+f*K,de=P+A*K,Ae=k+v*K,_e=Math.hypot(J,de,Ae);return u[0]=J*o/_e,u[1]=de*o/_e,u[2]=Ae*o/_e,!1}{const K=(-$-Math.sqrt(q))/(2*U);if(K<0){const J=Math.hypot(C,P,k);return u[0]=C*o/J,u[1]=P*o/J,u[2]=k*o/J,!1}return u[0]=C+f*K,u[1]=P+A*K,u[2]=k+v*K,!0}}}class wi{constructor(t,o,u,f,A){this.TL=t,this.TR=o,this.BR=u,this.BL=f,this.horizon=A}static fromInvProjectionMatrix(t,o,u){const f=[-1,1,1],A=[1,1,1],v=[1,-1,1],C=[-1,-1,1],P=Gr(f,f,t),k=Gr(A,A,t),U=Gr(v,v,t),$=Gr(C,C,t);return new wi(P,k,U,$,o/u)}}function Ji(s,t,o){let u=1/0,f=-1/0;const A=[];for(const v of s){Rn(A,v,t);const C=Nn(A,o);u=Math.min(u,C),f=Math.max(f,C)}return[u,f]}function Vi(s,t){let o=!0;for(let u=0;u<s.planes.length;u++){const f=s.planes[u];let A=0;for(let v=0;v<t.length;v++)A+=+(Nn(f,t[v])+f[3]>=0);if(A===0)return 0;A!==t.length&&(o=!1)}return o?2:1}function ta(s,t){for(const o of s.projections){const u=Ji(t,s.points[0],o.axis);if(o.projection[1]<u[0]||o.projection[0]>u[1])return 0}return 1}function so(s,t){let o=0;const u=[0,0,0,0];for(let v=0;v<s.length;v++)u[0]=s[v][0],u[1]=s[v][1],u[2]=s[v][2],u[3]=1,(f=u)[0]*(A=t)[0]+f[1]*A[1]+f[2]*A[2]+f[3]*A[3]>=0&&o++;var f,A;return o}class Pn{constructor(t,o){this.points=t||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=An.fromPoints(this.points),this.projections=[],this.frustumEdges=[Rn([],this.points[2],this.points[3]),Rn([],this.points[0],this.points[3]),Rn([],this.points[4],this.points[0]),Rn([],this.points[5],this.points[1]),Rn([],this.points[6],this.points[2]),Rn([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const f=[0,-u[2],u[1]],A=[u[2],0,-u[0]];this.projections.push({axis:f,projection:Ji(this.points,this.points[0],f)}),this.projections.push({axis:A,projection:Ji(this.points,this.points[0],A)})}}static fromInvProjectionMatrix(t,o,u,f){const A=Math.pow(2,u),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((k=>{const U=_i([],k,t),$=1/U[3]/o*A;return(q=U)[0]=(K=U)[0]*(J=[$,$,f?1/U[3]:$,$])[0],q[1]=K[1]*J[1],q[2]=K[2]*J[2],q[3]=K[3]*J[3],q;var q,K,J})),C=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((k=>{const U=Hr([],jn([],Rn([],v[k[0]],v[k[1]]),Rn([],v[k[2]],v[k[1]]))),$=-Nn(U,v[k[1]]);return U.concat($)})),P=[];for(let k=0;k<v.length;k++)P.push([v[k][0],v[k][1],v[k][2]]);return new Pn(P,C)}intersectsPrecise(t,o,u){for(let f=0;f<o.length;f++)if(!so(t,o[f]))return 0;for(let f=0;f<this.planes.length;f++)if(!so(t,this.planes[f]))return 0;for(const f of u)for(const A of this.frustumEdges){const v=jn([],f,A),C=Pt(v);if(C===0)continue;Vt(v,v,1/C);const P=Ji(this.points,this.points[0],v),k=Ji(t,this.points[0],v);if(P[0]>k[1]||k[0]>P[1])return 0}return 1}containsPoint(t){for(const o of this.planes){const u=o[3];if(Nn([o[0],o[1],o[2]],t)+u<0)return!1}return!0}}class An{static fromPoints(t){const o=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const f of t)or(o,o,f),ft(u,u,f);return new An(o,u)}static fromTileIdAndHeight(t,o,u){const f=1<<t.canonical.z,A=t.canonical.x,v=t.canonical.y;return new An([A/f,v/f,o],[(A+1)/f,(v+1)/f,u])}static applyTransform(t,o){const u=t.getCorners();for(let f=0;f<u.length;++f)Gr(u[f],u[f],o);return An.fromPoints(u)}static applyTransformFast(t,o){const u=[o[12],o[13],o[14]],f=[...u];for(let A=0;A<3;A++)for(let v=0;v<3;v++){const C=o[4*v+A],P=C*t.min[v],k=C*t.max[v];u[A]+=Math.min(P,k),f[A]+=Math.max(P,k)}return new An(u,f)}static projectAabbCorners(t,o){const u=t.getCorners();for(let f=0;f<u.length;++f)Gr(u[f],u[f],o);return u}constructor(t,o){this.min=t,this.max=o,this.center=Vt([],et([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],u=Re(this.min),f=Re(this.max);for(let A=0;A<o.length;A++)u[A]=o[A]?this.min[A]:this.center[A],f[A]=o[A]?this.center[A]:this.max[A];return f[2]=this.max[2],new An(u,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,o=this.max;return[[t[0],t[1],t[2]],[o[0],t[1],t[2]],[o[0],o[1],t[2]],[t[0],o[1],t[2]],[t[0],t[1],o[2]],[o[0],t[1],o[2]],[o[0],o[1],o[2]],[t[0],o[1],o[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?Vi(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?Vi(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,o){return o||this.intersects(t)?ta(t,this.getCorners()):0}intersectsPreciseFlat(t,o){return o||this.intersectsFlat(t)?ta(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let o=0;o<3;++o)if(this.min[o]>t.max[o]||t.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t.min[o]),this.max[o]=Math.max(this.max[o],t.max[o])}encapsulatePoint(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t[o]),this.max[o]=Math.max(this.max[o],t[o])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}Rr(An,"Aabb");class zi{constructor(t,o){this.feature=t,this.metersToTile=o,this.index=0}get(){const t=this.feature.vertices[this.index],o=this.feature.vertexProps[this.index].dir,u=o[1],f=-o[0],A=(t.extent+1)*this.metersToTile;return[new rr(Math.trunc(t.position[0]+u*A),Math.trunc(t.position[1]+f*A)),new rr(Math.trunc(t.position[0]-u*A),Math.trunc(t.position[1]-f*A))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class Ho{constructor(t,o,u,f,A,v){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[Mi(),Mi(),Mi(),Mi(),Mi(),Mi(),Mi()],this.id=t,this.heightRange={min:u,max:u},this.safeArea=o,this.constantHeight=u,this.constantHeight==null&&(this.constantHeight!=null||f.length!==0)){this.vertices=f,this.edges=A,this.edges=this.edges.filter((C=>{return C.a<this.vertices.length&&C.b<this.vertices.length&&!((P=this.vertices[C.a].position)[0]===(k=this.vertices[C.b].position)[0]&&P[1]===k[1]);var P,k})),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const C of this.vertices)this.vertexProps.push({dir:os(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,C.height),this.heightRange.max=Math.max(this.heightRange.max,C.height);for(const C of this.edges){const P=this.vertices[C.a].position,k=this.vertices[C.b].position,U=$n(Mi(),k,P),$=Xo(U),q=Qi(Mi(),U,1/$);this.edgeProps.push({vec:U,dir:q,len:$});const K=this.vertexProps[C.a].dir,J=this.vertexProps[C.b].dir;al(K,K,q),al(J,J,q)}for(const C of this.vertexProps)C.dir[0]===0&&C.dir[1]===0||ro(C.dir,C.dir);this.tessellate(v)}}pointElevation(t){if(this.constantHeight!=null)return this.constantHeight;const o=this.getClosestEdge(t);if(o==null)return 0;const[u,f]=o;return hn(this.vertices[this.edges[u].a].height,this.vertices[this.edges[u].b].height,f)}computeSlopeNormal(t,o){const u=this.getClosestEdge(t);if(!u)return wt(0,0,1);const f=u[0],A=this.edges[f],v=this.edgeProps[f].vec,C=wt(v[0],v[1],(this.vertices[A.b].height-this.vertices[A.a].height)*o),P=wt(C[1],-C[0],0);jn(P,P,C);const k=Pt(P);return k>0?Vt(P,P,1/k):Et(P,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(t){if(this.edges.length===0)return;let o=0,u=Number.POSITIVE_INFINITY,f=0;const[A,v,C,P,k,U,$]=this._tmpVec2;yl($,t.x,t.y);const q=new bi($,null);for(let K=0;K<this.edges.length;K++){const J=this.edges[K],de=this.edgeProps[K].dir;q.dir=de;const Ae=this.vertices[J.a].position,_e=this.vertices[J.b].position,Ie=q.intersectsPlane(Ae,this.vertexProps[J.a].dir,A),Pe=q.intersectsPlane(_e,this.vertexProps[J.b].dir,v);if(!Ie||!Pe)continue;$n(C,v,A),$n(P,$,A);const ke=Ir(C,C),Ye=ke>0?Ir(P,C)/ke:0,Qe=ce(Ye,0,1),tt=Math.abs((Ye-Qe)*this.edgeProps[K].len);$n(k,$,Ae),yl(U,de[1],-de[0]);const it=tt+Math.abs(Ir(k,U));it<u&&(o=K,u=it,f=Qe)}return[o,f]}tessellate(t){const o=ht(),u=ht(),f=ht(),A=ht();for(let v=this.edges.length-1;v>=0;--v){const C=this.edges[v].a,P=this.edges[v].b,{position:k,height:U,extent:$}=this.vertices[C],{position:q,height:K,extent:J}=this.vertices[P],de=this.vertexProps[C].dir,Ae=this.vertexProps[P].dir;if(Et(o,k[0]/t,k[1]/t,U),Et(u,q[0]/t,q[1]/t,K),Et(f,de[1],-de[0],0),Vt(f,f,$),Et(A,Ae[1],-Ae[0],0),Vt(A,A,J),this.distSqLines(wt(o[0]+.5*f[0],o[1]+.5*f[1],o[2]+.5*f[2]),wt(u[0]-.5*A[0],u[1]-.5*A[1],u[2]-.5*A[2]),wt(o[0]-.5*f[0],o[1]-.5*f[1],o[2]-.5*f[2]),wt(u[0]+.5*A[0],u[1]+.5*A[1],u[2]+.5*A[2]))<=.0025000000000000005)continue;const _e=this.vertices.length,Ie=al(Mi(),k,q);this.vertices.push({position:Qi(Ie,Ie,.5),height:.5*(U+K),extent:.5*($+J)});const Pe=al(Mi(),de,Ae);this.vertexProps.push({dir:ro(Pe,Pe)}),this.edges.splice(v,1),this.edgeProps.splice(v,1),this.edges.push({a:C,b:_e}),this.edges.push({a:_e,b:P});const ke=$n(Mi(),this.vertices[_e].position,k),Ye=Xo(ke),Qe={vec:ke,dir:Qi(Mi(),ke,1/Ye),len:Ye};this.edgeProps.push(Qe),this.edgeProps.push(Qe)}}distSqLines(t,o,u,f){const A=Zt(ht(),o,t),v=Zt(ht(),f,u),C=Zt(ht(),t,u),P=Nn(A,A),k=Nn(A,v),U=Nn(A,C),$=Nn(v,v),q=Nn(v,C),K=P*$-k*k;if(K===0)return Cr(Ur(A,u,f,Nn(C,v)/Nn(v,v)),t);const J=(P*q-k*U)/K;return Cr(Ur(A,t,o,(k*q-U*$)/K),Ur(v,u,f,J))}}class ho{static parseFrom(t,o){const u=On.parse(t);if(!u)return[];let{vertices:f,features:A}=u;const v=1/_t(o);A.sort(((U,$)=>U.id-$.id)),f.sort(((U,$)=>U.id-$.id||U.idx-$.idx)),f=f.filter(((U,$,q)=>$===q.findIndex((K=>K.id===U.id&&K.idx===U.idx))));const C=new Array;let P=0;const k=f.length;for(const U of A){if(U.constantHeight){C.push(new Ho(U.id,U.bounds,U.constantHeight));continue}for(;P!==k&&f[P].id<U.id;)P++;if(P===k||f[P].id!==U.id)continue;const $=new Array,q=new Array,K=P;for(;P!==k&&f[P].id===U.id;){const J=f[P];if($.push({position:J.position,height:J.height,extent:J.extent}),P!==K&&f[P-1].idx===J.idx-1){const de=P-K;q.push({a:de-1,b:de})}P++}C.push(new Ho(U.id,U.bounds,void 0,$,q,v))}return C}static getElevationFeature(t,o){if(!o)return;const u=+t.properties[In];return Number.isNaN(u)?void 0:o.find((f=>f.id===u))}}class sa{constructor(t,o){this.zScale=1,this.xOffset=0,this.yOffset=0,t.equals(o)||(this.zScale=Math.pow(2,o.z-t.z),this.xOffset=(t.x*this.zScale-o.x)*mr,this.yOffset=(t.y*this.zScale-o.y)*mr)}constantElevation(t,o){if(t.constantHeight!=null)return this.computeBiasedHeight(t.constantHeight,o)}pointElevation(t,o,u){const f=this.constantElevation(o,u);return f??(t.x=t.x*this.zScale+this.xOffset,t.y=t.y*this.zScale+this.yOffset,this.computeBiasedHeight(o.pointElevation(t),u))}computeBiasedHeight(t,o){return o<=0?t:t+o*At(0,o,t>=0?t:Math.abs(.5*t))}}Rr(Ho,"ElevationFeature");class qo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new uc,this.indexArray=new ea,this.segments=new No,this.programConfigurations=new Ts(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new Uc),this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,u,f){const A=this.layers[0],v=[];let C=null;A.type==="circle"&&(C=A.layout.get("circle-sort-key"));for(const{feature:k,id:U,index:$,sourceLayerIndex:q}of t){const K=this.layers[0]._featureFilter.needGeometry,J=Ht(k,K);if(!this.layers[0]._featureFilter.filter(new co(this.zoom,{worldview:this.worldview}),J,u))continue;const de=C?C.evaluate(J,{},u):void 0,Ae={id:U,properties:k.properties,type:k.type,sourceLayerIndex:q,index:$,geometry:K?J.geometry:ar(k,u,f),patterns:{},sortKey:de};v.push(Ae)}C&&v.sort(((k,U)=>k.sortKey-U.sortKey));let P=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new Ou,P=f.projection);for(const k of v){const{geometry:U,index:$,sourceLayerIndex:q}=k,K=t[$].feature;this.addFeature(k,U,$,o.availableImages,u,P,o.brightness,o.elevationFeatures),o.featureIndex.insert(K,U,$,q,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(t,o,u,f,A,v,C){this.programConfigurations.updatePaintArrays(t,o,A,u,f,v,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,E0.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,C0.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=t.createVertexBuffer(this.elevatedLayoutVertexArray,PA.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(t,o,u,f,A,v,C,P){let k;this.elevationMode!=="none"&&(k=ho.getElevationFeature(t,P));for(const U of o)for(const $ of U){const q=$.x,K=$.y;if(q<0||q>=mr||K<0||K>=mr)continue;if(v){const Ae=v.projectTilePoint(q,K,A),_e=v.upVector(A,q,K);this.addGlobeExtVertex(Ae,_e),this.addGlobeExtVertex(Ae,_e),this.addGlobeExtVertex(Ae,_e),this.addGlobeExtVertex(Ae,_e)}const J=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),de=J.vertexLength;if(this.addCircleVertex(q,K,-1,-1),this.addCircleVertex(q,K,1,-1),this.addCircleVertex(q,K,1,1),this.addCircleVertex(q,K,-1,1),this.elevationMode!=="none"){const Ae=k?k.pointElevation(new rr(q,K)):0;this.hasElevation=this.hasElevation||Ae!==0;for(let _e=0;_e<4;_e++)this.elevatedLayoutVertexArray.emplaceBack(Ae)}this.indexArray.emplaceBack(de,de+1,de+2),this.indexArray.emplaceBack(de,de+2,de+3),J.vertexLength+=4,J.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},f,A,C,void 0,this.worldview)}addCircleVertex(t,o,u,f){this.layoutVertexArray.emplaceBack(2*t+(u+1)/2,2*o+(f+1)/2)}addGlobeExtVertex(t,o){this.globeExtVertexArray.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}}function Xl(s,t){for(let o=0;o<s.length;o++)if(Fa(t,s[o]))return!0;for(let o=0;o<t.length;o++)if(Fa(s,t[o]))return!0;return!!dl(s,t)}function xa(s,t,o){return!!Fa(s,t)||!!jo(t,s,o)}function Dl(s,t){if(s.length===1)return ba(t,s[0]);for(let o=0;o<t.length;o++){const u=t[o];for(let f=0;f<u.length;f++)if(Fa(s,u[f]))return!0}for(let o=0;o<s.length;o++)if(ba(t,s[o]))return!0;for(let o=0;o<t.length;o++)if(dl(s,t[o]))return!0;return!1}function Ol(s,t,o){if(s.length>1){if(dl(s,t))return!0;for(let u=0;u<t.length;u++)if(jo(t[u],s,o))return!0}for(let u=0;u<s.length;u++)if(jo(s[u],t,o))return!0;return!1}function dl(s,t){if(s.length===0||t.length===0)return!1;for(let o=0;o<s.length-1;o++){const u=s[o],f=s[o+1];for(let A=0;A<t.length-1;A++)if(Es(u,f,t[A],t[A+1]))return!0}return!1}function Es(s,t,o,u){return go(s,o,u)!==go(t,o,u)&&go(s,t,o)!==go(s,t,u)}function Yl(s,t,o){return(s.x-o.x)*(t.y-o.y)-(s.y-o.y)*(t.x-o.x)}function Wo(s,t,o,u){const f=Yl(s,t,u),A=Yl(s,t,o);if(Math.sign(f)===Math.sign(A))return;const v=Yl(o,u,s),C=v+A-f;return Math.sign(v)!==Math.sign(C)?[v/(v-C),A/(A-f)]:void 0}function jo(s,t,o){const u=o*o;if(t.length===1)return s.distSqr(t[0])<u;for(let f=1;f<t.length;f++)if(Do(s,t[f-1],t[f])<u)return!0;return!1}function Do(s,t,o){const u=t.distSqr(o);if(u===0)return s.distSqr(t);const f=((s.x-t.x)*(o.x-t.x)+(s.y-t.y)*(o.y-t.y))/u;return s.distSqr(f<0?t:f>1?o:o.sub(t)._mult(f)._add(t))}function ba(s,t){let o,u,f,A=!1;for(let v=0;v<s.length;v++){o=s[v];for(let C=0,P=o.length-1;C<o.length;P=C++)u=o[C],f=o[P],u.y>t.y!=f.y>t.y&&t.x<(f.x-u.x)*(t.y-u.y)/(f.y-u.y)+u.x&&(A=!A)}return A}function Fa(s,t){let o=!1;for(let u=0,f=s.length-1;u<s.length;f=u++){const A=s[u],v=s[f];A.y>t.y!=v.y>t.y&&t.x<(v.x-A.x)*(t.y-A.y)/(v.y-A.y)+A.x&&(o=!o)}return o}function ra(s,t,o,u,f){for(const v of s)if(t<=v.x&&o<=v.y&&u>=v.x&&f>=v.y)return!0;const A=[new rr(t,o),new rr(t,f),new rr(u,f),new rr(u,o)];if(s.length>2){for(const v of A)if(Fa(s,v))return!0}for(let v=0;v<s.length-1;v++)if(us(s[v],s[v+1],A))return!0;return!1}function us(s,t,o){const u=o[0],f=o[2];if(s.x<u.x&&t.x<u.x||s.x>f.x&&t.x>f.x||s.y<u.y&&t.y<u.y||s.y>f.y&&t.y>f.y)return!1;const A=go(s,t,o[0]);return A!==go(s,t,o[1])||A!==go(s,t,o[2])||A!==go(s,t,o[3])}function xh(s,t,o,u,f,A){let v=t.y-s.y,C=s.x-t.x;if(A=A||0){const P=v*v+C*C;if(P===0)return!0;const k=Math.sqrt(P);v/=k,C/=k}return!((o.x-s.x)*v+(o.y-s.y)*C-A<0||(u.x-s.x)*v+(u.y-s.y)*C-A<0||(f.x-s.x)*v+(f.y-s.y)*C-A<0)}function hf(s,t,o,u,f,A,v){return!(xh(s,t,u,f,A,v)||xh(t,o,u,f,A,v)||xh(o,s,u,f,A,v)||xh(u,f,s,t,o,v)||xh(f,A,s,t,o,v)||xh(A,u,s,t,o,v))}function Lu(s,t,o){const u=t.paint.get(s).value;return u.kind==="constant"?u.value:o.programConfigurations.get(t.id).getMaxValue(s)}function ff(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function df(s,t,o,u,f){if(!t[0]&&!t[1])return s;const A=rr.convert(t)._mult(f);o==="viewport"&&A._rotate(-u);const v=[];for(let C=0;C<s.length;C++)v.push(s[C].sub(A));return v}function kl(s,t,o,u){const f=rr.convert(s)._mult(u);return t==="viewport"&&f._rotate(-o),f}let pf,bh;function Bu(s,t,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[s*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}Rr(qo,"CircleBucket",{omit:["layers"]});class wh{constructor(t,o,u){this.z=t,this.x=o,this.y=u,this.key=bm(0,t,t,o,u)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}isChildOf(t){const o=this.z-t.z;return t.z===0||t.z<this.z&&t.x===this.x>>o&&t.y===this.y>>o}url(t,o){const u=(function(A,v,C){var P=Bu(256*A,256*(v=Math.pow(2,C)-v-1),C),k=Bu(256*(A+1),256*(v+1),C);return P[0]+","+P[1]+","+k[0]+","+k[1]})(this.x,this.y,this.z),f=(function(A,v,C){let P,k="";for(let U=A;U>0;U--)P=1<<U-1,k+=(v&P?1:0)+(C&P?2:0);return k})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class xm{constructor(t,o){this.wrap=t,this.canonical=o,this.key=bm(t,o.z,o.z,o.x,o.y)}}class Ys{constructor(t,o,u,f,A){this.overscaledZ=t,this.wrap=o,this.canonical=new wh(u,+f,+A),this.key=o===0&&t===u?this.canonical.key:bm(o,t,u,f,A)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const o=this.canonical.z-t;return t>this.canonical.z?new Ys(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ys(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o=!0){if(this.overscaledZ===t&&o)return this.key;if(t>this.canonical.z)return bm(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-t;return bm(this.wrap*+o,t,t,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new Ys(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,f=2*this.canonical.y;return[new Ys(o,this.wrap,o,u,f),new Ys(o,this.wrap,o,u+1,f),new Ys(o,this.wrap,o,u,f+1),new Ys(o,this.wrap,o,u+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ys(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ys(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new xm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function bm(s,t,o,u,f){const A=1<<Math.min(o,22);let v=A*(f%A)+u%A;return s&&o<22&&(v+=A*A*((s<0?-2*s-1:2*s)%(1<<2*(22-o)))),16*(32*v+o)+(t-o)}const Fg=[s=>{let t=s.canonical.x-1,o=s.wrap;return t<0&&(t=(1<<s.canonical.z)-1,o--),new Ys(s.overscaledZ,o,s.canonical.z,t,s.canonical.y)},s=>{let t=s.canonical.x+1,o=s.wrap;return t===1<<s.canonical.z&&(t=0,o++),new Ys(s.overscaledZ,o,s.canonical.z,t,s.canonical.y)},s=>new Ys(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,(s.canonical.y===0?1<<s.canonical.z:s.canonical.y)-1),s=>new Ys(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y===(1<<s.canonical.z)-1?0:s.canonical.y+1)];Rr(wh,"CanonicalTileID"),Rr(Ys,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const Fx=ii([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:M0}=Fx,wa=ii([{name:"a_pos_3",components:3,type:"Int16"}]);var Ng=ii([{name:"a_pos",type:"Int16",components:2}]);function jg(s){return s*d/se}const Nx=[new An([H,H,H],[W,W,W]),new An([H,H,H],[0,0,W]),new An([0,H,H],[W,0,W]),new An([H,0,H],[0,W,W]),new An([0,0,H],[W,W,W])];function jx(s,t,o,u=!0){const f=Vt([],s._camera.position,s.worldSize),A=[t,o,1,1];_i(A,A,s.pixelMatrixInverse),eo(A,A,1/A[3]);const v=Hr([],Rn([],A,f)),C=s.globeMatrix,P=[C[12],C[13],C[14]],k=Rn([],P,f),U=Pt(k),$=Hr([],k),q=s.worldSize/(2*Math.PI),K=Nn($,v),J=Math.asin(q/U);if(J<Math.acos(K)){if(!u)return null;const $t=[],mt=[];Vt($t,v,U/K),Hr(mt,Rn(mt,$t,k)),Hr(v,et(v,k,Vt(v,mt,Math.tan(J)*U)))}const de=[];new Ai(f,v).closestPointOnSphere(P,q,de);const Ae=Hr([],He(C,0)),_e=Hr([],He(C,1)),Ie=Hr([],He(C,2)),Pe=Nn(Ae,de),ke=Nn(_e,de),Ye=Nn(Ie,de),Qe=le(Math.asin(-ke/q));let tt=le(Math.atan2(Pe,Ye));tt=s.center.lng+(function($t,mt){const Wt=(mt-$t+180)%360-180;return Wt<-180?Wt+360:Wt})(s.center.lng,tt);const it=Le(tt),ct=ce(Ge(Qe),0,1);return new It(it,ct)}class B2{constructor(t,o,u){this.a=Rn([],t,u),this.b=Rn([],o,u),this.center=u;const f=Hr([],this.a),A=Hr([],this.b);this.angle=Math.acos(Nn(f,A))}}function gy(s,t){if(s.angle===0)return null;let o;return o=s.a[t]===0?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[t]/s.a[t]/Math.sin(s.angle)-1/Math.tan(s.angle)),o<0||o>1?null:(function(u,f,A,v){const C=Math.sin(A);return u*(Math.sin((1-v)*A)/C)+f*(Math.sin(v*A)/C)})(s.a[t],s.b[t],s.angle,ce(o,0,1))+s.center[t]}function Fu(s){if(s.z<=1)return Nx[s.z+2*s.y+s.x];const t=Bd(DA(s));return An.fromPoints(t)}function $c(s,t,o){return Vt(s,s,1-o),Jt(s,s,t,o)}function Ug(s,t,o){for(const u of s)Gr(u,u,t),Vt(u,u,o)}function I0(s,t,o,u){const f=t/s.worldSize,A=s.globeMatrix;if(o.z<=1){const ct=Fu(o).getCorners();return Ug(ct,A,f),An.fromPoints(ct)}const v=DA(o,u),C=Bd(v,d+jg(s._tileCoverLift));Ug(C,A,f);const P=Number.MAX_VALUE,k=[-P,-P,-P],U=[P,P,P];if(v.contains(s.center)){for(const mt of C)or(U,U,mt),ft(k,k,mt);k[2]=0;const ct=s.point,$t=[ct.x*f,ct.y*f,0];return or(U,U,$t),ft(k,k,$t),new An(U,k)}if(s._tileCoverLift>0){for(const ct of C)or(U,U,ct),ft(k,k,ct);return new An(U,k)}const $=[A[12]*f,A[13]*f,A[14]*f],q=v.getCenter(),K=ce(s.center.lat,-We,We),J=ce(q.lat,-We,We),de=Le(s.center.lng),Ae=Ge(K);let _e=de-Le(q.lng);const Ie=Ae-Ge(J);_e>.5?_e-=1:_e<-.5&&(_e+=1);let Pe=0;Math.abs(_e)>Math.abs(Ie)?Pe=_e>=0?1:3:(Pe=Ie>=0?0:2,Jt($,$,[A[4]*f,A[5]*f,A[6]*f],-Math.sin(ut(Ie>=0?v.getSouth():v.getNorth()))*d));const ke=C[Pe],Ye=C[(Pe+1)%4],Qe=new B2(ke,Ye,$),tt=[gy(Qe,0)||ke[0],gy(Qe,1)||ke[1],gy(Qe,2)||ke[2]],it=Jf(s.zoom);if(it>0){const ct=(function({x:mt,y:Wt,z:sr},Kt,er,hr,Nt){const tr=1/(1<<sr);let Mt=mt*tr,St=Mt+tr,pr=Wt*tr,cr=pr+tr,nn=0;const kr=(Mt+St)/2-hr;return kr>.5?nn=-1:kr<-.5&&(nn=1),Mt=((Mt+nn)*Kt-(hr*=Kt))*er+hr,St=((St+nn)*Kt-hr)*er+hr,pr=(pr*Kt-(Nt*=Kt))*er+Nt,cr=(cr*Kt-Nt)*er+Nt,[[Mt,cr,0],[St,cr,0],[St,pr,0],[Mt,pr,0]]})(o,t,s._pixelsPerMercatorPixel,de,Ae);for(let mt=0;mt<C.length;mt++)$c(C[mt],ct[mt],it);const $t=et([],ct[Pe],ct[(Pe+1)%4]);Vt($t,$t,.5),$c(tt,$t,it)}for(const ct of C)or(U,U,ct),ft(k,k,ct);return U[2]=Math.min(ke[2],Ye[2]),or(U,U,tt),ft(k,k,tt),new An(U,k)}function DA({x:s,y:t,z:o},u=!1){const f=1/(1<<o),A=new he(Ze(s*f),t===(1<<o)-1&&u?-90:$e((t+1)*f)),v=new he(Ze((s+1)*f),t===0&&u?90:$e(t*f));return new Se(A,v)}function Bd(s,t=d){const o=ut(s.getNorth()),u=ut(s.getSouth()),f=Math.cos(o),A=Math.cos(u),v=Math.sin(o),C=Math.sin(u),P=s.getWest(),k=s.getEast();return[ee(A,C,P,t),ee(A,C,k,t),ee(f,v,k,t),ee(f,v,P,t)]}function Gc(s,t,o,u){const f=1<<o.z,A=(s/mr+o.x)/f;return Y($e((t/mr+o.y)/f),Ze(A),u)}function Mp({min:s,max:t}){return I/Math.max(t[0]-s[0],t[1]-s[1],t[2]-s[2])}const Ux=new Float64Array(16);function P0(s){const t=Mp(s),o=Ke(Ux,[t,t,t]);return we(o,o,tn([],s.min))}function Vg(s){const t=(u=s.min,(o=Ux)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=u[0],o[13]=u[1],o[14]=u[2],o[15]=1,o);var o,u;const f=1/Mp(s);return ve(t,t,[f,f,f])}function $g(s){const t=mr/(2*Math.PI);return s/(2*Math.PI)/t}function _y(s,t){return mr/(512*Math.pow(2,s))*Mp(Fu(t))}function Vx(s,t,o,u,f){const A=$g(o),v=[s,t,-o/(2*Math.PI)],C=oe(new Float64Array(16));return we(C,C,v),ve(C,C,[A,A,A]),Ce(C,C,ut(-f)),Ee(C,C,ut(-u)),C}function Jf(s){return At(x,E,s)}function yy(s,t){const o=Y(t.lat,t.lng),u=(function(J){const de=Y(J._center.lat,J._center.lng);let Ae=jn([],wt(0,1,0),de);const _e=st([],-J.angle,de);Ae=Gr(Ae,Ae,_e),st(_e,-J._pitch,Ae);const Ie=Hr([],de);return Vt(Ie,Ie,jg(J.cameraToCenterDistance/J.pixelsPerMeter)),Gr(Ie,Ie,_e),et([],de,Ie)})(s);return v=(f=Zt([],u,o))[0],C=f[1],P=f[2],k=(A=o)[0],U=A[1],$=A[2],K=(q=Math.sqrt((v*v+C*C+P*P)*(k*k+U*U+$*$)))&&Nn(f,A)/q,Math.acos(Math.min(Math.max(K,-1),1));var f,A,v,C,P,k,U,$,q,K}function Gg(s,t){return yy(s,t)>Math.PI/2*1.01}const $x=ut(85),vy=Math.cos($x),xy=Math.sin($x),F2=ne(),Gx=s=>{const t=[];return s.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),s.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function OA(s,t,o,u,f,A,v,C,P){if(A&&s.queryGeometry.isAboveHorizon)return!1;A&&(P*=s.pixelToTileUnitsFactor);const k=s.tileID.canonical,U=o.projection.upVectorScale(k,o.center.lat,o.worldSize).metersToTile;for(const $ of t)for(const q of $){const K=q.add(C),J=f&&o.elevation?o.elevation.exaggeration()*f.getElevationAt(K.x,K.y,!0):0,de=o.projection.projectTilePoint(K.x,K.y,k);if(J>0){const Pe=o.projection.upVector(k,K.x,K.y);de.x+=Pe[0]*U*J,de.y+=Pe[1]*U*J,de.z+=Pe[2]*U*J}const Ae=A?K:N2(de.x,de.y,de.z,u),_e=A?s.tilespaceRays.map((Pe=>wy(Pe,J))):s.queryGeometry.screenGeometry,Ie=_i([],[de.x,de.y,de.z,1],u);if(!v&&A?P*=Ie[3]/o.cameraToCenterDistance:v&&!A&&(P*=o.cameraToCenterDistance/Ie[3]),A){const Pe=$e((q.y/mr+k.y)/(1<<k.z));P/=o.projection.pixelsPerMeter(Pe,1)/Ue(1,Pe)}if(xa(_e,Ae,P))return!0}return!1}function N2(s,t,o,u){const f=_i([],[s,t,o,1],u);return new rr(f[0]/f[3],f[1]/f[3])}const by=wt(0,0,0),Oo=wt(0,0,1);function wy(s,t){const o=ht();return by[2]=t,s.intersectsPlane(by,Oo,o),new rr(o[0],o[1])}class R0 extends qo{}let Hg,Sy,qg,kA;function D0(s,{width:t,height:o},u,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*o*u)throw new RangeError("mismatched image size")}else f=new Uint8Array(t*o*u);return s.width=t,s.height=o,s.data=f,s}function wm(s,t,o){const{width:u,height:f}=t;u===s.width&&f===s.height||(Wg(s,t,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,u),height:Math.min(s.height,f)},o,null),s.width=u,s.height=f,s.data=t.data)}function Wg(s,t,o,u,f,A,v,C){if(f.width===0||f.height===0)return t;if(f.width>s.width||f.height>s.height||o.x>s.width-f.width||o.y>s.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||u.x>t.width-f.width||u.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const P=s.data,k=t.data,U=A===4&&C;for(let $=0;$<f.height;$++){const q=((o.y+$)*s.width+o.x)*A,K=((u.y+$)*t.width+u.x)*A;if(U)for(let J=0;J<f.width;J++){const de=q+J*A+3,Ae=K+J*A;k[Ae+0]=255,k[Ae+1]=255,k[Ae+2]=255,k[Ae+3]=P[de]}else if(v)for(let J=0;J<f.width;J++){const de=q+J*A,Ae=K+J*A,_e=new vi(P[de+0]/255,P[de+1]/255,P[de+2]/255,P[de+3]).toNonPremultipliedRenderColor(v).toArray();k[Ae+0]=_e[0],k[Ae+1]=_e[1],k[Ae+2]=_e[2],k[Ae+3]=_e[3]}else for(let J=0;J<f.width*A;J++)k[K+J]=P[q+J]}return t}Rr(R0,"HeatmapBucket",{omit:["layers"]});class Ip{constructor(t,o){D0(this,t,1,o)}resize(t){wm(this,new Ip(t),1)}clone(){return new Ip({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,u,f,A){Wg(t,o,u,f,A,1,null)}}class Bs{constructor(t,o){D0(this,t,4,o)}resize(t){wm(this,new Bs(t),4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Bs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,u,f,A,v,C){Wg(t,o,u,f,A,4,v,C)}}class Ty{constructor(t,o){this.width=t.width,this.height=t.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function zA(s){const t={},o=s.resolution||256,u=s.clips?s.clips.length:1,f=s.image||new Bs({width:o,height:u}),A=(v,C,P)=>{t[s.evaluationKey]=P;const k=s.expression.evaluate(t),U=k?k.toNonPremultipliedRenderColor(null):null;U&&(f.data[v+C+0]=Math.floor(255*U.r),f.data[v+C+1]=Math.floor(255*U.g),f.data[v+C+2]=Math.floor(255*U.b),f.data[v+C+3]=Math.floor(255*U.a))};if(s.clips)for(let v=0,C=0;v<u;++v,C+=4*o)for(let P=0,k=0;P<o;P++,k+=4){const U=P/(o-1),{start:$,end:q}=s.clips[v];A(C,k,$*(1-U)+q*U)}else for(let v=0,C=0;v<o;v++,C+=4)A(0,C,v/(o-1));return f}Rr(Ip,"AlphaImage"),Rr(Bs,"RGBAImage");const Zg=ii([{name:"a_pos",components:2,type:"Int16"}],4),ga=ii([{name:"a_road_z_offset",components:1,type:"Float32"}],4),Ey=ii([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),zl=ii([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function LA(s,t,o=2){const u=t&&t.length,f=u?t[0]*o:s.length;let A=Xg(s,0,f,o,!0);const v=[];if(!A||A.next===A.prev)return v;let C,P,k;if(u&&(A=(function(U,$,q,K){const J=[];for(let de=0,Ae=$.length;de<Ae;de++){const _e=Xg(U,$[de]*K,de<Ae-1?$[de+1]*K:U.length,K,!1);_e===_e.next&&(_e.steiner=!0),J.push(V2(_e))}J.sort(j2);for(let de=0;de<J.length;de++)q=Wx(J[de],q);return q})(s,t,A,o)),s.length>80*o){C=s[0],P=s[1];let U=C,$=P;for(let q=o;q<f;q+=o){const K=s[q],J=s[q+1];K<C&&(C=K),J<P&&(P=J),K>U&&(U=K),J>$&&($=J)}k=Math.max(U-C,$-P),k=k!==0?32767/k:0}return Pp(A,v,o,C,P,k,0),v}function Xg(s,t,o,u,f){let A;if(f===(function(v,C,P,k){let U=0;for(let $=C,q=P-k;$<P;$+=k)U+=(v[q]-v[$])*(v[$+1]+v[q+1]),q=$;return U})(s,t,o,u)>0)for(let v=t;v<o;v+=u)A=Iy(v/u|0,s[v],s[v+1],A);else for(let v=o-u;v>=t;v-=u)A=Iy(v/u|0,s[v],s[v+1],A);return A&&BA(A,A.next)&&(NA(A),A=A.next),A}function Fd(s,t){if(!s)return s;t||(t=s);let o,u=s;do if(o=!1,u.steiner||!BA(u,u.next)&&Na(u.prev,u,u.next)!==0)u=u.next;else{if(NA(u),u=t=u.prev,u===u.next)break;o=!0}while(o||u!==t);return t}function Pp(s,t,o,u,f,A,v){if(!s)return;!v&&A&&(function(P,k,U,$){let q=P;do q.z===0&&(q.z=Yg(q.x,q.y,k,U,$)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==P);q.prevZ.nextZ=null,q.prevZ=null,(function(K){let J,de=1;do{let Ae,_e=K;K=null;let Ie=null;for(J=0;_e;){J++;let Pe=_e,ke=0;for(let Qe=0;Qe<de&&(ke++,Pe=Pe.nextZ,Pe);Qe++);let Ye=de;for(;ke>0||Ye>0&&Pe;)ke!==0&&(Ye===0||!Pe||_e.z<=Pe.z)?(Ae=_e,_e=_e.nextZ,ke--):(Ae=Pe,Pe=Pe.nextZ,Ye--),Ie?Ie.nextZ=Ae:K=Ae,Ae.prevZ=Ie,Ie=Ae;_e=Pe}Ie.nextZ=null,de*=2}while(J>1)})(q)})(s,u,f,A);let C=s;for(;s.prev!==s.next;){const P=s.prev,k=s.next;if(A?qx(s,u,f,A):Hx(s))t.push(P.i,s.i,k.i),NA(s),s=k.next,C=k.next;else if((s=k)===C){v?v===1?Pp(s=Cy(Fd(s),t),t,o,u,f,A,2):v===2&&My(s,t,o,u,f,A):Pp(Fd(s),t,o,u,f,A,1);break}}}function Hx(s){const t=s.prev,o=s,u=s.next;if(Na(t,o,u)>=0)return!1;const f=t.x,A=o.x,v=u.x,C=t.y,P=o.y,k=u.y,U=Math.min(f,A,v),$=Math.min(C,P,k),q=Math.max(f,A,v),K=Math.max(C,P,k);let J=u.next;for(;J!==t;){if(J.x>=U&&J.x<=q&&J.y>=$&&J.y<=K&&Sh(f,C,A,P,v,k,J.x,J.y)&&Na(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function qx(s,t,o,u){const f=s.prev,A=s,v=s.next;if(Na(f,A,v)>=0)return!1;const C=f.x,P=A.x,k=v.x,U=f.y,$=A.y,q=v.y,K=Math.min(C,P,k),J=Math.min(U,$,q),de=Math.max(C,P,k),Ae=Math.max(U,$,q),_e=Yg(K,J,t,o,u),Ie=Yg(de,Ae,t,o,u);let Pe=s.prevZ,ke=s.nextZ;for(;Pe&&Pe.z>=_e&&ke&&ke.z<=Ie;){if(Pe.x>=K&&Pe.x<=de&&Pe.y>=J&&Pe.y<=Ae&&Pe!==f&&Pe!==v&&Sh(C,U,P,$,k,q,Pe.x,Pe.y)&&Na(Pe.prev,Pe,Pe.next)>=0||(Pe=Pe.prevZ,ke.x>=K&&ke.x<=de&&ke.y>=J&&ke.y<=Ae&&ke!==f&&ke!==v&&Sh(C,U,P,$,k,q,ke.x,ke.y)&&Na(ke.prev,ke,ke.next)>=0))return!1;ke=ke.nextZ}for(;Pe&&Pe.z>=_e;){if(Pe.x>=K&&Pe.x<=de&&Pe.y>=J&&Pe.y<=Ae&&Pe!==f&&Pe!==v&&Sh(C,U,P,$,k,q,Pe.x,Pe.y)&&Na(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.prevZ}for(;ke&&ke.z<=Ie;){if(ke.x>=K&&ke.x<=de&&ke.y>=J&&ke.y<=Ae&&ke!==f&&ke!==v&&Sh(C,U,P,$,k,q,ke.x,ke.y)&&Na(ke.prev,ke,ke.next)>=0)return!1;ke=ke.nextZ}return!0}function Cy(s,t){let o=s;do{const u=o.prev,f=o.next.next;!BA(u,f)&&Yx(u,o,o.next,f)&&dc(u,f)&&dc(f,u)&&(t.push(u.i,o.i,f.i),NA(o),NA(o.next),o=s=f),o=o.next}while(o!==s);return Fd(o)}function My(s,t,o,u,f,A){let v=s;do{let C=v.next.next;for(;C!==v.prev;){if(v.i!==C.i&&Xx(v,C)){let P=Kg(v,C);return v=Fd(v,v.next),P=Fd(P,P.next),Pp(v,t,o,u,f,A,0),void Pp(P,t,o,u,f,A,0)}C=C.next}v=v.next}while(v!==s)}function j2(s,t){let o=s.x-t.x;return o===0&&(o=s.y-t.y,o===0)&&(o=(s.next.y-s.y)/(s.next.x-s.x)-(t.next.y-t.y)/(t.next.x-t.x)),o}function Wx(s,t){const o=(function(f,A){let v=A;const C=f.x,P=f.y;let k,U=-1/0;if(BA(f,v))return v;do{if(BA(f,v.next))return v.next;if(P<=v.y&&P>=v.next.y&&v.next.y!==v.y){const de=v.x+(P-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(de<=C&&de>U&&(U=de,k=v.x<v.next.x?v:v.next,de===C))return k}v=v.next}while(v!==A);if(!k)return null;const $=k,q=k.x,K=k.y;let J=1/0;v=k;do{if(C>=v.x&&v.x>=q&&C!==v.x&&Zx(P<K?C:U,P,q,K,P<K?U:C,P,v.x,v.y)){const de=Math.abs(P-v.y)/(C-v.x);dc(v,f)&&(de<J||de===J&&(v.x>k.x||v.x===k.x&&U2(k,v)))&&(k=v,J=de)}v=v.next}while(v!==$);return k})(s,t);if(!o)return t;const u=Kg(o,s);return Fd(u,u.next),Fd(o,o.next)}function U2(s,t){return Na(s.prev,s,t.prev)<0&&Na(t.next,s,s.next)<0}function Yg(s,t,o,u,f){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-o)*f|0)|s<<8))|s<<4))|s<<2))|s<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-u)*f|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function V2(s){let t=s,o=s;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==s);return o}function Zx(s,t,o,u,f,A,v,C){return(f-v)*(t-C)>=(s-v)*(A-C)&&(s-v)*(u-C)>=(o-v)*(t-C)&&(o-v)*(A-C)>=(f-v)*(u-C)}function Sh(s,t,o,u,f,A,v,C){return!(s===v&&t===C)&&Zx(s,t,o,u,f,A,v,C)}function Xx(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!(function(o,u){let f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==u.i&&f.next.i!==u.i&&Yx(f,f.next,o,u))return!0;f=f.next}while(f!==o);return!1})(s,t)&&(dc(s,t)&&dc(t,s)&&(function(o,u){let f=o,A=!1;const v=(o.x+u.x)/2,C=(o.y+u.y)/2;do f.y>C!=f.next.y>C&&f.next.y!==f.y&&v<(f.next.x-f.x)*(C-f.y)/(f.next.y-f.y)+f.x&&(A=!A),f=f.next;while(f!==o);return A})(s,t)&&(Na(s.prev,s,t.prev)||Na(s,t.prev,t))||BA(s,t)&&Na(s.prev,s,s.next)>0&&Na(t.prev,t,t.next)>0)}function Na(s,t,o){return(t.y-s.y)*(o.x-t.x)-(t.x-s.x)*(o.y-t.y)}function BA(s,t){return s.x===t.x&&s.y===t.y}function Yx(s,t,o,u){const f=Qg(Na(s,t,o)),A=Qg(Na(s,t,u)),v=Qg(Na(o,u,s)),C=Qg(Na(o,u,t));return f!==A&&v!==C||!(f!==0||!FA(s,o,t))||!(A!==0||!FA(s,u,t))||!(v!==0||!FA(o,s,u))||!(C!==0||!FA(o,t,u))}function FA(s,t,o){return t.x<=Math.max(s.x,o.x)&&t.x>=Math.min(s.x,o.x)&&t.y<=Math.max(s.y,o.y)&&t.y>=Math.min(s.y,o.y)}function Qg(s){return s>0?1:s<0?-1:0}function dc(s,t){return Na(s.prev,s,s.next)<0?Na(s,t,s.next)>=0&&Na(s,s.prev,t)>=0:Na(s,t,s.prev)<0||Na(s,s.next,t)<0}function Kg(s,t){const o=Sm(s.i,s.x,s.y),u=Sm(t.i,t.x,t.y),f=s.next,A=t.prev;return s.next=t,t.prev=s,o.next=f,f.prev=o,u.next=o,o.prev=u,A.next=u,u.prev=A,u}function Iy(s,t,o,u){const f=Sm(s,t,o);return u?(f.next=u.next,f.prev=u,u.next.prev=f,u.next=f):(f.prev=f,f.next=f),f}function NA(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Sm(s,t,o){return{i:s,x:t,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Ql(s,t){const o=s.length;if(o<=1)return[s];const u=[];let f,A;for(let v=0;v<o;v++){const C=wo(s[v]);C!==0&&(s[v].area=Math.abs(C),A===void 0&&(A=C<0),A===C<0?(f&&u.push(f),f=[s[v]]):f.push(s[v]))}if(f&&u.push(f),t>1)for(let v=0;v<u.length;v++)u[v].length<=t||(ua(u[v],t,1,u[v].length-1,Qx),u[v]=u[v].slice(0,t));return u}function Qx(s,t){return t.area-s.area}function O0(s,t,o=1){if(!s)return null;const u=typeof s=="string"?Is.from(s).getPrimary():s.getPrimary(),f=typeof s=="string"?null:s.getSecondary();for(const A of[u,f]){if(!A)continue;const v=A.id.toString();t.has(v)||t.set(v,[]),A.scaleSelf(o),t.get(v).push(A)}return{primary:u.toString(),secondary:f?f.toString():null}}function mf(s,t,o,u){const f=u.patternDependencies;let A=!1;for(const v of t){const C=v.paint.get(`${s}-pattern`);C.isConstant()||(A=!0),O0(C.constantOr(null),f,o)&&(A=!0)}return A}function Py(s,t,o,u,f,A){const v=A.patternDependencies;for(const C of t){const P=C.paint.get(`${s}-pattern`).value;if(P.kind!=="constant"){let k=P.evaluate({zoom:u},o,{},A.availableImages);k=k&&k.name?k.name:k;const U=O0(k,v,f);if(!U)continue;const{primary:$,secondary:q}=U;$&&(o.patterns[C.id]=[$,q].filter(Boolean))}}return o}class Kx{constructor(){this.polygons=new Map}add(t,...o){const u=this.polygons.get(t);u?u.push(...o):this.polygons.set(t,o)}merge(t){for(const[o,u]of t.polygons)this.add(o,...u)}}class Hc{constructor(){this.portals=[]}static isOnBorder(t,o){return t<=0&&o<=0||t>=mr&&o>=mr}static evaluate(t){if(t.length===0)return new Hc;let o=[];for(const P of t)o.push(...P.portals);if(o.length===0)return new Hc;for(const P of o){const k=P.va,U=P.vb;(Hc.isOnBorder(k.x,U.x)||Hc.isOnBorder(k.y,U.y))&&(P.type="border")}const u=o.filter((P=>P.type!=="unevaluated")),f=o.filter((P=>P.type==="unevaluated"));if(f.length===0)return new Hc;f.sort(((P,k)=>P.hash===k.hash?P.isTunnel===k.isTunnel?0:P.isTunnel?-1:1:P.hash<k.hash?1:-1)),o=u.concat(f);let A=u.length,v=A,C=A;do if(v++,v===o.length||o[A].hash!==o[v].hash){if(v-A==2){C<A&&(o[C]=o[A],o[A]=null);const P=o[C],k=o[v-1];P.type=P.isTunnel!==k.isTunnel?"tunnel":"polygon",P.connection={a:P.connection.a,b:k.connection.a},C++}A=v}while(A!==o.length);return o.splice(C),o.sort(((P,k)=>P.hash<k.hash?1:-1)),{portals:o}}}Rr(Hc,"ElevationPortalGraph"),Rr(Kx,"ElevationPolygons");class Jx{constructor(t,o,u){this.outPositions=t,this.outNormals=o,this.outIndices=u,this.vertexLookup=new Map}addVertex(t,o,u){let f=t[2];u!=null&&(f*=u);const A=`${t[0]},${t[1]},${t[2]},${o[0]},${o[1]},${o[2]}`,v=this.vertexLookup.get(A);if(v!=null)return v;const C=this.outPositions.length;this.vertexLookup.set(A,C);const P=Math.trunc(16384*o[0]),k=Math.trunc(16384*o[1]),U=Math.trunc(16384*o[2]);return this.outPositions.emplaceBack(t[0],t[1],f),this.outNormals.emplaceBack(P,k,U),C}addTriangle(t,o,u){this.outIndices.emplaceBack(t,o,u)}addTriangles(t,o,u){if(t.length===0)return;const f=u.length===1,A=ht(),v=ht();for(let C=0;C<t.length;C+=3){const P=o[t[C+0]],k=o[t[C+1]],U=o[t[C+2]],$=f?u[0]:u[t[C+1]],q=f?u[0]:u[t[C+2]];Et(A,P.x,P.y,f?u[0]:u[t[C+0]]);const K=this.addVertex(A,v);Et(A,k.x,k.y,$);const J=this.addVertex(A,v);Et(A,U.x,U.y,q);const de=this.addVertex(A,v);this.outIndices.emplaceBack(K,J,de)}}addQuad(t,o,u,f,A,v){const C=this.addVertex(t,A,v),P=this.addVertex(o,A,v),k=this.addVertex(u,A,v),U=this.addVertex(f,A,v);this.addTriangle(C,P,k),this.addTriangle(k,U,C)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class pc{constructor(t,o,u,f){this.unevaluatedPortals=new Hc,this.portalPolygons=new Kx,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new _p,this.vertexNormals=new fm,this.indexArray=new ea,this.tileToMeters=_t(t),this.bridgeProgramConfigurations=new Ts(o,{zoom:u,lut:f},(A=>A!=="fill-tunnel-structure-color")),this.tunnelProgramConfigurations=new Ts(o,{zoom:u,lut:f},(A=>A!=="fill-bridge-guard-rail-color"))}addVertices(t,o){const u=this.unevalVertices.length;for(let f=0;f<t.length;f++)this.unevalVertices.push(t[f]),this.unevalHeights.push(o[f]);return u}addTriangles(t,o,u){const f=u?this.unevalTunnelTriangles:this.unevalTriangles;for(const A of t)f.push(A+o)}addRenderableRing(t,o,u,f,A,v){const C=[new rr(A.min.x,A.min.y),new rr(A.max.x,A.min.y),new rr(A.max.x,A.max.y),new rr(A.min.x,A.max.y)];for(let P=0;P<u-1;P++){const k=o+P,U=k+1,$=this.unevalVertices[k],q=this.unevalVertices[U];if(!($.x>=A.min.x&&$.x<=A.max.x&&$.y>=A.min.y&&$.y<=A.max.y||q.x>=A.min.x&&q.x<=A.max.x&&q.y>=A.min.y&&q.y<=A.max.y||us($,q,C))||this.isOnBorder($.x,q.x)||this.isOnBorder($.y,q.y))continue;const K=pc.computeEdgeHash(this.unevalVertices[k],this.unevalVertices[U]);let J,de=this.vertexHashLookup.get(pc.computePosHash($));de!=null?J=de.next:(de=this.vertexHashLookup.get(pc.computePosHash(q)),J=de!=null?de.prev:K),this.unevalEdges.push({polygonIdx:t,a:k,b:U,hash:K,portalHash:J,isTunnel:f,type:"unevaluated",featureInfo:v})}}addPortalCandidates(t,o,u,f,A){if(o.length===0)return;this.portalPolygons.add(t,{geometry:o,zLevel:A});const v=o[0];this.vertexHashLookup.clear();let C=pc.computeEdgeHash(v[v.length-2],v[v.length-1]);for(let P=0;P<v.length-1;P++){const k=v[P+0],U=v[P+1],$=os(U.x-k.x,U.y-k.y),q=Xo($);if(q===0)continue;let K="unevaluated";const J=f.pointElevation(k),de=f.pointElevation(U);Math.abs(J)<.01&&Math.abs(de)<.01?K="entrance":(this.isOnBorder(k.x,U.x)||this.isOnBorder(k.y,U.y))&&(K="border");const Ae=pc.computeEdgeHash(k,U);this.unevaluatedPortals.portals.push({connection:{a:t,b:void 0},va:k,vb:U,vab:$,length:q,hash:Ae,isTunnel:u,type:K});const _e=pc.computePosHash(k);this.vertexHashLookup.set(_e,{prev:C,next:Ae}),C=Ae}}construct(t){if(this.unevalVertices.length===0)return;const o=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),u=q=>{q.primitiveLength=this.indexArray.length-q.primitiveOffset},f=new Jx(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(t.portals,this.unevalEdges);const A=o(),v=o(),C=o(),P=(q,K)=>{q.sort(((de,Ae)=>de.type===K&&Ae.type!==K?-1:de.type!==K&&Ae.type===K?1:0));const J=q.findIndex((de=>de.type!==K));return J>=0?J:q.length};let k=0;this.unevalEdges.length>0&&(k=P(this.unevalEdges,"none"),this.constructBridgeStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:k},this.tileToMeters)),u(C);const U=o(),$=o();if(this.unevalEdges.length>0){const q=this.unevalEdges.splice(k),K=P(q,"tunnel")+k;this.unevalEdges.push(...q),this.constructTunnelStructures(f,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:k},{min:k,max:K})}u(U),f.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),u($),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),u(v),f.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),u(A),this.maskSegments=No.simpleSegment(0,$.primitiveOffset,0,$.primitiveLength),this.depthSegments=No.simpleSegment(0,v.primitiveOffset,0,v.primitiveLength),this.renderableBridgeSegments=No.simpleSegment(0,C.primitiveOffset,0,C.primitiveLength),this.renderableTunnelSegments=No.simpleSegment(0,U.primitiveOffset,0,U.primitiveLength),this.shadowCasterSegments=No.simpleSegment(0,A.primitiveOffset,0,A.primitiveLength)}update(t,o,u,f,A,v,C,P){this.bridgeProgramConfigurations.updatePaintArrays(t,o,A,u,f,v,C,P),this.tunnelProgramConfigurations.updatePaintArrays(t,o,A,u,f,v,C,P)}upload(t){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=t.createVertexBuffer(this.vertexPositions,Ey.members),this.vertexBufferNormal=t.createVertexBuffer(this.vertexNormals,zl.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(t),this.tunnelProgramConfigurations.upload(t))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(t,o,u,f,A){const v=(C,P)=>{for(let k=0;k<P.length-1;k++){const U=P[k].featureIndex,$=P[k+1].vertexStart,q=t.feature(U);C.populatePaintArrays($,q,U,{},u,o,f,void 0,A)}};v(this.bridgeProgramConfigurations,this.bridgeFeatureSections),v(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(t,o,u,f,A){const v=new Map;for(let C=f;C<A;C++){const P=u[C],k=P.a,U=P.b,$=pc.computePosHash(t[k]),q=pc.computePosHash(t[U]);let K=v.get($);K||(K={},v.set($,K));let J=v.get(q);J||(J={},v.set(q,J)),o[k]<=0&&o[U]<=0||(K.to=U,J.from=k)}return v}isTerminalVertex(t,o){const u=pc.computePosHash(this.unevalVertices[t]),f=o.get(u);return!f||!f.from||!f.to}constructBridgeStructures(t,o,u,f,A,v){t.clearVertexLookup();const C=this.computeVertexConnections(o,u,f,A.min,A.max),P=1/v,k=.5*P,U=(er,hr)=>Et(er,o[hr].x,o[hr].y,u[hr]*P),$=ht(),q=ht(),K=ht(),J=ht(),de=ht(),Ae=(er,hr)=>{const Nt=C.get(pc.computePosHash(o[hr])),tr=Nt.from,Mt=Nt.to;if(!tr||!Mt)return;U($,tr),U(q,hr),U(K,Mt),Zi(J),wn($,q)||(Rn(de,q,$),Hr(J,de)),wn(K,q)||(Rn(de,K,q),et(J,J,Hr(de,de)));const St=di(J);return St>0?Vt(er,J,1/St):void 0};let _e=Number.POSITIVE_INFINITY;this.sortSubarray(f,A.min,A.max,((er,hr)=>er.featureInfo.featureIndex-hr.featureInfo.featureIndex));const Ie=ht(),Pe=ht(),ke=ht(),Ye=ht(),Qe=ht(),tt=ht(),it=ht(),ct=ht(),$t=ht(),mt=[ht(),ht(),ht(),ht()],Wt=[ht(),ht(),ht(),ht()],sr=[{coord:new rr(0,0),height:0},{coord:new rr(0,0),height:0}],Kt=(er,hr)=>er>hr;for(let er=A.min;er<A.max;er++){const hr=f[er];if(!hr.featureInfo.guardRailEnabled||!this.prepareEdgePoints(sr,o,u,hr,Kt))continue;const[Nt,tr]=sr;if(Et(Ie,Nt.coord.x,Nt.coord.y,P*Nt.height),Et(Pe,tr.coord.x,tr.coord.y,P*tr.height),wn(Ie,Pe))continue;Rn(ke,Pe,Ie),Hr(ke,ke);const Mt=Ae(ct,hr.a)||ke,St=Ae($t,hr.b)||ke;Et(Ye,Mt[1],-Mt[0],0),Hr(Ye,Ye),Et(Qe,St[1],-St[0],0),Hr(Qe,Qe),jn(ct,Ye,Mt),Hr(tt,ct),jn(ct,Qe,St),Hr(it,ct),et(mt[0],Ie,Vt(ct,Rn(ct,Ye,tt),k)),et(mt[1],Ie,Vt(ct,et(ct,Ye,tt),k)),et(mt[2],Ie,Vt(ct,tt,k)),mt[3]=Ie,et(Wt[0],Pe,Vt(ct,Rn(ct,Qe,it),k)),et(Wt[1],Pe,Vt(ct,et(ct,Qe,it),k)),et(Wt[2],Pe,Vt(ct,it,k)),Wt[3]=Pe,_e=this.addFeatureSection(hr.featureInfo.featureIndex,_e,this.bridgeFeatureSections,t);const pr=t.addVertex(mt[0],Ye,v),cr=t.addVertex(mt[1],Ye,v),nn=t.addVertex(Wt[0],Qe,v),kr=t.addVertex(Wt[1],Qe,v);t.addTriangle(pr,cr,nn),t.addTriangle(cr,kr,nn);const Xr=t.addVertex(mt[1],tt,v),_r=t.addVertex(mt[2],tt,v),en=t.addVertex(Wt[1],it,v),Cn=t.addVertex(Wt[2],it,v);t.addTriangle(Xr,_r,en),t.addTriangle(_r,Cn,en),tn(Ye,Ye),tn(Qe,Qe);const Er=t.addVertex(mt[2],Ye,v),Qr=t.addVertex(mt[3],Ye,v),vn=t.addVertex(Wt[2],Qe,v),kn=t.addVertex(Wt[3],Qe,v);t.addTriangle(Er,Qr,vn),t.addTriangle(Qr,kn,vn);const Qn=this.isTerminalVertex(hr.a,C),Vn=this.isTerminalVertex(hr.b,C);Nt.height<.01&&Qn&&t.addQuad(mt[3],mt[2],mt[1],mt[0],tn(Mt,Mt),v),tr.height<.01&&Vn&&t.addQuad(Wt[0],Wt[1],Wt[2],Wt[3],St,v)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:t.getVertexCount()})}constructTunnelStructures(t,o,u,f,A,v){t.clearVertexLookup();let C=Number.POSITIVE_INFINITY;const P=(_e,Ie)=>_e.featureInfo.featureIndex-Ie.featureInfo.featureIndex;this.sortSubarray(f,A.min,A.max,P),this.sortSubarray(f,v.min,v.max,P);const k=_e=>Hr(_e,_e),U=[{coord:new rr(0,0),height:0},{coord:new rr(0,0),height:0}],$=(_e,Ie)=>_e<Ie,q=ht(),K=ht(),J=ht(),de=ht(),Ae=ht();for(let _e=A.min;_e<A.max;_e++){if(!this.prepareEdgePoints(U,o,u,f[_e],$))continue;const[Ie,Pe]=U,ke=k(Et(Ae,-(Pe.coord.y-Ie.coord.y),Pe.coord.x-Ie.coord.x,0));C=this.addFeatureSection(f[_e].featureInfo.featureIndex,C,this.tunnelFeatureSections,t),t.addQuad(Et(q,Ie.coord.x,Ie.coord.y,Ie.height),Et(K,Pe.coord.x,Pe.coord.y,Pe.height),Et(J,Pe.coord.x,Pe.coord.y,f[_e].isTunnel?-.1:0),Et(de,Ie.coord.x,Ie.coord.y,f[_e].isTunnel?-.1:0),ke)}for(let _e=v.min;_e<v.max;_e++){const Ie=f[_e];Ie.isTunnel&&([Ie.a,Ie.b]=[Ie.b,Ie.a]);const Pe=o[Ie.a],ke=o[Ie.b],Ye=k(Et(Ae,-(ke.y-Pe.y),ke.x-Pe.x,0));C=this.addFeatureSection(Ie.featureInfo.featureIndex,C,this.tunnelFeatureSections,t),t.addQuad(Et(q,ke.x,ke.y,0),Et(K,Pe.x,Pe.y,0),Et(J,Pe.x,Pe.y,u[Ie.a]+4),Et(de,ke.x,ke.y,u[Ie.b]+4),Ye),t.addQuad(Et(q,Pe.x,Pe.y,0),Et(K,ke.x,ke.y,0),Et(J,ke.x,ke.y,u[Ie.b]+4),Et(de,Pe.x,Pe.y,u[Ie.a]+4),Ye)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:t.getVertexCount()})}setElevatedPoint(t,o,u,f){t.coord.x=o,t.coord.y=u,t.height=f}prepareEdgePoints(t,o,u,f,A){let v=o[f.a].x,C=o[f.a].y,P=o[f.b].x,k=o[f.b].y,U=u[f.a],$=u[f.b];const q=A(U,0),K=A($,0);if(q&&K)return this.setElevatedPoint(t[0],v,C,U),this.setElevatedPoint(t[1],P,k,$),!0;if(!q&&!K)return!1;if(q){if(!K){const J=$/($-U);P=hn(P,v,J),k=hn(k,C,J),$=hn($,U,J)}}else{const J=U/(U-$);v=hn(v,P,J),C=hn(C,k,J),U=hn(U,$,J)}return this.setElevatedPoint(t[0],v,C,U),this.setElevatedPoint(t[1],P,k,$),!0}prepareEdges(t,o){if(o.length===0)return;o.sort(((C,P)=>C.hash===P.hash?P.polygonIdx-C.polygonIdx:P.hash>C.hash?1:-1));let u=0,f=0,A=0,v=o[u].polygonIdx;do f++,(f===o.length||o[u].hash!==o[f].hash)&&((f-u==1||o[f-1].polygonIdx!==v)&&(A<u&&(o[A]=o[u],o[u]=null),o[A].type="none",A++),u=f,u!==o.length&&(v=o[u].polygonIdx));while(u!==o.length);if(o.splice(A),o.length!==0&&t.length!==0){o.sort(((k,U)=>k.portalHash<U.portalHash?1:-1));let C=0,P=0;for(;C!==o.length&&P!==t.length;){const k=o[C],U=t[P];k.portalHash>U.hash?C++:U.hash>k.portalHash?P++:(k.type=U.type,C++)}}}isOnBorder(t,o){return t<=0&&o<=0||t>=mr&&o>=mr}addFeatureSection(t,o,u,f){return t!==o&&(o=t,u.push({featureIndex:t,vertexStart:f.getVertexCount()}),f.clearVertexLookup()),o}sortSubarray(t,o,u,f){const A=t.slice(o,u);A.sort(f),t.splice(o,A.length,...A)}static computeEdgeHash(t,o){return(t.y===o.y&&t.x>o.x||t.y>o.y)&&([t,o]=[o,t]),BigInt(pc.computePosHash(t))<<32n|BigInt(pc.computePosHash(o))}static computePosHash(t){return((65535&t.x)<<16|65535&t.y)>>>0}}var e1,t1={exports:{}},r1=(e1||(e1=1,(function(s,t){(function(o){function u(Ne,je){return Ne>je?1:Ne<je?-1:0}var f=function(Ne,je){Ne===void 0&&(Ne=u),je===void 0&&(je=!1),this._compare=Ne,this._root=null,this._size=0,this._noDuplicates=!!je},A={size:{configurable:!0}};function v(Ne,je,Ct,Ut,Sr){var br=Sr-Ut;if(br>0){var Br=Ut+Math.floor(br/2),un={key:je[Br],data:Ct[Br],parent:Ne};return un.left=v(un,je,Ct,Ut,Br),un.right=v(un,je,Ct,Br+1,Sr),un}return null}function C(Ne,je,Ct,Ut,Sr){if(!(Ct>=Ut)){for(var br=Ne[Ct+Ut>>1],Br=Ct-1,un=Ut+1;;){do Br++;while(Sr(Ne[Br],br)<0);do un--;while(Sr(Ne[un],br)>0);if(Br>=un)break;var Kn=Ne[Br];Ne[Br]=Ne[un],Ne[un]=Kn,Kn=je[Br],je[Br]=je[un],je[un]=Kn}C(Ne,je,Ct,un,Sr),C(Ne,je,un+1,Ut,Sr)}}f.prototype.rotateLeft=function(Ne){var je=Ne.right;je&&(Ne.right=je.left,je.left&&(je.left.parent=Ne),je.parent=Ne.parent),Ne.parent?Ne===Ne.parent.left?Ne.parent.left=je:Ne.parent.right=je:this._root=je,je&&(je.left=Ne),Ne.parent=je},f.prototype.rotateRight=function(Ne){var je=Ne.left;je&&(Ne.left=je.right,je.right&&(je.right.parent=Ne),je.parent=Ne.parent),Ne.parent?Ne===Ne.parent.left?Ne.parent.left=je:Ne.parent.right=je:this._root=je,je&&(je.right=Ne),Ne.parent=je},f.prototype._splay=function(Ne){for(;Ne.parent;){var je=Ne.parent;je.parent?je.left===Ne&&je.parent.left===je?(this.rotateRight(je.parent),this.rotateRight(je)):je.right===Ne&&je.parent.right===je?(this.rotateLeft(je.parent),this.rotateLeft(je)):je.left===Ne&&je.parent.right===je?(this.rotateRight(je),this.rotateLeft(je)):(this.rotateLeft(je),this.rotateRight(je)):je.left===Ne?this.rotateRight(je):this.rotateLeft(je)}},f.prototype.splay=function(Ne){for(var je,Ct,Ut,Sr,br;Ne.parent;)(Ct=(je=Ne.parent).parent)&&Ct.parent?((Ut=Ct.parent).left===Ct?Ut.left=Ne:Ut.right=Ne,Ne.parent=Ut):(Ne.parent=null,this._root=Ne),Sr=Ne.left,br=Ne.right,Ne===je.left?(Ct&&(Ct.left===je?(je.right?(Ct.left=je.right,Ct.left.parent=Ct):Ct.left=null,je.right=Ct,Ct.parent=je):(Sr?(Ct.right=Sr,Sr.parent=Ct):Ct.right=null,Ne.left=Ct,Ct.parent=Ne)),br?(je.left=br,br.parent=je):je.left=null,Ne.right=je,je.parent=Ne):(Ct&&(Ct.right===je?(je.left?(Ct.right=je.left,Ct.right.parent=Ct):Ct.right=null,je.left=Ct,Ct.parent=je):(br?(Ct.left=br,br.parent=Ct):Ct.left=null,Ne.right=Ct,Ct.parent=Ne)),Sr?(je.right=Sr,Sr.parent=je):je.right=null,Ne.left=je,je.parent=Ne)},f.prototype.replace=function(Ne,je){Ne.parent?Ne===Ne.parent.left?Ne.parent.left=je:Ne.parent.right=je:this._root=je,je&&(je.parent=Ne.parent)},f.prototype.minNode=function(Ne){if(Ne===void 0&&(Ne=this._root),Ne)for(;Ne.left;)Ne=Ne.left;return Ne},f.prototype.maxNode=function(Ne){if(Ne===void 0&&(Ne=this._root),Ne)for(;Ne.right;)Ne=Ne.right;return Ne},f.prototype.insert=function(Ne,je){var Ct=this._root,Ut=null,Sr=this._compare;if(this._noDuplicates)for(;Ct;){if(Ut=Ct,Sr(Ct.key,Ne)===0)return;Ct=Sr(Ct.key,Ne)<0?Ct.right:Ct.left}else for(;Ct;)Ut=Ct,Ct=Sr(Ct.key,Ne)<0?Ct.right:Ct.left;return Ct={key:Ne,data:je,left:null,right:null,parent:Ut},Ut?Sr(Ut.key,Ct.key)<0?Ut.right=Ct:Ut.left=Ct:this._root=Ct,this.splay(Ct),this._size++,Ct},f.prototype.find=function(Ne){for(var je=this._root,Ct=this._compare;je;){var Ut=Ct(je.key,Ne);if(Ut<0)je=je.right;else{if(!(Ut>0))return je;je=je.left}}return null},f.prototype.contains=function(Ne){for(var je=this._root,Ct=this._compare;je;){var Ut=Ct(Ne,je.key);if(Ut===0)return!0;je=Ut<0?je.left:je.right}return!1},f.prototype.remove=function(Ne){var je=this.find(Ne);if(!je)return!1;if(this.splay(je),je.left)if(je.right){var Ct=this.minNode(je.right);Ct.parent!==je&&(this.replace(Ct,Ct.right),Ct.right=je.right,Ct.right.parent=Ct),this.replace(je,Ct),Ct.left=je.left,Ct.left.parent=Ct}else this.replace(je,je.left);else this.replace(je,je.right);return this._size--,!0},f.prototype.removeNode=function(Ne){if(!Ne)return!1;if(this.splay(Ne),Ne.left)if(Ne.right){var je=this.minNode(Ne.right);je.parent!==Ne&&(this.replace(je,je.right),je.right=Ne.right,je.right.parent=je),this.replace(Ne,je),je.left=Ne.left,je.left.parent=je}else this.replace(Ne,Ne.left);else this.replace(Ne,Ne.right);return this._size--,!0},f.prototype.erase=function(Ne){var je=this.find(Ne);if(je){this.splay(je);var Ct=je.left,Ut=je.right,Sr=null;Ct&&(Ct.parent=null,Sr=this.maxNode(Ct),this.splay(Sr),this._root=Sr),Ut&&(Ct?Sr.right=Ut:this._root=Ut,Ut.parent=Sr),this._size--}},f.prototype.pop=function(){var Ne=this._root,je=null;if(Ne){for(;Ne.left;)Ne=Ne.left;je={key:Ne.key,data:Ne.data},this.remove(Ne.key)}return je},f.prototype.next=function(Ne){var je=Ne;if(je)if(je.right)for(je=je.right;je&&je.left;)je=je.left;else for(je=Ne.parent;je&&je.right===Ne;)Ne=je,je=je.parent;return je},f.prototype.prev=function(Ne){var je=Ne;if(je)if(je.left)for(je=je.left;je&&je.right;)je=je.right;else for(je=Ne.parent;je&&je.left===Ne;)Ne=je,je=je.parent;return je},f.prototype.forEach=function(Ne){for(var je=this._root,Ct=[],Ut=!1,Sr=0;!Ut;)je?(Ct.push(je),je=je.left):Ct.length>0?(Ne(je=Ct.pop(),Sr++),je=je.right):Ut=!0;return this},f.prototype.range=function(Ne,je,Ct,Ut){for(var Sr=[],br=this._compare,Br=this._root;Sr.length!==0||Br;)if(Br)Sr.push(Br),Br=Br.left;else{if(br((Br=Sr.pop()).key,je)>0)break;if(br(Br.key,Ne)>=0&&Ct.call(Ut,Br))return this;Br=Br.right}return this},f.prototype.keys=function(){for(var Ne=this._root,je=[],Ct=[],Ut=!1;!Ut;)Ne?(je.push(Ne),Ne=Ne.left):je.length>0?(Ne=je.pop(),Ct.push(Ne.key),Ne=Ne.right):Ut=!0;return Ct},f.prototype.values=function(){for(var Ne=this._root,je=[],Ct=[],Ut=!1;!Ut;)Ne?(je.push(Ne),Ne=Ne.left):je.length>0?(Ne=je.pop(),Ct.push(Ne.data),Ne=Ne.right):Ut=!0;return Ct},f.prototype.at=function(Ne){for(var je=this._root,Ct=[],Ut=!1,Sr=0;!Ut;)if(je)Ct.push(je),je=je.left;else if(Ct.length>0){if(je=Ct.pop(),Sr===Ne)return je;Sr++,je=je.right}else Ut=!0;return null},f.prototype.load=function(Ne,je,Ct){if(Ne===void 0&&(Ne=[]),je===void 0&&(je=[]),Ct===void 0&&(Ct=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Ut=Ne.length;return Ct&&C(Ne,je,0,Ut-1,this._compare),this._root=v(null,Ne,je,0,Ut),this._size=Ut,this},f.prototype.min=function(){var Ne=this.minNode(this._root);return Ne?Ne.key:null},f.prototype.max=function(){var Ne=this.maxNode(this._root);return Ne?Ne.key:null},f.prototype.isEmpty=function(){return this._root===null},A.size.get=function(){return this._size},f.createTree=function(Ne,je,Ct,Ut,Sr){return new f(Ct,Sr).load(Ne,je,Ut)},Object.defineProperties(f.prototype,A);var P=0,k=1,U=2,$=3,q=0,K=1,J=2,de=3;function Ae(Ne,je,Ct){je===null?(Ne.inOut=!1,Ne.otherInOut=!0):(Ne.isSubject===je.isSubject?(Ne.inOut=!je.inOut,Ne.otherInOut=je.otherInOut):(Ne.inOut=!je.otherInOut,Ne.otherInOut=je.isVertical()?!je.inOut:je.inOut),je&&(Ne.prevInResult=!_e(je,Ct)||je.isVertical()?je.prevInResult:je));var Ut=_e(Ne,Ct);Ne.resultTransition=Ut?(function(Sr,br){var Br,un=!Sr.inOut,Kn=!Sr.otherInOut;switch(br){case q:Br=un&&Kn;break;case K:Br=un||Kn;break;case de:Br=un^Kn;break;case J:Br=Sr.isSubject?un&&!Kn:Kn&&!un}return Br?1:-1})(Ne,Ct):0}function _e(Ne,je){switch(Ne.type){case P:switch(je){case q:return!Ne.otherInOut;case K:return Ne.otherInOut;case J:return Ne.isSubject&&Ne.otherInOut||!Ne.isSubject&&!Ne.otherInOut;case de:return!0}break;case U:return je===q||je===K;case $:return je===J;case k:return!1}return!1}var Ie=function(Ne,je,Ct,Ut,Sr){this.left=je,this.point=Ne,this.otherEvent=Ct,this.isSubject=Ut,this.type=Sr||P,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},Pe={inResult:{configurable:!0}};function ke(Ne,je){return Ne[0]===je[0]&&Ne[1]===je[1]}Ie.prototype.isBelow=function(Ne){var je=this.point,Ct=this.otherEvent.point;return this.left?(je[0]-Ne[0])*(Ct[1]-Ne[1])-(Ct[0]-Ne[0])*(je[1]-Ne[1])>0:(Ct[0]-Ne[0])*(je[1]-Ne[1])-(je[0]-Ne[0])*(Ct[1]-Ne[1])>0},Ie.prototype.isAbove=function(Ne){return!this.isBelow(Ne)},Ie.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},Pe.inResult.get=function(){return this.resultTransition!==0},Ie.prototype.clone=function(){var Ne=new Ie(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ne.contourId=this.contourId,Ne.resultTransition=this.resultTransition,Ne.prevInResult=this.prevInResult,Ne.isExteriorRing=this.isExteriorRing,Ne.inOut=this.inOut,Ne.otherInOut=this.otherInOut,Ne},Object.defineProperties(Ie.prototype,Pe);var Ye=11102230246251565e-32,Qe=134217729,tt=(3+8*Ye)*Ye;function it(Ne,je,Ct,Ut,Sr){var br,Br,un,Kn,Jn=je[0],Zn=Ut[0],Xi=0,Vo=0;Zn>Jn==Zn>-Jn?(br=Jn,Jn=je[++Xi]):(br=Zn,Zn=Ut[++Vo]);var Hn=0;if(Xi<Ne&&Vo<Ct)for(Zn>Jn==Zn>-Jn?(un=br-((Br=Jn+br)-Jn),Jn=je[++Xi]):(un=br-((Br=Zn+br)-Zn),Zn=Ut[++Vo]),br=Br,un!==0&&(Sr[Hn++]=un);Xi<Ne&&Vo<Ct;)Zn>Jn==Zn>-Jn?(un=br-((Br=br+Jn)-(Kn=Br-br))+(Jn-Kn),Jn=je[++Xi]):(un=br-((Br=br+Zn)-(Kn=Br-br))+(Zn-Kn),Zn=Ut[++Vo]),br=Br,un!==0&&(Sr[Hn++]=un);for(;Xi<Ne;)un=br-((Br=br+Jn)-(Kn=Br-br))+(Jn-Kn),Jn=je[++Xi],br=Br,un!==0&&(Sr[Hn++]=un);for(;Vo<Ct;)un=br-((Br=br+Zn)-(Kn=Br-br))+(Zn-Kn),Zn=Ut[++Vo],br=Br,un!==0&&(Sr[Hn++]=un);return br===0&&Hn!==0||(Sr[Hn++]=br),Hn}function ct(Ne){return new Float64Array(Ne)}var $t=33306690738754716e-32,mt=22204460492503146e-32,Wt=11093356479670487e-47,sr=ct(4),Kt=ct(8),er=ct(12),hr=ct(16),Nt=ct(4);function tr(Ne,je,Ct){var Ut=(function(Sr,br,Br,un,Kn,Jn){var Zn=(br-Jn)*(Br-Kn),Xi=(Sr-Kn)*(un-Jn),Vo=Zn-Xi;if(Zn===0||Xi===0||Zn>0!=Xi>0)return Vo;var Hn=Math.abs(Zn+Xi);return Math.abs(Vo)>=$t*Hn?Vo:-(function(Co,no,Li,zo,Lo,yo,Mo){var io,ei,lo,Qo,bn,Si,Bo,na,Uo,Za,uo,ja,qc,pl,Qs,Wc,Op,Xa,hs=Co-Lo,ml=Li-Lo,Kl=no-yo,Ll=zo-yo;sr[0]=(Qs=(na=hs-(Bo=(Si=Qe*hs)-(Si-hs)))*(Za=Ll-(Uo=(Si=Qe*Ll)-(Si-Ll)))-((pl=hs*Ll)-Bo*Uo-na*Uo-Bo*Za))-((uo=Qs-(Op=(na=Kl-(Bo=(Si=Qe*Kl)-(Si-Kl)))*(Za=ml-(Uo=(Si=Qe*ml)-(Si-ml)))-((Wc=Kl*ml)-Bo*Uo-na*Uo-Bo*Za)))+(bn=Qs-uo))+(bn-Op),sr[1]=(qc=pl-((ja=pl+uo)-(bn=ja-pl))+(uo-bn))-((uo=qc-Wc)+(bn=qc-uo))+(bn-Wc),sr[2]=ja-((Xa=ja+uo)-(bn=Xa-ja))+(uo-bn),sr[3]=Xa;var YA=(function(eAe,JR){for(var eD=JR[0],NS=1;NS<4;NS++)eD+=JR[NS];return eD})(0,sr),lv=mt*Mo;if(YA>=lv||-YA>=lv||(io=Co-(hs+(bn=Co-hs))+(bn-Lo),lo=Li-(ml+(bn=Li-ml))+(bn-Lo),ei=no-(Kl+(bn=no-Kl))+(bn-yo),Qo=zo-(Ll+(bn=zo-Ll))+(bn-yo),io===0&&ei===0&&lo===0&&Qo===0)||(lv=Wt*Mo+tt*Math.abs(YA),(YA+=hs*Qo+Ll*io-(Kl*lo+ml*ei))>=lv||-YA>=lv))return YA;Nt[0]=(Qs=(na=io-(Bo=(Si=Qe*io)-(Si-io)))*(Za=Ll-(Uo=(Si=Qe*Ll)-(Si-Ll)))-((pl=io*Ll)-Bo*Uo-na*Uo-Bo*Za))-((uo=Qs-(Op=(na=ei-(Bo=(Si=Qe*ei)-(Si-ei)))*(Za=ml-(Uo=(Si=Qe*ml)-(Si-ml)))-((Wc=ei*ml)-Bo*Uo-na*Uo-Bo*Za)))+(bn=Qs-uo))+(bn-Op),Nt[1]=(qc=pl-((ja=pl+uo)-(bn=ja-pl))+(uo-bn))-((uo=qc-Wc)+(bn=qc-uo))+(bn-Wc),Nt[2]=ja-((Xa=ja+uo)-(bn=Xa-ja))+(uo-bn),Nt[3]=Xa;var G7=it(4,sr,4,Nt,Kt);Nt[0]=(Qs=(na=hs-(Bo=(Si=Qe*hs)-(Si-hs)))*(Za=Qo-(Uo=(Si=Qe*Qo)-(Si-Qo)))-((pl=hs*Qo)-Bo*Uo-na*Uo-Bo*Za))-((uo=Qs-(Op=(na=Kl-(Bo=(Si=Qe*Kl)-(Si-Kl)))*(Za=lo-(Uo=(Si=Qe*lo)-(Si-lo)))-((Wc=Kl*lo)-Bo*Uo-na*Uo-Bo*Za)))+(bn=Qs-uo))+(bn-Op),Nt[1]=(qc=pl-((ja=pl+uo)-(bn=ja-pl))+(uo-bn))-((uo=qc-Wc)+(bn=qc-uo))+(bn-Wc),Nt[2]=ja-((Xa=ja+uo)-(bn=Xa-ja))+(uo-bn),Nt[3]=Xa;var H7=it(G7,Kt,4,Nt,er);Nt[0]=(Qs=(na=io-(Bo=(Si=Qe*io)-(Si-io)))*(Za=Qo-(Uo=(Si=Qe*Qo)-(Si-Qo)))-((pl=io*Qo)-Bo*Uo-na*Uo-Bo*Za))-((uo=Qs-(Op=(na=ei-(Bo=(Si=Qe*ei)-(Si-ei)))*(Za=lo-(Uo=(Si=Qe*lo)-(Si-lo)))-((Wc=ei*lo)-Bo*Uo-na*Uo-Bo*Za)))+(bn=Qs-uo))+(bn-Op),Nt[1]=(qc=pl-((ja=pl+uo)-(bn=ja-pl))+(uo-bn))-((uo=qc-Wc)+(bn=qc-uo))+(bn-Wc),Nt[2]=ja-((Xa=ja+uo)-(bn=Xa-ja))+(uo-bn),Nt[3]=Xa;var q7=it(H7,er,4,Nt,hr);return hr[q7-1]})(Sr,br,Br,un,Kn,Jn,Hn)})(Ne[0],Ne[1],je[0],je[1],Ct[0],Ct[1]);return Ut>0?-1:Ut<0?1:0}function Mt(Ne,je){var Ct=Ne.point,Ut=je.point;return Ct[0]>Ut[0]?1:Ct[0]<Ut[0]?-1:Ct[1]!==Ut[1]?Ct[1]>Ut[1]?1:-1:(function(Sr,br,Br,un){return Sr.left!==br.left?Sr.left?1:-1:tr(Br,Sr.otherEvent.point,br.otherEvent.point)!==0?Sr.isBelow(br.otherEvent.point)?-1:1:!Sr.isSubject&&br.isSubject?1:-1})(Ne,je,Ct)}function St(Ne,je,Ct){var Ut=new Ie(je,!1,Ne,Ne.isSubject),Sr=new Ie(je,!0,Ne.otherEvent,Ne.isSubject);return ke(Ne.point,Ne.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ne),Ut.contourId=Sr.contourId=Ne.contourId,Mt(Sr,Ne.otherEvent)>0&&(Ne.otherEvent.left=!0,Sr.left=!1),Ne.otherEvent.otherEvent=Sr,Ne.otherEvent=Ut,Ct.push(Sr),Ct.push(Ut),Ct}function pr(Ne,je){return Ne[0]*je[1]-Ne[1]*je[0]}function cr(Ne,je){return Ne[0]*je[0]+Ne[1]*je[1]}function nn(Ne,je,Ct){var Ut=(function(Kn,Jn,Zn,Xi,Vo){var Hn=[Jn[0]-Kn[0],Jn[1]-Kn[1]],Co=[Xi[0]-Zn[0],Xi[1]-Zn[1]];function no(Si,Bo,na){return[Si[0]+Bo*na[0],Si[1]+Bo*na[1]]}var Li=[Zn[0]-Kn[0],Zn[1]-Kn[1]],zo=pr(Hn,Co),Lo=zo*zo,yo=cr(Hn,Hn);if(Lo>0){var Mo=pr(Li,Co)/zo;if(Mo<0||Mo>1)return null;var io=pr(Li,Hn)/zo;return io<0||io>1?null:Mo===0||Mo===1?[no(Kn,Mo,Hn)]:io===0||io===1?[no(Zn,io,Co)]:[no(Kn,Mo,Hn)]}if((Lo=(zo=pr(Li,Hn))*zo)>0)return null;var ei=cr(Hn,Li)/yo,lo=ei+cr(Hn,Co)/yo,Qo=Math.min(ei,lo),bn=Math.max(ei,lo);return Qo<=1&&bn>=0?Qo===1?[no(Kn,Qo>0?Qo:0,Hn)]:bn===0?[no(Kn,bn<1?bn:1,Hn)]:[no(Kn,Qo>0?Qo:0,Hn),no(Kn,bn<1?bn:1,Hn)]:null})(Ne.point,Ne.otherEvent.point,je.point,je.otherEvent.point),Sr=Ut?Ut.length:0;if(Sr===0||Sr===1&&(ke(Ne.point,je.point)||ke(Ne.otherEvent.point,je.otherEvent.point))||Sr===2&&Ne.isSubject===je.isSubject)return 0;if(Sr===1)return ke(Ne.point,Ut[0])||ke(Ne.otherEvent.point,Ut[0])||St(Ne,Ut[0],Ct),ke(je.point,Ut[0])||ke(je.otherEvent.point,Ut[0])||St(je,Ut[0],Ct),1;var br=[],Br=!1,un=!1;return ke(Ne.point,je.point)?Br=!0:Mt(Ne,je)===1?br.push(je,Ne):br.push(Ne,je),ke(Ne.otherEvent.point,je.otherEvent.point)?un=!0:Mt(Ne.otherEvent,je.otherEvent)===1?br.push(je.otherEvent,Ne.otherEvent):br.push(Ne.otherEvent,je.otherEvent),Br&&un||Br?(je.type=k,Ne.type=je.inOut===Ne.inOut?U:$,Br&&!un&&St(br[1].otherEvent,br[0].point,Ct),2):un?(St(br[0],br[1].point,Ct),3):br[0]!==br[3].otherEvent?(St(br[0],br[1].point,Ct),St(br[1],br[2].point,Ct),3):(St(br[0],br[1].point,Ct),St(br[3].otherEvent,br[2].point,Ct),3)}function kr(Ne,je){if(Ne===je)return 0;if(tr(Ne.point,Ne.otherEvent.point,je.point)!==0||tr(Ne.point,Ne.otherEvent.point,je.otherEvent.point)!==0)return ke(Ne.point,je.point)?Ne.isBelow(je.otherEvent.point)?-1:1:Ne.point[0]===je.point[0]?Ne.point[1]<je.point[1]?-1:1:Mt(Ne,je)===1?je.isAbove(Ne.point)?-1:1:Ne.isBelow(je.point)?-1:1;if(Ne.isSubject!==je.isSubject)return Ne.isSubject?-1:1;var Ct=Ne.point,Ut=je.point;return Ct[0]===Ut[0]&&Ct[1]===Ut[1]?(Ct=Ne.otherEvent.point)[0]===(Ut=je.otherEvent.point)[0]&&Ct[1]===Ut[1]?0:Ne.contourId>je.contourId?1:-1:Mt(Ne,je)===1?1:-1}var Xr=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function _r(Ne,je,Ct,Ut){var Sr,br=Ne+1,Br=je[Ne].point,un=je.length;for(br<un&&(Sr=je[br].point);br<un&&Sr[0]===Br[0]&&Sr[1]===Br[1];){if(!Ct[br])return br;++br<un&&(Sr=je[br].point)}for(br=Ne-1;Ct[br]&&br>Ut;)br--;return br}Xr.prototype.isExterior=function(){return this.holeOf==null};var en=Er,Cn=Er;function Er(Ne,je){if(!(this instanceof Er))return new Er(Ne,je);if(this.data=Ne||[],this.length=this.data.length,this.compare=je||Qr,this.length>0)for(var Ct=(this.length>>1)-1;Ct>=0;Ct--)this._down(Ct)}function Qr(Ne,je){return Ne<je?-1:Ne>je?1:0}Er.prototype={push:function(Ne){this.data.push(Ne),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ne=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ne}},peek:function(){return this.data[0]},_up:function(Ne){for(var je=this.data,Ct=this.compare,Ut=je[Ne];Ne>0;){var Sr=Ne-1>>1,br=je[Sr];if(Ct(Ut,br)>=0)break;je[Ne]=br,Ne=Sr}je[Ne]=Ut},_down:function(Ne){for(var je=this.data,Ct=this.compare,Ut=this.length>>1,Sr=je[Ne];Ne<Ut;){var br=1+(Ne<<1),Br=br+1,un=je[br];if(Br<this.length&&Ct(je[Br],un)<0&&(br=Br,un=je[Br]),Ct(un,Sr)>=0)break;je[Ne]=un,Ne=br}je[Ne]=Sr}},en.default=Cn;var vn=Math.max,kn=Math.min,Qn=0;function Vn(Ne,je,Ct,Ut,Sr,br){var Br,un,Kn,Jn,Zn,Xi;for(Br=0,un=Ne.length-1;Br<un;Br++)if(Jn=Ne[Br+1],Zn=new Ie(Kn=Ne[Br],!1,void 0,je),Xi=new Ie(Jn,!1,Zn,je),Zn.otherEvent=Xi,Kn[0]!==Jn[0]||Kn[1]!==Jn[1]){Zn.contourId=Xi.contourId=Ct,br||(Zn.isExteriorRing=!1,Xi.isExteriorRing=!1),Mt(Zn,Xi)>0?Xi.left=!0:Zn.left=!0;var Vo=Kn[0],Hn=Kn[1];Sr[0]=kn(Sr[0],Vo),Sr[1]=kn(Sr[1],Hn),Sr[2]=vn(Sr[2],Vo),Sr[3]=vn(Sr[3],Hn),Ut.push(Zn),Ut.push(Xi)}}var jr=[];function Ln(Ne,je,Ct){typeof Ne[0][0][0]=="number"&&(Ne=[Ne]),typeof je[0][0][0]=="number"&&(je=[je]);var Ut=(function(Hn,Co,no){var Li=null;return Hn.length*Co.length==0&&(no===q?Li=jr:no===J?Li=Hn:no!==K&&no!==de||(Li=Hn.length===0?Co:Hn)),Li})(Ne,je,Ct);if(Ut)return Ut===jr?null:Ut;var Sr=[1/0,1/0,-1/0,-1/0],br=[1/0,1/0,-1/0,-1/0],Br=(function(Hn,Co,no,Li,zo){var Lo,yo,Mo,io,ei,lo,Qo=new en(null,Mt);for(Mo=0,io=Hn.length;Mo<io;Mo++)for(ei=0,lo=(Lo=Hn[Mo]).length;ei<lo;ei++)(yo=ei===0)&&Qn++,Vn(Lo[ei],!0,Qn,Qo,no,yo);for(Mo=0,io=Co.length;Mo<io;Mo++)for(ei=0,lo=(Lo=Co[Mo]).length;ei<lo;ei++)yo=ei===0,zo===J&&(yo=!1),yo&&Qn++,Vn(Lo[ei],!1,Qn,Qo,Li,yo);return Qo})(Ne,je,Sr,br,Ct);if(Ut=(function(Hn,Co,no,Li,zo){var Lo=null;return(no[0]>Li[2]||Li[0]>no[2]||no[1]>Li[3]||Li[1]>no[3])&&(zo===q?Lo=jr:zo===J?Lo=Hn:zo!==K&&zo!==de||(Lo=Hn.concat(Co))),Lo})(Ne,je,Sr,br,Ct))return Ut===jr?null:Ut;for(var un=(function(Hn){var Co,no,Li=(function(Mo){var io,ei,lo,Qo,bn=[];for(ei=0,lo=Mo.length;ei<lo;ei++)((io=Mo[ei]).left&&io.inResult||!io.left&&io.otherEvent.inResult)&&bn.push(io);for(var Si=!1;!Si;)for(Si=!0,ei=0,lo=bn.length;ei<lo;ei++)ei+1<lo&&Mt(bn[ei],bn[ei+1])===1&&(Qo=bn[ei],bn[ei]=bn[ei+1],bn[ei+1]=Qo,Si=!1);for(ei=0,lo=bn.length;ei<lo;ei++)(io=bn[ei]).otherPos=ei;for(ei=0,lo=bn.length;ei<lo;ei++)(io=bn[ei]).left||(Qo=io.otherPos,io.otherPos=io.otherEvent.otherPos,io.otherEvent.otherPos=Qo);return bn})(Hn),zo={},Lo=[],yo=function(){if(!zo[Co]){var Mo=Lo.length,io=(function(bn,Si,Bo){var na=new Xr;if(bn.prevInResult!=null){var Uo=bn.prevInResult,Za=Uo.outputContourId;if(Uo.resultTransition>0){var uo=Si[Za];if(uo.holeOf!=null){var ja=uo.holeOf;Si[ja].holeIds.push(Bo),na.holeOf=ja,na.depth=Si[Za].depth}else Si[Za].holeIds.push(Bo),na.holeOf=Za,na.depth=Si[Za].depth+1}else na.holeOf=null,na.depth=Si[Za].depth}else na.holeOf=null,na.depth=0;return na})(Li[Co],Lo,Mo),ei=function(bn){zo[bn]=!0,bn<Li.length&&Li[bn]&&(Li[bn].outputContourId=Mo)},lo=Co,Qo=Co;for(io.points.push(Li[Co].point);ei(lo),ei(lo=Li[lo].otherPos),io.points.push(Li[lo].point),!((lo=_r(lo,Li,zo,Qo))==Qo||lo>=Li.length)&&Li[lo];);Lo.push(io)}};for(Co=0,no=Li.length;Co<no;Co++)yo();return Lo})((function(Hn,Co,no,Li,zo,Lo){for(var yo,Mo,io,ei=new f(kr),lo=[],Qo=Math.min(Li[2],zo[2]);Hn.length!==0;){var bn=Hn.pop();if(lo.push(bn),Lo===q&&bn.point[0]>Qo||Lo===J&&bn.point[0]>Li[2])break;if(bn.left){Mo=yo=ei.insert(bn),yo=yo!==(io=ei.minNode())?ei.prev(yo):null,Mo=ei.next(Mo);var Si=yo?yo.key:null;if(Ae(bn,Si,Lo),Mo&&nn(bn,Mo.key,Hn)===2&&(Ae(bn,Si,Lo),Ae(Mo.key,bn,Lo)),yo&&nn(yo.key,bn,Hn)===2){var Bo=yo;Ae(Si,(Bo=Bo!==io?ei.prev(Bo):null)?Bo.key:null,Lo),Ae(bn,Si,Lo)}}else Mo=yo=ei.find(bn=bn.otherEvent),yo&&Mo&&(yo=yo!==io?ei.prev(yo):null,Mo=ei.next(Mo),ei.remove(bn),Mo&&yo&&nn(yo.key,Mo.key,Hn))}return lo})(Br,0,0,Sr,br,Ct)),Kn=[],Jn=0;Jn<un.length;Jn++){var Zn=un[Jn];if(Zn.isExterior()){for(var Xi=[Zn.points],Vo=0;Vo<Zn.holeIds.length;Vo++)Xi.push(un[Zn.holeIds[Vo]].points);Kn.push(Xi)}}return Kn}var gi={UNION:K,DIFFERENCE:J,INTERSECTION:q,XOR:de};o.diff=function(Ne,je){return Ln(Ne,je,J)},o.intersection=function(Ne,je){return Ln(Ne,je,q)},o.operations=gi,o.union=function(Ne,je){return Ln(Ne,je,K)},o.xor=function(Ne,je){return Ln(Ne,je,de)},Object.defineProperty(o,"__esModule",{value:!0})})(t)})(0,t1.exports)),t1.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function Jg(s,t,o,u){const f=[],A=u===0?(v,C,P,k,U,$)=>{v.push(new rr($,P+($-C)/(k-C)*(U-P)))}:(v,C,P,k,U,$)=>{v.push(new rr(C+($-P)/(U-P)*(k-C),$))};for(const v of s){const C=[];for(const P of v){if(P.length<=2)continue;const k=[];for(let q=0;q<P.length-1;q++){const K=P[q].x,J=P[q].y,de=P[q+1].x,Ae=P[q+1].y,_e=u===0?K:J,Ie=u===0?de:Ae;_e<t?Ie>t&&A(k,K,J,de,Ae,t):_e>o?Ie<o&&A(k,K,J,de,Ae,o):k.push(P[q]),Ie<t&&_e>=t&&A(k,K,J,de,Ae,t),Ie>o&&_e<=o&&A(k,K,J,de,Ae,o)}let U=P[P.length-1];const $=u===0?U.x:U.y;$>=t&&$<=o&&k.push(U),k.length&&(U=k[k.length-1],k[0].x===U.x&&k[0].y===U.y||k.push(k[0]),C.push(k))}C.length&&f.push(C)}return f}function $2(s,t){const o=e_(s),u=e_([t]),f=r1.intersection(o,u);return f==null?[]:Tm(f)}function G2(s,t){let u=e_(s,65536);const f=[];for(;t.valid();t.next()){const[A,v]=t.get(),C=A.x*65536,P=A.y*65536,k=v.x*65536,U=v.y*65536,$=k-C,q=U-P,K=Math.hypot($,q);if(K===0)continue;const J=Math.trunc(q/K*3),de=-Math.trunc($/K*3);f.push([[[C,P],[k,U],[k+J,U+de],[C+J,P+de],[C,P]]])}return f.length>0&&(u=r1.diff(u,f)),Tm(u,1/65536)}function e_(s,t=1){return[s.map((o=>o.map((u=>[u.x*t,u.y*t]))))]}function Tm(s,t=1){return s.map((o=>o.map(((u,f)=>{const A=u.map((v=>new rr(v[0]*t,v[1]*t).round()));return f>0&&A.reverse(),A}))))}class Em{constructor(t,o){this.layoutVertexArray=new uc,this.indexArray=new ea,this.lineIndexArray=new ha,this.triangleSegments=new No,this.lineSegments=new No,this.programConfigurations=new Ts(t.layers,{zoom:t.zoom,lut:t.lut}),this.uploaded=!1,o&&(this.elevatedLayoutVertexArray=new Uc)}update(t,o,u,f,A,v,C,P){this.programConfigurations.updatePaintArrays(t,o,A,u,f,v,C,P)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Zg.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.lineIndexBuffer=t.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=t.createVertexBuffer(this.elevatedLayoutVertexArray,ga.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(t,o,u,f,A,v,C){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,o,u,f,A,v,void 0,C)}}class t_{constructor(t){this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=t.lut,this.bufferData=new Em(t,!1),this.elevationBufferData=new Em(t,!0),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.projection=t.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=t.sourceLayerIndex,this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,u,f){this.hasPattern=mf("fill",this.layers,this.pixelRatio,o);const A=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:C,id:P,index:k,sourceLayerIndex:U}of t){const $=this.layers[0]._featureFilter.needGeometry,q=Ht(C,$);if(!this.layers[0]._featureFilter.filter(new co(this.zoom,{worldview:this.worldview}),q,u))continue;const K=A?A.evaluate(q,{},u,o.availableImages):void 0,J={id:P,properties:C.properties,type:C.type,sourceLayerIndex:U,index:k,geometry:$?q.geometry:ar(C,u,f),patterns:{},sortKey:K};v.push(J)}A&&v.sort(((C,P)=>C.sortKey-P.sortKey));for(const C of v){const{geometry:P,index:k,sourceLayerIndex:U}=C;if(this.hasPattern){const $=Py("fill",this.layers,C,this.zoom,this.pixelRatio,o);this.patternFeatures.push($)}else this.addFeature(C,P,k,u,{},o.availableImages,o.brightness,o.elevationFeatures);o.featureIndex.insert(t[k].feature,P,k,U,this.index)}}update(t,o,u,f,A,v,C){this.bufferData.update(t,o,u,f,A,v,C,this.worldview),this.elevationBufferData.update(t,o,u,f,A,v,C,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(t,o,u,f,A,v,C,this.worldview)}addFeatures(t,o,u,f,A,v){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,o,u,f,v,t.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(t){this.bufferData.upload(t),this.elevationBufferData.upload(t),this.elevatedStructures&&this.elevatedStructures.upload(t)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(t,o,u,f,A,v=[],C,P){const k=Ql(o,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(t,k,f,u,P):this.addGeometry(k,this.bufferData),this.bufferData.populatePaintArrays(t,u,A,v,f,C,this.worldview),this.elevationBufferData.populatePaintArrays(t,u,A,v,f,C,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(t,o,u,f,A){this.elevatedStructures&&(this.elevatedStructures.construct(t),this.elevatedStructures.populatePaintArrays(o,u,f,A,this.worldview))}addElevatedRoadFeature(t,o,u,f,A){const v=new Array,C=ho.getElevationFeature(t,A);if(!C)return void this.addGeometry(o,this.bufferData);{const k=this.clipPolygonsToTile(o,1);k.length>0&&v.push({polygons:k,elevationFeature:C,elevationTileID:u})}const P={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(t,{},u),featureIndex:f};for(const k of v)if(k.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new pc(k.elevationTileID,this.layers,this.zoom,this.lut));const $=k.elevationFeature.isTunnel();let q=0;t.properties.hasOwnProperty(ki)&&(q=+t.properties[ki]);for(const K of k.polygons)this.elevatedStructures.addPortalCandidates(k.elevationFeature.id,K,$,k.elevationFeature,q)}k.elevationFeature.constantHeight==null&&(k.polygons=this.prepareElevatedPolygons(k.polygons,k.elevationFeature,k.elevationTileID));const U=new sa(u,k.elevationTileID);this.addElevatedGeometry(k.polygons,U,k.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,f,P)}}addElevatedGeometry(t,o,u,f,A,v){const C={elevation:u,elevationSampler:o,bias:f,index:A,featureInfo:v},[P,k]=this.addGeometry(t,this.elevationBufferData,C);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:P,max:k}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,P),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,k))}addGeometry(t,o,u){let f=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,v=null;u&&(v=u.elevationSampler.constantElevation(u.elevation,u.bias),v!=null&&(f=v,A=v));const C=(P,k,U)=>{if(u!=null)if(k.push(P),v!=null)o.elevatedLayoutVertexArray.emplaceBack(v),U.push(v);else{const $=u.elevationSampler.pointElevation(P,u.elevation,u.bias);o.elevatedLayoutVertexArray.emplaceBack($),U.push($),f=Math.min(f,$),A=Math.max(A,$)}};for(const P of t){let k=0;for(const Pe of P)k+=Pe.length;const U=o.triangleSegments.prepareSegment(k,o.layoutVertexArray,o.indexArray),$=U.vertexLength,q=[],K=[],J=[],de=[],Ae=[],_e=o.layoutVertexArray.length;for(const Pe of P){if(Pe.length===0)continue;Pe!==P[0]&&K.push(q.length/2);const ke=o.lineSegments.prepareSegment(Pe.length,o.layoutVertexArray,o.lineIndexArray),Ye=ke.vertexLength;u&&Ae.push(o.layoutVertexArray.length-_e),C(Pe[0],J,de),o.layoutVertexArray.emplaceBack(Pe[0].x,Pe[0].y),o.lineIndexArray.emplaceBack(Ye+Pe.length-1,Ye),q.push(Pe[0].x),q.push(Pe[0].y);for(let Qe=1;Qe<Pe.length;Qe++)C(Pe[Qe],J,de),o.layoutVertexArray.emplaceBack(Pe[Qe].x,Pe[Qe].y),o.lineIndexArray.emplaceBack(Ye+Qe-1,Ye+Qe),q.push(Pe[Qe].x),q.push(Pe[Qe].y);ke.vertexLength+=Pe.length,ke.primitiveLength+=Pe.length}const Ie=LA(q,K);for(let Pe=0;Pe<Ie.length;Pe+=3)o.indexArray.emplaceBack($+Ie[Pe],$+Ie[Pe+1],$+Ie[Pe+2]);if(Ie.length>0&&u&&this.elevationMode==="hd-road-base"){const Pe=u.elevation.isTunnel(),ke=u.elevation.safeArea,Ye=this.elevatedStructures.addVertices(J,de);this.elevatedStructures.addTriangles(Ie,Ye,Pe);const Qe=Ae.length;if(Qe>0){for(let tt=0;tt<Qe-1;tt++)this.elevatedStructures.addRenderableRing(u.index,Ae[tt]+Ye,Ae[tt+1]-Ae[tt],Pe,ke,u.featureInfo);this.elevatedStructures.addRenderableRing(u.index,Ae[Qe-1]+Ye,J.length-Ae[Qe-1],Pe,ke,u.featureInfo)}}U.vertexLength+=k,U.primitiveLength+=Ie.length/3}return[f,A]}prepareElevatedPolygons(t,o,u){const f=1/_t(u),A=[];for(const v of t){const C=G2(v,new zi(o,f));A.push(...C)}return A}clipPolygonsToTile(t,o){const u=-o,f=-o,A=mr+o,v=mr+o;let C=0;const P=[],k=[];for(;C<t.length;C++){const q=t[C],K=nh(q);(K.min.x>=u&&K.max.x<=A&&K.min.y>=f&&K.max.y<=v?P:k).push(q)}if(P.length===t.length)return t;const U=[new rr(u,f),new rr(A,f),new rr(A,v),new rr(u,v),new rr(u,f)],$=P;for(const q of k)$.push(...$2(q,U));return $}}let n1,Cm,jA,Ry;Rr(t_,"FillBucket",{omit:["layers","patternFeatures"]}),Rr(Em,"FillBufferData"),Rr(pc,"ElevatedStructures");class Mm{constructor(t,o,u,f){if(this.triangleCount=o.length/3,this.min=new rr(0,0),this.max=new rr(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0)return;const[A,v]=[t[0].clone(),t[0].clone()];for(let $=1;$<t.length;++$){const q=t[$];A.x=Math.min(A.x,q.x),A.y=Math.min(A.y,q.y),v.x=Math.max(v.x,q.x),v.y=Math.max(v.y,q.y)}if(f){const $=Math.ceil(Math.max(v.x-A.x,v.y-A.y)/f);u=Math.max(u,$)}if(u===0)return;this.min=A,this.max=v;const C=this.max.sub(this.min);C.x=Math.max(C.x,1),C.y=Math.max(C.y,1);const P=Math.max(C.x,C.y)/u;this.cellsX=Math.max(1,Math.ceil(C.x/P)),this.cellsY=Math.max(1,Math.ceil(C.y/P)),this.xScale=1/P,this.yScale=1/P;const k=[];for(let $=0;$<this.triangleCount;$++){const q=t[o[3*$+0]].sub(this.min),K=t[o[3*$+1]].sub(this.min),J=t[o[3*$+2]].sub(this.min),de=Th(Math.floor(Math.min(q.x,K.x,J.x)),this.xScale,this.cellsX),Ae=Th(Math.floor(Math.max(q.x,K.x,J.x)),this.xScale,this.cellsX),_e=Th(Math.floor(Math.min(q.y,K.y,J.y)),this.yScale,this.cellsY),Ie=Th(Math.floor(Math.max(q.y,K.y,J.y)),this.yScale,this.cellsY),Pe=new rr(0,0),ke=new rr(0,0),Ye=new rr(0,0),Qe=new rr(0,0);for(let tt=_e;tt<=Ie;++tt){Pe.y=ke.y=tt*P,Ye.y=Qe.y=(tt+1)*P;for(let it=de;it<=Ae;++it)Pe.x=Ye.x=it*P,ke.x=Qe.x=(it+1)*P,(hf(q,K,J,Pe,ke,Qe)||hf(q,K,J,Pe,Qe,Ye))&&k.push({cellIdx:tt*this.cellsX+it,triIdx:$})}}if(k.length===0)return;k.sort((($,q)=>$.cellIdx-q.cellIdx||$.triIdx-q.triIdx));let U=0;for(;U<k.length;){const $=k[U].cellIdx,q={start:this.payload.length,len:0};for(;U<k.length&&k[U].cellIdx===$;)++q.len,this.payload.push(k[U++].triIdx);this.cells[$]=q}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,o){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const u=Th(t.x-this.min.x,this.xScale,this.cellsX),f=Th(t.y-this.min.y,this.yScale,this.cellsY),A=this.cells[f*this.cellsX+u];if(A){this._lazyInitLookup();for(let v=0;v<A.len;v++){const C=this.payload[A.start+v],P=Math.floor(C/8),k=1<<C%8;if(!(this.lookup[P]&k)&&(this.lookup[P]|=k,o.push(C),o.length===this.triangleCount))return}}}query(t,o,u){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>o.x||t.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const f=Th(t.x-this.min.x,this.xScale,this.cellsX),A=Th(o.x-this.min.x,this.xScale,this.cellsX),v=Th(t.y-this.min.y,this.yScale,this.cellsY),C=Th(o.y-this.min.y,this.yScale,this.cellsY);for(let P=v;P<=C;P++)for(let k=f;k<=A;k++){const U=this.cells[P*this.cellsX+k];if(U)for(let $=0;$<U.len;$++){const q=this.payload[U.start+$],K=Math.floor(q/8),J=1<<q%8;if(!(this.lookup[K]&J)&&(this.lookup[K]|=J,u.push(q),u.length===this.triangleCount))return}}}}function Th(s,t,o){return Math.max(0,Math.min(o-1,Math.floor(s*t)))}Rr(Mm,"TriangleGridIndex");class r_{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.footprints=[],this.worldview=t.worldview}updateFootprints(t,o){for(const u of this.footprints)o.push({footprint:u,id:t})}populate(t,o,u,f){const A=[];for(const{feature:v,id:C,index:P,sourceLayerIndex:k}of t){const U=this.layers[0]._featureFilter.needGeometry,$=Ht(v,U);if(!this.layers[0]._featureFilter.filter(new co(this.zoom,{worldview:this.worldview}),$,u))continue;const q={id:C,properties:v.properties,type:v.type,sourceLayerIndex:k,index:P,geometry:U?$.geometry:ar(v,u,f),patterns:{}};A.push(q)}for(const v of A){const{geometry:C,index:P,sourceLayerIndex:k}=v;this.addFeature(v,C,P,u,{},o.availableImages,o.brightness),o.featureIndex.insert(t[P].feature,C,P,k,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(t){}update(t,o,u,f,A,v,C){}destroy(){}addFeature(t,o,u,f,A,v=[],C){for(const P of Ql(o,2)){const k=[],U=[],$=[],q=new rr(1/0,1/0),K=new rr(-1/0,-1/0);for(const Ae of P)if(Ae.length!==0){Ae!==P[0]&&$.push(U.length/2);for(let _e=0;_e<Ae.length;_e++)U.push(Ae[_e].x),U.push(Ae[_e].y),k.push(Ae[_e]),q.x=Math.min(q.x,Ae[_e].x),q.y=Math.min(q.y,Ae[_e].y),K.x=Math.max(K.x,Ae[_e].x),K.y=Math.max(K.y,Ae[_e].y)}const J=LA(U,$),de=new Mm(k,J,8,256);this.footprints.push({vertices:k,indices:J,grid:de,min:q,max:K})}}}Rr(r_,"ClipBucket",{omit:["layers"]});const n_=ii([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),i1=ii([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),o1=ii([{name:"a_centroid_pos",components:2,type:"Uint16"}]),H2=ii([{name:"a_join_normal_inside",components:3,type:"Int16"}]),a1=ii([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),k0=ii([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:q2}=n_,z0=Number.MAX_SAFE_INTEGER,s1=z0-1;function L0(s,t,o,u){return s.order<t||s.order===z0||!(s.clipMask&o)||(function(f,A){return A.length!==0&&A.find((v=>v===f))===void 0})(u,s.clipScope)}function Im(s,t){return s.x-t.x||s.y-t.y}function i_(s,t){return Im(s.min,t.min)===0&&Im(s.max,t.max)===0}function Dy(s,t){return!(s.min.x>t.max.x||s.max.x<t.min.x||s.min.y>t.max.y||s.max.y<t.min.y)}function Rp(s,t){if(s.length!==t.length)return!1;for(let o=0;o<s.length;o++)if(s[o].sourceId!==t[o].sourceId||!i_(s[o],t[o])||s[o].order!==t[o].order||s[o].clipMask!==t[o].clipMask||!Ul(s[o].clipScope,t[o].clipScope))return!1;return!0}function l1(s,t,o){const u=1/mr,f=1/(1<<o.canonical.z),A=(t.x*u+o.canonical.x)*f+o.wrap,v=(t.y*u+o.canonical.y)*f;return{min:new rr((s.x*u+o.canonical.x)*f+o.wrap,(s.y*u+o.canonical.y)*f),max:new rr(A,v)}}function c1(s,t,o){const u=1<<o.canonical.z,f=((t.x-o.wrap)*u-o.canonical.x)*mr,A=(t.y*u-o.canonical.y)*mr;return{min:new rr(((s.x-o.wrap)*u-o.canonical.x)*mr,(s.y*u-o.canonical.y)*mr),max:new rr(f,A)}}function o_(s,t,o,u,f,A,v){const C=s.indices,P=s.vertices,k=[];for(let U=u;U<u+f;U+=3){const $=t[o[U+0]+A],q=t[o[U+1]+A],K=t[o[U+2]+A],J=Math.min($.x,q.x,K.x),de=Math.max($.x,q.x,K.x),Ae=Math.min($.y,q.y,K.y),_e=Math.max($.y,q.y,K.y);k.length=0,s.grid.query(new rr(J,Ae),new rr(de,_e),k);for(let Ie=0;Ie<k.length;Ie++){const Pe=k[Ie];if(hf(P[C[3*Pe+0]],P[C[3*Pe+1]],P[C[3*Pe+2]],$,q,K,v))return!0}}return!1}function Oy(s,t,o,u){if(!s||!o)return!1;let f=s.vertices;if(!t.canonical.equals(u.canonical)||t.wrap!==u.wrap){if(o.vertices.length<s.vertices.length)return Oy(o,u,s,t);const A=t.canonical,v=u.canonical,C=Math.pow(2,v.z-A.z);f=s.vertices.map((P=>new rr((P.x+A.x*mr)*C-v.x*mr,(P.y+A.y*mr)*C-v.y*mr)))}return o_(o,f,s.indices,0,s.indices.length,0,0)}function ky(s,t,o,u){const f=Math.pow(2,u.z-o.z);return new rr((s+o.x*mr)*f-u.x*mr,(t+o.y*mr)*f-u.y*mr)}function B0(s,t){const o=[];t.grid.queryPoint(s,o);const u=t.indices,f=t.vertices;for(let A=0;A<o.length;A++){const v=o[A];if(Fa([f[u[3*v+0]],f[u[3*v+1]],f[u[3*v+2]]],s))return!0}return!1}const a_=[new rr(0,0),new rr(mr,0),new rr(mr,mr),new rr(0,mr)];function F0(s,t){const o=[];let u=[];if(!t||s.length<2)return[s];if(s.length===2)return us(s[0],s[1],a_)?[s]:[];for(let f=0;f<s.length+2;f++){const A=s[f%s.length],v=s[(f+1)%s.length],C=us(f===0?s[s.length-1]:s[(f-1)%s.length],A,a_),P=us(A,v,a_),k=C||P;k&&u.push(A),k&&P||u.length>0&&(u.length>1&&o.push(u),u=[])}return u.length>1&&o.push(u),o}const zy=Xt.types,W2=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Ly=["fill-extrusion-flood-light-ground-radius"],By=Math.pow(2,13),s_=Math.pow(2,15)-1,l_=new rr(0,1),Nd=2147483648;function Pm(s,t,o,u,f,A,v,C){s.emplaceBack((t<<1)+v,(o<<1)+A,(Math.floor(u*By)<<1)+f,Math.round(C))}function Eh(s,t,o){s.emplaceBack(t.x*mr,t.y*mr,o?1:0)}function Af(s,t,o,u,f,A){s.emplaceBack(t.x,t.y,(o.x<<1)+u,(o.y<<1)+f,A)}function Ch(s,t,o){s.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class UA{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class VA{constructor(){this.centroidXY=new rr(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new rr(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new rr(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new rr(this.max.x-this.min.x,this.max.y-this.min.y)}}class jd{constructor(){this.acc=new rr(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,o){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=o.x,t.min.y=t.max.y=o.y)}appendEdge(t,o,u){this.accCount++,this.acc._add(o);let f=!!this.borders;o.x<t.min.x?(t.min.x=o.x,f=!0):o.x>t.max.x&&(t.max.x=o.x,f=!0),o.y<t.min.y?(t.min.y=o.y,f=!0):o.y>t.max.y&&(t.max.y=o.y,f=!0),((o.x===0||o.x===mr)&&o.x===u.x)!=((o.y===0||o.y===mr)&&o.y===u.y)&&this.processBorderOverlap(o,u),f&&this.checkBorderIntersection(o,u)}checkBorderIntersection(t,o){o.x<0!=t.x<0&&this.addBorderIntersection(0,hn(o.y,t.y,(0-o.x)/(t.x-o.x))),o.x>mr!=t.x>mr&&this.addBorderIntersection(1,hn(o.y,t.y,(mr-o.x)/(t.x-o.x))),o.y<0!=t.y<0&&this.addBorderIntersection(2,hn(o.x,t.x,(0-o.y)/(t.y-o.y))),o.y>mr!=t.y>mr&&this.addBorderIntersection(3,hn(o.x,t.x,(mr-o.y)/(t.y-o.y)))}addBorderIntersection(t,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[t];o<u[0]&&(u[0]=o),o>u[1]&&(u[1]=o)}processBorderOverlap(t,o){if(t.x===o.x){if(t.y===o.y)return;const u=t.x===0?0:1;this.addBorderIntersection(u,o.y),this.addBorderIntersection(u,t.y)}else{const u=t.y===0?2:3;this.addBorderIntersection(u,o.x),this.addBorderIntersection(u,t.x)}}centroid(){return this.accCount===0?new rr(0,0):new rr(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((t,o)=>t+ +(o[0]!==Number.MAX_VALUE)),0):0}}function u1(s,t){const o=s.add(t)._unit(),u=ce(s.x*o.x+s.y*o.y,-1,1);var f,A,v;return f=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(f)))/4*s_*((A=s).x*(v=t).y-A.y*v.x<0?-1:1)}const h1=[s=>s.x<0,s=>s.x>mr,s=>s.y<0,s=>s.y>mr];function N0(s,t,o,u){const f=[4];if(u===0)return f;o._mult(u);const A=s.sub(o),v=t.sub(o),C=[s,t,A,v];for(let P=0;P<4;P++)for(const k of C)if(h1[P](k)){f.push(P);break}return f}class Fy{constructor(t){this.vertexArray=new gA,this.indexArray=new ea,this.programConfigurations=new Ts(t.layers,{zoom:t.zoom,lut:t.lut},(o=>Ly.includes(o))),this._segments=new No,this.hiddenByLandmarkVertexArray=new mm,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new No}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,o,u,f=!1){const A=t.length;if(A>2){let v=Math.max(0,this._segments.get().length-1);const C=this._segments._prepareSegment(4*A,this.vertexArray.length,2*this._segmentToGroundQuads[v].length);let P;v!==this._segments.get().length-1&&(v++,this._segmentToGroundQuads[v]=[],this._segmentToRegionTriCounts[v]=[0,0,0,0,0]);{const k=t[0],U=t[1];P=u1(k.sub(t[A-1])._perp()._unit(),U.sub(k)._perp()._unit())}for(let k=0;k<A;k++){const U=k===A-1?0:k+1,$=t[k],q=t[U],K=t[U===A-1?0:U+1],J=q.sub($)._perp()._unit(),de=u1(J,K.sub(q)._perp()._unit()),Ae=P,_e=de;if($A($,q,o)||f&&V0($,o)&&V0(q,o)){P=de;continue}const Ie=C.vertexLength;Af(this.vertexArray,$,q,1,1,Ae),Af(this.vertexArray,$,q,1,0,Ae),Af(this.vertexArray,$,q,0,1,_e),Af(this.vertexArray,$,q,0,0,_e),C.vertexLength+=4;const Pe=N0($,q,J,u);for(const ke of Pe)this._segmentToGroundQuads[v].push({id:Ie,region:ke}),this._segmentToRegionTriCounts[v][ke]+=2,C.primitiveLength+=2;P=de}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),o=t.length;for(let u=0;u<o;u++)this._segmentToGroundQuads[u].sort(((f,A)=>f.region-A.region));for(let u=0;u<o;u++){const f=this._segmentToGroundQuads[u],A=t[u],v=this._segmentToRegionTriCounts[u];v.reduce(((P,k)=>P+k),0);let C=0;for(let P=0;P<=4;P++){const k=v[P];if(k!==0){let U=this.regionSegments[P];U||(U=this.regionSegments[P]=new No);const $={vertexOffset:A.vertexOffset,primitiveOffset:A.primitiveOffset+C,vertexLength:A.vertexLength,primitiveLength:k};U.get().push($)}C+=k}for(let P=0;P<f.length;P++){const k=f[P].id;this.indexArray.emplaceBack(k,k+1,k+3),this.indexArray.emplaceBack(k,k+3,k+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,o,u,f,A,v,C){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,o,u,f,A,v,void 0,C)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,i1.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,o,u,f,A,v,C,P){this.hasData()&&this.programConfigurations.updatePaintArrays(t,o,u,f,A,v,C,P)}updateHiddenByLandmark(t){this.updateHiddenByLandmarkRange(t.groundVertexArrayOffset,t.groundVertexCount,!!(t.flags&Nd))}updateHiddenByLandmarkRange(t,o,u){if(!this.hasData())return;const f=o+t;if(o!==0){for(let A=t;A<f;++A)this.hiddenByLandmarkVertexArray.emplace(A,u?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,a1.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const o=this.regionSegments[t];o&&o.destroy()}}}}class j0{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.pixelRatio=t.pixelRatio,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new ea,this.footprintVertices=new uc,this.footprintSegments=[],this.layoutVertexArray=new gh,this.centroidVertexArray=new MA,this.wallVertexArray=new T0,this.indexArray=new ea,this.programConfigurations=new Ts(t.layers,{zoom:t.zoom,lut:t.lut},(o=>W2.includes(o))),this.segments=new No,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.groundEffect=new Fy(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,u,f){this.features=[],this.hasPattern=mf("fill-extrusion",this.layers,this.pixelRatio,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=_t(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:A,id:v,index:C,sourceLayerIndex:P}of t){const k=this.layers[0]._featureFilter.needGeometry,U=Ht(A,k);if(!this.layers[0]._featureFilter.filter(new co(this.zoom,{worldview:this.worldview}),U,u))continue;const $={id:v,sourceLayerIndex:P,index:C,geometry:k?U.geometry:ar(A,u,f),properties:A.properties,type:A.type,patterns:{}},q=this.layoutVertexArray.length,K=zy[$.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:A.id,feature:Py("fill-extrusion",this.layers,$,this.zoom,this.pixelRatio,o)});else if(this.wallMode)for(const J of $.geometry)for(const de of F0(J,K))this.addFeature(A.id,$,[de],C,u,{},o.availableImages,f,o.brightness);else this.addFeature(A.id,$,$.geometry,C,u,{},o.availableImages,f,o.brightness);o.featureIndex.insert(A,$.geometry,C,P,this.index,q)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,o,u,f,A,v){for(const{featureId:C,feature:P}of this.features){const k=zy[P.type]==="Polygon",{geometry:U}=P;if(this.wallMode)for(const $ of U)for(const q of F0($,k))this.addFeature(C,P,[q],P.index,o,u,f,A,v);else this.addFeature(C,P,U,P.index,o,u,f,A,v)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,o,u,f,A,v,C){this.programConfigurations.updatePaintArrays(t,o,A,u,f,v,C,this.worldview),this.groundEffect.update(t,o,A,u,f,v,C,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,q2),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.wallVertexBuffer=t.createVertexBuffer(this.wallVertexArray,H2.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,k0.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,o1.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,u,f,A,v,C,P,k){const U=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,$=[new rr(0,0),new rr(mr,mr)],q=P.projection,K=q.name==="globe",J=this.wallMode||zy[o.type]==="Polygon",de=new jd;de.centroidDataIndex=this.centroidData.length;const Ae=new VA;Ae.buildingId=t,o.properties&&o.properties.hasOwnProperty("building_id")&&(Ae.buildingId=o.properties.building_id);const _e=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},A)<=0,Ie=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},A);let Pe;if(Ae.height=Ie,Ae.vertexArrayOffset=this.layoutVertexArray.length,Ae.groundVertexArrayOffset=this.groundEffect.vertexArray.length,K&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ou),this.wallMode){if(K)return void Fn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(u.length!==1)return;Pe=(function(mt){const Wt=mt[0].x===mt[mt.length-1].x&&mt[0].y===mt[mt.length-1].y;(function(_r){let en=0;const Cn=_r.length;for(let Er=0;Er<Cn;Er++)en+=(_r[(Er+1)%Cn].x-_r[Er].x)*(_r[(Er+1)%Cn].y+_r[Er].y);return en>=0})(mt)||(mt=mt.reverse());const Kt={geometry:[],joinNormals:[],indices:[]},er=[],hr=[],Nt=[];let tr=mt.length;for(;tr>=2&&mt[tr-1].equals(mt[tr-2]);)tr--;if(tr<(Wt?3:2))return Kt;let Mt,St,pr,cr,nn,kr=0;for(;kr<tr-1&&mt[kr].equals(mt[kr+1]);)kr++;Wt&&(Mt=mt[tr-2],nn=mt[kr].sub(Mt)._unit()._perp());for(let _r=kr;_r<tr;_r++){if(pr=_r===tr-1?Wt?mt[kr+1]:void 0:mt[_r+1],pr&&mt[_r].equals(pr))continue;nn&&(cr=nn),Mt&&(St=Mt),Mt=mt[_r],nn=pr?pr.sub(Mt)._unit()._perp():cr,cr=cr||nn;let en=cr.add(nn);en.x===0&&en.y===0||en._unit();const Cn=en.x*nn.x+en.y*nn.y,Er=Cn!==0?1/Cn:1/0,Qr=cr.x*nn.y-cr.y*nn.x>0;let vn="miter";const kn=2;vn==="miter"&&Er>kn&&(vn="bevel"),vn==="bevel"&&(Er>100&&(vn="flipbevel"),Er<kn&&(vn="miter"));const Qn=(Vn,jr,Ln,gi)=>{const Ne=new rr(Vn.x,Vn.y),je=new rr(Vn.x,Vn.y);Ne.x+=jr.x*gi,Ne.y+=jr.y*gi,je.x-=jr.x*Math.max(Ln,1),je.y-=jr.y*Math.max(Ln,1),Nt.push(jr),er.push(Ne),hr.push(je)};if(vn==="miter")en._mult(Er),Qn(Mt,en,0,0);else if(vn==="flipbevel")en=nn.mult(-1),Qn(Mt,en,0,0),Qn(Mt,en.mult(-1),0,0);else{const Vn=-Math.sqrt(Er*Er-1),jr=Qr?Vn:0,Ln=Qr?0:Vn;St&&Qn(Mt,cr,jr,Ln),pr&&Qn(Mt,nn,jr,Ln)}}Kt.geometry=[...er,...hr.reverse(),er[0]],Kt.joinNormals=[...Nt,...Nt.reverse(),Nt[Nt.length-1]];const Xr=Kt.geometry.length-1;for(let _r=0;_r<Xr/2;_r++)if(_r+1<Xr/2){let en=_r,Cn=_r+1,Er=Xr-1-_r,Qr=Xr-2-_r;en=en===0?Xr-1:en-1,Cn=Cn===0?Xr-1:Cn-1,Er=Er===0?Xr-1:Er-1,Qr=Qr===0?Xr-1:Qr-1,Kt.indices.push(Er),Kt.indices.push(Cn),Kt.indices.push(en),Kt.indices.push(Er),Kt.indices.push(Qr),Kt.indices.push(Cn)}return Kt})(u[0]),u=[Pe.geometry]}const ke=(mt,Wt)=>mt<(Wt.length-1)/2||mt===Wt.length-1,Ye=this.wallMode?[u]:Ql(u,500);for(let mt=Ye.length-1;mt>=0;mt--){const Wt=Ye[mt];(Wt.length===0||(Qe=Wt[0]).every((sr=>sr.x<=0))||Qe.every((sr=>sr.x>=mr))||Qe.every((sr=>sr.y<=0))||Qe.every((sr=>sr.y>=mr)))&&Ye.splice(mt,1)}var Qe;let tt;if(K)tt=$0(Ye,$,A);else{tt=[];for(const mt of Ye)tt.push({polygon:mt,bounds:$})}const it=J?this.edgeRadius:0,ct=it>0&&this.zoom<17,$t=(mt,Wt)=>{if(mt.length===0)return!1;const sr=mt[mt.length-1];return Wt.x===sr.x&&Wt.y===sr.y};for(const{polygon:mt,bounds:Wt}of tt){let sr=0,Kt=0;for(const tr of mt)J&&!tr[0].equals(tr[tr.length-1])&&tr.push(tr[0]),Kt+=J?tr.length-1:tr.length;const er=this.segments.prepareSegment((J?5:4)*Kt,this.layoutVertexArray,this.indexArray);Ae.footprintSegIdx<0&&(Ae.footprintSegIdx=this.footprintSegments.length),Ae.polygonSegIdx<0&&(Ae.polygonSegIdx=this.polygonSegments.length);const hr={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Nt=new UA;if(Nt.vertexOffset=this.footprintVertices.length,Nt.indexOffset=3*this.footprintIndices.length,Nt.ringIndices=[],J){const tr=[],Mt=[];sr=er.vertexLength;for(let pr=0;pr<mt.length;pr++){const cr=mt[pr];cr.length&&pr!==0&&Mt.push(tr.length/2);const nn=[];let kr,Xr;kr=cr[1].sub(cr[0])._perp()._unit(),Nt.ringIndices.push(cr.length-1);for(let _r=1;_r<cr.length;_r++){const en=cr[_r],Cn=cr[_r===cr.length-1?1:_r+1],Er=en.clone();if(it){Xr=Cn.sub(en)._perp()._unit();const Qr=kr.add(Xr)._unit(),vn=it*Math.min(4,1/(kr.x*Qr.x+kr.y*Qr.y));Er.x+=vn*Qr.x,Er.y+=vn*Qr.y,Er.x=Math.round(Er.x),Er.y=Math.round(Er.y),kr=Xr}if(!_e||it!==0&&!ct||$t(nn,Er)||nn.push(Er),Pm(this.layoutVertexArray,Er.x,Er.y,0,0,1,1,0),this.wallMode){const Qr=ke(_r,cr);Eh(this.wallVertexArray,Pe.joinNormals[_r],!Qr)}er.vertexLength++,this.footprintVertices.emplaceBack(en.x,en.y),tr.push(en.x,en.y),K&&Ch(this.layoutVertexExtArray,q.projectTilePoint(Er.x,Er.y,A),q.upVector(A,Er.x,Er.y))}_e&&(it===0||ct)&&(nn.length!==0&&$t(nn,nn[0])&&nn.pop(),this.groundEffect.addData(nn,Wt,U))}const St=this.wallMode?Pe.indices:LA(tr,Mt);for(let pr=0;pr<St.length;pr+=3)this.footprintIndices.emplaceBack(Nt.vertexOffset+St[pr+0],Nt.vertexOffset+St[pr+1],Nt.vertexOffset+St[pr+2]),this.indexArray.emplaceBack(sr+St[pr],sr+St[pr+2],sr+St[pr+1]),er.primitiveLength++;Nt.indexCount+=St.length,Nt.vertexCount+=this.footprintVertices.length-Nt.vertexOffset}for(let tr=0;tr<mt.length;tr++){const Mt=mt[tr];de.startRing(Ae,Mt[0]);let St=Mt.length>4&&Ny(Mt[Mt.length-2],Mt[0],Mt[1]),pr=it?f1(Mt[Mt.length-2],Mt[0],Mt[1],it):0;const cr=[];let nn,kr,Xr;kr=Mt[1].sub(Mt[0])._perp()._unit();let _r=!0;for(let en=1,Cn=0;en<Mt.length;en++){let Er=Mt[en-1],Qr=Mt[en];const vn=Mt[en===Mt.length-1?1:en+1];if(de.appendEdge(Ae,Qr,Er),$A(Qr,Er,Wt)){it&&(kr=vn.sub(Qr)._perp()._unit(),_r=!_r);continue}const kn=Qr.sub(Er)._perp(),Qn=kn.x/(Math.abs(kn.x)+Math.abs(kn.y)),Vn=kn.y>0?1:0,jr=Er.dist(Qr);if(Cn+jr>32768&&(Cn=0),it){Xr=vn.sub(Qr)._perp()._unit();let je=d1(Er,Qr,vn,U0(kr,Xr),it);isNaN(je)&&(je=0);const Ct=Qr.sub(Er)._unit();Er=Er.add(Ct.mult(pr))._round(),Qr=Qr.add(Ct.mult(-je))._round(),pr=je,kr=Xr,_e&&this.zoom>=17&&($t(cr,Er)||cr.push(Er),$t(cr,Qr)||cr.push(Qr))}const Ln=er.vertexLength,gi=Mt.length>4&&Ny(Er,Qr,vn);let Ne=GA(Cn,St,_r);if(Pm(this.layoutVertexArray,Er.x,Er.y,Qn,Vn,0,0,Ne),Pm(this.layoutVertexArray,Er.x,Er.y,Qn,Vn,0,1,Ne),this.wallMode){const je=ke(en-1,Mt),Ct=Pe.joinNormals[en-1];Eh(this.wallVertexArray,Ct,je),Eh(this.wallVertexArray,Ct,je)}if(Cn+=jr,Ne=GA(Cn,gi,!_r),St=gi,Pm(this.layoutVertexArray,Qr.x,Qr.y,Qn,Vn,0,0,Ne),Pm(this.layoutVertexArray,Qr.x,Qr.y,Qn,Vn,0,1,Ne),this.wallMode){const je=ke(en,Mt),Ct=Pe.joinNormals[en];Eh(this.wallVertexArray,Ct,je),Eh(this.wallVertexArray,Ct,je)}if(er.vertexLength+=4,this.indexArray.emplaceBack(Ln+0,Ln+1,Ln+2),this.indexArray.emplaceBack(Ln+1,Ln+3,Ln+2),er.primitiveLength+=2,it){const je=sr+(en===1?Mt.length-2:en-2),Ct=en===1?sr:je+1;if(this.indexArray.emplaceBack(Ln+1,je,Ln+3),this.indexArray.emplaceBack(je,Ct,Ln+3),er.primitiveLength+=2,nn===void 0&&(nn=Ln),!$A(vn,Mt[en],Wt)){const Ut=en===Mt.length-1?nn:er.vertexLength;this.indexArray.emplaceBack(Ln+2,Ln+3,Ut),this.indexArray.emplaceBack(Ln+3,Ut+1,Ut),this.indexArray.emplaceBack(Ln+3,Ct,Ut+1),er.primitiveLength+=3}_r=!_r}if(K){const je=this.layoutVertexExtArray,Ct=q.projectTilePoint(Er.x,Er.y,A),Ut=q.projectTilePoint(Qr.x,Qr.y,A),Sr=q.upVector(A,Er.x,Er.y),br=q.upVector(A,Qr.x,Qr.y);Ch(je,Ct,Sr),Ch(je,Ct,Sr),Ch(je,Ut,br),Ch(je,Ut,br)}}J&&(sr+=Mt.length-1),_e&&it&&this.zoom>=17&&(cr.length!==0&&$t(cr,cr[0])&&cr.pop(),this.groundEffect.addData(cr,Wt,U,it>0))}this.footprintSegments.push(Nt),hr.triangleCount=this.indexArray.length-hr.triangleArrayOffset,this.polygonSegments.push(hr),++Ae.footprintSegLen,++Ae.polygonSegLen}if(Ae.vertexCount=this.layoutVertexArray.length-Ae.vertexArrayOffset,Ae.groundVertexCount=this.groundEffect.vertexArray.length-Ae.groundVertexArrayOffset,Ae.vertexCount!==0){if(Ae.centroidXY=de.borders?l_:this.encodeCentroid(de,Ae),this.centroidData.push(Ae),de.borders){this.featuresOnBorder.push(de);const mt=this.featuresOnBorder.length-1;for(let Wt=0;Wt<de.borders.length;Wt++)de.borders[Wt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Wt].push(mt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,v,C,A,k,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(o,f,v,C,A,k,this.worldview),this.maxHeight=Math.max(this.maxHeight,Ie)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort(((o,u)=>this.featuresOnBorder[o].borders[t][0]-this.featuresOnBorder[u].borders[t][0]))}splitToSubtiles(){const t=[];for(let C=0;C<this.centroidData.length;C++){const P=this.centroidData[C],k=+(P.min.y+P.max.y>mr),U=2*k+(+(P.min.x+P.max.x>mr)^k);for(let $=0;$<P.polygonSegLen;$++){const q=P.polygonSegIdx+$;t.push({centroidIdx:C,subtile:U,polygonSegmentIdx:q,triangleSegmentIdx:this.polygonSegments[q].triangleSegIdx})}}const o=new ea;t.sort(((C,P)=>C.triangleSegmentIdx===P.triangleSegmentIdx?C.subtile-P.subtile:C.triangleSegmentIdx-P.triangleSegmentIdx));let u=0,f=0,A=0;for(const C of t){if(C.triangleSegmentIdx!==u)break;A++}const v=t.length;for(;f!==t.length;){u=t[f].triangleSegmentIdx;let C=0,P=f,k=f;for(let U=P;U<A&&t[U].subtile===C;U++)k++;for(;P!==A;){const U=t[P];C=U.subtile;const $=this.centroidData[U.centroidIdx].min.clone(),q=this.centroidData[U.centroidIdx].max.clone(),K={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let J=P;J<k;J++){const de=t[J],Ae=this.polygonSegments[de.polygonSegmentIdx],_e=this.centroidData[de.centroidIdx].min,Ie=this.centroidData[de.centroidIdx].max,Pe=this.indexArray.uint16;for(let ke=Ae.triangleArrayOffset;ke<Ae.triangleArrayOffset+Ae.triangleCount;ke++)o.emplaceBack(Pe[3*ke],Pe[3*ke+1],Pe[3*ke+2]);K.primitiveLength+=Ae.triangleCount,$.x=Math.min($.x,_e.x),$.y=Math.min($.y,_e.y),q.x=Math.max(q.x,Ie.x),q.y=Math.max(q.y,Ie.y)}K.primitiveLength>0&&this.triangleSubSegments.push({segment:K,min:$,max:q}),P=k;for(let J=P;J<A&&t[J].subtile===t[P].subtile;J++)k++}f=A;for(let U=f;U<v&&t[U].triangleSegmentIdx===t[f].triangleSegmentIdx;U++)A++}o._trim(),this.indexArray=o}getVisibleSegments(t,o,u){const f=new No;if(this.wallMode){for(const de of this.triangleSubSegments)f.segments.push(de.segment);return f}let A=0,v=0;const C=1<<t.canonical.z;if(o){const de=o.getMinMaxForTile(t);de&&(A=de.min,v=de.max)}v+=this.maxHeight;const P=t.toUnwrapped();let k;const U=[P.canonical.x/C+P.wrap,P.canonical.y/C],$=[(P.canonical.x+1)/C+P.wrap,(P.canonical.y+1)/C],q=(de,Ae,_e)=>[de[0]*(1-_e[0])+Ae[0]*_e[0],de[1]*(1-_e[1])+Ae[1]*_e[1]],K=[],J=[];for(const de of this.triangleSubSegments){K[0]=de.min.x/mr,K[1]=de.min.y/mr,J[0]=de.max.x/mr,J[1]=de.max.y/mr;const Ae=q(U,$,K),_e=q(U,$,J);if(new An([Ae[0],Ae[1],A],[_e[0],_e[1],v]).intersectsPrecise(u)===0){k&&(f.segments.push(k),k=void 0);continue}const Ie=de.segment;k&&k.vertexOffset!==Ie.vertexOffset&&(f.segments.push(k),k=void 0),k?(k.vertexLength+=Ie.vertexLength,k.primitiveLength+=Ie.primitiveLength):k={vertexOffset:Ie.vertexOffset,primitiveLength:Ie.primitiveLength,vertexLength:Ie.vertexLength,primitiveOffset:Ie.primitiveOffset,sortKey:void 0,vaos:{}}}return k&&f.segments.push(k),f}encodeCentroid(t,o){const u=t.centroid(),f=o.span(),A=Math.min(7,Math.round(f.x*this.tileToMeter/10)),v=Math.min(7,Math.round(f.y*this.tileToMeter/10));return new rr(ce(u.x,1,mr-1)<<3|A,ce(u.y,1,mr-1)<<3|v)}encodeBorderCentroid(t){if(!t.borders)return new rr(0,0);const o=t.borders,u=Number.MAX_VALUE;if(o[0][0]!==u||o[1][0]!==u){const f=o[0][0]!==u?0:1;return new rr(6|(o[0][0]!==u?0:65528),(o[f][0]+o[f][1])/2<<3|6)}{const f=o[2][0]!==u?2:3;return new rr((o[f][0]+o[f][1])/2<<3|6,6|(o[2][0]!==u?0:65528))}}showCentroid(t){const o=this.centroidData[t.centroidDataIndex];o.flags&=2147483647,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const o=t.vertexArrayOffset,u=t.vertexCount+t.vertexArrayOffset,f=t.flags&Nd?l_:t.centroidXY,A=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==f.y||A!==f.x){for(let v=o;v<u;++v)this.centroidVertexArray.emplace(v,f.x,f.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,o,u){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const f=o.getReplacementRegionsForTile(t.toUnwrapped());if(Rp(this.activeReplacements,f))return;if(this.activeReplacements=f,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const v of this.centroidData)v.flags&=2147483647;const A=[];for(const v of this.activeReplacements){if(v.order<u)continue;const C=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-t.canonical.z));if(v.footprint.buildingId){const P=v.footprint.buildingId;for(const k of this.centroidData)k.buildingId===P&&(k.flags|=Nd)}else for(const P of this.centroidData)if(!(P.flags&Nd||v.min.x>P.max.x||P.min.x>v.max.x||v.min.y>P.max.y||P.min.y>v.max.y))for(let k=0;k<P.footprintSegLen;k++){const U=this.footprintSegments[P.footprintSegIdx+k];if(A.length=0,p1(this.footprintVertices,U.vertexOffset,U.vertexCount,v.footprintTileId.canonical,t.canonical,A),o_(v.footprint,A,this.footprintIndices.uint16,U.indexOffset,U.indexCount,-U.vertexOffset,-C)){P.flags|=Nd;break}}}for(const v of this.centroidData)this.writeCentroidToBuffer(v);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,o,u){let f=!1;for(let A=0;A<u.footprintSegLen;A++){const v=this.footprintSegments[u.footprintSegIdx+A];let C=0;for(const P of v.ringIndices){for(let k=C,U=P+C-1;k<P+C;U=k++){const $=this.footprintVertices.int16[2*(k+v.vertexOffset)+0],q=this.footprintVertices.int16[2*(k+v.vertexOffset)+1],K=this.footprintVertices.int16[2*(U+v.vertexOffset)+1];q>o!=K>o&&t<(this.footprintVertices.int16[2*(U+v.vertexOffset)+0]-$)*(o-q)/(K-q)+$&&(f=!f)}C=P}}return f}getHeightAtTileCoord(t,o){let u=Number.NEGATIVE_INFINITY,f=!0;const A=4*(t+mr)*mr+(o+mr);if(this.partLookup.hasOwnProperty(A)){const v=this.partLookup[A];return v?{height:v.height,hidden:!!(v.flags&Nd)}:void 0}for(const v of this.centroidData)t>v.max.x||v.min.x>t||o>v.max.y||v.min.y>o||v.height<=u||this.footprintContainsPoint(t,o,v)&&(u=v.height,this.partLookup[A]=v,f=!!(v.flags&Nd));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:f};this.partLookup[A]=void 0}}function U0(s,t){const o=s.add(t)._unit();return s.x*o.x+s.y*o.y}function f1(s,t,o,u){const f=t.sub(s)._perp()._unit(),A=o.sub(t)._perp()._unit();return d1(s,t,o,U0(f,A),u)}function d1(s,t,o,u,f){const A=Math.sqrt(1-u*u);return Math.min(s.dist(t)/3,t.dist(o)/3,f*A/u)}function $A(s,t,o){return s.x<o[0].x&&t.x<o[0].x||s.x>o[1].x&&t.x>o[1].x||s.y<o[0].y&&t.y<o[0].y||s.y>o[1].y&&t.y>o[1].y}function V0(s,t){return s.x<t[0].x||s.x>t[1].x||s.y<t[0].y||s.y>t[1].y}function Ny(s,t,o){if(s.x<0||s.x>=mr||t.x<0||t.x>=mr||o.x<0||o.x>=mr)return!1;const u=o.sub(t),f=u.perp(),A=s.sub(t);return(u.x*A.x+u.y*A.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(A.x*A.x+A.y*A.y))>-.866&&f.x*A.x+f.y*A.y<0}function GA(s,t,o){const u=t?2|s:-3&s;return o?1|u:-2&u}function c_(){const s=Math.PI/32,t=Math.tan(s),o=se;return o*Math.sqrt(1+2*t*t)-o}function $0(s,t,o){const u=1<<o.z,f=Ze(o.x/u),A=Ze((o.x+1)/u),v=$e(o.y/u),C=$e((o.y+1)/u);return(function(P,k,U,$,q=0,K){const J=[];if(!P.length||!U||!$)return J;const de=(Qe,tt)=>{for(const it of Qe)J.push({polygon:it,bounds:tt})},Ae=Math.ceil(Math.log2(U)),_e=Math.ceil(Math.log2($)),Ie=Ae-_e,Pe=[];for(let Qe=0;Qe<Math.abs(Ie);Qe++)Pe.push(Ie>0?0:1);for(let Qe=0;Qe<Math.min(Ae,_e);Qe++)Pe.push(0),Pe.push(1);let ke=P;if(ke=Jg(ke,k[0].y-q,k[1].y+q,1),ke=Jg(ke,k[0].x-q,k[1].x+q,0),!ke.length)return J;const Ye=[];for(Pe.length?Ye.push({polygons:ke,bounds:k,depth:0}):de(ke,k);Ye.length;){const Qe=Ye.pop(),tt=Qe.depth,it=Pe[tt],ct=Qe.bounds[0],$t=Qe.bounds[1],mt=it===0?ct.x:ct.y,Wt=it===0?$t.x:$t.y,sr=K?K(it,mt,Wt):.5*(mt+Wt),Kt=Jg(Qe.polygons,mt-q,sr+q,it),er=Jg(Qe.polygons,sr-q,Wt+q,it);if(Kt.length){const hr=[ct,new rr(it===0?sr:$t.x,it===1?sr:$t.y)];Pe.length>tt+1?Ye.push({polygons:Kt,bounds:hr,depth:tt+1}):de(Kt,hr)}if(er.length){const hr=[new rr(it===0?sr:ct.x,it===1?sr:ct.y),$t];Pe.length>tt+1?Ye.push({polygons:er,bounds:hr,depth:tt+1}):de(er,hr)}}return J})(s,t,Math.ceil((A-f)/11.25),Math.ceil((v-C)/11.25),1,((P,k,U)=>{if(P===0)return .5*(k+U);{const $=$e((o.y+k/mr)/u);return(Ge(.5*($e((o.y+U/mr)/u)+$))*u-o.y)*mr}}))}function p1(s,t,o,u,f,A){const v=Math.pow(2,u.z-f.z);for(let C=0;C<o;C++){let P=s.int16[2*(C+t)+0],k=s.int16[2*(C+t)+1];P=(P+f.x*mr)*v-u.x*mr,k=(k+f.y*mr)*v-u.y*mr,A.push(new rr(P,k))}}let m1,G0;Rr(j0,"FillExtrusionBucket",{omit:["layers","features"]}),Rr(VA,"PartData"),Rr(UA,"FootprintSegment"),Rr(jd,"BorderCentroidData"),Rr(Fy,"GroundEffect");class h extends rr{constructor(t,o,u){super(t,o),this.z=u}}class _ extends h{constructor(t,o,u,f){super(t,o,u),this.w=f}}function M(s,t,o,u){const f=o==="x"?"y":"x",A=(u-s[o])/(t[o]-s[o]);s[f]=Math.round(s[f]+(t[f]-s[f])*A),s[o]=u,s.hasOwnProperty("z")&&(s.z=hn(s.z,t.z,A)),s.hasOwnProperty("w")&&(s.w=hn(s.w,t.w,A))}function L(s,t,o,u){const f=o,A=u;for(const v of["x","y"]){let C=s,P=t;C[v]>=P[v]&&(C=t,P=s),C[v]<f&&P[v]>f&&M(C,P,v,f),C[v]<A&&P[v]>A&&M(P,C,v,A)}}function X(s,t,o,u,f,A){const v=[];for(let C=0;C<s.length;C++){const P=s[C];let k;const U=v.length;let $=0;for(let q=0;q<P.length-1;q++){let K=P[q],J=P[q+1],de=0;const Ae=$;let _e,Ie;A&&(de=Math.hypot(J.x-K.x,J.y-K.y),$+=de,_e=K,Ie=J),K.x<t&&J.x<t||(K.x<t?K=new rr(t,K.y+(t-K.x)/(J.x-K.x)*(J.y-K.y))._round():J.x<t&&(J=new rr(t,K.y+(t-K.x)/(J.x-K.x)*(J.y-K.y))._round()),K.y<o&&J.y<o||(K.y<o?K=new rr(K.x+(o-K.y)/(J.y-K.y)*(J.x-K.x),o)._round():J.y<o&&(J=new rr(K.x+(o-K.y)/(J.y-K.y)*(J.x-K.x),o)._round()),K.x>=u&&J.x>=u||(K.x>=u?K=new rr(u,K.y+(u-K.x)/(J.x-K.x)*(J.y-K.y))._round():J.x>=u&&(J=new rr(u,K.y+(u-K.x)/(J.x-K.x)*(J.y-K.y))._round()),K.y>=f&&J.y>=f||(K.y>=f?K=new rr(K.x+(f-K.y)/(J.y-K.y)*(J.x-K.x),f)._round():J.y>=f&&(J=new rr(K.x+(f-K.y)/(J.y-K.y)*(J.x-K.x),f)._round()),k&&K.equals(k[k.length-1])||(k=[K],v.push(k),A&&A.push({progress:{min:Ae+De(_e,Ie,K)*de,max:1},parentIndex:C,prevPoint:_e,nextPoint:Ie})),k.push(J),A&&(A[A.length-1].progress.max=Ae+De(_e,Ie,J)*de,A[A.length-1].nextPoint=Ie)))))}if(A&&$>0)for(let q=U;q<v.length;q++)A[q].progress.min/=$,A[q].progress.max/=$}return v}function ie(s,t,o,u,f){if(s.length<2)return void u.push(s);const A=[];for(;t.valid();){const[k,U]=t.get();for(let $=0;$<s.length-1;$++){const q=s[$],K=s[$+1],J=Wo(q,K,k,U);if(J){const[de]=J,Ae=new rr(hn(q.x,K.x,de),hn(q.y,K.y,de));A.push({t:$+de,distance:0,point:Ae})}}t.next()}if(A.length===0)return void u.push(s);A.sort(((k,U)=>k.t-U.t));let v=0,C=0,P=[];for(u.push(P);v!==s.length;){if(C===A.length){for(;v!==s.length;)P.length!==0&&P[P.length-1].equals(s[v])||P.push(s[v]),v++;break}A[C].t<=v?(P.length!==0&&P[P.length-1].equals(A[C].point)||P.push(A[C].point),Math.trunc(A[C].t),C++):(P.length!==0&&P[P.length-1].equals(s[v])||P.push(s[v]),v++)}}function De(s,t,o){return s.x!==t.x?(o.x-s.x)/(t.x-s.x):s.y!==t.y?(o.y-s.y)/(t.y-s.y):0}function Xe(s,t){return s.x*t.x+s.y*t.y}function Tt(s,t){if(s.length===1){let o=0;const u=t[o++];let f;for(;!f||u.equals(f);)if(f=t[o++],!f)return 1/0;for(;o<t.length;o++){const A=t[o],v=s[0],C=f.sub(u),P=A.sub(u),k=v.sub(u),U=Xe(C,C),$=Xe(C,P),q=Xe(P,P),K=Xe(k,C),J=Xe(k,P),de=U*q-$*$,Ae=(q*K-$*J)/de,_e=(U*J-$*K)/de,Ie=u.z*(1-Ae-_e)+f.z*Ae+A.z*_e;if(isFinite(Ie))return Ie}return 1/0}{let o=1/0;for(const u of t)o=Math.min(o,u.z);return o}}function dr(s,t,o,u,f,A,v,C){const P=v*f.getElevationAt(s,t,!0,!0),k=A[0]!==0,U=k?A[1]===0?v*(A[0]/7-450):v*(function($,q,K){const J=Math.floor(q[0]/8),de=Math.floor(q[1]/8),Ae=10*(q[0]-8*J),_e=10*(q[1]-8*de),Ie=$.getElevationAt(J,de,!0,!0),Pe=$.getMeterToDEM(K),ke=Math.floor(.5*(Ae*Pe-1)),Ye=Math.floor(.5*(_e*Pe-1)),Qe=$.tileCoordToPixel(J,de),tt=2*ke+1,it=2*Ye+1,ct=(function(er,hr,Nt,tr,Mt){return[er.getElevationAtPixel(hr,Nt,!0),er.getElevationAtPixel(hr+Mt,Nt,!0),er.getElevationAtPixel(hr,Nt+Mt,!0),er.getElevationAtPixel(hr+tr,Nt+Mt,!0)]})($,Qe.x-ke,Qe.y-Ye,tt,it),$t=Math.abs(ct[0]-ct[1]),mt=Math.abs(ct[2]-ct[3]),Wt=Math.abs(ct[0]-ct[2])+Math.abs(ct[1]-ct[3]),sr=Math.min(.25,.5*Pe*($t+mt)/tt),Kt=Math.min(.25,.5*Pe*Wt/it);return Ie+Math.max(sr*Ae,Kt*_e)})(f,A,C):P;return{base:P+(o===0?-1:o),top:k?Math.max(U+u,P+o+2):P+u}}class zr{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Zr{constructor(){this.tasks={},this.taskQueue=[],Dr(["process"],this),this.invoker=new zr(this.process),this.nextId=0}add(t,o){const u=this.nextId++,f=(function({type:A,isSymbolTile:v,zoom:C}){return C=C||0,A==="message"?0:A!=="maybePrepare"||v?A!=="parseTile"||v?A==="parseTile"&&v?300-C:A==="maybePrepare"&&v?400-C:500:200-C:100-C})(o);if(f===0){try{t()}finally{}return null}return this.tasks[u]={fn:t,metadata:o,priority:f,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((u=>!!this.tasks[u])),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const o=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let t=null,o=1/0;for(let f=0;f<this.taskQueue.length;f++){const A=this.tasks[this.taskQueue[f]];A.priority<o&&(o=A.priority,t=f)}if(t===null)return null;const u=this.taskQueue[t];return this.taskQueue.splice(t,1),u}remove(){this.invoker.remove()}}class Ar{constructor(t,o,u){this.target=t,this.parent=o,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Dr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Zr}send(t,o,u,f,A=!1,v){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=v,this.callbacks[C]=u);const P=new Set;return this.target.postMessage({id:C,type:t,hasCallback:!!u,targetMapId:f,mustQueue:A,sourceMapId:this.mapId,data:ph(o,P)},P),{cancel:()=>{u&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:f,sourceMapId:this.mapId})}}}receive(t){const o=t.data;if(!o)return;const u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const f=this.cancelCallbacks[u];delete this.cancelCallbacks[u],f&&f.cancel()}else if(o.mustQueue||Ui(self)){const f=this.callbacks[u],A=this.scheduler.add((()=>this.processTask(u,o)),f&&f.metadata||{type:"message"});A&&(this.cancelCallbacks[u]=A)}else this.processTask(u,o)}processTask(t,o){if(delete this.cancelCallbacks[t],o.type==="<response>"){const u=this.callbacks[t];delete this.callbacks[t],u&&(o.error?u(Fc(o.error)):u(null,Fc(o.data)))}else{const u=new Set,f=o.hasCallback?(v,C)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:v?ph(v):null,data:ph(C,u)},u)}:()=>{},A=Fc(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,A,f);else if(this.parent.getWorkerSource){const v=o.type.split("."),{source:C,scope:P}=A;this.parent.getWorkerSource(o.sourceMapId,v[0],C,P)[v[1]](A,f)}else f(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var gr={workerUrl:"",workerClass:null,workerParams:void 0};const Pi="mapboxgl_preloaded_worker_pool";class li{constructor(){this.active={}}acquire(t,o=li.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(gr.workerClass!=null?new gr.workerClass:new self.Worker(gr.workerUrl,gr.workerParams));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Pi]}numActive(){return Object.keys(this.active).length}}li.workerCount=2;class Yo{constructor(t,o,u="Worker",f=li.workerCount){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=kt();const A=this.workerPool.acquire(this.id,f);for(let v=0;v<A.length;v++){const C=new Yo.Actor(A[v],o,this.id);C.name=`${u} ${v}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(t,o,u){vt(this.actors,((f,A)=>{f.send(t,o,A)}),u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((t=>{t.remove()})),this.actors=[],this.workerPool.release(this.id)}}let Yt,Ft;function nr(){return Yt||(Yt=new li),Yt}Yo.Actor=Ar;class Nr{constructor(t){this.module=t}createIntArray(t){const o=new Int32Array(t),u=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heap32.set(o,u/o.BYTES_PER_ELEMENT),u}createFloatArray(t){const o=new Float32Array(t),u=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heapF32.set(o,u/o.BYTES_PER_ELEMENT),u}createStringBuffer(t){const o=this.module.malloc(t.length+1);for(let u=0;u<t.length;++u)this.module.heapU8[o+u]=t.charCodeAt(u);return this.module.heapU8[o+t.length]=0,o}readStringBuffer(t){let o="";for(;this.module.heapU8[t]!==0;)o+=String.fromCharCode(this.module.heapU8[t]),++t;return o}setStyle(t){const o=t.entranceColorRgb,u=t.facadeGlazingColorRgb,f=t.roofColorRgb,A=t.wallColorRgb,v=t.normalScale;this.module.setStyle(o[0],o[1],o[2],u[0],u[1],u[2],f[0],f[1],f[2],A[0],A[1],A[2],v[0],v[1],v[2],t.tileToMeters)}setAOOptions(t,o){this.module.setAOOptions(t?1:0,o)}setMetricOptions(t,o){this.module.setMetricOptions(t?1:0,o)}setStructuralOptions(t){this.module.setStructuralOptions(t?1:0)}setFacadeOptions(t,o){this.module.setFacadeOptions(t,o?1:0)}setFauxFacadeOptions(t,o,u){this.module.setFauxFacadeOptions(t?1:0,o?1:0,u)}setFacadeClassifierOptions(t){this.module.setFacadeClassifierOptions(t)}generateMesh(t,o){for(const C of t){const P=this.createStringBuffer(C.roofType),k=[0],U=[];for(const K of C.coordinates)if(Array.isArray(K)){for(const J of K)U.push(J.x),U.push(J.y);k.push(U.length)}const $=this.createIntArray(k),q=this.createFloatArray(U);this.module.addFeature(C.id,C.sourceId,C.minHeight,C.height,P,C.roofType.length,q,$,k.length-1),this.module.free(P),this.module.free($),this.module.free(q)}for(const C of o){let P;P=C.entrances?JSON.parse(C.entrances):[];const k=this.createFloatArray(P),U=[];for(const q of C.coordinates)U.push(q.x),U.push(q.y);const $=this.createFloatArray(U);this.module.addFacade(C.sourceId,C.crossPerc,C.distanceToRoad,k,P.length,$,U.length),this.module.free(k),this.module.free($)}if(!this.module.generateMesh()){const C=this.module.getLastError();return this.readStringBuffer(C)}const u=this.module.getMeshCount(),f=new Array(u);for(let C=0;C<u;C++){const P=this.module.getPositionsPtr(C),k=this.module.getPositionsLength(C),U=new Float32Array(this.module.heapF32.buffer,P,k),$=this.module.getNormalsPtr(C),q=this.module.getNormalsLength(C),K=new Float32Array(this.module.heapF32.buffer,$,q),J=this.module.getColorsPtr(C),de=this.module.getColorsLength(C),Ae=new Uint8Array(this.module.heapU8.buffer,J,de),_e=this.module.getAOPtr(C),Ie=this.module.getAOLength(C),Pe=new Float32Array(this.module.heapF32.buffer,_e,Ie),ke=this.module.getUVPtr(C),Ye=this.module.getUVLength(C),Qe=new Float32Array(this.module.heapF32.buffer,ke,Ye),tt=this.module.getFauxFacadePtr(C),it=this.module.getFauxFacadeLength(C),ct=new Uint8Array(this.module.heapU8.buffer,tt,it),$t=this.module.getIndicesPtr(C),mt=this.module.getIndicesLength(C),Wt=new Int32Array(this.module.heap32.buffer,$t,mt),sr=this.module.getBuildingPart(C),Kt=this.readStringBuffer(sr);f[C]={positions:U,normals:K,colors:Ae,ao:Pe,uv:Qe,isFauxFacade:ct,indices:Wt,buildingPart:Kt}}const A=this.module.getRingCount(),v=[];for(let C=0;C<A;C++){const P=this.module.getRingPtr(C),k=this.module.getRingLength(C),U=new Float32Array(this.module.heapF32.buffer,P,k);v.push(U)}return{meshes:f,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:v}}}let Gn,fo,Wn,fi,Fs,ko=null,Nu=null,A1=null,g1=null;function xI(){return Ui(self)&&self.worker.dracoUrl?self.worker.dracoUrl:fo||ss.DRACO_URL}function bI(){if(Ui(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(fi)return fi;const s=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return fi=WebAssembly.validate(s)?ss.MESHOPT_SIMD_URL:ss.MESHOPT_URL,fi}function cj(){return g1}const _1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},uj={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},jy={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function wI(s,t,o){const u=o.json.bufferViews.length,f=o.buffers.length;t.bufferView=u,o.json.bufferViews[u]={buffer:f,byteLength:s.byteLength},o.buffers[f]=s}const Z2="KHR_draco_mesh_compression";function hj(s,t){const o=s.extensions&&s.extensions[Z2];if(!o)return;const u=new Wn.Decoder,f=CI(t,o.bufferView),A=new Wn.Mesh;if(!u.DecodeArrayToMesh(f,f.byteLength,A))throw new Error("Failed to decode Draco mesh");const v=t.json.accessors[s.indices],C=_1[v.componentType],P=v.count*C.BYTES_PER_ELEMENT,k=Wn._malloc(P);C===Uint16Array?u.GetTrianglesUInt16Array(A,P,k):u.GetTrianglesUInt32Array(A,P,k),wI(Wn.memory.buffer.slice(k,k+P),v,t),Wn._free(k);for(const U of Object.keys(o.attributes)){const $=u.GetAttributeByUniqueId(A,o.attributes[U]),q=t.json.accessors[s.attributes[U]],K=uj[q.componentType],J=q.count*jy[q.type]*_1[q.componentType].BYTES_PER_ELEMENT,de=Wn._malloc(J);u.GetAttributeDataArrayForAllPoints(A,$,Wn[K],J,de),wI(Wn.memory.buffer.slice(de,de+J),q,t),Wn._free(de)}u.destroy(),A.destroy(),delete s.extensions[Z2]}const y1="EXT_meshopt_compression";function fj(s,t){if(!s.extensions||!s.extensions[y1])return;const o=s.extensions[y1],u=new Uint8Array(t.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),f=new Uint8Array(o.count*o.byteStride);Fs.decodeGltfBuffer(f,o.count,o.byteStride,u,o.mode,o.filter),s.buffer=t.buffers.length,s.byteOffset=0,t.buffers[s.buffer]=f.buffer,delete s.extensions[y1]}const SI=1179937895,TI=new TextDecoder("utf8");function EI(s,t){return new URL(s,t).href}function dj(s,t,o,u){return fetch(EI(s.uri,u)).then((f=>f.arrayBuffer())).then((f=>{t.buffers[o]=f}))}function CI(s,t){const o=s.json.bufferViews[t];return new Uint8Array(s.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function pj(s,t,o,u){if(s.uri){const f=EI(s.uri,u);return fetch(f).then((A=>A.blob())).then((A=>createImageBitmap(A))).then((A=>{t.images[o]=A}))}if(s.bufferView!==void 0){const f=CI(t,s.bufferView),A=new Blob([f],{type:s.mimeType});return createImageBitmap(A).then((v=>{t.images[o]=v}))}}function MI(s,t=0,o){const u={json:null,images:[],buffers:[]};if(new Uint32Array(s,t,1)[0]===SI){const U=new Uint32Array(s,t);let $=2;const q=(U[$++]>>2)-3,K=U[$++]>>2;if($++,u.json=JSON.parse(TI.decode(U.subarray($,$+K))),$+=K,$<q){const J=U[$++];$++;const de=t+($<<2);u.buffers[0]=s.slice(de,de+J)}}else u.json=JSON.parse(TI.decode(new Uint8Array(s,t)));const{buffers:f,images:A,meshes:v,extensionsUsed:C,bufferViews:P}=u.json;let k=Promise.resolve();if(f){const U=[];for(let $=0;$<f.length;$++){const q=f[$];q.uri?U.push(dj(q,u,$,o)):u.buffers[$]||(u.buffers[$]=null)}k=Promise.all(U)}return k.then((()=>{const U=[],$=C&&C.includes(Z2),q=C&&C.includes(y1);if($&&U.push((function(){if(!Wn)return Gn??(Gn=(function(K){let J,de=null;function Ae(){J=new Uint8Array(de.buffer)}function _e(){throw new Error("Unexpected Draco error.")}const Ie={a:{a:_e,d:function(Pe,ke,Ye){return J.copyWithin(Pe,ke,ke+Ye)},c:function(Pe){const ke=J.length,Ye=Math.max(Pe>>>0,Math.ceil(1.2*ke)),Qe=Math.ceil((Ye-ke)/65536);try{return de.grow(Qe),Ae(),!0}catch{return!1}},b:_e}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(K,Ie):K.then((Pe=>Pe.arrayBuffer())).then((Pe=>WebAssembly.instantiate(Pe,Ie)))).then((Pe=>{const{Rb:ke,Qb:Ye,P:Qe,T:tt,X:it,Ja:ct,La:$t,Qa:mt,Va:Wt,Wa:sr,eb:Kt,jb:er,f:hr,e:Nt,yb:tr,zb:Mt,Ab:St,Bb:pr,Db:cr,Gb:nn}=Pe.instance.exports;de=Nt;const kr=(()=>{let Xr=0,_r=0,en=0,Cn=0;return Er=>{en&&(ke(Cn),ke(Xr),_r+=en,en=Xr=0),Xr||(_r+=128,Xr=Ye(_r));const Qr=Er.length+7&-8;let vn=Xr;Qr>=_r&&(en=Qr,vn=Cn=Ye(Qr));for(let kn=0;kn<Er.length;kn++)J[vn+kn]=Er[kn];return vn}})();return Ae(),hr(),{memory:Nt,_free:ke,_malloc:Ye,Mesh:class{constructor(){this.ptr=Qe()}destroy(){tt(this.ptr)}},Decoder:class{constructor(){this.ptr=ct()}destroy(){er(this.ptr)}DecodeArrayToMesh(Xr,_r,en){const Cn=kr(Xr),Er=$t(this.ptr,Cn,_r,en.ptr);return!!it(Er)}GetAttributeByUniqueId(Xr,_r){return{ptr:mt(this.ptr,Xr.ptr,_r)}}GetTrianglesUInt16Array(Xr,_r,en){Wt(this.ptr,Xr.ptr,_r,en)}GetTrianglesUInt32Array(Xr,_r,en){sr(this.ptr,Xr.ptr,_r,en)}GetAttributeDataArrayForAllPoints(Xr,_r,en,Cn,Er){Kt(this.ptr,Xr.ptr,_r.ptr,en,Cn,Er)}},DT_INT8:tr(),DT_UINT8:Mt(),DT_INT16:St(),DT_UINT16:pr(),DT_UINT32:cr(),DT_FLOAT32:nn()}}))})(fetch(xI())),Gn.then((K=>{Wn=K,Gn=void 0})))})()),q&&U.push((function(){if(Fs)return;const K=(function(J){let de;const Ae=WebAssembly.instantiateStreaming(J,{}).then((Pe=>{de=Pe.instance,de.exports.__wasm_call_ctors()})),_e={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Ie={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Ae,supported:!0,decodeGltfBuffer(Pe,ke,Ye,Qe,tt,it){(function(ct,$t,mt,Wt,sr,Kt,er){const hr=ct.exports.sbrk,Nt=Wt+3&-4,tr=hr(Nt*sr),Mt=hr(Kt.length),St=new Uint8Array(ct.exports.memory.buffer);St.set(Kt,Mt);const pr=$t(tr,Wt,sr,Mt,Kt.length);if(pr===0&&er&&er(tr,Nt,sr),mt.set(St.subarray(tr,tr+Wt*sr)),hr(tr-hr(0)),pr!==0)throw new Error(`Malformed buffer data: ${pr}`)})(de,de.exports[Ie[tt]],Pe,ke,Ye,Qe,de.exports[_e[it]])}}})(fetch(bI()));return K.ready.then((()=>{Fs=K}))})()),A)for(let K=0;K<A.length;K++)U.push(pj(A[K],u,K,o));return(U.length?Promise.all(U):Promise.resolve()).then((()=>{if($&&v)for(const{primitives:K}of v)for(const J of K)hj(J,u);if(q&&v&&P)for(const K of P)fj(K,u);return u}))}))}function X2(s){switch(s){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Y2(s){switch(s){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Q2{constructor(t,o,u,f){this.context=t,this.format=u,this.useMipmap=f&&f.useMipmap,this.texture=t.gl.createTexture(),this.update(o,{premultiply:f&&f.premultiply})}update(t,o){const u=t&&t instanceof HTMLVideoElement&&t.width===0?t.videoWidth:t.width,f=t&&t instanceof HTMLVideoElement&&t.height===0?t.videoHeight:t.height,{context:A}=this,{gl:v}=A,{x:C,y:P}=o&&o.position?o.position:{x:0,y:0},k=C+u,U=P+f;!this.size||this.size[0]===k&&this.size[1]===U||(v.bindTexture(v.TEXTURE_2D,null),v.deleteTexture(this.texture),this.texture=v.createTexture(),this.size=null),v.bindTexture(v.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA8&&(!o||o.premultiply!==!1));const $=t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap;if(!this.size&&k>0&&U>0){const q=this.useMipmap?Math.floor(Math.log2(Math.max(k,U)))+1:1;v.texStorage2D(v.TEXTURE_2D,q,this.format,k,U),this.size=[k,U]}this.size&&($?v.texSubImage2D(v.TEXTURE_2D,0,C,P,X2(this.format),Y2(this.format),t):"data"in t&&t.data&&v.texSubImage2D(v.TEXTURE_2D,0,C,P,u,f,X2(this.format),Y2(this.format),t.data)),this.useMipmap&&v.generateMipmap(v.TEXTURE_2D)}bind(t,o,u=!1){const{context:f}=this,{gl:A}=f;A.bindTexture(A.TEXTURE_2D,this.texture),t!==this.minFilter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,t),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,this.useMipmap&&!u?t===A.NEAREST?A.NEAREST_MIPMAP_NEAREST:A.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),o!==this.wrapS&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,o),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(t,o,u,f,A){const{context:v}=this,{gl:C}=v;C.bindTexture(C.TEXTURE_2D,this.texture),o!==this.magFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,o),this.magFilter=o),t!==this.minFilter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,this.useMipmap?t===C.NEAREST?C.NEAREST_MIPMAP_NEAREST:C.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),u!==this.wrapS&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,u),this.wrapS=u),f!==this.wrapT&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,f),this.wrapT=f),A!==this.compareMode&&(A?(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.COMPARE_REF_TO_TEXTURE),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_FUNC,A)):C.texParameteri(C.TEXTURE_2D,C.TEXTURE_COMPARE_MODE,C.NONE),this.compareMode=A)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Uy{constructor(t,o){this.context=t,this.texture=o}bind(t,o){const{context:u}=this,{gl:f}=u;f.bindTexture(f.TEXTURE_2D,this.texture),t!==this.minFilter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,t),this.minFilter=t),o!==this.wrapS&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,o),this.wrapS=o)}}const mj=ii([{name:"a_pos_3f",components:3,type:"Float32"}]),Aj=ii([{name:"a_color_3f",components:3,type:"Float32"}]),gj=ii([{name:"a_color_4f",components:4,type:"Float32"}]),_j=ii([{name:"a_uv_2f",components:2,type:"Float32"}]),yj=ii([{name:"a_normal_3f",components:3,type:"Float32"}]),vj=ii([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),xj=ii([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function II(s,t){const o=v1(s.projection,s.zoom,s.width,s.height),u=(function(A,v,C,P,k){const U=new he(C.lng-180*HA,C.lat),$=new he(C.lng+180*HA,C.lat),q=A.project(U.lng,U.lat),K=A.project($.lng,$.lat),J=-Math.atan2(K.y-q.y,K.x-q.x),de=It.fromLngLat(C);de.y=ce(de.y,-1+HA,1-HA);const Ae=de.toLngLat(),_e=A.project(Ae.lng,Ae.lat),Ie=It.fromLngLat(Ae);Ie.x+=HA;const Pe=Ie.toLngLat(),ke=A.project(Pe.lng,Pe.lat),Ye=RI(ke.x-_e.x,ke.y-_e.y,J),Qe=It.fromLngLat(Ae);Qe.y+=HA;const tt=Qe.toLngLat(),it=A.project(tt.lng,tt.lat),ct=RI(it.x-_e.x,it.y-_e.y,J),$t=Math.abs(Ye.x)/Math.abs(ct.y),mt=oe([]);Be(mt,mt,-J*(1-(k?0:P)));const Wt=oe([]);return ve(Wt,Wt,[1,1-(1-$t)*P,1]),Wt[4]=-ct.x/ct.y*P,Be(Wt,Wt,J),ye(Wt,mt,Wt),Wt})(s.projection,0,s.center,o,t),f=PI(s);return ve(u,u,[f,f,1]),u}function PI(s){const t=s.projection,o=v1(s.projection,s.zoom,s.width,s.height),u=K2(t,s.center),f=K2(t,he.convert(t.center));return Math.pow(2,u*o+(1-o)*f)}function v1(s,t,o,u,f=1/0){const A=s.range;if(!A)return 0;const v=Math.min(f,Math.max(o,u)),C=Math.log2(v/1024);return At(A[0]+C,A[1]+C,t)}const HA=1/4e4;function K2(s,t){const o=ce(t.lat,-We,We),u=new he(t.lng-180*HA,o),f=new he(t.lng+180*HA,o),A=s.project(u.lng,o),v=s.project(f.lng,o),C=It.fromLngLat(u),P=It.fromLngLat(f),k=v.x-A.x,U=v.y-A.y,$=P.x-C.x,q=P.y-C.y,K=Math.sqrt(($*$+q*q)/(k*k+U*U));return Math.log2(K)}function RI(s,t,o){const u=Math.cos(o),f=Math.sin(o);return{x:s*u-t*f,y:s*f+t*u}}function DI(s,t,o){oe(s),Be(s,s,ut(t[2])),Ce(s,s,ut(t[0])),Ee(s,s,ut(t[1])),ve(s,s,o),ye(s,s,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function x1(s,t,o,u,f,A,v,C){const P=[o[0]-t[0],o[1]-t[1],0],k=[u[0]-t[0],u[1]-t[1],0];if(Pt(P)<1e-12||Pt(k)<1e-12)return Ca(s);const U=jn([],P,k);Hr(U,U),Zt(k,u,t),P[2]=(A-f)*C,k[2]=(v-f)*C;const $=P;return jn($,P,k),Hr($,$),Va(s,U,$)}function J2(s,t,o=!1){const u=Jf(t.zoom),f=(function(A,v,C){const P=v.worldSize,k=[A[12],A[13],A[14]],U=$e(k[1]/P),$=Ze(k[0]/P),q=oe([]),K=Ue(1,U)*P,J=Ue(1,0)*P*lt(U,v.zoom),de=1/$g(P);let Ae=J*de;if(C){const ke=v1(v.projection,v.zoom,v.width,v.height,1024);Ae=de*v.projection.pixelSpaceConversion(v.center.lat,P,ke)}const _e=Y(U,$);et(_e,_e,Vt([],Hr([],_e),K*Ae*k[2]));const Ie=(function(ke){const Ye=[ke[0],ke[1],ke[2]];let Qe=[0,1,0];const tt=jn([],Qe,Ye);return jn(Qe,Ye,tt),ln(Qe)===0&&(Qe=[0,1,0],jn(tt,Ye,Qe)),Hr(tt,tt),Hr(Qe,Qe),Hr(Ye,Ye),[tt[0],tt[1],tt[2],0,Qe[0],Qe[1],Qe[2],0,Ye[0],Ye[1],Ye[2],0,ke[0],ke[1],ke[2],1]})(_e);ve(q,q,[Ae,Ae,Ae*K]),we(q,q,[-k[0],-k[1],-k[2]]);const Pe=ye([],v.globeMatrix,Ie);return ye(Pe,Pe,q),ye(Pe,Pe,A),Pe})(s,t,o);if(u>0){const A=(function(v,C){const P=C.worldSize,k=Ue(1,0)*P*lt(C.center.lat,C.zoom)/$g(P),U=Ue(1,C.center.lat)*P,$=oe([]);Ee($,$,ut(C.center.lng)),Ce($,$,ut(C.center.lat)),we($,$,[0,0,d]),ve($,$,[k,k,k*U]);const q=C.point;return we($,$,[-q.x,-q.y,0]),ye($,$,v),ye($,C.globeMatrix,$)})(s,t);return(function(v,C,P){const k=(J,de,Ae)=>{const _e=Pt(J),Ie=Pt(de),Pe=$c(J,de,Ae);return Vt(Pe,Pe,1/Pt(Pe)*hn(_e,Ie,Ae))},U=k([v[0],v[1],v[2]],[C[0],C[1],C[2]],P),$=k([v[4],v[5],v[6]],[C[4],C[5],C[6]],P),q=k([v[8],v[9],v[10]],[C[8],C[9],C[10]],P),K=$c([v[12],v[13],v[14]],[C[12],C[13],C[14]],P);return[U[0],U[1],U[2],0,$[0],$[1],$[2],0,q[0],q[1],q[2],0,K[0],K[1],K[2],1]})(f,A,u)}return f}function OI(s,t,o,u){const f=An.projectAabbCorners(u,o);let A=Number.MAX_VALUE,v=-1;for(let k=0;k<f.length;++k){const U=f[k];U[0]=(.5*U[0]+.5)*t.width,U[1]=(.5-.5*U[1])*t.height,U[2]<A&&(v=k,A=U[2])}const C=k=>new rr(f[k][0],f[k][1]);let P;switch(v){case 0:case 6:P=[C(1),C(5),C(4),C(7),C(3),C(2),C(1)];break;case 1:case 7:P=[C(0),C(4),C(5),C(6),C(2),C(3),C(0)];break;case 3:case 5:P=[C(1),C(0),C(4),C(7),C(6),C(2),C(1)];break;default:P=[C(1),C(5),C(6),C(7),C(3),C(0),C(1)]}if(Xl(s,P))return A}const H0=64,u_={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function kI(s,t,o,u,f,A,v,C,P,k=!1){const U=o.zoom,$=o.project(u),q=lt(u.lat,U),K=1/q;oe(s),we(s,s,[$.x+v[0]*K,$.y+v[1]*K,v[2]]);let J=1,de=1;const Ae=o.worldSize;if(k){if(o.projection.name==="mercator"){let ke=0;o.elevation&&(ke=o.elevation.getAtPointOrZero(new It($.x/Ae,$.y/Ae),0));const Ye=_i([],[$.x,$.y,ke,1],o.projMatrix)[3]/o.cameraToCenterDistance;J=Ye,de=Ye*lt(o.center.lat,U)}else if(o.projection.name==="globe"){const ke=J2(s,o),Ye=[0,0,0,1];_i(Ye,Ye,ye([],o.projMatrix,ke));const Qe=Ye[3]/o.cameraToCenterDistance,tt=Jf(U),it=o.projection.pixelsPerMeter(u.lat,Ae)*lt(u.lat,U),ct=o.projection.pixelsPerMeter(o.center.lat,Ae)*lt(o.center.lat,U);J=Qe/hn(it,yt(o.center.lat),tt),de=Qe*q/it,J*=ct,de*=ct}}else J=K;ve(s,s,[J,J,de]);const _e=[...s],Ie=t.orientation,Pe=[];if(DI(Pe,[Ie[0]+f[0],Ie[1]+f[1],Ie[2]+f[2]],A),ye(s,_e,Pe),C&&o.elevation){let ke=0;const Ye=[];if(P&&o.elevation){ke=(function(tt,it,ct,$t,mt){const Wt=it.elevation;if(!Wt)return 0;const sr=An.projectAabbCorners(ct,$t),Kt=Ue(1,mt.lat)*it.worldSize,er=(function(_r,en){const Cn=[0,0,1],Er=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Qr of Er){const vn=_r[Qr.corners[0]],kn=_r[Qr.corners[1]],Qn=_r[Qr.corners[2]],Vn=[kn[0]-vn[0],kn[1]-vn[1],en*(kn[2]-vn[2])],jr=jn(Vn,Vn,[Qn[0]-vn[0],Qn[1]-vn[1],en*(Qn[2]-vn[2])]);Hr(jr,jr),Qr.dotProductWithUp=Nn(jr,Cn)}return Er.sort(((Qr,vn)=>Qr.dotProductWithUp-vn.dotProductWithUp)),Er[0].corners})(sr,Kt),hr=sr[er[0]],Nt=sr[er[1]],tr=sr[er[2]],Mt=sr[er[3]],St=Wt.getAtPointOrZero(new It(hr[0]/it.worldSize,hr[1]/it.worldSize),0),pr=Wt.getAtPointOrZero(new It(Nt[0]/it.worldSize,Nt[1]/it.worldSize),0),cr=Wt.getAtPointOrZero(new It(tr[0]/it.worldSize,tr[1]/it.worldSize),0),nn=Wt.getAtPointOrZero(new It(Mt[0]/it.worldSize,Mt[1]/it.worldSize),0),kr=(St+nn)/2,Xr=(pr+cr)/2;return kr>Xr?pr<cr?x1(tt,Nt,Mt,hr,pr,nn,St,Kt):x1(tt,tr,hr,Mt,cr,St,nn,Kt):St<nn?x1(tt,hr,Nt,tr,St,pr,cr,Kt):x1(tt,Mt,tr,Nt,nn,cr,pr,Kt),Math.max(kr,Xr)})(Ye,o,t.aabb,s,u);const Qe=ye([],dt([],Ye),Pe);ye(s,_e,Qe)}else ke=o.elevation.getAtPointOrZero(new It($.x/Ae,$.y/Ae),0);ke!==0&&(s[14]+=ke)}}function Vy(s,t,o=!1){s.uploaded||(s.gfxTexture=new Q2(t,s.image,o?t.gl.R8:t.gl.RGBA8,{useMipmap:s.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),s.uploaded=!0,s.image=null)}function bj(s,t,o){s.indexBuffer=t.createIndexBuffer(s.indexArray,!1,!0),s.vertexBuffer=t.createVertexBuffer(s.vertexArray,mj.members,!1,!0),s.normalArray&&(s.normalBuffer=t.createVertexBuffer(s.normalArray,yj.members,!1,!0)),s.texcoordArray&&(s.texcoordBuffer=t.createVertexBuffer(s.texcoordArray,_j.members,!1,!0)),s.colorArray&&(s.colorBuffer=t.createVertexBuffer(s.colorArray,(s.colorArray.bytesPerElement===12?Aj:gj).members,!1,!0)),s.featureArray&&(s.pbrBuffer=t.createVertexBuffer(s.featureArray,xj.members,!0)),s.segments=No.simpleSegment(0,0,s.vertexArray.length,s.indexArray.length);const u=s.material;u.pbrMetallicRoughness.baseColorTexture&&Vy(u.pbrMetallicRoughness.baseColorTexture,t),u.pbrMetallicRoughness.metallicRoughnessTexture&&Vy(u.pbrMetallicRoughness.metallicRoughnessTexture,t),u.normalTexture&&Vy(u.normalTexture,t),u.occlusionTexture&&Vy(u.occlusionTexture,t,o),u.emissionTexture&&Vy(u.emissionTexture,t)}function eS(s,t,o){if(s.meshes)for(const u of s.meshes)bj(u,t,o);if(s.children)for(const u of s.children)eS(u,t,o)}function b1(s){if(s.meshes)for(const t of s.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(s.children)for(const t of s.children)b1(t)}function tS(s){if(s.meshes)for(const o of s.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((t=o.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(s.children)for(const o of s.children)tS(o)}function q0(s,t){const o=s.json.bufferViews[t.bufferView],u=_1[t.componentType];return new u(s.buffers[o.buffer],(t.byteOffset||0)+(o.byteOffset||0),t.count*(o.byteStride&&o.byteStride!==jy[t.type]*u.BYTES_PER_ELEMENT?o.byteStride/u.BYTES_PER_ELEMENT:jy[t.type]))}function rS(s,t,o,u){const f=_1[t.componentType],A=(function(U){switch(U){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}})(f),v=s.json.bufferViews[t.bufferView],C=v.byteStride?v.byteStride/f.BYTES_PER_ELEMENT:jy[t.type],P=o.float32,k=P.length/o.capacity;for(let U=0,$=0;U<t.count*C;U+=C,$+=k)for(let q=0;q<k;q++)P[$+q]=u[U+q]*A;o._trim()}function wj(s,t,o){const u=s.indices,f=s.attributes,A={};A.indexArray=new ea;const v=t.json.accessors[u],C=v.count/3;A.indexArray.reserve(C);const P=q0(t,v);for(let q=0;q<C;q++)A.indexArray.emplaceBack(P[3*q],P[3*q+1],P[3*q+2]);A.indexArray._trim(),A.vertexArray=new fl;const k=t.json.accessors[f.POSITION];A.vertexArray.reserve(k.count);const U=q0(t,k);for(let q=0;q<k.count;q++)A.vertexArray.emplaceBack(U[3*q],U[3*q+1],U[3*q+2]);if(A.vertexArray._trim(),A.aabb=new An(k.min,k.max),A.centroid=(function(q,K){const J=[0,0,0],de=q.length;if(de>0){for(let Ae=0;Ae<de;Ae++){const _e=3*q[Ae];J[0]+=K[_e],J[1]+=K[_e+1],J[2]+=K[_e+2]}J[0]/=de,J[1]/=de,J[2]/=de}return J})(P,U),f.COLOR_0!==void 0){const q=t.json.accessors[f.COLOR_0],K=jy[q.type],J=q0(t,q);A.colorArray=K===3?new fl:new Ss,A.colorArray.resize(q.count),rS(t,q,A.colorArray,J)}if(f.NORMAL!==void 0){A.normalArray=new fl;const q=t.json.accessors[f.NORMAL];A.normalArray.resize(q.count);const K=q0(t,q);rS(t,q,A.normalArray,K)}if(f.TEXCOORD_0!==void 0&&o.length>0){A.texcoordArray=new zd;const q=t.json.accessors[f.TEXCOORD_0];A.texcoordArray.resize(q.count);const K=q0(t,q);rS(t,q,A.texcoordArray,K)}if(f._FEATURE_ID_RGBA4444!==void 0){const q=t.json.accessors[f._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(A.featureData=q0(t,q))}f._FEATURE_RGBA4444!==void 0&&(A.featureData=new Uint32Array(q0(t,t.json.accessors[f._FEATURE_RGBA4444]).buffer));const $=s.material;return A.material=(function(q,K){const{emissiveFactor:J=[0,0,0],alphaMode:de="OPAQUE",alphaCutoff:Ae=.5,normalTexture:_e,occlusionTexture:Ie,emissiveTexture:Pe,doubleSided:ke}=q,{baseColorFactor:Ye=[1,1,1,1],metallicFactor:Qe=1,roughnessFactor:tt=1,baseColorTexture:it,metallicRoughnessTexture:ct}=q.pbrMetallicRoughness||{},$t=Ie?K[Ie.index]:void 0;if(Ie&&Ie.extensions&&Ie.extensions.KHR_texture_transform&&$t){const mt=Ie.extensions.KHR_texture_transform;$t.offsetScale=[mt.offset[0],mt.offset[1],mt.scale[0],mt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new vi(...Ye),metallicFactor:Qe,roughnessFactor:tt,baseColorTexture:it?K[it.index]:void 0,metallicRoughnessTexture:ct?K[ct.index]:void 0},doubleSided:ke,emissiveFactor:new vi(...J),alphaMode:de,alphaCutoff:Ae,normalTexture:_e?K[_e.index]:void 0,occlusionTexture:$t,emissionTexture:Pe?K[Pe.index]:void 0,defined:q.defined===void 0}})($!==void 0?t.json.materials[$]:{defined:!1},o),A}function zI(s,t,o){const{matrix:u,rotation:f,translation:A,scale:v,mesh:C,extras:P,children:k}=s,U={};if(U.matrix=u||(function($,q,K,J){var de=q[0],Ae=q[1],_e=q[2],Ie=q[3],Pe=de+de,ke=Ae+Ae,Ye=_e+_e,Qe=de*Pe,tt=de*ke,it=de*Ye,ct=Ae*ke,$t=Ae*Ye,mt=_e*Ye,Wt=Ie*Pe,sr=Ie*ke,Kt=Ie*Ye,er=J[0],hr=J[1],Nt=J[2];return $[0]=(1-(ct+mt))*er,$[1]=(tt+Kt)*er,$[2]=(it-sr)*er,$[3]=0,$[4]=(tt-Kt)*hr,$[5]=(1-(Qe+mt))*hr,$[6]=($t+Wt)*hr,$[7]=0,$[8]=(it+sr)*Nt,$[9]=($t-Wt)*Nt,$[10]=(1-(Qe+ct))*Nt,$[11]=0,$[12]=K[0],$[13]=K[1],$[14]=K[2],$[15]=1,$})([],f||[0,0,0,1],A||[0,0,0],v||[1,1,1]),C!==void 0){U.meshes=o[C];const $=U.anchor=[0,0];for(const q of U.meshes){const{min:K,max:J}=q.aabb;$[0]+=K[0]+J[0],$[1]+=K[1]+J[1]}$[0]=Math.floor($[0]/U.meshes.length/2),$[1]=Math.floor($[1]/U.meshes.length/2)}if(P&&(P.id&&(U.id=P.id),P.lights&&(U.lights=(function($){if(!$.length)return[];const q=(function(_e){const Ie=atob(_e),Pe=new Uint8Array(Ie.length);for(let ke=0;ke<Ie.length;ke++)Pe[ke]=Ie.codePointAt(ke);return Pe})($),K=[],J=q.length/24,de=new Uint16Array(q.buffer),Ae=new Float32Array(q.buffer);for(let _e=0;_e<J;_e++){const Ie=de[2*_e*6]/30,Pe=de[2*_e*6+1]/30,ke=de[2*_e*6+10]/100,Ye=Ae[6*_e+1],Qe=Ae[6*_e+2],tt=Ae[6*_e+3],it=Ae[6*_e+4],ct=tt-Ye,$t=it-Qe,mt=Math.hypot(ct,$t);K.push({pos:[Ye+.5*ct,Qe+.5*$t,Pe],normal:[$t/mt,-ct/mt,0],width:mt,height:Ie,depth:ke,points:[Ye,Qe,tt,it]})}return K})(P.lights))),k){const $=[];for(const q of k)$.push(zI(t.json.nodes[q],t,o));U.children=$}return U}function Sj(s){if(s.vertices.length===0||s.indices.length===0)return null;const t=new Mm(s.vertices,s.indices,8,256),[o,u]=[t.min.clone(),t.max.clone()];return{vertices:s.vertices,indices:s.indices,grid:t,min:o,max:u}}function Tj(s){if(!s.extras||!s.extras.ground)return null;const t=s.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const o=t[0];if(!o||!Array.isArray(o)||o.length===0)return null;const u=[];for(const v of o){if(!Array.isArray(v)||v.length!==2)continue;const C=v[0],P=v[1];typeof C=="number"&&typeof P=="number"&&u.push(new rr(C,P))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let f=0;for(let v=0;v<u.length;v++){const C=u[v],P=u[(v+1)%u.length],k=u[(v+2)%u.length];f+=(C.x-P.x)*(k.y-P.y)-(k.x-P.x)*(C.y-P.y)}f>0&&u.reverse();const A=LA(u.flatMap((v=>[v.x,v.y])),[]);return A.length===0?null:{vertices:u,indices:A}}function Ej(s,t){const o=[],u=[];let f=0;const A=[];for(const v of s){f=o.length;const C=v.vertexArray.float32,P=v.indexArray.uint16;for(let k=0;k<v.vertexArray.length;k++)A[0]=C[3*k+0],A[1]=C[3*k+1],A[2]=C[3*k+2],Gr(A,A,t),o.push(new rr(A[0],A[1]));for(let k=0;k<3*v.indexArray.length;k++)u.push(P[k]+f)}if(u.length%3!=0)return null;for(let v=0;v<u.length;v+=3){const C=o[u[v+0]],P=o[u[v+1]],k=o[u[v+2]];(C.x-P.x)*(k.y-P.y)-(k.x-P.x)*(C.y-P.y)>0&&([u[v+1],u[v+2]]=[u[v+2],u[v+1]])}return{vertices:o,indices:u}}function LI(s){const t=(function(P,k){const U=[],$=WebGL2RenderingContext;if(P.json.textures)for(const q of P.json.textures){const K={magFilter:$.LINEAR,minFilter:$.NEAREST,wrapS:$.REPEAT,wrapT:$.REPEAT};q.sampler!==void 0&&Object.assign(K,P.json.samplers[q.sampler]),U.push({image:k[q.source],sampler:K,uploaded:!1})}return U})(s,s.images),o=(function(P,k){const U=[];for(const $ of P.json.meshes){const q=[];for(const K of $.primitives)q.push(wj(K,P,k));U.push(q)}return U})(s,t),{scenes:u,scene:f,nodes:A}=s.json,v=u?u[f||0].nodes:[...A.keys()],C=[];for(const P of v)C.push(zI(A[P],s,o));return(function(P,k,U){const $={},q=new Set;for(let K=0;K<P.length;K++){const J=U[k[K]];if(!J.extras)continue;const de=J.extras["mapbox:footprint:version"],Ae=J.extras["mapbox:footprint:id"];(de||Ae)&&q.add(K),de==="1.0.0"&&Ae&&($[Ae]=K)}for(let K=0;K<P.length;K++){if(q.has(K))continue;const J=P[K],de=U[k[K]];if(!de.extras)continue;let Ae=null;J.id in $&&(Ae=Ej(P[$[J.id]].meshes,J.matrix)),Ae||(Ae=Tj(de)),Ae&&(J.footprint=Sj(Ae))}if(q.size>0){const K=Array.from(q.values()).sort(((J,de)=>J-de));for(let J=K.length-1;J>=0;J--)P.splice(K[J],1)}})(C,v,s.json.nodes),C}function Cj(s){s.heightmap=new Float32Array(4096),s.heightmap.fill(-1);const t=s.vertexArray.float32,o=s.aabb.min[0]-1,u=s.aabb.min[1]-1,f=H0/(s.aabb.max[0]-o+2),A=H0/(s.aabb.max[1]-u+2);for(let v=0;v<t.length;v+=3){const C=t[v+2],P=(t[v+0]-o)*f|0,k=(t[v+1]-u)*A|0;C>s.heightmap[k*H0+P]&&(s.heightmap[k*H0+P]=C)}}function BI(s,t,o,u,f){o.reserve(o.length+4*s.length),u.reserve(u.length+10*s.length),f.reserve(f.length+10*s.length);let A=u.length;for(const v of s){const C=Math.min(10,Math.max(4,1.3*v.height))*t,P=[-v.normal[1],v.normal[0],0],k=Math.min(.29,.1*v.width/v.depth),U=v.width-2*v.depth*t*(k+.01),$=Jt([],v.pos,P,U/2),q=Jt([],v.pos,P,-U/2),K=[$[0],$[1],$[2]+v.height],J=[q[0],q[1],q[2]+v.height],de=Jt([],v.normal,P,k);Vt(de,de,C);const Ae=Jt([],v.normal,P,-k);Vt(Ae,Ae,C),et(de,$,de),et(Ae,q,Ae),$[2]+=.1,q[2]+=.1,u.emplaceBack(de[0],de[1],de[2]),u.emplaceBack(Ae[0],Ae[1],Ae[2]),u.emplaceBack($[0],$[1],$[2]),u.emplaceBack(q[0],q[1],q[2]),u.emplaceBack(K[0],K[1],K[2]),u.emplaceBack(J[0],J[1],J[2]),u.emplaceBack($[0],$[1],$[2]),u.emplaceBack(q[0],q[1],q[2]),u.emplaceBack(de[0],de[1],de[2]),u.emplaceBack(Ae[0],Ae[1],Ae[2]);const _e=U/C/2;f.emplaceBack(-_e-k,-1,_e,.8),f.emplaceBack(_e+k,-1,_e,.8),f.emplaceBack(-_e,0,_e,1.3),f.emplaceBack(_e,0,_e,1.3),f.emplaceBack(_e+k,-.8,_e,.7),f.emplaceBack(_e+k,-.8,_e,.7),f.emplaceBack(0,0,_e,1.3),f.emplaceBack(0,0,_e,1.3),f.emplaceBack(_e+k,-1.2,_e,.8),f.emplaceBack(_e+k,-1.2,_e,.8),o.emplaceBack(6+A,4+A,8+A),o.emplaceBack(7+A,9+A,5+A),o.emplaceBack(0+A,1+A,2+A),o.emplaceBack(1+A,3+A,2+A),A+=10}}function Mj(s,t){const o={};o.indexArray=new ea,o.vertexArray=new fl,o.colorArray=new Ss,BI(s,t,o.indexArray,o.vertexArray,o.colorArray);const u={defined:!0};u.emissiveFactor=vi.black;const f={};return f.baseColorFactor=vi.white,u.pbrMetallicRoughness=f,o.material=u,o.aabb=new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}const FI=ii([{name:"a_pos_3f",components:3,type:"Float32"}]),Ij=ii([{name:"a_normal_3",components:3,type:"Int16"}]),Pj=ii([{name:"a_centroid_3",components:3,type:"Int16"}]),NI=ii([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),Rj=ii([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),Dj=ii([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),Oj=ii([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),kj=ii([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),jI=Xt.types,nS=32767;function zj(s,t){const o=mr+t;for(const u of s)for(const f of u)if(f.x<-t||f.x>o||f.y<-t||f.y>o)return!1;return!0}class UI{constructor(){this.layoutVertexArray=new fl,this.layoutAttenuationArray=new Ss,this.layoutColorArray=new ha,this.indexArray=new ea,this.indexArrayForConflation=new ea,this.segmentsBucket=new No}}class iS{constructor(){this.layoutVertexArray=new fl,this.layoutNormalArray=new Du,this.layoutCentroidArray=new Du,this.layoutColorArray=new ha,this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.layoutAOArray=[],this.indexArray=new ea,this.indexArrayForConflation=new ea,this.segmentsBucket=new No,this.entranceBloom=new UI}}class VI{constructor(t){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.buildingWithoutFacade=new iS,this.buildingWithFacade=new iS,this.indexArrayForConflationUploaded=!1,this.footprintLookup={},this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.hasPattern=!1,this.worldview=t.worldview,this.lut=t.lut,this.buildingWithFacade.layoutFacadePaintArray=new ha,this.buildingWithFacade.layoutFacadeDataArray=new Pl,this.buildingWithFacade.layoutFacadeVerticalRangeArray=new ha,this.programConfigurations=new Ts(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.projection=t.projection,this.groundEffect=new Fy(t)}updateFootprints(t,o){for(const u of this.footprints)o.push({footprint:u,id:t})}prepare(){return(function(){if(g1!=null||A1!=null)return null;if(Nu!=null)return Nu;const t=fetch(ss.BUILDING_GEN_URL);return Nu=(function(o){let u,f,A,v;function C(){u=new Uint8Array(v.buffer),f=new Int32Array(v.buffer),A=new Float32Array(v.buffer)}function P(){throw new Error("Unexpected BuildingGen error.")}const k=()=>{},U={a:{a:P,f:function($){const q=u.length,K=Math.max($>>>0,Math.ceil(1.2*q)),J=Math.ceil((K-q)/65536);try{return v.grow(J),C(),!0}catch{return!1}},g:P,b:k,c:k,d:k,e:k}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(o,U):o.then(($=>$.arrayBuffer())).then(($=>WebAssembly.instantiate($,U)))).then(($=>{const q=$.instance.exports;return(0,q.g)(),v=q.f,C(),new Nr({setStyle:q.h,setAOOptions:q.i,setMetricOptions:q.j,setStructuralOptions:q.k,setFacadeOptions:q.l,setFauxFacadeOptions:q.m,setFacadeClassifierOptions:q.n,addFeature:q.o,addFacade:q.p,generateMesh:q.q,getLastError:q.r,getOuterRingLength:q.s,getMeshCount:q.t,getPositionsPtr:q.u,getPositionsLength:q.v,getNormalsPtr:q.w,getNormalsLength:q.x,getColorsPtr:q.y,getColorsLength:q.z,getAOPtr:q.A,getAOLength:q.B,getUVPtr:q.C,getUVLength:q.D,getFauxFacadePtr:q.E,getFauxFacadeLength:q.F,getIndicesPtr:q.G,getIndicesLength:q.H,getBuildingPart:q.I,getRingCount:q.J,getRingPtr:q.K,getRingLength:q.L,free:q.M,malloc:q.N,heapU8:u,heap32:f,heapF32:A})}))})(t).then((o=>(Nu=null,g1=o,g1))).catch((o=>{Fn("Could not load building-gen"),Nu=null,A1=o})),Nu})()}populate(t,o,u,f){const A=cj();if(!A)return;const v=_t(u);this.tileToMeter=v,this.brightness=o.brightness,A.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,v],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:v,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),A.setAOOptions(!1,.3),A.setMetricOptions(!1,16),A.setStructuralOptions(!0),A.setFacadeClassifierOptions(3);const C=new Map;for(const{feature:P}of t){if(jI[P.type]!=="LineString")continue;const k=this.layers[0]._featureFilter.needGeometry,U=Ht(P,k);if(!this.layers[0]._featureFilter.filter(new co(this.zoom),U,u))continue;const $=k?U.geometry:ar(P,u,f),q=[];for(const Ae of $)for(const _e of Ae)q.push({x:_e.x,y:_e.y});const K={coordinates:q,crossPerc:P.properties.cross_perc,distanceToRoad:P.properties.distance_to_road,entrances:P.properties.entrances,sourceId:0},J=P.properties.source_id;let de=C.get(J);de||(de=[],C.set(J,de)),de.push(K)}this.maxHeight=0;for(const{feature:P,index:k}of t){if(jI[P.type]==="LineString")continue;const U=this.layers[0]._featureFilter.needGeometry,$=Ht(P,U);if(!this.layers[0]._featureFilter.filter(new co(this.zoom),$,u))continue;const q=U?$.geometry:ar(P,u,f),K=Ql(q,500);if(!zj(q,163))continue;const J=this.layers[0],de=J.layout.get("building-base").evaluate(P,{},u),Ae=J.layout.get("building-height").evaluate(P,{},u),_e=J.layout.get("building-roof-shape").evaluate(P,{},u),Ie=J.paint.get("building-ambient-occlusion-intensity"),Pe=J.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(_e==="flat")continue;const ke=J.layout.get("building-facade").evaluate(P,{},u);A.setFacadeOptions(4,!0),A.setFauxFacadeOptions(ke,!1,1);const Ye=P.properties.source_id;let Qe;Qe=C.has(Ye)?C.get(Ye):[];let tt=0,it=0,ct=0,$t=0,mt=0,Wt=0;if(ke){let jr=Math.round(J.layout.get("building-facade-floors").evaluate(P,{},u));if(de===0){jr=Math.max(1,jr-(Qe.length>0?1:0));let gi=4;if(Ae>100){const Ne=[10,13,15];gi=Ne[P.id?P.id%Ne.length:0],A.setFacadeOptions(gi,!0)}mt=1.6803*gi/v}else mt=de/v;Wt=Ae/v,mt=Math.min(mt,Wt),ct=J.layout.get("building-facade-unit-width").evaluate(P,{},u)/v,$t=(Wt-mt)/jr,A.setFauxFacadeOptions(!0,!0,ct);const Ln=J.layout.get("building-facade-window").evaluate(P,{},u);tt=Ln[0],it=Ln[1]}const sr=[],Kt=new rr(1/0,1/0),er=new rr(-1/0,-1/0),hr=new rr(0,0);let Nt=0;for(const jr of K)if(jr.length>0){const Ln=[];for(const gi of jr){const Ne=[];for(let je=gi.length-1;je>=0;je--){const Ct=gi[je];Ne.push({x:Ct.x,y:Ct.y}),Kt.x=Math.min(Kt.x,Ct.x),Kt.y=Math.min(Kt.y,Ct.y),er.x=Math.max(er.x,Ct.x),er.y=Math.max(er.y,Ct.y),hr.x+=Ct.x,hr.y+=Ct.y,Nt++}Ln.push(Ne)}sr.push({id:P.id?P.id:0,height:Ae,minHeight:de,sourceId:0,roofType:_e,coordinates:Ln})}hr.x/=Nt||1,hr.y/=Nt||1;const tr=A.generateMesh(sr,Qe);if(typeof tr=="string"){Fn(`Unable to generate building ${P.id}: ${tr}`);continue}if(tr.meshes.length===0||tr.modifiedPolygonRings.length===0)continue;let Mt=0;for(const jr of tr.meshes)Mt+=jr.positions.length/3;const St=ke?this.buildingWithFacade:this.buildingWithoutFacade,pr=St.segmentsBucket.prepareSegment(Mt,St.layoutVertexArray,St.indexArray),cr=[];let nn=null,kr=0,Xr=-1;const _r=St.indexArray.length;let en=0;for(const jr of tr.meshes){const Ln=St.layoutVertexArray.length;if(jr.buildingPart==="entrance"){const Ut=new Array;for(let un=0;un<jr.indices.length;un+=12){const Kn=jr.positions[un+0],Jn=jr.positions[un+1],Zn=jr.positions[un+3],Xi=jr.positions[un+4],Vo=jr.positions[un+2],Hn=jr.positions[un+8]-Vo,Co=1,no=Zn-Kn,Li=Xi-Jn,zo=Math.hypot(no,Li);Ut.push({pos:[Kn+.5*no,Jn+.5*Li,Vo],normal:[Li/zo,-no/zo,0],width:zo,height:Hn,depth:Co,points:[Kn,Jn,Zn,Xi]})}const Sr=St.entranceBloom.segmentsBucket.prepareSegment(10*Ut.length,St.entranceBloom.layoutVertexArray,St.entranceBloom.indexArray),br=St.entranceBloom.layoutVertexArray.length;kr=St.entranceBloom.indexArray.length,BI(Ut,.5/this.tileToMeter,St.entranceBloom.indexArray,St.entranceBloom.layoutVertexArray,St.entranceBloom.layoutAttenuationArray);const Br=St.entranceBloom.layoutVertexArray.length-br;Xr=St.entranceBloom.indexArray.length-kr;for(let un=0;un<Br;un++)St.entranceBloom.layoutColorArray.emplaceBack(65535,65535);Sr.vertexLength+=Br,Sr.primitiveLength+=Xr,nn={part:jr.buildingPart,vertexOffset:br,vertexLength:Br}}for(let Ut=0;Ut<jr.positions.length;Ut+=3)en=Math.max(en,jr.positions[Ut+2]),St.layoutVertexArray.emplaceBack(jr.positions[Ut],jr.positions[Ut+1],jr.positions[Ut+2]);const gi=Math.floor(hr.x),Ne=Math.floor(hr.y),je=Math.floor(en);for(let Ut=0;Ut<jr.positions.length;Ut+=3)St.layoutCentroidArray.emplaceBack(gi,Ne,je);for(let Ut=0;Ut<jr.normals.length;Ut+=3)St.layoutNormalArray.emplaceBack(jr.normals[Ut+0]*nS,jr.normals[Ut+1]*nS,jr.normals[Ut+2]*nS);for(let Ut=0;Ut<jr.ao.length;Ut++)St.layoutAOArray.push(jr.ao[Ut]);for(let Ut=0;Ut<jr.colors.length;Ut+=3){const Sr=1+(jr.ao[Ut/3]-1)*Ie;St.layoutColorArray.emplaceBack(jr.colors[Ut]*Sr<<8|jr.colors[Ut+1]*Sr,jr.colors[Ut+2]*Sr<<8)}if(ke){for(let Ut=0;Ut<jr.positions.length;Ut+=3)St.layoutFacadePaintArray.emplaceBack(65535,255);for(let Ut=0;Ut<jr.isFauxFacade.length;Ut++)if(jr.isFauxFacade[Ut]){const Sr=1|Math.min(65535,Math.floor(jr.uv[2*Ut]*tr.outerRingLength)),br=Math.floor(255*tt)<<8|Math.floor(255*it),Br=Math.floor(65535*Math.min(1,ct/mr)),un=Math.floor(65535*Math.min(1,$t/mr));St.layoutFacadeDataArray.emplaceBack(Sr,br,Br,un);const Kn=Math.floor(65535*Math.min(1,mt/mr)),Jn=Math.floor(65535*Math.min(1,Wt/mr));St.layoutFacadeVerticalRangeArray.emplaceBack(Kn,Jn)}else St.layoutFacadeDataArray.emplaceBack(0,0,0,0),St.layoutFacadeVerticalRangeArray.emplaceBack(0,0)}const Ct=pr.vertexLength;for(let Ut=0;Ut<jr.indices.length;Ut+=3)St.indexArray.emplaceBack(Ct+jr.indices[Ut],Ct+jr.indices[Ut+1],Ct+jr.indices[Ut+2]);pr.vertexLength+=jr.positions.length/3,pr.primitiveLength+=jr.indices.length/3,(jr.buildingPart==="roof"||jr.buildingPart==="wall"||jr.buildingPart==="facade_glazing"||jr.buildingPart==="entrance")&&cr.push({part:jr.buildingPart,vertexOffset:Ln,vertexLength:jr.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,en),this.buildingFeatures.push({feature:$,hasFauxFacade:ke,segment:pr,parts:cr,buildingBloom:nn});const Cn=St.indexArray.length-_r,Er=[],Qr=[],vn=new rr(1/0,1/0),kn=new rr(-1/0,-1/0),Qn=this.groundEffect.vertexArray.length;for(const jr of tr.modifiedPolygonRings){const Ln=[],gi=new rr(1/0,1/0),Ne=new rr(-1/0,-1/0);for(let je=0;je<jr.length;je+=2){const Ct=jr.length-je-2;gi.x=Math.min(gi.x,jr[Ct]),gi.y=Math.min(gi.y,jr[Ct+1]),Ne.x=Math.max(Ne.x,jr[Ct]),Ne.y=Math.max(Ne.y,jr[Ct+1]);const Ut=new rr(jr[Ct],jr[Ct+1]);Ln.push(Ut),Er.push(Ut.x,Ut.y),Qr.push(Ut.clone())}vn.x=Math.min(vn.x,gi.x),vn.y=Math.min(vn.y,gi.y),kn.x=Math.max(kn.x,Ne.x),kn.y=Math.max(kn.y,Ne.y),this.groundEffect.addData(Ln,[gi,Ne],Pe)}const Vn=this.groundEffect.vertexArray.length-Qn;(Kt.x<0||er.x>mr||Kt.y<0||er.y>mr)&&this.featuresOnBorder.push({featureId:P.id,footprintIndex:this.footprints.length});{const jr=LA(Er,null,2),Ln=new Mm(Qr,jr,8,256);let gi=P.id;P.properties&&P.properties.hasOwnProperty("building_id")&&(gi=P.properties.building_id),this.footprints.push({vertices:Qr,indices:jr,grid:Ln,min:vn,max:kn,buildingId:gi,hiddenFlags:0,indicesOffset:_r,indicesLength:Cn,bloomIndicesOffset:kr,bloomIndicesLength:Xr,groundEffectVertexOffset:Qn,groundEffectVertexLength:Vn,hasFauxFacade:ke,segment:pr,height:en})}this.programConfigurations.populatePaintArrays(St.layoutVertexArray.length,P,k,{},o.availableImages,u,o.brightness),this.groundEffect.addPaintPropertiesData(P,k,{},o.availableImages,u,o.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0],{})}update(t,o,u,f,A,v,C){this.programConfigurations.updatePaintArrays(t,o,A,u,f,v,C),this.groundEffect.update(t,o,A,u,f,v,C),this.evaluate(this.layers[0],t),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){const o=u=>{u.layoutVertexBuffer=t.createVertexBuffer(u.layoutVertexArray,FI.members),u.layoutNormalBuffer=t.createVertexBuffer(u.layoutNormalArray,Ij.members),u.layoutCentroidBuffer=t.createVertexBuffer(u.layoutCentroidArray,Pj.members),u.layoutFacadeDataArray&&u.layoutFacadeDataArray.length&&(u.layoutFacadeDataBuffer=t.createVertexBuffer(u.layoutFacadeDataArray,Dj.members)),u.layoutFacadeVerticalRangeArray&&u.layoutFacadeVerticalRangeArray.length&&(u.layoutFacadeVerticalRangeBuffer=t.createVertexBuffer(u.layoutFacadeVerticalRangeArray,Oj.members)),u.entranceBloom.layoutVertexArray.length&&(u.entranceBloom.layoutVertexBuffer=t.createVertexBuffer(u.entranceBloom.layoutVertexArray,FI.members),u.entranceBloom.layoutAttenuationBuffer=t.createVertexBuffer(u.entranceBloom.layoutAttenuationArray,kj.members)),this.uploadUpdatedColorBuffer(t),this.uploadUpdatedIndexBuffer(t)};this.uploaded||(o(this.buildingWithoutFacade),o(this.buildingWithFacade),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){const t=o=>{o.layoutVertexBuffer&&(o.layoutVertexBuffer.destroy(),o.layoutNormalBuffer.destroy(),o.layoutColorBuffer.destroy(),o.segmentsBucket.destroy(),o.indexBuffer&&o.indexBuffer.destroy(),o.entranceBloom.layoutVertexBuffer&&(o.entranceBloom.layoutVertexBuffer.destroy(),o.entranceBloom.layoutColorBuffer.destroy(),o.entranceBloom.layoutAttenuationBuffer.destroy(),o.entranceBloom.indexBuffer.destroy(),o.entranceBloom.segmentsBucket.destroy()))};t(this.buildingWithoutFacade),t(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(t,o,u=!0){let f=!1;const A=u?o:0,v=0|(u?-1:~o);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const C of t){const P=this.footprints[C],k=P.hiddenFlags&v|A;P.hiddenFlags!==k&&(P.hiddenFlags=k,f=!0,this.groundEffect.updateHiddenByLandmarkRange(P.groundEffectVertexOffset,P.groundEffectVertexLength,P.hiddenFlags!==0))}return f&&(this.indexArrayForConflationUploaded=!1),f}uploadUpdatedIndexBuffer(t){if(this.groundEffect.uploadHiddenByLandmark(t),this.indexArrayForConflationUploaded)return;const o=f=>{f.indexArray.length!==0&&(f.indexArrayForConflation.resize(f.indexArray.length),f.indexArrayForConflation.uint16.set(f.indexArray.uint16),f.entranceBloom.indexArrayForConflation.resize(f.entranceBloom.indexArray.length),f.entranceBloom.indexArrayForConflation.uint16.set(f.entranceBloom.indexArray.uint16))};o(this.buildingWithoutFacade),o(this.buildingWithFacade);for(const f of this.footprints){const A=f.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,v=f.indicesOffset+f.indicesLength;if(f.hiddenFlags!==0){for(let P=f.indicesOffset;P<v;P++)A.indexArrayForConflation.uint16[3*P+0]=0,A.indexArrayForConflation.uint16[3*P+1]=0,A.indexArrayForConflation.uint16[3*P+2]=0;const C=f.bloomIndicesOffset+f.bloomIndicesLength;for(let P=f.bloomIndicesOffset;P<C;P++)A.entranceBloom.indexArrayForConflation.uint16[3*P+0]=0,A.entranceBloom.indexArrayForConflation.uint16[3*P+1]=0,A.entranceBloom.indexArrayForConflation.uint16[3*P+2]=0}}const u=f=>{f.indexArray.length!==0&&(f.indexBuffer?f.indexBuffer.updateData(f.indexArrayForConflation):f.indexBuffer=t.createIndexBuffer(f.indexArrayForConflation,!0),f.entranceBloom.indexBuffer?f.entranceBloom.indexBuffer.updateData(f.entranceBloom.indexArrayForConflation):f.entranceBloom.indexBuffer=t.createIndexBuffer(f.entranceBloom.indexArrayForConflation,!0))};u(this.buildingWithoutFacade),u(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(t){const o=u=>{u.layoutColorBuffer?u.layoutColorBuffer.updateData(u.layoutColorArray):u.layoutColorBuffer=t.createVertexBuffer(u.layoutColorArray,NI.members,!0),u.layoutFacadePaintArray&&(u.layoutFacadePaintBuffer?u.layoutFacadePaintBuffer.updateData(u.layoutFacadePaintArray):u.layoutFacadePaintBuffer=t.createVertexBuffer(u.layoutFacadePaintArray,Rj.members,!0)),u.entranceBloom.layoutColorBuffer?u.entranceBloom.layoutColorBuffer.updateData(u.entranceBloom.layoutColorArray):u.entranceBloom.layoutColorBuffer=t.createVertexBuffer(u.entranceBloom.layoutColorArray,NI.members,!0)};o(this.buildingWithoutFacade),o(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(t,o){const u=t.paint.get("building-ambient-occlusion-intensity");for(const f of this.buildingFeatures){const A=o[f.feature.id],v=f.feature;v.properties["building-part"]="roof";const C=t.paint.get("building-color").evaluate(v,A,this.canonical).toPremultipliedRenderColor(this.lut),P=t.paint.get("building-emissive-strength").evaluate(v,A,this.canonical);v.properties["building-part"]="wall";const k=t.paint.get("building-color").evaluate(v,A,this.canonical).toPremultipliedRenderColor(this.lut),U=t.paint.get("building-emissive-strength").evaluate(v,A,this.canonical);v.properties["building-part"]="window";const $=t.paint.get("building-color").evaluate(v,A,this.canonical).toPremultipliedRenderColor(this.lut),q=t.paint.get("building-emissive-strength").evaluate(v,A,this.canonical);v.properties["building-part"]="door";const K=t.paint.get("building-color").evaluate(v,A,this.canonical).toPremultipliedRenderColor(this.lut),J=t.paint.get("building-emissive-strength").evaluate(v,A,this.canonical),de=f.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const _e of f.parts){let Ie,Pe=C;_e.part==="roof"?(Pe=C,Ie=P):_e.part==="wall"?(Pe=k,Ie=U):_e.part==="facade_glazing"?(Pe=$,Ie=q):_e.part==="entrance"&&(Pe=K,Ie=J),Ie=ce(Ie,0,1);for(let ke=0;ke<_e.vertexLength;ke++){const Ye=_e.vertexOffset+ke,Qe=1+(de.layoutAOArray[Ye]-1)*u;de.layoutColorArray.emplace(Ye,Pe.r*Qe*255<<8|Pe.g*Qe*255,Pe.b*Qe*255<<8|255*Ie),f.hasFauxFacade&&de.layoutFacadePaintArray.emplace(Ye,255*$.r<<8|255*$.g,255*$.b<<8|255*q)}}const Ae=f.buildingBloom;if(Ae)for(let _e=0;_e<Ae.vertexLength;_e++)de.entranceBloom.layoutColorArray.emplace(Ae.vertexOffset+_e,255*K.r<<8|255*K.g,255*K.b<<8|51*J)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(t,o,u){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const f=o.getReplacementRegionsForTile(t.toUnwrapped());if(Rp(this.activeReplacements,f))return;this.activeReplacements=f;for(const v of this.footprints)v.hiddenFlags&=-2;const A=[];for(const v of this.activeReplacements){if(v.order<=s1)continue;const C=Math.max(1,Math.pow(2,v.footprintTileId.canonical.z-t.canonical.z));for(const P of this.footprints)P.min.x>v.max.x||P.max.x<v.min.x||P.min.y>v.max.y||P.max.y<v.min.y||(A.length=0,Lj(P.vertices,0,P.vertices.length,v.footprintTileId.canonical,t.canonical,A),o_(v.footprint,A,P.indices,0,P.indices.length,0,-C)&&(P.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const v of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(v.groundEffectVertexOffset,v.groundEffectVertexLength,v.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(t,o){let u=Number.NEGATIVE_INFINITY,f=!0;const A=4*(t+mr)*mr+(o+mr);if(this.footprintLookup.hasOwnProperty(A)){const C=this.footprintLookup[A];return C?{height:C.height,hidden:C.hiddenFlags!==0}:void 0}const v=new rr(t,o);for(const C of this.footprints)t>C.max.x||C.min.x>t||o>C.max.y||C.min.y>o||C.height<=u||B0(v,C)&&(u=C.height,this.footprintLookup[A]=C,f=C.hiddenFlags!==0);if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:f};this.footprintLookup[A]=void 0}}function Lj(s,t,o,u,f,A){const v=Math.pow(2,u.z-f.z);for(let C=0;C<o;C++){let P=s[C+t].x,k=s[C+t].y;P=(P+f.x*mr)*v-u.x*mr,k=(k+f.y*mr)*v-u.y*mr,A.push(new rr(P,k))}}let $I,GI;Rr(VI,"BuildingBucket",{omit:["layers"]}),Rr(iS,"BuildingGeometry"),Rr(UI,"BuildingBloomGeometry");const Bj=ii([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Fj=ii([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:Nj}=Bj,jj=ii([{name:"a_packed",components:3,type:"Float32"}]),{members:Uj}=jj,Vj=ii([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:$j}=Vj;class HI{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.image=new Ip({width:t,height:o}),this.positions={},this.uploaded=!1}getDash(t,o){const u=this.getKey(t,o);return this.positions[u]}trim(){const t=this.width,o=this.height=Fr(this.nextRow);this.image.resize({width:t,height:o})}getKey(t,o){return t.join(",")+o}getDashRanges(t,o,u){const f=[];let A=t.length%2==1?-t[t.length-1]*u:0,v=t[0]*u,C=!0;f.push({left:A,right:v,isDash:C,zeroLength:t[0]===0});let P=t[0];for(let k=1;k<t.length;k++){C=!C;const U=t[k];A=P*u,P+=U,v=P*u,f.push({left:A,right:v,isDash:C,zeroLength:U===0})}return f}addRoundDash(t,o,u){const f=o/2;for(let A=-u;A<=u;A++){const v=this.width*(this.nextRow+u+A);let C=0,P=t[C];for(let k=0;k<this.width;k++){k/P.right>1&&(P=t[++C]);const U=Math.abs(k-P.left),$=Math.abs(k-P.right),q=Math.min(U,$);let K;const J=A/u*(f+1);if(P.isDash){const de=f-Math.abs(J);K=Math.sqrt(q*q+de*de)}else K=f-Math.sqrt(q*q+J*J);this.image.data[v+k]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(t,o){for(let P=t.length-1;P>=0;--P){const k=t[P],U=t[P+1];k.zeroLength?t.splice(P,1):U&&U.isDash===k.isDash&&(U.left=k.left,t.splice(P,1))}const u=t[0],f=t[t.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const A=this.width*this.nextRow;let v=0,C=t[v];for(let P=0;P<this.width;P++){P/C.right>1&&(C=t[++v]);const k=Math.abs(P-C.left),U=Math.abs(P-C.right),$=Math.min(k,U);this.image.data[A+P]=Math.max(0,Math.min(255,(C.isDash?$:-$)+o+128))}}addDash(t,o){const u=this.getKey(t,o);if(this.positions[u])return this.positions[u];const f=o==="round",A=f?7:0,v=2*A+1;if(this.nextRow+v>this.height)return Fn("LineAtlas out of space"),null;t.length===0&&t.push(1);let C=0;for(let U=0;U<t.length;U++)t[U]<0&&(Fn("Negative value is found in line dasharray, replacing values with 0"),t[U]=0),C+=t[U];if(C!==0){const U=this.width/C,$=this.getDashRanges(t,this.width,U);f?this.addRoundDash($,U,A):this.addRegularDash($,o==="square"?.5*U:0)}const P=this.nextRow+A;this.nextRow+=v;const k={tl:[P,A],br:[C,0]};return this.positions[u]=k,k}}Rr(HI,"LineAtlas");const Gj=Xt.types,Hj=Math.cos(Math.PI/180*37.5),qj=Math.cos(Math.PI/180*5);class oS{constructor(t){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=t.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=t.overscaling,this.pixelRatio=t.pixelRatio,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((o=>{this.gradients[o.id]={}})),this.layoutVertexArray=new lf,this.layoutVertexArray2=new fl,this.patternVertexArray=new fl,this.indexArray=new ea,this.programConfigurations=new Ts(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new No,this.maxLineLength=0,this.zOffsetVertexArray=new fl,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.tessellationStep=t.tessellationStep?t.tessellationStep:mr/64,this.worldview=t.worldview}updateFootprints(t,o){}populate(t,o,u,f){this.hasPattern=mf("line",this.layers,this.pixelRatio,o);const A=this.layers[0].layout.get("line-sort-key");this.tileToMeter=_t(u);const v=this.layers[0].layout.get("line-elevation-reference");if(v==="hd-road-markup")this.elevationType="road";else{const q=this.layers[0].layout.get("line-z-offset"),K=q.isConstant()&&!q.constantOr(0);this.elevationType=v!=="sea"&&v!=="ground"&&K?"none":"offset",this.elevationType==="offset"&&v==="none"&&Fn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const C=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&C!==void 0;const P=[];for(const{feature:q,id:K,index:J,sourceLayerIndex:de}of t){const Ae=this.layers[0]._featureFilter.needGeometry,_e=Ht(q,Ae);if(!this.layers[0]._featureFilter.filter(new co(this.zoom,{worldview:this.worldview}),_e,u))continue;const Ie=A?A.evaluate(_e,{},u):void 0,Pe={id:K,properties:q.properties,type:q.type,sourceLayerIndex:de,index:J,geometry:Ae?_e.geometry:ar(q,u,f),patterns:{},sortKey:Ie};P.push(Pe)}A&&P.sort(((q,K)=>q.sortKey-K.sortKey));const{lineAtlas:k,featureIndex:U}=o,$=this.addConstantDashes(k);for(const q of P){const{geometry:K,index:J,sourceLayerIndex:de}=q;if($&&this.addFeatureDashes(q,k),this.hasPattern){const Ae=Py("line",this.layers,q,this.zoom,this.pixelRatio,o);this.patternFeatures.push(Ae)}else this.addFeature(q,K,J,u,k.positions,o.availableImages,o.brightness,o.elevationFeatures);U.insert(t[J].feature,K,J,de,this.index)}}addConstantDashes(t){let o=!1;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,A=u.layout.get("line-cap").value;if(f.kind!=="constant"||A.kind!=="constant")o=!0;else{const v=A.value,C=f.value;if(!C)continue;t.addDash(C,v)}}return o}addFeatureDashes(t,o){const u=this.zoom;for(const f of this.layers){const A=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if(A.kind==="constant"&&v.kind==="constant")continue;let C,P;if(A.kind==="constant"){if(C=A.value,!C)continue}else C=A.evaluate({zoom:u},t);P=v.kind==="constant"?v.value:v.evaluate({zoom:u},t),o.addDash(C,P),t.patterns[f.id]=[o.getKey(C,P)]}}update(t,o,u,f,A,v,C,P){this.programConfigurations.updatePaintArrays(t,o,A,u,f,v,C,P)}addFeatures(t,o,u,f,A,v){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,o,u,f,v)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Uj)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,$j)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,Fj.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Nj),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t,o){let u,f;if(o&&o>0?(u=`mapbox_clip_start_${o}`,f=`mapbox_clip_end_${o}`):(u="mapbox_clip_start",f="mapbox_clip_end"),t.properties&&t.properties.hasOwnProperty(u)&&t.properties.hasOwnProperty(f))return{start:+t.properties[u],end:+t.properties[f]}}addFeature(t,o,u,f,A,v,C,P){const k=this.layers[0].layout,U=k.get("line-join").evaluate(t,{}),$=k.get("line-cap").evaluate(t,{}),q=k.get("line-miter-limit"),K=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(t),this.lineFeature=t;const J=!(!t.properties||!t.properties.hasOwnProperty("mapbox_line_metrics"))&&t.properties.mapbox_line_metrics;this.zOffsetValue=k.get("line-z-offset").value;const de=this.layers[0].paint.get("line-width").value;if(de.kind!=="constant"&&de.isLineProgressConstant===!1&&(this.variableWidthValue=de),this.elevationType==="road"){const Ae=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(t,o,f,P,U,$,q,K)){const[_e,Ie]=this.clipRuntimeLinesToTile(o,1);for(let Pe=0;Pe<_e.length;Pe++){const ke=_e[Pe],Ye=Ie[Pe],Qe={progress:{min:Ye.progress.min,max:Ye.progress.max},nextDir:this.computeSegNextDir(Ye,ke),prevDir:this.computeSegPrevDir(Ye,ke)};this.addLine(ke,t,f,U,$,q,K,Qe,J&&Ye.parentIndex>0?Ye.parentIndex:null)}this.fillNonElevatedRoadSegment(Ae)}}else for(let Ae=0;Ae<o.length;Ae++)this.addLine(o[Ae],t,f,U,$,q,K,void 0,J&&Ae>0?Ae:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,A,v,f,C,void 0,this.worldview)}computeSegNextDir(t,o){return t.nextPoint.sub(o.at(-2)).unit()}computeSegPrevDir(t,o){return o[1].sub(t.prevPoint).unit()}clipLinesToTile(t,o){return X(t,-o,-o,mr+o,mr+o)}clipRuntimeLinesToTile(t,o){const u=[];return[X(t,-o,-o,mr+o,mr+o,u),u]}addElevatedRoadFeature(t,o,u,f,A,v,C,P){const k=[],U=ho.getElevationFeature(t,f);if(U){const $=this.clipLinesToTile(o,1),q=this.prepareElevatedLines($,U,u);for(const K of q)k.push({geometry:K,elevation:U,elevationTileID:u,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(k.length===0)return!1;for(const $ of k){const q=this.layoutVertexArray.length;this.addLine($.geometry,t,u,A,v,C,P);const K=new sa(u,$.elevationTileID);if($.elevation)for(let J=q;J<this.layoutVertexArray.length;J++){const de=new rr(this.layoutVertexArray.int16[6*J]>>1,this.layoutVertexArray.int16[6*J+1]>>1),Ae=K.pointElevation(de,$.elevation,.05);this.updateHeightRange(Ae),this.zOffsetVertexArray.emplaceBack(Ae,0,0)}else this.fillNonElevatedRoadSegment(q)}return!0}prepareElevatedLines(t,o,u){if(o.constantHeight!=null)return t;const f=[],A=1/_t(u);for(const v of t)ie(v,new zi(o,A),0,f);return f}fillNonElevatedRoadSegment(t){for(let o=t;o<this.layoutVertexArray.length;o++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(t){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,t),this.heightRange.max=Math.max(this.heightRange.max,t)):this.heightRange={min:t,max:t}}addLine(t,o,u,f,A,v,C,P,k){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=k?this.lineFeatureClips(o,k):this.lineClips;const U=f==="none";this.patternJoinNone=this.hasPattern&&U,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const $=P&&P.progress.min>0,q=P&&P.progress.max<1;if(this.lineClips){let ct={min:this.lineClips.start,max:this.lineClips.end},$t=1;if(P){const sr=this.lineClips.end-this.lineClips.start;ct=(function(Kt,er,hr){return{min:tu(Kt.min,er,hr),max:tu(Kt.max,er,hr)}})(P.progress,{min:0,max:1},ct),sr>0&&($t=(ct.max-ct.min)/sr)}const mt=+o.properties.mapbox_clip_feature_len,Wt=+o.properties.mapbox_clip_seg_len;if(Number.isNaN(mt)||Number.isNaN(Wt)){for(let Kt=0;Kt<t.length-1;Kt++)this.totalDistance+=t[Kt].dist(t[Kt+1]);const sr=this.totalDistance/(ct.max-ct.min);this.totalFeatureLength=Number.isFinite(sr)?sr:0,this.lineClips.start=ct.min,this.lineClips.end=ct.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=mt,this.distance=Wt*$t,this.lineClips.start=ct.min,this.lineClips.end=ct.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const K=Gj[o.type]==="Polygon";let J=t.length;for(;J>=2&&t[J-1].equals(t[J-2]);)J--;let de=0;for(;de<J-1&&t[de].equals(t[de+1]);)de++;if(J<(K?3:2))return;f==="bevel"&&(v=1.05);const Ae=this.segments.prepareSegment(10*J,this.layoutVertexArray,this.indexArray);let _e,Ie,Pe,ke,Ye,Qe,tt,it;P&&P.prevDir&&(Qe=P.prevDir.perp()),P&&P.nextDir&&(tt=P.nextDir.perp()),this.e1=this.e2=-1,K&&(_e=t[J-2],Ye=t[de].sub(_e)._unit()._perp());for(let ct=de;ct<J;ct++){if(Pe=ct===J-1?K?t[de+1]:void 0:t[ct+1],Pe&&t[ct].equals(Pe))continue;Ye&&(ke=Ye),_e&&(Ie=_e),_e=t[ct],it=this.evaluateLineProgressFeatures(Ie?Ie.dist(_e):0),Ye=Pe?Pe.sub(_e)._unit()._perp():ke,ke=ke||Ye;const $t=Ie&&Pe;let mt=$t?f:K||U?"butt":A;const Wt=ke.x*Ye.x+ke.y*Ye.y;if(U){const St=function(pr){if(pr.patternJoinNone){const cr=pr.segmentPoints.length/2,nn=pr.lineSoFar-pr.segmentStart;for(let kr=0;kr<cr;++kr){const Xr=pr.segmentPoints[2*kr+1],_r=Math.round(pr.segmentPoints[2*kr])+.5+.25*Xr;pr.patternVertexArray.emplaceBack(_r,nn,pr.segmentStart),pr.patternVertexArray.emplaceBack(_r,nn,pr.segmentStart)}pr.segmentPoints.length=0}pr.e1=pr.e2=-1};if($t&&Wt<qj){this.updateDistance(Ie,_e),this.addCurrentVertex(_e,ke,1,1,Ae,it),St(this),this.addCurrentVertex(_e,Ye,-1,-1,Ae,it);continue}if(Ie){if(!Pe){this.updateDistance(Ie,_e),this.addCurrentVertex(_e,ke,1,1,Ae,it),St(this);continue}mt="miter"}}let sr=ke.add(Ye);sr.x===0&&sr.y===0||sr._unit();const Kt=sr.x*Ye.x+sr.y*Ye.y,er=Kt!==0?1/Kt:1/0,hr=2*Math.sqrt(2-2*Kt),Nt=Kt<Hj&&Ie&&Pe,tr=ke.x*Ye.y-ke.y*Ye.x>0,Mt=this.overscaling<=16?15*mr/(512*this.overscaling):0;if($t&&mt==="round"){if(er<C)mt="miter";else if(er<=2){const St=aS(_e,-10,mr+10);mt=this.elevationType==="offset"&&(St||this.hasCrossSlope)?"miter":"fakeround"}}if(mt==="miter"&&er>v&&(mt="bevel"),mt==="bevel"&&(er>2&&(mt="flipbevel"),er<v&&(mt="miter")),Ie&&!(mt==="miter"&&Nt)&&this.updateDistance(Ie,_e),mt==="miter")if(Nt){const St=_e.dist(Ie);if(St>2*Mt){const cr=_e.sub(_e.sub(Ie)._mult(Mt/St)._round());this.updateDistance(Ie,cr),this.addCurrentVertex(cr,ke,0,0,Ae,it),Ie=cr}this.updateDistance(Ie,_e),sr._mult(er),this.addCurrentVertex(_e,sr,0,0,Ae,it);const pr=_e.dist(Pe);if(pr>2*Mt){const cr=_e.add(Pe.sub(_e)._mult(Mt/pr)._round());this.updateDistance(_e,cr),this.addCurrentVertex(cr,Ye,0,0,Ae,it),_e=cr}}else sr._mult(er),this.addCurrentVertex(_e,sr,0,0,Ae,it);else if(mt==="flipbevel"){if(er>100)sr=Ye.mult(-1);else{const St=er*ke.add(Ye).mag()/ke.sub(Ye).mag();sr._perp()._mult(St*(tr?-1:1))}this.addCurrentVertex(_e,sr,0,0,Ae,it),this.addCurrentVertex(_e,sr.mult(-1),0,0,Ae,it)}else if(mt==="bevel"||mt==="fakeround"){it!=null&&Ie&&this.addCurrentVertex(_e,tt||ke,-1,-1,Ae,it);const St=_e.dist(Ie)<=2*Mt&&mt!=="bevel",pr=sr.mult(tr?1:-1);pr._mult(er);const cr=Ye.mult(tr?-1:1),nn=ke.mult(tr?-1:1),kr=this.evaluateLineProgressFeatures(this.distance);if(it==null&&(this.addHalfVertex(_e,pr.x,pr.y,!1,!tr,0,Ae,kr),St||this.addHalfVertex(_e,pr.x+2*nn.x,pr.y+2*nn.y,!1,tr,0,Ae,kr)),mt==="fakeround"){const Xr=Math.round(180*hr/Math.PI/20);this.addHalfVertex(_e,nn.x,nn.y,!1,tr,0,Ae,kr);for(let _r=0;_r<Xr;_r++){let en=_r/Xr;if(en!==.5){const Er=en-.5;en+=en*Er*(en-1)*((1.0904+Wt*(Wt*(3.55645-1.43519*Wt)-3.2452))*Er*Er+(.848013+Wt*(.215638*Wt-1.06021)))}const Cn=cr.sub(nn)._mult(en)._add(nn)._unit();this.addHalfVertex(_e,Cn.x,Cn.y,!1,tr,0,Ae,kr)}this.addHalfVertex(_e,cr.x,cr.y,!1,tr,0,Ae,kr)}St||it!=null||this.addHalfVertex(_e,pr.x+2*cr.x,pr.y+2*cr.y,!1,tr,0,Ae,kr),it!=null&&Pe&&this.addCurrentVertex(_e,Qe||Ye,1,1,Ae,it)}else if(mt==="butt")this.addCurrentVertex(_e,sr,0,0,Ae,it);else if(mt==="square"){if(!Ie){const St=$?0:-1;this.addCurrentVertex(_e,sr,St,St,Ae,it)}if(this.addCurrentVertex(_e,sr,0,0,Ae,it),Ie){const St=q?0:1;this.addCurrentVertex(_e,sr,St,St,Ae,it)}}else if(mt==="round"){if(Ie){const St=!$t&&tt?tt:ke;this.addCurrentVertex(_e,St,0,0,Ae,it),!$t&&q||this.addCurrentVertex(_e,St,1,1,Ae,it,!0)}if(Pe){const St=!$t&&Qe?Qe:Ye;!$t&&$||this.addCurrentVertex(_e,St,-1,-1,Ae,it,!0),this.addCurrentVertex(_e,St,0,0,Ae,it)}}}}addVerticesTo(t,o,u,f,A,v,C,P,k,U){const $=(o.w-t.w)/this.tessellationStep|0;let q=0;const K=this.scaledDistance;if($>1){this.lineSoFar=t.w;const de=(o.x-t.x)/$,Ae=(o.y-t.y)/$,_e=(o.z-t.z)/$,Ie=(o.w-t.w)/$;for(let Pe=1;Pe<$;++Pe){t.x+=de,t.y+=Ae,t.z+=_e,this.lineSoFar+=Ie,q+=Ie;const ke=this.evaluateLineProgressFeatures(this.prevDistance+q);this.scaledDistance=(this.prevDistance+q)/this.totalDistance,this.addHalfVertex(t,u,f,U,!1,C,k,ke),this.addHalfVertex(t,A,v,U,!0,-P,k,ke)}}this.lineSoFar=o.w,this.scaledDistance=K;const J=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,u,f,U,!1,C,k,J),this.addHalfVertex(o,A,v,U,!0,-P,k,J)}evaluateLineProgressFeatures(t){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+t)/this.totalFeatureLength):Fn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:o}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}}addCurrentVertex(t,o,u,f,A,v,C=!1){const P=o.x+o.y*u,k=o.y-o.x*u,U=o.y*f-o.x,$=-o.y-o.x*f;if(v!=null){const q=this.elevationType==="offset",K=-10,J=mr+10,de=v.zOffset,Ae=new _(t.x,t.y,de,this.lineSoFar),_e=!!q&&aS(t,K,J),Ie=this.lineSoFar,Pe=this.distance;if(this.currentVertex)if(_e){const ke=this.currentVertexIsOutside,Ye=this.currentVertex,Qe=new _(t.x,t.y,de,this.lineSoFar);if(L(Ye,Qe,K,J),!aS(Qe,K,J)){if(ke){this.e1=this.e2=-1,this.distance-=Ye.dist(Ae),this.lineSoFar=Ye.w;const tt=this.evaluateLineProgressFeatures(Ye.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Ye,P,k,C,!1,u,A,tt),this.addHalfVertex(Ye,U,$,C,!0,-f,A,tt),this.prevDistance=this.distance}this.distance=this.prevDistance+Ye.dist(Qe),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Ye,Qe,P,k,U,$,u,f,A,C),this.distance=Pe,this.scaledDistance=this.distance/this.totalDistance}}else{const ke=this.currentVertex;if(this.currentVertexIsOutside){L(ke,Ae,K,J),this.e1=this.e2=-1,this.distance-=ke.dist(Ae),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=ke.w;const Ye=this.evaluateLineProgressFeatures(ke.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ke,P,k,C,!1,u,A,Ye),this.addHalfVertex(ke,U,$,C,!0,-f,A,Ye),this.prevDistance=this.distance,this.distance=Pe,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(ke,Ae,P,k,U,$,u,f,A,C)}else _e||(this.addHalfVertex(t,P,k,C,!1,u,A,v),this.addHalfVertex(t,U,$,C,!0,-f,A,v));this.currentVertex=Ae,this.currentVertexIsOutside=_e,this.lineSoFar=Ie}else this.addHalfVertex(t,P,k,C,!1,u,A,v),this.addHalfVertex(t,U,$,C,!0,-f,A,v)}addHalfVertex({x:t,y:o},u,f,A,v,C,P,k){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),v||this.segmentPoints.push(this.lineSoFar-this.segmentStart,C)),this.layoutVertexArray.emplaceBack((t<<1)+(A?1:0),(o<<1)+(v?1:0),Math.round(63*u)+128,Math.round(63*f)+128,1+(C===0?0:C<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const $=hn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,$)}const U=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,U),P.primitiveLength++),v?this.e2=U:this.e1=U,k!=null&&this.zOffsetVertexArray.emplaceBack(k.zOffset,k.variableWidth,k.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(t,o){this.prevDistance=this.distance,this.distance+=t.dist(o),this.updateScaledDistance()}}function aS(s,t,o){return s.x<t||s.x>o||s.y<t||s.y>o}let qI,WI;function ZI(s,t,o){return t*(mr/(s.tileSize*Math.pow(2,o-s.tileID.overscaledZ)))}Rr(oS,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const XI=(s,t,o)=>(1-o)*s+o*t;function YI(s,t){return 1/ZI(s,1,t.tileZoom)}function QI(s,t,o,u){return s.translatePosMatrix(u||t.tileID.projMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const KI=s=>{const t=[];JI(s)&&t.push("RENDER_LINE_DASH"),s.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const o=s.paint.get("line-trim-offset");o[0]===0&&o[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),s.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER");const u=s.layout.get("line-join").constantOr("miter")==="none",f=!!s.paint.get("line-pattern").constantOr(1);return u&&f&&t.push("LINE_JOIN_NONE"),t};function JI(s){const t=s.paint.get("line-dasharray").value;return t.kind!=="constant"||t.value}let sS;const eP=()=>sS||(sS={layout:qI||(qI=new Go({"line-cap":new xr(pt.layout_line["line-cap"]),"line-join":new xr(pt.layout_line["line-join"]),"line-miter-limit":new lr(pt.layout_line["line-miter-limit"]),"line-round-limit":new lr(pt.layout_line["line-round-limit"]),"line-sort-key":new xr(pt.layout_line["line-sort-key"]),"line-z-offset":new xr(pt.layout_line["line-z-offset"]),"line-elevation-reference":new lr(pt.layout_line["line-elevation-reference"]),"line-cross-slope":new lr(pt.layout_line["line-cross-slope"]),visibility:new lr(pt.layout_line.visibility),"line-width-unit":new lr(pt.layout_line["line-width-unit"])})),paint:WI||(WI=new Go({"line-opacity":new xr(pt.paint_line["line-opacity"]),"line-color":new xr(pt.paint_line["line-color"]),"line-translate":new lr(pt.paint_line["line-translate"]),"line-translate-anchor":new lr(pt.paint_line["line-translate-anchor"]),"line-width":new xr(pt.paint_line["line-width"]),"line-gap-width":new xr(pt.paint_line["line-gap-width"]),"line-offset":new xr(pt.paint_line["line-offset"]),"line-blur":new xr(pt.paint_line["line-blur"]),"line-dasharray":new xr(pt.paint_line["line-dasharray"]),"line-pattern":new xr(pt.paint_line["line-pattern"]),"line-pattern-cross-fade":new lr(pt.paint_line["line-pattern-cross-fade"]),"line-gradient":new Dd(pt.paint_line["line-gradient"]),"line-trim-offset":new lr(pt.paint_line["line-trim-offset"]),"line-trim-fade-range":new lr(pt.paint_line["line-trim-fade-range"]),"line-trim-color":new lr(pt.paint_line["line-trim-color"]),"line-emissive-strength":new lr(pt.paint_line["line-emissive-strength"]),"line-border-width":new xr(pt.paint_line["line-border-width"]),"line-border-color":new xr(pt.paint_line["line-border-color"]),"line-occlusion-opacity":new lr(pt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},sS);class Wj extends xr{possiblyEvaluate(t,o){return o=new co(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition,worldview:o.worldview}),super.possiblyEvaluate(t,o)}evaluate(t,o,u,f){return o=Object.assign({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,u,f)}}let $y;function tP(s,t){return t>0?t+2*s:s}const Zj=ii([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xj=ii([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Yj=ii([{name:"a_projected_pos",components:4,type:"Float32"}],4);ii([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Qj=ii([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),Kj=ii([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),Jj=ii([{name:"a_texb",components:2,type:"Uint16"}]),eU=ii([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),tU=ii([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);ii([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const rP=ii([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),rU=ii([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ii([{name:"triangle",components:3,type:"Uint16"}]),ii([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ii([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),ii([{type:"Float32",name:"offsetX"}]),ii([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ns=24;function nU(s,t,o){return s.sections.forEach((u=>{u.text=(function(f,A,v){const C=A.layout.get("text-transform").evaluate(v,{});return C==="uppercase"?f=f.toLocaleUpperCase():C==="lowercase"&&(f=f.toLocaleLowerCase()),Ru.applyArabicShaping&&(f=Ru.applyArabicShaping(f)),f})(u.text,t,o)})),s}const Gy={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function iU(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}function oU(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}const lS=4294967296,nP=1/lS,iP=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let w1=class{constructor(s=new Uint8Array(16)){this.buf=ArrayBuffer.isView(s)?s:new Uint8Array(s),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(s,t,o=this.length){for(;this.pos<o;){const u=this.readVarint(),f=u>>3,A=this.pos;this.type=7&u,s(f,t,this),this.pos===A&&this.skip(u)}return t}readMessage(s,t){return this.readFields(s,t,this.readVarint()+this.pos)}readFixed32(){const s=this.dataView.getUint32(this.pos,!0);return this.pos+=4,s}readSFixed32(){const s=this.dataView.getInt32(this.pos,!0);return this.pos+=4,s}readFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*lS;return this.pos+=8,s}readSFixed64(){const s=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*lS;return this.pos+=8,s}readFloat(){const s=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,s}readDouble(){const s=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,s}readVarint(s){const t=this.buf;let o,u;return u=t[this.pos++],o=127&u,u<128?o:(u=t[this.pos++],o|=(127&u)<<7,u<128?o:(u=t[this.pos++],o|=(127&u)<<14,u<128?o:(u=t[this.pos++],o|=(127&u)<<21,u<128?o:(u=t[this.pos],o|=(15&u)<<28,(function(f,A,v){const C=v.buf;let P,k;if(k=C[v.pos++],P=(112&k)>>4,k<128||(k=C[v.pos++],P|=(127&k)<<3,k<128)||(k=C[v.pos++],P|=(127&k)<<10,k<128)||(k=C[v.pos++],P|=(127&k)<<17,k<128)||(k=C[v.pos++],P|=(127&k)<<24,k<128)||(k=C[v.pos++],P|=(1&k)<<31,k<128))return h_(f,P,A);throw new Error("Expected varint not more than 10 bytes")})(o,s,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const s=this.readVarint();return s%2==1?(s+1)/-2:s/2}readBoolean(){return!!this.readVarint()}readString(){const s=this.readVarint()+this.pos,t=this.pos;return this.pos=s,s-t>=12&&iP?iP.decode(this.buf.subarray(t,s)):(function(o,u,f){let A="",v=u;for(;v<f;){const C=o[v];let P,k,U,$=null,q=C>239?4:C>223?3:C>191?2:1;if(v+q>f)break;q===1?C<128&&($=C):q===2?(P=o[v+1],(192&P)==128&&($=(31&C)<<6|63&P,$<=127&&($=null))):q===3?(P=o[v+1],k=o[v+2],(192&P)==128&&(192&k)==128&&($=(15&C)<<12|(63&P)<<6|63&k,($<=2047||$>=55296&&$<=57343)&&($=null))):q===4&&(P=o[v+1],k=o[v+2],U=o[v+3],(192&P)==128&&(192&k)==128&&(192&U)==128&&($=(15&C)<<18|(63&P)<<12|(63&k)<<6|63&U,($<=65535||$>=1114112)&&($=null))),$===null?($=65533,q=1):$>65535&&($-=65536,A+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),A+=String.fromCharCode($),v+=q}return A})(this.buf,t,s)}readBytes(){const s=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,s);return this.pos=s,t}readPackedVarint(s=[],t){const o=this.readPackedEnd();for(;this.pos<o;)s.push(this.readVarint(t));return s}readPackedSVarint(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readSVarint());return s}readPackedBoolean(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readBoolean());return s}readPackedFloat(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readFloat());return s}readPackedDouble(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readDouble());return s}readPackedFixed32(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readFixed32());return s}readPackedSFixed32(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readSFixed32());return s}readPackedFixed64(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readFixed64());return s}readPackedSFixed64(s=[]){const t=this.readPackedEnd();for(;this.pos<t;)s.push(this.readSFixed64());return s}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(s){const t=7&s;if(t===0)for(;this.buf[this.pos++]>127;);else if(t===2)this.pos=this.readVarint()+this.pos;else if(t===5)this.pos+=4;else{if(t!==1)throw new Error(`Unimplemented type: ${t}`);this.pos+=8}}writeTag(s,t){this.writeVarint(s<<3|t)}realloc(s){let t=this.length||16;for(;t<this.pos+s;)t*=2;if(t!==this.length){const o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.dataView=new DataView(o.buffer),this.length=t}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeSFixed32(s){this.realloc(4),this.dataView.setInt32(this.pos,s,!0),this.pos+=4}writeFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*nP),!0),this.pos+=8}writeSFixed64(s){this.realloc(8),this.dataView.setInt32(this.pos,-1&s,!0),this.dataView.setInt32(this.pos+4,Math.floor(s*nP),!0),this.pos+=8}writeVarint(s){(s=+s||0)>268435455||s<0?(function(t,o){let u,f;if(t>=0?(u=t%4294967296|0,f=t/4294967296|0):(u=~(-t%4294967296),f=~(-t/4294967296),4294967295^u?u=u+1|0:(u=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),(function(A,v,C){C.buf[C.pos++]=127&A|128,A>>>=7,C.buf[C.pos++]=127&A|128,A>>>=7,C.buf[C.pos++]=127&A|128,A>>>=7,C.buf[C.pos++]=127&A|128,C.buf[C.pos]=127&(A>>>=7)})(u,0,o),(function(A,v){const C=(7&A)<<4;v.buf[v.pos++]|=C|((A>>>=3)?128:0),A&&(v.buf[v.pos++]=127&A|((A>>>=7)?128:0),A&&(v.buf[v.pos++]=127&A|((A>>>=7)?128:0),A&&(v.buf[v.pos++]=127&A|((A>>>=7)?128:0),A&&(v.buf[v.pos++]=127&A|((A>>>=7)?128:0),A&&(v.buf[v.pos++]=127&A)))))})(f,o)})(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))}writeSVarint(s){this.writeVarint(s<0?2*-s-1:2*s)}writeBoolean(s){this.writeVarint(+s)}writeString(s){s=String(s),this.realloc(4*s.length),this.pos++;const t=this.pos;this.pos=(function(u,f,A){for(let v,C,P=0;P<f.length;P++){if(v=f.charCodeAt(P),v>55295&&v<57344){if(!C){v>56319||P+1===f.length?(u[A++]=239,u[A++]=191,u[A++]=189):C=v;continue}if(v<56320){u[A++]=239,u[A++]=191,u[A++]=189,C=v;continue}v=C-55296<<10|v-56320|65536,C=null}else C&&(u[A++]=239,u[A++]=191,u[A++]=189,C=null);v<128?u[A++]=v:(v<2048?u[A++]=v>>6|192:(v<65536?u[A++]=v>>12|224:(u[A++]=v>>18|240,u[A++]=v>>12&63|128),u[A++]=v>>6&63|128),u[A++]=63&v|128)}return A})(this.buf,s,this.pos);const o=this.pos-t;o>=128&&oP(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o}writeFloat(s){this.realloc(4),this.dataView.setFloat32(this.pos,s,!0),this.pos+=4}writeDouble(s){this.realloc(8),this.dataView.setFloat64(this.pos,s,!0),this.pos+=8}writeBytes(s){const t=s.length;this.writeVarint(t),this.realloc(t);for(let o=0;o<t;o++)this.buf[this.pos++]=s[o]}writeRawMessage(s,t){this.pos++;const o=this.pos;s(t,this);const u=this.pos-o;u>=128&&oP(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u}writeMessage(s,t,o){this.writeTag(s,2),this.writeRawMessage(t,o)}writePackedVarint(s,t){t.length&&this.writeMessage(s,aU,t)}writePackedSVarint(s,t){t.length&&this.writeMessage(s,sU,t)}writePackedBoolean(s,t){t.length&&this.writeMessage(s,uU,t)}writePackedFloat(s,t){t.length&&this.writeMessage(s,lU,t)}writePackedDouble(s,t){t.length&&this.writeMessage(s,cU,t)}writePackedFixed32(s,t){t.length&&this.writeMessage(s,hU,t)}writePackedSFixed32(s,t){t.length&&this.writeMessage(s,fU,t)}writePackedFixed64(s,t){t.length&&this.writeMessage(s,dU,t)}writePackedSFixed64(s,t){t.length&&this.writeMessage(s,pU,t)}writeBytesField(s,t){this.writeTag(s,2),this.writeBytes(t)}writeFixed32Field(s,t){this.writeTag(s,5),this.writeFixed32(t)}writeSFixed32Field(s,t){this.writeTag(s,5),this.writeSFixed32(t)}writeFixed64Field(s,t){this.writeTag(s,1),this.writeFixed64(t)}writeSFixed64Field(s,t){this.writeTag(s,1),this.writeSFixed64(t)}writeVarintField(s,t){this.writeTag(s,0),this.writeVarint(t)}writeSVarintField(s,t){this.writeTag(s,0),this.writeSVarint(t)}writeStringField(s,t){this.writeTag(s,2),this.writeString(t)}writeFloatField(s,t){this.writeTag(s,5),this.writeFloat(t)}writeDoubleField(s,t){this.writeTag(s,1),this.writeDouble(t)}writeBooleanField(s,t){this.writeVarintField(s,+t)}};function h_(s,t,o){return o?4294967296*t+(s>>>0):4294967296*(t>>>0)+(s>>>0)}function oP(s,t,o){const u=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(u);for(let f=o.pos-1;f>=s;f--)o.buf[f+u]=o.buf[f]}function aU(s,t){for(let o=0;o<s.length;o++)t.writeVarint(s[o])}function sU(s,t){for(let o=0;o<s.length;o++)t.writeSVarint(s[o])}function lU(s,t){for(let o=0;o<s.length;o++)t.writeFloat(s[o])}function cU(s,t){for(let o=0;o<s.length;o++)t.writeDouble(s[o])}function uU(s,t){for(let o=0;o<s.length;o++)t.writeBoolean(s[o])}function hU(s,t){for(let o=0;o<s.length;o++)t.writeFixed32(s[o])}function fU(s,t){for(let o=0;o<s.length;o++)t.writeSFixed32(s[o])}function dU(s,t){for(let o=0;o<s.length;o++)t.writeFixed64(s[o])}function pU(s,t){for(let o=0;o<s.length;o++)t.writeSFixed64(s[o])}const cS=3;function mU(s,t,o){t.glyphs=[],s===1&&o.readMessage(AU,t)}function AU(s,t,o){if(s===3){const{id:u,bitmap:f,width:A,height:v,left:C,top:P,advance:k}=o.readMessage(gU,{});t.glyphs.push({id:u,bitmap:new Ip({width:A+2*cS,height:v+2*cS},f),metrics:{width:A,height:v,left:C,top:P,advance:k}})}else s===4?t.ascender=o.readSVarint():s===5&&(t.descender=o.readSVarint())}function gU(s,t,o){s===1?t.id=o.readVarint():s===2?t.bitmap=o.readBytes():s===3?t.width=o.readVarint():s===4?t.height=o.readVarint():s===5?t.left=o.readSVarint():s===6?t.top=o.readSVarint():s===7&&(t.advance=o.readVarint())}const aP=cS,ju={horizontal:1,vertical:2,horizontalOnly:3};class Hy{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(t,o){const u=new Hy;return u.scale=t||1,u.fontStack=o,u}static forImage(t){const o=new Hy;return o.image=t,o}}class f_{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o,u){const f=new f_;for(let A=0;A<t.sections.length;A++){const v=t.sections[A];v.image?f.addImageSection(v,u):f.addTextSection(v,o)}return f}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=(function(o,u){let f="";for(let A=0;A<o.length;A++){const v=o.charCodeAt(A+1)||null,C=o.charCodeAt(A-1)||null;f+=!u&&(v&&pp(v)&&!Gy[o[A+1]]||C&&pp(C)&&!Gy[o[A-1]])||!Gy[o[A]]?o[A]:Gy[o[A]]}return f})(this.text,t)}trim(){let t=0;for(let u=0;u<this.text.length&&S1[this.text.charCodeAt(u)];u++)t++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=t&&S1[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const u=new f_;return u.text=this.text.substring(t,o),u.sectionIndex=this.sectionIndex.slice(t,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,o)=>Math.max(t,this.sections[o].scale)),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(Hy.forText(t.scale,t.fontStack||o));const u=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(u)}addImageSection(t,o){const u=t.image?t.image.getPrimary():null;if(!u)return void Fn("Can't add FormattedSection with an empty image.");u.scaleSelf(o);const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCodePoint(f),this.sections.push(Hy.forImage(u)),this.sectionIndex.push(this.sections.length-1)):Fn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function uS(s,t,o,u,f,A,v,C,P,k,U,$,q,K,J,de=1){const Ae=f_.fromFeature(s,f,de);$===ju.vertical&&Ae.verticalizePunctuation(q);let _e=[];const Ie=(function(tt,it,ct,$t,mt,Wt){if(!tt)return[];const sr=[],Kt=(function(tr,Mt,St,pr,cr,nn){let kr=0;for(let Xr=0;Xr<tr.length();Xr++){const _r=tr.getSection(Xr);kr+=sP(tr.getCodePoint(Xr),_r,pr,cr,Mt,nn)}return kr/Math.max(1,Math.ceil(kr/St))})(tt,it,ct,$t,mt,Wt),er=tt.text.indexOf("")>=0;let hr=0;for(let tr=0;tr<tt.length();tr++){const Mt=tt.getSection(tr),St=tt.getCodePoint(tr);if(S1[St]||(hr+=sP(St,Mt,$t,mt,it,Wt)),tr<tt.length()-1){const pr=!((Nt=St)<11904||!(dn["Bopomofo Extended"](Nt)||dn.Bopomofo(Nt)||dn["CJK Compatibility Forms"](Nt)||dn["CJK Compatibility Ideographs"](Nt)||dn["CJK Compatibility"](Nt)||dn["CJK Radicals Supplement"](Nt)||dn["CJK Strokes"](Nt)||dn["CJK Symbols and Punctuation"](Nt)||dn["CJK Unified Ideographs Extension A"](Nt)||dn["CJK Unified Ideographs"](Nt)||dn["Enclosed CJK Letters and Months"](Nt)||dn["Halfwidth and Fullwidth Forms"](Nt)||dn.Hiragana(Nt)||dn["Ideographic Description Characters"](Nt)||dn["Kangxi Radicals"](Nt)||dn["Katakana Phonetic Extensions"](Nt)||dn.Katakana(Nt)||dn["Vertical Forms"](Nt)||dn["Yi Radicals"](Nt)||dn["Yi Syllables"](Nt)));(_U[St]||pr||Mt.image)&&sr.push(cP(tr+1,hr,Kt,sr,yU(St,tt.getCodePoint(tr+1),pr&&er),!1))}}var Nt;return uP(cP(tt.length(),hr,Kt,sr,0,!0))})(Ae,k,A,t,u,K),{processBidirectionalText:Pe,processStyledBidirectionalText:ke}=Ru;if(Pe&&Ae.sections.length===1){const tt=Pe(Ae.toString(),Ie);for(const it of tt){const ct=new f_;ct.text=it,ct.sections=Ae.sections;for(let $t=0;$t<it.length;$t++)ct.sectionIndex.push(0);_e.push(ct)}}else if(ke){const tt=ke(Ae.text,Ae.sectionIndex,Ie);for(const it of tt){const ct=new f_;ct.text=it[0],ct.sectionIndex=it[1],ct.sections=Ae.sections,_e.push(ct)}}else _e=(function(tt,it){const ct=[],$t=tt.text;let mt=0;for(const Wt of it)ct.push(tt.substring(mt,Wt)),mt=Wt;return mt<$t.length&&ct.push(tt.substring(mt,$t.length)),ct})(Ae,Ie);const Ye=[],Qe={positionedLines:Ye,text:Ae.toString(),top:U[1],bottom:U[1],left:U[0],right:U[0],writingMode:$,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if((function(tt,it,ct,$t,mt,Wt,sr,Kt,er,hr,Nt,tr){let Mt=0,St=0,pr=0;const cr=Kt==="right"?1:Kt==="left"?0:.5;let nn=!1;for(const Er of mt){const Qr=Er.getSections();for(const vn of Qr){if(vn.image)continue;const kn=it[vn.fontStack];if(kn&&(nn=kn.ascender!==void 0&&kn.descender!==void 0,!nn))break}if(!nn)break}let kr=0;for(const Er of mt){Er.trim();const Qr=Er.getMaxScale(),vn=(Qr-1)*Ns,kn={positionedGlyphs:[],lineOffset:0};tt.positionedLines[kr]=kn;const Qn=kn.positionedGlyphs;let Vn=0;if(!Er.length()){St+=Wt,++kr;continue}let jr=0,Ln=0;for(let Ne=0;Ne<Er.length();Ne++){const je=Er.getSection(Ne),Ct=Er.getSectionIndex(Ne),Ut=Er.getCodePoint(Ne);let Sr=je.scale,br=null,Br=null,un=null,Kn=Ns,Jn=0,Zn=er;Zn===ju.vertical&&((Xr=Ut)===12312||Xr===12313||Xr===12316||Xr===12540||Xr===12448)&&(Zn=ju.horizontal);const Xi=!(Zn===ju.horizontal||!Nt&&!dp(Ut)||Nt&&(S1[Ut]||Mg(Ut)));if(je.image){const Vo=$t.get(je.image.toString());if(!Vo)continue;un=je.image,tt.iconsInText=tt.iconsInText||!0,Br=Vo.paddedRect;const Hn=Vo.displaySize;Sr=Sr*Ns/tr,br={width:Hn[0],height:Hn[1],left:0,top:-aP,advance:Xi?Hn[1]:Hn[0],localGlyph:!1},Jn=nn?-br.height*Sr:Qr*Ns-17-Hn[1]*Sr,Kn=br.advance;const Co=(Xi?Hn[0]:Hn[1])*Sr-Ns*Qr;Co>0&&Co>Vn&&(Vn=Co)}else{const Vo=ct[je.fontStack];if(!Vo)continue;Vo[Ut]&&(Br=Vo[Ut]);const Hn=it[je.fontStack];if(!Hn)continue;const Co=Hn.glyphs[Ut];if(!Co)continue;if(br=Co.metrics,Kn=Ut!==8203?Ns:0,nn){const no=Hn.ascender!==void 0?Math.abs(Hn.ascender):0,Li=Hn.descender!==void 0?Math.abs(Hn.descender):0,zo=(no+Li)*Sr;jr<zo&&(jr=zo,Ln=(no-Li)/2*Sr),Jn=-no*Sr}else Jn=(Qr-Sr)*Ns-17}Xi?(tt.verticalizable=!0,Qn.push({glyph:Ut,image:un,x:Mt,y:St+Jn,vertical:Xi,scale:Sr,localGlyph:br.localGlyph,fontStack:je.fontStack,sectionIndex:Ct,metrics:br,rect:Br}),Mt+=Kn*Sr+hr):(Qn.push({glyph:Ut,image:un,x:Mt,y:St+Jn,vertical:Xi,scale:Sr,localGlyph:br.localGlyph,fontStack:je.fontStack,sectionIndex:Ct,metrics:br,rect:Br}),Mt+=br.advance*Sr+hr)}Qn.length!==0&&(pr=Math.max(Mt-hr,pr),nn?hP(Qn,cr,Vn,Ln,Wt*Qr/2):hP(Qn,cr,Vn,0,Wt/2)),Mt=0;const gi=Wt*Qr+Vn;kn.lineOffset=Math.max(Vn,vn),St+=gi,++kr}var Xr;const _r=St,{horizontalAlign:en,verticalAlign:Cn}=hS(sr);(function(Er,Qr,vn,kn,Qn,Vn){const jr=(Qr-vn)*Qn,Ln=-Vn*kn;for(const gi of Er)for(const Ne of gi.positionedGlyphs)Ne.x+=jr,Ne.y+=Ln})(tt.positionedLines,cr,en,Cn,pr,_r),tt.top+=-Cn*_r,tt.bottom=tt.top+_r,tt.left+=-en*pr,tt.right=tt.left+pr,tt.hasBaseline=nn})(Qe,t,o,u,_e,v,C,P,$,k,q,J),!(function(tt){for(const it of tt)if(it.positionedGlyphs.length!==0)return!1;return!0})(Ye))return Qe}const S1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_U={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function sP(s,t,o,u,f,A){if(t.image){const v=u.get(t.image.toString());return v?v.displaySize[0]*t.scale*Ns/A+f:0}{const v=o[t.fontStack],C=v&&v.glyphs[s];return C?C.metrics.advance*t.scale+f:0}}function lP(s,t,o,u){const f=Math.pow(s-t,2);return u?s<t?f/2:2*f:f+Math.abs(o)*o}function yU(s,t,o){let u=0;return s===10&&(u-=1e4),o&&(u+=150),s!==40&&s!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function cP(s,t,o,u,f,A){let v=null,C=lP(t,o,f,A);for(const P of u){const k=lP(t-P.x,o,f,A)+P.badness;k<=C&&(v=P,C=k)}return{index:s,x:t,priorBreak:v,badness:C}}function uP(s){return s?uP(s.priorBreak).concat(s.index):[]}function hS(s){let t=.5,o=.5;switch(s){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function hP(s,t,o,u,f){if(!(t||o||u||f))return;const A=s.length-1,v=s[A],C=(v.x+v.metrics.advance*v.scale)*t;for(let P=0;P<=A;P++)s[P].x-=C,s[P].y+=o+u+f}function fP(s){return s.imagePrimary!==void 0&&s.top!==void 0&&s.bottom!==void 0&&s.left!==void 0&&s.right!==void 0}function vU(s,t,o,u){const{horizontalAlign:f,verticalAlign:A}=hS(u),v=o[0]-s.displaySize[0]*f,C=o[1]-s.displaySize[1]*A;return{imagePrimary:s,imageSecondary:t,top:C,bottom:C+s.displaySize[1],left:v,right:v+s.displaySize[0]}}function dP(s,t,o,u,f,A){const v=s.imagePrimary;let C;if(v.content){const Ae=v.content,_e=v.pixelRatio||1;C=[Ae[0]/_e,Ae[1]/_e,v.displaySize[0]-Ae[2]/_e,v.displaySize[1]-Ae[3]/_e]}const P=t.left*A,k=t.right*A;let U,$,q,K;o==="width"||o==="both"?(K=f[0]+P-u[3],$=f[0]+k+u[1]):(K=f[0]+(P+k-v.displaySize[0])/2,$=K+v.displaySize[0]);const J=t.top*A,de=t.bottom*A;return o==="height"||o==="both"?(U=f[1]+J-u[0],q=f[1]+de+u[2]):(U=f[1]+(J+de-v.displaySize[1])/2,q=U+v.displaySize[1]),{imagePrimary:v,imageSecondary:void 0,top:U,right:$,bottom:q,left:K,collisionPadding:C}}function pP(s){return!s.imagePrimary.stretchX}function mP(s){return!s.imagePrimary.stretchY}function AP(s){return{width:s.right-s.left,height:s.bottom-s.top}}const Dp=128;function gP(s,t,o){const{expression:u}=t;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new co(s+1,{worldview:o}))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:A}=u;let v=0;for(;v<f.length&&f[v]<=s;)v++;v=Math.max(0,v-1);let C=v;for(;C<f.length&&f[C]<s+1;)C++;C=Math.min(f.length-1,C);const P=f[v],k=f[C];return u.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:k,interpolationType:A}:{kind:"camera",minZoom:P,maxZoom:k,minSize:u.evaluate(new co(P,{worldview:o})),maxSize:u.evaluate(new co(k,{worldview:o})),interpolationType:A}}}function fS(s,{uSize:t,uSizeT:o},{lowerSize:u,upperSize:f}){return s.kind==="source"?u/Dp:s.kind==="composite"?hn(u/Dp,f/Dp,o):t}function qy(s,t,o=1){let u=0,f=0;if(s.kind==="constant")f=s.layoutSize*o;else if(s.kind!=="source"){const{interpolationType:A,minZoom:v,maxZoom:C}=s,P=A?ce(Ro.interpolationFactor(A,t,v,C),0,1):0;s.kind==="camera"?f=hn(s.minSize,s.maxSize,P)*o:u=P*o}return{uSizeT:u,uSize:f}}class Rm extends rr{constructor(t,o,u,f,A){super(t,o),this.angle=f,this.z=u,A!==void 0&&(this.segment=A)}clone(){return new Rm(this.x,this.y,this.z,this.angle,this.segment)}}function _P(s,t,o,u,f){if(t.segment===void 0)return!0;let A=t,v=t.segment+1,C=0;for(;C>-o/2;){if(v--,v<0)return!1;C-=s[v].dist(A),A=s[v]}C+=s[v].dist(s[v+1]),v++;const P=[];let k=0;for(;C<o/2;){const U=s[v],$=s[v+1];if(!$)return!1;let q=s[v-1].angleTo(U)-U.angleTo($);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:C,angleDelta:q}),k+=q;C-P[0].distance>u;)k-=P.shift().angleDelta;if(k>f)return!1;v++,C+=U.dist($)}return!0}function yP(s){let t=0;for(let o=0;o<s.length-1;o++)t+=s[o].dist(s[o+1]);return t}function vP(s,t,o){return s?.6*t*o:0}function xP(s,t){return Math.max(s?s.right-s.left:0,t?t.right-t.left:0)}function xU(s,t,o,u,f,A){const v=vP(o,f,A),C=xP(o,u)*A;let P=0;const k=yP(s)/2;for(let U=0;U<s.length-1;U++){const $=s[U],q=s[U+1],K=$.dist(q);if(P+K>k){const J=(k-P)/K,de=hn($.x,q.x,J),Ae=hn($.y,q.y,J),_e=new Rm(de,Ae,0,q.angleTo($),U);return!v||_P(s,_e,C,v,t)?_e:void 0}P+=K}}function bU(s,t,o,u,f,A,v,C,P){const k=vP(u,A,v),U=xP(u,f),$=U*v,q=s[0].x===0||s[0].x===P||s[0].y===0||s[0].y===P;return t-$<t/4&&(t=$+t/4),bP(s,q?t/2*C%t:(U/2+2*A)*v*C%t,t,k,o,$,q,!1,P)}function bP(s,t,o,u,f,A,v,C,P){const k=A/2,U=yP(s);let $=0,q=t-o,K=[];for(let J=0;J<s.length-1;J++){const de=s[J],Ae=s[J+1],_e=de.dist(Ae),Ie=Ae.angleTo(de);for(;q+o<$+_e;){q+=o;const Pe=(q-$)/_e,ke=hn(de.x,Ae.x,Pe),Ye=hn(de.y,Ae.y,Pe);if(ke>=0&&ke<P&&Ye>=0&&Ye<P&&q-k>=0&&q+k<=U){const Qe=new Rm(ke,Ye,0,Ie,J);u&&!_P(s,Qe,A,u,f)||K.push(Qe)}}$+=_e}return C||K.length||v||(K=bP(s,$/2,o,u,f,A,v,!0,P)),K}function wP(s){let t=0,o=0;for(const v of s)t+=v.w*v.h,o=Math.max(o,v.w);s.sort(((v,C)=>C.h-v.h));const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let f=0,A=0;for(const v of s)for(let C=u.length-1;C>=0;C--){const P=u[C];if(!(v.w>P.w||v.h>P.h)){if(v.x=P.x,v.y=P.y,A=Math.max(A,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===P.w&&v.h===P.h){const k=u.pop();k&&C<u.length&&(u[C]=k)}else v.h===P.h?(P.x+=v.w,P.w-=v.w):v.w===P.w?(P.y+=v.h,P.h-=v.h):(u.push({x:P.x+v.w,y:P.y,w:P.w-v.w,h:v.h}),P.y+=v.h,P.h-=v.h);break}}return{w:f,h:A,fill:t/(f*A)||0}}Rr(Rm,"Anchor");const W0=1;class Wy{static getImagePositionScale(t,o,u){if(o&&t&&t.options&&t.options.transform){const f=t.options.transform;return{x:f.a,y:f.d}}return{x:u,y:u}}constructor(t,o,u,f){this.paddedRect=t;const{pixelRatio:A,version:v,stretchX:C,stretchY:P,content:k,sdf:U,usvg:$}=o;this.pixelRatio=A,this.stretchX=C,this.stretchY=P,this.content=k,this.version=v,this.padding=u,this.sdf=U,this.usvg=$,this.scale=Wy.getImagePositionScale(f,$,A)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function dS(s,t,o){const u=ys.parse(s),f=(function(A,v,C=[1,1]){return{x:0,y:0,w:(A.data?A.data.width:A.width*C[0])+2*v,h:(A.data?A.data.height:A.height*C[1])+2*v}})(t,o,[u.options.transform.a,u.options.transform.d]);return{bin:f,imagePosition:new Wy(f,t,o,u),imageVariant:u}}class SP{constructor(t,o,u){const f=new Map,A=new Map;this.haveRenderCallbacks=[];const v=[];this.addImages(t,f,W0,v),this.addImages(o,A,2,v);const{w:C,h:P}=wP(v),k=new Bs({width:C||1,height:P||1});for(const[U,$]of t.entries()){const q=f.get(U).paddedRect;Bs.copy($.data,k,{x:0,y:0},{x:q.x+W0,y:q.y+W0},$.data,null,$.sdf)}for(const[U,$]of o.entries()){const q=A.get(U),K=q.paddedRect;let J=q.padding;const de=K.x+J,Ae=K.y+J,_e=$.data.width,Ie=$.data.height;J=J>1?J-1:J,Bs.copy($.data,k,{x:0,y:0},{x:de,y:Ae},$.data,u),Bs.copy($.data,k,{x:0,y:Ie-J},{x:de,y:Ae-J},{width:_e,height:J},u),Bs.copy($.data,k,{x:0,y:0},{x:de,y:Ae+Ie},{width:_e,height:J},u),Bs.copy($.data,k,{x:_e-J,y:0},{x:de-J,y:Ae},{width:J,height:Ie},u),Bs.copy($.data,k,{x:0,y:0},{x:de+_e,y:Ae},{width:J,height:Ie},u),Bs.copy($.data,k,{x:_e-J,y:Ie-J},{x:de-J,y:Ae-J},{width:J,height:J},u),Bs.copy($.data,k,{x:0,y:Ie-J},{x:de+_e,y:Ae-J},{width:J,height:J},u),Bs.copy($.data,k,{x:0,y:0},{x:de+_e,y:Ae+Ie},{width:J,height:J},u),Bs.copy($.data,k,{x:_e-J,y:0},{x:de-J,y:Ae+Ie},{width:J,height:J},u)}this.lut=u,this.image=k,this.iconPositions=f,this.patternPositions=A}addImages(t,o,u,f){for(const[A,v]of t.entries()){const{bin:C,imagePosition:P,imageVariant:k}=dS(A,v,u);o.set(A,P),f.push(C),v.hasRenderCallback&&this.haveRenderCallbacks.push(k.id)}}patchUpdatedImages(t,o,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((f=>t.hasImage(f,u))),t.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const f of t.getUpdatedImages(u)){for(const A of this.iconPositions.keys()){const v=ys.parse(A);if(wl.isEqual(v.id,f)){const C=t.getImage(f,u);this.patchUpdatedImage(this.iconPositions.get(A),C,o,null)}}for(const A of this.patternPositions.keys()){const v=ys.parse(A);if(wl.isEqual(v.id,f)){const C=t.getImage(f,u);this.patchUpdatedImage(this.patternPositions.get(A),C,o,this.lut)}}}}patchUpdatedImage(t,o,u,f=null){if(!t||!o||t.version===o.version)return;t.version=o.version;const[A,v]=t.tl,C=t.sdf;if(this.lut||C){const P={width:o.data.width,height:o.data.height},k=new Bs(P);Bs.copy(o.data,k,{x:0,y:0},{x:0,y:0},P,f,C),u.update(k,{position:{x:A,y:v}})}else u.update(o.data,{position:{x:A,y:v}})}}Rr(Wy,"ImagePosition"),Rr(SP,"ImageAtlas");const Zy=1e20;function TP(s,t,o,u,f,A,v,C,P){for(let k=t;k<t+u;k++)EP(s,o*A+k,A,f,v,C,P);for(let k=o;k<o+f;k++)EP(s,k*A+t,1,u,v,C,P)}function EP(s,t,o,u,f,A,v){A[0]=0,v[0]=-Zy,v[1]=Zy,f[0]=s[t];for(let C=1,P=0,k=0;C<u;C++){f[C]=s[t+C*o];const U=C*C;do{const $=A[P];k=(f[C]-f[$]+U-$*$)/(C-$)/2}while(k<=v[P]&&--P>-1);P++,A[P]=C,v[P]=k,v[P+1]=Zy}for(let C=0,P=0;C<u;C++){for(;v[P+1]<C;)P++;const k=A[P],U=C-k;s[t+C*o]=f[k]+U*U}}const Ud=2,pS={none:0,ideographs:1,all:2};class d_{constructor(t,o,u){this.requestManager=t,this.localGlyphMode=o,this.localFontFamily=u,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,o){const u=[],f=this.url||ss.GLYPHS_URL;for(const A in t)for(const v of t[A])u.push({stack:A,id:v});vt(u,(({stack:A,id:v},C)=>{let P=this.entries[A];P||(P=this.entries[A]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let k=P.glyphs[v];if(k!==void 0)return void C(null,{stack:A,id:v,glyph:k});if(k=this._tinySDF(P,A,v),k)return P.glyphs[v]=k,void C(null,{stack:A,id:v,glyph:k});const U=Math.floor(v/256);if(256*U>65535)return Fn("glyphs > 65535 not supported"),void C(null,{stack:A,id:v,glyph:k});if(P.ranges[U])return void C(null,{stack:A,id:v,glyph:k});let $=P.requests[U];$||($=P.requests[U]=[],d_.loadGlyphRange(A,U,f,this.requestManager,((q,K)=>{if(K){P.ascender=K.ascender,P.descender=K.descender;for(const J in K.glyphs)this._doesCharSupportLocalGlyph(+J)||(P.glyphs[+J]=K.glyphs[+J]);P.ranges[U]=!0}for(const J of $)J(q,K);delete P.requests[U]}))),$.push(((q,K)=>{q?C(q):K&&C(null,{stack:A,id:v,glyph:K.glyphs[v]||null})}))}),((A,v)=>{if(A)o(A);else if(v){const C={};for(const{stack:P,id:k,glyph:U}of v)C[P]===void 0&&(C[P]={}),C[P].glyphs===void 0&&(C[P].glyphs={}),C[P].glyphs[k]=U&&{id:U.id,bitmap:U.bitmap.clone(),metrics:U.metrics},C[P].ascender=this.entries[P].ascender,C[P].descender=this.entries[P].descender;o(null,C)}}))}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==pS.none&&(this.localGlyphMode===pS.all?!!this.localFontFamily:!!this.localFontFamily&&(dn["CJK Unified Ideographs"](t)||dn["Hangul Syllables"](t)||dn.Hiragana(t)||dn.Katakana(t)||dn["CJK Symbols and Punctuation"](t)||dn["CJK Unified Ideographs Extension A"](t)||dn["CJK Unified Ideographs Extension B"](t)||dn.Osage(t)))}_tinySDF(t,o,u){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(u))return;let A=t.tinySDF;if(!A){let de="400";/bold/i.test(o)?de="900":/medium/i.test(o)?de="500":/light/i.test(o)&&(de="200"),A=t.tinySDF=new d_.TinySDF({fontFamily:f,fontWeight:de,fontSize:24*Ud,buffer:3*Ud,radius:8*Ud}),A.fontWeight=de}if(this.localGlyphs[A.fontWeight][u])return this.localGlyphs[A.fontWeight][u];const v=String.fromCodePoint(u),{data:C,width:P,height:k,glyphWidth:U,glyphHeight:$,glyphLeft:q,glyphTop:K,glyphAdvance:J}=A.draw(v);return this.localGlyphs[A.fontWeight][u]={id:u,bitmap:new Ip({width:P,height:k},C),metrics:{width:U/Ud,height:$/Ud,left:q/Ud,top:K/Ud-27,advance:J/Ud,localGlyph:!0}}}}d_.loadGlyphRange=function(s,t,o,u,f){const A=256*t,v=A+255,C=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",s).replace("{range}",`${A}-${v}`),zh.Glyphs);wc(C,((P,k)=>{if(P)f(P);else if(k){const U={},$=(function(q){return new w1(q).readFields(mU,{})})(k);for(const q of $.glyphs)U[q.id]=q;f(null,{glyphs:U,ascender:$.ascender,descender:$.descender})}}))},d_.TinySDF=class{constructor({fontSize:s=24,buffer:t=3,radius:o=8,cutoff:u=.25,fontFamily:f="sans-serif",fontWeight:A="normal",fontStyle:v="normal",lang:C=null}={}){this.buffer=t,this.cutoff=u,this.radius=o,this.lang=C;const P=this.size=s+4*t,k=this._createCanvas(P),U=this.ctx=k.getContext("2d",{willReadFrequently:!0});U.font=`${v} ${A} ${s}px ${f}`,U.textBaseline="alphabetic",U.textAlign="left",U.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(s){const t=document.createElement("canvas");return t.width=t.height=s,t}draw(s){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:f,actualBoundingBoxRight:A}=this.ctx.measureText(s),v=Math.ceil(o),C=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(A-f))),P=Math.min(this.size-this.buffer,v+Math.ceil(u)),k=C+2*this.buffer,U=P+2*this.buffer,$=Math.max(k*U,0),q=new Uint8ClampedArray($),K={data:q,width:k,height:U,glyphWidth:C,glyphHeight:P,glyphTop:v,glyphLeft:0,glyphAdvance:t};if(C===0||P===0)return K;const{ctx:J,buffer:de,gridInner:Ae,gridOuter:_e}=this;this.lang&&(J.lang=this.lang),J.clearRect(de,de,C,P),J.fillText(s,de,de+v);const Ie=J.getImageData(de,de,C,P);_e.fill(Zy,0,$),Ae.fill(0,0,$);for(let Pe=0;Pe<P;Pe++)for(let ke=0;ke<C;ke++){const Ye=Ie.data[4*(Pe*C+ke)+3]/255;if(Ye===0)continue;const Qe=(Pe+de)*k+ke+de;if(Ye===1)_e[Qe]=0,Ae[Qe]=Zy;else{const tt=.5-Ye;_e[Qe]=tt>0?tt*tt:0,Ae[Qe]=tt<0?tt*tt:0}}TP(_e,0,0,k,U,k,this.f,this.v,this.z),TP(Ae,de,de,C,P,k,this.f,this.v,this.z);for(let Pe=0;Pe<$;Pe++){const ke=Math.sqrt(_e[Pe])-Math.sqrt(Ae[Pe]);q[Pe]=Math.round(255-255*(ke/this.radius+this.cutoff))}return K}};const qA=W0;function CP(s,t){return s+t[1]-t[0]}function MP(s,t,o,u,f=1){const A=[],v=s.imagePrimary,C=v.pixelRatio,P=v.paddedRect.w-2*qA,k=v.paddedRect.h-2*qA,U=(s.right-s.left)*f,$=(s.bottom-s.top)*f,q=v.stretchX||[[0,P]],K=v.stretchY||[[0,k]],J=q.reduce(CP,0),de=K.reduce(CP,0),Ae=P-J,_e=k-de;let Ie=0,Pe=J,ke=0,Ye=de,Qe=0,tt=Ae,it=0,ct=_e;if(v.content&&u){const mt=v.content;Ie=T1(q,0,mt[0]),ke=T1(K,0,mt[1]),Pe=T1(q,mt[0],mt[2]),Ye=T1(K,mt[1],mt[3]),Qe=mt[0]-Ie,it=mt[1]-ke,tt=mt[2]-mt[0]-Pe,ct=mt[3]-mt[1]-Ye}const $t=(mt,Wt,sr,Kt)=>{const er=E1(mt.stretch-Ie,Pe,U,s.left*f),hr=C1(mt.fixed-Qe,tt,mt.stretch,J),Nt=E1(Wt.stretch-ke,Ye,$,s.top*f),tr=C1(Wt.fixed-it,ct,Wt.stretch,de),Mt=E1(sr.stretch-Ie,Pe,U,s.left*f),St=C1(sr.fixed-Qe,tt,sr.stretch,J),pr=E1(Kt.stretch-ke,Ye,$,s.top*f),cr=C1(Kt.fixed-it,ct,Kt.stretch,de),nn=new rr(er,Nt),kr=new rr(Mt,Nt),Xr=new rr(Mt,pr),_r=new rr(er,pr),en=new rr(hr/C,tr/C),Cn=new rr(St/C,cr/C),Er=t*Math.PI/180;if(Er){const jr=Math.sin(Er),Ln=Math.cos(Er),gi=[Ln,-jr,jr,Ln];nn._matMult(gi),kr._matMult(gi),_r._matMult(gi),Xr._matMult(gi)}const Qr=mt.stretch+mt.fixed,vn=sr.stretch+sr.fixed,kn=Wt.stretch+Wt.fixed,Qn=Kt.stretch+Kt.fixed,Vn=s.imageSecondary;return{tl:nn,tr:kr,bl:_r,br:Xr,texPrimary:{x:v.paddedRect.x+qA+Qr,y:v.paddedRect.y+qA+kn,w:vn-Qr,h:Qn-kn},texSecondary:Vn?{x:Vn.paddedRect.x+qA+Qr,y:Vn.paddedRect.y+qA+kn,w:vn-Qr,h:Qn-kn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:en,pixelOffsetBR:Cn,minFontScaleX:tt/C/U,minFontScaleY:ct/C/$,isSDF:o}};if(u&&(v.stretchX||v.stretchY)){const mt=IP(q,Ae,J),Wt=IP(K,_e,de);for(let sr=0;sr<mt.length-1;sr++){const Kt=mt[sr],er=mt[sr+1];for(let hr=0;hr<Wt.length-1;hr++)A.push($t(Kt,Wt[hr],er,Wt[hr+1]))}}else A.push($t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:k+1}));return A}function T1(s,t,o){let u=0;for(const f of s)u+=Math.max(t,Math.min(o,f[1]))-Math.max(t,Math.min(o,f[0]));return u}function IP(s,t,o){const u=[{fixed:-qA,stretch:0}];for(const[f,A]of s){const v=u[u.length-1];u.push({fixed:f-v.stretch,stretch:v.stretch}),u.push({fixed:f-v.stretch,stretch:v.stretch+(A-f)})}return u.push({fixed:t+qA,stretch:o}),u}function E1(s,t,o,u){return s/t*o+u}function C1(s,t,o,u){return s-t*o/u}function wU(s,t,o,u){const f=t+s.positionedLines[u].lineOffset;return u===0?o+f/2:o+(f+(t+s.positionedLines[u-1].lineOffset))/2}function SU(s,t=1,o=!1){let u=1/0,f=1/0,A=-1/0,v=-1/0;const C=s[0];for(let K=0;K<C.length;K++){const J=C[K];(!K||J.x<u)&&(u=J.x),(!K||J.y<f)&&(f=J.y),(!K||J.x>A)&&(A=J.x),(!K||J.y>v)&&(v=J.y)}const P=Math.min(A-u,v-f);let k=P/2;const U=new yu([],TU);if(P===0)return new rr(u,f);for(let K=u;K<A;K+=P)for(let J=f;J<v;J+=P)U.push(new p_(K+k,J+k,k,s));let $=(function(K){let J=0,de=0,Ae=0;const _e=K[0];for(let Ie=0,Pe=_e.length,ke=Pe-1;Ie<Pe;ke=Ie++){const Ye=_e[Ie],Qe=_e[ke],tt=Ye.x*Qe.y-Qe.x*Ye.y;de+=(Ye.x+Qe.x)*tt,Ae+=(Ye.y+Qe.y)*tt,J+=3*tt}return new p_(de/J,Ae/J,0,K)})(s),q=U.length;for(;U.length;){const K=U.pop();(K.d>$.d||!$.d)&&($=K,o&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,q)),K.max-$.d<=t||(k=K.h/2,U.push(new p_(K.p.x-k,K.p.y-k,k,s)),U.push(new p_(K.p.x+k,K.p.y-k,k,s)),U.push(new p_(K.p.x-k,K.p.y+k,k,s)),U.push(new p_(K.p.x+k,K.p.y+k,k,s)),q+=4)}return o&&(console.log(`num probes: ${q}`),console.log(`best distance: ${$.d}`)),$.p}function TU(s,t){return t.max-s.max}class p_{constructor(t,o,u,f){this.p=new rr(t,o),this.h=u,this.d=(function(A,v){let C=!1,P=1/0;for(let k=0;k<v.length;k++){const U=v[k];for(let $=0,q=U.length,K=q-1;$<q;K=$++){const J=U[$],de=U[K];J.y>A.y!=de.y>A.y&&A.x<(de.x-J.x)*(A.y-J.y)/(de.y-J.y)+J.x&&(C=!C),P=Math.min(P,Do(A,J,de))}}return(C?1:-1)*Math.sqrt(P)})(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const EU=Object.keys,mS=Number.POSITIVE_INFINITY,CU=Math.sqrt(2);function PP(s,[t,o]){let u=0,f=0;if(o===mS){t<0&&(t=0);const A=t/CU;switch(s){case"top-right":case"top-left":f=A-7;break;case"bottom-right":case"bottom-left":f=7-A;break;case"bottom":f=7-t;break;case"top":f=t-7}switch(s){case"top-right":case"bottom-right":u=-A;break;case"top-left":case"bottom-left":u=A;break;case"left":u=t;break;case"right":u=-t}}else{switch(t=Math.abs(t),o=Math.abs(o),s){case"top-right":case"top-left":case"top":f=o-7;break;case"bottom-right":case"bottom-left":case"bottom":f=7-o}switch(s){case"top-right":case"bottom-right":case"right":u=-t;break;case"top-left":case"bottom-left":case"left":u=t}}return[u,f]}function M1(s,t,o,u,f,A,v,C,P){if(!t||!t.usvg)return;const k=AP(u),U=AP(f),$=A!=="both"&&A!=="width"||!pP(u)?1:U.width/k.width,q=A!=="both"&&A!=="height"||!mP(u)?1:U.height/k.height;o.scaleSelf($,q);const K=o.toString();v.set(K,o),C.set(K,t);const{imagePosition:J}=dS(K,t,W0);P.set(K,J)}function RP(s,t,o,u,f,A,v,C,P){if(!s)return;const k=(function(U,$,q,K,J,de){if(U.kind==="camera")return U.maxSize;if(U.kind==="composite"){const Ae=$.possiblyEvaluate(new co(U.maxZoom,{worldview:de}),q).evaluate(J,{},q),_e=$.possiblyEvaluate(new co(U.minZoom,{worldview:de}),q).evaluate(J,{},q);return Math.max(Ae,_e)}return $.possiblyEvaluate(new co(K,{worldview:de})).evaluate(J,{},q)})(t,o,u,f,A,P);return s.scaleSelf(k*C*v)}function DP(s,t,o,u,f,A,v,C,P){return{iconPrimary:RP(s.getPrimary(),t,o,u,f,A,v,C,P),iconSecondary:RP(s.getSecondary(),t,o,u,f,A,v,C,P)}}function MU(s,t,o){if(!t)return;const u=o.get(s.toString()),f=o.get(t.toString());u&&f&&(u.paddedRect.w===f.paddedRect.w&&u.paddedRect.h===f.paddedRect.h||Fn(`Mismatch in icon variant sizes: ${s.toString()} and ${t.toString()}`),u.usvg!==f.usvg&&Fn(`Mismatch in icon variant image types: ${s.id} and ${t.id}`))}function OP(s,t,o,u){if(!s)return;const f=t.get(o.toString());if(s.imagePrimary=f,u){const A=t.get(u.toString());s.imageSecondary=A}}function IU(s,t){for(const o in s.horizontal)kP(s.horizontal[o],t);kP(s.vertical,t)}function kP(s,t){if(s){for(const o of s.positionedLines)for(const u of o.positionedGlyphs)if(u.image!==null){const f=u.image.toString();u.rect=t.get(f).paddedRect}}}function AS(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function PU(s,t,o,u,f,A,v,C,P){const k=gS(A.horizontal)||A.vertical,U=o.get("icon-text-fit-padding").evaluate(u,{},f);let $,q=t;return t&&P!=="none"&&(s.allowVerticalPlacement&&A.vertical&&($=dP(t,A.vertical,P,U,C,v)),k&&(q=dP(t,k,P,U,C,v))),{defaultShapedIcon:q,verticallyShapedIcon:$}}function RU(s,t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e,Ie,Pe){let ke=v.textMaxSize.evaluate(t,{},q);ke===void 0?ke=C*v.textScaleFactor:ke*=v.textScaleFactor;const Ye=s.layers[0].layout,Qe=gS(o.horizontal)||o.vertical,tt=K.name==="globe",it=Ns,ct=s.tilePixelRatio*ke/it,$t=(hr=s.overscaling,s.zoom>18&&hr>2&&(hr>>=1),Math.max(mr/(512*hr),1)*Ye.get("symbol-spacing")),mt=Ye.get("text-padding")*s.tilePixelRatio,Wt=Ye.get("icon-padding")*s.tilePixelRatio,sr=ut(Ye.get("text-max-angle")),Kt=Ye.get("icon-rotation-alignment")==="map"&&Pe!=="point",er=$t/2;var hr;s.hasAnyIconTextFit===!1&&Ae!=="none"&&(s.hasAnyIconTextFit=!0);const Nt=t.properties?+t.properties[In]:null,tr=Nt&&s.elevationFeatureIdToIndex?s.elevationFeatureIdToIndex.get(Nt):65535,Mt=(St,pr,cr)=>{if(pr.x<0||pr.x>=mr||pr.y<0||pr.y>=mr)return;let nn=null;if(tt){const{x:kr,y:Xr,z:_r}=K.projectTilePoint(pr.x,pr.y,cr);nn={anchor:new Rm(kr,Xr,_r,0,void 0),up:K.upVector(cr,pr.x,pr.y)}}(function(kr,Xr,_r,en,Cn,Er,Qr,vn,kn,Qn,Vn,jr,Ln,gi,Ne,je,Ct,Ut,Sr,br,Br,un,Kn,Jn,Zn,Xi,Vo,Hn,Co){const no=kr.addToLineVertexArray(Xr,en);let Li,zo,Lo,yo,Mo,io,ei,lo=0,Qo=0,bn=0,Si=0,Bo=-1,na=-1;const Uo={};let Za=Oa("");const uo=_r?_r.anchor:Xr,ja=Hn!=="none";let qc=0,pl=0;if(kn._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Xa=kn.layout.get("text-offset").evaluate(Br,{},Zn);qc=Xa[0]*Ns,pl=Xa[1]*Ns}else qc=kn.layout.get("text-radial-offset").evaluate(Br,{},Zn)*Ns,pl=mS;if(kr.allowVerticalPlacement&&Cn.vertical){const Xa=Cn.vertical;if(Ne)io=_S(Xa),vn&&(ei=_S(vn));else{const hs=kn.layout.get("text-rotate").evaluate(Br,{},Zn)+90;Lo=I1(Qn,uo,Xr,Vn,jr,Ln,Xa,gi,hs,je),vn&&(yo=I1(Qn,uo,Xr,Vn,jr,Ln,vn,Ut,hs))}}if(Er){const Xa=kr.iconSizeData,hs=kn.layout.get("icon-rotate").evaluate(Br,{},Zn),ml=MP(Er,hs,Kn,ja,un.iconScaleFactor),Kl=vn?MP(vn,hs,Kn,ja,un.iconScaleFactor):void 0;zo=I1(Qn,uo,Xr,Vn,jr,Ln,Er,Ut,hs,null),lo=4*ml.length;let Ll=null;Xa.kind==="source"?(Ll=[Dp*kn.layout.get("icon-size").evaluate(Br,{},Zn)*un.iconScaleFactor],Ll[0]>WA&&Fn(`${kr.layerIds[0]}: Value for "icon-size" is >= ${Xy}. Reduce your "icon-size".`)):Xa.kind==="composite"&&(Ll=[Dp*un.compositeIconSizes[0].evaluate(Br,{},Zn)*un.iconScaleFactor,Dp*un.compositeIconSizes[1].evaluate(Br,{},Zn)*un.iconScaleFactor],(Ll[0]>WA||Ll[1]>WA)&&Fn(`${kr.layerIds[0]}: Value for "icon-size" is >= ${Xy}. Reduce your "icon-size".`)),kr.addSymbols(kr.icon,ml,Ll,br,Sr,Br,void 0,_r,Xr,no.lineStartIndex,no.lineLength,-1,Jn,Zn,Xi,Vo),Bo=kr.icon.placedSymbolArray.length-1,Kl&&(Qo=4*Kl.length,kr.addSymbols(kr.icon,Kl,Ll,br,Sr,Br,ju.vertical,_r,Xr,no.lineStartIndex,no.lineLength,-1,Jn,Zn,Xi,Vo),na=kr.icon.placedSymbolArray.length-1)}for(const Xa in Cn.horizontal){const hs=Xa,ml=Cn.horizontal[hs];Li||(Za=Oa(ml.text),Ne?Mo=_S(ml):Li=I1(Qn,uo,Xr,Vn,jr,Ln,ml,gi,kn.layout.get("text-rotate").evaluate(Br,{},Zn),je));const Kl=ml.positionedLines.length===1;if(bn+=zP(kr,_r,Xr,ml,Qr,kn,Ne,Br,je,no,Cn.vertical?ju.horizontal:ju.horizontalOnly,Kl?EU(Cn.horizontal):[hs],Uo,Bo,un,Jn,Zn,Xi),Kl)break}Cn.vertical&&(Si+=zP(kr,_r,Xr,Cn.vertical,Qr,kn,Ne,Br,je,no,ju.vertical,["vertical"],Uo,na,un,Jn,Zn,Xi));let Qs=-1;const Wc=(Xa,hs)=>Xa?Math.max(Xa,hs):hs;Qs=Wc(Mo,Qs),Qs=Wc(io,Qs),Qs=Wc(ei,Qs);const Op=Qs>-1?1:0;kr.glyphOffsetArray.length>=65535&&Fn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Br.sortKey!==void 0&&kr.addToSortKeyRanges(kr.symbolInstances.length,Br.sortKey),kr.symbolInstances.emplaceBack(Xr.x,Xr.y,uo.x,uo.y,uo.z,Uo.right>=0?Uo.right:-1,Uo.center>=0?Uo.center:-1,Uo.left>=0?Uo.left:-1,Uo.vertical>=0?Uo.vertical:-1,Bo,na,Za,Li!==void 0?Li:kr.collisionBoxArray.length,Li!==void 0?Li+1:kr.collisionBoxArray.length,Lo!==void 0?Lo:kr.collisionBoxArray.length,Lo!==void 0?Lo+1:kr.collisionBoxArray.length,zo!==void 0?zo:kr.collisionBoxArray.length,zo!==void 0?zo+1:kr.collisionBoxArray.length,yo||kr.collisionBoxArray.length,yo?yo+1:kr.collisionBoxArray.length,Vn,bn,Si,lo,Qo,Op,0,qc,pl,Qs,0,ja?1:0,Co)})(s,pr,nn,St,o,u,A,f,s.layers[0],s.collisionBoxArray,t.index,t.sourceLayerIndex,s.index,mt,Ie,k,0,Wt,Kt,_e,t,v,U,$,q,J,de,Ae,tr)};if(Pe==="line")for(const St of X(t.geometry,0,0,mr,mr)){const pr=bU(St,$t,sr,o.vertical||Qe,u,it,ct,s.overscaling,mr);for(const cr of pr)Qe&&DU(s,Qe.text,er,cr)||Mt(St,cr,q)}else if(Pe==="line-center"){for(const St of t.geometry)if(St.length>1){const pr=xU(St,sr,o.vertical||Qe,u,it,ct);pr&&Mt(St,pr,q)}}else if(t.type==="Polygon")for(const St of Ql(t.geometry,0)){const pr=SU(St,16);Mt(St[0],new Rm(pr.x,pr.y,0,0,void 0),q)}else if(t.type==="LineString")for(const St of t.geometry)Mt(St,new Rm(St[0].x,St[0].y,0,0,void 0),q);else if(t.type==="Point")for(const St of t.geometry)for(const pr of St)Mt([pr],new Rm(pr.x,pr.y,0,0,void 0),q)}const Xy=255,WA=Xy*Dp;function zP(s,t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae,_e){const Ie=(function(Ye,Qe,tt,it,ct,$t,mt,Wt){const sr=[];if(Qe.positionedLines.length===0)return sr;const Kt=it.layout.get("text-rotate").evaluate($t,{})*Math.PI/180,er=(function(St){const pr=St[0],cr=St[1],nn=pr*cr;return nn>0?[pr,-cr]:nn<0?[-pr,cr]:pr===0?[cr,pr]:[cr,-pr]})(tt);let hr=Math.abs(Qe.top-Qe.bottom);for(const St of Qe.positionedLines)hr-=St.lineOffset;const Nt=Qe.positionedLines.length,tr=hr/Nt;let Mt=Qe.top-tt[1];for(let St=0;St<Nt;++St){const pr=Qe.positionedLines[St];Mt=wU(Qe,tr,Mt,St);for(const cr of pr.positionedGlyphs){if(!cr.rect)continue;const nn=cr.rect||{};let kr=aP+1,Xr=!0,_r=1,en=0;if(cr.image){const Br=mt.get(cr.image.toString());if(!Br)continue;if(Br.sdf){Fn("SDF images are not supported in formatted text and will be ignored.");continue}Xr=!1,_r=Br.pixelRatio,kr=W0/_r}const Cn=(ct||Wt)&&cr.vertical,Er=cr.metrics.advance*cr.scale/2,Qr=cr.metrics,vn=cr.rect;if(vn===null)continue;Wt&&Qe.verticalizable&&(en=cr.image?Er-cr.metrics.width*cr.scale/2:0);const kn=ct?[cr.x+Er,cr.y]:[0,0];let Qn=[0,0],Vn=[0,0],jr=!1;ct||(Cn?(Vn=[cr.x+Er+er[0],cr.y+er[1]-en],jr=!0):Qn=[cr.x+Er+tt[0],cr.y+tt[1]-en]);const Ln=vn.w*cr.scale/(_r*(cr.localGlyph?Ud:1)),gi=vn.h*cr.scale/(_r*(cr.localGlyph?Ud:1));let Ne,je,Ct,Ut;if(Cn){const Br=cr.y-Mt,un=new rr(-Er,Er-Br),Kn=-Math.PI/2,Jn=new rr(...Vn);Ne=new rr(-Er+Qn[0],Qn[1]),Ne._rotateAround(Kn,un)._add(Jn),Ne.x+=-Br+Er,Ne.y-=(Qr.left-kr)*cr.scale;const Zn=cr.image?Qr.advance*cr.scale:Ns*cr.scale,Xi=String.fromCodePoint(cr.glyph);iU(Xi)?Ne.x+=(1-kr)*cr.scale:oU(Xi)?Ne.x+=Zn-Qr.height*cr.scale+(-kr-1)*cr.scale:Ne.x+=cr.image||Qr.width+2*kr===vn.w&&Qr.height+2*kr===vn.h?(Zn-gi)/2:(Zn-(Qr.height+2*kr)*cr.scale)/2,je=new rr(Ne.x,Ne.y-Ln),Ct=new rr(Ne.x+gi,Ne.y),Ut=new rr(Ne.x+gi,Ne.y-Ln)}else{const Br=(Qr.left-kr)*cr.scale-Er+Qn[0],un=(-Qr.top-kr)*cr.scale+Qn[1],Kn=Br+Ln,Jn=un+gi;Ne=new rr(Br,un),je=new rr(Kn,un),Ct=new rr(Br,Jn),Ut=new rr(Kn,Jn)}if(Kt){let Br;Br=ct?new rr(0,0):jr?new rr(er[0],er[1]):new rr(tt[0],tt[1]),Ne._rotateAround(Kt,Br),je._rotateAround(Kt,Br),Ct._rotateAround(Kt,Br),Ut._rotateAround(Kt,Br)}const Sr=new rr(0,0),br=new rr(0,0);sr.push({tl:Ne,tr:je,bl:Ct,br:Ut,texPrimary:nn,texSecondary:void 0,writingMode:Qe.writingMode,glyphOffset:kn,sectionIndex:cr.sectionIndex,isSDF:Xr,pixelOffsetTL:Sr,pixelOffsetBR:br,minFontScaleX:0,minFontScaleY:0})}}return sr})(0,u,P,A,v,C,f,s.allowVerticalPlacement),Pe=s.textSizeData;let ke=null;Pe.kind==="source"?(ke=[Dp*A.layout.get("text-size").evaluate(C,{},Ae)*J.textScaleFactor],ke[0]>WA&&Fn(`${s.layerIds[0]}: Value for "text-size" is >= ${Xy}. Reduce your "text-size".`)):Pe.kind==="composite"&&(ke=[Dp*J.compositeTextSizes[0].evaluate(C,{},Ae)*J.textScaleFactor,Dp*J.compositeTextSizes[1].evaluate(C,{},Ae)*J.textScaleFactor],(ke[0]>WA||ke[1]>WA)&&Fn(`${s.layerIds[0]}: Value for "text-size" is >= ${Xy}. Reduce your "text-size".`)),s.addSymbols(s.text,Ie,ke,P,v,C,U,t,o,k.lineStartIndex,k.lineLength,K,de,Ae,_e,!1);for(const Ye of $)q[Ye]=s.text.placedSymbolArray.length-1;return 4*Ie.length}function gS(s){for(const t in s)return s[t];return null}function I1(s,t,o,u,f,A,v,C,P,k){let U=v.top,$=v.bottom,q=v.left,K=v.right;if(fP(v)&&v.collisionPadding){const J=v.collisionPadding;q-=J[0],U-=J[1],K+=J[2],$+=J[3]}if(P){const J=new rr(q,U),de=new rr(K,U),Ae=new rr(q,$),_e=new rr(K,$),Ie=ut(P);let Pe=new rr(0,0);k&&(Pe=new rr(k[0],k[1])),J._rotateAround(Ie,Pe),de._rotateAround(Ie,Pe),Ae._rotateAround(Ie,Pe),_e._rotateAround(Ie,Pe),q=Math.min(J.x,de.x,Ae.x,_e.x),K=Math.max(J.x,de.x,Ae.x,_e.x),U=Math.min(J.y,de.y,Ae.y,_e.y),$=Math.max(J.y,de.y,Ae.y,_e.y)}return s.emplaceBack(t.x,t.y,t.z,o.x,o.y,q,U,K,$,C,u,f,A),s.length-1}function _S(s){fP(s)&&s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const t=s.bottom-s.top;return t>0?Math.max(10,t):null}function DU(s,t,o,u){const f=s.compareText;if(t in f){const A=f[t];for(let v=A.length-1;v>=0;v--)if(u.dist(A[v])<o)return!0}else f[t]=[];return f[t].push(u),!1}function LP(s,t){const o=s.fovAboveCenter,u=s.elevation?s.elevation.getMinElevationBelowMSL()*t:0,f=(s._camera.position[2]*s.worldSize-u)/Math.cos(s._pitch),A=Math.sin(o)*f/Math.sin(Math.max(Math.PI/2-s._pitch-o,.01));let v=Math.sin(s._pitch)*A+f;const C=f*(1/s._horizonShift);if(!s.elevation||s.elevation.exaggeration()===0){let P=Math.max(s.zoom-17,0);s.isOrthographic&&(P/=10),v*=1+P}return Math.min(1.01*v,C)}function Yy(s,t){if(!t.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:t};const o=Math.pow(2,-s.z),u=s.x*o,f=(s.x+1)*o,A=s.y*o,v=(s.y+1)*o,C=Ze(u),P=Ze(f),k=$e(A),U=$e(v),$=t.project(C,k),q=t.project(P,k),K=t.project(P,U),J=t.project(C,U);let de=Math.min($.x,q.x,K.x,J.x),Ae=Math.min($.y,q.y,K.y,J.y),_e=Math.max($.x,q.x,K.x,J.x),Ie=Math.max($.y,q.y,K.y,J.y);const Pe=o/16;function ke(Qe,tt,it,ct,$t,mt){const Wt=(it+$t)/2,sr=(ct+mt)/2,Kt=t.project(Ze(Wt),$e(sr)),er=Math.max(0,de-Kt.x,Ae-Kt.y,Kt.x-_e,Kt.y-Ie);de=Math.min(de,Kt.x),_e=Math.max(_e,Kt.x),Ae=Math.min(Ae,Kt.y),Ie=Math.max(Ie,Kt.y),er>Pe&&(ke(Qe,Kt,it,ct,Wt,sr),ke(Kt,tt,Wt,sr,$t,mt))}ke($,q,u,A,f,A),ke(q,K,f,A,f,v),ke(K,J,f,v,u,v),ke(J,$,u,v,u,A),de-=Pe,Ae-=Pe,_e+=Pe,Ie+=Pe;const Ye=1/Math.max(_e-de,Ie-Ae);return{scale:Ye,x:de*Ye,y:Ae*Ye,x2:_e*Ye,y2:Ie*Ye,projection:t}}function BP(s,{x:t,y:o},u=0){return new rr(((t-u)*s.scale-s.x)*mr,(o*s.scale-s.y)*mr)}const OU=oe(new Float32Array(16));class ZA{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,o){return{x:0,y:0,z:0}}unproject(t,o){return new he(0,0)}projectTilePoint(t,o,u){return{x:t,y:o,z:0}}locationPoint(t,o,u,f=!0){return t._coordinatePoint(t.locationCoordinate(o,u),f)}pixelsPerMeter(t,o){return Ue(1,t)*o}pixelSpaceConversion(t,o,u){return 1}farthestPixelDistance(t){return LP(t,t.pixelsPerMeter)}pointCoordinate(t,o,u,f){const A=t.horizonLineFromTop(!1),v=new rr(o,Math.max(A,u));return t.rayIntersectionCoordinate(t.pointRayIntersection(v,f))}pointCoordinate3D(t,o,u){const f=new rr(o,u);if(t.elevation)return t.elevation.pointCoordinate(f);{const A=this.pointCoordinate(t,f.x,f.y,0);return[A.x,A.y,A.z]}}isPointAboveHorizon(t,o){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,o.x,o.y);const u=t.horizonLineFromTop();return o.y<u}createInversionMatrix(t,o){return OU}createTileMatrix(t,o,u){let f,A,v;const C=u.canonical,P=oe(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=Yy(C,this);f=1,A=k.x+u.wrap*k.scale,v=k.y,ve(P,P,[f/k.scale,f/k.scale,t.pixelsPerMeter/o])}else f=o/t.zoomScale(C.z),A=(C.x+Math.pow(2,C.z)*u.wrap)*f,v=C.y*f;return we(P,P,[A,v,0]),ve(P,P,[f/mr,f/mr,1]),P}upVector(t,o,u){return[0,0,1]}upVectorScale(t,o,u){return{metersToTile:1}}}class kU extends ZA{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[o,u]=this.parallels=t.parallels||[29.5,45.5],f=Math.sin(ut(o));this.n=(f+Math.sin(ut(u)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(t,o){const{n:u,c:f,r0:A}=this,v=ut(t-this.center[0]),C=ut(o),P=Math.sqrt(f-2*u*Math.sin(C))/u;return{x:P*Math.sin(v*u),y:P*Math.cos(v*u)-A,z:0}}unproject(t,o){const{n:u,c:f,r0:A}=this,v=A+o;let C=Math.atan2(t,Math.abs(v))*Math.sign(v);v*u<0&&(C-=Math.PI*Math.sign(t)*Math.sign(v));const P=ut(this.center[0])*u;C=Je(C,-Math.PI-P,Math.PI-P);const k=ce(le(C/u)+this.center[0],-180,180),U=Math.asin(ce((f-(t*t+v*v)*u*u)/(2*u),-1,1)),$=ce(le(U),-We,We);return new he(k,$)}}const Qy=1.340264,Ky=-.081106,Jy=893e-6,ev=.003796,P1=Math.sqrt(3)/2;class zU extends ZA{project(t,o){o=o/180*Math.PI,t=t/180*Math.PI;const u=Math.asin(P1*Math.sin(o)),f=u*u,A=f*f*f;return{x:.5*(t*Math.cos(u)/(P1*(Qy+3*Ky*f+A*(7*Jy+9*ev*f)))/Math.PI+.5),y:1-.5*(u*(Qy+Ky*f+A*(Jy+ev*f))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,f=u*u,A=f*f*f;for(let U,$,q,K=0;K<12&&($=u*(Qy+Ky*f+A*(Jy+ev*f))-o,q=Qy+3*Ky*f+A*(7*Jy+9*ev*f),U=$/q,u=ce(u-U,-Math.PI/3,Math.PI/3),f=u*u,A=f*f*f,!(Math.abs(U)<1e-12));++K);const v=P1*t*(Qy+3*Ky*f+A*(7*Jy+9*ev*f))/Math.cos(u),C=Math.asin(Math.sin(u)/P1),P=ce(180*v/Math.PI,-180,180),k=ce(180*C/Math.PI,-We,We);return new he(P,k)}}class LU extends ZA{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){return{x:.5+t/360,y:.5-o/360,z:0}}unproject(t,o){const u=360*(t-.5),f=ce(360*(.5-o),-We,We);return new he(u,f)}}const m_=Math.PI/2;function R1(s){return Math.tan((m_+s)/2)}class BU extends ZA{constructor(t){super(t),this.center=t.center||[0,30];const[o,u]=this.parallels=t.parallels||[30,30];let f=ut(o),A=ut(u);this.southernCenter=f+A<0,this.southernCenter&&(f=-f,A=-A);const v=Math.cos(f),C=R1(f);this.n=f===A?Math.sin(f):Math.log(v/Math.cos(A))/Math.log(R1(A)/C),this.f=v*Math.pow(R1(f),this.n)/this.n}project(t,o){o=ut(o),this.southernCenter&&(o=-o),t=ut(t-this.center[0]);const u=1e-6,{n:f,f:A}=this;A>0?o<-m_+u&&(o=-m_+u):o>m_-u&&(o=m_-u);const v=A/Math.pow(R1(o),f);let C=v*Math.sin(f*t),P=A-v*Math.cos(f*t);return C=.5*(C/Math.PI+.5),P=.5*(P/Math.PI+.5),{x:C,y:this.southernCenter?P:1-P,z:0}}unproject(t,o){t=(2*t-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:u,f}=this,A=f-o,v=Math.sign(A),C=Math.sign(u)*Math.sqrt(t*t+A*A);let P=Math.atan2(t,Math.abs(A))*v;A*u<0&&(P-=Math.PI*Math.sign(t)*v);const k=ce(le(P/u)+this.center[0],-180,180),U=ce(le(2*Math.atan(Math.pow(f/C,1/u))-m_),-We,We);return new he(k,this.southernCenter?-U:U)}}class FP extends ZA{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,o){return{x:Le(t),y:Ge(o),z:0}}unproject(t,o){const u=Ze(t),f=$e(o);return new he(u,f)}}const NP=ut(We);class FU extends ZA{project(t,o){const u=(o=ut(o))*o,f=u*u;return{x:.5*((t=ut(t))*(.8707-.131979*u+f*(f*(.003971*u-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+u*(.015085+f*(.028874*u-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,f=25,A=0,v=u*u;do{v=u*u;const k=v*v;A=(u*(1.007226+v*(.015085+k*(.028874*v-.044475-.005916*k)))-o)/(1.007226+v*(.045255+k*(.259866*v-.311325-.005916*11*k))),u=ce(u-A,-NP,NP)}while(Math.abs(A)>1e-6&&--f>0);v=u*u;const C=ce(le(t/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),P=le(u);return new he(C,P)}}const jP=ut(We);class NU extends ZA{project(t,o){o=ut(o),t=ut(t);const u=Math.cos(o),f=2/Math.PI,A=Math.acos(u*Math.cos(t/2)),v=Math.sin(A)/A,C=.5*(t*f+2*u*Math.sin(t/2)/v)||0,P=.5*(o+Math.sin(o)/v)||0;return{x:.5*(C/Math.PI+.5),y:1-.5*(P/Math.PI+1),z:0}}unproject(t,o){let u=t=(2*t-.5)*Math.PI,f=o=(2*(1-o)-1)*Math.PI,A=25;const v=1e-6;let C=0,P=0;do{const k=Math.cos(f),U=Math.sin(f),$=2*U*k,q=U*U,K=k*k,J=Math.cos(u/2),de=Math.sin(u/2),Ae=2*J*de,_e=de*de,Ie=1-K*J*J,Pe=Ie?1/Ie:0,ke=Ie?Math.acos(k*J)*Math.sqrt(1/Ie):0,Ye=.5*(2*ke*k*de+2*u/Math.PI)-t,Qe=.5*(ke*U+f)-o,tt=.5*Pe*(K*_e+ke*k*J*q)+1/Math.PI,it=Pe*(Ae*$/4-ke*U*de),ct=.125*Pe*($*de-ke*U*K*Ae),$t=.5*Pe*(q*J+ke*_e*k)+.5,mt=it*ct-$t*tt;C=(Qe*it-Ye*$t)/mt,P=(Ye*ct-Qe*tt)/mt,u=ce(u-C,-Math.PI,Math.PI),f=ce(f-P,-jP,jP)}while((Math.abs(C)>v||Math.abs(P)>v)&&--A>0);return new he(le(u),le(f))}}class UP extends ZA{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ut(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){const{scale:u,cosPhi:f}=this;return{x:ut(t)*f*u+.5,y:-Math.sin(ut(o))/f*u+.5,z:0}}unproject(t,o){const{scale:u,cosPhi:f}=this,A=-(o-.5)/u,v=ce(le((t-.5)/u)/f,-180,180),C=Math.asin(ce(A*f,-1,1)),P=ce(le(C),-We,We);return new he(v,P)}}class jU extends FP{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,o,u){const f=Gc(t,o,u);return Gr(f,f,P0(Fu(u))),{x:f[0],y:f[1],z:f[2]}}locationPoint(t,o,u){const f=Y(o.lat,o.lng),A=Hr([],f),v=u?t._centerAltitude+u:t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(o),t._centerAltitude):t._centerAltitude;Jt(f,f,A,Ue(1,0)*mr*v);const C=oe(new Float64Array(16));return ye(C,t.pixelMatrix,t.globeMatrix),Gr(f,f,C),new rr(f[0],f[1])}pixelsPerMeter(t,o){return Ue(1,0)*o}pixelSpaceConversion(t,o,u){const f=Ue(1,t)*o,A=hn(Ue(1,45)*o,f,u);return this.pixelsPerMeter(t,o)/A}createTileMatrix(t,o,u){const f=Vg(Fu(u.canonical));return ye(new Float64Array(16),t.globeMatrix,f)}createInversionMatrix(t,o){const{center:u}=t,f=P0(Fu(o));return Ee(f,f,ut(u.lng)),Ce(f,f,ut(u.lat)),ve(f,f,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(t,o,u,f){return jx(t,o,u,!0)||new It(0,0)}pointCoordinate3D(t,o,u){const f=this.pointCoordinate(t,o,u,0);return[f.x,f.y,f.z]}isPointAboveHorizon(t,o){return!jx(t,o.x,o.y,!1)}farthestPixelDistance(t){const o=(function(f,A){const v=f.cameraToCenterDistance,C=f._centerAltitude*A,P=f._camera,k=f._camera.forward(),U=et([],Vt([],k,-v),[0,0,C]),$=f.worldSize/(2*Math.PI),q=[0,0,-$],K=f.width/f.height,J=Math.tan(f.fovAboveCenter),de=Vt([],P.up(),J),Ae=Vt([],P.right(),J*K),_e=Hr([],et([],et([],k,de),Ae)),Ie=[];let Pe;if(new Ai(U,_e).closestPointOnSphere(q,$,Ie)){const ke=et([],Ie,q),Ye=Rn([],ke,U);Pe=Math.cos(f.fovAboveCenter)*Pt(Ye)}else{const ke=Rn([],U,q),Ye=Rn([],q,U);Hr(Ye,Ye);const Qe=Pt(ke)-$;Pe=Math.sqrt(Qe*(Qe+2*$));const tt=Math.acos(Pe/($+Qe))-Math.acos(Nn(k,Ye));Pe*=Math.cos(tt)}return 1.01*Pe})(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),u=Jf(t.zoom);if(u>0){const f=LP(t,Ue(1,t.center.lat)*t.worldSize),A=t.worldSize/(2*Math.PI),v=Math.max(t.width,t.height)/t.worldSize*Math.PI;return hn(o,f+A*(1-Math.cos(v)),Math.pow(u,10))}return o}upVector(t,o,u){return Gc(o,u,t,1)}upVectorScale(t){return{metersToTile:jg(Mp(Fu(t)))}}}function VP(s){const t=s.parallels,o=!!t&&Math.abs(t[0]+t[1])<.01;switch(s.name){case"mercator":return new FP(s);case"equirectangular":return new LU(s);case"naturalEarth":return new FU(s);case"equalEarth":return new zU(s);case"winkelTripel":return new NU(s);case"albers":return o?new UP(s):new kU(s);case"lambertConformalConic":return o?new UP(s):new BU(s);case"globe":return new jU(s)}throw new Error(`Invalid projection name: ${s.name}`)}const UU=Xt.types,VU=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function D1(s,t,o,u,f,A,v,C,P,k,U,$,q){const K=C?Math.min(WA,Math.round(C[0])):0,J=C?Math.min(WA,Math.round(C[1])):0;s.emplaceBack(t,o,Math.round(32*u),Math.round(32*f),A,v,(K<<1)+(P?1:0),J,16*k,16*U,256*$,256*q)}function O1(s,t,o){s.emplaceBack(t,o)}function k1(s,t,o,u,f,A,v){s.emplaceBack(t,o,u,f,A,v)}const z1=(s,t,o,u)=>{for(let f=0;f<t;f++)s.emplaceBack(o[0],o[1],o[2],u[0],u[1],u[2])};function L1(s,t,o,u,f){s.emplaceBack(t,o,u,f),s.emplaceBack(t,o,u,f),s.emplaceBack(t,o,u,f),s.emplaceBack(t,o,u,f)}function $U(s){for(const t of s.sections)if(Pg(t.text))return!0;return!1}class yS{constructor(t){this.layoutVertexArray=new _A,this.indexArray=new ea,this.programConfigurations=t,this.segments=new No,this.dynamicLayoutVertexArray=new Ss,this.opacityVertexArray=new Ra,this.placedSymbolArray=new Am,this.iconTransitioningVertexArray=new ha,this.globeExtVertexArray=new _h,this.zOffsetVertexArray=new Uc,this.orientationVertexArray=new vp}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,o,u,f,A){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Zj.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Yj.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,VU,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,Jj.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Xj.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||A)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,Qj.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=t.createVertexBuffer(this.orientationVertexArray,Kj.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Rr(yS,"SymbolBuffers");class vS{constructor(t,o,u){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new u,this.segments=new No,this.collisionVertexArray=new vA,this.collisionVertexArrayExt=new Ss}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,eU.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,tU.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Rr(vS,"CollisionBuffers");class B1{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((v=>v.fqid)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=oe([]),this.placementViewportMatrix=oe([]);const o=this.layers[0]._unevaluatedLayout._values;this.worldview=t.worldview,this.textSizeData=gP(this.zoom,o["text-size"],this.worldview),this.iconSizeData=gP(this.zoom,o["icon-size"],this.worldview);const u=this.layers[0].layout,f=u.get("symbol-sort-key"),A=u.get("symbol-z-order");this.lut=t.lut,this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=A!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(A==="viewport-y"||A==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map((v=>ju[v])),this.stateDependentLayerIds=this.layers.filter((v=>v.isStateDependent())).map((v=>v.id)),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new yS(new Ts(this.layers,{zoom:this.zoom,lut:this.lut},(t=>t.startsWith("text")||t.startsWith("symbol")))),this.icon=new yS(new Ts(this.layers,{zoom:this.zoom,lut:this.lut},(t=>t.startsWith("icon")||t.startsWith("symbol")))),this.glyphOffsetArray=new w0,this.lineVertexArray=new S0,this.symbolInstances=new TA}calculateGlyphDependencies(t,o,u,f,A){for(const v of t){const C=v.codePointAt(0);if(C===void 0)break;if(o[C]=!0,f&&A&&C<=65535){const P=Gy[v];P&&(o[P.charCodeAt(0)]=!0)}}}updateFootprints(t,o){}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!Rp(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(t,o,u,f){const A=this.layers[0],v=A.layout,C=this.projection.name==="globe",P=v.get("text-font"),k=v.get("text-field"),U=v.get("icon-image"),[$,q]=v.get("icon-size-scale-range"),K=ce(o.scaleFactor||1,$,q),J=(k.value.kind!=="constant"||k.value.value instanceof cs&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(P.value.kind!=="constant"||P.value.value.length>0),de=U.value.kind!=="constant"||!!U.value.value||Object.keys(U.parameters).length>0,Ae=v.get("symbol-sort-key");if(this.features=[],!J&&!de)return;const _e=o.iconDependencies,Ie=o.glyphDependencies,Pe=o.availableImages,ke=new co(this.zoom,{worldview:this.worldview});for(const{feature:Ye,id:Qe,index:tt,sourceLayerIndex:it}of t){const ct=A._featureFilter.needGeometry,$t=Ht(Ye,ct);if(!A._featureFilter.filter(ke,$t,u))continue;if(ct||($t.geometry=ar(Ye,u,f)),C&&Ye.type!==1&&u.z<=5){const er=$t.geometry,hr=.98078528056,Nt=(tr,Mt)=>Nn(Gc(tr.x,tr.y,u,1),Gc(Mt.x,Mt.y,u,1))<hr;for(let tr=0;tr<er.length;tr++)er[tr]=zt(er[tr],Nt)}let mt,Wt;if(J){const er=A.getValueAndResolveTokens("text-field",$t,u,Pe),hr=cs.factory(er);$U(hr)&&(this.hasRTLText=!0),(!this.hasRTLText||am()==="unavailable"||this.hasRTLText&&Ru.isParsed())&&(mt=nU(hr,A,$t))}if(de){const er=A.getValueAndResolveTokens("icon-image",$t,u,Pe);Wt=typeof er=="string"?Is.build(er):er}if(!mt&&!Wt)continue;const sr=this.sortFeaturesByKey?Ae.evaluate($t,{},u):void 0,Kt={id:Qe,text:mt,icon:Wt,index:tt,sourceLayerIndex:it,geometry:$t.geometry,properties:Ye.properties,type:UU[Ye.type],sortKey:sr};if(this.features.push(Kt),Wt){const er=this.layers[0]._unevaluatedLayout._values,{iconPrimary:hr,iconSecondary:Nt}=DP(Wt,this.iconSizeData,er["icon-size"],u,this.zoom,Kt,this.pixelRatio,K,this.worldview),tr=hr.id.toString();if(_e.has(tr)?_e.get(tr).push(hr):_e.set(tr,[hr]),Nt){this.hasAnySecondaryIcon=!0;const Mt=Nt.id.toString();_e.has(Mt)?_e.get(Mt).push(Nt):_e.set(Mt,[Nt])}}if(mt){const er=P.evaluate($t,{},u).join(","),hr=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ju.vertical)>=0;for(const Nt of mt.sections)if(Nt.image){const tr=Nt.image.getPrimary().scaleSelf(this.pixelRatio),Mt=tr.id.toString(),St=_e.get(Mt)||[];St.push(tr),_e.set(Mt,St)}else{const tr=om(mt.toString()),Mt=Nt.fontStack||er,St=Ie[Mt]=Ie[Mt]||{};this.calculateGlyphDependencies(Nt.text,St,hr,this.allowVerticalPlacement,tr)}}}if(v.get("symbol-placement")==="line"&&(this.features=(function(Ye){const Qe={},tt={},it=[];let ct=0;function $t(Kt){it.push(Ye[Kt]),ct++}function mt(Kt,er,hr){const Nt=tt[Kt];return delete tt[Kt],tt[er]=Nt,it[Nt].geometry[0].pop(),it[Nt].geometry[0]=it[Nt].geometry[0].concat(hr[0]),Nt}function Wt(Kt,er,hr){const Nt=Qe[er];return delete Qe[er],Qe[Kt]=Nt,it[Nt].geometry[0].shift(),it[Nt].geometry[0]=hr[0].concat(it[Nt].geometry[0]),Nt}function sr(Kt,er,hr){const Nt=hr?er[0][er[0].length-1]:er[0][0];return`${Kt}:${Nt.x}:${Nt.y}`}for(let Kt=0;Kt<Ye.length;Kt++){const er=Ye[Kt],hr=er.geometry,Nt=er.text?er.text.toString():null;if(!Nt){$t(Kt);continue}const tr=sr(Nt,hr),Mt=sr(Nt,hr,!0);if(tr in tt&&Mt in Qe&&tt[tr]!==Qe[Mt]){const St=Wt(tr,Mt,hr),pr=mt(tr,Mt,it[St].geometry);delete Qe[tr],delete tt[Mt],tt[sr(Nt,it[pr].geometry,!0)]=pr,it[St].geometry=null}else tr in tt?mt(tr,Mt,hr):Mt in Qe?Wt(tr,Mt,hr):($t(Kt),Qe[tr]=ct-1,tt[Mt]=ct-1)}return it.filter((Kt=>Kt.geometry))})(this.features)),v.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",o.elevationFeatures){!this.elevationFeatures&&o.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const Ye of o.elevationFeatures)this.elevationFeatureIdToIndex.set(Ye.id,this.elevationFeatures.length),this.elevationFeatures.push(Ye)}}else v.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort(((Ye,Qe)=>Ye.sortKey-Qe.sortKey))}update(t,o,u,f,A,v,C){this.text.programConfigurations.updatePaintArrays(t,o,A,u,f,v,C,this.worldview),this.icon.programConfigurations.updatePaintArrays(t,o,A,u,f,v,C,this.worldview)}updateRoadElevation(t){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;const u=_t(t),f=1/u;let A=!1,v=!1;for(let C=0;C<this.symbolInstances.length;C++){const P=this.symbolInstances.get(C),k=wt(1,0,0),U=wt(0,1,0),{numHorizontalGlyphVertices:$,numVerticalGlyphVertices:q,numIconVertices:K,numVerticalIconVertices:J}=P,de=$>0||q>0,Ae=K>0,_e=this.elevationFeatures[P.elevationFeatureIndex];if(_e){const Ie=new rr(P.tileAnchorX,P.tileAnchorY),Pe=.075+_e.pointElevation(Ie);P.zOffset!==Pe&&(o=!0,P.zOffset=Pe);const ke=_e.computeSlopeNormal(Ie,f),Ye=Va(Bn(),wt(0,0,1),ke);Tr(k,k,Ye),Tr(U,U,Ye),k[2]*=u,U[2]*=u,k[0]===1&&k[1]===0&&k[2]===0&&U[0]===0&&U[1]===1&&U[2]===0||(A=A||de,v=v||Ae)}if(de&&(z1(this.text.orientationVertexArray,$,k,U),z1(this.text.orientationVertexArray,q,k,U)),Ae){const{placedIconSymbolIndex:Ie,verticalPlacedIconSymbolIndex:Pe}=P;Ie>=0&&z1(this.icon.orientationVertexArray,K,k,U),Pe>=0&&z1(this.icon.orientationVertexArray,J,k,U)}}A||(this.text.orientationVertexArray=void 0),v||(this.icon.orientationVertexArray=void 0),o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const t=(A,v,C)=>{u+=v,u>A.length&&A.resize(u);for(let P=-v;P<0;P++)A.emplace(P+u,C)},o=(A,v,C)=>{f+=v,f>A.length&&A.resize(f);for(let P=-v;P<0;P++)A.emplace(P+f,C)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,f=0;for(let A=0;A<this.symbolInstances.length;A++){const v=this.symbolInstances.get(A),{numHorizontalGlyphVertices:C,numVerticalGlyphVertices:P,numIconVertices:k}=v,U=v.zOffset,$=k>0;if((C>0||P>0)&&(t(this.text.zOffsetVertexArray,C,U),t(this.text.zOffsetVertexArray,P,U)),$){const{placedIconSymbolIndex:q,verticalPlacedIconSymbolIndex:K}=v;q>=0&&o(this.icon.zOffsetVertexArray,k,U),K>=0&&o(this.icon.zOffsetVertexArray,v.numVerticalIconVertices,U)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=VP(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const u=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:f,y:A}of o)this.lineVertexArray.emplaceBack(f,A);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(t,o,u,f,A,v,C,P,k,U,$,q,K,J,de,Ae){const _e=t.indexArray,Ie=t.layoutVertexArray,Pe=t.globeExtVertexArray,ke=t.segments.prepareSegment(4*o.length,Ie,_e,this.canOverlap?v.sortKey:void 0),Ye=this.glyphOffsetArray.length,Qe=ke.vertexLength,tt=this.allowVerticalPlacement&&C===ju.vertical?Math.PI/2:0,it=v.text&&v.text.sections;for(let $t=0;$t<o.length;$t++){const{tl:mt,tr:Wt,bl:sr,br:Kt,texPrimary:er,texSecondary:hr,pixelOffsetTL:Nt,pixelOffsetBR:tr,minFontScaleX:Mt,minFontScaleY:St,glyphOffset:pr,isSDF:cr,sectionIndex:nn}=o[$t],kr=ke.vertexLength,Xr=pr[1];if(D1(Ie,k.x,k.y,mt.x,Xr+mt.y,er.x,er.y,u,cr,Nt.x,Nt.y,Mt,St),D1(Ie,k.x,k.y,Wt.x,Xr+Wt.y,er.x+er.w,er.y,u,cr,tr.x,Nt.y,Mt,St),D1(Ie,k.x,k.y,sr.x,Xr+sr.y,er.x,er.y+er.h,u,cr,Nt.x,tr.y,Mt,St),D1(Ie,k.x,k.y,Kt.x,Xr+Kt.y,er.x+er.w,er.y+er.h,u,cr,tr.x,tr.y,Mt,St),P){const{x:_r,y:en,z:Cn}=P.anchor,[Er,Qr,vn]=P.up;k1(Pe,_r,en,Cn,Er,Qr,vn),k1(Pe,_r,en,Cn,Er,Qr,vn),k1(Pe,_r,en,Cn,Er,Qr,vn),k1(Pe,_r,en,Cn,Er,Qr,vn),L1(t.dynamicLayoutVertexArray,_r,en,Cn,tt)}else L1(t.dynamicLayoutVertexArray,k.x,k.y,k.z,tt);if(Ae){const _r=hr||er;O1(t.iconTransitioningVertexArray,_r.x,_r.y),O1(t.iconTransitioningVertexArray,_r.x+_r.w,_r.y),O1(t.iconTransitioningVertexArray,_r.x,_r.y+_r.h),O1(t.iconTransitioningVertexArray,_r.x+_r.w,_r.y+_r.h)}_e.emplaceBack(kr,kr+1,kr+2),_e.emplaceBack(kr+1,kr+2,kr+3),ke.vertexLength+=4,ke.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(pr[0]),$t!==o.length-1&&nn===o[$t+1].sectionIndex||t.programConfigurations.populatePaintArrays(Ie.length,v,v.index,{},K,J,de,it&&it[nn],this.worldview)}const ct=P?P.anchor:k;t.placedSymbolArray.emplaceBack(ct.x,ct.y,ct.z,k.x,k.y,Ye,this.glyphOffsetArray.length-Ye,Qe,U,$,k.segment,u?u[0]:0,u?u[1]:0,f[0],f[1],C,0,0,0,q,0)}_commitLayoutVertex(t,o,u,f,A,v,C){t.emplaceBack(o,u,f,A,v,Math.round(C.x),Math.round(C.y))}_addCollisionDebugVertices(t,o,u,f,A,v,C){const P=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),k=P.vertexLength,U=C.tileAnchorX,$=C.tileAnchorY;for(let K=0;K<4;K++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,o,t.padding,C.zOffset),this._commitLayoutVertex(u.layoutVertexArray,f,A,v,U,$,new rr(t.x1,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,A,v,U,$,new rr(t.x2,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,f,A,v,U,$,new rr(t.x2,t.y2)),this._commitLayoutVertex(u.layoutVertexArray,f,A,v,U,$,new rr(t.x1,t.y2)),P.vertexLength+=4;const q=u.indexArray;q.emplaceBack(k,k+1),q.emplaceBack(k+1,k+2),q.emplaceBack(k+2,k+3),q.emplaceBack(k+3,k),P.primitiveLength+=4}_addTextDebugCollisionBoxes(t,o,u,f,A,v){for(let C=f;C<A;C++){const P=u.get(C),k=this.getSymbolInstanceTextSize(t,v,o,C);this._addCollisionDebugVertices(P,k,this.textCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(t,o,u,f,A,v){for(let C=f;C<A;C++){const P=u.get(C),k=this.getSymbolInstanceIconSize(t,o,v.placedIconSymbolIndex);this._addCollisionDebugVertices(P,k,this.iconCollisionBox,P.projectedAnchorX,P.projectedAnchorY,P.projectedAnchorZ,v)}}generateCollisionDebugBuffers(t,o,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new vS(yp,rP.members,ha),this.iconCollisionBox=new vS(yp,rP.members,ha);const f=qy(this.iconSizeData,t),A=qy(this.textSizeData,t,u);for(let v=0;v<this.symbolInstances.length;v++){const C=this.symbolInstances.get(v);this._addTextDebugCollisionBoxes(A,t,o,C.textBoxStartIndex,C.textBoxEndIndex,C),this._addTextDebugCollisionBoxes(A,t,o,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C),this._addIconDebugCollisionBoxes(f,t,o,C.iconBoxStartIndex,C.iconBoxEndIndex,C),this._addIconDebugCollisionBoxes(f,t,o,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C)}}getSymbolInstanceTextSize(t,o,u,f){const A=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:f),v=fS(this.textSizeData,t,A)/Ns;return this.tilePixelRatio*v}getSymbolInstanceIconSize(t,o,u){const f=this.icon.placedSymbolArray.get(u),A=fS(this.iconSizeData,t,f);return this.tilePixelRatio*A}_commitDebugCollisionVertexUpdate(t,o,u,f){t.emplaceBack(o,-u,-u,f),t.emplaceBack(o,u,-u,f),t.emplaceBack(o,u,u,f),t.emplaceBack(o,-u,u,f)}_updateTextDebugCollisionBoxes(t,o,u,f,A,v,C){for(let P=f;P<A;P++){const k=u.get(P),U=this.getSymbolInstanceTextSize(t,v,o,P);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,U,k.padding,v.zOffset)}}_updateIconDebugCollisionBoxes(t,o,u,f,A,v,C){for(let P=f;P<A;P++){const k=u.get(P),U=this.getSymbolInstanceIconSize(t,o,v.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,U,k.padding,v.zOffset)}}updateCollisionDebugBuffers(t,o,u,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const A=qy(this.iconSizeData,t,f),v=qy(this.textSizeData,t,u);for(let C=0;C<this.symbolInstances.length;C++){const P=this.symbolInstances.get(C);this._updateTextDebugCollisionBoxes(v,t,o,P.textBoxStartIndex,P.textBoxEndIndex,P,u),this._updateTextDebugCollisionBoxes(v,t,o,P.verticalTextBoxStartIndex,P.verticalTextBoxEndIndex,P,u),this._updateIconDebugCollisionBoxes(A,t,o,P.iconBoxStartIndex,P.iconBoxEndIndex,P,f),this._updateIconDebugCollisionBoxes(A,t,o,P.verticalIconBoxStartIndex,P.verticalIconBoxEndIndex,P,f)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,o,u,f,A,v,C,P,k){const U={};if(o<u){const{x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke,featureIndex:Ye}=t.get(o);U.textBox={x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke},U.textFeatureIndex=Ye}if(f<A){const{x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke,featureIndex:Ye}=t.get(f);U.verticalTextBox={x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke},U.verticalTextFeatureIndex=Ye}if(v<C){const{x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke,featureIndex:Ye}=t.get(v);U.iconBox={x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke},U.iconFeatureIndex=Ye}if(P<k){const{x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke,featureIndex:Ye}=t.get(P);U.verticalIconBox={x1:$,y1:q,x2:K,y2:J,padding:de,projectedAnchorX:Ae,projectedAnchorY:_e,projectedAnchorZ:Ie,tileAnchorX:Pe,tileAnchorY:ke},U.verticalIconFeatureIndex=Ye}return U}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,o){const u=t.placedSymbolArray.get(o),f=u.vertexStartIndex+4*u.numGlyphs;for(let A=u.vertexStartIndex;A<f;A+=4)t.indexArray.emplaceBack(A,A+1,A+2),t.indexArray.emplaceBack(A+1,A+2,A+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),u=Math.cos(t),f=[],A=[],v=[];for(let C=0;C<this.symbolInstances.length;++C){v.push(C);const P=this.symbolInstances.get(C);f.push(0|Math.round(o*P.tileAnchorX+u*P.tileAnchorY)),A.push(P.featureIndex)}return v.sort(((C,P)=>f[C]-f[P]||A[P]-A[C])),v}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((t,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(t).zOffset))}addToSortKeyRanges(t,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:A,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:C,placedIconSymbolIndex:P,verticalPlacedIconSymbolIndex:k}=u;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),A>=0&&A!==f&&this.addIndicesForPlacedSymbol(this.text,A),v>=0&&v!==A&&v!==f&&this.addIndicesForPlacedSymbol(this.text,v),C>=0&&this.addIndicesForPlacedSymbol(this.text,C),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let $P,GP,xS;Rr(B1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),B1.addDynamicAttributes=L1;class HP{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:ul,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rr(HP,"FormatSectionOverride",{omit:["defaultValue"]});const bS=()=>xS||(xS={layout:$P||($P=new Go({"symbol-placement":new lr(pt.layout_symbol["symbol-placement"]),"symbol-spacing":new lr(pt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new lr(pt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new xr(pt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new lr(pt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new lr(pt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new lr(pt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new lr(pt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new lr(pt.layout_symbol["icon-ignore-placement"]),"icon-optional":new lr(pt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new lr(pt.layout_symbol["icon-rotation-alignment"]),"icon-size":new xr(pt.layout_symbol["icon-size"]),"icon-size-scale-range":new lr(pt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new xr(pt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xr(pt.layout_symbol["icon-text-fit-padding"]),"icon-image":new xr(pt.layout_symbol["icon-image"]),"icon-image-use-theme":new lr({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new xr(pt.layout_symbol["icon-rotate"]),"icon-padding":new lr(pt.layout_symbol["icon-padding"]),"icon-keep-upright":new lr(pt.layout_symbol["icon-keep-upright"]),"icon-offset":new xr(pt.layout_symbol["icon-offset"]),"icon-anchor":new xr(pt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new lr(pt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new lr(pt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new lr(pt.layout_symbol["text-rotation-alignment"]),"text-field":new xr(pt.layout_symbol["text-field"]),"text-font":new xr(pt.layout_symbol["text-font"]),"text-size":new xr(pt.layout_symbol["text-size"]),"text-size-scale-range":new lr(pt.layout_symbol["text-size-scale-range"]),"text-max-width":new xr(pt.layout_symbol["text-max-width"]),"text-line-height":new xr(pt.layout_symbol["text-line-height"]),"text-letter-spacing":new xr(pt.layout_symbol["text-letter-spacing"]),"text-justify":new xr(pt.layout_symbol["text-justify"]),"text-radial-offset":new xr(pt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new lr(pt.layout_symbol["text-variable-anchor"]),"text-anchor":new xr(pt.layout_symbol["text-anchor"]),"text-max-angle":new lr(pt.layout_symbol["text-max-angle"]),"text-writing-mode":new lr(pt.layout_symbol["text-writing-mode"]),"text-rotate":new xr(pt.layout_symbol["text-rotate"]),"text-padding":new lr(pt.layout_symbol["text-padding"]),"text-keep-upright":new lr(pt.layout_symbol["text-keep-upright"]),"text-transform":new xr(pt.layout_symbol["text-transform"]),"text-offset":new xr(pt.layout_symbol["text-offset"]),"text-allow-overlap":new lr(pt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new lr(pt.layout_symbol["text-ignore-placement"]),"text-optional":new lr(pt.layout_symbol["text-optional"]),visibility:new lr(pt.layout_symbol.visibility)})),paint:GP||(GP=new Go({"icon-opacity":new xr(pt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new xr(pt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new xr(pt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new xr(pt.paint_symbol["text-emissive-strength"]),"icon-color":new xr(pt.paint_symbol["icon-color"]),"icon-halo-color":new xr(pt.paint_symbol["icon-halo-color"]),"icon-halo-width":new xr(pt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new xr(pt.paint_symbol["icon-halo-blur"]),"icon-translate":new lr(pt.paint_symbol["icon-translate"]),"icon-translate-anchor":new lr(pt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new lr(pt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new xr(pt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new xr(pt.paint_symbol["text-occlusion-opacity"]),"text-color":new xr(pt.paint_symbol["text-color"],{runtimeType:Ws,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new xr(pt.paint_symbol["text-halo-color"]),"text-halo-width":new xr(pt.paint_symbol["text-halo-width"]),"text-halo-blur":new xr(pt.paint_symbol["text-halo-blur"]),"text-translate":new lr(pt.paint_symbol["text-translate"]),"text-translate-anchor":new lr(pt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new lr(pt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new lr(pt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new lr(pt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new lr(pt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new xr(pt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},xS);class F1 extends Ls{constructor(t,o,u,f){super(t,bS(),o,u,f,t.layout?t.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=oe([]),this.hasOcclusionOpacityProperties=t.paint!==void 0&&("icon-occlusion-opacity"in t.paint||"text-occlusion-opacity"in t.paint)}_handleSpecialPaintPropertyUpdate(t){t!=="icon-occlusion-opacity"&&t!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(t,o){super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const f=[];for(const A of u)f.indexOf(A)<0&&f.push(A);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(t,o,u,f){return this._saturation===t&&this._contrast===o&&this._brightnessMin===u&&this._brightnessMax===f||(this._colorAdjustmentMatrix=(function(A,v,C,P){A=Hs(A),v=as(v);const k=ne(),U=A/3,$=1-2*U,q=[$,U,U,0,U,$,U,0,U,U,$,0,0,0,0,1],K=.5-.5*v,J=P-C;return ye(k,[J,0,0,0,0,J,0,0,0,0,J,0,C,C,C,1],[v,0,0,0,0,v,0,0,0,0,v,0,K,K,K,1]),ye(k,k,q),k})(t,o,u,f),this._saturation=t,this._contrast=o,this._brightnessMin=u,this._brightnessMax=f),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,o,u,f){const A=this.layout.get(t).evaluate(o,{},u,f),v=this._unevaluatedLayout._values[t];return v.isDataDriven()||ni(v.value)||!A?A:(function(C,P){return P.replace(/{([^{}]+)}/g,((k,U)=>U in C?String(C[U]):""))})(o.properties,A)}createBucket(t){return new B1(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of bS().paint.overridableProperties){if(!F1.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),u=new HP(o),f=new yi(u,o.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let A=null;A=o.value.kind==="constant"||o.value.kind==="source"?new Wr("source",f):new pi("composite",f,o.value.zoomStops,o.value.interpolationType),this.paint._values[t]=new Ah(o.property,A,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&F1.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const u=t.get("text-field"),f=bS().paint.properties[o];let A=!1;const v=C=>{for(const P of C)if(f.overrides&&f.overrides.hasOverride(P))return void(A=!0)};if(u.value.kind==="constant"&&u.value.value instanceof cs)v(u.value.value.sections);else if(u.value.kind==="source"){const C=k=>{A||(k instanceof Mn&&Ma(k.value)===th?v(k.value.sections):k instanceof So?v(k.sections):k.eachChild(C))},P=u.value;P._styleExpression&&C(P._styleExpression.expression)}return A}getProgramIds(){return["symbol"]}getDefaultProgramParams(t,o,u){return{config:new Kf(this,{zoom:o,lut:u}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let qP,WP,ZP,XP;var wS=ii([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function N1(s,t,o,u,f,A,v,C){const P=[s,t,1,o,u,1,f,A,1],k=[v,C,1],U=Q([],P),[$,q,K]=Sn(k,k,U);return te(P,P,[$,0,0,0,q,0,0,0,K])}function YP(s,t,o,u,f,A,v,C){const P=(function(k,U,$,q,K,J,de,Ae){const _e=N1(0,0,1,0,1,1,0,1),Ie=N1(k,U,$,q,K,J,de,Ae);return te(Ie,Ie,Q([],_e))})(s,t,o,u,f,A,v,C);return[P[2]/P[8]/mr,P[5]/P[8]/mr]}function j1(s){return[s[0],Math.min(Math.max(s[1],-We),We)]}class QP extends Tc{constructor(t,o,u,f){super(),this.id=t,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(f),this.options=o,this._dirty=!1}load(t,o){if(this._loaded=o||!1,this.fire(new Ka("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=cu(this.map._requestManager.transformRequest(this.url,zh.Image),((u,f)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new ya(u)):f&&(this.image=f instanceof HTMLImageElement?Vl.getImageData(f):f,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())}))}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Uy(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ka("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Uy||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=t[0][1],u=t[0][1];for(const A of t)A[1]>u&&(u=A[1]),A[1]<o&&(o=A[1]);const f=(u+o)/2;if(f>We?this.onNorthPole=!0:f<-We&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const A=t.map(It.fromLngLat);this.tileID=(function(v){let C=1/0,P=1/0,k=-1/0,U=-1/0;for(const de of v)C=Math.min(C,de.x),P=Math.min(P,de.y),k=Math.max(k,de.x),U=Math.max(U,de.y);const $=Math.max(k-C,U-P),q=Math.max(0,Math.floor(-Math.log2($))),K=Math.pow(2,q);let J=Math.floor((C+k)/2*K);return J>1&&(J-=1),new wh(q,J,Math.floor((P+U)/2*K))})(A),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ka("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof Uy||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const _e in this.tiles){const Ie=this.tiles[_e];Ie.state!=="loaded"&&(Ie.state="loaded",Ie.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Yy(new wh(0,0,0),this.map.transform.projection),u=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!(function(_e){const Ie=_e[1].x-_e[0].x,Pe=_e[1].y-_e[0].y,ke=_e[2].x-_e[1].x,Ye=_e[2].y-_e[1].y,Qe=_e[3].x-_e[2].x,tt=_e[3].y-_e[2].y,it=_e[0].x-_e[3].x,ct=_e[0].y-_e[3].y,$t=Ie*Ye-ke*Pe,mt=ke*tt-Qe*Ye,Wt=Qe*ct-it*tt,sr=it*Pe-Ie*ct;return $t>0&&mt>0&&Wt>0&&sr>0||$t<0&&mt<0&&Wt<0&&sr<0})(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const f=Yy(this.tileID,this.map.transform.projection),[A,v,C,P]=this.coordinates.map((_e=>{const Ie=f.projection.project(_e[0],_e[1]);return BP(f,Ie)._round()}));this.perspectiveTransform=YP(A.x,A.y,v.x,v.y,C.x,C.y,P.x,P.y);const k=this._boundsArray=new gh;k.emplaceBack(A.x,A.y,0,0),k.emplaceBack(v.x,v.y,mr,0),k.emplaceBack(P.x,P.y,0,mr),k.emplaceBack(C.x,C.y,mr,mr),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(k,wS.members),this.boundsSegments=No.simpleSegment(0,0,4,2);const U=[],$=[j1((q=this.coordinates)[0]),j1(q[1]),j1(q[2]),j1(q[3])];var q;const[K,J,de,Ae]=(function(_e){let Ie=_e[0][0],Pe=Ie,ke=_e[0][1],Ye=ke;for(let Qe=1;Qe<_e.length;Qe++)_e[Qe][0]<Ie?Ie=_e[Qe][0]:_e[Qe][0]>Pe&&(Pe=_e[Qe][0]),_e[Qe][1]<ke?ke=_e[Qe][1]:_e[Qe][1]>Ye&&(Ye=_e[Qe][1]);return[Ie,ke,Pe-Ie,Ye-ke]})($);{const _e=new gh,[Ie,Pe,ke,Ye]=(function(Nt){let tr=Nt[0].x,Mt=tr,St=Nt[0].y,pr=St;for(let cr=1;cr<Nt.length;cr++)Nt[cr].x<tr?tr=Nt[cr].x:Nt[cr].x>Mt&&(Mt=Nt[cr].x),Nt[cr].y<St?St=Nt[cr].y:Nt[cr].y>pr&&(pr=Nt[cr].y);return[tr,St,Mt-tr,pr-St]})(u),Qe=Nt=>[(Nt.x-Ie)/ke,(Nt.y-Pe)/Ye],[tt,it,ct,$t]=u.map(Qe),mt=(function(Nt,tr,Mt,St,pr,cr,nn,kr){const Xr=N1(0,0,1,0,1,1,0,1);return te(Xr,Xr,Q([],N1(Nt,tr,Mt,St,pr,cr,nn,kr)))})(tt[0],tt[1],it[0],it[1],ct[0],ct[1],$t[0],$t[1]);this.elevatedGlobePerspectiveTransform=YP(tt[0],tt[1],it[0],it[1],ct[0],ct[1],$t[0],$t[1]);const Wt=(Nt,tr)=>{U.push(Nt.lng);const Mt=Math.round((Nt.lng-K)/de*mr),St=Math.round((Nt.lat-J)/Ae*mr),pr=Qe(tr),cr=Sn([],[pr[0],pr[1],1],mt),nn=Math.round(cr[0]/cr[2]*mr),kr=Math.round(cr[1]/cr[2]*mr);_e.emplaceBack(Mt,St,nn,kr)},sr=u[3].x-u[0].x,Kt=u[3].y-u[0].y,er=u[2].x-u[1].x,hr=u[2].y-u[1].y;for(let Nt=0;Nt<65;Nt++){const tr=Nt/64,Mt=[u[0].x+tr*sr,u[0].y+tr*Kt],St=[u[1].x+tr*er,u[1].y+tr*hr],pr=St[0]-Mt[0],cr=St[1]-Mt[1];for(let nn=0;nn<65;nn++){const kr=nn/64,Xr={x:Mt[0]+pr*kr,y:Mt[1]+cr*kr};Wt(o.projection.unproject(Xr.x,Xr.y),Xr)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(_e,wS.members)}{this.maxLongitudeTriangleSize=0;let _e=[],Ie=new ea;const Pe=(ke,Ye,Qe)=>{Ie.emplaceBack(ke,Ye,Qe);const tt=U[ke],it=U[Ye],ct=U[Qe],$t=Math.min(Math.min(tt,it),ct),mt=Math.max(Math.max(tt,it),ct)-$t;mt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=mt),_e.push($t+mt/2)};for(let ke=0;ke<64;ke++)for(let Ye=0;Ye<64;Ye++){const Qe=65*ke+Ye,tt=Qe+1,it=Qe+65,ct=it+1;Pe(Qe,it,tt),Pe(tt,it,ct)}[_e,Ie]=(function(ke,Ye){const Qe=Array.from({length:ke.length},((ct,$t)=>$t));Qe.sort(((ct,$t)=>ke[ct]-ke[$t]));const tt=[],it=new ea;for(let ct=0;ct<Qe.length;ct++){const $t=Qe[ct];tt.push(ke[$t]);const mt=3*$t,Wt=mt+1;it.emplaceBack(Ye.uint16[mt],Ye.uint16[Wt],Ye.uint16[Wt+1])}return[tt,it]})(_e,Ie),this.elevatedGlobeTrianglesCenterLongitudes=_e,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(Ie)}this.elevatedGlobeSegments=No.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,de/mr,0,Ae/mr,0,0,J,K,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const o=this.map.painter.context,u=o.gl;!this._dirty||this.texture instanceof Uy||(this.texture?this.texture.update(this.image):(this.texture=new Q2(o,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(o)}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let f=(A=t+180)+360*Math.round((u[0]-A)/360);var A;const v=new No,C=($,q)=>{v.segments.push({vertexOffset:0,primitiveOffset:$,vertexLength:o.segments[0].vertexLength,primitiveLength:q,sortKey:void 0,vaos:{}})},P=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-f)<=P){const $=ca(u,0,u.length,f+P);return $===u.length||C($,mn(u,$+1,u.length,f+360-P)-$),v}f<u[0]&&(f+=360);const k=mn(u,0,u.length,f-P);if(k===u.length)return C(0,u.length),v;C(0,k-0);const U=ca(u,k+1,u.length,f+P);return U!==u.length&&C(U,u.length-U),v}}const GU=(Math.pow(256,2)-1)/16907520;class KP extends Ls{constructor(t,o,u,f){super(t,{layout:ZP||(ZP=new Go({visibility:new lr(pt.layout_raster.visibility)})),paint:XP||(XP=new Go({"raster-opacity":new lr(pt.paint_raster["raster-opacity"]),"raster-color":new Dd(pt.paint_raster["raster-color"]),"raster-color-mix":new lr(pt.paint_raster["raster-color-mix"]),"raster-color-range":new lr(pt.paint_raster["raster-color-range"]),"raster-hue-rotate":new lr(pt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new lr(pt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new lr(pt.paint_raster["raster-brightness-max"]),"raster-saturation":new lr(pt.paint_raster["raster-saturation"]),"raster-contrast":new lr(pt.paint_raster["raster-contrast"]),"raster-resampling":new lr(pt.paint_raster["raster-resampling"]),"raster-fade-duration":new lr(pt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new lr(pt.paint_raster["raster-emissive-strength"]),"raster-array-band":new lr(pt.paint_raster["raster-array-band"]),"raster-elevation":new lr(pt.paint_raster["raster-elevation"]),"raster-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof QP&&(t._source.onNorthPole||t._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(t){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[u,f]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(f)||u===this._curRampRange[0]&&f===this._curRampRange[1]||(this.colorRamp=zA({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:f}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,f])}}let JP,eR,tR,rR,nR;class iR extends Ls{constructor(t,o,u,f){super(t,{layout:JP||(JP=new Go({visibility:new lr(pt["layout_raster-particle"].visibility)})),paint:eR||(eR=new Go({"raster-particle-array-band":new lr(pt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new lr(pt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Dd(pt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new lr(pt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new lr(pt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new lr(pt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new lr(pt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new lr(pt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},o,u,f),this._updateColorRamp(),this.lastInvalidatedAt=Vl.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){t!=="raster-particle-color"&&t!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),t==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=zA({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Vl.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class HU extends Ls{constructor(t,o){super(t,{},o,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(t){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}function SS(s,t,o){const u=[0,0,1],f=Ca([]);return Qa(f,f,o?-ut(s)+Math.PI:ut(s)),Io(f,f,-ut(t)),Tr(u,u,f),Hr(u,u)}const oR={None:0,Model:1,Symbol:2,FillExtrusion:4};class U1{constructor(t,o,u,f){this.message=(t?`${t}: `:"")+u,f&&(this.identifier=f),o!=null&&o.__line__&&(this.line=o.__line__)}}function TS(s,t){const o=s.indexOf("://")===-1;try{return new URL(s,o&&t?"http://example.com":void 0),!0}catch{return!1}}class aR{constructor(t,o){this.feature=t,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class sR{constructor(){this.instancedDataArray=new wA,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class ES{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.projection=t.projection,this.index=t.index,this.worldview=t.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=t.styleDefinedModelURLs}updateFootprints(t,o){}populate(t,o,u,f){this.tileToMeter=_t(u);const A=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:v,id:C,index:P,sourceLayerIndex:k}of t){const U=C??(v.properties&&v.properties.hasOwnProperty("id")?v.properties.id:void 0),$=Ht(v,A);if(!this.layers[0]._featureFilter.filter(new co(this.zoom,{worldview:this.worldview}),$,u))continue;const q={id:U,sourceLayerIndex:k,index:P,geometry:A?$.geometry:ar(v,u,f),properties:v.properties,type:v.type,patterns:{}},K=this.addFeature(q,q.geometry,$);K&&o.featureIndex.insert(v,q.geometry,P,k,this.index,this.instancesPerModel[K].instancedDataArray.length,mr/32)}this.lookup=null}update(t,o,u,f){for(const A in this.instancesPerModel){const v=this.instancesPerModel[A];for(const C in t)v.idToFeaturesIndex.hasOwnProperty(C)&&(this.evaluate(v.features[v.idToFeaturesIndex[C]],t[C],v,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];for(const f of u.features){const A=this.layers[0],v=f.feature,C=this.canonical,P=A.paint.get("model-rotation").evaluate(v,{},C),k=A.paint.get("model-scale").evaluate(v,{},C),U=A.paint.get("model-translation").evaluate(v,{},C);wn(f.rotation,P)&&wn(f.scale,k)&&wn(f.translation,U)||(this.evaluate(f,f.featureStates,u,!0),t=!0)}}return t}updateReplacement(t,o,u,f){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const A=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(Rp(this.activeReplacements,A))return!1;this.activeReplacements=A;let v=!1;for(const C in this.instancesPerModel){const P=this.instancesPerModel[C],k=P.instancedDataArray;for(const U of P.features){const $=U.instancedDataOffset,q=U.instancedDataCount;for(let K=0;K<q;K++){const J=16*(K+$);let de=k.float32[J+0];const Ae=de>mr;de=Ae?de-mr:de;const _e=Math.floor(de),Ie=k.float32[J+1];let Pe=!1;for(const ke of this.activeReplacements)if(!L0(ke,u,oR.Model,f)&&!(ke.min.x>_e||_e>ke.max.x||ke.min.y>Ie||Ie>ke.max.y)&&(Pe=B0(ky(_e,Ie,t.canonical,ke.footprintTileId.canonical),ke.footprint),Pe))break;k.float32[J]=Pe?de+mr:de,v=v||Pe!==Ae}}}return v}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=t.createVertexBuffer(u.instancedDataArray,vj.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris&&this.modelsRequested)for(const o of this.modelUris)t.removeModel(o,"",!0)}addFeature(t,o,u){const f=this.layers[0],A=f.layout.get("model-id").evaluate(u,{},this.canonical);if(!A)return Fn(`modelId is not evaluated for layer ${f.id} and it is not going to get rendered.`),A;(TS(A,!1)||this.styleDefinedModelURLs[A]!==void 0)&&(this.modelUris.includes(A)||this.modelUris.push(A)),this.instancesPerModel[A]||(this.instancesPerModel[A]=new sR);const v=this.instancesPerModel[A],C=v.instancedDataArray,P=new aR(u,C.length);for(const k of o)for(const U of k){if(U.x<0||U.x>=mr||U.y<0||U.y>=mr)continue;if(this.lookupDim!==0){const q=(this.lookupDim-1)/mr,K=this.lookupDim*(U.y*q|0)+U.x*q|0;if(this.lookup){if(this.lookup[K]!==0)continue;this.lookup[K]=1}}this.instanceCount++;const $=C.length;C.resize($+1),v.instancesEvaluatedElevation.push(0),C.float32[16*$]=U.x,C.float32[16*$+1]=U.y}return P.instancedDataCount=v.instancedDataArray.length-P.instancedDataOffset,P.instancedDataCount>0&&(t.id&&(v.idToFeaturesIndex[t.id]=v.features.length),v.features.push(P),this.evaluate(P,{},v,!1)),A}getModelUris(){return this.modelUris}evaluate(t,o,u,f){const A=this.layers[0],v=t.feature,C=this.canonical,P=t.rotation=A.paint.get("model-rotation").evaluate(v,o,C),k=t.scale=A.paint.get("model-scale").evaluate(v,o,C),U=t.translation=A.paint.get("model-translation").evaluate(v,o,C),$=A.paint.get("model-color").evaluate(v,o,C);$.a=A.paint.get("model-color-mix-intensity").evaluate(v,o,C);const q=[];this.maxVerticalOffset<U[2]&&(this.maxVerticalOffset=U[2]),this.maxScale=Math.max(Math.max(this.maxScale,k[0]),Math.max(k[1],k[2])),DI(q,P,k);const K=Math.round(100*$.a)+$.b/1.05;for(let J=0;J<t.instancedDataCount;++J){const de=t.instancedDataOffset+J,Ae=16*de,_e=u.instancedDataArray.float32;let Ie=0;f&&(Ie=_e[Ae+6]-u.instancesEvaluatedElevation[de]);const Pe=0|_e[Ae+1];_e[Ae]=(0|_e[Ae])+$.r/1.05,_e[Ae+1]=Pe+$.g/1.05,_e[Ae+2]=K,_e[Ae+3]=1/(C.z>10?this.tileToMeter:_t(C,Pe)),_e[Ae+4]=U[0],_e[Ae+5]=U[1],_e[Ae+6]=U[2]+Ie,_e[Ae+7]=q[0],_e[Ae+8]=q[1],_e[Ae+9]=q[2],_e[Ae+10]=q[4],_e[Ae+11]=q[5],_e[Ae+12]=q[6],_e[Ae+13]=q[8],_e[Ae+14]=q[9],_e[Ae+15]=q[10],u.instancesEvaluatedElevation[de]=U[2]}}}let lR,cR;Rr(ES,"ModelBucket",{omit:["layers"]}),Rr(sR,"PerModelAttributes"),Rr(aR,"ModelFeature");class A_{constructor(t,o,u){this._demTile=t,this._dem=this._demTile.dem,this._scale=o,this._offset=u}static create(t,o,u){const f=u||t.findDEMTileFor(o);if(!f||!f.dem)return;const A=f.dem,v=f.tileID,C=1<<o.canonical.z-v.canonical.z;return new A_(f,A.dim/mr/C,[(o.canonical.x/C-v.canonical.x)*A.dim,(o.canonical.y/C-v.canonical.y)*A.dim])}tileCoordToPixel(t,o){const u=o*this._scale+this._offset[1];return new rr(Math.floor(t*this._scale+this._offset[0]),Math.floor(u))}getElevationAt(t,o,u,f){const A=t*this._scale+this._offset[0],v=o*this._scale+this._offset[1],C=Math.floor(A),P=Math.floor(v),k=this._dem;return f=!!f,u?hn(hn(k.get(C,P,f),k.get(C,P+1,f),v-P),hn(k.get(C+1,P,f),k.get(C+1,P+1,f),v-P),A-C):k.get(C,P,f)}getElevationAtPixel(t,o,u){return this._dem.get(t,o,!!u)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Ue(1,t)*this._dem.stride}}const CS=new Float32Array(262144),Z0=new Uint8Array(262144);function uR(s){let t=0;if(s.meshes)for(const o of s.meshes)t=Math.max(t,o.aabb.max[2]);if(s.children)for(const o of s.children)t=Math.max(t,uR(o));return t}function hR(s,t,o){if(s.meshes)for(const u of s.meshes){if(u.aabb.min[0]===1/0)continue;const f=An.applyTransform(u.aabb,s.matrix);o.insert(t,f.min[0],f.min[1],f.max[0],f.max[1])}if(s.children)for(const u of s.children)hR(u,t,o)}const fR=["","wall","door","roof","window","lamp","logo"];class dR{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:t.id,geometry:[],properties:{height:uR(t)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const o=new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==t&&(u.transformedAabb=An.applyTransformFast(u.aabb,this.node.matrix),o.encapsulate(u.transformedAabb)),t++;this.aabb=o}return this.aabb}}class V1{constructor(t,o,u,f,A,v,C,P){this.id=u,this.layers=t,this.layerIds=this.layers.map((k=>k.fqid)),this.stateDependentLayerIds=this.layers.filter((k=>k.isStateDependent())).map((k=>k.id)),this.modelTraits|=u_.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,f&&(this.modelTraits|=u_.HasMapboxMeshFeatures),A&&(this.modelTraits|=u_.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=v,this.worldview=P,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const k of o)this.nodesInfo.push(new dR(k)),hR(k,C.featureIndexArray.length,C.grid),C.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,C.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(t,o){for(const u of this.getNodesInfo()){const f=u.node;f.footprint&&o.push({footprint:f.footprint,id:t})}}update(t){const o=Object.keys(t).length!==0;if(o&&!this.stateDependentLayers.length)return;const u=o?this.stateDependentLayers:this.layers;if(!Ul(t,this.states))for(const f of u)this.evaluate(f,t);this.states=structuredClone(t)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const u of o){const f=u.node;this.uploaded?this.updatePbrBuffer(f):eS(f,t,!0)}for(const u of o)b1(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let o=!1;if(!t.meshes)return o;for(const u of t.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),o=!0);return o}needsReEvaluation(t,o,u){const f=t.transform.projectionOptions,A=t.style.getBrightness(),v=this.brightness!==A;if(!this.uploaded||this.dirty||f.name!==this.projection.name||tv(u.paint.get("model-color").value,v)||tv(u.paint.get("model-color-mix-intensity").value,v)||tv(u.paint.get("model-roughness").value,v)||tv(u.paint.get("model-emissive-strength").value,v)||tv(u.paint.get("model-height-based-emissive-strength-multiplier").value,v)){this.projection=f,this.brightness=A;const C=this.getNodesInfo();for(const P of C)P.state=null;return!0}return!1}evaluateTransform(t,o){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const u=this.getNodesInfo(),f=this.id.canonical;for(const A of u){const v=A.feature;A.evaluatedTranslation=o.paint.get("model-translation").evaluate(v,{},f),A.evaluatedScale=o.paint.get("model-scale").evaluate(v,{},f)}}evaluate(t,o){const u=this.getNodesInfo();for(const f of u){if(!f.node.meshes)continue;const A=f.feature,v=o&&o[A.id];if(Ul(v,f.state))continue;f.state=structuredClone(v);const C=f.node.meshes&&f.node.meshes[0].featureData,P=f.evaluatedColor[2],k=f.evaluatedRMEA[2],U=this.id.canonical;if(f.hasTranslucentParts=!1,C){for(let $=0;$<fR.length;$++){const q=fR[$];q.length&&(A.properties.part=q);const K=t.paint.get("model-color").evaluate(A,v,U).toPremultipliedRenderColor(null),J=t.paint.get("model-color-mix-intensity").evaluate(A,v,U);f.evaluatedColor[$]=[K.r,K.g,K.b,J],f.evaluatedRMEA[$][0]=t.paint.get("model-roughness").evaluate(A,v,U),f.evaluatedRMEA[$][2]=t.paint.get("model-emissive-strength").evaluate(A,v,U),f.evaluatedRMEA[$][3]=K.a,f.emissionHeightBasedParams[$]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(A,v,U),!f.hasTranslucentParts&&K.a<1&&(f.hasTranslucentParts=!0)}delete A.properties.part,WU(f,P!==f.evaluatedColor[2]||k!==f.evaluatedRMEA[2],this.modelTraits)}else f.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(A,v,U);f.evaluatedTranslation=t.paint.get("model-translation").evaluate(A,v,U),f.evaluatedScale=t.paint.get("model-scale").evaluate(A,v,U),this.updatePbrBuffer(f.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,o,u,f){const A=t.findDEMTileFor(u);if(A&&(A.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(A.dem&&A.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=A.tileID.overscaledZ;const v=A_.create(t,u,A);if(!v)return;this.modelTraits&u_.HasMapboxMeshFeatures&&this.updateDEM(t,v,u,f);for(const C of this.getNodesInfo()){const P=C.node;if(!P.footprint||!P.footprint.vertices||!P.footprint.vertices.length)continue;const k=P.footprint.vertices;let U=v.getElevationAt(k[0].x,k[0].y,!0,!0);for(let $=1;$<k.length;$++)U=Math.min(U,v.getElevationAt(k[$].x,k[$].y,!0,!0));P.elevation=U}}this.terrainTile=A.tileID.canonical,this.terrainExaggeration=o}}updateDEM(t,o,u,f){let A=o._dem._modifiedForSources[f];if(A===void 0&&(o._dem._modifiedForSources[f]=[],A=o._dem._modifiedForSources[f]),A.includes(u.canonical))return;const v=o._dem.dim;A.push(u.canonical);let C=!1;for(const P of this.getNodesInfo()){const k=P.node;if(!k.footprint||!k.footprint.grid)continue;const U=k.footprint.grid,$=o.tileCoordToPixel(U.min.x,U.min.y),q=o.tileCoordToPixel(U.max.x,U.max.y),K=Math.min(Math.min(v-q.y,$.x),Math.min($.y,v-q.x));if(K<0)continue;const J=ce(K,2,5);let de=Math.max(0,$.x-J),Ae=Math.max(0,$.y-J),_e=Math.min(q.x+J,v-1),Ie=Math.min(q.y+J,v-1);for(let Qe=Ae;Qe<=Ie;++Qe)for(let tt=de;tt<=_e;++tt)Z0[Qe*v+tt]=255;let Pe=0,ke=0;for(let Qe=0;Qe<U.cellsY;++Qe)for(let tt=0;tt<U.cellsX;++tt){if(!U.cells[Qe*U.cellsX+tt])continue;const it=o.tileCoordToPixel(U.min.x+tt/U.xScale,U.min.y+Qe/U.yScale),ct=o.tileCoordToPixel(U.min.x+(tt+1)/U.xScale,U.min.y+(Qe+1)/U.yScale);for(let $t=it.y;$t<=Math.min(ct.y+1,v-1);++$t)for(let mt=it.x;mt<=Math.min(ct.x+1,v-1);++mt)Z0[$t*v+mt]===255&&(Z0[$t*v+mt]=0,Pe+=o.getElevationAtPixel(mt,$t),ke++)}const Ye=Pe/ke;de=Math.max(1,$.x-J),Ae=Math.max(1,$.y-J),_e=Math.min(q.x+J,v-2),Ie=Math.min(q.y+J,v-2),C=!0;for(let Qe=Ae;Qe<=Ie;++Qe)for(let tt=de;tt<=_e;++tt)Z0[Qe*v+tt]===0&&(CS[Qe*v+tt]=o._dem.set(tt,Qe,Ye));for(let Qe=1;Qe<J;++Qe){de=Math.max(1,$.x-Qe),Ae=Math.max(1,$.y-Qe),_e=Math.min(q.x+Qe,v-2),Ie=Math.min(q.y+Qe,v-2);for(let tt=Ae;tt<=Ie;++tt)for(let it=de;it<=_e;++it){const ct=tt*v+it;if(Z0[ct]===255){let $t=0,mt=0,Wt=-1,sr=-1;for(let Kt=-1;Kt<=1;++Kt)for(let er=-1;er<=1;++er){const hr=(tt+Kt)*v+it+er;if(Z0[hr]>=Qe)continue;const Nt=CS[hr],tr=Math.abs(Nt);tr>mt&&($t=Nt,mt=tr,Wt=er,sr=Kt)}if(mt>.1){const Kt=1-(Qe+.5*Math.abs(Wt*sr))/J;let er=o._dem.get(it,tt)+$t*Kt;const hr=o._dem.get(it+Wt,tt+sr),Nt=o._dem.get(it-Wt,tt-sr,!0);(er-hr)*(er-Nt)>0&&(er=(hr+Nt)/2),CS[ct]=o._dem.set(it,tt,er),Z0[ct]=Qe}}}}}C&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=Vl.now())}setFilter(t){this.filter=t?Od(t):null}getNodesInfo(){return this.filter?this.nodesInfo.filter((t=>this.filter.filter(new co(this.id.overscaledZ,{worldview:this.worldview}),t.feature,this.id.canonical))):this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const o of t)b1(o.node),tS(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(t.toUnwrapped());for(const f of this.getNodesInfo()){const A=f.node.footprint;f.hiddenByReplacement=!!A&&!u.find((v=>v.footprint===A))}}getHeightAtTileCoord(t,o){const u=[],f=[0,0,0],A=oe([]);for(const v of this.getNodesInfo()){const C=v.node.meshes[0],P=C.transformedAabb;if(t<P.min[0]||o<P.min[1]||t>P.max[0]||o>P.max[1])continue;if(v.node.hidden===!0)return{height:1/0,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};ue(A,v.node.matrix),f[0]=t,f[1]=o,Gr(f,f,A);const k=(f[0]-C.aabb.min[0])/(C.aabb.max[0]-C.aabb.min[0])*H0|0,U=Math.min(63,(f[1]-C.aabb.min[1])/(C.aabb.max[1]-C.aabb.min[1])*H0|0)*H0+Math.min(63,k),$=C.heightmap[U];if(!($<0&&v.node.footprint))return v.hiddenByReplacement?void 0:{height:$,maxHeight:v.feature.properties.height,hidden:!1,verticalScale:v.evaluatedScale[2]};if(v.node.footprint.grid.query(new rr(t,o),new rr(t,o),u),u.length>0)return{height:void 0,maxHeight:v.feature.properties.height,hidden:v.hiddenByReplacement,verticalScale:v.evaluatedScale[2]}}}}function tv(s,t){return s instanceof Wr&&!s.isLightConstant&&t}function qU(s,t,o,u,f,A,v,C){let P=(61440&t|(61440&t)>>4)>>8,k=(3840&t|(3840&t)>>4)>>4,U=240&t|(240&t)>>4;o[3]>0&&(P=hn(P,255*o[0],o[3]),k=hn(k,255*o[1],o[3]),U=hn(U,255*o[2],o[3]));const $=P<<8|k,q=U<<8|Math.floor(255*u[3]),K=(function(Qe){const tt=ce(Qe,0,2);return Math.min(Math.round(.5*tt*255),255)})(u[2])<<8|15*u[0]<<4|15*u[1],J=ce(f[0],0,1),de=ce(f[1],0,1),Ae=ce(f[2],0,1),_e=ce(f[3],0,1);let Ie,Pe,ke,Ye;if(J!==de&&v!==A&&de!==J){const Qe=v-A;Pe=1/(Qe*(de-J)),ke=-(A+Qe*J)/(Qe*(de-J));const tt=ce(f[4],-1,1);Ye=Math.pow(10,tt),Ie=255*Ae<<8|255*_e}else Ie=65535,Pe=0,ke=1,Ye=1;if(s.emplaceBack($,q,K,Ie,Pe,ke,Ye),C){const Qe=C.length;C.clear();for(let tt=0;tt<Qe;tt++)C.emplaceBack($,q,K,Ie,Pe,ke,Ye)}}function WU(s,t,o){const u=s.node;let f=0;const A=o&u_.HasMeshoptCompression;for(const v of u.meshes){if(u.lights&&u.lightMeshIndex===f||!v.featureData)continue;v.featureArray=new Ba,v.featureArray.reserve(v.featureData.length);let C=t;for(const P of v.featureData){const k=A?65535&P:P>>16&65535,U=A?P>>16&65535:65535&P,$=(15&U)<8?15&U:0,q=s.evaluatedRMEA[$],K=s.evaluatedColor[$],J=s.emissionHeightBasedParams[$];let de;if(C&&$===2&&u.lights&&(de=new Ba,de.resize(10*u.lights.length)),qU(v.featureArray,k,K,q,J,v.aabb.min[2],v.aabb.max[2],de),de&&C){C=!1;const Ae=u.meshes[u.lightMeshIndex];Ae.featureArray=de,Ae.featureArray._trim()}}v.featureArray._trim(),f++}}function pR(s,t,o,u){const f=1<<s.z;t.lat=$e((u/mr+s.y)/f),t.lng=Ze((o/mr+s.x)/f)}function ZU(s,t,o,u){const f=s.getNodesInfo()[t];if(!f||f.hiddenByReplacement||!f.node.meshes)return;let A=Number.MAX_VALUE;const v=f.node,C=o.tile,P=u.calculatePosMatrix(C.tileID.toUnwrapped(),u.worldSize),k=f.evaluatedScale;let U=0;u.elevation&&v.elevation&&(U=v.elevation*u.elevation.exaggeration()),we(P,P,[(v.anchor?v.anchor[0]:0)*(k[0]-1),(v.anchor?v.anchor[1]:0)*(k[1]-1),U]),ve(P,P,k);const $=o.queryGeometry,q=$.isPointQuery()?$.screenBounds:$.screenGeometry,K=function(de){const Ae=ye([],P,de.matrix);ye(Ae,u.expandedFarZProjMatrix,Ae);for(let _e=0;_e<de.meshes.length;++_e){const Ie=de.meshes[_e];if(_e===de.lightMeshIndex)continue;const Pe=OI(q,u,Ae,Ie.aabb);Pe!=null&&(A=Math.min(Pe,A))}if(de.children)for(const _e of de.children)K(_e)};if(K(v),A===Number.MAX_VALUE)return;const J=new he(0,0);return pR(C.tileID.canonical,J,f.node.anchor[0],f.node.anchor[1]),{intersectionZ:A,position:J,feature:f.feature}}Rr(V1,"Tiled3dModelBucket",{omit:["layers"]}),Rr(dR,"Tiled3dModelFeature");const XU={circle:class extends Ls{constructor(s,t,o,u){super(s,{layout:pf||(pf=new Go({"circle-sort-key":new xr(pt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new lr(pt.layout_circle["circle-elevation-reference"]),visibility:new lr(pt.layout_circle.visibility)})),paint:bh||(bh=new Go({"circle-radius":new xr(pt.paint_circle["circle-radius"]),"circle-color":new xr(pt.paint_circle["circle-color"]),"circle-blur":new xr(pt.paint_circle["circle-blur"]),"circle-opacity":new xr(pt.paint_circle["circle-opacity"]),"circle-translate":new lr(pt.paint_circle["circle-translate"]),"circle-translate-anchor":new lr(pt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new lr(pt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new lr(pt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new xr(pt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new xr(pt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new xr(pt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new lr(pt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}createBucket(s){return new qo(s)}queryRadius(s){const t=s;return Lu("circle-radius",this,t)+Lu("circle-stroke-width",this,t)+ff(this.paint.get("circle-translate"))}queryIntersectsFeature(s,t,o,u,f,A,v,C){const P=kl(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),A.angle,s.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o);return OA(s,u,A,v,C,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",P,k)}getProgramIds(){return["circle"]}getDefaultProgramParams(s,t,o){const u=Gx(this);return{config:new Kf(this,{zoom:t,lut:o}),defines:u,overrideFog:!1}}is3D(s){return!s&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends Ls{createBucket(s){return new R0(s)}constructor(s,t,o,u){super(s,{layout:Hg||(Hg=new Go({visibility:new lr(pt.layout_heatmap.visibility)})),paint:Sy||(Sy=new Go({"heatmap-radius":new xr(pt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new xr(pt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new lr(pt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Dd(pt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new lr(pt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=zA({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(s){return Lu("heatmap-radius",this,s)}queryIntersectsFeature(s,t,o,u,f,A,v,C){const P=this.paint.get("heatmap-radius").evaluate(t,o);return OA(s,u,A,v,C,!0,!0,new rr(0,0),P)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(s,t,o){return s==="heatmap"?{config:new Kf(this,{zoom:t,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Ls{constructor(s,t,o,u){super(s,{layout:qg||(qg=new Go({visibility:new lr(pt.layout_hillshade.visibility)})),paint:kA||(kA=new Go({"hillshade-illumination-direction":new lr(pt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new lr(pt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new lr(pt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new lr(pt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new lr(pt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new lr(pt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new lr(pt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(s,t,o){return{overrideFog:!1}}},fill:class extends Ls{constructor(s,t,o,u){super(s,{layout:n1||(n1=new Go({"fill-sort-key":new xr(pt.layout_fill["fill-sort-key"]),visibility:new lr(pt.layout_fill.visibility),"fill-elevation-reference":new lr(pt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new xr(pt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:Cm||(Cm=new Go({"fill-antialias":new lr(pt.paint_fill["fill-antialias"]),"fill-opacity":new xr(pt.paint_fill["fill-opacity"]),"fill-color":new xr(pt.paint_fill["fill-color"]),"fill-outline-color":new xr(pt.paint_fill["fill-outline-color"]),"fill-translate":new lr(pt.paint_fill["fill-translate"]),"fill-translate-anchor":new lr(pt.paint_fill["fill-translate-anchor"]),"fill-pattern":new xr(pt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new lr(pt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new lr(pt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new xr(pt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new xr(pt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new xr(pt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}getProgramIds(){const s=this.paint.get("fill-pattern"),t=s&&s.constantOr(1),o=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(s,t,o){return{config:new Kf(this,{zoom:t,lut:o}),overrideFog:!1}}recalculate(s,t){super.recalculate(s,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new t_(s)}queryRadius(){return ff(this.paint.get("fill-translate"))}queryIntersectsFeature(s,t,o,u,f,A){return!s.queryGeometry.isAboveHorizon&&Dl(df(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),A.angle,s.pixelToTileUnitsFactor),u)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(s){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const t=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return s!=null?t&&!s:t}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends Ls{constructor(s,t,o,u){super(s,{layout:m1||(m1=new Go({visibility:new lr(pt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new lr(pt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:G0||(G0=new Go({"fill-extrusion-opacity":new lr(pt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new xr(pt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new lr(pt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new lr(pt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new xr(pt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new lr(pt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new xr(pt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new xr(pt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new lr(pt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new lr(pt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new lr(pt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new lr(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new lr(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new lr(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new lr(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new lr(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new lr(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new lr(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new xr(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new xr(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new lr(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new lr(pt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new lr(pt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new lr(pt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new xr(pt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new xr(pt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new lr(pt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new j0(s)}queryRadius(){return ff(this.paint.get("fill-extrusion-translate"))}is3D(s){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(s,t,o,u,f,A,v,C,P){const k=kl(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),A.angle,s.pixelToTileUnitsFactor),U=this.paint.get("fill-extrusion-height").evaluate(t,o),$=this.paint.get("fill-extrusion-base").evaluate(t,o),q=[0,0],K=C&&A.elevation,J=A.elevation?A.elevation.exaggeration():1,de=s.tile.getBucket(this);if(K&&de instanceof j0){const ke=de.centroidVertexArray,Ye=P+1;Ye<ke.length&&(q[0]=ke.geta_centroid_pos0(Ye),q[1]=ke.geta_centroid_pos1(Ye))}if(q[0]===0&&q[1]===1)return!1;A.projection.name==="globe"&&(u=$0([u],[new rr(0,0),new rr(mr,mr)],s.tileID.canonical).map((ke=>ke.polygon)).flat());const Ae=K?C:null,[_e,Ie]=(function(ke,Ye,Qe,tt,it,ct,$t,mt,Wt,sr,Kt){return ke.projection.name==="globe"?(function(er,hr,Nt,tr,Mt,St,pr,cr,nn,kr,Xr){const _r=[],en=[],Cn=er.projection.upVectorScale(Xr,er.center.lat,er.worldSize).metersToTile,Er=[0,0,0,1],Qr=[0,0,0,1],vn=(Qn,Vn,jr,Ln)=>{Qn[0]=Vn,Qn[1]=jr,Qn[2]=Ln,Qn[3]=1},kn=c_();Nt>0&&(Nt+=kn),tr+=kn;for(const Qn of hr){const Vn=[],jr=[];for(const Ln of Qn){const gi=Ln.x+Mt.x,Ne=Ln.y+Mt.y,je=er.projection.projectTilePoint(gi,Ne,Xr),Ct=er.projection.upVector(Xr,Ln.x,Ln.y);let Ut=Nt,Sr=tr;if(pr){const br=dr(gi,Ne,Nt,tr,pr,cr,nn,kr);Ut+=br.base,Sr+=br.top}Nt!==0?vn(Er,je.x+Ct[0]*Cn*Ut,je.y+Ct[1]*Cn*Ut,je.z+Ct[2]*Cn*Ut):vn(Er,je.x,je.y,je.z),vn(Qr,je.x+Ct[0]*Cn*Sr,je.y+Ct[1]*Cn*Sr,je.z+Ct[2]*Cn*Sr),Gr(Er,Er,St),Gr(Qr,Qr,St),Vn.push(new h(Er[0],Er[1],Er[2])),jr.push(new h(Qr[0],Qr[1],Qr[2]))}_r.push(Vn),en.push(jr)}return[_r,en]})(ke,Ye,Qe,tt,it,ct,$t,mt,Wt,sr,Kt):$t?(function(er,hr,Nt,tr,Mt,St,pr,cr,nn){const kr=[],Xr=[],_r=[0,0,0,1];for(const en of er){const Cn=[],Er=[];for(const Qr of en){const vn=Qr.x+tr.x,kn=Qr.y+tr.y,Qn=dr(vn,kn,hr,Nt,St,pr,cr,nn);_r[0]=vn,_r[1]=kn,_r[2]=Qn.base,_r[3]=1,_i(_r,_r,Mt),_r[3]=Math.max(_r[3],1e-5);const Vn=new h(_r[0]/_r[3],_r[1]/_r[3],_r[2]/_r[3]);_r[0]=vn,_r[1]=kn,_r[2]=Qn.top,_r[3]=1,_i(_r,_r,Mt),_r[3]=Math.max(_r[3],1e-5);const jr=new h(_r[0]/_r[3],_r[1]/_r[3],_r[2]/_r[3]);Cn.push(Vn),Er.push(jr)}kr.push(Cn),Xr.push(Er)}return[kr,Xr]})(Ye,Qe,tt,it,ct,$t,mt,Wt,sr):(function(er,hr,Nt,tr,Mt){const St=[],pr=[],cr=Mt[8]*hr,nn=Mt[9]*hr,kr=Mt[10]*hr,Xr=Mt[11]*hr,_r=Mt[8]*Nt,en=Mt[9]*Nt,Cn=Mt[10]*Nt,Er=Mt[11]*Nt;for(const Qr of er){const vn=[],kn=[];for(const Qn of Qr){const Vn=Qn.x+tr.x,jr=Qn.y+tr.y,Ln=Mt[0]*Vn+Mt[4]*jr+Mt[12],gi=Mt[1]*Vn+Mt[5]*jr+Mt[13],Ne=Mt[2]*Vn+Mt[6]*jr+Mt[14],je=Mt[3]*Vn+Mt[7]*jr+Mt[15],Ct=Ln+cr,Ut=gi+nn,Sr=Ne+kr,br=Math.max(je+Xr,1e-5),Br=Ln+_r,un=gi+en,Kn=Ne+Cn,Jn=Math.max(je+Er,1e-5);vn.push(new h(Ct/br,Ut/br,Sr/br)),kn.push(new h(Br/Jn,un/Jn,Kn/Jn))}St.push(vn),pr.push(kn)}return[St,pr]})(Ye,Qe,tt,it,ct)})(A,u,$,U,k,v,Ae,q,J,A.center.lat,s.tileID.canonical),Pe=s.queryGeometry;return(function(ke,Ye,Qe){let tt=1/0;Dl(Qe,Ye)&&(tt=Tt(Qe,Ye[0]));for(let it=0;it<Ye.length;it++){const ct=Ye[it],$t=ke[it];for(let mt=0;mt<ct.length-1;mt++){const Wt=ct[mt],sr=[Wt,ct[mt+1],$t[mt+1],$t[mt],Wt];Xl(Qe,sr)&&(tt=Math.min(tt,Tt(Qe,sr)))}}return tt!==1/0&&tt})(_e,Ie,Pe.isPointQuery()?Pe.screenBounds:Pe.screenGeometry)}},building:class extends Ls{constructor(s,t,o,u){super(s,{layout:$I||($I=new Go({visibility:new lr(pt.layout_building.visibility),"building-facade":new xr(pt.layout_building["building-facade"]),"building-facade-floors":new xr(pt.layout_building["building-facade-floors"]),"building-facade-unit-width":new xr(pt.layout_building["building-facade-unit-width"]),"building-facade-window":new xr(pt.layout_building["building-facade-window"]),"building-roof-shape":new xr(pt.layout_building["building-roof-shape"]),"building-height":new xr(pt.layout_building["building-height"]),"building-base":new xr(pt.layout_building["building-base"]),"building-flood-light-wall-radius":new xr(pt.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new xr(pt.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new xr(pt.layout_building["building-flip-roof-orientation"])})),paint:GI||(GI=new Go({"building-opacity":new lr(pt.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new lr(pt.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new lr(pt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new lr(pt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new lr(pt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new lr(pt.paint_building["building-vertical-scale"]),"building-cast-shadows":new lr(pt.paint_building["building-cast-shadows"]),"building-color":new xr(pt.paint_building["building-color"]),"building-emissive-strength":new xr(pt.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new lr(pt.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new lr(pt.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new lr(pt.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new lr(pt.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new lr(pt.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new VI(s)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(s){return!0}},line:class extends Ls{constructor(s,t,o,u){const f=eP();super(s,f,t,o,u),f.layout&&(this.layout=new Gf(f.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Yh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(s,t){super.recalculate(s,t),this.paint._values["line-floorwidth"]=(()=>{if($y)return $y;const o=eP();return $y=new Wj(o.paint.properties["line-width"].specification),$y.useIntegerZoom=!0,$y})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new oS(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(s,t,o){const u=KI(this);return{config:new Kf(this,{zoom:t,lut:o}),defines:u,overrideFog:!1}}queryRadius(s){const t=s,o=tP(Lu("line-width",this,t),Lu("line-gap-width",this,t)),u=Lu("line-offset",this,t);return o/2+Math.abs(u)+ff(this.paint.get("line-translate"))}queryIntersectsFeature(s,t,o,u,f,A){if(s.queryGeometry.isAboveHorizon)return!1;const v=df(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),A.angle,s.pixelToTileUnitsFactor),C=s.pixelToTileUnitsFactor/2*tP(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),P=this.paint.get("line-offset").evaluate(t,o);return P&&(u=(function(k,U){const $=[],q=new rr(0,0);for(let K=0;K<k.length;K++){const J=k[K],de=[];for(let Ae=0;Ae<J.length;Ae++){const _e=J[Ae],Ie=J[Ae+1],Pe=Ae===0?q:_e.sub(J[Ae-1])._unit()._perp(),ke=Ae===J.length-1?q:Ie.sub(_e)._unit()._perp(),Ye=Pe._add(ke)._unit();Ye._mult(1/(Ye.x*ke.x+Ye.y*ke.y)),de.push(Ye._mult(U)._add(_e))}$.push(de)}return $})(u,P*s.pixelToTileUnitsFactor)),(function(k,U,$){for(let q=0;q<U.length;q++){const K=U[q];if(k.length>=3){for(let J=0;J<K.length;J++)if(Fa(k,K[J]))return!0}if(Ol(k,K,$))return!0}return!1})(v,u,C)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(s){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:F1,background:class extends Ls{constructor(s,t,o,u){super(s,{layout:qP||(qP=new Go({visibility:new lr(pt.layout_background.visibility)})),paint:WP||(WP=new Go({"background-pitch-alignment":new lr(pt.paint_background["background-pitch-alignment"]),"background-color":new lr(pt.paint_background["background-color"]),"background-pattern":new lr(pt.paint_background["background-pattern"]),"background-opacity":new lr(pt.paint_background["background-opacity"]),"background-emissive-strength":new lr(pt.paint_background["background-emissive-strength"]),"background-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(s,t,o){return{overrideFog:!1}}is3D(s){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:KP,"raster-particle":iR,sky:class extends Ls{constructor(s,t,o,u){super(s,{layout:tR||(tR=new Go({visibility:new lr(pt.layout_sky.visibility)})),paint:rR||(rR=new Go({"sky-type":new lr(pt.paint_sky["sky-type"]),"sky-atmosphere-sun":new lr(pt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new lr(pt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new lr(pt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new lr(pt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Dd(pt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new lr(pt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new lr(pt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new lr(pt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(s){s==="sky-gradient"?this._updateColorRamp():s!=="sky-atmosphere-sun"&&s!=="sky-atmosphere-halo-color"&&s!=="sky-atmosphere-color"&&s!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=zA({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(s,t){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),f=!u,A=s.style.light,v=A.properties.get("position");return f&&A.properties.get("anchor")==="viewport"&&Fn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?SS(v.azimuthal,90-v.polar,t):SS(u[0],90-u[1],t)}const o=this.paint.get("sky-gradient-center");return SS(o[0],90-o[1],t)}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return s==="atmosphere"?["skyboxCapture","skybox"]:s==="gradient"?["skyboxGradient"]:null}},slot:class extends Ls{constructor(s,t,o,u){super(s,{paint:nR||(nR=new Go({}))},t,null)}},model:class extends Ls{constructor(s,t,o,u){super(s,{layout:lR||(lR=new Go({visibility:new lr(pt.layout_model.visibility),"model-id":new xr(pt.layout_model["model-id"])})),paint:cR||(cR=new Go({"model-opacity":new xr(pt.paint_model["model-opacity"]),"model-rotation":new xr(pt.paint_model["model-rotation"]),"model-scale":new xr(pt.paint_model["model-scale"]),"model-translation":new xr(pt.paint_model["model-translation"]),"model-color":new xr(pt.paint_model["model-color"]),"model-color-mix-intensity":new xr(pt.paint_model["model-color-mix-intensity"]),"model-type":new lr(pt.paint_model["model-type"]),"model-cast-shadows":new lr(pt.paint_model["model-cast-shadows"]),"model-receive-shadows":new lr(pt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new lr(pt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new xr(pt.paint_model["model-emissive-strength"]),"model-roughness":new xr(pt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new xr(pt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new lr(pt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new lr(pt.paint_model["model-front-cutoff"]),"model-elevation-reference":new lr(pt.paint_model["model-elevation-reference"]),"model-color-use-theme":new xr({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(s){return new ES(s)}getProgramIds(){return["model"]}is3D(s){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(s){return s instanceof V1?mr-1:0}queryIntersectsFeature(s,t,o,u,f,A){if(!this.modelManager)return!1;const v=this.modelManager,C=s.tile.getBucket(this);if(!(C&&C instanceof ES))return!1;for(const P in C.instancesPerModel){const k=C.instancesPerModel[P],U=t.id!==void 0?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(k.idToFeaturesIndex.hasOwnProperty(U)){const $=k.features[k.idToFeaturesIndex[U]],q=v.getModel(P,this.scope);if(!q)return!1;let K=ne();const J=new he(0,0),de=C.canonical;let Ae=Number.MAX_VALUE;for(let _e=0;_e<$.instancedDataCount;++_e){const Ie=16*($.instancedDataOffset+_e),Pe=k.instancedDataArray.float32,ke=[Pe[Ie+4],Pe[Ie+5],Pe[Ie+6]];pR(de,J,Pe[Ie],0|Pe[Ie+1]),kI(K,q,A,J,$.rotation,$.scale,ke,!1,!1,!1),A.projection.name==="globe"&&(K=J2(K,A));const Ye=ye([],A.projMatrix,K),Qe=s.queryGeometry,tt=OI(Qe.isPointQuery()?Qe.screenBounds:Qe.screenGeometry,A,Ye,q.aabb);tt!=null&&(Ae=Math.min(tt,Ae))}return Ae!==Number.MAX_VALUE&&Ae}}return!1}_handleOverridablePaintPropertyUpdate(s,t,o){return!(!this.layout||t.isDataDriven()||o.isDataDriven()||s!=="model-color"&&s!=="model-color-mix-intensity"&&s!=="model-rotation"&&s!=="model-scale"&&s!=="model-translation"&&s!=="model-emissive-strength")}_isPropertyZoomDependent(s){const t=this._transitionablePaint._values[s];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof pi}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Ls{constructor(s,t,o,u){super(s,{layout:jA||(jA=new Go({"clip-layer-types":new lr(pt.layout_clip["clip-layer-types"]),"clip-layer-scope":new lr(pt.layout_clip["clip-layer-scope"])})),paint:Ry||(Ry=new Go({}))},t,o,u)}recalculate(s,t){super.recalculate(s,t)}createBucket(s){return new r_(s)}is3D(s){return!0}}},MS=new vi(0,0,0),IS={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},PS={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},$1={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},YU={PAINT_ORDER_FILL_AND_STROKE:1},rv={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},mR={MASK_TYPE_LUMINANCE:1};function QU(s,t,o){s===1&&t.icons.push((function(u,f){return(function(A){if(A.usvg_tree.height||(A.usvg_tree.height=A.usvg_tree.width),!A.metadata)return A;const{metadata:v}=A;if(v.content_area){const{content_area:C}=v;C.left==null&&(C.left=0),C.top==null&&(C.top=C.left),C.width==null&&(C.width=A.usvg_tree.width),C.height==null&&(C.height=C.width)}if(v.text_placeholder){const{text_placeholder:C}=v;C.top==null&&(C.top=C.left),C.height==null&&(C.height=C.width)}return v.stretch_x&&v.stretch_x.length&&AR(v,"x"),v.stretch_y&&v.stretch_y.length&&AR(v,"y"),A})(u.readFields(KU,{name:void 0},f))})(o,o.readVarint()+o.pos))}function AR(s,t){const o=[],u=s[`stretch_${t}`];let f=null;for(let A=0;A<u.length;A++)f===null?f=o.length===0?u[0]:o[o.length-1][1]+u[A]:(o.push([f,f+u[A]]),f=null);s[`stretch_${t}_areas`]=o}function KU(s,t,o){s===1?t.name=o.readString():s===2?t.metadata=(function(u,f){return u.readFields(JU,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},f)})(o,o.readVarint()+o.pos):s===3&&(t.usvg_tree=(function(u,f){return u.readFields(r7,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},f)})(o,o.readVarint()+o.pos),t.data="usvg_tree")}function JU(s,t,o){s===1?t.stretch_x=o.readPackedVarint():s===2?t.stretch_y=o.readPackedVarint():s===3?t.content_area=gR(o,o.readVarint()+o.pos):s===4?t.variables.push((function(u,f){return u.readFields(t7,{name:void 0},f)})(o,o.readVarint()+o.pos)):s===5&&(t.text_placeholder=gR(o,o.readVarint()+o.pos))}function gR(s,t){return s.readFields(e7,{},t)}function e7(s,t,o){s===1?t.left=o.readVarint():s===2?t.width=o.readVarint():s===3?t.top=o.readVarint():s===4&&(t.height=o.readVarint())}function t7(s,t,o){s===1?t.name=o.readString():s===2&&(t.rgb_color=q1(o.readVarint()),t.value="rgb_color")}function r7(s,t,o){s===1?t.width=t.height=o.readVarint():s===2?t.height=o.readVarint():s===3?t.children.push(G1(o,o.readVarint()+o.pos)):s===4?t.linear_gradients.push((function(u,f){return u.readFields(c7,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},f)})(o,o.readVarint()+o.pos)):s===5?t.radial_gradients.push((function(u,f){return u.readFields(h7,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},f)})(o,o.readVarint()+o.pos)):s===7?t.clip_paths.push((function(u,f){return u.readFields(f7,{children:[]},f)})(o,o.readVarint()+o.pos)):s===8&&t.masks.push((function(u,f){const A=u.readFields(d7,{left:0,width:20,mask_type:mR.MASK_TYPE_LUMINANCE,children:[]},f);return A.height==null&&(A.height=A.width),A.top==null&&(A.top=A.left),A})(o,o.readVarint()+o.pos))}function G1(s,t){return s.readFields(n7,{},t)}function n7(s,t,o){s===1?(t.group=(function(u,f){return u.readFields(i7,{opacity:255,children:[]},f)})(o,o.readVarint()+o.pos),t.node="group"):s===2&&(t.path=(function(u,f){return u.readFields(a7,{paint_order:1,commands:[],step:1,diffs:[],rule:IS.PATH_RULE_NON_ZERO},f)})(o,o.readVarint()+o.pos),t.node="path")}function i7(s,t,o){s===1?t.transform=H1(o,o.readVarint()+o.pos):s===2?t.opacity=o.readVarint():s===5?t.clip_path_idx=o.readVarint():s===6?t.mask_idx=o.readVarint():s===7&&t.children.push(G1(o,o.readVarint()+o.pos))}function H1(s,t){return s.readFields(o7,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},t)}function o7(s,t,o){s===1?t.sx=o.readFloat():s===2?t.ky=o.readFloat():s===3?t.kx=o.readFloat():s===4?t.sy=o.readFloat():s===5?t.tx=o.readFloat():s===6&&(t.ty=o.readFloat())}function a7(s,t,o){s===1?t.fill=(function(u,f){return u.readFields(s7,{rgb_color:MS,paint:"rgb_color",opacity:255},f)})(o,o.readVarint()+o.pos):s===2?t.stroke=(function(u,f){return u.readFields(l7,{rgb_color:MS,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},f)})(o,o.readVarint()+o.pos):s===3?t.paint_order=o.readVarint():s===5?o.readPackedVarint(t.commands):s===6?t.step=o.readFloat():s===7?o.readPackedSVarint(t.diffs):s===8&&(t.rule=o.readVarint())}function s7(s,t,o){s===1?(t.rgb_color=q1(o.readVarint()),t.paint="rgb_color"):s===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):s===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):s===5&&(t.opacity=o.readVarint())}function q1(s){return new vi((s>>16&255)/255,(s>>8&255)/255,(255&s)/255,1)}function l7(s,t,o){s===1?(t.rgb_color=q1(o.readVarint()),t.paint="rgb_color"):s===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):s===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):s===5?o.readPackedFloat(t.dasharray):s===6?t.dashoffset=o.readFloat():s===7?t.miterlimit=o.readFloat():s===8?t.opacity=o.readVarint():s===9?t.width=o.readFloat():s===10?t.linecap=o.readVarint():s===11&&(t.linejoin=o.readVarint())}function c7(s,t,o){s===1?t.transform=H1(o,o.readVarint()+o.pos):s===2?t.spread_method=o.readVarint():s===3?t.stops.push(_R(o,o.readVarint()+o.pos)):s===4?t.x1=o.readFloat():s===5?t.y1=o.readFloat():s===6?t.x2=o.readFloat():s===7&&(t.y2=o.readFloat())}function _R(s,t){return s.readFields(u7,{offset:0,opacity:255,rgb_color:MS},t)}function u7(s,t,o){s===1?t.offset=o.readFloat():s===2?t.opacity=o.readVarint():s===3&&(t.rgb_color=q1(o.readVarint()))}function h7(s,t,o){s===1?t.transform=H1(o,o.readVarint()+o.pos):s===2?t.spread_method=o.readVarint():s===3?t.stops.push(_R(o,o.readVarint()+o.pos)):s===4?t.cx=o.readFloat():s===5?t.cy=o.readFloat():s===6?t.r=o.readFloat():s===7?t.fx=o.readFloat():s===8?t.fy=o.readFloat():s===9&&(t.fr=o.readFloat())}function f7(s,t,o){s===1?t.transform=H1(o,o.readVarint()+o.pos):s===2?t.clip_path_idx=o.readVarint():s===3&&t.children.push(G1(o,o.readVarint()+o.pos))}function d7(s,t,o){s===1?t.left=t.top=o.readFloat():s===2?t.width=t.height=o.readFloat():s===3?t.top=o.readFloat():s===4?t.height=o.readFloat():s===5?t.mask_type=o.readVarint():s===6?t.mask_idx=o.readVarint():s===7&&t.children.push(G1(o,o.readVarint()+o.pos))}class p7{static calculate(t={},o=[]){const u=new Map,f=new Map;if(Object.keys(t).length===0)return u;o.forEach((A=>{f.set(A.name,A.rgb_color||new vi(0,0,0))}));for(const[A,v]of Object.entries(t))f.has(A)?u.set(f.get(A).toString(),v):console.warn(`Ignoring unknown image variable "${A}"`);return u}}function g_(s,t=255,o){const u=t/255,f=s.toString(),A=o.has(f)?o.get(f).clone():s.clone();return A.a*=u,A.toString()}function nv(s,t){if(!Df()){const o=document.createElement("canvas");return o.width=s,o.height=t,o}return new OffscreenCanvas(s,t)}function m7(s,t){const o=p7.calculate(t.params,s.metadata?s.metadata.variables:[]),u=s.usvg_tree,f=u.width,A=u.height,v=t.transform?t.transform:new DOMMatrix,C=Math.max(1,Math.round(f*v.a)),P=Math.max(1,Math.round(A*v.d)),k=new DOMMatrix([C/f,0,0,P/A,0,0]),U=nv(C,P).getContext("2d");return RS(U,k,u,u,o),U.getImageData(0,0,C,P)}function RS(s,t,o,u,f){for(const A of u.children)yR(s,t,o,A,f)}function yR(s,t,o,u,f){u.group?(s.save(),(function(A,v,C,P,k){const U=P.mask_idx!=null?C.masks[P.mask_idx]:null,$=P.clip_path_idx!=null?C.clip_paths[P.clip_path_idx]:null;if(P.transform&&(v=__(P.transform).preMultiplySelf(v)),!(function(J,de,Ae){return J.opacity!==255||de||Ae})(P,$!=null,U!=null))return void RS(A,v,C,P,k);const q=nv(A.canvas.width,A.canvas.height),K=q.getContext("2d");RS(K,v,C,P,k),$&&ER(K,v,C,$),U&&CR(K,v,C,U,k),A.globalAlpha=P.opacity/255,A.drawImage(q,0,0)})(s,t,o,u.group,f),s.restore()):u.path&&(s.save(),(function(A,v,C,P,k){A.setTransform(v),P.paint_order===YU.PAINT_ORDER_FILL_AND_STROKE?(vR(A,C,P,k),bR(A,C,P,k)):(bR(A,C,P,k),vR(A,C,P,k))})(s,t,o,u.path,f),s.restore())}function vR(s,t,o,u){const f=o.fill;if(!f)return;const A=f.opacity/255;switch(s.save(),s.beginPath(),MR(o,s),f.paint){case"rgb_color":s.fillStyle=g_(f.rgb_color,f.opacity,u);break;case"linear_gradient_idx":{const v=t.linear_gradients[f.linear_gradient_idx];v.transform&&s.setTransform(__(v.transform).preMultiplySelf(s.getTransform())),s.fillStyle=wR(s,v,A,u);break}case"radial_gradient_idx":{const v=t.radial_gradients[f.radial_gradient_idx];v.transform&&s.setTransform(__(v.transform).preMultiplySelf(s.getTransform())),s.fillStyle=SR(s,v,A,u)}}s.fill(xR(o)),s.restore()}function xR(s){return s.rule===IS.PATH_RULE_NON_ZERO?"nonzero":s.rule===IS.PATH_RULE_EVEN_ODD?"evenodd":void 0}function bR(s,t,o,u){const f=o.stroke;if(!f)return;const A=IR(o);s.lineWidth=f.width,s.miterLimit=f.miterlimit,s.setLineDash(f.dasharray),s.lineDashOffset=f.dashoffset;const v=f.opacity/255;switch(f.paint){case"rgb_color":s.strokeStyle=g_(f.rgb_color,f.opacity,u);break;case"linear_gradient_idx":s.strokeStyle=wR(s,t.linear_gradients[f.linear_gradient_idx],v,u,!0);break;case"radial_gradient_idx":s.strokeStyle=SR(s,t.radial_gradients[f.radial_gradient_idx],v,u,!0)}switch(f.linejoin){case $1.LINE_JOIN_MITER_CLIP:case $1.LINE_JOIN_MITER:s.lineJoin="miter";break;case $1.LINE_JOIN_ROUND:s.lineJoin="round";break;case $1.LINE_JOIN_BEVEL:s.lineJoin="bevel"}switch(f.linecap){case PS.LINE_CAP_BUTT:s.lineCap="butt";break;case PS.LINE_CAP_ROUND:s.lineCap="round";break;case PS.LINE_CAP_SQUARE:s.lineCap="square"}s.stroke(A)}function wR(s,t,o,u,f=!1){if(t.stops.length===1){const q=t.stops[0];return g_(q.rgb_color,q.opacity*o,u)}const{x1:A,y1:v,x2:C,y2:P}=t;let k=new DOMPoint(A,v),U=new DOMPoint(C,P);if(f){const q=__(t.transform);k=q.transformPoint(k),U=q.transformPoint(U)}const $=s.createLinearGradient(k.x,k.y,U.x,U.y);for(const q of t.stops)$.addColorStop(q.offset,g_(q.rgb_color,q.opacity*o,u));return $}function SR(s,t,o,u,f=!1){if(t.stops.length===1){const _e=t.stops[0];return g_(_e.rgb_color,_e.opacity*o,u)}const A=__(t.transform),{fx:v,fy:C,fr:P,cx:k,cy:U,r:$}=t;let q=new DOMPoint(v,C),K=new DOMPoint(k,U),J=P,de=$;if(f){q=A.transformPoint(q),K=A.transformPoint(K);const _e=(A.a+A.d)/2;J=P*_e,de=t.r*_e}const Ae=s.createRadialGradient(q.x,q.y,J,K.x,K.y,de);for(const _e of t.stops)Ae.addColorStop(_e.offset,g_(_e.rgb_color,_e.opacity*o,u));return Ae}function TR(s,t,o,u){const f=u.transform?__(u.transform).preMultiplySelf(t):t,A=nv(s.canvas.width,s.canvas.height),v=A.getContext("2d");for(const P of u.children)if(P.group)TR(v,f,o,P.group);else if(P.path){const k=P.path,U=new Path2D;U.addPath(IR(k),f),v.fill(U,xR(k))}const C=u.clip_path_idx!=null?o.clip_paths[u.clip_path_idx]:null;C&&ER(v,f,o,C),s.globalCompositeOperation="source-over",s.drawImage(A,0,0)}function ER(s,t,o,u){const f=nv(s.canvas.width,s.canvas.height);TR(f.getContext("2d"),t,o,u),s.globalCompositeOperation="destination-in",s.drawImage(f,0,0)}function CR(s,t,o,u,f){if(u.children.length===0)return;const A=u.mask_idx!=null?o.masks[u.mask_idx]:null;A&&CR(s,t,o,A,f);const v=s.canvas.width,C=s.canvas.height,P=nv(v,C),k=P.getContext("2d"),U=u.width,$=u.height,q=u.left,K=u.top,J=new Path2D,de=new Path2D;de.rect(q,K,U,$),J.addPath(de,t),k.clip(J);for(const Ie of u.children)yR(k,t,o,Ie,f);const Ae=k.getImageData(0,0,v,C),_e=Ae.data;if(u.mask_type===mR.MASK_TYPE_LUMINANCE)for(let Ie=0;Ie<_e.length;Ie+=4)_e[Ie+3]=_e[Ie+3]/255*(.2126*_e[Ie]+.7152*_e[Ie+1]+.0722*_e[Ie+2]);k.putImageData(Ae,0,0),s.globalCompositeOperation="destination-in",s.drawImage(P,0,0)}function __(s){return s?new DOMMatrix([s.sx,s.ky,s.kx,s.sy,s.tx,s.ty]):new DOMMatrix}function MR(s,t){const o=s.step;let u=s.diffs[0]*o,f=s.diffs[1]*o;t.moveTo(u,f);for(let A=0,v=2;A<s.commands.length;A++)switch(s.commands[A]){case rv.PATH_COMMAND_MOVE:u+=s.diffs[v++]*o,f+=s.diffs[v++]*o,t.moveTo(u,f);break;case rv.PATH_COMMAND_LINE:u+=s.diffs[v++]*o,f+=s.diffs[v++]*o,t.lineTo(u,f);break;case rv.PATH_COMMAND_QUAD:{const C=u+s.diffs[v++]*o,P=f+s.diffs[v++]*o;u=C+s.diffs[v++]*o,f=P+s.diffs[v++]*o,t.quadraticCurveTo(C,P,u,f);break}case rv.PATH_COMMAND_CUBIC:{const C=u+s.diffs[v++]*o,P=f+s.diffs[v++]*o,k=C+s.diffs[v++]*o,U=P+s.diffs[v++]*o;u=k+s.diffs[v++]*o,f=U+s.diffs[v++]*o,t.bezierCurveTo(C,P,k,U,u,f);break}case rv.PATH_COMMAND_CLOSE:t.closePath()}return t}function IR(s){return MR(s,new Path2D)}class W1{constructor(t){this.capacity=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const o=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,o),o}put(t,o){this.cache.has(t)?this.cache.delete(t):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,o)}delete(t){this.cache.delete(t)}}Rr(W1,"LRUCache");class DS{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(t){return new Bs(t,t.data)}getFromCache(t,o,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new W1(150)),this.cacheMap.get(u).get(gp(t.toString(),o))}setInCache(t,o,u,f){this.cacheDependenciesMap.has(f)||this.cacheDependenciesMap.set(f,new Map),this.cacheMap.has(f)||this.cacheMap.set(f,new W1(150));const A=this.cacheDependenciesMap.get(f),v=gp(t.id.toString(),u);A.get(v)||A.set(v,new Set);const C=this.cacheMap.get(f),P=t.toString();A.get(v).add(P),C.put(gp(t.toString(),u),o)}removeImagesFromCacheByIds(t,o,u=0){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const f=this.cacheMap.get(u),A=this.cacheDependenciesMap.get(u);for(const v of t){const C=gp(v.toString(),o);if(A.has(C)){for(const P of A.get(C))f.delete(P);A.delete(C)}}}rasterize(t,o,u,f,A=m7){const v=this.getFromCache(t,u,f);if(v)return v.clone();const C=A(o.icon,t.options),P=DS._getImage(C);return this.setInCache(t,P,u,f),P.clone()}}class PR{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,o){const u=this.toIdx(t,o);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(t,o){return this.leaves[this.toIdx(t,o)]}toIdx(t,o){return o*this.size+t}}function RR(s,t,o,u){let f=0,A=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(u[v])<1e-15){if(o[v]<s[v]||o[v]>t[v])return null}else{const C=1/u[v];let P=(s[v]-o[v])*C,k=(t[v]-o[v])*C;if(P>k){const U=P;P=k,k=U}if(P>f&&(f=P),k<A&&(A=k),f>A)return null}return f}function DR(s,t,o,u,f,A,v,C,P,k,U){const $=u-s,q=f-t,K=A-o,J=v-s,de=C-t,Ae=P-o,_e=U[1]*Ae-U[2]*de,Ie=U[2]*J-U[0]*Ae,Pe=U[0]*de-U[1]*J,ke=$*_e+q*Ie+K*Pe;if(Math.abs(ke)<1e-15)return null;const Ye=1/ke,Qe=k[0]-s,tt=k[1]-t,it=k[2]-o,ct=(Qe*_e+tt*Ie+it*Pe)*Ye;if(ct<0||ct>1)return null;const $t=tt*K-it*q,mt=it*$-Qe*K,Wt=Qe*q-tt*$,sr=(U[0]*$t+U[1]*mt+U[2]*Wt)*Ye;return sr<0||ct+sr>1?null:(J*$t+de*mt+Ae*Wt)*Ye}function OR(s,t,o){return(s-t)/(o-t)}function kR(s,t,o,u,f,A,v,C,P){const k=1<<o,U=A-u,$=v-f,q=(s+1)/k*U+u,K=(t+0)/k*$+f,J=(t+1)/k*$+f;C[0]=(s+0)/k*U+u,C[1]=K,P[0]=q,P[1]=J}class zR{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=(function(A){const v=Math.ceil(Math.log2(A.dim/8)),C=[];let P=Math.ceil(Math.pow(2,v));const k=1/P,U=(K,J,de,Ae,_e)=>{const Ie=Ae?1:0,Pe=(K+1)*de-Ie,ke=J*de,Ye=(J+1)*de-Ie;_e[0]=K*de,_e[1]=ke,_e[2]=Pe,_e[3]=Ye};let $=new PR(P);const q=[];for(let K=0;K<P*P;K++){U(K%P,Math.floor(K/P),k,!1,q);const J=XA(q[0],q[1],A),de=XA(q[2],q[1],A),Ae=XA(q[2],q[3],A),_e=XA(q[0],q[3],A);$.minimums.push(Math.min(J,de,Ae,_e)),$.maximums.push(Math.max(J,de,Ae,_e)),$.leaves.push(1)}for(C.push($),P/=2;P>=1;P/=2){const K=C[C.length-1];$=new PR(P);for(let J=0;J<P*P;J++){U(J%P,Math.floor(J/P),2,!0,q);const de=K.getElevation(q[0],q[1]),Ae=K.getElevation(q[2],q[1]),_e=K.getElevation(q[2],q[3]),Ie=K.getElevation(q[0],q[3]),Pe=K.isLeaf(q[0],q[1]),ke=K.isLeaf(q[2],q[1]),Ye=K.isLeaf(q[2],q[3]),Qe=K.isLeaf(q[0],q[3]),tt=Math.min(de.min,Ae.min,_e.min,Ie.min),it=Math.max(de.max,Ae.max,_e.max,Ie.max),ct=Pe&&ke&&Ye&&Qe;$.maximums.push(it),$.minimums.push(tt),$.leaves.push(it-tt<=5&&ct?1:0)}C.push($)}return C})(this.dem),u=o.length-1,f=o[u];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(o,0,0,u,0)}raycastRoot(t,o,u,f,A,v,C=1){return RR([t,o,-100],[u,f,this.maximums[0]*C],A,v)}raycast(t,o,u,f,A,v,C=1){if(!this.nodeCount)return null;const P=this.raycastRoot(t,o,u,f,A,v,C);if(P==null)return null;const k=[],U=[],$=[],q=[],K=[{idx:0,t:P,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:J,t:de,nodex:Ae,nodey:_e,depth:Ie}=K.pop();if(this.leaves[J]){kR(Ae,_e,Ie,t,o,u,f,$,q);const ke=1<<Ie,Ye=(Ae+0)/ke,Qe=(Ae+1)/ke,tt=(_e+0)/ke,it=(_e+1)/ke,ct=XA(Ye,tt,this.dem)*C,$t=XA(Qe,tt,this.dem)*C,mt=XA(Qe,it,this.dem)*C,Wt=XA(Ye,it,this.dem)*C,sr=DR($[0],$[1],ct,q[0],$[1],$t,q[0],q[1],mt,A,v),Kt=DR(q[0],q[1],mt,$[0],q[1],Wt,$[0],$[1],ct,A,v),er=Math.min(sr!==null?sr:Number.MAX_VALUE,Kt!==null?Kt:Number.MAX_VALUE);if(er!==Number.MAX_VALUE)return er;{const hr=Jt([],A,v,de);if(LR(ct,$t,Wt,mt,OR(hr[0],$[0],q[0]),OR(hr[1],$[1],q[1]))>=hr[2])return de}continue}let Pe=0;for(let ke=0;ke<this._siblingOffset.length;ke++){kR((Ae<<1)+this._siblingOffset[ke][0],(_e<<1)+this._siblingOffset[ke][1],Ie+1,t,o,u,f,$,q),$[2]=-100,q[2]=this.maximums[this.childOffsets[J]+ke]*C;const Ye=RR($,q,A,v);if(Ye!=null){const Qe=Ye;k[ke]=Qe;let tt=!1;for(let it=0;it<Pe&&!tt;it++)Qe>=k[U[it]]&&(U.splice(it,0,ke),tt=!0);tt||(U[Pe]=ke),Pe++}}for(let ke=0;ke<Pe;ke++){const Ye=U[ke];K.push({idx:this.childOffsets[J]+Ye,t:k[Ye],nodex:(Ae<<1)+this._siblingOffset[Ye][0],nodey:(_e<<1)+this._siblingOffset[Ye][1],depth:Ie+1})}}return null}_addNode(t,o,u){return this.minimums.push(t),this.maximums.push(o),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(t,o,u,f,A){if(t[f].isLeaf(o,u)===1)return;this.childOffsets[A]||(this.childOffsets[A]=this.nodeCount);const v=f-1,C=t[v];let P=0,k=0;for(let U=0;U<this._siblingOffset.length;U++){const $=2*o+this._siblingOffset[U][0],q=2*u+this._siblingOffset[U][1],K=C.getElevation($,q),J=C.isLeaf($,q),de=this._addNode(K.min,K.max,J);J&&(P|=1<<U),k||(k=de)}for(let U=0;U<this._siblingOffset.length;U++)P&1<<U||this._construct(t,2*o+this._siblingOffset[U][0],2*u+this._siblingOffset[U][1],v,k+U)}}function LR(s,t,o,u,f,A){return hn(hn(s,o,A),hn(t,u,A),f)}function XA(s,t,o){const u=o.dim,f=ce(s*u-.5,0,u-1),A=ce(t*u-.5,0,u-1),v=Math.floor(f),C=Math.floor(A),P=Math.min(v+1,u-1),k=Math.min(C+1,u-1);return LR(o.get(v,C),o.get(P,C),o.get(v,k),o.get(P,k),f-v,A-C)}const A7={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function g7(s,t,o){return(256*s*256+256*t+o)/10-1e4}function _7(s,t,o){return 256*s+t+o/256-32768}class Z1{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,o,u,f=!1){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void Fn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const A=this.dim=o.height-2,v=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=f,this._modifiedForSources={},!f){for(let P=0;P<A;P++)v[this._idx(-1,P)]=v[this._idx(0,P)],v[this._idx(A,P)]=v[this._idx(A-1,P)],v[this._idx(P,-1)]=v[this._idx(P,0)],v[this._idx(P,A)]=v[this._idx(P,A-1)];v[this._idx(-1,-1)]=v[this._idx(0,0)],v[this._idx(A,-1)]=v[this._idx(A-1,0)],v[this._idx(-1,A)]=v[this._idx(0,A-1)],v[this._idx(A,A)]=v[this._idx(A-1,A-1)]}const C=u==="terrarium"?_7:g7;for(let P=0;P<v.length;++P){const k=4*P;this.floatView[P]=C(this.pixels[k],this.pixels[k+1],this.pixels[k+2])}this._timestamp=Vl.now()}_buildQuadTree(){this._tree=new zR(this)}get(t,o,u=!1){u&&(t=ce(t,-1,this.dim),o=ce(o,-1,this.dim));const f=this._idx(t,o);return this.floatView[f]}set(t,o,u){const f=this._idx(t,o),A=this.floatView[f];return this.floatView[f]=u,u-A}static getUnpackVector(t){return A7[t]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}static pack(t,o){const u=[0,0,0,0],f=Z1.getUnpackVector(o);let A=Math.floor((t+f[3])/f[2]);return u[2]=A%256,A=Math.floor(A/256),u[1]=A%256,A=Math.floor(A/256),u[0]=A,u}getPixels(){return new Ty({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,o,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,A=o*this.dim+this.dim,v=u*this.dim,C=u*this.dim+this.dim;switch(o){case-1:f=A-1;break;case 1:A=f+1}switch(u){case-1:v=C-1;break;case 1:C=v+1}const P=-o*this.dim,k=-u*this.dim;for(let U=v;U<C;U++)for(let $=f;$<A;$++){const q=4*this._idx($,U),K=4*this._idx($+P,U+k);this.pixels[q+0]=t.pixels[K+0],this.pixels[q+1]=t.pixels[K+1],this.pixels[q+2]=t.pixels[K+2],this.pixels[q+3]=t.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function y7(s,t,o){s===1?t.headerLength=o.readFixed32():s===2?t.x=o.readVarint():s===3?t.y=o.readVarint():s===4?t.z=o.readVarint():s===5&&t.layers.push((function(u,f){return u.readFields(S7,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},f)})(o,o.readVarint()+o.pos))}function v7(s,t,o){s===1?(t.delta_filter=(function(u,f){return u.readFields(x7,{blockSize:0},f)})(o,o.readVarint()+o.pos),t.filter="delta_filter"):s===2?(o.readVarint(),t.filter="zigzag_filter"):s===3?(o.readVarint(),t.filter="bitshuffle_filter"):s===4&&(o.readVarint(),t.filter="byteshuffle_filter")}function x7(s,t,o){s===1&&(t.blockSize=o.readVarint())}function b7(s,t,o){s===1?(o.readVarint(),t.codec="gzip_data"):s===2?(o.readVarint(),t.codec="jpeg_image"):s===3?(o.readVarint(),t.codec="webp_image"):s===4&&(o.readVarint(),t.codec="png_image")}function w7(s,t,o){let u=0,f=0;s===1?t.firstByte=o.readFixed64():s===2?t.lastByte=o.readFixed64():s===3?t.filters.push((function(A,v){return A.readFields(v7,{},v)})(o,o.readVarint()+o.pos)):s===4?t.codec=(function(A,v){return A.readFields(b7,{},v)})(o,o.readVarint()+o.pos):s===5?f=o.readFloat():s===6?u=o.readFloat():s===7?t.bands.push(o.readString()):s===8?t.offset=o.readDouble():s===9&&(t.scale=o.readDouble()),t.offset===0&&(t.offset=f),t.scale===0&&(t.scale=u)}function S7(s,t,o){s===1?t.version=o.readVarint():s===2?t.name=o.readString():s===3?t.units=o.readString():s===4?t.tileSize=o.readVarint():s===5?t.buffer=o.readVarint():s===6?t.pixelFormat=o.readVarint():s===7&&t.dataIndex.push((function(u,f){return u.readFields(w7,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},f)})(o,o.readVarint()+o.pos))}function T7(s,t,o){if(s===2)(function(u,f,A){u.readFields(E7,A,f)})(o,o.readVarint()+o.pos,t);else if(s===3)throw new Error("Not implemented")}function E7(s,t,o){if(s===1){let u=0;const f=o.readVarint()+o.pos;for(;o.pos<f;)t[u++]=o.readVarint()}}function C7(s,t){if(t.length!==4)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let o=t[3];for(let u=2;u>=1;u--){const f=u===1?1:0,A=u===2?1:0;for(let v=0;v<t[0];v++){const C=t[1]*v;for(let P=f;P<t[1];P++){const k=t[2]*(P+C);for(let U=A;U<t[2];U++){const $=t[3]*(U+k);for(let q=0;q<t[3];q++){const K=$+q;s[K]+=s[K-o]}}}}o*=t[u]}return s}function M7(s){for(let t=0,o=s.length;t<o;t++)s[t]=s[t]>>>1^-(1&s[t]);return s}function I7(s,t){switch(t){case"uint32":return s;case"uint16":for(let o=0;o<s.length;o+=2){const u=s[o],f=s[o+1];s[o]=(240&u)>>4|(61440&u)>>8|(240&f)<<4|61440&f,s[o+1]=15&u|(3840&u)>>4|(15&f)<<8|(3840&f)<<4}return s;case"uint8":for(let o=0;o<s.length;o+=4){const u=s[o],f=s[o+1],A=s[o+2],v=s[o+3];s[o+0]=(192&u)>>6|(192&f)>>4|(192&A)>>2|192&v,s[o+1]=(48&u)>>4|(48&f)>>2|48&A|(48&v)<<2,s[o+2]=(12&u)>>2|12&f|(12&A)<<2|(12&v)<<4,s[o+3]=3&u|(3&f)<<2|(3&A)<<4|(3&v)<<6}return s;default:throw new Error(`Invalid pixel format, "${t}"`)}}Rr(Z1,"DEMData"),Rr(zR,"DemMinMaxQuadTree",{omit:["dem"]});var gf=Uint8Array,iv=Uint16Array,P7=Int32Array,BR=new gf([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),FR=new gf([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),R7=new gf([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),NR=function(s,t){for(var o=new iv(31),u=0;u<31;++u)o[u]=t+=1<<s[u-1];var f=new P7(o[30]);for(u=1;u<30;++u)for(var A=o[u];A<o[u+1];++A)f[A]=A-o[u]<<5|u;return{b:o,r:f}},jR=NR(BR,2),UR=jR.b,D7=jR.r;UR[28]=258,D7[258]=28;for(var O7=NR(FR,0).b,VR=new iv(32768),rs=0;rs<32768;++rs){var y_=(43690&rs)>>1|(21845&rs)<<1;VR[rs]=((65280&(y_=(61680&(y_=(52428&y_)>>2|(13107&y_)<<2))>>4|(3855&y_)<<4))>>8|(255&y_)<<8)>>1}var ov=function(s,t,o){for(var u=s.length,f=0,A=new iv(t);f<u;++f)s[f]&&++A[s[f]-1];var v,C=new iv(t);for(f=1;f<t;++f)C[f]=C[f-1]+A[f-1]<<1;v=new iv(1<<t);var P=15-t;for(f=0;f<u;++f)if(s[f])for(var k=f<<4|s[f],U=t-s[f],$=C[s[f]-1]++<<U,q=$|(1<<U)-1;$<=q;++$)v[VR[$]>>P]=k;return v},av=new gf(288);for(rs=0;rs<144;++rs)av[rs]=8;for(rs=144;rs<256;++rs)av[rs]=9;for(rs=256;rs<280;++rs)av[rs]=7;for(rs=280;rs<288;++rs)av[rs]=8;var $R=new gf(32);for(rs=0;rs<32;++rs)$R[rs]=5;var k7=ov(av,9),z7=ov($R,5),OS=function(s){for(var t=s[0],o=1;o<s.length;++o)s[o]>t&&(t=s[o]);return t},Vd=function(s,t,o){var u=t/8|0;return(s[u]|s[u+1]<<8)>>(7&t)&o},kS=function(s,t){var o=t/8|0;return(s[o]|s[o+1]<<8|s[o+2]<<16)>>(7&t)},L7=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],$d=function(s,t,o){var u=new Error(t||L7[s]);if(u.code=s,Error.captureStackTrace&&Error.captureStackTrace(u,$d),!o)throw u;return u},B7=new gf(0),F7=typeof TextDecoder<"u"&&new TextDecoder;try{F7.decode(B7,{stream:!0})}catch{}const N7={gzip_data:"gzip"};class ed extends Error{constructor(t){super(t),this.name="MRTError"}}const j7={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},GR={uint32:1,uint16:2,uint8:4},U7={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let zS;class X1{constructor(t=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){const o=this.layers[t];if(!o)throw new ed(`Layer '${t}' not found`);return o}getHeaderLength(t){const o=new Uint8Array(t),u=new DataView(t);if(o[0]!==13)throw new ed("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(t){const o=new Uint8Array(t),u=this.getHeaderLength(t);if(o.length<u)throw new ed(`Expected header with length >= ${u} but got buffer of length ${o.length}`);const f=new zS(o.subarray(0,u)).readFields(y7,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==f.x||this.y!==f.y||this.z!==f.z))throw new ed(`Invalid attempt to parse header ${f.z}/${f.x}/${f.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=f.x,this.y=f.y,this.z=f.z;for(const A of f.layers)this.layers[A.name]=new HR(A,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const o=[],u=this.getLayer(t.layerName);for(let f of t.blockIndices){const A=u.dataIndex[f],v=A.firstByte-t.firstByte,C=A.lastByte-t.firstByte;if(u._blocksInProgress.has(f))continue;const P={layerName:u.name,firstByte:v,lastByte:C,pixelFormat:u.pixelFormat,blockIndex:f,blockShape:[A.bands.length].concat(u.bandShape),buffer:u.buffer,codec:A.codec.codec,filters:A.filters.map((k=>k.filter))};u._blocksInProgress.add(f),o.push(P)}return new qR(o,(()=>{o.forEach((f=>u._blocksInProgress.delete(f.blockIndex)))}),((f,A)=>{if(o.forEach((v=>u._blocksInProgress.delete(v.blockIndex))),f)throw f;A.forEach((v=>{this.getLayer(v.layerName).processDecodedData(v)}))}))}}class HR{constructor({version:t,name:o,units:u,tileSize:f,pixelFormat:A,buffer:v,dataIndex:C},P){if(this.version=t,this.version!==1)throw new ed(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=o,this.units=u,this.tileSize=f,this.buffer=v,this.pixelFormat=j7[A],this.dataIndex=C,this.bandShape=[f+2*v,f+2*v,GR[this.pixelFormat]],this._decodedBlocks=new W1(P?P.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return GR[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((({bands:t})=>t)).flat()}processDecodedData(t){const o=t.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,t.data)}getBlockForBand(t){let o=0;switch(typeof t){case"string":for(const[u,f]of this.dataIndex.entries()){for(const[A,v]of f.bands.entries())if(v===t)return{bandIndex:o+A,blockIndex:u,blockBandIndex:A};o+=f.bands.length}break;case"number":for(const[u,f]of this.dataIndex.entries()){if(t>=o&&t<o+f.bands.length)return{bandIndex:t,blockIndex:u,blockBandIndex:t-o};o+=f.bands.length}break;default:throw new ed(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(t){let o=1/0,u=-1/0;const f=[],A=new Set;for(const v of t){const{blockIndex:C}=this.getBlockForBand(v);if(C<0)throw new ed(`Invalid band: ${JSON.stringify(v)}`);const P=this.dataIndex[C];f.includes(C)||f.push(C),A.add(C),o=Math.min(o,P.firstByte),u=Math.max(u,P.lastByte)}if(A.size>this.cacheSize)throw new ed(`Number of blocks to decode (${A.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:u,blockIndices:f}}hasBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0}hasDataForBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(t){const{blockIndex:o,blockBandIndex:u}=this.getBlockForBand(t);if(o<0)throw new ed(`Band not found: ${JSON.stringify(t)}`);const f=this._decodedBlocks.get(o.toString());if(!f)throw new ed(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const A=this.dataIndex[o],v=this.bandShape.reduce(((k,U)=>k*U),1),C=u*v,P=f.subarray(C,C+v);return{data:P,bytes:new Uint8Array(P.buffer).subarray(P.byteOffset,P.byteOffset+P.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:A.offset,scale:A.scale}}}X1.setPbf=function(s){zS=s};class qR{constructor(t,o,u){this.tasks=t,this._onCancel=o,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,o){this._finalized||(this._onComplete(t,o),this._finalized=!0)}}X1.performDecoding=function(s,t){const o=new Uint8Array(s);return Promise.all(t.tasks.map((u=>{const{layerName:f,firstByte:A,lastByte:v,pixelFormat:C,blockShape:P,blockIndex:k,filters:U,codec:$}=u,q=o.subarray(A,v+1),K=new Uint32Array(P[0]*P[1]*P[2]);let J;if($!=="gzip_data")throw new ed(`Unhandled codec: ${$}`);return J=(function(de,Ae){if(!globalThis.DecompressionStream&&Ae==="gzip_data")return Promise.resolve(((ke=(function(tt){tt[0]==31&&tt[1]==139&&tt[2]==8||$d(6,"invalid gzip data");var it=tt[3],ct=10;4&it&&(ct+=2+(tt[10]|tt[11]<<8));for(var $t=(it>>3&1)+(it>>4&1);$t>0;$t-=!tt[ct++]);return ct+(2&it)})(Pe=de))+8>Pe.length&&$d(6,"invalid gzip data"),(function(tt,it,ct,$t){var mt=tt.length;if(!mt||it.f&&!it.l)return ct||new gf(0);var Wt=!ct,sr=Wt||it.i!=2,Kt=it.i;Wt&&(ct=new gf(3*mt));var er,hr,Nt=function(zo){var Lo=ct.length;if(zo>Lo){var yo=new gf(Math.max(2*Lo,zo));yo.set(ct),ct=yo}},tr=it.f||0,Mt=it.p||0,St=it.b||0,pr=it.l,cr=it.d,nn=it.m,kr=it.n,Xr=8*mt;do{if(!pr){tr=Vd(tt,Mt,1);var _r=Vd(tt,Mt+1,3);if(Mt+=3,!_r){var en=tt[(Ne=4+((Mt+7)/8|0))-4]|tt[Ne-3]<<8,Cn=Ne+en;if(Cn>mt){Kt&&$d(0);break}sr&&Nt(St+en),ct.set(tt.subarray(Ne,Cn),St),it.b=St+=en,it.p=Mt=8*Cn,it.f=tr;continue}if(_r==1)pr=k7,cr=z7,nn=9,kr=5;else if(_r==2){var Er=Vd(tt,Mt,31)+257,Qr=Vd(tt,Mt+10,15)+4,vn=Er+Vd(tt,Mt+5,31)+1;Mt+=14;for(var kn=new gf(vn),Qn=new gf(19),Vn=0;Vn<Qr;++Vn)Qn[R7[Vn]]=Vd(tt,Mt+3*Vn,7);Mt+=3*Qr;var jr=OS(Qn),Ln=(1<<jr)-1,gi=ov(Qn,jr);for(Vn=0;Vn<vn;){var Ne,je=gi[Vd(tt,Mt,Ln)];if(Mt+=15&je,(Ne=je>>4)<16)kn[Vn++]=Ne;else{var Ct=0,Ut=0;for(Ne==16?(Ut=3+Vd(tt,Mt,3),Mt+=2,Ct=kn[Vn-1]):Ne==17?(Ut=3+Vd(tt,Mt,7),Mt+=3):Ne==18&&(Ut=11+Vd(tt,Mt,127),Mt+=7);Ut--;)kn[Vn++]=Ct}}var Sr=kn.subarray(0,Er),br=kn.subarray(Er);nn=OS(Sr),kr=OS(br),pr=ov(Sr,nn),cr=ov(br,kr)}else $d(1);if(Mt>Xr){Kt&&$d(0);break}}sr&&Nt(St+131072);for(var Br=(1<<nn)-1,un=(1<<kr)-1,Kn=Mt;;Kn=Mt){var Jn=(Ct=pr[kS(tt,Mt)&Br])>>4;if((Mt+=15&Ct)>Xr){Kt&&$d(0);break}if(Ct||$d(2),Jn<256)ct[St++]=Jn;else{if(Jn==256){Kn=Mt,pr=null;break}var Zn=Jn-254;Jn>264&&(Zn=Vd(tt,Mt,(1<<(Hn=BR[Vn=Jn-257]))-1)+UR[Vn],Mt+=Hn);var Xi=cr[kS(tt,Mt)&un],Vo=Xi>>4;if(Xi||$d(3),Mt+=15&Xi,br=O7[Vo],Vo>3){var Hn=FR[Vo];br+=kS(tt,Mt)&(1<<Hn)-1,Mt+=Hn}if(Mt>Xr){Kt&&$d(0);break}sr&&Nt(St+131072);var Co=St+Zn;if(St<br){var no=0-br,Li=Math.min(br,Co);for(no+St<0&&$d(3);St<Li;++St)ct[St]=(void 0)[no+St]}for(;St<Co;++St)ct[St]=ct[St-br]}}it.l=pr,it.p=Kn,it.b=St,it.f=tr,pr&&(tr=1,it.m=nn,it.d=cr,it.n=kr)}while(!tr);return St!=ct.length&&Wt?(er=ct,((hr=St)==null||hr>er.length)&&(hr=er.length),new gf(er.subarray(0,hr))):ct.subarray(0,St)})(Pe.subarray(ke,-8),{i:2},new gf(((_e=Pe)[(Ie=_e.length)-4]|_e[Ie-3]<<8|_e[Ie-2]<<16|_e[Ie-1]<<24)>>>0))));var _e,Ie,Pe,ke;const Ye=N7[Ae];if(!Ye)throw new Error(`Unhandled codec: ${Ae}`);const Qe=new globalThis.DecompressionStream(Ye);return new Response(new Blob([de]).stream().pipeThrough(Qe)).arrayBuffer().then((tt=>new Uint8Array(tt)))})(q,$).then((de=>((function(Ae,_e){Ae.readFields(T7,_e)})(new zS(de),K),new U7[C](K.buffer)))),J.then((de=>{for(let Ae=U.length-1;Ae>=0;Ae--)switch(U[Ae]){case"delta_filter":C7(de,P);break;case"zigzag_filter":M7(de);break;case"bitshuffle_filter":I7(de,C);break;default:throw new ed(`Unhandled filter "${U[Ae]}"`)}return{layerName:f,blockIndex:k,data:de}})).catch((de=>{throw de}))})))},Rr(qR,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Rr(X1,"MapboxRasterTile"),Rr(HR,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class WR{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const u=t[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const V7=["id","tile","layer","source","sourceLayer","state"];class v_{constructor(t,o,u,f,A){this.type="Feature",this._vectorTileFeature=t,this._z=o,this._x=u,this._y=f,this.properties=t.properties,this.id=A}clone(){const t=new v_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(t.state=Object.assign({},this.state)),this.layer&&(t.layer=Object.assign({},this.layer)),this.source&&(t.source=this.source),this.sourceLayer&&(t.sourceLayer=this.sourceLayer),t}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of V7)this[o]!==void 0&&(t[o]=this[o]);return t}}class ZR{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new tf(mr,16,0),this.featureIndexArray=new CA,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(t,o,u,f,A,v=0,C=0){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,f,A,v);const k=this.grid;for(let U=0;U<o.length;U++){const $=o[U],q=[1/0,1/0,-1/0,-1/0];for(let K=0;K<$.length;K++){const J=$[K];q[0]=Math.min(q[0],J.x),q[1]=Math.min(q[1],J.y),q[2]=Math.max(q[2],J.x),q[3]=Math.max(q[3],J.y)}C!==0&&(q[0]-=C,q[1]-=C,q[2]+=C,q[3]+=C),q[0]<mr&&q[1]<mr&&q[2]>=0&&q[3]>=0&&k.insert(P,q[0],q[1],q[2],q[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new rn(new w1(this.rawTileData)).layers,this.sourceLayerCoder=new WR(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,o){const{tilespaceGeometry:u,transform:f,tileTransform:A,pixelPosMatrix:v,availableImages:C,worldview:P}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const k=u.bufferedTilespaceBounds,U=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,((J,de,Ae,_e)=>ra(u.bufferedTilespaceGeometry,J,de,Ae,_e)));U.sort($7);let $=null;f.elevation&&U.length>0&&($=A_.create(f.elevation,this.tileID));const q={};let K;for(let J=0;J<U.length;J++){const de=U[J];if(de===K)continue;K=de;const Ae=this.featureIndexArray.get(de);let _e=null;this.is3DTile?this.loadMatchingModelFeature(q,Ae,t,u,f,P):this.loadMatchingFeature(q,Ae,t,C,P,((Ie,Pe,ke,Ye=0)=>(_e||(_e=ar(Ie,this.tileID.canonical,A)),Pe.queryIntersectsFeature(u,Ie,ke,_e,this.z,f,v,$,Ye))))}return q}loadMatchingFeature(t,o,u,f,A,v){const{featureIndex:C,bucketIndex:P,sourceLayerIndex:k,layoutVertexArrayOffset:U}=o,$=this.bucketLayerIDs[P],q=u.layers,K=Object.keys(q);if(K.length&&!Yn(K,$))return;const J=u.sourceCache,de=this.sourceLayerCoder.decode(k),Ae=this.vtLayers[de].feature(C),_e=this.getId(Ae,de);for(let Ie=0;Ie<$.length;Ie++){const Pe=$[Ie];if(!q[Pe])continue;const{styleLayer:ke,targets:Ye}=q[Pe];let Qe={};_e!==void 0&&(Qe=J.getFeatureState(ke.sourceLayer,_e));const tt=!v||v(Ae,ke,Qe,U);if(!tt)continue;const it=new v_(Ae,this.z,this.x,this.y,_e);it.tile=this.tileID.canonical,it.state=Qe;let ct=this.serializedLayersCache.get(Pe);ct||(ct=ke.serialize(),ct.id=Pe,this.serializedLayersCache.set(Pe,ct)),it.source=ct.source,it.sourceLayer=ct["source-layer"],it.layer=Object.assign({},ct),it.layer.paint=XR(ct.paint,ke.paint,Ae,Qe,f),it.layer.layout=XR(ct.layout,ke.layout,Ae,Qe,f);let $t=!1;for(const mt of Ye){this.updateFeatureProperties(it,mt);const{filter:Wt}=mt;if(Wt){if(Ae.properties=it.properties,Wt.needGeometry){const sr=Ht(Ae,!0);if(!Wt.filter(new co(this.tileID.overscaledZ,{worldview:A}),sr,this.tileID.canonical))continue}else if(!Wt.filter(new co(this.tileID.overscaledZ,{worldview:A}),Ae))continue}$t=!0,mt.targetId&&this.addFeatureVariant(it,mt)}$t&&this.appendToResult(t,Pe,C,it,tt)}}loadMatchingModelFeature(t,o,u,f,A,v){const{featureIndex:C,bucketIndex:P}=o,k=this.bucketLayerIDs[P],U=u.layers,$=Object.keys(U);if(!$.length||Yn($,k))for(let q=0;q<k.length;q++){const K=k[q],{styleLayer:J,targets:de}=U[K];if(J.type!=="model")continue;const Ae=f.tile,_e=Ae.getBucket(J);if(!(_e&&_e instanceof V1))continue;const Ie=ZU(_e,C,f,A);if(!Ie)continue;const{z:Pe,x:ke,y:Ye}=Ae.tileID.canonical,{feature:Qe,intersectionZ:tt,position:it}=Ie;let ct={};Qe.id!==void 0&&(ct=u.sourceCache.getFeatureState(J.sourceLayer,Qe.id));const $t=new v_({},Pe,ke,Ye,Qe.id);$t.tile=this.tileID.canonical,$t.state=ct,$t.properties=Qe.properties,$t.geometry={type:"Point",coordinates:[it.lng,it.lat]};let mt=this.serializedLayersCache.get(K);mt||(mt=J.serialize(),mt.id=K,this.serializedLayersCache.set(K,mt)),$t.source=mt.source,$t.sourceLayer=mt["source-layer"],$t.layer=Object.assign({},mt);let Wt=!1;for(const sr of de){this.updateFeatureProperties($t,sr);const{filter:Kt}=sr;if(Kt){if(Qe.properties=$t.properties,Kt.needGeometry){if(!Kt.filter(new co(this.tileID.overscaledZ,{worldview:v}),Qe,this.tileID.canonical))continue}else if(!Kt.filter(new co(this.tileID.overscaledZ,{worldview:v}),Qe))continue}Wt=!0,sr.targetId&&this.addFeatureVariant($t,sr)}Wt&&this.appendToResult(t,K,C,$t,tt)}}updateFeatureProperties(t,o,u){if(o.properties){const f={};for(const A in o.properties){const v=o.properties[A].evaluate({zoom:this.z},t._vectorTileFeature,t.state,t.tile,u);v!=null&&(f[A]=v)}t.properties=f}}addFeatureVariant(t,o,u){const f={target:o.target,namespace:o.namespace,uniqueFeatureID:o.uniqueFeatureID};o.properties&&(f.properties=t.properties),t.variants=t.variants||{},t.variants[o.targetId]=t.variants[o.targetId]||[],t.variants[o.targetId].push(f)}appendToResult(t,o,u,f,A){let v=t[o];v===void 0&&(v=t[o]=[]),v.push({featureIndex:u,feature:f,intersectionZ:A})}lookupSymbolFeatures(t,o,u,f,A,v){const C={};this.loadVTLayers();for(const P of t)this.loadMatchingFeature(C,{bucketIndex:o,sourceLayerIndex:u,featureIndex:P,layoutVertexArrayOffset:0},f,A,v);return C}loadFeature(t){const{featureIndex:o,sourceLayerIndex:u}=t;this.loadVTLayers();const f=this.sourceLayerCoder.decode(u),A=this.vtFeatures[f];if(A[o])return A[o];const v=this.vtLayers[f].feature(o);return A[o]=v,v}hasLayer(t){for(const o of this.bucketLayerIDs)for(const u of o)if(t===u)return!0;return!1}getId(t,o){let u=t.id;if(this.promoteId){const f=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[o];if(f!=null)if(Array.isArray(f)){if(!this.promoteIdExpression){const A=Tn(f);if(A.result!=="success"){const v=A.value.map((C=>`${C.key}: ${C.message}`)).join(", ");return void Fn(`Failed to create expression for promoteId: ${v}`)}this.promoteIdExpression=A.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Zs),u=this.promoteIdExpression.evaluate({zoom:0},t)}else u=t.properties[f];typeof u=="boolean"&&(u=Number(u))}return u}}function XR(s,t,o,u,f){return wr(s,((A,v)=>{const C=t instanceof Gf?t.get(v):null;return C&&C.evaluate?C.evaluate(o,u,void 0,f):C}))}function $7(s,t){return t-s}Rr(ZR,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const YR=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class LS{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=u>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const A=YR[15&u];if(!A)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(t,2,1),[C]=new Uint32Array(t,4,1);return new LS(C,v,A,t)}constructor(t,o=64,u=Float64Array,f){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const A=YR.indexOf(this.ArrayType),v=2*t*this.ArrayType.BYTES_PER_ELEMENT,C=t*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-C%8)%8;if(A<0)throw new Error(`Unexpected typed array class: ${u}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+P,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+v+C+P),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+P,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+A]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=t,this.coords[this._pos++]=o,u}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return BS(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:A,coords:v,nodeSize:C}=this,P=[0,A.length-1,0],k=[];for(;P.length;){const U=P.pop()||0,$=P.pop()||0,q=P.pop()||0;if($-q<=C){for(let Ae=q;Ae<=$;Ae++){const _e=v[2*Ae],Ie=v[2*Ae+1];_e>=t&&_e<=u&&Ie>=o&&Ie<=f&&k.push(A[Ae])}continue}const K=q+$>>1,J=v[2*K],de=v[2*K+1];J>=t&&J<=u&&de>=o&&de<=f&&k.push(A[K]),(U===0?t<=J:o<=de)&&(P.push(q),P.push(K-1),P.push(1-U)),(U===0?u>=J:f>=de)&&(P.push(K+1),P.push($),P.push(1-U))}return k}within(t,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:A,nodeSize:v}=this,C=[0,f.length-1,0],P=[],k=u*u;for(;C.length;){const U=C.pop()||0,$=C.pop()||0,q=C.pop()||0;if($-q<=v){for(let Ae=q;Ae<=$;Ae++)KR(A[2*Ae],A[2*Ae+1],t,o)<=k&&P.push(f[Ae]);continue}const K=q+$>>1,J=A[2*K],de=A[2*K+1];KR(J,de,t,o)<=k&&P.push(f[K]),(U===0?t-u<=J:o-u<=de)&&(C.push(q),C.push(K-1),C.push(1-U)),(U===0?t+u>=J:o+u>=de)&&(C.push(K+1),C.push($),C.push(1-U))}return P}}function BS(s,t,o,u,f,A){if(f-u<=o)return;const v=u+f>>1;QR(s,t,v,u,f,A),BS(s,t,o,u,v-1,1-A),BS(s,t,o,v+1,f,1-A)}function QR(s,t,o,u,f,A){for(;f>u;){if(f-u>600){const k=f-u+1,U=o-u+1,$=Math.log(k),q=.5*Math.exp(2*$/3),K=.5*Math.sqrt($*q*(k-q)/k)*(U-k/2<0?-1:1);QR(s,t,o,Math.max(u,Math.floor(o-U*q/k+K)),Math.min(f,Math.floor(o+(k-U)*q/k+K)),A)}const v=t[2*o+A];let C=u,P=f;for(sv(s,t,u,o),t[2*f+A]>v&&sv(s,t,u,f);C<P;){for(sv(s,t,C,P),C++,P--;t[2*C+A]<v;)C++;for(;t[2*P+A]>v;)P--}t[2*u+A]===v?sv(s,t,u,P):(P++,sv(s,t,P,f)),P<=o&&(u=P+1),o<=P&&(f=P-1)}}function sv(s,t,o,u){FS(s,o,u),FS(t,2*o,2*u),FS(t,2*o+1,2*u+1)}function FS(s,t,o){const u=s[t];s[t]=s[o],s[o]=u}function KR(s,t,o,u){const f=s-o,A=t-u;return f*f+A*A}i.$=ap,i.A=ys,i.B=gp,i.C=2,i.D=Yo,i.E=Tc,i.F=Wy,i.G=wP,i.H=xd,i.I=wl,i.J=sm,i.K=gn,i.L=Uh,i.M=fr,i.N=at,i.O=jt,i.P=rr,i.Q=ni,i.R=zh,i.S=Hf,i.T=Q2,i.U=Tn,i.V=U1,i.W=hi,i.X=Xs,i.Y=Jo,i.Z=To,i._=Rs,i.a=function(s){return ss.API_CDN_URL_REGEX.test(s)},i.a$=$e,i.a0=jh,i.a1=np,i.a2=lm,i.a3=class extends U1{},i.a4=Qt,i.a5=Rt,i.a6=pt,i.a7=function(s){const t=s.value;return t?jh(t)?TS(t,!0)?[]:[new U1(s.key,t,`invalid url "${t}"`)]:[new U1(s.key,t,`string expected, "${gn(t)}" found`)]:[]},i.a8=m0,i.a9=Go,i.aA=ce,i.aB=ye,i.aC=_i,i.aD=d,i.aE=Fa,i.aF=Le,i.aG=xt,i.aH=function(s,t){const o={};for(let u=0;u<t.length;u++){const f=t[u];f in s&&(o[f]=s[f])}return o},i.aI=Se,i.aJ=Ge,i.aK=class{constructor(s){this.entries={},this.scheduler=s}request(s,t,o,u){const f=this.entries[s]=this.entries[s]||{callbacks:[]};if(f.result){const[A,v]=f.result;return this.scheduler?this.scheduler.add((()=>{u(A,v)}),t):u(A,v),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=o(((A,v)=>{f.result=[A,v];for(const C of f.callbacks)this.scheduler?this.scheduler.add((()=>{C(A,v)}),t):C(A,v);setTimeout((()=>delete this.entries[s]),3e3)}))),()=>{f.result||(f.callbacks=f.callbacks.filter((A=>A!==u)),f.callbacks.length||(f.cancel(),delete this.entries[s]))}}},i.aL=function(s,t,o){const u=JSON.stringify(s.request);return s.data&&(this.deduped.entries[u]={result:[null,s.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},(f=>{const A=wc(s.request,((v,C,P,k)=>{v?f(v):C&&f(null,{vectorTile:o?void 0:new rn(new w1(C)),rawData:C,cacheControl:P,expires:k})}));return()=>{A.cancel(),f()}}),t)},i.aM=function(s){Ju++,Ju>cl&&(s.getActor().send("enforceCacheSizeLimit",vl),Ju=0)},i.aN=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log2(s)))},i.aO=Ys,i.aP=KP,i.aQ=iR,i.aR=he,i.aS=QP,i.aT=function(s,t){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(let u=0;u<s.length;u++){const f=document.createElement("source");Sc(s[u])||(o.crossOrigin="Anonymous"),f.src=s[u],o.appendChild(f)}return{cancel:()=>{}}},i.aU=Uy,i.aV=function(s){return fetch(s).then((t=>t.arrayBuffer())).then((t=>MI(t,0,s)))},i.aW=LI,i.aX=class{constructor(s,t,o,u){this.id=s,this.position=t!=null?new he(t[0],t[1]):new he(0,0),this.orientation=o??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new An([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(s,t){if(ye(s.matrix,t,s.matrix),s.meshes)for(const o of s.meshes){const u=An.applyTransformFast(o.aabb,s.matrix);this.aabb.encapsulate(u)}if(s.children)for(const o of s.children)this._applyTransformations(o,s.matrix)}computeBoundsAndApplyParent(){const s=oe([]);for(const t of this.nodes)this._applyTransformations(t,s)}computeModelMatrix(s,t,o,u,f,A,v=!1){kI(this.matrix,this,s.transform,this.position,t,o,u,f,A,v)}upload(s){if(!this.uploaded){for(const t of this.nodes)eS(t,s);for(const t of this.nodes)b1(t);this.uploaded=!0}}destroy(){for(const s of this.nodes)tS(s)}},i.aY=Dr,i.aZ=Yy,i.a_=Ze,i.aa=lr,i.ab=class{constructor(s){this.specification=s}possiblyEvaluate(s,t){return ia(s.expression.evaluate(t))}interpolate(s,t,o){return{x:hn(s.x,t.x,o),y:hn(s.y,t.y,o),z:hn(s.z,t.z,o),azimuthal:hn(s.azimuthal,t.azimuthal,o),polar:hn(s.polar,t.polar,o)}}},i.ac=co,i.ad=pi,i.ae=It,i.af=Gr,i.ag=Pt,i.ah=At,i.ai=Gf,i.aj=Jf,i.ak=hn,i.al=mr,i.am=du,i.an=ut,i.ao=vi,i.ap=class{constructor(s){this.specification=s}possiblyEvaluate(s,t){return(function([o,u]){const f=ia([1,o,u]);return{x:f.x,y:f.y,z:f.z}})(s.expression.evaluate(t))}interpolate(s,t,o){return{x:hn(s.x,t.x,o),y:hn(s.y,t.y,o),z:hn(s.z,t.z,o)}}},i.aq=function(s,t,o=0,u=!0){const f=new rr(o,o),A=s.sub(f),v=t.add(f),C=[A,new rr(v.x,A.y),v,new rr(A.x,v.y)];return u&&C.push(A.clone()),C},i.ar=function(s,t){const o=[];for(let u=0;u<s.length;u++){const f=Je(u-1,-1,s.length-1),A=Je(u+1,-1,s.length-1),v=s[u],C=s[A],P=s[f].sub(v).unit(),k=C.sub(v).unit(),U=k.angleWithSep(P.x,P.y),$=P.add(k).unit().mult(-1*t/Math.sin(U/2));o.push(v.add($))}return o},i.as=BP,i.at=ra,i.au=function(s,t,o=0){return wt(((t.x-o)*s.scale-s.x)*mr,(t.y*s.scale-s.y)*mr,Ve(t.z,t.y))},i.av=Rn,i.aw=Hr,i.ax=Ai,i.ay=ZI,i.az=function(s){let t=1/0,o=1/0,u=-1/0,f=-1/0;for(const A of s)t=Math.min(t,A.x),o=Math.min(o,A.y),u=Math.max(u,A.x),f=Math.max(f,A.y);return{min:new rr(t,o),max:new rr(u,f)}},i.b=function(s){return ss.API_FONTS_REGEX.test(s)},i.b$=B0,i.b0=gh,i.b1=ea,i.b2=kt,i.b3=SA,i.b4=B1,i.b5=function(){Ru.isLoading()||Ru.isLoaded()||am()!=="deferred"||nf()},i.b6=Od,i.b7=Ht,i.b8=v_,i.b9=ri,i.bA=oe,i.bB=Be,i.bC=ne,i.bD=function(s,t){const{x:o,y:u}=s.point,f=Vx(o,u,s.worldSize/s._pixelsPerMercatorPixel,0,0);return ye(f,f,Vg(Fu(t)))},i.bE=F,i.bF=Zi,i.bG=function(s,t){var o=t[0]-s[0],u=t[1]-s[1],f=t[2]-s[2];return Math.sqrt(o*o+u*u+f*f)},i.bH=Jt,i.bI=jn,i.bJ=Nn,i.bK=qy,i.bL=ju,i.bM=fS,i.bN=function(s,t,o,u,f){const A=5*t+2;s.float32[A+0]=o,s.float32[A+1]=u,s.float32[A+2]=f},i.bO=L1,i.bP=os,i.bQ=Qi,i.bR=al,i.bS=Gs,i.bT=Je,i.bU=function(s,t,o,u){var f=new B(4);return f[0]=s,f[1]=t,f[2]=o,f[3]=u,f},i.bV=X,i.bW=Xl,i.bX=Ns,i.bY=L0,i.bZ=oR,i.b_=ky,i.ba=oS,i.bb=t_,i.bc=ar,i.bd=uc,i.be=bA,i.bf=Ng,i.bg=No,i.bh=LA,i.bi=wS,i.bj=function(s,t){const o=Jf(t.zoom);if(o===0)return Fu(s);const u=DA(s),f=Bd(u),A=Le(u.getWest())*t.worldSize,v=Le(u.getEast())*t.worldSize,C=Ge(u.getNorth())*t.worldSize,P=Ge(u.getSouth())*t.worldSize,k=[A,C,0],U=[v,C,0],$=[A,P,0],q=[v,P,0],K=ue([],t.globeMatrix);return Gr(k,k,K),Gr(U,U,K),Gr($,$,K),Gr(q,q,K),f[0]=$c(f[0],$,o),f[1]=$c(f[1],q,o),f[2]=$c(f[2],U,o),f[3]=$c(f[3],k,o),An.fromPoints(f)},i.bk=P0,i.bl=ue,i.bm=Gc,i.bn=$c,i.bo=Du,i.bp=wa,i.bq=Ke,i.br=we,i.bs=X1,i.bt=w1,i.bu=wc,i.bv=function(s,t){const o=[];for(const u in s)u in t||o.push(u);return o},i.bw=vt,i.bx=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.by=Ul,i.bz=function(s){var t=new B(16);return t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=s[3],t[4]=s[4],t[5]=s[5],t[6]=s[6],t[7]=s[7],t[8]=s[8],t[9]=s[9],t[10]=s[10],t[11]=s[11],t[12]=s[12],t[13]=s[13],t[14]=s[14],t[15]=s[15],t},i.c=Qp,i.c$=function(s){return s*s*s*s*s},i.c0=hS,i.c1=PP,i.c2=AS,i.c3=LS,i.c4=Vt,i.c5=di,i.c6=Ca,i.c7=function(s,t,o){o*=.5;var u=t[0],f=t[1],A=t[2],v=t[3],C=Math.sin(o),P=Math.cos(o);return s[0]=u*P+f*C,s[1]=f*P-u*C,s[2]=A*P+v*C,s[3]=v*P-A*C,s},i.c8=Io,i.c9=He,i.cA=Pn,i.cB=PI,i.cC=wh,i.cD=I0,i.cE=function(s,t,o,u,f,A,v,C,P){if(P.name==="globe")return I0(s,t,new wh(o,u,f),!1);const k=Yy({z:o,x:u,y:f},P);return new An([(A+k.x/k.scale)*t,t*(k.y/k.scale),v],[(A+k.x2/k.scale)*t,t*(k.y2/k.scale),C])},i.cF=function(s,t,o){return s[0]=Math.min(t[0],o[0]),s[1]=Math.min(t[1],o[1]),s[2]=Math.min(t[2],o[2]),s[3]=Math.min(t[3],o[3]),s},i.cG=function(s,t,o){return s[0]=Math.max(t[0],o[0]),s[1]=Math.max(t[1],o[1]),s[2]=Math.max(t[2],o[2]),s[3]=Math.max(t[3],o[3]),s},i.cH=function(s){const t=Math.round((s+45+360)%360/90)%4;return ge[t]},i.cI=We,i.cJ=eo,i.cK=E,i.cL=function(s){const t=oe(new Float64Array(16));ye(t,s.pixelMatrix,s.globeMatrix);const o=[0,H,0],u=[0,W,0];return Gr(o,o,t),Gr(u,u,t),[o[0]>0&&o[0]<=s.width&&o[1]>0&&o[1]<=s.height&&!Gg(s,new he(s.center.lat,90)),u[0]>0&&u[0]<=s.width&&u[1]>0&&u[1]<=s.height&&!Gg(s,new he(s.center.lat,-90))]},i.cM=function(s,t){const{scale:o}=s.tileTransform,u=o*mr/(s.tileSize*Math.pow(2,t.zoom-s.tileID.overscaledZ+s.tileID.canonical.z));return(function(f,A,v){var C=A[1],P=A[2],k=A[3],U=v[0],$=v[1];return f[0]=A[0]*U,f[1]=C*U,f[2]=P*$,f[3]=k*$,f})(new Float32Array(4),t.inverseAdjustmentMatrix,[u,u])},i.cN=v1,i.cO=bt,i.cP=II,i.cQ=function(s){const t=II(s,!0);return F([],[t[0],t[1],t[4],t[5]])},i.cR=ve,i.cS=wi,i.cT=Ce,i.cU=function(s){const{x:t,y:o}=s.point,{lng:u,lat:f}=s._center;return Vx(t,o,s.worldSize,u,f)},i.cV=ir,i.cW=le,i.cX=bm,i.cY=us,i.cZ=x,i.c_=function(s,t,o){let u=0;for(let f=0;f<2;++f)s[f]>0&&(u+=(s[f]-0)*(s[f]-0)),t[f]<0&&(u+=(0-t[f])*(0-t[f]));return u},i.ca=function(s,t){return s[0]=-t[0],s[1]=-t[1],s[2]=-t[2],s[3]=t[3],s},i.cb=dt,i.cc=function(s,t,o,u,f){var A=1/Math.tan(t/2);if(s[0]=A/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=A,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,f!=null&&f!==1/0){var v=1/(u-f);s[10]=(f+u)*v,s[14]=2*f*u*v}else s[10]=-1,s[14]=-2*u;return s},i.cd=function(s,t,o,u,f,A,v){var C=1/(t-o),P=1/(u-f),k=1/(A-v);return s[0]=-2*C,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*P,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*k,s[11]=0,s[12]=(t+o)*C,s[13]=(f+u)*P,s[14]=(v+A)*k,s[15]=1,s},i.ce=Ue,i.cf=function(s,t,o){s[4*t+0]=o[0],s[4*t+1]=o[1],s[4*t+2]=o[2],s[4*t+3]=o[3]},i.cg=uf,i.ch=ym,i.ci=Ei,i.cj=yh,i.ck=Ep,i.cl=VP,i.cm=function(){var s=new B(4);return B!=Float32Array&&(s[1]=0,s[2]=0),s[0]=1,s[3]=1,s},i.cn=function(s,t,o){var u=t[0],f=t[1],A=t[2],v=t[3],C=Math.sin(o),P=Math.cos(o);return s[0]=u*P+A*C,s[1]=f*P+v*C,s[2]=u*-C+A*P,s[3]=f*-C+v*P,s},i.co=function(s,t){return s[0]===t[0]&&s[1]===t[1]&&s[2]===t[2]&&s[3]===t[3]},i.cp=wn,i.cq=function(s){var t=s[0],o=s[1],u=s[2],f=s[3];return Math.sqrt(t*t+o*o+u*u+f*f)},i.cr=to,i.cs=Tr,i.ct=xm,i.cu=3,i.cv=2,i.cw=7,i.cx=6,i.cy=Ur,i.cz=ht,i.d=function(s){return ss.API_TILEJSON_REGEX.test(s)},i.d$=KI,i.d0=Oe,i.d1=45,i.d2=Sp,i.d3=function(s,t,o){const u=Math.sqrt(s*s+t*t+o*o),f=u>0?Math.acos(o/u)*Xu:0;let A=s!==0||t!==0?Math.atan2(-t,-s)*Xu+90:0;return A<0&&(A+=360),[u,A,f]},i.d4=wt,i.d5=ia,i.d6=_t,i.d7=et,i.d8=An,i.d9=Zt,i.dA=function(s,t,o){const u=Jf(o.zoom),f=s.style.map._antialias,A=s.terrain&&s.terrain.exaggeration()>0;return u===0&&!f&&!A},i.dB=function(s){const t=s.pixelsPerMeter,o=t/Ue(1,s.center.lat),u=oe(new Float64Array(16));return we(u,u,[s.point.x,s.point.y,0]),ve(u,u,[o,o,t]),Float32Array.from(u)},i.dC=DA,i.dD=function(s){const t=We-5;s=ce(s,-t,t)/t*90;const o=Math.pow(Math.abs(Math.sin(ut(s))),3);return Math.round(o*(N.length-1))},i.dE=function(s,t,o,u){const f=t.getNorth(),A=t.getSouth(),v=t.getWest(),C=t.getEast(),P=1<<s.z,k=C-v,U=f-A,$=k/D,q=-U/N[o],K=[0,$,0,q,0,0,f,v,0];if(s.z>0){const J=180/u;te(K,K,[J/k+1,0,0,0,J/U+1,0,-.5*J/$,.5*J/q,1])}return K[2]=P,K[5]=s.x,K[8]=s.y,K},i.dF=Fu,i.dG=function(s,t,o){const u=oe(new Float64Array(16)),f=(t/(1<<s)-.5)*Math.PI*2;return Ee(u,o.globeMatrix,f),Float32Array.from(u)},i.dH=class{isDataAvailableAtPoint(s){const t=this._source();if(this.isUsingMockSource()||!t||s.y<0||s.y>1)return!1;const o=t.getSource().maxzoom,u=1<<o,f=Math.floor(s.x),A=Math.floor((s.x-f)*u),v=Math.floor(s.y*u),C=this.findDEMTileFor(new Ys(o,f,o,A,v));return!(!C||!C.dem)}getAtPointOrZero(s,t=0){return this.getAtPoint(s,t)||0}getAtPoint(s,t,o=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const u=this._source();if(!u||s.y<0||s.y>1)return t;const f=u.getSource().maxzoom,A=1<<f,v=Math.floor(s.x),C=s.x-v,P=new Ys(f,v,f,Math.floor(C*A),Math.floor(s.y*A)),k=this.findDEMTileFor(P);if(!k||!k.dem)return t;const U=k.dem,$=1<<k.tileID.canonical.z,q=(C*$-k.tileID.canonical.x)*U.dim,K=(s.y*$-k.tileID.canonical.y)*U.dim,J=Math.floor(q),de=Math.floor(K);return(o?this.exaggeration():1)*hn(hn(U.get(J,de),U.get(J,de+1),K-de),hn(U.get(J+1,de),U.get(J+1,de+1),K-de),q-J)}getAtTileOffset(s,t,o){const u=1<<s.canonical.z;return this.getAtPointOrZero(new It(s.wrap+(s.canonical.x+t/mr)/u,(s.canonical.y+o/mr)/u))}getAtTileOffsetFunc(s,t,o,u){return f=>{const A=this.getAtTileOffset(s,f.x,f.y),v=u.upVector(s.canonical,f.x,f.y);return Vt(v,v,A*u.upVectorScale(s.canonical,t,o).metersToTile),v}}getForTilePoints(s,t,o,u){if(this.isUsingMockSource())return!1;const f=A_.create(this,s,u);return!!f&&(t.forEach((A=>{A[2]=this.exaggeration()*f.getElevationAt(A[0],A[1],o)})),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(s);if(!t||!t.dem)return null;const o=t.dem.tree,u=t.tileID,f=1<<s.canonical.z-u.canonical.z;let A=s.canonical.x/f-u.canonical.x,v=s.canonical.y/f-u.canonical.y,C=0;for(let P=0;P<s.canonical.z-u.canonical.z&&!o.leaves[C];P++){A*=2,v*=2;const k=2*Math.floor(v)+Math.floor(A);C=o.childOffsets[C]+k,A%=1,v%=1}return{min:this.exaggeration()*o.minimums[C],max:this.exaggeration()*o.maximums[C]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,t,o){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const s=this.visibleDemTiles;if(s.length===0)return null;let t=!1,o=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const f of s){const A=this.getMinMaxForTile(f.tileID);A&&(o=Math.min(o,A.min),u=Math.max(u,A.max),t=!0)}return t?{min:o,max:u}:null}},i.dI=Ty,i.dJ=jg,i.dK=function(s,t){return[Math.pow(s[0],2.2)*t,Math.pow(s[1],2.2)*t,Math.pow(s[2],2.2)*t]},i.dL=G,i.dM=function(s,t){var o=Math.sin(t),u=Math.cos(t);return s[0]=u,s[1]=o,s[2]=0,s[3]=-o,s[4]=u,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},i.dN=Sn,i.dO=_y,i.dP=as,i.dQ=Hs,i.dR=256,i.dS=function(s,t){const o=[0,0,0];return Gr(o,o,P0(Fu(t.canonical))),Gr(o,o,s),o},i.dT=s=>({u_matrix:new Ep(s),u_texsize:new yh(s),u_pixels_to_tile_units:new fc(s),u_device_pixel_ratio:new Ei(s),u_width_scale:new Ei(s),u_floor_width_scale:new Ei(s),u_image:new uf(s),u_units_to_pixels:new yh(s),u_tile_units_to_pixels:new Ei(s),u_alpha_discard_threshold:new Ei(s),u_trim_offset:new yh(s),u_trim_fade_range:new yh(s),u_trim_color:new Sp(s),u_emissive_strength:new Ei(s),u_zbias_factor:new Ei(s),u_tile_to_meter:new Ei(s),u_ground_shadow_factor:new ym(s),u_pattern_transition:new Ei(s)}),i.dU=s=>({u_matrix:new Ep(s),u_pixels_to_tile_units:new fc(s),u_device_pixel_ratio:new Ei(s),u_width_scale:new Ei(s),u_floor_width_scale:new Ei(s),u_units_to_pixels:new yh(s),u_dash_image:new uf(s),u_gradient_image:new uf(s),u_image_height:new Ei(s),u_texsize:new yh(s),u_tile_units_to_pixels:new Ei(s),u_alpha_discard_threshold:new Ei(s),u_trim_offset:new yh(s),u_trim_fade_range:new yh(s),u_trim_color:new Sp(s),u_emissive_strength:new Ei(s),u_zbias_factor:new Ei(s),u_tile_to_meter:new Ei(s),u_ground_shadow_factor:new ym(s)}),i.dV=s=>({u_camera_to_center_distance:new Ei(s),u_extrude_scale:new fc(s),u_device_pixel_ratio:new Ei(s),u_matrix:new Ep(s),u_inv_rot_matrix:new Ep(s),u_merc_center:new yh(s),u_tile_id:new ym(s),u_zoom_transition:new Ei(s),u_up_dir:new ym(s),u_emissive_strength:new Ei(s)}),i.dW=yA,i.dX=rU,i.dY=class{constructor(s,t,o,u){this.context=s,this.format=u,this.size=o,this.texture=s.gl.createTexture();const[f,A,v]=this.size,{gl:C}=s;C.bindTexture(C.TEXTURE_3D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in t&&t.data&&C.texImage3D(C.TEXTURE_3D,0,this.format,f,A,v,0,X2(this.format),Y2(this.format),t.data)}bind(s,t){const{context:o}=this,{gl:u}=o;u.bindTexture(u.TEXTURE_3D,this.texture),s!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,s),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,s),this.minFilter=s),t!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:s}=this.context;s.deleteTexture(this.texture),this.texture=null}},i.dZ=Gx,i.d_=(s,t,o,u,f,A)=>{const v=s.transform,C=v.projection.name==="globe";let P;if(A.paint.get("circle-pitch-alignment")==="map")if(C){const U=_y(v.zoom,t.canonical)*v._pixelsPerMercatorPixel;P=Float32Array.from([U,0,0,U])}else P=v.calculatePixelsToTileUnitsMatrix(o);else P=new Float32Array([v.pixelsToGLUnits[0],0,0,v.pixelsToGLUnits[1]]);const k={u_camera_to_center_distance:s.transform.getCameraToCenterDistance(v.projection),u_matrix:s.translatePosMatrix(t.projMatrix,o,A.paint.get("circle-translate"),A.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Vl.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:F2,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:A.paint.get("circle-emissive-strength")};if(C){k.u_inv_rot_matrix=u,k.u_merc_center=f,k.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],k.u_zoom_transition=Jf(v.zoom);const U=f[0]*mr,$=f[1]*mr;k.u_up_dir=v.projection.upVector(new wh(0,0,0),U,$)}return k},i.da=function(s){return[Math.pow(s[0],1/2.2),Math.pow(s[1],1/2.2),Math.pow(s[2],1/2.2)]},i.db=TS,i.dc=function(s,t){return s.readFields(QU,{icons:[]},t)},i.dd=nr,i.de=d_,i.df=pS,i.dg=$l,i.dh=Rg,i.di=oa,i.dj=Oa,i.dk=Un,i.dl=function(s){const t=s.indexOf(Ap);return t>=0?s.slice(0,t):s},i.dm=function(s){return s.indexOf(Ap)>=0},i.dn=function(s){const t=s.lastIndexOf(Ap);return t>=0?s.slice(t+1):""},i.dp=function(s){const t=[],o=s.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),s.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},i.dq=function(s,t,o,u){return s.type==="custom"?new HU(s,t):new XU[s.type](s,t,o,u)},i.dr=zn,i.ds=function(s){const t=s.indexOf(Ap);return t>=0?s.slice(t+1):""},i.dt=class extends v_{constructor(s,t){super(s._vectorTileFeature,s._z,s._x,s._y,s.id),s.state&&(this.state=Object.assign({},s.state)),this.target=t.target,this.namespace=t.namespace,t.properties&&(this.properties=t.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=s.source,this.sourceLayer=s.sourceLayer,this.layer=s.layer)}toJSON(){const s=super.toJSON();return s.target=this.target,s.namespace=this.namespace,s}},i.du=hA,i.dv=oi,i.dw=function(s){return s({pluginStatus:zs,pluginURL:rf}),hA.on("pluginStateChange",s),s},i.dx=Tp,i.dy=class extends hc{constructor(s){super(s),this.current=Lg}set(s,t,o){if(this.fetchUniformLocation(s,t)){for(let u=0;u<9;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},i.dz=Me,i.e=ss,i.e$=function(){const s=Yt;s&&(s.isPreloaded()&&s.numActive()===1?(s.release(Pi),Yt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.e0=Is,i.e1=(s,t,o,u,f,A,v,C,P,k)=>{const U=s.transform,$=U.pitch<15?XI(.07,.7,ce((14-U.zoom)/5,0,1)):.07,q=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:QI(s,t,o,u),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:U.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:f,u_width_scale:A,u_floor_width_scale:v,u_image:0,u_tile_units_to_pixels:YI(t,U),u_units_to_pixels:[1/U.pixelsToGLUnits[0],1/U.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:C,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(q?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:$,u_tile_to_meter:_t(t.tileID.canonical,0),u_ground_shadow_factor:P,u_pattern_transition:k}},i.e2=(s,t,o,u,f,A,v,C,P,k)=>{const U=s.transform,$=U.calculatePixelsToTileUnitsMatrix(t),q=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",K=U.pitch<15?XI(.07,.7,ce((14-U.zoom)/5,0,1)):.07;return{u_matrix:QI(s,t,o,u),u_pixels_to_tile_units:$,u_device_pixel_ratio:A,u_width_scale:v,u_floor_width_scale:C,u_units_to_pixels:[1/U.pixelsToGLUnits[0],1/U.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:f,u_texsize:JI(o)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:YI(t,s.transform),u_alpha_discard_threshold:0,u_trim_offset:P,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(q?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:K,u_tile_to_meter:_t(t.tileID.canonical,0),u_ground_shadow_factor:k}},i.e3=Fr,i.e4=zA,i.e5=Ve,i.e6=Fg,i.e7=j0,i.e8=c_,i.e9=Nd,i.eA=ha,i.eB=zd,i.eC=function(s,t,o,u,f,A,v,C,P,k,U,$,q,K,J,de){var Ae=new B(16);return Ae[0]=s,Ae[1]=t,Ae[2]=o,Ae[3]=u,Ae[4]=f,Ae[5]=A,Ae[6]=v,Ae[7]=C,Ae[8]=P,Ae[9]=k,Ae[10]=U,Ae[11]=$,Ae[12]=q,Ae[13]=K,Ae[14]=J,Ae[15]=de,Ae},i.eD=se,i.eE=kd,i.eF=dm,i.eG=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new rr(1/0,1/0),max:new rr(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(s,t=!1){const o=l1(new rr(0,0),new rr(mr,mr),s),u=[];if(t&&!Dy(o,this._globalClipBounds))return u;for(const f of this._activeRegions){if(f.hiddenByOverlap||!Dy(o,f))continue;const A=c1(f.min,f.max,s);u.push({min:A.min,max:A.max,sourceId:this._sourceIds[f.priority],footprint:f.footprint,footprintTileId:f.tileId,order:f.order,clipMask:f.clipMask,clipScope:f.clipScope})}return u}setSources(s){this._setSources(s.map((t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const o=[];for(const u of t.cache.getVisibleCoordinates()){const f=t.cache.getTile(u).buckets[t.layer];f&&f.updateFootprints(u.toUnwrapped(),o)}return o},getOrder:()=>t.order,getClipMask:()=>t.clipMask,getClipScope:()=>t.clipScope}))))}_addSource(s){const t=s.getFootprints();if(t.length===0)return;const o=s.getOrder(),u=s.getClipMask(),f=s.getClipScope();for(const A of t){if(!A.footprint)continue;const v=l1(A.footprint.min,A.footprint.max,A.id);this._activeRegions.push({min:v.min,max:v.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:A.id,footprint:A.footprint,order:o,clipMask:u,clipScope:f})}this._sourceIds.push(s.getSourceId())}_computeReplacement(){this._activeRegions.sort(((t,o)=>t.priority-o.priority||Im(t.min,o.min)||Im(t.max,o.max)||t.order-o.order||t.clipMask-o.clipMask||(function(u,f){const A=(v,C)=>v+C;return u.length-f.length||u.reduce(A,"").localeCompare(f.reduce(A,""))})(t.clipScope,o.clipScope)));let s=this._activeRegions.length!==this._prevRegions.length;if(!s){let t=0;for(;!s&&t!==this._activeRegions.length;){const o=this._activeRegions[t],u=this._prevRegions[t];s=o.priority!==u.priority||!i_(o,u)||o.order!==u.order||o.clipMask!==u.clipMask||!Ul(o.clipScope,u.clipScope),++t}}if(s){++this._updateTime;for(const o of this._activeRegions)o.order!==z0&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const t=o=>{const u=this._activeRegions;if(o>=u.length)return o;const f=u[o].priority;for(;o<u.length&&u[o].priority===f;)++o;return o};if(this._sourceIds.length>1){let o=0,u=t(o);for(;o!==u;){let f=o;const A=o;for(;f!==u;){const v=this._activeRegions[f];v.hiddenByOverlap=!1;for(let C=0;C<A;C++){const P=this._activeRegions[C];if(!P.hiddenByOverlap&&v.order===z0&&Dy(v,P)&&(v.hiddenByOverlap=Oy(v.footprint,v.tileId,P.footprint,P.tileId),v.hiddenByOverlap))break}++f}o=u,u=t(o)}}}}_setSources(s){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=s.length-1;t>=0;t--)this._addSource(s[t]);this._computeReplacement()}},i.eH=z0,i.eI=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.withSkirts.destroy(),s.withoutSkirts.destroy()}_fillGridMeshWithLods(s,t){const o=new uc,u=new ea,f=[],A=s+1+2,v=t[0]+1,C=t[0]+1+(1+t.length),P=(k,U,$)=>{let q=k===A-1?k-2:k===0?k:k-1;return q+=$?24575:0,[q,U]};for(let k=0;k<A;++k)o.emplaceBack(...P(k,0,!0));for(let k=0;k<v;++k)for(let U=0;U<A;++U)o.emplaceBack(...P(U,k,(U===0||U===A-1)&&!0));for(let k=0;k<t.length;++k){const U=t[k];for(let $=0;$<A;++$)o.emplaceBack(...P($,U,!0))}for(let k=0;k<t.length;++k){const U=u.length,$=t[k]+1+2,q=new ea;for(let de=0;de<$-1;de++){const Ae=de===$-2,_e=Ae?A*(C-t.length+k-de):A;for(let Ie=0;Ie<A-1;Ie++){const Pe=de*A+Ie;de===0||Ae||Ie===0||Ie===A-2?(q.emplaceBack(Pe+1,Pe,Pe+_e),q.emplaceBack(Pe+_e,Pe+_e+1,Pe+1)):(u.emplaceBack(Pe+1,Pe,Pe+_e),u.emplaceBack(Pe+_e,Pe+_e+1,Pe+1))}}const K=No.simpleSegment(0,U,o.length,u.length-U);for(let de=0;de<q.uint16.length;de+=3)u.emplaceBack(q.uint16[de],q.uint16[de+1],q.uint16[de+2]);const J=No.simpleSegment(0,U,o.length,u.length-U);f.push({withoutSkirts:K,withSkirts:J})}return{vertices:o,indices:u,segments:f}}_createGrid(s){const t=this._fillGridMeshWithLods(D,N);this._gridSegments=t.segments,this._gridBuffer=s.createVertexBuffer(t.vertices,Ng.members),this._gridIndexBuffer=s.createIndexBuffer(t.indices,!0)}_createPoles(s){const t=new ea;for(let v=0;v<=D;v++)t.emplaceBack(0,v+1,v+2);this._poleIndexBuffer=s.createIndexBuffer(t,!0);const o=new Xf,u=new Xf,f=new Xf,A=new Xf;this._poleSegments=[];for(let v=0,C=0;v<x;v++){const P=360/(1<<v);o.emplaceBack(0,-d,0,.5,0),u.emplaceBack(0,-d,0,.5,1),f.emplaceBack(0,-d,0,.5,.5),A.emplaceBack(0,-d,0,.5,.5);for(let k=0;k<=D;k++){let U=k/D,$=0;const q=hn(0,P,U),[K,J,de]=ee(vy,xy,q,d);o.emplaceBack(K,J,de,U,$),u.emplaceBack(K,J,de,U,1-$);const Ae=ut(q);U=.5+.5*Math.sin(Ae),$=.5+.5*Math.cos(Ae),f.emplaceBack(K,J,de,U,$),A.emplaceBack(K,J,de,U,1-$)}this._poleSegments.push(No.simpleSegment(C,0,66,64)),C+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(o,M0,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(u,M0,!1),this._texturedPoleNorthVertexBuffer=s.createVertexBuffer(f,M0,!1),this._texturedPoleSouthVertexBuffer=s.createVertexBuffer(A,M0,!1)}getGridBuffers(s,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[s].withSkirts:this._gridSegments[s].withoutSkirts]}getPoleBuffers(s,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}},i.eJ=s1,i.eK=ze,i.eL=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.eM=g,i.eN=Ot,i.eO=function(s,t,o){return s[0]=t[0]/o[0],s[1]=t[1]/o[1],s[2]=t[2]/o[2],s},i.eP=mo,i.eQ=Y,i.eR=ln,i.eS=Et,i.eT=function([s,t,o]){const u=Math.hypot(s,t,o),f=Math.atan2(s,o),A=.5*Math.PI-Math.acos(-t/u);return new he(le(f),le(A))},i.eU=$o,i.eV=K2,i.eW=function(s){const t=s.navigator?s.navigator.userAgent:null;return!!(function(o){if(yn==null){const u=o.navigator?o.navigator.userAgent:null;yn=!!o.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return yn})(s)&&!(!t||!(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},i.eX=function(s,t){vl=s,cl=t},i.eY=Gg,i.eZ=yy,i.e_=function(s){const t=[0,0,0],o=oe(new Float64Array(16));return ye(o,s.pixelMatrix,s.globeMatrix),Gr(t,t,o),new rr(t[0],t[1])},i.ea=450,i.eb=7,i.ec=lt,i.ed=function(s,t){if(s===t){var o=t[1],u=t[2],f=t[3],A=t[6],v=t[7],C=t[11];s[1]=t[4],s[2]=t[8],s[3]=t[12],s[4]=o,s[6]=t[9],s[7]=t[13],s[8]=u,s[9]=A,s[11]=t[14],s[12]=f,s[13]=v,s[14]=C}else s[0]=t[0],s[1]=t[4],s[2]=t[8],s[3]=t[12],s[4]=t[1],s[5]=t[5],s[6]=t[9],s[7]=t[13],s[8]=t[2],s[9]=t[6],s[10]=t[10],s[11]=t[14],s[12]=t[3],s[13]=t[7],s[14]=t[11],s[15]=t[15];return s},i.ee=GU,i.ef=ii,i.eg=qa,i.eh=256,i.ei=Vg,i.ej=fl,i.ek=Ee,i.el=function(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[4],s[4]=t[5],s[5]=t[6],s[6]=t[8],s[7]=t[9],s[8]=t[10],s},i.em=Xf,i.en=xp,i.eo=O,i.ep=function(s,t,o,u,f){return ce((s-t)/(o-t)*(f-u)+u,u,f)},i.eq=Qa,i.er=function(s,t){var o=t[0],u=t[1],f=t[2],A=t[3],v=t[4],C=t[5],P=t[6],k=t[7],U=t[8],$=U*v-C*k,q=-U*A+C*P,K=k*A-v*P,J=o*$+u*q+f*K;return J?(s[0]=$*(J=1/J),s[1]=(-U*u+f*k)*J,s[2]=(C*u-f*v)*J,s[3]=q*J,s[4]=(U*o-f*P)*J,s[5]=(-C*o+f*A)*J,s[6]=K*J,s[7]=(-k*o+u*P)*J,s[8]=(v*o-u*A)*J,s):null},i.es=2,i.et=tn,i.eu=J2,i.ev=[1,1,1],i.ew=A_,i.ex=Ao,i.ey=function(s,t,o,u){var f=t[0],A=t[1],v=t[2],C=t[3];return s[0]=f+u*(o[0]-f),s[1]=A+u*(o[1]-A),s[2]=v+u*(o[2]-v),s[3]=C+u*(o[3]-C),s},i.ez=u_,i.f=function(s){return btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,((t,o)=>String.fromCharCode(+("0x"+o)))))},i.f0=function(){nr().acquire(Pi)},i.f1=am,i.f2=function(s,t,o=!1){if(zs===Il.deferred||zs===Il.loading||zs===Il.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");rf=Vl.resolveURL(s),zs=Il.deferred,cA=t,uA(),o||nf()},i.f3=function(s){fi=Vl.resolveURL(s),ko||(ko=new Yo(nr(),new Tc)),ko.broadcast("setMeshoptUrl",fi)},i.f4=bI,i.f5=function(s){fo=Vl.resolveURL(s),ko||(ko=new Yo(nr(),new Tc)),ko.broadcast("setDracoUrl",fo)},i.f6=xI,i.f7=gr,i.f8=function(s){const t=fd();if(!t)return;const o=t.delete(ll);s&&o.then((()=>s())).catch(s)},i.f9=li,i.fA=function(s){dd(),gs?.then((t=>{t.keys().then((o=>{for(let u=0;u<o.length-s;u++)t.delete(o[u]).catch((f=>Fn(f.message)))})).catch((o=>Fn(o.message)))})).catch((t=>Fn(t.message)))},i.fa=Rr,i.fb=Ip,i.fc=Ud,i.fd=WR,i.fe=ZR,i.ff=HI,i.fg=In,i.fh="hd_road_elevation",i.fi=ho,i.fj=wr,i.fk=Hc,i.fl=dS,i.fm=W0,i.fn=function(s,t,o,u,f,A,v,C=1,P,k,U){s.createArrays(),s.tilePixelRatio=mr/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const $=s.layers[0].layout,q=s.layers[0]._unevaluatedLayout._values,K={};K.scaleFactor=C,K.textSizeScaleRange=$.get("text-size-scale-range"),K.iconSizeScaleRange=$.get("icon-size-scale-range");const[J,de]=K.textSizeScaleRange,[Ae,_e]=K.iconSizeScaleRange;K.textScaleFactor=ce(K.scaleFactor,J,de),K.iconScaleFactor=ce(K.scaleFactor,Ae,_e);const Ie=q["text-size"],Pe=q["icon-size"];if(s.textSizeData.kind==="composite"){const{minZoom:ct,maxZoom:$t}=s.textSizeData;K.compositeTextSizes=[Ie.possiblyEvaluate(new co(ct,{worldview:U}),A),Ie.possiblyEvaluate(new co($t,{worldview:U}),A)]}if(s.iconSizeData.kind==="composite"){const{minZoom:ct,maxZoom:$t}=s.iconSizeData;K.compositeIconSizes=[Pe.possiblyEvaluate(new co(ct,{worldview:U}),A),Pe.possiblyEvaluate(new co($t,{worldview:U}),A)]}K.layoutTextSize=Ie.possiblyEvaluate(new co(v+1,{worldview:U}),A),K.layoutIconSize=Pe.possiblyEvaluate(new co(v+1,{worldview:U}),A),K.textMaxSize=Ie.possiblyEvaluate(new co(18,{worldview:U}),A);const ke=$.get("symbol-placement"),Ye=$.get("text-rotation-alignment")==="map"&&ke!=="point",Qe=$.get("text-size");let tt=!1;const it=[];for(const ct of s.features){const $t=$.get("text-font").evaluate(ct,{},A).join(","),mt=Qe.evaluate(ct,{},A)*K.textScaleFactor,Wt=K.layoutTextSize.evaluate(ct,{},A)*K.textScaleFactor,sr=K.layoutIconSize.evaluate(ct,{},A)*K.iconScaleFactor,Kt={horizontal:{},vertical:void 0},er=ct.text;let hr,Nt=[0,0];if(er){const Qr=er.toString(),vn=$.get("text-letter-spacing").evaluate(ct,{},A)*Ns,kn=$.get("text-line-height").evaluate(ct,{},A)*Ns,Qn=mh(Qr)?vn:0,Vn=$.get("text-anchor").evaluate(ct,{},A),jr=$.get("text-variable-anchor");if(!jr){const Ct=$.get("text-radial-offset").evaluate(ct,{},A);if(Ct)Nt=PP(Vn,[Ct*Ns,mS]);else{const Ut=$.get("text-offset").evaluate(ct,{},A);Nt=[Ut[0]*Ns,Ut[1]*Ns]}}let Ln=Ye?"center":$.get("text-justify").evaluate(ct,{},A);const gi=ke==="point",Ne=gi?$.get("text-max-width").evaluate(ct,{},A)*Ns:1/0,je=Ct=>{s.allowVerticalPlacement&&om(Qr)&&(Kt.vertical=uS(er,t,o,f,$t,Ne,kn,Vn,Ct,Qn,Nt,ju.vertical,!0,Wt,mt,P))};if(!Ye&&jr){const Ct=Ln==="auto"?jr.map((Sr=>AS(Sr))):[Ln];let Ut=!1;for(let Sr=0;Sr<Ct.length;Sr++){const br=Ct[Sr];if(!Kt.horizontal[br])if(Ut)Kt.horizontal[br]=Kt.horizontal[0];else{const Br=uS(er,t,o,f,$t,Ne,kn,"center",br,Qn,Nt,ju.horizontal,!1,Wt,mt,P);Br&&(Kt.horizontal[br]=Br,Ut=Br.positionedLines.length===1)}}je("left")}else{if(Ln==="auto"&&(Ln=AS(Vn)),gi||$.get("text-writing-mode").indexOf("horizontal")>=0||!om(Qr)){const Ct=uS(er,t,o,f,$t,Ne,kn,Vn,Ln,Qn,Nt,ju.horizontal,!1,Wt,mt,P);Ct&&(Kt.horizontal[Ln]=Ct)}je(gi?"left":Ln)}}let tr,Mt,St,pr,cr,nn,kr=!1;const Xr=$.get("icon-text-fit").evaluate(ct,{},A);if(ct.icon&&ct.icon.hasPrimary()){const Qr=DP(ct.icon,s.iconSizeData,q["icon-size"],A,s.zoom,ct,P,K.iconScaleFactor,U);tr=Qr.iconPrimary,St=Qr.iconSecondary;const vn=tr.toString();if(Mt=u.get(vn),Mt&&(cr=$.get("icon-offset").evaluate(ct,{},A),nn=$.get("icon-anchor").evaluate(ct,{},A),hr=vU(f.get(vn),St?f.get(St.toString()):void 0,cr,nn),kr=Mt.sdf,s.sdfIcons===void 0?s.sdfIcons=Mt.sdf:s.sdfIcons!==Mt.sdf&&Fn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Mt.pixelRatio!==s.pixelRatio||$.get("icon-rotate").constantOr(1)!==0)&&(s.iconsNeedLinear=!0)),St){const kn=St.toString();pr=u.get(kn)}}tt=tt||!(!ct.icon||!ct.icon.hasSecondary());const _r=gS(Kt.horizontal)||Kt.vertical;s.iconsInText||(s.iconsInText=!!_r&&_r.iconsInText);const en=Wt*K.textScaleFactor/Ns,{defaultShapedIcon:Cn,verticallyShapedIcon:Er}=PU(s,hr,$,ct,A,Kt,en,cr,Xr);Xr!=="none"&&hr&&(pP(hr)||mP(hr))&&(M1(0,Mt,tr,hr,Cn,Xr,k,u,f),M1(0,pr,St,hr,Cn,Xr,k,u,f),Er&&(M1(0,Mt,tr,hr,Er,Xr,k,u,f),M1(0,pr,St,hr,Er,Xr,k,u,f))),hr=Cn,it.push({feature:ct,shapedTextOrientations:Kt,shapedText:_r,shapedIcon:hr,iconPrimary:tr,iconSecondary:St,iconOffset:cr,iconAnchor:nn,verticallyShapedIcon:Er,layoutTextSize:Wt,layoutIconSize:sr,textOffset:Nt,isSDFIcon:kr,iconTextFit:Xr})}return{featureData:it,sizes:K,hasAnySecondaryIcon:tt,textAlongLine:Ye,symbolPlacement:ke}},i.fo=SP,i.fp=function(s,t,o,u,f,A,v,C,P,k){const{featureData:U,hasAnySecondaryIcon:$,sizes:q,textAlongLine:K,symbolPlacement:J}=t;for(const de of U){const{shapedIcon:Ae,verticallyShapedIcon:_e,feature:Ie,shapedTextOrientations:Pe,shapedText:ke,layoutTextSize:Ye,textOffset:Qe,isSDFIcon:tt,iconPrimary:it,iconSecondary:ct,iconTextFit:$t,iconOffset:mt}=de;OP(Ae,k.iconPositions,it,ct),OP(_e,k.iconPositions,it,ct),IU(Pe,k.iconPositions),MU(it,ct,k.iconPositions),(ke||Ae)&&RU(s,Ie,Pe,Ae,_e,P,q,Ye,0,Qe,tt,u,f,v,C,$,$t,mt,K,J)}o&&s.generateCollisionDebugBuffers(A,s.collisionBoxArray,q.textScaleFactor)},i.fq=rn,i.fr=Z1,i.fs=Xt,i.ft=function(s){let t=0;if(new Uint32Array(s,0,1)[0]!==SI){const o=new Uint32Array(s,0,7),[,,u,f,A,v]=o;t=o.byteLength+f+A+v+A,(u!==s.byteLength||t>=s.byteLength)&&Fn("Invalid b3dm header information.")}return MI(s,t)},i.fu=function(s,t){const o=LI(s);for(const u of o){for(const f of u.meshes)Cj(f);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(Mj(u.lights,t)))}return o},i.fv=V1,i.fw=Ui,i.fx=Ar,i.fy=Ru,i.fz=Il,i.g=function(s,t){return oi(Object.assign(s,{method:"GET"}),t)},i.h=function(s){return s.indexOf("mapbox:")===0},i.i=function(s){return ss.API_STYLE_REGEX.test(s)&&!Qp(s)},i.j=Fe,i.k=Fo,i.l=function(s){return decodeURIComponent(atob(s).split("").map((t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2))).join(""))},i.m=function(s,t){return oi(Object.assign(s,{type:"json"}),t)},i.n=cu,i.o=Vl,i.p=function(s,t){return oi(Object.assign(s,{method:"POST"}),t)},i.q=Bs,i.r=Df,i.s=function(s){try{const t=self[s];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=function(){return Ft||(Ft=new li),Ft},i.u=function(){return(function s(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)})()},i.v=function(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)},i.w=Fn,i.x=DS,i.y=ya,i.z=Ka})),y(["./shared"],(function(i){function z(ut){const le=ut?ut.url.toString():void 0;return le?performance.getEntriesByName(le):[]}function B(ut){if(typeof ut=="number"||typeof ut=="boolean"||typeof ut=="string"||ut==null)return JSON.stringify(ut);if(Array.isArray(ut)){let ge="[";for(const Me of ut)ge+=`${B(Me)},`;return`${ge}]`}let le="{";for(const ge of Object.keys(ut).sort())le+=`${ge}:${B(ut[ge])},`;return`${le}}`}function F(ut){let le="";for(const ge of i.bx)le+=`/${B(ut[ge])}`;return le}class G{constructor(le){this.keyCache={},this._layers={},this._layerConfigs={},le&&this.replace(le)}replace(le,ge){this._layerConfigs={},this._layers={},this.update(le,[],ge)}update(le,ge,Me){this._options=Me;for(const g of le)this._layerConfigs[g.id]=g,(this._layers[g.id]=i.dq(g,this.scope,null,this._options)).compileFilter(Me),this.keyCache[g.id]&&delete this.keyCache[g.id];for(const g of ge)delete this.keyCache[g],delete this._layerConfigs[g],delete this._layers[g];this.familiesBySource={};const ze=(function(g,ce){const At={};for(let vt=0;vt<g.length;vt++){const Lt=g[vt];let kt=ce&&ce[Lt.id];kt||(Lt.type==="symbol"?kt=Lt.id:(kt=F(Lt),Lt.type==="line"&&Lt.paint&&(function Dr(wr){return typeof wr=="string"&&wr==="line-progress"||(Array.isArray(wr)?wr.some(Dr):!(!wr||typeof wr!="object")&&Object.values(wr).some(Dr))})(Lt.paint["line-width"])&&(kt+=`/${B(Lt.paint["line-width"])}`))),ce&&(ce[Lt.id]=kt);let Fr=At[kt];Fr||(Fr=At[kt]=[]),Fr.push(Lt)}const Je=[];for(const vt in At)Je.push(At[vt]);return Je})(Object.values(this._layerConfigs),this.keyCache);for(const g of ze){const ce=g.map((Fr=>this._layers[Fr.id])),At=ce[0];if(At.visibility==="none")continue;const Je=At.source||"";let vt=this.familiesBySource[Je];vt||(vt=this.familiesBySource[Je]={});const Lt=At.sourceLayer||"_geojsonTileLayer";let kt=vt[Lt];kt||(kt=vt[Lt]=[]),kt.push(ce)}}}const Q=1*i.fc;class te{constructor(le){const ge={},Me=[];for(const At in le){const Je=le[At],vt=ge[At]={};for(const Lt in Je.glyphs){const kt=Je.glyphs[+Lt];if(!kt||kt.bitmap.width===0||kt.bitmap.height===0)continue;const Fr=kt.metrics.localGlyph?Q:1,Dr={x:0,y:0,w:kt.bitmap.width+2*Fr,h:kt.bitmap.height+2*Fr};Me.push(Dr),vt[Lt]=Dr}}const{w:ze,h:g}=i.G(Me),ce=new i.fb({width:ze||1,height:g||1});for(const At in le){const Je=le[At];for(const vt in Je.glyphs){const Lt=Je.glyphs[+vt];if(!Lt||Lt.bitmap.width===0||Lt.bitmap.height===0)continue;const kt=ge[At][vt],Fr=Lt.metrics.localGlyph?Q:1;i.fb.copy(Lt.bitmap,ce,{x:0,y:0},{x:kt.x+Fr,y:kt.y+Fr},Lt.bitmap)}}this.image=ce,this.positions=ge}}i.fa(te,"GlyphAtlas");class ne{constructor(le){this.tileID=new i.aO(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.tileZoom=le.tileZoom,this.uid=le.uid,this.zoom=le.zoom,this.lut=le.lut,this.canonical=le.tileID.canonical,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.scope=le.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=le.showCollisionBoxes,this.collectResourceTiming=!!le.request&&le.request.collectResourceTiming,this.promoteId=le.promoteId,this.isSymbolTile=le.isSymbolTile,this.tileTransform=i.aZ(le.tileID.canonical,le.projection),this.projection=le.projection,this.worldview=le.worldview,this.localizableLayerIds=le.localizableLayerIds,this.brightness=le.brightness,this.extraShadowCaster=!!le.extraShadowCaster,this.tessellationStep=le.tessellationStep,this.scaleFactor=le.scaleFactor,this.worldview=le.worldview}parse(le,ge,Me,ze,g,ce){this.status="parsing",this.data=le,this.collisionBoxArray=new i.b3;const At=new i.fd(Object.keys(le.layers).sort()),Je=new i.fe(this.tileID,this.promoteId);Je.bucketLayerIDs=[];const vt={},Lt=new i.ff(256,256),kt={featureIndex:Je,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Lt,availableImages:Me,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Fr=[],Dr=ge.familiesBySource[this.source];for(const zn in Dr){const Un=le.layers[zn];if(!Un)continue;let Yn=!1,Ii=!1,Fn=!1;for(const Ui of Dr[zn])Ui[0].type==="symbol"?Yn=!0:Ii=!0,Ui[0].is3D()&&Ui[0].type!=="model"&&(Fn=!0);if(this.extraShadowCaster&&!Fn||this.isSymbolTile===!0&&!Yn||this.isSymbolTile===!1&&!Ii)continue;Un.version===1&&i.w(`Vector tile source "${this.source}" layer "${zn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const go=At.encode(zn),wo=[];let ia=!1;for(let Ui=0,ri=0;Ui<Un.length;Ui++){const yn=Un.feature(Ui),He=Je.getId(yn,zn);if(this.localizableLayerIds&&this.localizableLayerIds.has(zn)){const mn=yn.properties?yn.properties.worldview:null;if(this.worldview&&typeof mn=="string")if(mn==="all")yn.properties.$localized=!0;else{if(!mn.split(",").includes(this.worldview))continue;yn.properties.$localized=!0,yn.properties.worldview=this.worldview}}!ia&&yn.properties&&yn.properties.hasOwnProperty(i.fg)&&(ia=!0),wo.push({feature:yn,id:He,index:ri,sourceLayerIndex:go}),ri++}ia&&!kt.elevationFeatures&&le.layers.hasOwnProperty(i.fh)&&(kt.elevationFeatures=i.fi.parseFrom(le.layers[i.fh],this.canonical));for(const Ui of Dr[zn]){const ri=Ui[0];if(this.extraShadowCaster&&(!ri.is3D()||ri.type==="model")||this.isSymbolTile!==void 0&&ri.type==="symbol"!==this.isSymbolTile||ri.minzoom&&this.zoom<Math.floor(ri.minzoom)||ri.maxzoom&&this.zoom>=ri.maxzoom||ri.visibility==="none")continue;oe(Ui,this.zoom,kt.brightness,Me,this.worldview);const yn=vt[ri.id]=ri.createBucket({index:Je.bucketLayerIDs.length,layers:Ui,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:go,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:ze,worldview:this.worldview});Je.bucketLayerIDs.push(Ui.map((mn=>i.B(mn.id,mn.scope))));let He=yn.prepare?yn.prepare():null;He!=null?(He=He.then((()=>yn.populate(wo,kt,this.tileID.canonical,this.tileTransform))),Fr.push(He)):yn.populate(wo,kt,this.tileID.canonical,this.tileTransform)}}const wr=()=>{let zn,Un,Yn,Ii,Fn,go;Lt.trim();const wo={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ia=()=>{if(zn)return this.status="done",ce(zn);if(this.extraShadowCaster)this.status="done",ce(null,{buckets:Object.values(vt).filter((ri=>!ri.isEmpty())),featureIndex:Je,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:kt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Un&&Yn&&Ii){const ri=new te(Un),yn=new Map;for(const[ca,as]of Yn.entries()){const{imagePosition:Hs}=i.fl(ca,as,i.fm);yn.set(ca,Hs)}const He={};for(const ca in vt){const as=vt[ca];as instanceof i.b4&&(oe(as.layers,this.zoom,kt.brightness,Me,this.worldview),He[ca]=i.fn(as,Un,ri.positions,Yn,yn,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,Fn,this.worldview))}const mn={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(g,Yn,Fn,(()=>{mn.iconsPending=!1,Ui(He,ri,mn)})),this.rasterizeIfNeeded(g,Ii,go,(()=>{mn.patternsPending=!1,Ui(He,ri,mn)}))}},Ui=(ri,yn,He,mn)=>{if(He.iconsPending||He.patternsPending)return;const ca=new i.fo(Yn,Ii,this.lut);for(const as in vt){const Hs=vt[as];if(as in ri)i.fp(Hs,ri[as],this.showCollisionBoxes,Me,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Yn,ca);else if(Hs.hasPattern&&(Hs instanceof i.ba||Hs instanceof i.bb||Hs instanceof i.e7)){oe(Hs.layers,this.zoom,kt.brightness,Me,this.worldview);const tu=Object.fromEntries(ca.patternPositions);Hs.addFeatures(kt,this.tileID.canonical,tu,Me,this.tileTransform,this.brightness)}}this.status="done",ce(null,{buckets:Object.values(vt).filter((as=>!as.isEmpty())),featureIndex:Je,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yn.image,lineAtlas:Lt,imageAtlas:ca,brightness:kt.brightness})};if(!this.extraShadowCaster){const ri=i.fj(kt.glyphDependencies,(mn=>Object.keys(mn).map(Number)));Object.keys(ri).length?g.send("getGlyphs",{uid:this.uid,stacks:ri},((mn,ca)=>{zn||(zn=mn,Un=ca,ia())}),void 0,!1,wo):Un={};const yn=Array.from(kt.iconDependencies.keys()).map((mn=>i.I.parse(mn)));yn.length?g.send("getImages",{images:yn,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((mn,ca)=>{zn||(zn=mn,Yn=new Map,Fn=this.updateImageMapAndGetImageTaskQueue(Yn,ca,kt.iconDependencies),ia())}),void 0,!1,wo):(Yn=new Map,Fn=new Map);const He=Array.from(kt.patternDependencies.keys()).map((mn=>i.I.parse(mn)));He.length?g.send("getImages",{images:He,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((mn,ca)=>{zn||(zn=mn,Ii=new Map,go=this.updateImageMapAndGetImageTaskQueue(Ii,ca,kt.patternDependencies),ia())}),void 0,!1,wo):(Ii=new Map,go=new Map)}if(kt.elevationFeatures&&kt.elevationFeatures.length>0){const ri=[];for(const He of Object.values(vt))if(He instanceof i.bb){const mn=He.getUnevaluatedPortalGraph();mn&&ri.push(mn)}const yn=i.fk.evaluate(ri);for(const He of Object.values(vt))if(He instanceof i.bb){const mn=le.layers[At.decode(He.sourceLayerIndex)];He.setEvaluatedPortalGraph(yn,mn,this.tileID.canonical,kt.availableImages,kt.brightness)}}ia()};Fr.length>0?Promise.allSettled(Fr).then(wr).catch(ce):wr()}rasterizeIfNeeded(le,ge,Me,ze){Array.from(ge.values()).some((g=>g.usvg))?this.rasterize(le,ge,Me,ze):ze()}updateImageMapAndGetImageTaskQueue(le,ge,Me){const ze=new Map;for(const g of ge.keys()){const ce=Me.get(g)||[];for(const At of ce){const Je=At.toString(),vt=ge.get(At.id.toString());vt.usvg?ze.has(Je)||(ze.set(Je,At),le.set(Je,Object.assign({},vt))):le.set(Je,vt)}}return ze}rasterize(le,ge,Me,ze){this.rasterizeTask=le.send("rasterizeImages",{scope:this.scope,tasks:Me},((g,ce)=>{if(!g)for(const[At,Je]of ce.entries()){const vt=Object.assign(ge.get(At),{data:Je});ge.set(At,vt)}ze()}))}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function oe(ut,le,ge,Me,ze){const g=new i.ac(le,{brightness:ge,worldview:ze});for(const ce of ut)ce.recalculate(g,Me)}class ue extends i.E{constructor(le,ge,Me,ze,g,ce,At){super(),this.actor=le,this.layerIndex=ge,this.availableImages=Me,this.availableModels=ze,this.loadVectorData=ce||i.aL,this.loading={},this.loaded={},this.deduped=new i.aK(le.scheduler),this.isSpriteLoaded=g,this.scheduler=le.scheduler,this.brightness=At}loadTile(le,ge){const Me=le.uid,ze=le&&le.request,g=ze&&ze.collectResourceTiming,ce=this.loading[Me]=new ne(le);ce.abort=this.loadVectorData(le,((At,Je)=>{const vt=!this.loading[Me];if(delete this.loading[Me],ce.cancelRasterize(),vt||At||!Je)return ce.status="done",vt||(this.loaded[Me]=ce),ge(At);const Lt=Je.rawData,kt={};Je.expires&&(kt.expires=Je.expires),Je.cacheControl&&(kt.cacheControl=Je.cacheControl),ce.vectorTile=Je.vectorTile||new i.fq(new i.bt(Lt));const Fr=()=>{ce.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,((Dr,wr)=>{if(Dr||!wr)return ge(Dr);const zn={};if(g){const Un=z(ze);Un.length>0&&(zn.resourceTiming=JSON.parse(JSON.stringify(Un)))}ge(null,Object.assign({rawTileData:Lt.slice(0)},wr,kt,zn))}))};this.isSpriteLoaded?Fr():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(Fr,{type:"parseTile",isSymbolTile:le.isSymbolTile,zoom:le.tileZoom}):Fr()})),this.loaded=this.loaded||{},this.loaded[Me]=ce}))}reloadTile(le,ge){const Me=this.loaded,ze=le.uid;if(Me&&Me[ze]){const g=Me[ze];g.scaleFactor=le.scaleFactor,g.showCollisionBoxes=le.showCollisionBoxes,g.projection=le.projection,g.brightness=le.brightness,g.tileTransform=i.aZ(le.tileID.canonical,le.projection),g.extraShadowCaster=le.extraShadowCaster,g.lut=le.lut,g.worldview=le.worldview;const ce=(At,Je)=>{const vt=g.reloadCallback;vt&&(delete g.reloadCallback,g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,vt)),ge(At,Je)};g.status==="parsing"?g.reloadCallback=ce:g.status==="done"&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,ce):ce())}else ge(null,void 0)}abortTile(le,ge){const Me=le.uid,ze=this.loading[Me];ze&&(ze.abort&&ze.abort(),delete this.loading[Me]),ge()}removeTile(le,ge){const Me=this.loaded,ze=le.uid;Me&&Me[ze]&&delete Me[ze],ge()}}class ye{loadTile(le,ge){const{uid:Me,encoding:ze,rawImageData:g,padding:ce}=le,At=ImageBitmap&&g instanceof ImageBitmap?this.getImageData(g,ce):g;ge(null,new i.fr(Me,At,ze,ce<1))}reloadTile(le,ge){ge(null,null)}abortTile(le,ge){ge()}removeTile(le,ge){ge()}getImageData(le,ge){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(le.width,le.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=le.width,this.offscreenCanvas.height=le.height,this.offscreenCanvasContext.drawImage(le,0,0,le.width,le.height);const Me=this.offscreenCanvasContext.getImageData(-ge,-ge,le.width+2*ge,le.height+2*ge);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Me}}i.bs.setPbf(i.bt);class we{constructor(le){this._mrt=new i.bs(le.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=le.uid,this.tileID=le.tileID,this.source=le.source}parse(le,ge){const Me=this._mrt;this.status="parsing",this._entireBuffer=le;try{Me.parseHeader(le),this._isHeaderLoaded=!0;const ze=[];for(const g in Me.layers){const ce=Me.getLayer(g),At=ce.getDataRange(ce.getBandList()),Je=Me.createDecodingTask(At),vt=le.slice(At.firstByte,At.lastByte+1),Lt=i.bs.performDecoding(vt,Je).then((kt=>Je.complete(null,kt))).catch((kt=>Je.complete(kt,null)));ze.push(Lt)}Promise.allSettled(ze).then((()=>ge(null,Me))).catch((g=>ge(g)))}catch(ze){ge(ze)}}}class ve{constructor(le){this.actor=le,this.loading={},this.loaded={}}loadTile(le,ge){const Me=le.uid,ze=le.request,g=this.loading[Me]=new we(le),{cancel:ce}=i.bu(ze,((At,Je,vt,Lt)=>{const kt=!this.loading[Me];if(delete this.loading[Me],kt||At||!Je)return g.status="done",kt||(this.loaded[Me]=g),ge(At);g.parse(Je,((Fr,Dr)=>{if(Fr||!Dr)return ge(Fr);ge(null,Dr,vt,Lt)})),this.loaded[Me]=g}));g.abort=ce}reloadTile(le,ge){ge(null,void 0)}abortTile(le,ge){const Me=le.uid,ze=this.loading[Me];ze&&(ze.abort&&ze.abort(),delete this.loading[Me]),ge()}removeTile(le,ge){const Me=le.uid;this.loaded[Me]&&delete this.loaded[Me],ge()}decodeRasterArray(le,ge){i.bs.performDecoding(le.buffer,le.task).then((Me=>ge(null,Me))).catch((Me=>ge(Me)))}}const Ce=i.fs.prototype.toGeoJSON;class Ee{constructor(le){this._feature=le,this.extent=i.al,this.type=le.type,this.properties=le.tags,"id"in le&&!isNaN(le.id)&&(this.id=parseInt(le.id,10))}loadGeometry(){if(this._feature.type===1){const le=[];for(const ge of this._feature.geometry)le.push([new i.P(ge[0],ge[1])]);return le}{const le=[];for(const ge of this._feature.geometry){const Me=[];for(const ze of ge)Me.push(new i.P(ze[0],ze[1]));le.push(Me)}return le}}toGeoJSON(le,ge,Me){return Ce.call(this,le,ge,Me)}}class Be{constructor(le,ge){this.name=le,this.extent=i.al,this.length=ge.length,this._jsonFeatures=ge}feature(le){return new Ee(this._jsonFeatures[le])}}class Ke{constructor(le){this.layers={},this.extent=i.al;for(const ge of Object.keys(le))this.layers[ge]=new Be(ge,le[ge])}}const st=64/4096,dt=128;class bt{constructor(){this.features=new Map}clear(){this.features.clear()}load(le=[],ge){for(const Me of le){const ze=Me.id;if(ze==null)continue;let g=this.features.get(ze);g&&this.updateCache(g,ge),Me.geometry?(g=Re(Me),this.updateCache(g,ge),this.features.set(ze,g)):this.features.delete(ze),this.updateCache(g,ge)}}updateCache(le,ge){for(const{canonical:Me,uid:ze}of Object.values(ge)){const{z:g,x:ce,y:At}=Me;ht(le,Math.pow(2,g),ce,At)&&delete ge[ze]}}getTile(le,ge,Me){const ze=Math.pow(2,le),g=[];for(const ce of this.features.values())ht(ce,ze,ge,Me)&&g.push(et(ce,ze,ge,Me));return{features:g}}getFeatures(){return[...this.features.values()]}}function ht({minX:ut,minY:le,maxX:ge,maxY:Me},ze,g,ce){return ut<(g+1+st)/ze&&le<(ce+1+st)/ze&&ge>(g-st)/ze&&Me>(ce-st)/ze}function Re(ut){const{id:le,geometry:ge,properties:Me}=ut;if(!ge)return;if(ge.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:ze,coordinates:g}=ge,ce={id:le,type:1,geometry:[],tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},At=ce.geometry;if(ze==="Point")Pt(g,At,ce);else if(ze==="MultiPoint")for(const Je of g)Pt(Je,At,ce);else if(ze==="LineString")ce.type=2,wt(g,At,ce);else if(ze==="MultiLineString")ce.type=2,Et(g,At,ce);else if(ze==="Polygon")ce.type=3,Et(g,At,ce,!0);else{if(ze!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");ce.type=3;for(const Je of g)Et(Je,At,ce,!0)}return ce}function Pt([ut,le],ge,Me){const ze=i.aF(ut);let g=i.aJ(le);g=g<0?0:g>1?1:g,ge.push(ze,g),Me.minX=Math.min(Me.minX,ze),Me.minY=Math.min(Me.minY,g),Me.maxX=Math.max(Me.maxX,ze),Me.maxY=Math.max(Me.maxY,g)}function wt(ut,le,ge,Me=!1,ze=!1){const g=[];for(const ce of ut)Pt(ce,g,ge);le.push(g),Me&&(function(ce,At){let Je=0;for(let vt=0,Lt=ce.length,kt=Lt-2;vt<Lt;kt=vt,vt+=2)Je+=(ce[vt]-ce[kt])*(ce[vt+1]+ce[kt+1]);if(Je>0===At)for(let vt=0,Lt=ce.length;vt<Lt/2;vt+=2){const kt=ce[vt],Fr=ce[vt+1];ce[vt]=ce[Lt-2-vt],ce[vt+1]=ce[Lt-1-vt],ce[Lt-2-vt]=kt,ce[Lt-1-vt]=Fr}})(g,ze)}function Et(ut,le,ge,Me=!1){for(let ze=0;ze<ut.length;ze++)wt(ut[ze],le,ge,Me,ze===0)}function et(ut,le,ge,Me){const{id:ze,type:g,geometry:ce,tags:At}=ut,Je=[];if(g===1)(function(vt,Lt,kt,Fr,Dr){for(let wr=0;wr<vt.length;wr+=2){const zn=Math.round(i.al*(vt[wr+0]*Lt-kt)),Un=Math.round(i.al*(vt[wr+1]*Lt-Fr));Dr.push([zn,Un])}})(ce,le,ge,Me,Je);else for(const vt of ce)Zt(vt,le,ge,Me,Je);return{id:ze,type:g,geometry:Je,tags:At}}function Zt(ut,le,ge,Me,ze){const g=-dt,ce=i.al+dt;let At;for(let Je=0;Je<ut.length-2;Je+=2){let vt=Math.round(i.al*(ut[Je+0]*le-ge)),Lt=Math.round(i.al*(ut[Je+1]*le-Me)),kt=Math.round(i.al*(ut[Je+2]*le-ge)),Fr=Math.round(i.al*(ut[Je+3]*le-Me));const Dr=kt-vt,wr=Fr-Lt;vt<g&&kt<g||(vt<g?(Lt+=Math.round(wr*((g-vt)/Dr)),vt=g):kt<g&&(Fr=Lt+Math.round(wr*((g-vt)/Dr)),kt=g),Lt<g&&Fr<g||(Lt<g?(vt+=Math.round(Dr*((g-Lt)/wr)),Lt=g):Fr<g&&(kt=vt+Math.round(Dr*((g-Lt)/wr)),Fr=g),vt>=ce&&kt>=ce||(vt>=ce?(Lt+=Math.round(wr*((ce-vt)/Dr)),vt=ce):kt>=ce&&(Fr=Lt+Math.round(wr*((ce-vt)/Dr)),kt=ce),Lt>=ce&&Fr>=ce||(Lt>=ce?(vt+=Math.round(Dr*((ce-Lt)/wr)),Lt=ce):Fr>=ce&&(kt=vt+Math.round(Dr*((ce-Lt)/wr)),Fr=ce),At&&vt===At[At.length-1][0]&&Lt===At[At.length-1][1]||(At=[[vt,Lt]],ze.push(At)),At.push([kt,Fr])))))}}function ir({name:ut,features:le},ge){ge.writeStringField(1,ut),ge.writeVarintField(5,i.al);const Me=new Map,ze=new Map,g={keys:Me,values:ze,feature:null};for(const ce of le)g.feature=ce,ge.writeMessage(2,or,g);for(const ce of Me.keys())ge.writeStringField(3,ce);for(const ce of ze.keys())ge.writeMessage(4,ln,ce)}function or(ut,le){const ge=ut.feature;ge.id!==void 0&&Number.isSafeInteger(+ge.id)&&le.writeVarintField(1,+ge.id),ge.tags&&le.writeMessage(2,ft,ut),le.writeVarintField(3,ge.type),le.writeMessage(4,Cr,ge)}function ft({keys:ut,values:le,feature:ge},Me){for(const ze of Object.keys(ge.tags)){let g=ge.tags[ze];if(g===null)continue;let ce=ut.get(ze);ce===void 0&&(ce=ut.size,ut.set(ze,ce)),Me.writeVarint(ce);const At=typeof g;At!=="string"&&At!=="boolean"&&At!=="number"&&(g=JSON.stringify(g));let Je=le.get(g);Je===void 0&&(Je=le.size,le.set(g,Je)),Me.writeVarint(Je)}}function Vt(ut,le){return(le<<3)+(7&ut)}function Jt(ut){return ut<<1^ut>>31}function Cr(ut,le){const{geometry:ge,type:Me}=ut;let ze=0,g=0;if(Me===1){le.writeVarint(Vt(1,ge.length));for(const ce of ge){const At=ce[0]-ze,Je=ce[1]-g;le.writeVarint(Jt(At)),le.writeVarint(Jt(Je)),ze+=At,g+=Je}}else for(const ce of ge){le.writeVarint(Vt(1,1));const At=ce.length-(Me===3?1:0);for(let Je=0;Je<At;Je++){Je===1&&le.writeVarint(Vt(2,At-1));const vt=ce[Je][0]-ze,Lt=ce[Je][1]-g;le.writeVarint(Jt(vt)),le.writeVarint(Jt(Lt)),ze+=vt,g+=Lt}Me===3&&le.writeVarint(Vt(7,1))}}function ln(ut,le){const ge=typeof ut;ge==="string"?le.writeStringField(1,ut):ge==="boolean"?le.writeBooleanField(7,ut):ge==="number"&&(ut%1!=0?le.writeDoubleField(3,ut):ut<0?le.writeSVarintField(6,ut):le.writeVarintField(5,ut))}const tn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ut=>ut},Hr=Math.fround||(Nn=new Float32Array(1),ut=>(Nn[0]=+ut,Nn[0]));var Nn;const jn=3,Ur=5,Gr=6;class Sn{constructor(le){this.options=Object.assign(Object.create(tn),le),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(le){const{log:ge,minZoom:Me,maxZoom:ze}=this.options;ge&&console.time("total time");const g=`prepare ${le.length} points`;ge&&console.time(g),this.points=le;const ce=[];for(let Je=0;Je<le.length;Je++){const vt=le[Je];if(!vt.geometry)continue;const[Lt,kt]=vt.geometry.coordinates,Fr=Hr(wn(Lt)),Dr=Hr(Rn(kt));ce.push(Fr,Dr,1/0,Je,-1,1),this.options.reduce&&ce.push(0)}let At=this.trees[ze+1]=this._createTree(ce);ge&&console.timeEnd(g);for(let Je=ze;Je>=Me;Je--){const vt=+Date.now();At=this.trees[Je]=this._createTree(this._cluster(At,Je)),ge&&console.log("z%d: %d clusters in %dms",Je,At.numItems,+Date.now()-vt)}return ge&&console.timeEnd("total time"),this}getClusters(le,ge){let Me=((le[0]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,le[1]));let g=le[2]===180?180:((le[2]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,le[3]));if(le[2]-le[0]>=360)Me=-180,g=180;else if(Me>g){const kt=this.getClusters([Me,ze,180,ce],ge),Fr=this.getClusters([-180,ze,g,ce],ge);return kt.concat(Fr)}const At=this.trees[this._limitZoom(ge)],Je=At.range(wn(Me),Rn(ce),wn(g),Rn(ze)),vt=At.data,Lt=[];for(const kt of Je){const Fr=this.stride*kt;Lt.push(vt[Fr+Ur]>1?Tr(vt,Fr,this.clusterProps):this.points[vt[Fr+jn]])}return Lt}getChildren(le){const ge=this._getOriginId(le),Me=this._getOriginZoom(le),ze="No cluster with the specified id.",g=this.trees[Me];if(!g)throw new Error(ze);const ce=g.data;if(ge*this.stride>=ce.length)throw new Error(ze);const At=this.options.radius/(this.options.extent*Math.pow(2,Me-1)),Je=g.within(ce[ge*this.stride],ce[ge*this.stride+1],At),vt=[];for(const Lt of Je){const kt=Lt*this.stride;ce[kt+4]===le&&vt.push(ce[kt+Ur]>1?Tr(ce,kt,this.clusterProps):this.points[ce[kt+jn]])}if(vt.length===0)throw new Error(ze);return vt}getLeaves(le,ge,Me){const ze=[];return this._appendLeaves(ze,le,ge=ge||10,Me=Me||0,0),ze}getTile(le,ge,Me){const ze=this.trees[this._limitZoom(le)],g=Math.pow(2,le),{extent:ce,radius:At}=this.options,Je=At/ce,vt=(Me-Je)/g,Lt=(Me+1+Je)/g,kt={features:[]};return this._addTileFeatures(ze.range((ge-Je)/g,vt,(ge+1+Je)/g,Lt),ze.data,ge,Me,g,kt),ge===0&&this._addTileFeatures(ze.range(1-Je/g,vt,1,Lt),ze.data,g,Me,g,kt),ge===g-1&&this._addTileFeatures(ze.range(0,vt,Je/g,Lt),ze.data,-1,Me,g,kt),kt.features.length?kt:null}getClusterExpansionZoom(le){let ge=this._getOriginZoom(le)-1;for(;ge<=this.options.maxZoom;){const Me=this.getChildren(le);if(ge++,Me.length!==1)break;le=Me[0].properties.cluster_id}return ge}_appendLeaves(le,ge,Me,ze,g){const ce=this.getChildren(ge);for(const At of ce){const Je=At.properties;if(Je&&Je.cluster?g+Je.point_count<=ze?g+=Je.point_count:g=this._appendLeaves(le,Je.cluster_id,Me,ze,g):g<ze?g++:le.push(At),le.length===Me)break}return g}_createTree(le){const ge=new i.c3(le.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Me=0;Me<le.length;Me+=this.stride)ge.add(le[Me],le[Me+1]);return ge.finish(),ge.data=le,ge}_addTileFeatures(le,ge,Me,ze,g,ce){for(const At of le){const Je=At*this.stride,vt=ge[Je+Ur]>1;let Lt,kt,Fr;if(vt)Lt=Zi(ge,Je,this.clusterProps),kt=ge[Je],Fr=ge[Je+1];else{const zn=this.points[ge[Je+jn]];Lt=zn.properties;const[Un,Yn]=zn.geometry.coordinates;kt=wn(Un),Fr=Rn(Yn)}const Dr={type:1,geometry:[[Math.round(this.options.extent*(kt*g-Me)),Math.round(this.options.extent*(Fr*g-ze))]],tags:Lt};let wr;wr=vt||this.options.generateId?ge[Je+jn]:this.points[ge[Je+jn]].id,wr!==void 0&&(Dr.id=wr),ce.features.push(Dr)}}_limitZoom(le){return Math.max(this.options.minZoom,Math.min(Math.floor(+le),this.options.maxZoom+1))}_cluster(le,ge){const{radius:Me,extent:ze,reduce:g,minPoints:ce}=this.options,At=Me/(ze*Math.pow(2,ge)),Je=le.data,vt=[],Lt=this.stride;for(let kt=0;kt<Je.length;kt+=Lt){if(Je[kt+2]<=ge)continue;Je[kt+2]=ge;const Fr=Je[kt],Dr=Je[kt+1],wr=le.within(Je[kt],Je[kt+1],At),zn=Je[kt+Ur];let Un=zn;for(const Yn of wr){const Ii=Yn*Lt;Je[Ii+2]>ge&&(Un+=Je[Ii+Ur])}if(Un>zn&&Un>=ce){let Yn,Ii=Fr*zn,Fn=Dr*zn,go=-1;const wo=(kt/Lt<<5)+(ge+1)+this.points.length;for(const ia of wr){const Ui=ia*Lt;if(Je[Ui+2]<=ge)continue;Je[Ui+2]=ge;const ri=Je[Ui+Ur];Ii+=Je[Ui]*ri,Fn+=Je[Ui+1]*ri,Je[Ui+4]=wo,g&&(Yn||(Yn=this._map(Je,kt,!0),go=this.clusterProps.length,this.clusterProps.push(Yn)),g(Yn,this._map(Je,Ui)))}Je[kt+4]=wo,vt.push(Ii/Un,Fn/Un,1/0,wo,-1,Un),g&&vt.push(go)}else{for(let Yn=0;Yn<Lt;Yn++)vt.push(Je[kt+Yn]);if(Un>1)for(const Yn of wr){const Ii=Yn*Lt;if(!(Je[Ii+2]<=ge)){Je[Ii+2]=ge;for(let Fn=0;Fn<Lt;Fn++)vt.push(Je[Ii+Fn])}}}}return vt}_getOriginId(le){return le-this.points.length>>5}_getOriginZoom(le){return(le-this.points.length)%32}_map(le,ge,Me){if(le[ge+Ur]>1){const ce=this.clusterProps[le[ge+Gr]];return Me?Object.assign({},ce):ce}const ze=this.points[le[ge+jn]].properties,g=this.options.map(ze);return Me&&g===ze?Object.assign({},g):g}}function Tr(ut,le,ge){return{type:"Feature",id:ut[le+jn],properties:Zi(ut,le,ge),geometry:{type:"Point",coordinates:[(Me=ut[le],360*(Me-.5)),mo(ut[le+1])]}};var Me}function Zi(ut,le,ge){const Me=ut[le+Ur],ze=Me>=1e4?`${Math.round(Me/1e3)}k`:Me>=1e3?Math.round(Me/100)/10+"k":Me,g=ut[le+Gr],ce=g===-1?{}:Object.assign({},ge[g]);return Object.assign(ce,{cluster:!0,cluster_id:ut[le+jn],point_count:Me,point_count_abbreviated:ze})}function wn(ut){return ut/360+.5}function Rn(ut){const le=Math.sin(ut*Math.PI/180),ge=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return ge<0?0:ge>1?1:ge}function mo(ut){const le=(180-360*ut)*Math.PI/180;return 360*Math.atan(Math.exp(le))/Math.PI-90}function di(ut,le,ge,Me){let ze=Me;const g=le+(ge-le>>1);let ce,At=ge-le;const Je=ut[le],vt=ut[le+1],Lt=ut[ge],kt=ut[ge+1];for(let Fr=le+3;Fr<ge;Fr+=3){const Dr=Ao(ut[Fr],ut[Fr+1],Je,vt,Lt,kt);if(Dr>ze)ce=Fr,ze=Dr;else if(Dr===ze){const wr=Math.abs(Fr-g);wr<At&&(ce=Fr,At=wr)}}ze>Me&&(ce-le>3&&di(ut,le,ce,Me),ut[ce+2]=ze,ge-ce>3&&di(ut,ce,ge,Me))}function Ao(ut,le,ge,Me,ze,g){let ce=ze-ge,At=g-Me;if(ce!==0||At!==0){const Je=((ut-ge)*ce+(le-Me)*At)/(ce*ce+At*At);Je>1?(ge=ze,Me=g):Je>0&&(ge+=ce*Je,Me+=At*Je)}return ce=ut-ge,At=le-Me,ce*ce+At*At}function eo(ut,le,ge,Me){const ze={id:ut??null,type:le,geometry:ge,tags:Me,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(le==="Point"||le==="MultiPoint"||le==="LineString")$o(ze,ge);else if(le==="Polygon")$o(ze,ge[0]);else if(le==="MultiLineString")for(const g of ge)$o(ze,g);else if(le==="MultiPolygon")for(const g of ge)$o(ze,g[0]);return ze}function $o(ut,le){for(let ge=0;ge<le.length;ge+=3)ut.minX=Math.min(ut.minX,le[ge]),ut.minY=Math.min(ut.minY,le[ge+1]),ut.maxX=Math.max(ut.maxX,le[ge]),ut.maxY=Math.max(ut.maxY,le[ge+1])}function _i(ut,le,ge,Me){if(!le.geometry)return;const ze=le.geometry.coordinates;if(ze&&ze.length===0)return;const g=le.geometry.type,ce=Math.pow(ge.tolerance/((1<<ge.maxZoom)*ge.extent),2);let At=[],Je=le.id;if(ge.promoteId?Je=le.properties[ge.promoteId]:ge.generateId&&(Je=Me||0),g==="Point")Bn(ze,At);else if(g==="MultiPoint")for(const vt of ze)Bn(vt,At);else if(g==="LineString")Ca(ze,At,ce,!1);else if(g==="MultiLineString"){if(ge.lineMetrics){for(const vt of ze)At=[],Ca(vt,At,ce,!1),ut.push(eo(Je,"LineString",At,le.properties));return}Io(ze,At,ce,!1)}else if(g==="Polygon")Io(ze,At,ce,!0);else{if(g!=="MultiPolygon"){if(g==="GeometryCollection"){for(const vt of le.geometry.geometries)_i(ut,{id:Je,geometry:vt,properties:le.properties},ge,Me);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const vt of ze){const Lt=[];Io(vt,Lt,ce,!0),At.push(Lt)}}ut.push(eo(Je,g,At,le.properties))}function Bn(ut,le){le.push(Qa(ut[0]),ao(ut[1]),0)}function Ca(ut,le,ge,Me){let ze,g,ce=0;for(let Je=0;Je<ut.length;Je++){const vt=Qa(ut[Je][0]),Lt=ao(ut[Je][1]);le.push(vt,Lt,0),Je>0&&(ce+=Me?(ze*Lt-vt*g)/2:Math.sqrt(Math.pow(vt-ze,2)+Math.pow(Lt-g,2))),ze=vt,g=Lt}const At=le.length-3;le[2]=1,di(le,0,At,ge),le[At+2]=1,le.size=Math.abs(ce),le.start=0,le.end=le.size}function Io(ut,le,ge,Me){for(let ze=0;ze<ut.length;ze++){const g=[];Ca(ut[ze],g,ge,Me),le.push(g)}}function Qa(ut){return ut/360+.5}function ao(ut){const le=Math.sin(ut*Math.PI/180),ge=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return ge<0?0:ge>1?1:ge}function ai(ut,le,ge,Me,ze,g,ce,At){if(Me/=le,g>=(ge/=le)&&ce<Me)return ut;if(ce<ge||g>=Me)return null;const Je=[];for(const vt of ut){const Lt=vt.geometry;let kt=vt.type;const Fr=ze===0?vt.minX:vt.minY,Dr=ze===0?vt.maxX:vt.maxY;if(Fr>=ge&&Dr<Me){Je.push(vt);continue}if(Dr<ge||Fr>=Me)continue;let wr=[];if(kt==="Point"||kt==="MultiPoint")Po(Lt,wr,ge,Me,ze);else if(kt==="LineString")to(Lt,wr,ge,Me,ze,!1,At.lineMetrics);else if(kt==="MultiLineString")Mi(Lt,wr,ge,Me,ze,!1);else if(kt==="Polygon")Mi(Lt,wr,ge,Me,ze,!0);else if(kt==="MultiPolygon")for(const zn of Lt){const Un=[];Mi(zn,Un,ge,Me,ze,!0),Un.length&&wr.push(Un)}if(wr.length){if(At.lineMetrics&&kt==="LineString"){for(const zn of wr)Je.push(eo(vt.id,kt,zn,vt.tags));continue}kt!=="LineString"&&kt!=="MultiLineString"||(wr.length===1?(kt="LineString",wr=wr[0]):kt="MultiLineString"),kt!=="Point"&&kt!=="MultiPoint"||(kt=wr.length===3?"Point":"MultiPoint"),Je.push(eo(vt.id,kt,wr,vt.tags))}}return Je.length?Je:null}function Po(ut,le,ge,Me,ze){for(let g=0;g<ut.length;g+=3){const ce=ut[g+ze];ce>=ge&&ce<=Me&&os(le,ut[g],ut[g+1],ut[g+2])}}function to(ut,le,ge,Me,ze,g,ce){let At=Va(ut);const Je=ze===0?yl:al;let vt,Lt,kt=ut.start;for(let Un=0;Un<ut.length-3;Un+=3){const Yn=ut[Un],Ii=ut[Un+1],Fn=ut[Un+2],go=ut[Un+3],wo=ut[Un+4],ia=ze===0?Yn:Ii,Ui=ze===0?go:wo;let ri=!1;ce&&(vt=Math.sqrt(Math.pow(Yn-go,2)+Math.pow(Ii-wo,2))),ia<ge?Ui>ge&&(Lt=Je(At,Yn,Ii,go,wo,ge),ce&&(At.start=kt+vt*Lt)):ia>Me?Ui<Me&&(Lt=Je(At,Yn,Ii,go,wo,Me),ce&&(At.start=kt+vt*Lt)):os(At,Yn,Ii,Fn),Ui<ge&&ia>=ge&&(Lt=Je(At,Yn,Ii,go,wo,ge),ri=!0),Ui>Me&&ia<=Me&&(Lt=Je(At,Yn,Ii,go,wo,Me),ri=!0),!g&&ri&&(ce&&(At.end=kt+vt*Lt),le.push(At),At=Va(ut)),ce&&(kt+=vt)}let Fr=ut.length-3;const Dr=ut[Fr],wr=ut[Fr+1],zn=ze===0?Dr:wr;zn>=ge&&zn<=Me&&os(At,Dr,wr,ut[Fr+2]),Fr=At.length-3,g&&Fr>=3&&(At[Fr]!==At[0]||At[Fr+1]!==At[1])&&os(At,At[0],At[1],At[2]),At.length&&le.push(At)}function Va(ut){const le=[];return le.size=ut.size,le.start=ut.start,le.end=ut.end,le}function Mi(ut,le,ge,Me,ze,g){for(const ce of ut)to(ce,le,ge,Me,ze,g,!1)}function os(ut,le,ge,Me){ut.push(le,ge,Me)}function yl(ut,le,ge,Me,ze,g){const ce=(g-le)/(Me-le);return os(ut,g,ge+(ze-ge)*ce,1),ce}function al(ut,le,ge,Me,ze,g){const ce=(g-ge)/(ze-ge);return os(ut,le+(Me-le)*ce,g,1),ce}function $n(ut,le){const ge=[];for(let Me=0;Me<ut.length;Me++){const ze=ut[Me],g=ze.type;let ce;if(g==="Point"||g==="MultiPoint"||g==="LineString")ce=Qi(ze.geometry,le);else if(g==="MultiLineString"||g==="Polygon"){ce=[];for(const At of ze.geometry)ce.push(Qi(At,le))}else if(g==="MultiPolygon"){ce=[];for(const At of ze.geometry){const Je=[];for(const vt of At)Je.push(Qi(vt,le));ce.push(Je)}}ge.push(eo(ze.id,g,ce,ze.tags))}return ge}function Qi(ut,le){const ge=[];ge.size=ut.size,ut.start!==void 0&&(ge.start=ut.start,ge.end=ut.end);for(let Me=0;Me<ut.length;Me+=3)ge.push(ut[Me]+le,ut[Me+1],ut[Me+2]);return ge}function Xo(ut,le){if(ut.transformed)return ut;const ge=1<<ut.z,Me=ut.x,ze=ut.y;for(const g of ut.features){const ce=g.geometry,At=g.type;if(g.geometry=[],At===1)for(let Je=0;Je<ce.length;Je+=2)g.geometry.push(ro(ce[Je],ce[Je+1],le,ge,Me,ze));else for(let Je=0;Je<ce.length;Je++){const vt=[];for(let Lt=0;Lt<ce[Je].length;Lt+=2)vt.push(ro(ce[Je][Lt],ce[Je][Lt+1],le,ge,Me,ze));g.geometry.push(vt)}}return ut.transformed=!0,ut}function ro(ut,le,ge,Me,ze,g){return[Math.round(ge*(ut*Me-ze)),Math.round(ge*(le*Me-g))]}function Ir(ut,le,ge,Me,ze){const g=le===ze.maxZoom?0:ze.tolerance/((1<<le)*ze.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:ut.length,source:null,x:ge,y:Me,z:le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const At of ut)If(ce,At,g,ze);return ce}function If(ut,le,ge,Me){const ze=le.geometry,g=le.type,ce=[];if(ut.minX=Math.min(ut.minX,le.minX),ut.minY=Math.min(ut.minY,le.minY),ut.maxX=Math.max(ut.maxX,le.maxX),ut.maxY=Math.max(ut.maxY,le.maxY),g==="Point"||g==="MultiPoint")for(let At=0;At<ze.length;At+=3)ce.push(ze[At],ze[At+1]),ut.numPoints++,ut.numSimplified++;else if(g==="LineString")bc(ce,ze,ut,ge,!1,!1);else if(g==="MultiLineString"||g==="Polygon")for(let At=0;At<ze.length;At++)bc(ce,ze[At],ut,ge,g==="Polygon",At===0);else if(g==="MultiPolygon")for(let At=0;At<ze.length;At++){const Je=ze[At];for(let vt=0;vt<Je.length;vt++)bc(ce,Je[vt],ut,ge,!0,vt===0)}if(ce.length){let At=le.tags||null;if(g==="LineString"&&Me.lineMetrics){At={};for(const vt in le.tags)At[vt]=le.tags[vt];At.mapbox_clip_start=ze.start/ze.size,At.mapbox_clip_end=ze.end/ze.size}const Je={geometry:ce,type:g==="Polygon"||g==="MultiPolygon"?3:g==="LineString"||g==="MultiLineString"?2:1,tags:At};le.id!==null&&(Je.id=le.id),ut.features.push(Je)}}function bc(ut,le,ge,Me,ze,g){const ce=Me*Me;if(Me>0&&le.size<(ze?ce:Me))return void(ge.numPoints+=le.length/3);const At=[];for(let Je=0;Je<le.length;Je+=3)(Me===0||le[Je+2]>ce)&&(ge.numSimplified++,At.push(le[Je],le[Je+1])),ge.numPoints++;ze&&(function(Je,vt){let Lt=0;for(let kt=0,Fr=Je.length,Dr=Fr-2;kt<Fr;Dr=kt,kt+=2)Lt+=(Je[kt]-Je[Dr])*(Je[kt+1]+Je[Dr+1]);if(Lt>0===vt)for(let kt=0,Fr=Je.length;kt<Fr/2;kt+=2){const Dr=Je[kt],wr=Je[kt+1];Je[kt]=Je[Fr-2-kt],Je[kt+1]=Je[Fr-1-kt],Je[Fr-2-kt]=Dr,Je[Fr-1-kt]=wr}})(At,g),ut.push(At)}const Gs={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class hd{constructor(le,ge){const Me=(ge=this.options=(function(g,ce){for(const At in ce)g[At]=ce[At];return g})(Object.create(Gs),ge)).debug;if(Me&&console.time("preprocess data"),ge.maxZoom<0||ge.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ge.promoteId&&ge.generateId)throw new Error("promoteId and generateId cannot be used together.");let ze=(function(g,ce){const At=[];if(g.type==="FeatureCollection")for(let Je=0;Je<g.features.length;Je++)_i(At,g.features[Je],ce,Je);else _i(At,g.type==="Feature"?g:{geometry:g},ce);return At})(le,ge);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ge.indexMaxZoom,ge.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ze=(function(g,ce){const At=ce.buffer/ce.extent;let Je=g;const vt=ai(g,1,-1-At,At,0,-1,2,ce),Lt=ai(g,1,1-At,2+At,0,-1,2,ce);return(vt||Lt)&&(Je=ai(g,1,-At,1+At,0,-1,2,ce)||[],vt&&(Je=$n(vt,1).concat(Je)),Lt&&(Je=Je.concat($n(Lt,-1)))),Je})(ze,ge),ze.length&&this.splitTile(ze,0,0,0),Me&&(ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(le,ge,Me,ze,g,ce,At){const Je=[le,ge,Me,ze],vt=this.options,Lt=vt.debug;for(;Je.length;){ze=Je.pop(),Me=Je.pop(),ge=Je.pop(),le=Je.pop();const kt=1<<ge,Fr=Zu(ge,Me,ze);let Dr=this.tiles[Fr];if(!Dr&&(Lt>1&&console.time("creation"),Dr=this.tiles[Fr]=Ir(le,ge,Me,ze,vt),this.tileCoords.push({z:ge,x:Me,y:ze}),Lt)){Lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ge,Me,ze,Dr.numFeatures,Dr.numPoints,Dr.numSimplified),console.timeEnd("creation"));const ri=`z${ge}`;this.stats[ri]=(this.stats[ri]||0)+1,this.total++}if(Dr.source=le,g==null){if(ge===vt.indexMaxZoom||Dr.numPoints<=vt.indexMaxPoints)continue}else{if(ge===vt.maxZoom||ge===g)continue;if(g!=null){const ri=g-ge;if(Me!==ce>>ri||ze!==At>>ri)continue}}if(Dr.source=null,le.length===0)continue;Lt>1&&console.time("clipping");const wr=.5*vt.buffer/vt.extent,zn=.5-wr,Un=.5+wr,Yn=1+wr;let Ii=null,Fn=null,go=null,wo=null,ia=ai(le,kt,Me-wr,Me+Un,0,Dr.minX,Dr.maxX,vt),Ui=ai(le,kt,Me+zn,Me+Yn,0,Dr.minX,Dr.maxX,vt);le=null,ia&&(Ii=ai(ia,kt,ze-wr,ze+Un,1,Dr.minY,Dr.maxY,vt),Fn=ai(ia,kt,ze+zn,ze+Yn,1,Dr.minY,Dr.maxY,vt),ia=null),Ui&&(go=ai(Ui,kt,ze-wr,ze+Un,1,Dr.minY,Dr.maxY,vt),wo=ai(Ui,kt,ze+zn,ze+Yn,1,Dr.minY,Dr.maxY,vt),Ui=null),Lt>1&&console.timeEnd("clipping"),Je.push(Ii||[],ge+1,2*Me,2*ze),Je.push(Fn||[],ge+1,2*Me,2*ze+1),Je.push(go||[],ge+1,2*Me+1,2*ze),Je.push(wo||[],ge+1,2*Me+1,2*ze+1)}}getTile(le,ge,Me){le=+le,ge=+ge,Me=+Me;const ze=this.options,{extent:g,debug:ce}=ze;if(le<0||le>24)return null;const At=1<<le,Je=Zu(le,ge=ge+At&At-1,Me);if(this.tiles[Je])return Xo(this.tiles[Je],g);ce>1&&console.log("drilling down to z%d-%d-%d",le,ge,Me);let vt,Lt=le,kt=ge,Fr=Me;for(;!vt&&Lt>0;)Lt--,kt>>=1,Fr>>=1,vt=this.tiles[Zu(Lt,kt,Fr)];return vt&&vt.source?(ce>1&&(console.log("found parent tile z%d-%d-%d",Lt,kt,Fr),console.time("drilling down")),this.splitTile(vt.source,Lt,kt,Fr,le,ge,Me),ce>1&&console.timeEnd("drilling down"),this.tiles[Je]?Xo(this.tiles[Je],g):null):null}}function Zu(ut,le,ge){return 32*((1<<ut)*ge+le)+ut}function Pf(ut,le){const ge=ut.tileID.canonical;if(!this._geoJSONIndex)return void le(null,null);const Me=this._geoJSONIndex.getTile(ge.z,ge.x,ge.y);if(!Me)return void le(null,null);const ze=vt=>vt.tags&&"3d_elevation_id"in vt.tags&&"source"in vt.tags&&vt.tags.source==="elevation",g=Me.features.filter((vt=>ze(vt)));let ce={_geojsonTileLayer:Me.features};g.length>0&&(ce={_geojsonTileLayer:Me.features.filter((vt=>!ze(vt))),hd_road_elevation:g});const At=new Ke(ce),Je=(function(vt){const Lt=new i.bt;for(const kt of Object.keys(vt))Lt.writeMessage(3,ir,{name:kt,features:vt[kt]});return Lt.finish()})(ce).buffer;le(null,{vectorTile:At,rawData:Je})}class rr extends ue{constructor(le,ge,Me,ze,g,ce,At){super(le,ge,Me,ze,g,Pf,At),ce&&(this.loadGeoJSON=ce),this._dynamicIndex=new bt}loadData(le,ge){const Me=le&&le.request,ze=Me&&Me.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(le,((g,ce)=>{if(g||!ce)return ge(g);if(typeof ce!="object")return ge(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));{try{if(le.filter){const Je=i.U(le.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Je.result==="error")throw new Error(Je.value.map((vt=>`${vt.key}: ${vt.message}`)).join(", "));ce.features=ce.features.filter((vt=>Je.value.evaluate({zoom:0},vt)))}le.dynamic?(ce.type==="Feature"&&(ce={type:"FeatureCollection",features:[ce]}),le.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(ce.features,this.loaded),le.cluster&&(ce.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=le.cluster?new Sn((function({superclusterOptions:Je,clusterProperties:vt}){if(!vt||!Je)return Je;const Lt={},kt={},Fr={accumulated:null,zoom:0},Dr={properties:null},wr=Object.keys(vt);for(const zn of wr){const[Un,Yn]=vt[zn],Ii=i.U(Yn),Fn=i.U(typeof Un=="string"?[Un,["accumulated"],["get",zn]]:Un);Lt[zn]=Ii.value,kt[zn]=Fn.value}return Je.map=zn=>{Dr.properties=zn;const Un={};for(const Yn of wr)Un[Yn]=Lt[Yn].evaluate(Fr,Dr);return Un},Je.reduce=(zn,Un)=>{Dr.properties=Un;for(const Yn of wr)Fr.accumulated=zn[Yn],zn[Yn]=kt[Yn].evaluate(Fr,Dr)},Je})(le)).load(ce.features):le.dynamic?this._dynamicIndex:(function(Je,vt){return new hd(Je,vt)})(ce,le.geojsonVtOptions)}catch(Je){return ge(Je)}const At={};if(ze){const Je=z(Me);Je&&(At.resourceTiming={},At.resourceTiming[le.source]=JSON.parse(JSON.stringify(Je)))}ge(null,At)}}))}reloadTile(le,ge){const Me=this.loaded;return Me&&Me[le.uid]?le.partial?ge(null,void 0):super.reloadTile(le,ge):this.loadTile(le,ge)}loadGeoJSON(le,ge){if(le.request)i.m(le.request,ge);else{if(typeof le.data!="string")return ge(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`));setTimeout((()=>{try{return ge(null,JSON.parse(le.data))}catch{return ge(new Error(`Input data given to '${le.source}' is not a valid GeoJSON object.`))}}),0)}}getClusterExpansionZoom(le,ge){try{ge(null,this._geoJSONIndex.getClusterExpansionZoom(le.clusterId))}catch(Me){ge(Me)}}getClusterChildren(le,ge){try{ge(null,this._geoJSONIndex.getChildren(le.clusterId))}catch(Me){ge(Me)}}getClusterLeaves(le,ge){try{ge(null,this._geoJSONIndex.getLeaves(le.clusterId,le.limit,le.offset))}catch(Me){ge(Me)}}}class Ul{constructor(le,ge,Me){this.tileID=new i.aO(le.tileID.overscaledZ,le.tileID.wrap,le.tileID.canonical.z,le.tileID.canonical.x,le.tileID.canonical.y),this.tileZoom=le.tileZoom,this.uid=le.uid,this.zoom=le.zoom,this.canonical=le.tileID.canonical,this.pixelRatio=le.pixelRatio,this.tileSize=le.tileSize,this.source=le.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=le.projection,this.brightness=ge,this.worldview=Me}parse(le,ge,Me,ze){this.status="parsing";const g=new i.aO(Me.tileID.overscaledZ,Me.tileID.wrap,Me.tileID.canonical.z,Me.tileID.canonical.x,Me.tileID.canonical.y),ce=[],At=ge.familiesBySource[Me.source],Je=new i.fe(g,Me.promoteId);Je.bucketLayerIDs=[],Je.is3DTile=!0,i.ft(le).then((vt=>{if(!vt)return ze(new Error("Could not parse tile"));const Lt=vt.json.extensionsUsed&&vt.json.extensionsUsed.includes("MAPBOX_mesh_features")||vt.json.asset.extras&&vt.json.asset.extras.MAPBOX_mesh_features,kt=vt.json.extensionsUsed&&vt.json.extensionsUsed.includes("EXT_meshopt_compression"),Fr=new i.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const Dr in At)for(const wr of At[Dr]){const zn=wr[0];Je.bucketLayerIDs.push(wr.map((Ii=>i.B(Ii.id,Ii.scope)))),zn.recalculate(Fr,[]);const Un=i.fu(vt,1/i.d6(Me.tileID.canonical)),Yn=new i.fv(wr,Un,g,Lt,kt,this.brightness,Je,this.worldview);Lt||(Yn.needsUpload=!0),ce.push(Yn),Yn.evaluate(zn)}this.status="done",ze(null,{buckets:ce,featureIndex:Je,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})})).catch((vt=>ze(new Error(vt.message))))}}class kh{constructor(le,ge,Me,ze,g,ce,At,Je){this.actor=le,this.layerIndex=ge,this.availableImages=Me,this.availableModels=ze,this.brightness=At,this.loading={},this.loaded={},this.worldview=Je}loadTile(le,ge){const Me=le.uid,ze=this.loading[Me]=new Ul(le,this.brightness,this.worldview);i.bu(le.request,((g,ce)=>{const At=!this.loading[Me];return delete this.loading[Me],At||g?(ze.status="done",At||(this.loaded[Me]=ze),ge(g)):ce&&ce.byteLength!==0?void ze.parse(ce,this.layerIndex,le,((Je,vt)=>{ze.status="done",this.loaded=this.loaded||{},this.loaded[Me]=ze,Je||!vt?ge(Je):ge(null,vt)})):(ze.status="done",this.loaded[Me]=ze,ge())}))}reloadTile(le,ge){const Me=this.loaded,ze=le.uid;if(Me&&Me[ze]){const g=Me[ze];g.projection=le.projection,g.brightness=le.brightness;const ce=(At,Je)=>{g.reloadCallback&&(delete g.reloadCallback,this.loadTile(le,ge)),ge(At,Je)};g.status==="parsing"?g.reloadCallback=ce:g.status==="done"&&this.loadTile(le,ge)}}abortTile(le,ge){const Me=le.uid;this.loading[Me]&&delete this.loading[Me],ge()}removeTile(le,ge){const Me=this.loaded,ze=le.uid;Me&&Me[ze]&&delete Me[ze],ge()}}class Xu{constructor(le){this.self=le,this.actor=new i.fx(le,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new i.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=i.cl({name:"mercator"}),this.workerSourceTypes={vector:ue,geojson:rr,"raster-dem":ye,"raster-array":ve,"batched-model":kh},this.workerSources={},this.self.registerWorkerSource=(ge,Me)=>{if(this.workerSourceTypes[ge])throw new Error(`Worker source with name "${ge}" already registered.`);this.workerSourceTypes[ge]=Me},this.self.registerRTLTextPlugin=ge=>{if(i.fy.isParsed())throw new Error("RTL text plugin already registered.");i.fy.setState({pluginStatus:i.fz.parsed,pluginURL:i.fy.getPluginURL()}),i.fy.applyArabicShaping=ge.applyArabicShaping,i.fy.processBidirectionalText=ge.processBidirectionalText,i.fy.processStyledBidirectionalText=ge.processStyledBidirectionalText;for(const Me of this.rtlPluginParsingListeners)Me(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(le,ge,Me){delete this.layerIndexes[le],delete this.availableImages[le],delete this.availableModels[le],delete this.workerSources[le],Me()}checkIfReady(le,ge,Me){Me()}setReferrer(le,ge){this.referrer=ge}spriteLoaded(le,ge){this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={});const{scope:Me,isLoaded:ze}=ge;if(this.isSpriteLoaded[le][Me]=ze,this.workerSources[le]&&this.workerSources[le][Me])for(const g in this.workerSources[le][Me]){const ce=this.workerSources[le][Me][g];for(const At in ce){const Je=ce[At];Je instanceof ue&&(Je.isSpriteLoaded=ze,Je.fire(new i.z("isSpriteLoaded")))}}}setImages(le,ge,Me){this.availableImages[le]||(this.availableImages[le]={});const{scope:ze,images:g}=ge;if(this.availableImages[le][ze]=g,this.workerSources[le]&&this.workerSources[le][ze]){for(const ce in this.workerSources[le][ze]){const At=this.workerSources[le][ze][ce];for(const Je in At)At[Je].availableImages=g}Me()}else Me()}setModels(le,{scope:ge,models:Me},ze){if(this.availableModels[le]||(this.availableModels[le]={}),this.availableModels[le][ge]=Me,this.workerSources[le]&&this.workerSources[le][ge]){for(const g in this.workerSources[le][ge]){const ce=this.workerSources[le][ge][g];for(const At in ce)ce[At].availableModels=Me}ze()}else ze()}setProjection(le,ge){this.projections[le]=i.cl(ge)}setBrightness(le,ge,Me){this.brightness=ge,Me()}setWorldview(le,ge,Me){this.worldview=ge,Me()}setLayers(le,ge,Me){this.getLayerIndex(le,ge.scope).replace(ge.layers,ge.options),Me()}updateLayers(le,ge,Me){this.getLayerIndex(le,ge.scope).update(ge.layers,ge.removedIds,ge.options),Me()}loadTile(le,ge,Me){ge.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,ge.type,ge.source,ge.scope).loadTile(ge,Me)}decodeRasterArray(le,ge,Me){this.getWorkerSource(le,ge.type,ge.source,ge.scope).decodeRasterArray(ge,Me)}reloadTile(le,ge,Me){ge.projection=this.projections[le]||this.defaultProjection,this.getWorkerSource(le,ge.type,ge.source,ge.scope).reloadTile(ge,Me)}abortTile(le,ge,Me){this.getWorkerSource(le,ge.type,ge.source,ge.scope).abortTile(ge,Me)}removeTile(le,ge,Me){this.getWorkerSource(le,ge.type,ge.source,ge.scope).removeTile(ge,Me)}removeSource(le,ge,Me){if(!(this.workerSources[le]&&this.workerSources[le][ge.scope]&&this.workerSources[le][ge.scope][ge.type]&&this.workerSources[le][ge.scope][ge.type][ge.source]))return;const ze=this.workerSources[le][ge.scope][ge.type][ge.source];delete this.workerSources[le][ge.scope][ge.type][ge.source],ze.removeSource!==void 0?ze.removeSource(ge,Me):Me()}loadWorkerSource(le,ge,Me){try{this.self.importScripts(ge.url),Me()}catch(ze){Me(ze.toString())}}syncRTLPluginState(le,ge,Me){if(i.fy.isParsed())Me(null,!0);else if(i.fy.isParsing())this.rtlPluginParsingListeners.push(Me);else try{i.fy.setState(ge);const ze=i.fy.getPluginURL();!i.fy.isLoaded()||i.fy.isParsed()||i.fy.isParsing()||ze==null||(i.fy.setState({pluginStatus:i.fz.parsing,pluginURL:i.fy.getPluginURL()}),this.self.importScripts(ze),i.fy.isParsed()?Me(null,!0):this.rtlPluginParsingListeners.push(Me))}catch(ze){Me(ze.toString())}}setDracoUrl(le,ge){this.dracoUrl=ge}getAvailableImages(le,ge){this.availableImages[le]||(this.availableImages[le]={});let Me=this.availableImages[le][ge];return Me||(Me=[]),Me}getAvailableModels(le,ge){this.availableModels[le]||(this.availableModels[le]={});let Me=this.availableModels[le][ge];return Me||(Me={}),Me}getLayerIndex(le,ge){this.layerIndexes[le]||(this.layerIndexes[le]={});let Me=this.layerIndexes[le][ge];return Me||(Me=this.layerIndexes[le][ge]=new G,Me.scope=ge),Me}getWorkerSource(le,ge,Me,ze){const g=this.workerSources;return g[le]||(g[le]={}),g[le][ze]||(g[le][ze]={}),g[le][ze][ge]||(g[le][ze][ge]={}),this.isSpriteLoaded[le]||(this.isSpriteLoaded[le]={}),g[le][ze][ge][Me]||(g[le][ze][ge][Me]=new this.workerSourceTypes[ge]({send:(ce,At,Je,vt,Lt,kt)=>this.actor.send(ce,At,Je,le,Lt,kt),scheduler:this.actor.scheduler},this.getLayerIndex(le,ze),this.getAvailableImages(le,ze),this.getAvailableModels(le,ze),this.isSpriteLoaded[le][ze],void 0,this.brightness,this.worldview)),g[le][ze][ge][Me]}rasterizeImagesWorker(le,ge,Me){const ze=new Map;for(const[g,{image:ce,imageVariant:At}]of ge.tasks.entries()){const Je=this.imageRasterizer.rasterize(At,ce,ge.scope,le);ze.set(g,Je)}Me(void 0,ze)}removeRasterizedImages(le,ge,Me){this.imageRasterizer.removeImagesFromCacheByIds(ge.imageIds,ge.scope,le),Me()}enforceCacheSizeLimit(le,ge){i.fA(ge)}getWorkerPerformanceMetrics(le,ge,Me){Me(void 0,void 0)}}return i.fw(self)&&(self.worker=new Xu(self)),Xu})),y(["./shared"],(function(i){var z="3.15.0";const B={create:"create",load:"load",fullLoad:"fullLoad"},F={mark(p){performance.mark(p)},measure(p,n,c){performance.measure(p,n,c)}};function G(p){const n=p.name.split("?")[0];return i.a(n)&&n.includes("mapbox-gl.js")?"javascript":i.a(n)&&n.includes("mapbox-gl.css")?"css":i.b(n)?"fontRange":i.c(n)?"sprite":i.i(n)?"style":i.d(n)?"tilejson":"other"}var Q,te={},ne=(function(){if(Q)return te;function p(d){return!n(d)}function n(d){return typeof window>"u"||typeof document>"u"?"not a browser":(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var E,I,D=new Blob([""],{type:"text/javascript"}),N=URL.createObjectURL(D);try{I=new Worker(N),E=!0}catch{E=!1}return I&&I.terminate(),URL.revokeObjectURL(N),E})()?(function(){var E=document.createElement("canvas");E.width=E.height=1;var I=E.getContext("2d");if(!I)return!1;var D=I.getImageData(0,0,1,1);return D&&D.width===E.width})()?(c[x=d&&d.failIfMajorPerformanceCaveat]===void 0&&(c[x]=(function(E){var I,D=(function(N){var H=document.createElement("canvas"),W=Object.create(p.webGLContextAttributes);return W.failIfMajorPerformanceCaveat=N,H.getContext("webgl2",W)})(E);if(!D)return!1;try{I=D.createShader(D.VERTEX_SHADER)}catch{return!1}return!(!I||D.isContextLost())&&(D.shaderSource(I,"void main() {}"),D.compileShader(I),D.getShaderParameter(I,D.COMPILE_STATUS)===!0)})(x)),c[x]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var x}Q=1,te.supported=p,te.notSupportedReason=n;var c={};return p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},te})();function oe(p,n,c){const d=document.createElement(p);return n!=null&&(d.className=n),c&&c.appendChild(d),d}function ue(p,n,c){const d=document.createElementNS("http://www.w3.org/2000/svg",p);for(const x of Object.keys(n))d.setAttributeNS(null,x,String(n[x]));return c&&c.appendChild(d),d}const ye=typeof document<"u"?document.documentElement&&document.documentElement.style:null,we=ye&&ye.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ve;function Ce(){ye&&we&&(ve=ye[we],ye[we]="none")}function Ee(){ye&&we&&(ye[we]=ve)}function Be(p){p.preventDefault(),p.stopPropagation(),window.removeEventListener("click",Be,!0)}function Ke(){window.addEventListener("click",Be,!0),window.setTimeout((()=>{window.removeEventListener("click",Be,!0)}),0)}function st(p,n){const c=p.getBoundingClientRect();return ht(p,c,n)}function dt(p,n){const c=p.getBoundingClientRect(),d=[];for(let x=0;x<n.length;x++)d.push(ht(p,c,n[x]));return d}function bt(p){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&p.button===2&&p.ctrlKey?0:p.button}function ht(p,n,c){const d=p.offsetWidth===n.width?1:p.offsetWidth/n.width;return new i.P((c.clientX-n.left)*d,(c.clientY-n.top)*d)}const Re="01",Pt="NO_ACCESS_TOKEN";class wt{constructor(n,c,d){this._transformRequestFn=n,this._customAccessToken=c,this._silenceAuthErrors=!!d,this._createSkuToken()}_createSkuToken(){const n=(function(){let c="";for(let d=0;d<10;d++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Re,c].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,c){return this._transformRequestFn&&this._transformRequestFn(n,c)||{url:n}}normalizeStyleURL(n,c){if(!i.h(n))return n;const d=et(n);return d.params.push(`sdk=js-${z}`),d.path=`/styles/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||c)}normalizeGlyphsURL(n,c){if(!i.h(n))return n;const d=et(n);return d.path=`/fonts/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||c)}normalizeModelURL(n,c){if(!i.h(n))return n;const d=et(n);return d.path=`/models/v1${d.path}`,this._makeAPIURL(d,this._customAccessToken||c)}normalizeSourceURL(n,c,d,x){if(!i.h(n))return n;const E=et(n);return E.path=`/v4/${E.authority}.json`,E.params.push("secure"),d&&E.params.push(`language=${d}`),x&&E.params.push(`worldview=${x}`),this._makeAPIURL(E,this._customAccessToken||c)}normalizeIconsetURL(n,c){const d=et(n);return i.h(n)?(d.path=`/styles/v1${d.path}/iconset.pbf`,this._makeAPIURL(d,this._customAccessToken||c)):Zt(d)}normalizeSpriteURL(n,c,d,x){const E=et(n);return i.h(n)?(E.path=`/styles/v1${E.path}/sprite${c}${d}`,this._makeAPIURL(E,this._customAccessToken||x)):(E.path+=`${c}${d}`,Zt(E))}normalizeTileURL(n,c,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!i.h(n))return n;const x=et(n);x.path=x.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${c||d&&x.authority!=="raster"&&d===512?"@2x":""}${i.k.supported?".webp":"$1"}`),x.authority==="raster"?x.path=`/${i.e.RASTER_URL_PREFIX}${x.path}`:x.authority==="rasterarrays"?x.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${x.path}`:x.authority==="3dtiles"?x.path=`/${i.e.TILES3D_URL_PREFIX}${x.path}`:(x.path=x.path.replace(/^.+\/v4\//,"/"),x.path=`/${i.e.TILE_URL_VERSION}${x.path}`);const E=this._customAccessToken||(function(I){for(const D of I){const N=D.match(/^access_token=(.*)$/);if(N)return N[1]}return null})(x.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&E&&this._skuToken&&x.params.push(`sku=${this._skuToken}`),this._makeAPIURL(x,E)}canonicalizeTileURL(n,c){const d=et(n);if(!d.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!d.path.match(/\.[\w]+$/))return n;let x="mapbox://";d.path.match(/^\/raster\/v1\//)?x+=`raster/${d.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:d.path.match(/^\/rasterarrays\/v1\//)?x+=`rasterarrays/${d.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:x+=`tiles/${d.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let E=d.params;return c&&(E=E.filter((I=>!I.match(/^access_token=/)))),E.length&&(x+=`?${E.join("&")}`),x}canonicalizeTileset(n,c){const d=!!c&&i.h(c),x=[];for(const E of n.tiles||[])i.j(E)?x.push(this.canonicalizeTileURL(E,d)):x.push(E);return x}_makeAPIURL(n,c){const d="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",x=et(i.e.API_URL);if(n.protocol=x.protocol,n.authority=x.authority,n.protocol==="http"){const E=n.params.indexOf("secure");E>=0&&n.params.splice(E,1)}if(x.path!=="/"&&(n.path=`${x.path}${n.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Zt(n);if(c=c||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!c)throw new Error(`An API access token is required to use Mapbox GL. ${d}`);if(c[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${d}`)}return n.params=n.params.filter((E=>E.indexOf("access_token")===-1)),n.params.push(`access_token=${c||""}`),Zt(n)}}const Et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function et(p){const n=p.match(Et);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function Zt(p){const n=p.params.length?`?${p.params.join("&")}`:"";return`${p.protocol}://${p.authority}${p.path}${n}`}const ir="mapbox.eventData";function or(p){if(!p)return null;const n=p.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(i.l(n[1]))}catch{return null}}class ft{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const c=or(i.e.ACCESS_TOKEN);let d="";return d=c&&c.u?i.f(c.u):i.e.ACCESS_TOKEN||"",n?`${ir}.${n}:${d}`:`${ir}:${d}`}fetchEventData(){const n=i.s("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid");if(n)try{const x=localStorage.getItem(c);x&&(this.eventData=JSON.parse(x));const E=localStorage.getItem(d);E&&(this.anonId=E)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const n=i.s("localStorage"),c=this.getStorageKey(),d=this.getStorageKey("uuid"),x=this.anonId;if(n&&x)try{localStorage.setItem(d,x),Object.keys(this.eventData).length>=1&&localStorage.setItem(c,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,c,d,x){if(!i.e.EVENTS_URL)return;const E=et(i.e.EVENTS_URL);E.params.push(`access_token=${x||i.e.ACCESS_TOKEN||""}`);const I={event:this.type,created:new Date(n).toISOString()},D=c?Object.assign(I,c):I,N={url:Zt(E),headers:{"Content-Type":"text/plain"},body:JSON.stringify([D])};this.pendingRequest=i.p(N,(H=>{this.pendingRequest=null,d(H),this.saveEventData(),this.processRequests(x)}))}queueRequest(n,c){this.queue.push(n),this.processRequests(c)}}const Vt=new class extends ft{constructor(p){super("appUserTurnstile"),this._customAccessToken=p}postTurnstileEvent(p,n){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(p)&&p.some((c=>i.h(c)||i.j(c)))&&this.queueRequest(Date.now(),n)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=or(i.e.ACCESS_TOKEN),c=n?n.u:i.e.ACCESS_TOKEN;let d=c!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),d=!0);const x=this.queue.shift();if(this.eventData.lastSuccess){const E=new Date(this.eventData.lastSuccess),I=new Date(x),D=(x-this.eventData.lastSuccess)/864e5;d=d||D>=1||D<-1||E.getDate()!==I.getDate()}else d=!0;d?this.postEvent(x,{sdkIdentifier:"mapbox-gl-js",sdkVersion:z,skuId:Re,"enabled.telemetry":!1,userId:this.anonId},(E=>{E||(this.eventData.lastSuccess=x,this.eventData.tokenU=c)}),p):this.processRequests()}},Jt=Vt.postTurnstileEvent.bind(Vt),Cr=new class extends ft{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(p,n,c,d){this.skuToken=n,this.errorCb=d,i.e.EVENTS_URL&&(c||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},c):this.errorCb(new Error(Pt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:c}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:z,skuId:Re,skuToken:this.skuToken,userId:this.anonId},(d=>{d?this.errorCb(d):n&&(this.success[n]=!0)}),p))}remove(){this.errorCb=null}},ln=Cr.postMapLoadEvent.bind(Cr),tn=new class extends ft{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(p){let n=this.mapInstanceIdMap.get(p);return n||(n=i.u(),this.mapInstanceIdMap.set(p,n)),n}getEventId(p){const n=this.eventIdPerMapInstanceMap.get(p)||0;return this.eventIdPerMapInstanceMap.set(p,n+1),n}postStyleLoadEvent(p,n){const{map:c,style:d,importedStyles:x}=n;if(!i.e.EVENTS_URL||!p&&!i.e.ACCESS_TOKEN)return;const E=this.getMapInstanceId(c),I={mapInstanceId:E,eventId:this.getEventId(E),style:d};x.length&&(I.importedStyles=x),this.queueRequest({timestamp:Date.now(),payload:I},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:c}=this.queue.shift();this.postEvent(n,c,(()=>{}),p)}},Hr=tn.postStyleLoadEvent.bind(tn),Nn=new class extends ft{constructor(){super("gljs.performance")}postPerformanceEvent(p,n){i.e.EVENTS_URL&&(p||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},p)}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:c}=this.queue.shift(),d=(function(x){const E=performance.getEntriesByType("resource"),I=performance.getEntriesByType("mark"),D=(function(se){const fe={};if(se){for(const he in se)if(he!=="other")for(const Se of se[he]){const me=`${he}ResolveRangeMin`,Te=`${he}ResolveRangeMax`,Oe=`${he}RequestCount`,Le=`${he}RequestCachedCount`;fe[me]=Math.min(fe[me]||1/0,Se.startTime),fe[Te]=Math.max(fe[Te]||-1/0,Se.responseEnd);const Ge=Ue=>{fe[Ue]===void 0&&(fe[Ue]=0),++fe[Ue]};Se.transferSize!==void 0&&Se.transferSize===0&&Ge(Le),Ge(Oe)}}return fe})((function(se,fe){const he={};if(se)for(const Se of se){const me=fe(Se);he[me]===void 0&&(he[me]=[]),he[me].push(Se)}return he})(E,G)),N=window.devicePixelRatio,H=navigator.connection||navigator.mozConnection||navigator.webkitConnection,W=H?H.effectiveType:void 0,ee={counters:[],metadata:[],attributes:[]},Y=(se,fe,he)=>{he!=null&&se.push({name:fe,value:he.toString()})};for(const se in D)Y(ee.counters,se,D[se]);if(x.interactionRange[0]!==1/0&&x.interactionRange[1]!==-1/0&&(Y(ee.counters,"interactionRangeMin",x.interactionRange[0]),Y(ee.counters,"interactionRangeMax",x.interactionRange[1])),I)for(const se of Object.keys(B)){const fe=B[se],he=I.find((Se=>Se.name===fe));he&&Y(ee.counters,fe,he.startTime)}return Y(ee.counters,"visibilityHidden",x.visibilityHidden),Y(ee.attributes,"style",(function(se){if(se)for(const fe of se){const he=fe.name.split("?")[0];if(i.i(he)){const Se=he.split("/").slice(-2);if(Se.length===2)return`mapbox://styles/${Se[0]}/${Se[1]}`}}})(E)),Y(ee.attributes,"terrainEnabled",x.terrainEnabled?"true":"false"),Y(ee.attributes,"fogEnabled",x.fogEnabled?"true":"false"),Y(ee.attributes,"projection",x.projection),Y(ee.attributes,"zoom",x.zoom),Y(ee.metadata,"devicePixelRatio",N),Y(ee.metadata,"connectionEffectiveType",W),Y(ee.metadata,"navigatorUserAgent",navigator.userAgent),Y(ee.metadata,"screenWidth",window.screen.width),Y(ee.metadata,"screenHeight",window.screen.height),Y(ee.metadata,"windowWidth",window.innerWidth),Y(ee.metadata,"windowHeight",window.innerHeight),Y(ee.metadata,"mapWidth",x.width/N),Y(ee.metadata,"mapHeight",x.height/N),Y(ee.metadata,"webglRenderer",x.renderer),Y(ee.metadata,"webglVendor",x.vendor),Y(ee.metadata,"sdkVersion",z),Y(ee.metadata,"sdkIdentifier","mapbox-gl-js"),ee})(c);for(const x of d.metadata);for(const x of d.counters);for(const x of d.attributes);this.postEvent(n,d,(()=>{}),p)}},jn=Nn.postPerformanceEvent.bind(Nn),Ur=new class extends ft{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(p,n,c,d){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const x=et(i.e.API_URL+i.e.SESSION_PATH);x.params.push(`sku=${n||""}`),x.params.push(`access_token=${d||i.e.ACCESS_TOKEN||""}`);const E={url:Zt(x),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(E,(I=>{this.pendingRequest=null,c(I),this.saveEventData(),this.processRequests(d)}))}getSessionAPI(p,n,c,d){this.skuToken=n,this.errorCb=d,i.e.SESSION_PATH&&i.e.API_URL&&(c||i.e.ACCESS_TOKEN?this.queueRequest({id:p,timestamp:Date.now()},c):this.errorCb(new Error(Pt)))}processRequests(p){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:c}=this.queue.shift();n&&this.success[n]||this.getSession(c,this.skuToken,(d=>{d?this.errorCb(d):n&&(this.success[n]=!0)}),p)}remove(){this.errorCb=null}},Gr=Ur.getSessionAPI.bind(Ur),Sn=new Set;function Tr(p,n){n?Sn.add(p):Sn.delete(p)}class Zi{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,c){this._updatedSourceCaches[n]=c,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const c=n.scope;this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._updatedLayers[c].add(n.id),this.setDirty()}removeLayer(n){const c=n.scope;this._removedLayers[c]=this._removedLayers[c]||{},this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._removedLayers[c][n.id]=n,this._updatedLayers[c].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const c in this._updatedLayers)n[c]=n[c]||{},n[c].updatedIds=Array.from(this._updatedLayers[c].values());for(const c in this._removedLayers)n[c]=n[c]||{},n[c].removedIds=Object.keys(this._removedLayers[c]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(n){return this._updatedImages[n]?Array.from(this._updatedImages[n].values()):[]}updateImage(n,c){this._updatedImages[c]=this._updatedImages[c]||new Set,this._updatedImages[c].add(i.I.toString(n)),this.setDirty()}resetUpdatedImages(n){this._updatedImages[n]&&this._updatedImages[n].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function wn(p){const{userImage:n}=p;return!!(n&&n.render&&n.render())&&(p.data.replace(new Uint8Array(n.data.buffer)),!0)}class Rn extends i.E{constructor(n){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=n,n!=="raster"&&i.r()&&(this.imageRasterizerDispatcher=new i.D(i.t(),this,"Image Rasterizer Worker",1))}addScope(n){this.loaded.set(n,!1),this.imageProviders.set(n,new Map),this.images.set(n,new Map),this.updatedImages.set(n,new Set),this.callbackDispatchedThisFrame.set(n,new Set),this.patterns.set(n,new Map),this.atlasImage.set(n,new i.q({width:1,height:1}))}removeScope(n){this.loaded.delete(n),this.imageProviders.delete(n),this.images.delete(n),this.updatedImages.delete(n),this.callbackDispatchedThisFrame.delete(n),this.patterns.delete(n),this.atlasImage.delete(n);const c=this.atlasTexture.get(n);c&&(c.destroy(),this.atlasTexture.delete(n))}addImageProvider(n,c){this.imageProviders.has(c)||this.imageProviders.set(c,new Map),this.imageProviders.get(c).set(n.id,n)}removeImageProvider(n,c){this.imageProviders.has(c)&&this.imageProviders.get(c).delete(n)}getPendingImageProviders(){const n=[];for(const c of this.imageProviders.values())for(const d of c.values())d.hasPendingRequests()&&n.push(d);return n}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.x),this._imageRasterizer}isLoaded(){for(const n of this.loaded.keys())if(!this.loaded.get(n))return!1;return!0}setLoaded(n,c){if(this.loaded.get(c)!==n&&(this.loaded.set(c,n),n)){for(const{ids:d,callback:x}of this.requestors)this._notify(d,c,x);this.requestors=[]}}hasImage(n,c){return!!this.getImage(n,c)}getImage(n,c){return this.images.get(c).get(n.toString())}addImage(n,c,d){this._validate(n,d)&&this.images.get(c).set(n.toString(),d)}_validate(n,c){let d=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new i.y(new Error(`Image "${n.name}" has invalid "stretchX" value`))),d=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new i.y(new Error(`Image "${n.name}" has invalid "stretchY" value`))),d=!1),this._validateContent(c.content,c)||(this.fire(new i.y(new Error(`Image "${n.name}" has invalid "content" value`))),d=!1),d}_validateStretch(n,c){if(!n)return!0;let d=0;for(const x of n){if(x[0]<d||x[1]<x[0]||c<x[1])return!1;d=x[1]}return!0}_validateContent(n,c){return n?n.length!==4||!c.usvg&&(n[0]<0||c.data.width<n[0]||n[1]<0||c.data.height<n[1]||n[2]<0||c.data.width<n[2]||n[3]<0||c.data.height<n[3])?!1:!(n[2]<n[0]||n[3]<n[1]):!0}updateImage(n,c,d){const x=this.images.get(c).get(n.toString());d.version=x.version+1,this.images.get(c).set(n.toString(),d),this.updatedImages.get(c).add(n),this.removeFromImageRasterizerCache(n,c)}clearUpdatedImages(n){this.updatedImages.get(n).clear()}removeFromImageRasterizerCache(n,c){this.spriteFormat!=="raster"&&(i.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[n],scope:c}):this.imageRasterizer.removeImagesFromCacheByIds([n],c))}removeImage(n,c){const d=this.images.get(c),x=d.get(n.toString());d.delete(n.toString()),this.patterns.get(c).delete(n.toString()),this.removeFromImageRasterizerCache(n,c),x.userImage&&x.userImage.onRemove&&x.userImage.onRemove()}listImages(n){return Array.from(this.images.get(n).keys()).map((c=>i.I.from(c)))}getImages(n,c,d){const x=[],E=[],I=this.imageProviders.get(c);for(const W of n){if(!W.iconsetId){x.push(W);continue}const ee=I.get(W.iconsetId);ee&&(this.getImage(W,c)?E.push(W):ee.addPendingRequest(W))}if(x.length===0)return void this._notify(E,c,d);let D=!0;const N=!!this.loaded.get(c),H=this.images.get(c);if(!N)for(const W of x)H.has(W.toString())||(D=!1);N||D?this._notify(x,c,d):this.requestors.push({ids:x,scope:c,callback:d})}rasterizeImages(n,c){const d=new Map,{tasks:x,scope:E}=n;for(const[I,D]of x.entries()){const N=this.getImage(D.id,E);N&&d.set(I,{image:N,imageVariant:D})}this._rasterizeImages(E,d,c)}_rasterizeImages(n,c,d){if(i.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:c,scope:n},d);else{const x=new Map;for(const[E,{image:I,imageVariant:D}]of c.entries())x.set(E,this.imageRasterizer.rasterize(D,I,n,0));d(void 0,x)}}getUpdatedImages(n){return this.updatedImages.get(n)||new Set}_notify(n,c,d){const x=this.images.get(c),E=new Map;for(const I of n){if(!x.get(I.toString())){if(I.iconsetId)continue;this.fire(new i.z("styleimagemissing",{id:I.name}))}const D=x.get(I.toString());if(!D){i.w(`Image "${I.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const N={data:D.usvg?null:D.data.clone(),pixelRatio:D.pixelRatio,sdf:D.sdf,usvg:D.usvg,version:D.version,stretchX:D.stretchX,stretchY:D.stretchY,content:D.content,hasRenderCallback:!!(D.userImage&&D.userImage.render)};D.usvg&&Object.assign(N,{width:D.icon.usvg_tree.width,height:D.icon.usvg_tree.height}),E.set(i.I.toString(I),N)}d(null,E)}getPixelSize(n){const{width:c,height:d}=this.atlasImage.get(n);return{width:c,height:d}}getPattern(n,c,d){const x=n.toString(),E=this.patterns.get(c),I=E.get(x),D=this.getImage(n,c);if(!D)return null;if(I){if(I.position.version===D.version)return I.position;I.position.version=D.version}else{if(D.usvg&&!D.data){const N=this.getPatternInFlightId(x,c);if(this.patternsInFlight.has(N))return null;this.patternsInFlight.add(N);const H=new i.A(n).scaleSelf(i.o.devicePixelRatio),W=new Map([[H.toString(),{image:D,imageVariant:H}]]);return this._rasterizeImages(c,W,((ee,Y)=>this.storePatternImage(H,c,D,d,Y))),null}this.storePattern(n,c,D)}return this._updatePatternAtlas(c,d),E.get(x).position}getPatternInFlightId(n,c){return i.B(n,c)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(n,c,d,x,E){const I=n.toString(),D=E?E.get(I):void 0;D&&(d.data=D,this.storePattern(n.id,c,d),this._updatePatternAtlas(c,x),this.patternsInFlight.delete(this.getPatternInFlightId(n.id.toString(),c)))}storePattern(n,c,d){const x={w:d.data.width+2*i.C,h:d.data.height+2*i.C,x:0,y:0},E=new i.F(x,d,i.C);this.patterns.get(c).set(n.toString(),{bin:x,position:E})}destroyAtlasTextures(){for(const n of this.atlasTexture.values())n&&n.destroy();this.atlasTexture.clear()}bind(n,c){const d=n.gl;let x=this.atlasTexture.get(c);x?this.dirty&&(x.update(this.atlasImage.get(c)),this.dirty=!1):(x=new i.T(n,this.atlasImage.get(c),d.RGBA8),this.atlasTexture.set(c,x)),x.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(n,c){const d=this.patterns.get(n),x=Array.from(d.values()).map((({bin:H})=>H)),{w:E,h:I}=i.G(x),D=this.atlasImage.get(n);D.resize({width:E||1,height:I||1});const N=this.images.get(n);for(const[H,{bin:W,position:ee}]of d.entries()){let Y=ee.padding;const se=W.x+Y,fe=W.y+Y,he=N.get(H).data,Se=he.width,me=he.height;Y=Y>1?Y-1:Y,i.q.copy(he,D,{x:0,y:0},{x:se,y:fe},{width:Se,height:me},c),i.q.copy(he,D,{x:0,y:me-Y},{x:se,y:fe-Y},{width:Se,height:Y},c),i.q.copy(he,D,{x:0,y:0},{x:se,y:fe+me},{width:Se,height:Y},c),i.q.copy(he,D,{x:Se-Y,y:0},{x:se-Y,y:fe},{width:Y,height:me},c),i.q.copy(he,D,{x:0,y:0},{x:se+Se,y:fe},{width:Y,height:me},c),i.q.copy(he,D,{x:Se-Y,y:me-Y},{x:se-Y,y:fe-Y},{width:Y,height:Y},c),i.q.copy(he,D,{x:0,y:me-Y},{x:se+Se,y:fe-Y},{width:Y,height:Y},c),i.q.copy(he,D,{x:0,y:0},{x:se+Se,y:fe+me},{width:Y,height:Y},c),i.q.copy(he,D,{x:Se-Y,y:0},{x:se-Y,y:fe+me},{width:Y,height:Y},c)}this.dirty=!0}beginFrame(){for(const n of this.images.keys())this.callbackDispatchedThisFrame.set(n,new Set)}dispatchRenderCallbacks(n,c){const d=this.images.get(c);for(const x of n){if(this.callbackDispatchedThisFrame.get(c).has(x.toString()))continue;this.callbackDispatchedThisFrame.get(c).add(x.toString());const E=d.get(x.toString());wn(E)&&this.updateImage(x,c,E)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function mo(p){const n=p.value,c=p.valueSpec,d=p.style,x=p.styleSpec,E=p.key,I=p.arrayElementValidator||ro;if(!Array.isArray(n))return[new i.V(E,n,`array expected, ${i.K(n)} found`)];if(c.length&&n.length!==c.length)return[new i.V(E,n,`array length ${c.length} expected, length ${n.length} found`)];if(c["min-length"]&&n.length<c["min-length"])return[new i.V(E,n,`array length at least ${c["min-length"]} expected, length ${n.length} found`)];let D={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};x.$version<7&&(D.function=c.function),i.H(c.value)&&(D=c.value);let N=[];for(let H=0;H<n.length;H++)N=N.concat(I({array:n,arrayIndex:H,value:n[H],valueSpec:D,style:d,styleSpec:x,key:`${E}[${H}]`},!0));return N}function di(p){const n=p.key,c=p.value,d=p.valueSpec;if(!i.L(c))return[new i.V(n,c,`number expected, ${i.K(c)} found`)];if(c!=c)return[new i.V(n,c,"number expected, NaN found")];if("minimum"in d){let x=d.minimum;if(Array.isArray(d.minimum)&&(x=d.minimum[p.arrayIndex]),c<x)return[new i.V(n,c,`${c} is less than the minimum value ${x}`)]}if("maximum"in d){let x=d.maximum;if(Array.isArray(d.maximum)&&(x=d.maximum[p.arrayIndex]),c>x)return[new i.V(n,c,`${c} is greater than the maximum value ${x}`)]}return[]}function Ao(p){const n=p.key,c=p.value;if(!i.H(c))return[new i.V(n,c,`object expected, ${i.K(c)} found`)];const d=p.valueSpec,x=i.J(c.type);let E,I,D,N={};const H=x!=="categorical"&&c.property===void 0,W=!H,ee=(function(he){const Se=he.stops;return Array.isArray(Se)&&Array.isArray(Se[0])&&i.H(Se[0][0])})(c),Y=Ir({key:p.key,value:p.value,valueSpec:p.styleSpec.function,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:function(he){if(x==="identity")return[new i.V(he.key,he.value,'identity function may not have a "stops" property')];let Se=[];const me=he.value;return Se=Se.concat(mo({key:he.key,value:me,valueSpec:he.valueSpec,style:he.style,styleSpec:he.styleSpec,arrayElementValidator:se})),Array.isArray(me)&&me.length===0&&Se.push(new i.V(he.key,me,"array must have at least one stop")),Se},default:function(he){return ro({key:he.key,value:he.value,valueSpec:d,style:he.style,styleSpec:he.styleSpec})}}});return x==="identity"&&H&&Y.push(new i.V(p.key,p.value,'missing required property "property"')),x==="identity"||c.stops||Y.push(new i.V(p.key,p.value,'missing required property "stops"')),x==="exponential"&&d.expression&&!i.M(d)&&Y.push(new i.V(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(W&&!i.N(d)?Y.push(new i.V(p.key,p.value,"property functions not supported")):H&&!i.O(d)&&Y.push(new i.V(p.key,p.value,"zoom functions not supported"))),x!=="categorical"&&!ee||c.property!==void 0||Y.push(new i.V(p.key,p.value,'"property" property is required')),Y;function se(he){let Se=[];const me=he.value,Te=he.key;if(!Array.isArray(me))return[new i.V(Te,me,`array expected, ${i.K(me)} found`)];if(me.length!==2)return[new i.V(Te,me,`array length 2 expected, length ${me.length} found`)];if(ee){if(!i.H(me[0]))return[new i.V(Te,me,`object expected, ${i.K(me[0])} found`)];const Oe=me[0];if(Oe.zoom===void 0)return[new i.V(Te,me,"object stop key must have zoom")];if(Oe.value===void 0)return[new i.V(Te,me,"object stop key must have value")];const Le=i.J(Oe.zoom);if(typeof Le!="number")return[new i.V(Te,Oe.zoom,"stop zoom values must be numbers")];if(D&&D>Le)return[new i.V(Te,Oe.zoom,"stop zoom values must appear in ascending order")];Le!==D&&(D=Le,I=void 0,N={}),Se=Se.concat(Ir({key:`${Te}[0]`,value:me[0],valueSpec:{zoom:{}},style:he.style,styleSpec:he.styleSpec,objectElementValidators:{zoom:di,value:fe}}))}else Se=Se.concat(fe({key:`${Te}[0]`,value:me[0],style:he.style,styleSpec:he.styleSpec},me));return i.Q(i.S(me[1]))?Se.concat([new i.V(`${Te}[1]`,me[1],"expressions are not allowed in function stops.")]):Se.concat(ro({key:`${Te}[1]`,value:me[1],valueSpec:d,style:he.style,styleSpec:he.styleSpec}))}function fe(he,Se){const me=i.K(he.value),Te=i.J(he.value),Oe=he.value!==null?he.value:Se;if(E){if(me!==E)return[new i.V(he.key,Oe,`${me} stop domain type must match previous stop domain type ${E}`)]}else E=me;if(me!=="number"&&me!=="string"&&me!=="boolean"&&typeof Te!="number"&&typeof Te!="string"&&typeof Te!="boolean")return[new i.V(he.key,Oe,"stop domain value must be a number, string, or boolean")];if(me!=="number"&&x!=="categorical"){let Le=`number expected, ${me} found`;return i.N(d)&&x===void 0&&(Le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(he.key,Oe,Le)]}return x!=="categorical"||me!=="number"||typeof Te=="number"&&isFinite(Te)&&Math.floor(Te)===Te?x!=="categorical"&&me==="number"&&typeof Te=="number"&&typeof I=="number"&&I!==void 0&&Te<I?[new i.V(he.key,Oe,"stop domain values must appear in ascending order")]:(I=Te,x==="categorical"&&Te in N?[new i.V(he.key,Oe,"stop domain values must be unique")]:(N[Te]=!0,[])):[new i.V(he.key,Oe,`integer expected, found ${String(Te)}`)]}}function eo(p){const n=(p.expressionContext==="property"?i.W:i.U)(i.S(p.value),p.valueSpec);if(n.result==="error")return n.value.map((d=>new i.V(`${p.key}${d.key}`,p.value,d.message)));const c=n.value.expression||n.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!c.outputDefined())return[new i.V(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!i.Z(c))return[new i.V(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter")return $o(c,p);if(p.expressionContext==="appearance")return _i(c,p);if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!i.X(c,["zoom","feature-state"]))return[new i.V(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!i.Y(c))return[new i.V(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function $o(p,n){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const x of n.valueSpec.expression.parameters)c.delete(x);if(c.size===0)return[];const d=[];return p instanceof i._&&c.has(p.name)?[new i.V(n.key,n.value,`["${p.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(p.eachChild((x=>{d.push(...$o(x,n))})),d)}function _i(p,n){const c=new Set;if(n.valueSpec&&n.valueSpec.expression)for(const x of n.valueSpec.expression.parameters)c.add(x);if(c.size===0)return[];const d=[];return p instanceof i._&&!c.has(p.name)?[new i.V(n.key,n.value,`["${p.name}"] is not an allowed parameter`)]:(p.eachChild((x=>{d.push(..._i(x,n))})),d)}function Bn(p){const n=p.key,c=p.value,d=p.valueSpec,x=[];return Array.isArray(d.values)?d.values.indexOf(i.J(c))===-1&&x.push(new i.V(n,c,`expected one of [${d.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(d.values).indexOf(i.J(c))===-1&&x.push(new i.V(n,c,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(c)} found`)),x}function Ca(p){return i.a2(i.S(p.value))?eo(Object.assign({},p,{expressionContext:"filter",valueSpec:p.styleSpec[`filter_${p.layerType||"fill"}`]})):Io(p)}function Io(p){const n=p.value,c=p.key;if(!Array.isArray(n))return[new i.V(c,n,`array expected, ${i.K(n)} found`)];if(n.length<1)return[new i.V(c,n,"filter array must have at least 1 element")];const d=p.styleSpec;let x=Bn({key:`${c}[0]`,value:n[0],valueSpec:d.filter_operator});switch(i.J(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&i.J(n[1])==="$type"&&x.push(new i.V(c,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&x.push(new i.V(c,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(i.a0(n[1])||x.push(new i.V(`${c}[1]`,n[1],`string expected, ${i.K(n[1])} found`)));for(let E=2;E<n.length;E++)i.J(n[1])==="$type"?x=x.concat(Bn({key:`${c}[${E}]`,value:n[E],valueSpec:d.geometry_type})):i.a0(n[E])||i.L(n[E])||i.$(n[E])||x.push(new i.V(`${c}[${E}]`,n[E],`string, number, or boolean expected, ${i.K(n[E])} found.`));break;case"any":case"all":case"none":for(let E=1;E<n.length;E++)x=x.concat(Io({key:`${c}[${E}]`,value:n[E],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":n.length!==2?x.push(new i.V(c,n,`filter array for "${n[0]}" operator must have 2 elements`)):i.a0(n[1])||x.push(new i.V(`${c}[1]`,n[1],`string expected, ${i.K(n[1])} found`))}return x}function Qa(p,n){const c=p.key,d=p.style,x=p.layer,E=p.styleSpec,I=p.value,D=p.objectKey,N=E[`${n}_${p.layerType}`];if(!N)return[];const H=D.match(/^(.*)-use-theme$/);if(H&&N[H[1]])return i.Q(I)?[].concat(ro({key:p.key,value:I,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:d,styleSpec:E,expressionContext:"property",propertyType:n,propertyKey:D})):ro({key:c,value:I,valueSpec:{type:"string"},style:d,styleSpec:E});const W=D.match(/^(.*)-transition$/);if(n==="paint"&&W&&N[W[1]]&&N[W[1]].transition)return ro({key:c,value:I,valueSpec:E.transition,style:d,styleSpec:E});const ee=p.valueSpec||N[D];if(!ee)return[new i.a3(c,I,`unknown property "${D}"`)];let Y;if(i.a0(I)&&i.N(ee)&&!ee.tokens&&(Y=/^{([^}]+)}$/.exec(I))){const fe=`\`{ "type": "identity", "property": ${Y?JSON.stringify(Y[1]):'"_"'} }\``;return[new i.V(c,I,`"${D}" does not support interpolation syntax
Use an identity property function instead: ${fe}.`)]}const se=[];if(p.layerType==="symbol")D!=="text-field"||!d||d.glyphs||d.imports||se.push(new i.V(c,I,'use of "text-field" requires a style "glyphs" property')),D==="text-font"&&i.a4(i.S(I))&&i.J(I.type)==="identity"&&se.push(new i.V(c,I,'"text-font" does not support identity functions'));else if(p.layerType==="model"&&n==="paint"&&x&&x.layout&&x.layout.hasOwnProperty("model-id")&&i.N(ee)&&(i.a5(ee)||i.O(ee))){const fe=i.W(i.S(I),ee),he=fe.value.expression||fe.value._styleExpression.expression;he&&!i.X(he,["measure-light"])&&(D==="model-emissive-strength"&&i.Y(he)&&i.Z(he)||se.push(new i.V(c,I,`${D} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return se.concat(ro({key:p.key,value:I,valueSpec:ee,style:d,styleSpec:E,expressionContext:"property",propertyType:n,propertyKey:D}))}function ao(p){return Qa(p,"paint")}function ai(p){return Qa(p,"layout")}function Po(p){let n=[];const c=p.value,d=p.key,x=p.style,E=p.styleSpec;if(!i.H(c))return[new i.V(d,c,"object expected")];c.type||c.ref||n.push(new i.V(d,c,'either "type" or "ref" is required'));let I=i.J(c.type);const D=i.J(c.ref);if(c.id){const N=i.J(c.id);for(let H=0;H<p.arrayIndex;H++){const W=x.layers[H];i.J(W.id)===N&&n.push(new i.V(d,c.id,`duplicate layer id "${N}", previously used at line ${W.id.__line__}`))}}if("ref"in c){let N;["type","source","source-layer","filter","layout"].forEach((H=>{H in c&&n.push(new i.V(d,c[H],`"${H}" is prohibited for ref layers`))})),x.layers.forEach((H=>{i.J(H.id)===D&&(N=H)})),N?N.ref?n.push(new i.V(d,c.ref,"ref cannot reference another ref layer")):I=i.J(N.type):typeof D=="string"&&n.push(new i.V(d,c.ref,`ref layer "${D}" not found`))}else if(I!=="background"&&I!=="sky"&&I!=="slot")if(c.source)if(i.a0(c.source)){const N=x.sources&&x.sources[c.source],H=N&&i.J(N.type);N?H==="vector"&&I==="raster"?n.push(new i.V(d,c.source,`layer "${c.id}" requires a raster source`)):H==="raster"&&I!=="raster"?n.push(new i.V(d,c.source,`layer "${c.id}" requires a vector source`)):H!=="vector"||c["source-layer"]?H==="raster-dem"&&I!=="hillshade"?n.push(new i.V(d,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):H!=="raster-array"||["raster","raster-particle"].includes(I)?I==="line"&&c.paint&&(c.paint["line-gradient"]||c.paint["line-trim-offset"])&&H==="geojson"&&!N.lineMetrics?n.push(new i.V(d,c,`layer "${c.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):I==="raster-particle"&&H!=="raster-array"&&n.push(new i.V(d,c.source,`layer "${c.id}" requires a 'raster-array' source.`)):n.push(new i.V(d,c.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new i.V(d,c,`layer "${c.id}" must specify a "source-layer"`)):n.push(new i.V(d,c.source,`source "${c.source}" not found`))}else n.push(new i.V(`${d}.source`,c.source,'"source" must be a string'));else n.push(new i.V(d,c,'missing required property "source"'));return n=n.concat(Ir({key:d,value:c,valueSpec:E.layer,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ro({key:`${d}.type`,value:c.type,valueSpec:E.layer.type,style:p.style,styleSpec:p.styleSpec,object:c,objectKey:"type"}),filter:N=>Ca(Object.assign({layerType:I},N)),layout:N=>Ir({layer:c,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":H=>ai(Object.assign({layerType:I},H))}}),paint:N=>Ir({layer:c,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":H=>ao(Object.assign({layerType:I,layer:c},H))}}),appearances(N){const H=mo({key:N.key,value:N.value,valueSpec:N.valueSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:Y=>(function(se){const{key:fe,layer:he,layerType:Se}=se,me=i.J(se.value),Te=i.J(me.name),Oe=i.J(me.condition),Le=Ir({key:fe,value:me,valueSpec:se.styleSpec.appearance,style:se.style,styleSpec:se.styleSpec,objectElementValidators:{condition:Ge=>(function(Ue){const Ze=[];return Ze.push(...eo({key:Ue.key,value:Ue.object.condition,valueSpec:i.a6.appearance.condition,expressionContext:"appearance"})),Ze})(Object.assign({layer:he,layerType:Se},Ge)),properties:Ge=>(function(Ue){const Ze=[],{styleSpec:$e,layer:Ve,layerType:We}=Ue,yt=$e[`paint_${We}`],lt=$e[`layout_${We}`],Ot=Ue.object[Ue.objectKey];for(const _t in Ot){const It=_t in yt?"paint":_t in lt?"layout":void 0;if(!It){Ze.push(new i.V(Ue.key,_t,`unknown property "${_t}" for layer type "${We}"`));continue}const ur=Object.assign({},Ue,{key:`${Ue.key}.${_t}`,object:Ot,objectKey:_t,layer:Ve,layerType:We,value:Ot[_t],valueSpec:It==="paint"?yt[_t]:lt[_t]});Ze.push(...Qa(ur,It))}return Ze})(Object.assign({layer:he,layerType:Se},Ge))}});return Te==="hidden"||Oe||Le.push(new i.V(se.key,"name",'Appearance with name different than "hidden" must have a condition')),Le})(Object.assign({layerType:I,layer:c},Y))}),W=Array.isArray(N.value)?N.value:[],ee=new Set;return W.forEach(((Y,se)=>{const fe=i.J(Y.name);if(fe)if(ee.has(fe)){const he=i.J(c.id);H.push(new i.V(N.key,fe,`Duplicated appearance name "${fe}" for layer "${he}"`))}else ee.add(fe)})),H}}})),n}function to({key:p,value:n}){return i.a0(n)?[]:[new i.V(p,n,`string expected, ${i.K(n)} found`)]}const Va={promoteId:function p({key:n,value:c}){if(i.a0(c))return to({key:n,value:c});if(Array.isArray(c)){const x=[],E=i.S(c),I=i.U(E);return I.result==="error"&&I.value.forEach((D=>{x.push(new i.V(`${n}${D.key}`,null,`${D.message}`))})),i.X(I.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||x.push(new i.V(`${n}`,null,"promoteId expression should be only feature dependent")),x}if(!i.H(c))return[new i.V(n,c,`string, expression or object expected, "${i.K(c)}" found`)];const d=[];for(const x in c)d.push(...p({key:`${n}.${x}`,value:c[x]}));return d}};function Mi(p){const n=p.value,c=p.key,d=p.styleSpec,x=p.style;if(!i.H(n))return[new i.V(c,n,`object expected, ${i.K(n)} found`)];if(!("type"in n))return[new i.V(c,n,'"type" is required')];const E=i.J(n.type);let I=[];switch(["vector","raster","raster-dem","raster-array"].includes(E)&&("url"in n||"tiles"in n||I.push(new i.a3(c,n,'Either "url" or "tiles" is required.'))),E){case"vector":case"raster":case"raster-dem":case"raster-array":return I=I.concat(Ir({key:c,value:n,valueSpec:d[`source_${E.replace("-","_")}`],style:p.style,styleSpec:d,objectElementValidators:Va})),I;case"geojson":if(I=Ir({key:c,value:n,valueSpec:d.source_geojson,style:x,styleSpec:d,objectElementValidators:Va}),"cluster"in n&&"clusterProperties"in n){if(!i.H(n.clusterProperties))return[new i.V(`${c}.clusterProperties`,n,`object expected, ${i.K(n)} found`)];for(const D in n.clusterProperties){const N=n.clusterProperties[D];if(!Array.isArray(N))return[new i.V(`${c}.clusterProperties.${D}`,N,"array expected")];const[H,W]=N,ee=typeof H=="string"?[H,["accumulated"],["get",D]]:H;I.push(...eo({key:`${c}.${D}.map`,value:W,expressionContext:"cluster-map"})),I.push(...eo({key:`${c}.${D}.reduce`,value:ee,expressionContext:"cluster-reduce"}))}}return I;case"video":return Ir({key:c,value:n,valueSpec:d.source_video,style:x,styleSpec:d});case"image":return Ir({key:c,value:n,valueSpec:d.source_image,style:x,styleSpec:d});case"canvas":return[new i.V(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Bn({key:`${c}.type`,value:n.type,valueSpec:{values:os(d)}})}}function os(p){return p.source.reduce(((n,c)=>{const d=p[c];return d.type.type==="enum"&&(n=n.concat(Object.keys(d.type.values))),n}),[])}function yl(p){const n=p.value,c=p.styleSpec,d=c.light,x=p.style;if(n===void 0)return[];if(!i.H(n))return[new i.V("light",n,`object expected, ${i.K(n)} found`)];let E=[];for(const I in n){const D=I.match(/^(.*)-transition$/),N=I.match(/^(.*)-use-theme$/);E=E.concat(N&&d[N[1]]?ro({key:I,value:n[I],valueSpec:{type:"string"},style:x,styleSpec:c}):D&&d[D[1]]&&d[D[1]].transition?ro({key:I,value:n[I],valueSpec:c.transition,style:x,styleSpec:c}):d[I]?ro({key:I,value:n[I],valueSpec:d[I],style:x,styleSpec:c}):[new i.V(I,n[I],`unknown property "${I}"`)])}return E}function al(p){const n=p.value;if(!n)return[];const c=p.key;if(!i.H(n))return[new i.V(c,n,`object expected, ${i.K(n)} found`)];let d=[];const x=p.styleSpec,E=x["light-3d"],I=p.style,D=p.style.lights;for(const W of["type","id"])if(!(W in n))return d=d.concat([new i.V(c,n,`missing property "${W}"`)]),d;if(!i.a0(n.type))return d=d.concat([new i.V(`${c}.type`,n.type,"string expected")]),d;if(D)for(let W=0;W<p.arrayIndex;W++){const ee=i.J(n.type),Y=D[W];i.J(Y.type)===ee&&d.push(new i.V(c,n.id,`duplicate light type "${n.type}", previously defined at line ${Y.id.__line__}`))}const N=`properties_light_${n.type}`;if(!(N in x))return d=d.concat([new i.V(`${c}.type`,n,`Invalid light type ${n.type}`)]),d;const H=x[N];for(const W in n)if(W==="properties"){const ee=n[W];if(!i.H(ee))return d=d.concat([new i.V("properties",ee,`object expected, ${i.K(ee)} found`)]),d;for(const Y in ee){const se=Y.match(/^(.*)-transition$/),fe=Y.match(/^(.*)-use-theme$/);d=d.concat(fe&&H[fe[1]]?ro({key:W,value:ee[Y],valueSpec:{type:"string"},style:I,styleSpec:x}):se&&H[se[1]]&&H[se[1]].transition?ro({key:W,value:n[W],valueSpec:x.transition,style:I,styleSpec:x}):H[Y]?ro({key:Y,value:ee[Y],valueSpec:H[Y],style:I,styleSpec:x}):[new i.a3(p.key,ee[Y],`unknown property "${Y}"`)])}}else d=d.concat(E[W]?ro({key:W,value:n[W],valueSpec:E[W],style:I,styleSpec:x}):[new i.a3(W,n[W],`unknown property "${W}"`)]);return d}function $n(p){const n=p.value,c=p.key,d=p.style,x=p.styleSpec,E=x.terrain;if(n==null)return[];if(!i.H(n))return[new i.V("terrain",n,`object expected, ${i.K(n)} found`)];let I=[];for(const D in n){const N=D.match(/^(.*)-transition$/),H=D.match(/^(.*)-use-theme$/);I=I.concat(H&&E[H[1]]?ro({key:D,value:n[D],valueSpec:{type:"string"},style:d,styleSpec:x}):N&&E[N[1]]&&E[N[1]].transition?ro({key:D,value:n[D],valueSpec:x.transition,style:d,styleSpec:x}):E[D]?ro({key:D,value:n[D],valueSpec:E[D],style:d,styleSpec:x}):[new i.a3(D,n[D],`unknown property "${D}"`)])}if(n.source)if(i.a0(n.source)){const D=d.sources&&d.sources[n.source],N=D&&i.J(D.type);D?N!=="raster-dem"&&I.push(new i.V(`${c}.source`,n.source,`terrain cannot be used with a source of type ${N}, it only be used with a "raster-dem" source type`)):I.push(new i.V(`${c}.source`,n.source,`source "${n.source}" not found`))}else I.push(new i.V(`${c}.source`,n.source,"source must be a string"));else I.push(new i.V(c,n,'terrain is missing required property "source"'));return I}function Qi(p){const n=p.value,c=p.style,d=p.styleSpec,x=d.fog;if(n===void 0)return[];if(!i.H(n))return[new i.V("fog",n,`object expected, ${i.K(n)} found`)];let E=[];for(const I in n){const D=I.match(/^(.*)-transition$/),N=I.match(/^(.*)-use-theme$/);E=E.concat(N&&x[N[1]]?ro({key:I,value:n[I],valueSpec:{type:"string"},style:c,styleSpec:d}):D&&x[D[1]]&&x[D[1]].transition?ro({key:I,value:n[I],valueSpec:d.transition,style:c,styleSpec:d}):x[I]?ro({key:I,value:n[I],valueSpec:x[I],style:c,styleSpec:d}):[new i.a3(I,n[I],`unknown property "${I}"`)])}return E}const Xo={"*":()=>[],array:mo,boolean:function(p){const n=p.value,c=p.key;return i.$(n)?[]:[new i.V(c,n,`boolean expected, ${i.K(n)} found`)]},number:di,color:function({key:p,value:n}){return i.a0(n)?i.a1.parseCSSColor(n)===null?[new i.V(p,n,`color expected, "${n}" found`)]:[]:[new i.V(p,n,`color expected, ${i.K(n)} found`)]},enum:Bn,filter:Ca,function:Ao,layer:Po,object:Ir,source:Mi,model:i.a7,light:yl,"light-3d":al,terrain:$n,fog:Qi,string:to,formatted:function(p){return to(p).length===0?[]:eo(p)},resolvedImage:function(p){return to(p).length===0?[]:eo(p)},projection:function(p){const n=p.value,c=p.styleSpec,d=c.projection,x=p.style;if(i.H(n)){let E=[];for(const I in n)E=E.concat(ro({key:I,value:n[I],valueSpec:d[I],style:x,styleSpec:c}));return E}return i.a0(n)?[]:[new i.V("projection",n,`object or string expected, ${i.K(n)} found`)]},import:function(p){const n=p.key,{value:c,styleSpec:d}=p;if(!i.H(c))return[new i.V(n,c,"import must be an object")];const{data:x,...E}=c;Object.defineProperty(E,"__line__",{value:c.__line__,enumerable:!1});let I=Ir(Object.assign({},p,{value:E,valueSpec:d.import}));return i.J(E.id)===""&&I.push(new i.V(`${p.key}.id`,E,"import id can't be an empty string")),x&&(I=I.concat(bc(x,d,{key:`${p.key}.data`}))),I},iconset:function(p){const n=p.value,c=p.key,d=p.styleSpec,x=p.style;if(!i.H(n))return[new i.V(c,n,"object expected")];if(!n.type)return[new i.V(c,n,'"type" is required')];const E=i.J(n.type);let I=[];if(I=I.concat(Ir({key:c,value:n,valueSpec:d[`iconset_${E}`],style:x,styleSpec:d})),(function(D,N){return!(D!=="source"||!N.source)})(E,n)){const D=x.sources&&x.sources[n.source],N=D&&i.J(D.type);D?N!=="raster-array"&&I.push(new i.V(c,n.source,`iconset cannot be used with a source of type ${String(N)}, it only be used with a "raster-array" source type`)):I.push(new i.V(c,n.source,`source "${n.source}" not found`))}return I}};function ro(p,n=!1){const c=p.value,d=p.valueSpec,x=p.styleSpec;if(d.expression){if(i.a4(i.J(c)))return Ao(p);if(i.Q(i.S(c)))return eo(p)}if(d.type&&Xo[d.type]){const E=Xo[d.type](p);return n===!0&&E.length>0&&Array.isArray(p.value)?eo(p):E}return Ir(Object.assign({},p,{valueSpec:d.type?x[d.type]:d}))}function Ir(p){const n=p.key,c=p.value,d=p.valueSpec||{},x=p.objectElementValidators||{},E=p.style,I=p.styleSpec;if(!i.H(c))return[new i.V(n,c,`object expected, ${i.K(c)} found`)];let D=[];for(const N in c){const H=N.split(".")[0];let W;x[H]?W=x[H]:d[H]?W=ro:x["*"]?W=x["*"]:d["*"]&&(W=ro),W?D=D.concat(W({key:(n&&`${n}.`)+N,value:c[N],valueSpec:d[H]||d["*"],style:E,styleSpec:I,object:c,objectKey:N},c)):D.push(new i.a3(n,c[N],`unknown property "${N}"`))}for(const N in d)x[N]||d[N].required&&d[N].default===void 0&&c[N]===void 0&&D.push(new i.V(n,c,`missing required property "${N}"`));return D}function If({key:p,value:n}){const c=to({key:p,value:n});if(c.length)return c;const d=n;return d.indexOf("{fontstack}")===-1&&c.push(new i.V(p,n,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&c.push(new i.V(p,n,'"glyphs" url must include a "{range}" token')),c}function bc(p,n=i.a6,c={}){return Ir({key:c.key||"",value:p,valueSpec:Object.assign(n.$root,{"*":{type:"*"}}),styleSpec:n,style:p,objectElementValidators:{glyphs:If}})}function Gs(p,n=i.a6){return g(bc(p,n))}const hd=p=>g(Mi(p)),Zu=p=>g(yl(p)),Pf=p=>g(al(p)),rr=p=>g($n(p)),Ul=p=>g(Qi(p)),kh=p=>g((function(n){const c=n.value,d=n.style,x=n.styleSpec,E=x.snow;if(c===void 0)return[];if(!i.H(c))return[new i.V("snow",c,`object expected, ${i.K(c)} found`)];let I=[];for(const D in c){const N=D.match(/^(.*)-transition$/);I=I.concat(N&&E[N[1]]&&E[N[1]].transition?ro({key:D,value:c[D],valueSpec:x.transition,style:d,styleSpec:x}):E[D]?ro({key:D,value:c[D],valueSpec:E[D],style:d,styleSpec:x}):[new i.a3(D,c[D],`unknown property "${D}"`)])}return I})(p)),Xu=p=>g((function(n){const c=n.value,d=n.style,x=n.styleSpec,E=x.rain;if(c===void 0)return[];if(!i.H(c))return[new i.V("rain",c,`object expected, ${i.K(c)} found`)];let I=[];for(const D in c){const N=D.match(/^(.*)-transition$/);I=I.concat(N&&E[N[1]]&&E[N[1]].transition?ro({key:D,value:c[D],valueSpec:x.transition,style:d,styleSpec:x}):E[D]?ro({key:D,value:c[D],valueSpec:E[D],style:d,styleSpec:x}):[new i.a3(D,c[D],`unknown property "${D}"`)])}return I})(p)),ut=p=>g(Po(p)),le=p=>g(Ca(p)),ge=p=>g(ao(p)),Me=p=>g(ai(p)),ze=p=>g(i.a7(p));function g(p){return p.slice().sort(((n,c)=>n.line&&c.line?n.line-c.line:0))}function ce(p,n){let c=!1;if(n&&n.length)for(const d of n)d instanceof i.a3?i.w(d.message):(p.fire(new i.y(new Error(d.message))),c=!0);return c}let At;class Je extends i.E{constructor(n,c="flat"){super(),this._transitionable=new i.a8(At||(At=new i.a9({anchor:new i.aa(i.a6.light.anchor),position:new i.ab(i.a6.light.position),color:new i.aa(i.a6.light.color),intensity:new i.aa(i.a6.light.intensity)}))),this.setLight(n,c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,c,d={}){this._validate(Zu,n,d)||(this._transitionable.setTransitionOrValue(n),this.id=c)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,d){return(!d||d.validate!==!1)&&ce(this,n.call(Gs,Object.assign({value:c,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}let vt=class extends i.E{constructor(p,n,c,d,x){super(),this.scope=c,this._transitionable=new i.a8(new i.a9({source:new i.aa(i.a6.terrain.source),exaggeration:new i.aa(i.a6.terrain.exaggeration)}),c,d),this._transitionable.setTransitionOrValue(p,d),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n,this.worldview=x}get(){return this._transitionable.serialize()}set(p,n){this._transitionable.setTransitionOrValue(p,n)}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}getExaggeration(p){return this._transitioning.possiblyEvaluate(new i.ac(p,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const p=this._transitionable._values.exaggeration;if(!p)return null;const n=p.value.expression;if(!n)return null;let c=-1,d=-1,x=1;for(const E of n.zoomStops)x=n.evaluate(new i.ac(E,{worldview:this.worldview})),x>.01?(c=E,d=-1):d=E;return x<.01&&c>0&&d>c?[c,d]:null}isZoomDependent(){const p=this._transitionable._values.exaggeration;return p!=null&&p.value!=null&&p.value.expression!=null&&p.value.expression instanceof i.ad}};const Lt=45,kt=65,Fr=.05;function Dr(p,n,c,d){const x=i.ah(Lt,kt,c),[E,I]=wr(p,d);let D=1-Math.min(1,Math.exp((n-E)/(I-E)*-6));return D*=D*D,D=Math.min(1,1.00747*D),D*x*p.alpha}function wr(p,n){const c=.5/Math.tan(.5*n);return[p.range[0]+c,p.range[1]+c]}function zn(p,n,c,d,x){const E=i.af([],[n,c,d],x.mercatorFogMatrix);return Dr(p,i.ag(E),x.pitch,x._fov)}function Un(p,n,c,d,x,E,I){const D=[[c,d,0],[x,d,0],[x,E,0],[c,E,0]];let N=Number.MAX_VALUE,H=-Number.MAX_VALUE;for(const W of D){const ee=i.af([],W,n),Y=i.ag(ee);N=Math.min(N,Y),H=Math.max(H,Y)}return[Dr(p,N,I.pitch,I._fov),Dr(p,H,I.pitch,I._fov)]}class Yn extends i.E{constructor(n,c,d,x){super();const E=new i.a9({range:new i.aa(i.a6.fog.range),color:new i.aa(i.a6.fog.color),"color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.aa(i.a6.fog["high-color"]),"high-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.aa(i.a6.fog["space-color"]),"space-color-use-theme":new i.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.aa(i.a6.fog["horizon-blend"]),"star-intensity":new i.aa(i.a6.fog["star-intensity"]),"vertical-range":new i.aa(i.a6.fog["vertical-range"])});this._transitionable=new i.a8(E,d,new Map(x)),this.set(n,x),this._transitioning=this._transitionable.untransitioned(),this._transform=c,this.properties=new i.ai(E),this.scope=d}get state(){const n=this._transform,c=n.projection.name==="globe",d=i.aj(n.zoom),x=this.properties.get("range"),E=[.5,3];return{range:c?[i.ak(E[0],x[0],d),i.ak(E[1],x[1],d)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,c,d={}){if(this._validate(Ul,n,d))return;const x=Object.assign({},n);for(const E of Object.keys(i.a6.fog))x[E]===void 0&&(x[E]=i.a6.fog[E].default);this._options=x,this._transitionable.setTransitionOrValue(this._options,c)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ah(Lt,kt,n))*c.a}getOpacityAtLatLng(n,c){return this._transform.projection.supportsFog?(function(d,x,E){const I=i.ae.fromLngLat(x),D=E.elevation?E.elevation.getAtPointOrZero(I):0;return zn(d,I.x,I.y,D,E)})(this.state,n,c):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const c=this._transform.calculateFogTileMatrix(n.toUnwrapped());return Un(this.state,c,0,0,i.al,i.al,this._transform)}getOpacityForBounds(n,c,d,x,E){return this._transform.projection.supportsFog?Un(this.state,n,c,d,x,E,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?wr(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const c=[4,5,6,7];for(const d of c){const x=n.points[d];let E;if(x[2]>=0)E=x;else{const I=n.points[d-4];E=i.am(I,x,I[2]/(I[2]-x[2]))}if(zn(this.state,E[0],E[1],0,this._transform)>=Fr)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,c,d){return(!d||d.validate!==!1)&&ce(this,n.call(Gs,Object.assign({value:c,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}}let Ii,Fn,go,wo,ia=class extends i.E{constructor(p,n,c,d){super();const x=Ii||(Ii=new i.a9({density:new i.aa(i.a6.snow.density),intensity:new i.aa(i.a6.snow.intensity),color:new i.aa(i.a6.snow.color),opacity:new i.aa(i.a6.snow.opacity),vignette:new i.aa(i.a6.snow.vignette),"vignette-color":new i.aa(i.a6.snow["vignette-color"]),"center-thinning":new i.aa(i.a6.snow["center-thinning"]),direction:new i.aa(i.a6.snow.direction),"flake-size":new i.aa(i.a6.snow["flake-size"])}));this._transitionable=new i.a8(x,c,new Map(d)),this.set(p,d),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(x),this.scope=c}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),c=this.properties.get("direction"),d=i.an(c[0]),x=-Math.max(i.an(c[1]),.01),E=[Math.cos(d)*Math.cos(x),Math.sin(d)*Math.cos(x),Math.sin(x)],I=this.properties.get("vignette"),D=this.properties.get("vignette-color");return D.a=I,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(n.r,n.g,n.b,n.a*p),direction:E,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:D}}get(){return this._transitionable.serialize()}set(p,n,c={}){if(this._validate(kh,p,c))return;const d=Object.assign({},p);for(const x of Object.keys(i.a6.snow))d[x]===void 0&&(d[x]=i.a6.snow[x].default);this._options=d,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,c){return(!c||c.validate!==!1)&&ce(this,p.call(Gs,Object.assign({value:n,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}},Ui=class extends i.E{constructor(p,n,c,d){super();const x=Fn||(Fn=new i.a9({density:new i.aa(i.a6.rain.density),intensity:new i.aa(i.a6.rain.intensity),color:new i.aa(i.a6.rain.color),opacity:new i.aa(i.a6.rain.opacity),vignette:new i.aa(i.a6.rain.vignette),"vignette-color":new i.aa(i.a6.rain["vignette-color"]),"center-thinning":new i.aa(i.a6.rain["center-thinning"]),direction:new i.aa(i.a6.rain.direction),"droplet-size":new i.aa(i.a6.rain["droplet-size"]),"distortion-strength":new i.aa(i.a6.rain["distortion-strength"])}));this._transitionable=new i.a8(x,c,new Map(d)),this.set(p,d),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ai(x),this.scope=c}get state(){const p=this.properties.get("opacity"),n=this.properties.get("color"),c=this.properties.get("direction"),d=i.an(c[0]),x=-Math.max(i.an(c[1]),.01),E=[Math.cos(d)*Math.cos(x),Math.sin(d)*Math.cos(x),Math.sin(x)],I=this.properties.get("vignette-color");return I.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ao(n.r,n.g,n.b,n.a*p),direction:E,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:I}}get(){return this._transitionable.serialize()}set(p,n,c={}){if(this._validate(Xu,p,c))return;const d=Object.assign({},p);for(const x of Object.keys(i.a6.rain))d[x]===void 0&&(d[x]=i.a6.rain[x].default);this._options=d,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(p){this._transitionable.setTransitionOrValue(this._options,new Map(p))}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}_validate(p,n,c){return(!c||c.validate!==!1)&&ce(this,p.call(Gs,Object.assign({value:n,style:{glyphs:!0,sprite:!0},styleSpec:i.a6})))}};class ri extends i.E{constructor(n,c,d,x){super(),this.scope=d,this._options=n,this.properties=new i.ai(c),this._transitionable=new i.a8(c,d,new Map(x)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,c){this._options=n,this._transitionable.setTransitionOrValue(n.properties,c)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class yn{constructor(n,c,d){this.screenBounds=n,this.cameraPoint=d.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=c,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,d)}static createFromScreenPoints(n,c){let d,x;if(n instanceof i.P||typeof n[0]=="number"){const E=i.P.convert(n);d=[E],x=c.isPointAboveHorizon(E)}else{const E=i.P.convert(n[0]),I=i.P.convert(n[1]),D=E.add(I)._div(2);d=[E,I],x=i.aq(E,I).every((N=>c.isPointAboveHorizon(N)))&&c.isPointAboveHorizon(D)}return new yn(d,x,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return i.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const c=this.screenBounds[0],d=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.aq(c,d,0,!1);return this.cameraPoint.y>d.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<d.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=d.x?x[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(x[3]=this.cameraPoint)),i.ar(x,n)}bufferedCameraGeometryGlobe(n){const c=this.screenBounds[0],d=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],x=i.aq(c,d,n),E=this.cameraPoint.clone();switch(3*((E.y>c.y)+(E.y>d.y))+((E.x>c.x)+(E.x>d.x))){case 0:x[0]=E,x[4]=E.clone();break;case 1:x.splice(1,0,E);break;case 2:x[1]=E;break;case 3:x.splice(4,0,E);break;case 5:x.splice(2,0,E);break;case 6:x[3]=E;break;case 7:x.splice(3,0,E);break;case 8:x[2]=E}return x}containsTile(n,c,d,x=0){const E=n.queryPadding/c._pixelsPerMercatorPixel+1,I=d?this._bufferedCameraMercator(E,c):this._bufferedScreenMercator(E,c);let D=n.tileID.wrap+(I.unwrapped?x:0);const N=I.polygon.map((Se=>i.as(n.tileTransform,Se,D)));if(!i.at(N,0,0,i.al,i.al))return;D=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const H=this.screenGeometryMercator.polygon.map((Se=>i.au(n.tileTransform,Se,D))),W=H.map((Se=>new i.P(Se[0],Se[1]))),ee=c.getFreeCameraOptions().position||new i.ae(0,0,0),Y=i.au(n.tileTransform,ee,D),se=H.map((Se=>{const me=i.av(Se,Se,Y);return i.aw(me,me),new i.ax(Y,me)})),fe=i.ay(n,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:W,tilespaceRays:se,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(he=i.az(N),he.min.x=i.aA(he.min.x,0,i.al),he.min.y=i.aA(he.min.y,0,i.al),he.max.x=i.aA(he.max.x,0,i.al),he.max.y=i.aA(he.max.y,0,i.al),he),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:fe};var he}_bufferedScreenMercator(n,c){const d=ca(n);if(this._screenRaycastCache[d])return this._screenRaycastCache[d];{let x;return x=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),c):{polygon:this.bufferedScreenGeometry(n).map((E=>c.pointCoordinate3D(E))),unwrapped:!0},this._screenRaycastCache[d]=x,x}}_bufferedCameraMercator(n,c){const d=ca(n);if(this._cameraRaycastCache[d])return this._cameraRaycastCache[d];{let x;return x=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),c):{polygon:this.bufferedCameraGeometry(n).map((E=>c.pointCoordinate3D(E))),unwrapped:!0},this._cameraRaycastCache[d]=x,x}}_projectAndResample(n,c){const d=(function(E,I){const D=i.aB([],I.pixelMatrix,I.globeMatrix),N=[0,-i.aD,0,1],H=[0,i.aD,0,1],W=[0,0,0,1];i.aC(N,N,D),i.aC(H,H,D),i.aC(W,W,D);const ee=new i.P(N[0]/N[3],N[1]/N[3]),Y=new i.P(H[0]/H[3],H[1]/H[3]),se=i.aE(E,ee)&&N[3]<W[3],fe=i.aE(E,Y)&&H[3]<W[3];if(!se&&!fe)return null;const he=(function(Ze,$e,Ve){for(let We=1;We<Ze.length;We++){const yt=mn($e.pointCoordinate3D(Ze[We-1]).x),lt=mn($e.pointCoordinate3D(Ze[We]).x);if(Ve<0){if(yt<lt)return{idx:We,t:-yt/(lt-1-yt)}}else if(lt<yt)return{idx:We,t:(1-yt)/(lt+1-yt)}}return null})(E,I,se?-1:1);if(!he)return null;const{idx:Se,t:me}=he;let Te=Se>1?He(E.slice(0,Se),I):[],Oe=Se<E.length?He(E.slice(Se),I):[];Te=Te.map((Ze=>new i.P(mn(Ze.x),Ze.y))),Oe=Oe.map((Ze=>new i.P(mn(Ze.x),Ze.y)));const Le=[...Te];Le.length===0&&Le.push(Oe[Oe.length-1]);const Ge=i.ak(Le[Le.length-1].y,(Oe.length===0?Te[0]:Oe[0]).y,me);let Ue;return Ue=se?[new i.P(0,Ge),new i.P(0,0),new i.P(1,0),new i.P(1,Ge)]:[new i.P(1,Ge),new i.P(1,1),new i.P(0,1),new i.P(0,Ge)],Le.push(...Ue),Oe.length===0?Le.push(Te[0]):Le.push(...Oe),{polygon:Le.map((Ze=>new i.ae(Ze.x,Ze.y))),unwrapped:!1}})(n,c);if(d)return d;const x=(function(E,I){let D=!1,N=-1/0,H=0;for(let ee=0;ee<E.length-1;ee++)E[ee].x>N&&(N=E[ee].x,H=ee);for(let ee=0;ee<E.length-1;ee++){const Y=(H+ee)%(E.length-1),se=E[Y],fe=E[Y+1];Math.abs(se.x-fe.x)>.5&&(se.x<fe.x?(se.x+=1,Y===0&&(E[E.length-1].x+=1)):(fe.x+=1,Y+1===E.length-1&&(E[0].x+=1)),D=!0)}const W=i.aF(I.center.lng);return D&&W<Math.abs(W-1)&&E.forEach((ee=>{ee.x-=1})),{polygon:E,unwrapped:D}})(He(n,c).map((E=>new i.P(mn(E.x),E.y))),c);return{polygon:x.polygon.map((E=>new i.ae(E.x,E.y))),unwrapped:x.unwrapped}}}function He(p,n){return i.aG(p,(c=>{const d=n.pointCoordinate3D(c);c.x=d.x,c.y=d.y}),1/256)}function mn(p){return p<0?1+p%1:p%1}function ca(p){return 100*p|0}function as(p,n,c,d,x){const E=function(D,N){if(D)return x(D);if(N){if(p.url&&N.tiles&&p.tiles&&delete p.tiles,N.variants){if(!Array.isArray(N.variants))return x(new Error("variants must be an array"));for(const W of N.variants){if(W==null||typeof W!="object"||W.constructor!==Object)return x(new Error("variant must be an object"));if(!Array.isArray(W.capabilities))return x(new Error("capabilities must be an array"));if(W.capabilities.length===1&&W.capabilities[0]==="meshopt"){N=Object.assign(N,W);break}}}const H=i.aH(Object.assign({},N,p),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);H.tiles=n.canonicalizeTileset(H,p.url),x(null,H)}},I=(function(D,N,H){if(!D)return null;if(!N&&!H)return D;H=H||D.worldview_default;const W=Object.values(D.language||{});if(W.length===0)return null;const ee=Object.values(D.worldview||{});if(ee.length===0)return null;const Y=W.every((fe=>fe===N)),se=ee.every((fe=>fe===H));return Y&&se?D:N in(D.language_options||{})||H in(D.worldview_options||{})?null:D.language_options&&D.worldview_options?D:null})(p.data,c,d);return I?i.o.frame((()=>E(null,I))):p.url?i.m(n.transformRequest(n.normalizeSourceURL(p.url,null,c,d),i.R.Source),E):i.o.frame((()=>{const{data:D,...N}=p;E(null,N)}))}function Hs(p,n){const c=Math.pow(2,n.z),d=Math.floor(i.aF(p.getWest())*c),x=Math.floor(i.aJ(p.getNorth())*c),E=Math.ceil(i.aF(p.getEast())*c),I=Math.ceil(i.aJ(p.getSouth())*c);return n.x>=d&&n.x<E&&n.y>=x&&n.y<I}class tu{constructor(n,c,d){this.bounds=n?i.aI.convert(this.validateBounds(n)):null,this.minzoom=c||0,this.maxzoom=d||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}addExtraBounds(n){if(n){this.extraBounds||(this.extraBounds=[]);for(const c of n)this.extraBounds.push(i.aI.convert(this.validateBounds(c)))}}contains(n){if(n.z>this.maxzoom||n.z<this.minzoom||this.bounds&&!Hs(this.bounds,n))return!1;if(!this.extraBounds)return!0;for(const c of this.extraBounds)if(Hs(c,n))return!0;return!1}static fromTileJSON(n){if(!n.bounds&&!n.extra_bounds)return null;const c=new tu(n.bounds,n.minzoom,n.maxzoom);return c.addExtraBounds(n.extra_bounds),c}}class ss extends i.E{constructor(n,c,d,x){if(super(),this.id=n,this.dispatcher=d,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,i.aH(c,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},c),this._collectResourceTiming=!!c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new i.aK}load(n){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,d=this.map.getWorldview();this._tileJSONRequest=as(this._options,this.map._requestManager,c,d,((x,E)=>{if(this._tileJSONRequest=null,this._loaded=!0,x)c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),d&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${d}`),this.fire(new i.y(x));else if(E){if(Object.assign(this,E),this.hasWorldviews=!!E.worldview_options,E.worldview_default&&(this.worldviewDefault=E.worldview_default),E.vector_layers){this.vectorLayers=E.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const I of E.vector_layers)this.vectorLayerIds.push(I.id),E.worldview&&E.worldview[I.source]&&this.localizableLayerIds.add(I.id)}this.tileBounds=tu.fromTileJSON(E),Jt(E.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}n&&n(x)}))}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(n)))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(n,c){const d=n.tileID.canonical.url(this.tiles,this.scheme),x=this.map._requestManager.normalizeTileURL(d),E=this.map._requestManager.transformRequest(x,i.R.Tile),I=this.map.style?this.map.style.getLut(this.scope):null,D=I?{image:I.image.clone()}:null,N={request:E,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,lut:D,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&i.h(d)&&(N.localizableLayerIds=this.localizableLayerIds),N.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=c:n.request=n.actor.send("reloadTile",N,H.bind(this));else if(n.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",N,H.bind(this),void 0,!0);else{const W=i.aL.call({deduped:this._deduped},N,((ee,Y)=>{ee||!Y?H.call(this,ee):(N.data={cacheControl:Y.cacheControl,expires:Y.expires,rawData:Y.rawData.slice(0)},n.actor&&n.actor.send("loadTile",N,H.bind(this),void 0,!0))}),!0);n.request={cancel:W}}function H(W,ee){return delete n.request,n.aborted?c(null):W&&W.status!==404?c(W):(ee&&ee.resourceTiming&&(n.resourceTiming=ee.resourceTiming),this.map._refreshExpiredTiles&&ee&&n.setExpiryData(ee),n.loadVectorData(ee,this.map.painter),i.aM(this.dispatcher),c(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,c){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Fe extends i.E{constructor(n,c,d,x){super(),this.id=n,this.dispatcher=d,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},c),Object.assign(this,i.aH(c,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const c=this.map.getWorldview();this._tileJSONRequest=as(this._options,this.map._requestManager,null,c,((d,x)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new i.y(d)):x&&(Object.assign(this,x),x.raster_layers&&(this.rasterLayers=x.raster_layers,this.rasterLayerIds=this.rasterLayers.map((E=>E.id))),this.tileBounds=tu.fromTileJSON(x),Jt(x.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),n&&n(d)}))}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(n)))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,c){const d=i.o.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),d,this.tileSize);n.request=i.n(this.map._requestManager.transformRequest(x,i.R.Tile),((E,I,D,N)=>(delete n.request,n.aborted?(n.state="unloaded",c(null)):E?(n.state="errored",c(E)):I?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:D,expires:N}),n.setTexture(I,this.map.painter),n.state="loaded",i.aM(this.dispatcher),void c(null)):c(null))))}abortTile(n,c){n.request&&(n.request.cancel(),delete n.request),c&&c()}unloadTile(n,c){n.texture&&n.texture instanceof i.T?(n.destroy(!0),n.texture&&n.texture instanceof i.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),c&&c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Qp([p,n],c,d,{scaled:x=!0}={}){const{tileSize:E,buffer:I}=d,{x:D,y:N,z:H}=c;if(!isFinite(D)||!isFinite(N)||!isFinite(H))throw new Error("Invalid MRT header");const W=2**H,ee=W*i.aF(p),Y=W*i.aJ(n);return(function([se,fe],he,{scaled:Se=!0}={}){if(!he)throw new Error("bandView is undefined");const{data:me,tileSize:Te,buffer:Oe,offset:Le,scale:Ge,dimension:Ue}=he;if(se<-Oe||se>Te+Oe||fe<-Oe||fe>Te+Oe)throw new Error(`Point (${se}, ${fe}) out of bounds for tileSize=${Te}, buffer=${Oe}`);const Ze=(fe+Oe)*(Te+2*Oe)+(se+Oe);if(new Uint32Array(me.buffer)[Ze]===4294967295)return null;let $e=[];$e=Se?[]:new he.data.constructor(Ue);for(let Ve=0;Ve<Ue;Ve++)$e[Ve]=Math.round(1e12*(me[Ue*Ze+Ve]*Ge+Le))/1e12;return $e})([Math.min(Math.max(-I,Math.floor((ee-D)*E)),E-1+I),Math.min(Math.max(-I,Math.floor((Y-N)*E)),E-1+I)],d,{scaled:x})}class Yu extends Fe{constructor(n,c,d,x){super(n,c,d,x),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},c)}triggerRepaint(n){const c=this.map.painter._terrain,d=this.map.style.getSourceCache(this.id);c&&c.enabled&&d&&c._clearRenderCacheForTile(d.id,n.tileID),this.map.triggerRepaint()}loadTile(n,c){const d=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(d,i.R.Tile),E={request:x,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};n.source=this.id,n.scope=this.scope,n.requestParams=x,n.actor||(n.actor=this.dispatcher.getActor());const I=(D,N,H,W)=>{if(delete n.request,n.aborted)return n.state="unloaded",c(null);if(D)return D.name==="AbortError"?void 0:(n.state="errored",c(D));if(this.map._refreshExpiredTiles&&N&&n.setExpiryData({cacheControl:H,expires:W}),this.partial&&n.state!=="expired")n.state="empty";else if(!this.partial){if(!N)return c(null);n.state="loaded",n._isHeaderLoaded=!0,n._mrt=N}c(null)};n.request=this.partial?n.fetchHeader(void 0,I.bind(this)):n.actor.send("loadTile",E,I.bind(this),void 0,!0)}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,c){const d=n.texturePerLayer;if(n.flushAllQueues(),d.size){n.destroy(!0);for(const x of d.values())this.map.painter.saveTileTexture(x)}else n.destroy()}prepareTile(n,c,d,x){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBandForRender(c,d,x,((E,I)=>{if(E)return n.state="errored",this.fire(new i.y(E)),void this.triggerRepaint(n);I&&(n._isHeaderLoaded=!0,n.setTexturePerLayer(d,I,this.map.painter),n.state="loaded",this.triggerRepaint(n))})))}getInitialBand(n){if(!this.rasterLayers)return 0;const c=this.rasterLayers.find((({id:E})=>E===n)),d=c&&c.fields,x=d&&d.bands&&d.bands;return x?x[0]:0}getTextureDescriptor(n,c,d){if(!n)return;const x=c.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!x)return;let E=null;c instanceof i.aP?E=c.paint.get("raster-array-band"):c instanceof i.aQ&&(E=c.paint.get("raster-particle-array-band"));const I=E||this.getInitialBand(x);if(I==null)return;if(!n.textureDescriptorPerLayer.get(c.id))return void this.prepareTile(n,x,c.id,I);if(n.updateNeeded(c.id,I)&&!d)return;const D=n.textureDescriptorPerLayer.get(c.id);return Object.assign({},D,{texture:n.texturePerLayer.get(c.id)})}getImages(n,c){const d=new Map;for(const x of n)for(const E of c){const[I,D]=E.split("/"),N=x.getLayer(I);if(!N||!N.hasBand(D)||!N.hasDataForBand(D))continue;const{bytes:H,tileSize:W,buffer:ee}=N.getBandView(D),Y=W+2*ee,se={data:new i.q({width:Y,height:Y},H),pixelRatio:2,sdf:!1,usvg:!1,version:0};d.set(E,se)}return d}queryRasterArrayValueByBandId(n,c,d){const x=c._mrt;return new Promise((E=>{const I={},D=new Set;for(const[N,H]of Object.entries(x.layers)){if(d.layerName&&N!==d.layerName)continue;const W={};I[N]=W;for(const{bands:ee}of H.dataIndex)for(const Y of ee)d.bands&&!d.bands.includes(Y)||(D.add(i.B(N,Y)),c.fetchBand(N,null,Y,(se=>{i.o.frame((()=>{W[Y]=se?null:Qp([n.lng,n.lat],x,H.getBandView(Y)),D.delete(i.B(N,Y)),D.size===0&&E(I)}))}),!1))}D.size===0&&E(I)}))}_loadTileForQuery(n,c){if(this._loadTileLoaded[n.uid])return void c(null,n._mrt);if(this._loadTilePending[n.uid])return void this._loadTilePending[n.uid].push(c);this._loadTilePending[n.uid]=[c];const d=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),x=this.map._requestManager.transformRequest(d,i.R.Tile);n.actor.send("loadTile",{request:x,uid:n.uid,tileID:n.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},((E,I,D,N)=>E?(this._loadTilePending[n.uid].forEach((H=>H(E,null))),void delete this._loadTilePending[n.uid]):I?(this.map._refreshExpiredTiles&&I&&n.setExpiryData({cacheControl:D,expires:N}),n._mrt=I,n._isHeaderLoaded=!0,n.state="loaded",this._loadTilePending[n.uid].forEach((H=>H(null,I))),this._loadTileLoaded[n.uid]=!0,void delete this._loadTilePending[n.uid]):(this._loadTilePending[n.uid].forEach((H=>H(null,null))),void delete this._loadTilePending[n.uid])),void 0,!0)}queryRasterArrayValueByAllBands(n,c,d){return new Promise(((x,E)=>{this._loadTileForQuery(c,((I,D)=>{I?E(I):x(D?this.queryRasterArrayValueByBandId(n,c,d):null)}))}))}queryRasterArrayValue(n,c){const d=i.aR.convert(n),x=this.findLoadedParent(d);return x&&x._mrt?c.bands||!this.partial?this.queryRasterArrayValueByBandId(d,x,c):this.queryRasterArrayValueByAllBands(d,x,c):Promise.resolve(null)}findLoadedParent(n){const c=i.ae.fromLngLat(n,this.map.transform.tileSize),d=this.maxzoom+1,x=1<<d,E=Math.floor(c.x),I=Math.floor((c.x-E)*x),D=Math.floor(c.y*x),N=this.map.style.getSourceCache(this.id),H=new i.aO(d,E,d,I,D);return N.findLoadedParent(H,this.minzoom)}}const ru={vector:ss,raster:Fe,"raster-dem":class extends Fe{constructor(p,n,c,d){super(p,n,c,d),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(p,n){const c=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function d(x,E){x&&(p.state="errored",n(x)),E&&(p.dem=E,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",n(null))}p.request=i.n(this.map._requestManager.transformRequest(c,i.R.Tile),(function(x,E,I,D){if(delete p.request,p.aborted)p.state="unloaded",n(null);else if(x)p.state="errored",n(x);else if(E){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:I,expires:D});const N=ImageBitmap&&E instanceof ImageBitmap&&i.r(),H=1-(E.width-i.aN(E.width))/2;H<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const W=N?E:i.o.getImageData(E,H),ee={uid:p.uid,tileID:p.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:W,encoding:this.encoding,padding:H};p.actor&&p.state!=="expired"||(p.actor=this.dispatcher.getActor(),p.actor.send("loadTile",ee,d.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(p){const n=p.canonical,c=Math.pow(2,n.z),d=(n.x-1+c)%c,x=n.x===0?p.wrap-1:p.wrap,E=(n.x+1+c)%c,I=n.x+1===c?p.wrap+1:p.wrap,D={};return D[new i.aO(p.overscaledZ,x,n.z,d,n.y).key]={backfilled:!1},D[new i.aO(p.overscaledZ,I,n.z,E,n.y).key]={backfilled:!1},n.y>0&&(D[new i.aO(p.overscaledZ,x,n.z,d,n.y-1).key]={backfilled:!1},D[new i.aO(p.overscaledZ,p.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},D[new i.aO(p.overscaledZ,I,n.z,E,n.y-1).key]={backfilled:!1}),n.y+1<c&&(D[new i.aO(p.overscaledZ,x,n.z,d,n.y+1).key]={backfilled:!1},D[new i.aO(p.overscaledZ,p.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},D[new i.aO(p.overscaledZ,I,n.z,E,n.y+1).key]={backfilled:!1}),D}},"raster-array":Yu,geojson:class extends i.E{constructor(p,n,c,d){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(d),this._data=n.data,this._options=Object.assign({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const x=i.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*x,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*x,extent:i.al,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:i.al,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*x,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}updateData(p){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof p!="string"&&(p.type==="Feature"&&(p={type:"FeatureCollection",features:[p]}),p.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof p!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const c of this._data.features)n.set(c.id,c);for(const c of p.features)n.set(c.id,c);this._data.features=[...n.values()]}else this._data=p;return this._updateWorkerData(!0),this}getClusterExpansionZoom(p,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterChildren(p,n){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id,scope:this.scope},n),this}getClusterLeaves(p,n,c,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:p,limit:n,offset:c},d),this}_updateWorkerData(p=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const n=Object.assign({append:p},this.workerOptions);n.scope=this.scope;const c=this._data;typeof c=="string"?(n.request=this.map._requestManager.transformRequest(i.o.resolveURL(c),i.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,((d,x)=>{if(this._loaded=!0,this._pendingLoad=null,d)this.fire(new i.y(d));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(E.resourceTiming=x.resourceTiming[this.id]),p&&(this._partialReload=!0),this.fire(new i.z("data",E)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(p),this._coalesce=!1)}))}loaded(){return this._loaded}reload(){const p=i.B(this.id,this.scope);this.map.style.clearSource(p),this._updateWorkerData()}loadTile(p,n){const c=p.actor?"reloadTile":"loadTile";p.actor=this.actor;const d=this.map.style?this.map.style.getLut(this.scope):null,x=d?{image:d.image.clone()}:null,E=this._partialReload,I={type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:x,scope:this.scope,pixelRatio:i.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:p.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:E,worldview:this.map.getWorldview()};p.request=this.actor.send(c,I,((D,N)=>E&&!N?(p.state="loaded",n(null)):(delete p.request,p.destroy(),p.aborted?n(null):D?n(D):(p.loadVectorData(N,this.map.painter,c==="reloadTile"),n(null)))),void 0,c==="loadTile")}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p,n){this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id,scope:this.scope}),p.destroy()}onRemove(p){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aS{constructor(p,n,c,d){super(p,n,c,d),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const n of p.urls)this.urls.push(this.map._requestManager.transformRequest(n,i.R.Source).url);i.aT(this.urls,((n,c)=>{this._loaded=!0,n?this.fire(new i.y(n)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const n=this.video.seekable;p<n.start(0)||p>n.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const p=this.map.painter.context,n=p.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(p,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aS,model:class extends i.E{constructor(p,n,c,d){super(),this.id=p,this.type="model",this.models=[],this._loaded=!1,this._options=n}load(){const p=[];for(const n in this._options.models){const c=this._options.models[n],d=i.aV(this.map._requestManager.transformRequest(c.uri,i.R.Model).url).then((x=>{if(!x)return;const E=i.aW(x),I=new i.aX(n,c.position,c.orientation,E);I.computeBoundsAndApplyParent(),this.models.push(I)})).catch((x=>{this.fire(new i.y(new Error(`Could not load model ${n} from ${c.uri}: ${x.message}`)))}));p.push(d)}Promise.allSettled(p).then((()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((n=>{this._loaded=!0,this.fire(new i.y(new Error(`Could not load models: ${n.message}`)))}))}onAdd(p){this.map=p,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(p,n){}serialize(){return this._options}},"batched-model":class extends i.E{constructor(p,n,c,d){super(),this.type="batched-model",this.id=p,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=c,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(d)}onAdd(p){this.map=p,this.load()}reload(){this.cancelTileJSONRequest();const p=i.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(p)))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(p){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map.getWorldview();this._tileJSONRequest=as(this._options,this.map._requestManager,n,c,((d,x)=>{this._tileJSONRequest=null,this._loaded=!0,d?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new i.y(d))):x&&(Object.assign(this,x),x.bounds&&(this.tileBounds=new tu(x.bounds,this.minzoom,this.maxzoom)),Jt(x.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),p&&p(d)}))}hasTransition(){return!1}hasTile(p){return!this.tileBounds||this.tileBounds.contains(p.canonical)}loaded(){return this._loaded}loadTile(p,n){const c=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme)),d={request:this.map._requestManager.transformRequest(c,i.R.Tile),data:void 0,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,tileSize:this.tileSize*p.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:p.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:i.o.devicePixelRatio,promoteId:this.promoteId};if(p.actor&&p.state!=="expired")if(p.state==="loading")p.reloadCallback=n;else{if(p.buckets){const E=Object.values(p.buckets);for(const I of E)I.dirty=!0;return void(p.state="loaded")}p.request=p.actor.send("reloadTile",d,x.bind(this))}else p.actor=this.dispatcher.getActor(),p.request=p.actor.send("loadTile",d,x.bind(this),void 0,!0);function x(E,I){return p.aborted?n(null):E&&E.status!==404?n(E):(this.map._refreshExpiredTiles&&I&&p.setExpiryData(I),p.loadModelData(I,this.map.painter),p.state="loaded",void n(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends i.aS{constructor(p,n,c,d){super(p,n,c,d),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some((x=>!Array.isArray(x)||x.length!==2||x.some((E=>typeof E!="number"))))||this.fire(new i.y(new i.V(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${p}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(p){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!p&&!this._playing||this.texture instanceof i.aU||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends i.E{constructor(p,n,c,d){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=n,this.setEventedParent(d),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new tu(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,i.aH(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this.map=p,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:n,y:c,z:d}=p.canonical;return this._implementation.hasTile({x:n,y:c,z:d})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,n){const{x:c,y:d,z:x}=p.tileID.canonical,E=new AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:c,y:d,z:x},{signal:E.signal})).then((function(I){return delete p.request,p.aborted?(p.state="unloaded",n(null)):I===void 0?(p.state="errored",n(null)):I===null?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",n(null)):(function(D){return D instanceof ImageData||D instanceof HTMLCanvasElement||D instanceof ImageBitmap||D instanceof HTMLImageElement})(I)?(this.loadTileData(p,I),p.state="loaded",void n(null)):(p.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((I=>{I.name!=="AbortError"&&(p.state="errored",n(I))})),p.request.cancel=()=>E.abort()}loadTileData(p,n){p.setTexture(n,this.map.painter)}unloadTile(p,n){if(p.texture&&p.texture instanceof i.T?(p.destroy(!0),p.texture&&p.texture instanceof i.T&&this.map.painter.saveTileTexture(p.texture)):p.destroy(),this._implementation.unloadTile){const{x:c,y:d,z:x}=p.tileID.canonical;this._implementation.unloadTile({x:c,y:d,z:x})}n&&n()}abortTile(p,n){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z})))}_clearTiles(){const p=i.B(this.id,this.scope);this.map.style.clearSource(p)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},Rf=function(p,n,c,d){const x=new ru[n.type](p,n,c,d);if(x.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${x.id}`);return i.aY(["load","abort","unload","serialize","prepare"],x),x};function Qu(p,n,c=""){return`${c}:${n.id||""}:${n.layer.id}:${(function(d){if("layerId"in d)return`layer:${d.layerId}`;{const{featuresetId:x,importId:E}=d;return`featureset:${x}${E?`:import:${E}`:""}`}})(p.target)}`}function Ku(p,n,c,d=""){if(p.uniqueFeatureID){const x=Qu(p,n,d);if(c.has(x))return!0;c.add(x)}return!1}function As(p,n,c,d,x=!1){const E=n.sourceCache.transform,I=n.sourceCache.tilesIn(p,n.has3DLayers,x);I.sort(sl);const D=[];for(const N of I){const H=N.tile.queryRenderedFeatures(n,N,c,d,E,x);Object.keys(H).length&&D.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:H})}return D.length===0?{}:(function(N){const H={},W={};for(const ee of N){const Y=ee.queryResults,se=ee.wrappedTileID,fe=W[se]=W[se]||{};for(const he in Y){const Se=Y[he],me=fe[he]=fe[he]||{},Te=H[he]=H[he]||[];for(const Oe of Se)me[Oe.featureIndex]||(me[Oe.featureIndex]=!0,Te.push(Oe))}}return H})(D)}function Df(p,n,c,d,x,E){const I={},D=d.queryRenderedSymbols(p),N=[];for(const H of Object.keys(D).map(Number))N.push(x[H]);N.sort(sl);for(const H of N){const W=H.featureIndex.lookupSymbolFeatures(D[H.bucketInstanceId],H.bucketIndex,H.sourceLayerIndex,n,c,E);for(const ee in W){const Y=I[ee]=I[ee]||[],se=W[ee];se.sort(((fe,he)=>{const Se=H.featureSortOrder;if(Se){const me=Se.indexOf(fe.featureIndex);return Se.indexOf(he.featureIndex)-me}return he.featureIndex-fe.featureIndex}));for(const fe of se)Y.push(fe)}}return I}function Vl(p,n){const c=p.getRenderableIds().map((E=>p.getTileByID(E))),d=[],x={};for(let E=0;E<c.length;E++){const I=c[E],D=I.tileID.canonical.key;x[D]||(x[D]=!0,I.querySourceFeatures(d,n))}return d}function sl(p,n){const c=p.tileID,d=n.tileID;return c.overscaledZ-d.overscaledZ||c.canonical.y-d.canonical.y||c.wrap-d.wrap||c.canonical.x-d.canonical.x}function oa(p,n){const c={};if(!n)return c;for(const d of p){const x=d.layerIds.map((E=>n.getLayer(E))).filter(Boolean);if(x.length!==0){d.layers=x,d.stateDependentLayerIds&&(d.stateDependentLayers=d.stateDependentLayerIds.map((E=>x.filter((I=>I.id===E))[0])));for(const E of x)c[E.fqid]=d}}return c}const ll=32,vl=33,cl=new Uint16Array(8184);for(let p=0;p<2046;p++){let n=p+2,c=0,d=0,x=0,E=0,I=0,D=0;for(1&n?x=E=I=ll:c=d=D=ll;(n>>=1)>1;){const H=c+x>>1,W=d+E>>1;1&n?(x=c,E=d,c=I,d=D):(c=x,d=E,x=I,E=D),I=H,D=W}const N=4*p;cl[N+0]=c,cl[N+1]=d,cl[N+2]=x,cl[N+3]=E}const xl=new Uint16Array(2178),gs=new Uint8Array(1089),nu=new Uint16Array(1089);function fd(p){return p===0?-.03125:p===32?.03125:0}const dd={type:2,extent:i.al,loadGeometry:()=>[[new i.P(0,0),new i.P(i.al+1,0),new i.P(i.al+1,i.al+1),new i.P(0,i.al+1),new i.P(0,0)]]};class Ju{constructor(n,c,d,x,E,I){this.tileID=n,this.uid=i.b2(),this.uses=0,this.tileSize=c,this.tileZoom=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=E,x&&x.style&&(this._lastUpdatedBrightness=x.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",x&&x.transform&&(this.projection=x.transform.projection),this.worldview=I}registerFadeDuration(n){const c=n+this.timeAdded;c<i.o.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aZ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,c,d){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=oa(n.buckets,c.style),this.hasSymbolBuckets=!1;for(const x in this.buckets){const E=this.buckets[x];if(E instanceof i.b4){if(this.hasSymbolBuckets=!0,!d)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const x in this.buckets){const E=this.buckets[x];if(E instanceof i.b4&&E.hasRTLText){this.hasRTLText=!0,i.b5();break}}this.queryPadding=0;for(const x in this.buckets){const E=this.buckets[x],I=c.style.getOwnLayer(x);if(!I)continue;const D=I.queryRadius(E);this.queryPadding=Math.max(this.queryPadding,D)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new i.b3}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(n,c,d){n&&(n.resourceTiming&&(this.resourceTiming=n.resourceTiming),this.buckets=Object.assign({},this.buckets,oa(n.buckets,c.style)),n.featureIndex&&(this.latestFeatureIndex=n.featureIndex))}getBucket(n){return this.buckets[n.fqid]}upload(n){for(const x in this.buckets){const E=this.buckets[x];E.uploadPending()&&E.upload(n)}const c=n.gl,d=this.imageAtlas;d&&!d.uploaded&&(this.imageAtlasTexture=new i.T(n,d.image,c.RGBA8,{useMipmap:!!d.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(n,this.glyphAtlasImage,c.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(n,this.lineAtlas.image,c.R8),this.lineAtlas.uploaded=!0)}prepare(n,c,d){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,d),!c||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const x=c.style.getBrightness();(this._lastUpdatedBrightness||x)&&(this._lastUpdatedBrightness&&x&&Math.abs(this._lastUpdatedBrightness-x)<.001||(this.updateBuckets(c,this._lastUpdatedBrightness!==x),this._lastUpdatedBrightness=x))}queryRenderedFeatures(n,c,d,x,E,I){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const D=(function(N,H){const W=i.bq([],[.5*N.width,.5*-N.height,1]);return i.br(W,W,[1,-1,0]),i.aB(W,W,N.calculateProjMatrix(H.toUnwrapped())),Float32Array.from(W)})(E,this.tileID);return this.latestFeatureIndex.query(n,{tilespaceGeometry:c,pixelPosMatrix:D,transform:x,availableImages:d,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(n,c){const d=this.latestFeatureIndex;if(!d||!d.rawTileData)return;const x=d.loadVTLayers(),E=c?c.sourceLayer:"",I=x._geojsonTileLayer||x[E];if(!I)return;const D=i.b6(c&&c.filter),{z:N,x:H,y:W}=this.tileID.canonical,ee={z:N,x:H,y:W};for(let Y=0;Y<I.length;Y++){const se=I.feature(Y);if(D.needGeometry){const Se=i.b7(se,!0);if(!D.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),Se,this.tileID.canonical))continue}else if(!D.filter(new i.ac(this.tileID.overscaledZ,{worldview:this.worldview}),se))continue;const fe=d.getId(se,E),he=new i.b8(se,N,H,W,fe);he.tile=ee,n.push(he)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(n){const c=this.expirationTime;if(n.cacheControl){const d=i.b9(n.cacheControl);d["max-age"]&&(this.expirationTime=Date.now()+1e3*d["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const d=Date.now();let x=!1;if(this.expirationTime>d)x=!1;else if(c)if(this.expirationTime<c)x=!0;else{const E=this.expirationTime-c;E?this.expirationTime=d+Math.max(E,3e4):x=!0}else x=!0;x?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(n){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&n&&this.updateBuckets(n)}updateBuckets(n,c){if(!this.latestFeatureIndex||!n.style)return;const d=this.latestFeatureIndex.loadVTLayers(),x=n.style.listImages(),E=n.style.getBrightness();for(const I in this.buckets){if(!n.style.hasLayer(I))continue;const D=this.buckets[I],N=D.layers[0],H=N.sourceLayer||"_geojsonTileLayer",W=d[H],ee=n.style.getLayerSourceCache(N);let Y={};ee&&(Y=ee._state.getState(H,void 0));const se=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},fe=Object.keys(Y).length>0&&!c;(fe&&D.stateDependentLayers.length!==0||c)&&D.update(Y,W,x,se,fe?D.stateDependentLayers:D.layers,c,E),(D instanceof i.ba||D instanceof i.bb)&&n._terrain&&n._terrain.enabled&&ee&&D.uploadPending()&&n._terrain._clearRenderCacheForTile(ee.id,this.tileID);const he=n&&n.style&&n.style.getOwnLayer(I);he&&(this.queryPadding=Math.max(this.queryPadding,he.queryRadius(D)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=i.o.now()+n}setTexture(n,c){const d=c.context,x=d.gl;this.texture=this.texture||c.getTileTexture(n.width),this.texture&&this.texture instanceof i.T?this.texture.update(n):(this.texture=new i.T(d,n,x.RGBA8,{useMipmap:!0}),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE))}setDependencies(n,c){const d={};for(const x of c)d[x]=!0;this.dependencies[n]=d}hasDependency(n,c){for(const d of n){const x=this.dependencies[d];if(x){for(const E of c)if(x[E])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const d=i.bc(dd,this.tileID.canonical,this.tileTransform)[0],x=new i.bd,E=new i.be;for(let I=0;I<d.length;I++){const{x:D,y:N}=d[I];x.emplaceBack(D,N),E.emplaceBack(I)}E.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(E),this._tileDebugBuffer=n.createVertexBuffer(x,i.bf.members),this._tileDebugSegments=i.bg.simpleSegment(0,0,x.length,E.length)}_makeTileBoundsBuffers(n,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const d=i.bc(dd,this.tileID.canonical,this.tileTransform)[0];let x,E;if(this.isRaster){const I=(function(D,N){const H=i.aZ(D,N),W=Math.pow(2,D.z);for(let Se=0;Se<vl;Se++)for(let me=0;me<vl;me++){const Te=i.a_((D.x+(me+fd(me))/ll)/W),Oe=i.a$((D.y+(Se+fd(Se))/ll)/W),Le=N.project(Te,Oe),Ge=Se*vl+me;xl[2*Ge+0]=Math.round((Le.x*H.scale-H.x)*i.al),xl[2*Ge+1]=Math.round((Le.y*H.scale-H.y)*i.al)}gs.fill(0),nu.fill(0);for(let Se=2045;Se>=0;Se--){const me=4*Se,Te=cl[me+0],Oe=cl[me+1],Le=cl[me+2],Ge=cl[me+3],Ue=Te+Le>>1,Ze=Oe+Ge>>1,$e=Ue+Ze-Oe,Ve=Ze+Te-Ue,We=Oe*vl+Te,yt=Ge*vl+Le,lt=Ze*vl+Ue,Ot=Math.hypot((xl[2*We+0]+xl[2*yt+0])/2-xl[2*lt+0],(xl[2*We+1]+xl[2*yt+1])/2-xl[2*lt+1])>=16;gs[lt]=gs[lt]||(Ot?1:0),Se<1022&&(gs[lt]=gs[lt]||gs[(Oe+Ve>>1)*vl+(Te+$e>>1)]||gs[(Ge+Ve>>1)*vl+(Le+$e>>1)])}const ee=new i.b0,Y=new i.b1;let se=0;function fe(Se,me){const Te=me*vl+Se;return nu[Te]===0&&(ee.emplaceBack(xl[2*Te+0],xl[2*Te+1],Se*i.al/ll,me*i.al/ll),nu[Te]=++se),nu[Te]-1}function he(Se,me,Te,Oe,Le,Ge){const Ue=Se+Te>>1,Ze=me+Oe>>1;if(Math.abs(Se-Le)+Math.abs(me-Ge)>1&&gs[Ze*vl+Ue])he(Le,Ge,Se,me,Ue,Ze),he(Te,Oe,Le,Ge,Ue,Ze);else{const $e=fe(Se,me),Ve=fe(Te,Oe),We=fe(Le,Ge);Y.emplaceBack($e,Ve,We)}}return he(0,0,ll,ll,ll,0),he(ll,ll,0,0,0,ll),{vertices:ee,indices:Y}})(this.tileID.canonical,c);x=I.vertices,E=I.indices}else{x=new i.b0,E=new i.b1;for(const{x:D,y:N}of d)x.emplaceBack(D,N,0,0);const I=i.bh(x.int16.subarray(0,4*x.length),void 0,4);for(let D=0;D<I.length;D+=3)E.emplaceBack(I[D],I[D+1],I[D+2])}this._tileBoundsBuffer=n.createVertexBuffer(x,i.bi.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(E),this._tileBoundsSegments=i.bg.simpleSegment(0,0,x.length,E.length)}_makeGlobeTileDebugBuffers(n,c){const d=c.projection;if(!d||d.name!=="globe"||c.freezeTileCoverage)return;const x=this.tileID.canonical,E=i.bj(x,c),I=i.bk(E),D=i.aj(c.zoom);let N;D>0&&(N=i.bl(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,x,c,I,N,D),this._makeGlobeTileDebugTextBuffer(n,x,c,I,N,D)}_globePoint(n,c,d,x,E,I,D){let N=i.bm(n,c,d);if(I){const H=1<<d.z,W=i.aF(x.center.lng),ee=i.aJ(x.center.lat),Y=(d.x+.5)/H-W;let se=0;Y>.5?se=-1:Y<-.5&&(se=1);let fe=(n/i.al+d.x)/H+se,he=(c/i.al+d.y)/H;fe=(fe-W)*x._pixelsPerMercatorPixel+W,he=(he-ee)*x._pixelsPerMercatorPixel+ee;const Se=[fe*x.worldSize,he*x.worldSize,0];i.af(Se,Se,I),N=i.bn(N,Se,D)}return i.af(N,N,E)}_makeGlobeTileDebugBorderBuffer(n,c,d,x,E,I){const D=new i.bd,N=new i.be,H=new i.bo,W=(Y,se,fe,he,Se)=>{const me=(fe-Y)/(Se-1),Te=(he-se)/(Se-1),Oe=D.length;for(let Le=0;Le<Se;Le++){const Ge=Y+Le*me,Ue=se+Le*Te;D.emplaceBack(Ge,Ue);const Ze=this._globePoint(Ge,Ue,c,d,x,E,I);H.emplaceBack(Ze[0],Ze[1],Ze[2]),N.emplaceBack(Oe+Le)}},ee=i.al;W(0,0,ee,0,16),W(ee,0,ee,ee,16),W(ee,ee,0,ee,16),W(0,ee,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(N),this._tileDebugBuffer=n.createVertexBuffer(D,i.bf.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(H,i.bp.members),this._tileDebugSegments=i.bg.simpleSegment(0,0,D.length,N.length)}_makeGlobeTileDebugTextBuffer(n,c,d,x,E,I){const D=i.al/4,N=new i.bd,H=new i.b1,W=new i.bo,ee=25;H.reserve(32),N.reserve(ee),W.reserve(ee);const Y=(se,fe)=>ee*se+fe;for(let se=0;se<ee;se++){const fe=se*D;for(let he=0;he<ee;he++){const Se=he*D;N.emplaceBack(Se,fe);const me=this._globePoint(Se,fe,c,d,x,E,I);W.emplaceBack(me[0],me[1],me[2])}}for(let se=0;se<4;se++)for(let fe=0;fe<4;fe++){const he=Y(se,fe),Se=Y(se,fe+1),me=Y(se+1,fe),Te=Y(se+1,fe+1);H.emplaceBack(he,Se,me),H.emplaceBack(me,Se,Te)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(H),this._tileDebugTextBuffer=n.createVertexBuffer(N,i.bf.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(W,i.bp.members),this._tileDebugTextSegments=i.bg.simpleSegment(0,0,ee,32)}destroy(n=!1){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!n&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bs.setPbf(i.bt);class Fo extends Ju{constructor(n,c,d,x,E){super(n,c,d,x,E),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(n){return this._mrt&&this._mrt.getLayer(n)}setTexturePerLayer(n,c,d){const x=d.context,E=x.gl;let I=this.texturePerLayer.get(n)||d.getTileTexture(c.width);I&&I instanceof i.T?I.update(c,{premultiply:!1}):I=new i.T(x,c,E.RGBA8,{premultiply:!1}),this.texturePerLayer.has(n)||this.texturePerLayer.set(n,I)}flushQueues(n){const c=this._workQueuePerLayer.get(n)||[],d=this._fetchQueuePerLayer.get(n)||[];for(;c.length;)c.pop()();for(;d.length;)d.pop()()}flushAllQueues(){for(const n of this._workQueuePerLayer.keys()){const c=this._workQueuePerLayer.get(n)||[];for(;c.length;)c.pop()()}for(const n of this._fetchQueuePerLayer.keys()){const c=this._fetchQueuePerLayer.get(n)||[];for(;c.length;)c.pop()()}}fetchHeader(n=16384,c){const d=this._mrt=new i.bs(30),x=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=i.bu(x,((E,I,D,N)=>{if(E)c(E);else try{const H=d.getHeaderLength(I);if(H>n)return void(this.request=this.fetchHeader(H,c));d.parseHeader(I),this._isHeaderLoaded=!0;let W=0;for(const ee of Object.values(d.layers))W=Math.max(W,ee.dataIndex[ee.dataIndex.length-1].lastByte);I.byteLength>=W&&(this.entireBuffer=I),c(null,this.entireBuffer||I,D,N)}catch(H){c(H)}})),this.request}fetchBandForRender(n,c,d,x){this.fetchBand(n,c,d,(E=>{if(E)return void x(E);this.updateTextureDescriptor(n,c,d);const I=this.textureDescriptorPerLayer.get(c);x(null,I?I.img:null)}))}fetchBand(n,c,d,x,E=!0){const I=this._mrt;if(!this._isHeaderLoaded||!I)return void x(new Error("Tile header is not ready"));const D=this.actor;if(!D)return void x(new Error("Can't fetch tile band without an actor"));let N;const H=i.B(String(d),i.B(this.tileID.key,n));let W=this._taskQueue.get(H);W?W.add(x):(W=new Set,W.add(x),this._taskQueue.set(H,W));const ee=(he,Se)=>{N.complete(he,Se),he?x(he):(W.values().forEach((me=>me(null,Se))),this._taskQueue.delete(H))},Y=(he,Se)=>{if(he)return x(he);const me=D.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:Se,task:N},ee,void 0,!0);if(c!==null){const Te=this._workQueuePerLayer.get(c)||[];Te.push((()=>{me&&me.cancel(),N.cancel()})),this._workQueuePerLayer.has(c)||this._workQueuePerLayer.set(c,Te)}};let se;try{se=I.getLayer(n)}catch(he){if(this.state==="reloading")return;throw he}if(!se)return void x(new Error(`Unknown sourceLayer "${n}"`));if(se.hasDataForBand(d))return W.values().forEach((he=>he(null,null))),void this._taskQueue.delete(H);const fe=se.getDataRange([d]);if(N=I.createDecodingTask(fe),!N||N.tasks.length)if(c!==null&&this.flushQueues(c),this.entireBuffer)Y(null,this.entireBuffer.slice(fe.firstByte,fe.lastByte+1));else{const he=Object.assign({},this.requestParams,{headers:{Range:`bytes=${fe.firstByte}-${fe.lastByte}`}}),Se=i.bu(he,Y);if(c!==null){const me=this._fetchQueuePerLayer.get(c)||[];me.push((()=>{Se.cancel(),N.cancel()})),this._fetchQueuePerLayer.has(c)||this._fetchQueuePerLayer.set(c,me)}}}updateNeeded(n,c){return(!this.textureDescriptorPerLayer.get(n)||this.textureDescriptorPerLayer.get(n).band!==c||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(n,c,d){if(!this._mrt)return;const x=this._mrt.getLayer(n);if(!x||!x.hasBand(d)||!x.hasDataForBand(d))return;const{bytes:E,tileSize:I,buffer:D,offset:N,scale:H}=x.getBandView(d),W=I+2*D,ee=new i.q({width:W,height:W},E),Y=this.texturePerLayer.get(c);Y&&Y instanceof i.T&&Y.update(ee,{premultiply:!1}),this.textureDescriptorPerLayer.set(c,{layer:n,band:d,img:ee,buffer:D,offset:N,tileSize:I,format:x.pixelFormat,mix:[H,256*H,65536*H,16777216*H]})}destroy(n=!1){if(super.destroy(n),delete this._mrt,!n)for(const c of this.texturePerLayer.values())c&&c instanceof i.T&&c.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class iu{constructor(n,c){this.max=n,this.onRemove=c,this.reset()}reset(){for(const n in this.data)for(const c of this.data[n])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(n,c,d){const x=n.wrapped().key;this.data[x]===void 0&&(this.data[x]=[]);const E={value:c,timeout:void 0};if(d!==void 0&&(E.timeout=setTimeout((()=>{this.remove(n,E)}),d)),this.data[x].push(E),this.order.push(x),this.order.length>this.max){const I=this._getAndRemoveByKey(this.order[0]);I&&this.onRemove(I)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const c=this.data[n].shift();return c.timeout&&clearTimeout(c.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),c.value}getByKey(n){const c=this.data[n];return c?c[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,c){if(!this.has(n))return this;const d=n.wrapped().key,x=c===void 0?0:this.data[d].indexOf(c),E=this.data[d][x];return this.data[d].splice(x,1),E.timeout&&clearTimeout(E.timeout),this.data[d].length===0&&delete this.data[d],this.onRemove(E.value),this.order.splice(this.order.indexOf(d),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(n){const c=[];for(const d in this.data)for(const x of this.data[d])n(x.value)||c.push(x);for(const d of c)this.remove(d.value.tileID,d)}}class ou{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,c,d){const x=String(c);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][x]=this.stateChanges[n][x]||{},Object.assign(this.stateChanges[n][x],d),this.deletedStates[n]===null){this.deletedStates[n]={};for(const E in this.state[n])E!==x&&(this.deletedStates[n][E]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][x]===null){this.deletedStates[n][x]={};for(const E in this.state[n][x])d[E]||(this.deletedStates[n][x][E]=null)}else for(const E in d)this.deletedStates[n]&&this.deletedStates[n][x]&&this.deletedStates[n][x][E]===null&&delete this.deletedStates[n][x][E]}removeFeatureState(n,c,d){if(this.deletedStates[n]===null)return;const x=String(c);if(this.deletedStates[n]=this.deletedStates[n]||{},d&&c!==void 0)this.deletedStates[n][x]!==null&&(this.deletedStates[n][x]=this.deletedStates[n][x]||{},this.deletedStates[n][x][d]=null);else if(c!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][x])for(d in this.deletedStates[n][x]={},this.stateChanges[n][x])this.deletedStates[n][x][d]=null;else this.deletedStates[n][x]=null;else this.deletedStates[n]=null}getState(n,c){const d=this.state[n]||{},x=this.stateChanges[n]||{},E=this.deletedStates[n];if(E===null)return{};if(c!==void 0){const D=String(c),N=Object.assign({},d[D],x[D]);if(E){const H=E[c];if(H===null)return{};for(const W in H)delete N[W]}return N}const I=Object.assign({},d,x);if(E)for(const D in E)delete I[D];return I}initializeTileState(n,c){n.refreshFeatureState(c)}coalesceChanges(n,c){const d={};for(const x in this.stateChanges){this.state[x]=this.state[x]||{};const E={};for(const I in this.stateChanges[x])this.state[x][I]||(this.state[x][I]={}),Object.assign(this.state[x][I],this.stateChanges[x][I]),E[I]=this.state[x][I];d[x]=E}for(const x in this.deletedStates){this.state[x]=this.state[x]||{};const E={};if(this.deletedStates[x]===null)for(const I in this.state[x])E[I]={},this.state[x][I]={};else for(const I in this.deletedStates[x]){if(this.deletedStates[x][I]===null)this.state[x][I]={};else if(this.state[x][I])for(const D of Object.keys(this.deletedStates[x][I]))delete this.state[x][I][D];E[I]=this.state[x][I]}d[x]=d[x]||{},Object.assign(d[x],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(d).length!==0)for(const x in n)n[x].refreshFeatureState(c)}}class ls extends i.E{constructor(n,c,d){super(),this.id=n,this._onlySymbols=d,c.on("data",(x=>{x.dataType==="source"&&x.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&x.dataType==="source"&&x.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),c.on("error",(()=>{this._sourceErrored=!0})),this._source=c,this._tiles={},this._cache=new iu(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ou,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles)if(!this._tiles[n].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,c){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,c)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const d=this._tiles[c];d.upload(n),d.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map((n=>n.tileID)).sort(eh).map((n=>n.key))}getRenderableIds(n,c){const d=[];for(const x in this._tiles)this._isIdRenderable(+x,n,c)&&d.push(this._tiles[x]);return n?d.sort(((x,E)=>{const I=x.tileID,D=E.tileID,N=new i.P(I.canonical.x,I.canonical.y)._rotate(this.transform.angle),H=new i.P(D.canonical.x,D.canonical.y)._rotate(this.transform.angle);return I.overscaledZ-D.overscaledZ||H.y-N.y||H.x-N.x})).map((x=>x.tileID.key)):d.map((x=>x.tileID)).sort(eh).map((x=>x.key))}hasRenderableParent(n){const c=this.findLoadedParent(n,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(n,c,d){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(c||!this._tiles[n].holdingForFade())&&(d||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,c){const d=this._tiles[n];d&&(d.state!=="loading"&&(d.state=c),this._loadTile(d,this._tileLoaded.bind(this,d,n,c)))}_tileLoaded(n,c,d,x){if(x)if(n.state="errored",x.status!==404)this._source.fire(new i.y(x,{tile:n}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const E=this.map.painter.terrain;this.update(this.transform,E.getScaledDemTileSize(),!0),E.resetTileLookupCache(this.id)}else this.update(this.transform)}else n.timeAdded=i.o.now(),d==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(c,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const c=this.getRenderableIds();for(let x=0;x<c.length;x++){const E=c[x];if(n.neighboringTiles&&n.neighboringTiles[E]){const I=this.getTileByID(E);d(n,I),d(I,n)}}function d(x,E){if(!x.dem||x.dem.borderReady)return;x.needsHillshadePrepare=!0,x.needsDEMTextureUpload=!0;let I=E.tileID.canonical.x-x.tileID.canonical.x;const D=E.tileID.canonical.y-x.tileID.canonical.y,N=Math.pow(2,x.tileID.canonical.z),H=E.tileID.key;I===0&&D===0||Math.abs(D)>1||(Math.abs(I)>1&&(Math.abs(I+N)===1?I+=N:Math.abs(I-N)===1&&(I-=N)),E.dem&&x.dem&&(x.dem.backfillBorder(E.dem,I,D),x.neighboringTiles&&x.neighboringTiles[H]&&(x.neighboringTiles[H].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,c,d,x){for(const E in this._tiles){let I=this._tiles[E];if(x[E]||!I.hasData()||I.tileID.overscaledZ<=c||I.tileID.overscaledZ>d)continue;let D=I.tileID;for(;I&&I.tileID.overscaledZ>c+1;){const H=I.tileID.scaledTo(I.tileID.overscaledZ-1);I=this._tiles[H.key],I&&I.hasData()&&(D=H)}let N=D;for(;N.overscaledZ>c;)if(N=N.scaledTo(N.overscaledZ-1),n[N.key]){x[D.key]=D;break}}}findLoadedParent(n,c){if(n.key in this._loadedParentTiles){const d=this._loadedParentTiles[n.key];return d&&d.tileID.overscaledZ>=c?d:null}for(let d=n.overscaledZ-1;d>=c;d--){const x=n.scaledTo(d),E=this._getLoadedTile(x);if(E)return E}}_getLoadedTile(n){const c=this._tiles[n.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,c){c=c||this._source.tileSize;const d=Math.ceil(n.width/c)+1,x=Math.ceil(n.height/c)+1,E=Math.floor(d*x*5),I=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,E):E,D=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,I):I;this._cache.setMaxSize(D)}handleWrapJump(n){const c=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,c){const d={};for(const x in this._tiles){const E=this._tiles[x];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+c),d[E.tileID.key]=E}this._tiles=d;for(const x in this._timers)clearTimeout(this._timers[x]),delete this._timers[x];for(const x in this._tiles)this._setTileReloadTimer(+x,this._tiles[x])}}update(n,c,d,x,E){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!d)return;this.updateCacheSize(n,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const I=this._source.type==="batched-model";let D,N=this._source.maxzoom;const H=this.map&&this.map.painter?this.map.painter._terrain:null;if(H&&H.sourceCache===this&&H.attenuationRange()){const Y=H.attenuationRange()[0],se=Math.floor(Y)-Math.log2(H.getDemUpscale());N>se&&(N=se)}if(this.used||this.usedForTerrain){if(this._source.tileID)D=n.getVisibleUnwrappedCoordinates(this._source.tileID).map((Y=>new i.aO(Y.canonical.z,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y)));else if(this.tileCoverLift!==0){const Y=n.clone();Y.tileCoverLift=this.tileCoverLift,D=Y.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:I}),this._source.minzoom<=1&&n.projection.name==="globe"&&(D.push(new i.aO(1,0,1,0,0)),D.push(new i.aO(1,0,1,1,0)),D.push(new i.aO(1,0,1,0,1)),D.push(new i.aO(1,0,1,1,1)))}else if(D=n.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!d,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:I}),this._source.hasTile){const Y=this._source.hasTile.bind(this._source);D=D.filter((se=>Y(se)))}}else D=[];if(D.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!pd(this._source.type)){const Y=n.coveringZoomLevel({tileSize:c||this._source.tileSize,roundZoom:this._source.roundZoom&&!d}),se=Math.min(Y,this._source.maxzoom);if(I){const fe=n.extendTileCover(D,se);for(const he of fe)D.push(he)}else if(E){const fe=n.extendTileCoverToNearPlane(D,this.transform.getFrustum(se),se);for(const he of fe)D.push(he)}else if(this.castsShadows&&x){const fe=n.extendTileCover(D,se,x);for(const he of fe)this._shadowCasterTiles[he.key]=!0,D.push(he)}}const W=this._updateRetainedTiles(D);if(pd(this._source.type)&&D.length!==0){const Y={},se={},fe=Object.keys(W);for(const Se of fe){const me=W[Se],Te=this._tiles[Se];if(!Te||Te.fadeEndTime&&Te.fadeEndTime<=i.o.now())continue;const Oe=this.findLoadedParent(me,Math.max(me.overscaledZ-ls.maxOverzooming,this._source.minzoom));Oe&&(this._addTile(Oe.tileID),Y[Oe.tileID.key]=Oe.tileID),se[Se]=me}const he=D[D.length-1].overscaledZ;for(const Se in this._tiles){const me=this._tiles[Se];if(W[Se]||!me.hasData())continue;let Te=me.tileID;for(;Te.overscaledZ>he;){Te=Te.scaledTo(Te.overscaledZ-1);const Oe=this._tiles[Te.key];if(Oe&&Oe.hasData()&&se[Te.key]){W[Se]=me.tileID;break}}}for(const Se in Y)W[Se]||(this._coveredTiles[Se]=!0,W[Se]=Y[Se])}for(const Y in W)this._tiles[Y].clearFadeHold();const ee=i.bv(this._tiles,W);for(const Y of ee){const se=this._tiles[Y];se.hasSymbolBuckets&&!se.holdingForFade()?se.setHoldDuration(this.map._fadeDuration):se.hasSymbolBuckets&&!se.symbolFadeFinished()||this._removeTile(+Y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const c={};if(n.length===0)return c;const d={},x=n.reduce(((H,W)=>Math.min(H,W.overscaledZ)),1/0),E=n[0].overscaledZ,I=Math.max(E-ls.maxOverzooming,this._source.minzoom),D=Math.max(E+ls.maxUnderzooming,this._source.minzoom),N={};for(const H of n){const W=this._addTile(H);c[H.key]=H,W.hasData()||x<this._source.maxzoom&&(N[H.key]=H)}this._retainLoadedChildren(N,x,D,c);for(const H of n){let W=this._tiles[H.key];if(W.hasData())continue;if(H.canonical.z>=this._source.maxzoom){const Y=H.children(this._source.maxzoom)[0],se=this.getTile(Y);if(se&&se.hasData()){c[Y.key]=Y;continue}}else{const Y=H.children(this._source.maxzoom);if(c[Y[0].key]&&c[Y[1].key]&&c[Y[2].key]&&c[Y[3].key])continue}let ee=W.wasRequested();for(let Y=H.overscaledZ-1;Y>=I;--Y){const se=H.scaledTo(Y);if(d[se.key]||(d[se.key]=!0,W=this.getTile(se),!W&&ee&&(W=this._addTile(se)),W&&(c[se.key]=se,ee=W.wasRequested(),W.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const c=[];let d,x=this._tiles[n].tileID;for(;x.overscaledZ>0;){if(x.key in this._loadedParentTiles){d=this._loadedParentTiles[x.key];break}c.push(x.key);const E=x.scaledTo(x.overscaledZ-1);if(d=this._getLoadedTile(E),d)break;x=E}for(const E of c)this._loadedParentTiles[E]=d}}_addTile(n){let c=this._tiles[n.key];if(c)return c.isExtraShadowCaster!==!0||this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),c;c=this._cache.getAndRemove(n),c&&(this._setTileReloadTimer(n.key,c),c.tileID=n,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,c)));const d=!!c;if(!d){const x=this.map?this.map.painter:null,E=this._source.tileSize*n.overscaleFactor();c=this._source.type==="raster-array"?new Fo(n,E,this.transform.tileZoom,x,this._isRaster):new Ju(n,E,this.transform.tileZoom,x,this._isRaster,this._source.worldview),this._loadTile(c,this._tileLoaded.bind(this,c,n.key,c.state))}return c.uses++,this._tiles[n.key]=c,d||this._source.fire(new i.z("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(n,c){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const d=c.getExpiryTimeout();d&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),d))}_removeTile(n){const c=this._tiles[n];c&&(c.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),c.uses>0||(c.hasData()&&c.state!=="reloading"||c.state==="empty"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,c,d){const x=[],E=this.transform;if(!E)return x;const I=E.projection.name==="globe",D=i.aF(E.center.lng);for(const N in this._tiles){const H=this._tiles[N];if(d&&H.clearQueryDebugViz(),H.holdingForFade())continue;let W;if(I){const ee=H.tileID.canonical;if(ee.z===0){const Y=[Math.abs(i.aA(D,...au(ee,-1))-D),Math.abs(i.aA(D,...au(ee,1))-D)];W=[0,2*Y.indexOf(Math.min(...Y))-1]}else{const Y=[Math.abs(i.aA(D,...au(ee,-1))-D),Math.abs(i.aA(D,...au(ee,0))-D),Math.abs(i.aA(D,...au(ee,1))-D)];W=[Y.indexOf(Math.min(...Y))-1]}}else W=[0];for(const ee of W){const Y=n.containsTile(H,E,c,ee);Y&&x.push(Y)}}return x}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,c){const d=this.getRenderableIds(n,c).map((E=>this._tiles[E].tileID)),x=this.transform.projection.name==="globe";for(const E of d)E.projMatrix=this.transform.calculateProjMatrix(E.toUnwrapped()),E.expandedProjMatrix=x?this.transform.calculateProjMatrix(E.toUnwrapped(),!1,!0):E.projMatrix;return d}sortCoordinatesByDistance(n){const c=n.slice(),d=this.transform._camera.position,x=this.transform._camera.forward(),E={};for(const I of c){const D=1/(1<<I.canonical.z);E[I.key]=((I.canonical.x+.5)*D+I.wrap-d[0])*x[0]+((I.canonical.y+.5)*D-d[1])*x[1]-d[2]*x[2]}return c.sort(((I,D)=>E[I.key]-E[D.key])),c}hasTransition(){if(this._source.hasTransition())return!0;if(pd(this._source.type))for(const n in this._tiles){const c=this._tiles[n];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=i.o.now())return!0}return!1}setFeatureState(n,c,d){this._state.updateState(n=n||"_geojsonTileLayer",c,d)}removeFeatureState(n,c,d){this._state.removeFeatureState(n=n||"_geojsonTileLayer",c,d)}getFeatureState(n,c){return this._state.getState(n=n||"_geojsonTileLayer",c)}setDependencies(n,c,d){const x=this._tiles[n];x&&x.setDependencies(c,d)}reloadTilesForDependencies(n,c){for(const d in this._tiles)this._tiles[d].hasDependency(n,c)&&this._reloadTile(+d,"reloading");this._cache.filter((d=>!d.hasDependency(n,c)))}_preloadTiles(n,c){if(!this._sourceLoaded){const N=()=>{this._sourceLoaded&&(this._source.off("data",N),this._preloadTiles(n,c))};return void this._source.on("data",N)}const d=new Map,x=Array.isArray(n)?n:[n],E=this.map.painter.terrain,I=this.usedForTerrain&&E?E.getScaledDemTileSize():this._source.tileSize;for(const N of x){const H=N.coveringTiles({tileSize:I,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const W of H)d.set(W.key,W);this.usedForTerrain&&N.updateElevation(!1)}const D=Array.from(d.values());i.bw(D,((N,H)=>{const W=new Ju(N,this._source.tileSize*N.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(W,(ee=>{this._source.type==="raster-dem"&&W.dem&&this._backfillDEM(W),H(ee,W)}))}),c)}}function eh(p,n){const c=Math.abs(2*p.wrap)-+(p.wrap<0),d=Math.abs(2*n.wrap)-+(n.wrap<0);return p.overscaledZ-n.overscaledZ||d-c||n.canonical.y-p.canonical.y||n.canonical.x-p.canonical.x}function pd(p){return p==="raster"||p==="image"||p==="video"||p==="custom"}function au(p,n){const c=1<<p.z;return[p.x/c+n,(p.x+1)/c+n]}ls.maxOverzooming=10,ls.maxUnderzooming=3;class zh{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,c=!1;for(const d in this.style._mergedLayers){const x=this.style._mergedLayers[d];if(x.type==="fill-extrusion"||x.type==="building")this.layers.push({layer:x,visible:n,visibilityChanged:c});else if(x.type==="model"){const E=this.style.getLayerSource(x);E&&E.type==="batched-model"&&this.layers.push({layer:x,visible:n,visibilityChanged:c})}}}onNewFrame(n){this.layersGotHidden=!1;for(const c of this.layers){const d=c.layer;let x=!1;d.type==="fill-extrusion"?x=!d.isHidden(n)&&d.paint.get("fill-extrusion-opacity")>0:d.type==="building"?x=!d.isHidden(n)&&d.paint.get("building-opacity")>0:d.type==="model"&&(x=!d.isHidden(n)&&d.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!x&&c.visible,c.visible=x}}updateZOffset(n,c){this.currentBuildingBuckets=[];for(const x of this.layers){const E=x.layer,I=this.style.getLayerSourceCache(E);let D=1;E.type==="fill-extrusion"?D=x.visible?E.paint.get("fill-extrusion-vertical-scale"):0:E.type==="building"&&(D=x.visible?E.paint.get("building-vertical-scale"):0);let N=I?I.getTile(c):null;if(!N&&I)for(const H in I._tiles){const W=I._tiles[H];if(c.canonical.isChildOf(W.tileID.canonical)){N=W;break}}this.currentBuildingBuckets.push({bucket:N?N.getBucket(E):null,tileID:N?N.tileID:c,verticalScale:D})}n.hasAnyZOffset=!1;let d=!1;for(let x=0;x<n.symbolInstances.length;x++){const E=n.symbolInstances.get(x),I=E.zOffset,D=this._getHeightAtTileOffset(c,E.tileAnchorX,E.tileAnchorY);E.zOffset=D!==Number.NEGATIVE_INFINITY?D:I,d||I===E.zOffset||(d=!0),n.hasAnyZOffset||E.zOffset===0||(n.hasAnyZOffset=!0)}d&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,c,d,x){let E=c,I=d;if(n.canonical.z!==x.canonical.z){const D=x.canonical,N=1/(1<<n.canonical.z-D.z);E=(c+n.canonical.x*i.al)*N-D.x*i.al|0,I=(d+n.canonical.y*i.al)*N-D.y*i.al|0}return{tileX:E,tileY:I}}_getHeightAtTileOffset(n,c,d){let x,E;for(let I=0;I<this.layers.length;++I){const D=this.layers[I].layer;if(D.type!=="fill-extrusion"&&D.type!=="building")continue;const{bucket:N,tileID:H,verticalScale:W}=this.currentBuildingBuckets[I];if(!N)continue;const{tileX:ee,tileY:Y}=this._mapCoordToOverlappingTile(n,c,d,H),se=N.getHeightAtTileCoord(ee,Y);se&&se.height!==void 0&&(se.hidden?x=se.height:E=Math.max(se.height*W,E||0))}if(E!==void 0)return E;for(let I=0;I<this.layers.length;++I){const D=this.layers[I];if(D.layer.type!=="model"||!D.visible)continue;const{bucket:N,tileID:H}=this.currentBuildingBuckets[I];if(!N)continue;const{tileX:W,tileY:ee}=this._mapCoordToOverlappingTile(n,c,d,H),Y=N.getHeightAtTileCoord(W,ee);if(Y&&!Y.hidden)return Y.height===void 0&&x!==void 0?Math.min(Y.maxHeight,x)*Y.verticalScale:Y.height?Y.height*Y.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function su(p,n){const c={};for(const d in p)d!=="ref"&&(c[d]=p[d]);return i.bx.forEach((d=>{d in n&&(c[d]=n[d])})),c}function $l(p){p=p.slice();const n=Object.create(null);for(let c=0;c<p.length;c++)n[p[c].id]=p[c];for(let c=0;c<p.length;c++)"ref"in p[c]&&(p[c]=su(p[c],n[p[c].ref]));return p}const oi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function wc(p,n,c){c.push({command:oi.addSource,args:[p,n[p]]})}function Sc(p,n,c){n.push({command:oi.removeSource,args:[p]}),c[p]=!0}function rp(p,n,c,d){Sc(p,c,d),wc(p,n,c)}function lu(p,n,c){let d;for(d in p[c])if(p[c].hasOwnProperty(d)&&d!=="data"&&!i.by(p[c][d],n[c][d]))return!1;for(d in n[c])if(n[c].hasOwnProperty(d)&&d!=="data"&&!i.by(p[c][d],n[c][d]))return!1;return!0}function oc(p,n,c,d,x,E){let I;for(I in n=n||{},p=p||{})p.hasOwnProperty(I)&&(i.by(p[I],n[I])||c.push({command:E,args:[d,I,n[I],x]}));for(I in n)n.hasOwnProperty(I)&&!p.hasOwnProperty(I)&&(i.by(p[I],n[I])||c.push({command:E,args:[d,I,n[I],x]}))}function cu(p){return p.id}function uu(p,n){return p[n.id]=n,p}function Of(p,n,c){const d=n.createTileMatrix(p,p.worldSize,c.toUnwrapped());return i.aB(new Float32Array(16),p.projMatrix,d)}function Ms(p,n,c){if(n.projection.name===c.projection.name)return p.projMatrix;const d=c.clone();return d.setProjection(n.projection),Of(d,n.getProjection(),p)}function bl(p,n,c){return n.name===c.projection.name?p.projMatrix:Of(c,n,p)}class md{constructor(n,c){this.reset(n,c)}reset(n,c){this.points=n||[],this._distances=[0];for(let d=1;d<this.points.length;d++)this._distances[d]=this._distances[d-1]+this.points[d].dist(this.points[d-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=i.aA(n,0,1);let c=1,d=this._distances[c];const x=n*this.paddedLength+this.padding;for(;d<x&&c<this._distances.length;)d=this._distances[++c];const E=c-1,I=this._distances[E],D=d-I,N=D>0?(x-I)/D:0;return this.points[E].mult(1-N).add(this.points[c].mult(N))}}class Lh{constructor(n,c,d){const x=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(n/d),this.yCellCount=Math.ceil(c/d);for(let I=0;I<this.xCellCount*this.yCellCount;I++)x.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=c,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,c,d,x,E){this._forEachCell(c,d,x,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(x),this.bboxes.push(E)}insertCircle(n,c,d,x){this._forEachCell(c-x,d-x,c+x,d+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(c),this.circles.push(d),this.circles.push(x)}_insertBoxCell(n,c,d,x,E,I){this.boxCells[E].push(I)}_insertCircleCell(n,c,d,x,E,I){this.circleCells[E].push(I)}_query(n,c,d,x,E,I){if(d<0||n>this.width||x<0||c>this.height)return!E&&[];const D=[];if(n<=0&&c<=0&&this.width<=d&&this.height<=x){if(E)return!0;for(let N=0;N<this.boxKeys.length;N++)D.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const H=this.circles[3*N],W=this.circles[3*N+1],ee=this.circles[3*N+2];D.push({key:this.circleKeys[N],x1:H-ee,y1:W-ee,x2:H+ee,y2:W+ee})}return I?D.filter(I):D}return this._forEachCell(n,c,d,x,this._queryCell,D,{hitTest:E,seenUids:{box:{},circle:{}}},I),E?D.length>0:D}_queryCircle(n,c,d,x,E){const I=n-d,D=n+d,N=c-d,H=c+d;if(D<0||I>this.width||H<0||N>this.height)return!x&&[];const W=[];return this._forEachCell(I,N,D,H,this._queryCellCircle,W,{hitTest:x,circle:{x:n,y:c,radius:d},seenUids:{box:{},circle:{}}},E),x?W.length>0:W}query(n,c,d,x,E){return this._query(n,c,d,x,!1,E)}hitTest(n,c,d,x,E){return this._query(n,c,d,x,!0,E)}hitTestCircle(n,c,d,x){return this._queryCircle(n,c,d,!0,x)}_queryCell(n,c,d,x,E,I,D,N){const H=D.seenUids,W=this.boxCells[E];if(W!==null){const Y=this.bboxes;for(const se of W)if(!H.box[se]){H.box[se]=!0;const fe=4*se;if(n<=Y[fe+2]&&c<=Y[fe+3]&&d>=Y[fe+0]&&x>=Y[fe+1]&&(!N||N(this.boxKeys[se]))){if(D.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[se],x1:Y[fe],y1:Y[fe+1],x2:Y[fe+2],y2:Y[fe+3]})}}}const ee=this.circleCells[E];if(ee!==null){const Y=this.circles;for(const se of ee)if(!H.circle[se]){H.circle[se]=!0;const fe=3*se;if(this._circleAndRectCollide(Y[fe],Y[fe+1],Y[fe+2],n,c,d,x)&&(!N||N(this.circleKeys[se]))){if(D.hitTest)return I.push(!0),!0;{const he=Y[fe],Se=Y[fe+1],me=Y[fe+2];I.push({key:this.circleKeys[se],x1:he-me,y1:Se-me,x2:he+me,y2:Se+me})}}}}}_queryCellCircle(n,c,d,x,E,I,D,N){const H=D.circle,W=D.seenUids,ee=this.boxCells[E];if(ee!==null){const se=this.bboxes;for(const fe of ee)if(!W.box[fe]){W.box[fe]=!0;const he=4*fe;if(this._circleAndRectCollide(H.x,H.y,H.radius,se[he+0],se[he+1],se[he+2],se[he+3])&&(!N||N(this.boxKeys[fe])))return I.push(!0),!0}}const Y=this.circleCells[E];if(Y!==null){const se=this.circles;for(const fe of Y)if(!W.circle[fe]){W.circle[fe]=!0;const he=3*fe;if(this._circlesCollide(se[he],se[he+1],se[he+2],H.x,H.y,H.radius)&&(!N||N(this.circleKeys[fe])))return I.push(!0),!0}}}_forEachCell(n,c,d,x,E,I,D,N){const H=this._convertToXCellCoord(n),W=this._convertToYCellCoord(c),ee=this._convertToXCellCoord(d),Y=this._convertToYCellCoord(x);for(let se=H;se<=ee;se++)for(let fe=W;fe<=Y;fe++)if(E.call(this,n,c,d,x,this.xCellCount*fe+se,I,D,N))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,c,d,x,E,I){const D=x-n,N=E-c,H=d+I;return H*H>D*D+N*N}_circleAndRectCollide(n,c,d,x,E,I,D){const N=(I-x)/2,H=Math.abs(n-(x+N));if(H>N+d)return!1;const W=(D-E)/2,ee=Math.abs(c-(E+W));if(ee>W+d)return!1;if(H<=N||ee<=W)return!0;const Y=H-N,se=ee-W;return Y*Y+se*se<=d*d}}const kf={unknown:0,flipRequired:1,flipNotRequired:2},Oa=Math.tan(85*Math.PI/180);function Ka(p,n,c,d,x,E,I){const D=i.bC();if(c)if(E.name==="globe"){const N=i.bD(x,n);i.aB(D,D,N)}else{const N=i.bE([],I);D[0]=N[0],D[1]=N[1],D[4]=N[2],D[5]=N[3],d||i.bB(D,D,x.angle)}else i.aB(D,x.labelPlaneMatrix,p);return D}function ya(p,n,c,d,x,E,I){const D=Ka(p,n,c,d,x,E,I);return E.name==="globe"&&c||(D[2]=D[6]=D[10]=D[14]=0),D}function hu(p,n,c,d,x,E,I){if(c){if(E.name==="globe"){const D=Ka(p,n,c,d,x,E,I);return i.bl(D,D),i.aB(D,p,D),D}{const D=i.bz(p),N=i.bA([]);return N[0]=I[0],N[1]=I[1],N[4]=I[2],N[5]=I[3],i.aB(D,D,N),d||i.bB(D,D,-x.angle),D}}return x.glCoordMatrix}function qs(p,n,c,d){const x=[p,n,c,1];c?i.aC(x,x,d):du(x,x,d);const E=x[3];return x[0]/=E,x[1]/=E,x[2]/=E,x}function Tc(p,n){return Math.min(.5+p/n*.5,1.5)}function wl(p,n){const c=p[0]/p[3],d=p[1]/p[3];return c>=-n[0]&&c<=n[0]&&d>=-n[1]&&d<=n[1]}function Kp(p,n,c,d,x,E,I,D,N,H){const W=c.transform,ee=d?p.textSizeData:p.iconSizeData,Y=i.bK(ee,c.transform.zoom),se=W.projection.name==="globe",fe=[256/c.width*2+1,256/c.height*2+1],he=d?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;he.clear();let Se=null;se&&(Se=d?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const me=p.lineVertexArray,Te=d?p.text.placedSymbolArray:p.icon.placedSymbolArray,Oe=c.transform.width/c.transform.height;let Le,Ge=!1;for(let Ue=0;Ue<Te.length;Ue++){const Ze=Te.get(Ue),{numGlyphs:$e,writingMode:Ve}=Ze;if(Ve!==i.bL.vertical||Ge||Le===i.bL.horizontal||(Ge=!0),Le=Ve,(Ze.hidden||Ve===i.bL.vertical)&&!Ge){hn($e,he);continue}Ge=!1;const We=new i.P(Ze.tileAnchorX,Ze.tileAnchorY);let{x:yt,y:lt,z:Ot}=W.projection.projectTilePoint(We.x,We.y,H.canonical);if(N){const[Xt,qr,$r]=N(We);yt+=Xt,lt+=qr,Ot+=$r}const _t=[yt,lt,Ot,1];if(i.aC(_t,_t,n),!wl(_t,fe)){hn($e,he);continue}const It=_t[3],ur=Tc(c.transform.getCameraToCenterDistance(W.projection),It),xt=i.bM(ee,Y,Ze),rt=I?xt/ur:xt*ur,zt=qs(yt,lt,Ot,x);if(zt[3]<=0){hn($e,he);continue}let gt={};const Bt=i.an(p.layers[0].layout.get("text-max-angle")),Gt=Math.cos(Bt),ar=I?null:N,Ht=vi(Ze,rt,!1,D,n,x,E,p.glyphOffsetArray,me,he,Se,zt,We,gt,Oe,ar,W.projection,H,I,Gt);Ge=Ht.useVertical,ar&&Ht.needsFlipping&&(gt={}),(Ht.notEnoughRoom||Ge||Ht.needsFlipping&&vi(Ze,rt,!0,D,n,x,E,p.glyphOffsetArray,me,he,Se,zt,We,gt,Oe,ar,W.projection,H,I,Gt).notEnoughRoom)&&hn($e,he)}d?(p.text.dynamicLayoutVertexBuffer.updateData(he),Se&&p.text.globeExtVertexBuffer&&p.text.globeExtVertexBuffer.updateData(Se)):(p.icon.dynamicLayoutVertexBuffer.updateData(he),Se&&p.icon.globeExtVertexBuffer&&p.icon.globeExtVertexBuffer.updateData(Se))}function zf(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se){const{lineStartIndex:me,glyphStartIndex:Te,segment:Oe}=D,Le=Te+D.numGlyphs,Ge=me+D.lineLength,Ue=n.getoffsetX(Te),Ze=n.getoffsetX(Le-1),$e=Ad(p*Ue,c,d,x,E,I,Oe,me,Ge,N,H,W,ee,Y,!0,se,fe,he,Se);if(!$e)return null;const Ve=Ad(p*Ze,c,d,x,E,I,Oe,me,Ge,N,H,W,ee,Y,!0,se,fe,he,Se);return Ve?{first:$e,last:Ve}:null}function np(p,n,c,d){return p===i.bL.horizontal&&Math.abs(d)>Math.abs(c)?{useVertical:!0}:p===i.bL.vertical?d>0?{needsFlipping:!0}:null:n!==kf.unknown&&(function(x,E){return x===0||Math.abs(E/x)>Oa})(c,d)?n===kf.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function vi(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me,Te,Oe){const Le=n/24,Ge=p.lineOffsetX*Le,Ue=p.lineOffsetY*Le,{lineStartIndex:Ze,glyphStartIndex:$e,numGlyphs:Ve,segment:We,writingMode:yt,flipState:lt}=p,Ot=Ze+p.lineLength,_t=It=>{if(W){const[zt,gt,Bt]=It.up,Gt=H.length;i.bN(W,Gt+0,zt,gt,Bt),i.bN(W,Gt+1,zt,gt,Bt),i.bN(W,Gt+2,zt,gt,Bt),i.bN(W,Gt+3,zt,gt,Bt)}const[ur,xt,rt]=It.point;i.bO(H,ur,xt,rt,It.angle)};if(Ve>1){const It=zf(Le,D,Ge,Ue,c,ee,Y,p,N,E,se,he,!1,Se,me,Te,Oe);if(!It)return{notEnoughRoom:!0};if(d&&!c){let[ur,xt,rt]=It.first.point,[zt,gt,Bt]=It.last.point;[ur,xt]=qs(ur,xt,rt,I),[zt,gt]=qs(zt,gt,Bt,I);const Gt=np(yt,lt,(zt-ur)*fe,gt-xt);if(p.flipState=Gt&&Gt.needsFlipping?kf.flipRequired:kf.flipNotRequired,Gt)return Gt}_t(It.first);for(let ur=$e+1;ur<$e+Ve-1;ur++){const xt=Ad(Le*D.getoffsetX(ur),Ge,Ue,c,ee,Y,We,Ze,Ot,N,E,se,he,!1,!1,Se,me,Te,Oe);if(!xt)return H.length-=4*(ur-$e),{notEnoughRoom:!0};_t(xt)}_t(It.last)}else{if(d&&!c){const ur=qs(Y.x,Y.y,0,x),xt=Ze+We+1,rt=new i.P(N.getx(xt),N.gety(xt)),zt=qs(rt.x,rt.y,0,x),gt=zt[3]>0?zt:Jp(Y,rt,ur,1,x,void 0,Se,me.canonical),Bt=np(yt,lt,(gt[0]-ur[0])*fe,gt[1]-ur[1]);if(p.flipState=Bt&&Bt.needsFlipping?kf.flipRequired:kf.flipNotRequired,Bt)return Bt}const It=Ad(Le*D.getoffsetX($e),Ge,Ue,c,ee,Y,We,Ze,Ot,N,E,se,he,!1,!1,Se,me,Te,Oe);if(!It)return{notEnoughRoom:!0};_t(It)}return{}}function fu(p,n,c,d,x){const{x:E,y:I,z:D}=d.projectTilePoint(p.x,p.y,n);if(!x)return qs(E,I,D,c);const[N,H,W]=x(p);return qs(E+N,I+H,D+W,c)}function Jp(p,n,c,d,x,E,I,D){const N=fu(p.sub(n)._unit()._add(p),D,x,I,E);return i.av(N,c,N),i.aw(N,N),i.bH(N,c,N,d)}function Ad(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me,Te){const Oe=d?p-n:p+n;let Le=Oe>0?1:-1,Ge=0;d&&(Le*=-1,Ge=Math.PI),Le<0&&(Ge+=Math.PI);let Ue=D+I+(Le>0?0:1)|0,Ze=x,$e=x,Ve=0,We=0;const yt=Math.abs(Oe),lt=[],Ot=[];let _t=E,It=_t,ur=i.bF([]);const xt=()=>Jp(It,_t,$e,yt-Ve+1,W,Y,he,Se.canonical);for(;Ve+We<=yt;){if(Ue+=Le,Ue<D||Ue>=N)return null;if($e=Ze,It=_t,lt.push($e),se&&Ot.push(It),_t=new i.P(H.getx(Ue),H.gety(Ue)),Ze=ee[Ue],!Ze){const $r=fu(_t,Se.canonical,W,he,Y);Ze=$r[3]>0?ee[Ue]=$r:xt()}Ve+=We;const Xt=i.av([],Ze,$e),qr=i.bG($e,Ze);if(c&&qr>0&&We>0&&i.bJ(ur,Xt)/(We*qr)<Te)return null;We=qr,ur=Xt}fe&&Y&&(ee[Ue]&&(Ze=xt(),We=i.bG($e,Ze),ur=i.av([],Ze,$e)),ee[Ue]=Ze);const rt=(yt-Ve)/We,zt=_t.sub(It)._mult(rt)._add(It),gt=i.bH([],$e,ur,rt);let Bt=[0,0,1],Gt=ur[0],ar=ur[1];if(me&&(Bt=he.upVector(Se.canonical,zt.x,zt.y),Bt[0]!==0||Bt[1]!==0||Bt[2]!==1)){const Xt=[Bt[2],0,-Bt[0]],qr=i.bI([],Bt,Xt);i.aw(Xt,Xt),i.aw(qr,qr),Gt=i.bJ(ur,Xt),ar=i.bJ(ur,qr)}if(c){const Xt=i.bI([],Bt,ur);i.aw(Xt,Xt),i.bH(gt,gt,Xt,c*Le)}const Ht=Ge+Math.atan2(ar,Gt);return lt.push(gt),se&&Ot.push(zt),{point:gt,angle:Ht,path:lt,tilePath:Ot,up:Bt}}function hn(p,n){const c=n.length,d=c+4*p;n.resize(d),n.float32.fill(-1/0,4*c,4*d)}function du(p,n,c){const d=n[0],x=n[1];return p[0]=c[0]*d+c[4]*x+c[12],p[1]=c[1]*d+c[5]*x+c[13],p[3]=c[3]*d+c[7]*x+c[15],p}const $a=100;class Gl{constructor(n,c,d=new Lh(n.width+200,n.height+200,25),x=new Lh(n.width+200,n.height+200,25)){this.transform=n,this.grid=d,this.ignoredGrid=x,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+$a,this.screenBottomBoundary=n.height+$a,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=c}placeCollisionBox(n,c,d,x,E,I,D,N,H,W,ee){let Y=d.projectedAnchorX,se=d.projectedAnchorY,fe=d.projectedAnchorZ;const he=d.tileAnchorX,Se=d.tileAnchorY,me=d.elevation,Te=d.tileID,Oe=n.getProjection();if(me&&Te){const[Ot,_t,It]=Oe.upVector(Te.canonical,d.tileAnchorX,d.tileAnchorY),ur=Oe.upVectorScale(Te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;Y+=Ot*me*ur,se+=_t*me*ur,fe+=It*me*ur}const Le=n.projection.name==="globe",Ge=n.projection.name==="globe"?i.aj(this.transform.zoom):0;if(Te&&Le&&Ge<1&&!I){const Ot=1<<Te.canonical.z,_t=i.bP(he,Se);i.bQ(_t,_t,1/i.al),i.bR(_t,_t,i.bP(Te.canonical.x,Te.canonical.y)),i.bQ(_t,_t,1/Ot),i.bS(_t,_t,i.bP(x[0],x[1])),_t[0]=i.bT(_t[0],-.5,.5),i.bQ(_t,_t,i.al);const It=i.bU(_t[0],_t[1],i.al/(2*Math.PI),1);i.aC(It,It,E),Y=i.ak(Y,It[0],Ge),se=i.ak(se,It[1],Ge),fe=i.ak(fe,It[2],Ge)}const Ue=this.projectAndGetPerspectiveRatio(W,Y,se,fe,d.tileID,Oe.name==="globe"||!!me||this.transform.pitch>0,Oe),Ze=H*Ue.perspectiveRatio,$e=(d.x1*c+D.x-d.padding)*Ze+Ue.point.x,Ve=(d.y1*c+D.y-d.padding)*Ze+Ue.point.y,We=(d.x2*c+D.x+d.padding)*Ze+Ue.point.x,yt=(d.y2*c+D.y+d.padding)*Ze+Ue.point.y,lt=Ue.perspectiveRatio<=.55||Ue.occluded;return!this.isInsideGrid($e,Ve,We,yt)||!N&&this.grid.hitTest($e,Ve,We,yt,ee)||lt?{box:[],offscreen:!1,occluded:Ue.occluded}:{box:[$e,Ve,We,yt],offscreen:this.isOffscreen($e,Ve,We,yt),occluded:!1}}placeCollisionCircles(n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he){const Se=[],me=this.transform.elevation,Te=n.getProjection(),Oe=me?me.getAtTileOffsetFunc(he,this.transform.center.lat,this.transform.worldSize,Te):null,Le=new i.P(d.tileAnchorX,d.tileAnchorY);let{x:Ge,y:Ue,z:Ze}=Te.projectTilePoint(Le.x,Le.y,he.canonical);if(Oe){const[Bt,Gt,ar]=Oe(Le);Ge+=Bt,Ue+=Gt,Ze+=ar}const $e=Te.name==="globe",Ve=this.projectAndGetPerspectiveRatio(D,Ge,Ue,Ze,he,$e||!!me||this.transform.pitch>0,Te),{perspectiveRatio:We}=Ve,yt=(ee?I/We:I*We)/i.bX,lt=qs(Ge,Ue,Ze,N),Ot=d.lineOffsetX*yt,_t=d.lineOffsetY*yt,It=i.an(n.layers[0].layout.get("text-max-angle")),ur=Math.cos(It),xt=Ve.signedDistanceFromCamera>0?zf(yt,E,Ot,_t,!1,lt,Le,d,x,N,{},me&&!ee?Oe:null,ee&&!!me,Te,he,ee,ur):null;let rt=!1,zt=!1,gt=!0;if(xt&&!Ve.occluded){const Bt=.5*se*We+fe,Gt=new i.P(-100,-100),ar=new i.P(this.screenRightBoundary,this.screenBottomBoundary),Ht=new md,{first:Xt,last:qr}=xt,$r=Xt.path.length;let Yr=[];for(let En=$r-1;En>=1;En--)Yr.push(Xt.path[En]);for(let En=1;En<qr.path.length;En++)Yr.push(qr.path[En]);const Lr=2.5*Bt;H&&(Yr=Yr.map((([En,In,ki],_n)=>(Oe&&!$e&&(ki=Oe(_n<$r-1?Xt.tilePath[$r-1-_n]:qr.tilePath[_n-$r+2])[2]),qs(En,In,ki,H)))),Yr.some((En=>En[3]<=0))&&(Yr=[]));let rn=[];if(Yr.length>0){let En=1/0,In=-1/0,ki=1/0,_n=-1/0;for(const si of Yr)En=Math.min(En,si[0]),ki=Math.min(ki,si[1]),In=Math.max(In,si[0]),_n=Math.max(_n,si[1]);In>=Gt.x&&En<=ar.x&&_n>=Gt.y&&ki<=ar.y&&(rn=[Yr.map((si=>new i.P(si[0],si[1])))],(En<Gt.x||In>ar.x||ki<Gt.y||_n>ar.y)&&(rn=i.bV(rn,Gt.x,Gt.y,ar.x,ar.y)))}for(const En of rn){Ht.reset(En,.25*Bt);let In=0;In=Ht.length<=.5*Bt?1:Math.ceil(Ht.paddedLength/Lr)+1;for(let ki=0;ki<In;ki++){const _n=ki/Math.max(In-1,1),si=Ht.lerp(_n),xi=si.x+$a,Ci=si.y+$a;Se.push(xi,Ci,Bt,0);const On=xi-Bt,bi=Ci-Bt,Ai=xi+Bt,wi=Ci+Bt;if(gt=gt&&this.isOffscreen(On,bi,Ai,wi),zt=zt||this.isInsideGrid(On,bi,Ai,wi),!c&&this.grid.hitTestCircle(xi,Ci,Bt,Y)&&(rt=!0,!W))return{circles:[],offscreen:!1,collisionDetected:rt,occluded:!1}}}}return{circles:!W&&rt||!zt?[]:Se,offscreen:gt,collisionDetected:rt,occluded:Ve.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let d=1/0,x=1/0,E=-1/0,I=-1/0;for(const W of n){const ee=new i.P(W.x+$a,W.y+$a);d=Math.min(d,ee.x),x=Math.min(x,ee.y),E=Math.max(E,ee.x),I=Math.max(I,ee.y),c.push(ee)}const D=this.grid.query(d,x,E,I).concat(this.ignoredGrid.query(d,x,E,I)),N={},H={};for(const W of D){const ee=W.key;if(N[ee.bucketInstanceId]===void 0&&(N[ee.bucketInstanceId]={}),N[ee.bucketInstanceId][ee.featureIndex])continue;const Y=[new i.P(W.x1,W.y1),new i.P(W.x2,W.y1),new i.P(W.x2,W.y2),new i.P(W.x1,W.y2)];i.bW(c,Y)&&(N[ee.bucketInstanceId][ee.featureIndex]=!0,H[ee.bucketInstanceId]===void 0&&(H[ee.bucketInstanceId]=[]),H[ee.bucketInstanceId].push(ee.featureIndex))}return H}insertCollisionBox(n,c,d,x,E){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:x,collisionGroupID:E},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,c,d,x,E){const I=c?this.ignoredGrid:this.grid,D={bucketInstanceId:d,featureIndex:x,collisionGroupID:E};for(let N=0;N<n.length;N+=4)I.insertCircle(D,n[N],n[N+1],n[N+2])}projectAndGetPerspectiveRatio(n,c,d,x,E,I,D){const N=[c,d,x,1];let H=!1;x||this.transform.pitch>0?(i.aC(N,N,n),this.fogState&&E&&D.name!=="globe"&&(H=(function(Y,se,fe,he,Se,me){const Te=me.calculateFogTileMatrix(Se),Oe=[se,fe,he];return i.af(Oe,Oe,Te),Dr(Y,i.ag(Oe),me.pitch,me._fov)})(this.fogState,c,d,x,E.toUnwrapped(),this.transform)>.9)):du(N,N,n);const W=N[3];return{point:new i.P((N[0]/W+1)/2*this.transform.width+$a,(-N[1]/W+1)/2*this.transform.height+$a),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/W*.5,1.5),signedDistanceFromCamera:W,occluded:I&&N[2]>W||H}}isOffscreen(n,c,d,x){return d<$a||n>=this.screenRightBoundary||x<$a||c>this.screenBottomBoundary}isInsideGrid(n,c,d,x){return d>=0&&n<this.gridRightBoundary&&x>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const n=i.bA([]);return i.br(n,n,[-100,-100,0]),n}}class gd{constructor(n,c,d,x){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?c:-c))):x&&d?1:0,this.placed=d}isHidden(){return this.opacity===0&&!this.placed}}class ul{constructor(n,c,d,x,E,I=!1){this.text=new gd(n?n.text:null,c,d,E),this.icon=new gd(n?n.icon:null,c,x,E),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Kr{constructor(n,c,d,x=!1){this.text=n,this.icon=c,this.skipFade=d,this.clipped=x}}class Di{constructor(){this.invProjMatrix=i.bC(),this.viewportMatrix=i.bC(),this.circles=[]}}class Oi{constructor(n,c,d,x,E){this.bucketInstanceId=n,this.featureIndex=c,this.sourceLayerIndex=d,this.bucketIndex=x,this.tileID=E}}class Ws{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const c=++this.maxGroupID;this.collisionGroups[n]={ID:c,predicate:d=>d.collisionGroupID===c}}return this.collisionGroups[n]}}function Bh(p,n,c,d,x){const{horizontalAlign:E,verticalAlign:I}=i.c0(p),D=-(E-.5)*n,N=-(I-.5)*c,H=i.c1(p,d);return new i.P(D+H[0]*x,N+H[1]*x)}function Ti(p,n,c,d,x){const E=new i.P(p,n);return c&&E._rotate(d?x:-x),E}class ip{constructor(n,c,d,x,E,I){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new Gl(this.transform,E),this.buildingIndex=I,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Ws(d),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,c,d,x,E=1){const I=d.getBucket(c),D=d.latestFeatureIndex;if(!I||!D||c.fqid!==I.layerIds[0])return;const N=I.layers[0].layout,H=I.layers[0].paint,W=d.collisionBoxArray,ee=Math.pow(2,this.transform.zoom-d.tileID.overscaledZ),Y=d.tileSize/i.al,se=d.tileID.toUnwrapped();this.transform.setProjection(I.projection);const fe=(he=d.tileID,Se=I.getProjection(),me=this.transform,Se.name===this.projection?me.calculateProjMatrix(he.toUnwrapped()):Of(me,Se,he));var he,Se,me;const Te=N.get("text-pitch-alignment")==="map",Oe=N.get("text-rotation-alignment")==="map";c.compileFilter(c.options);const Le=c.dynamicFilter(),Ge=c.dynamicFilterNeedsFeature(),Ue=this.transform.calculatePixelsToTileUnitsMatrix(d),Ze=ya(fe,d.tileID.canonical,Te,Oe,this.transform,I.getProjection(),Ue);let $e=null;const Ve=I.getProjection().createInversionMatrix(this.transform,d.tileID.canonical);if(Te){const rt=hu(fe,d.tileID.canonical,Te,Oe,this.transform,I.getProjection(),Ue);$e=i.aB([],this.transform.labelPlaneMatrix,rt)}let We=null;Le&&d.latestFeatureIndex&&(We={unwrappedTileID:se,dynamicFilter:Le,dynamicFilterNeedsFeature:Ge}),this.retainedQueryData[I.bucketInstanceId]=new Oi(I.bucketInstanceId,D,I.sourceLayerIndex,I.index,d.tileID);const[yt,lt]=I.layers[0].layout.get("text-size-scale-range"),Ot=i.aA(E,yt,lt),[_t,It]=N.get("icon-size-scale-range"),ur=i.aA(E,_t,It),xt={bucket:I,layout:N,paint:H,posMatrix:fe,invMatrix:Ve,mercatorCenter:[i.aF(this.transform.center.lng),i.aJ(this.transform.center.lat)],textLabelPlaneMatrix:Ze,labelToScreenMatrix:$e,clippingData:We,scale:ee,textPixelRatio:Y,holdingForFade:d.holdingForFade(),collisionBoxArray:W,partiallyEvaluatedTextSize:i.bK(I.textSizeData,this.transform.zoom,Ot),partiallyEvaluatedIconSize:i.bK(I.iconSizeData,this.transform.zoom,ur),collisionGroup:this.collisionGroups.get(I.sourceID),latestFeatureIndex:d.latestFeatureIndex};if(x)for(const rt of I.sortKeyRanges){const{sortKey:zt,symbolInstanceStart:gt,symbolInstanceEnd:Bt}=rt;n.push({sortKey:zt,symbolInstanceStart:gt,symbolInstanceEnd:Bt,parameters:xt})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:I.symbolInstances.length,parameters:xt})}attemptAnchorPlacement(n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me,Te,Oe,Le,Ge){const{textOffset0:Ue,textOffset1:Ze,crossTileID:$e}=he,Ve=[Ue,Ze],We=Bh(n,I,D,Ve,N),yt=this.collisionIndex.placeCollisionBox(me,N,c,d,x,E,Ti(We.x,We.y,H,W,this.transform.angle),fe,ee,Y,se.predicate);if(Oe){const lt=me.getSymbolInstanceIconSize(Ge,this.transform.zoom,he.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(me,lt,Oe,d,x,E,Ti(We.x,We.y,H,W,this.transform.angle),fe,ee,Y,se.predicate).box.length===0)return}if(yt.box.length>0){let lt;return this.prevPlacement&&this.prevPlacement.variableOffsets[$e]&&this.prevPlacement.placements[$e]&&this.prevPlacement.placements[$e].text&&(lt=this.prevPlacement.variableOffsets[$e].anchor),this.variableOffsets[$e]={textOffset:Ve,width:I,height:D,anchor:n,textScale:N,prevAnchor:lt},this.markUsedJustification(me,n,he,Te),me.allowVerticalPlacement&&(this.markUsedOrientation(me,Te,he),this.placedOrientations[$e]=Te),{shift:We,placedGlyphBoxes:yt}}}placeLayerBucketPart(n,c,d,x,E=1){const{bucket:I,layout:D,paint:N,posMatrix:H,textLabelPlaneMatrix:W,labelToScreenMatrix:ee,clippingData:Y,textPixelRatio:se,mercatorCenter:fe,invMatrix:he,holdingForFade:Se,collisionBoxArray:me,partiallyEvaluatedTextSize:Te,partiallyEvaluatedIconSize:Oe,collisionGroup:Le,latestFeatureIndex:Ge}=n.parameters,Ue=D.get("text-optional"),Ze=D.get("icon-optional"),$e=D.get("text-allow-overlap"),Ve=D.get("icon-allow-overlap"),We=D.get("text-rotation-alignment")==="map",yt=D.get("icon-rotation-alignment")==="map",lt=D.get("text-pitch-alignment")==="map",Ot=N.get("symbol-z-offset"),_t=D.get("symbol-elevation-reference")==="sea",It=D.get("symbol-placement"),[ur,xt]=D.get("text-size-scale-range"),[rt,zt]=D.get("icon-size-scale-range"),gt=i.aA(E,ur,xt),Bt=i.aA(E,rt,zt),Gt=D.get("text-variable-anchor"),ar=We&&It!=="point",Ht=yt&&It!=="point",Xt=Gt&&I.hasTextData(),qr=I.hasIconTextFit()&&Xt&&I.hasIconData();this.transform.setProjection(I.projection);const $r=Xt||ar,Yr=Ht||qr;let Lr=$e&&(Ve||!I.hasIconData()||Ze),rn=Ve&&($e||!I.hasTextData()||Ue);const En=!Ot.isConstant();!I.collisionArrays&&me&&I.deserializeCollisionBoxes(me),d&&x&&I.updateCollisionDebugBuffers(this.transform.zoom,me,gt,Bt);const In=(_n,si,xi)=>{const{crossTileID:Ci,numVerticalGlyphVertices:On}=_n;let bi=null;if(Y&&Y.dynamicFilterNeedsFeature||En){const Wo=this.retainedQueryData[I.bucketInstanceId];bi=Ge.loadFeature({featureIndex:_n.featureIndex,bucketIndex:Wo.bucketIndex,sourceLayerIndex:Wo.sourceLayerIndex,layoutVertexArrayOffset:0})}if(Y&&!(0,Y.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},bi,this.retainedQueryData[I.bucketInstanceId].tileID.canonical,new i.P(_n.tileAnchorX,_n.tileAnchorY),this.transform.calculateDistanceTileData(Y.unwrappedTileID)))return this.placements[Ci]=new Kr(!1,!1,!1,!0),void c.add(Ci);const Ai=Ot.evaluate(bi,{});if(c.has(Ci))return;if(Se)return void(this.placements[Ci]=new Kr(!1,!1,!1));let wi=!1,Ji=!1,Vi=!0,ta=!1,so=!1,Pn=null,An={box:null,offscreen:null,occluded:null},zi={box:null},Ho=null,ho=null,sa=null,qo=0,Xl=0,xa=0;xi.textFeatureIndex?qo=xi.textFeatureIndex:_n.useRuntimeCollisionCircles&&(qo=_n.featureIndex),xi.verticalTextFeatureIndex&&(Xl=xi.verticalTextFeatureIndex);const Dl=Wo=>{Wo.tileID=this.retainedQueryData[I.bucketInstanceId].tileID;const jo=this.transform.elevation;Wo.elevation=_t?Ai:Ai+(jo?jo.getAtTileOffset(Wo.tileID,Wo.tileAnchorX,Wo.tileAnchorY):0),Wo.elevation+=_n.zOffset},Ol=xi.textBox;if(Ol){Dl(Ol);const Wo=Do=>{let ba=i.bL.horizontal;if(I.allowVerticalPlacement&&!Do&&this.prevPlacement){const Fa=this.prevPlacement.placedOrientations[Ci];Fa&&(this.placedOrientations[Ci]=Fa,ba=Fa,this.markUsedOrientation(I,ba,_n))}return ba},jo=(Do,ba)=>{if(I.allowVerticalPlacement&&On>0&&xi.verticalTextBox){for(const Fa of I.writingModes)if(Fa===i.bL.vertical?(An=ba(),zi=An):An=Do(),An&&An.box&&An.box.length)break}else An=Do()};if(Gt){let Do=Gt;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ci]){const ra=this.prevPlacement.variableOffsets[Ci];Do.indexOf(ra.anchor)>0&&(Do=Do.filter((us=>us!==ra.anchor)),Do.unshift(ra.anchor))}const ba=(ra,us,xh)=>{const hf=I.getSymbolInstanceTextSize(Te,_n,this.transform.zoom,si),Lu=(ra.x2-ra.x1)*hf+2*ra.padding,ff=(ra.y2-ra.y1)*hf+2*ra.padding,df=_n.hasIconTextFit&&!Ve?us:null;df&&Dl(df);let kl={box:[],offscreen:!1,occluded:!1};const pf=$e?2*Do.length:Do.length;for(let bh=0;bh<pf;++bh){const Bu=this.attemptAnchorPlacement(Do[bh%Do.length],ra,fe,he,$r,Lu,ff,hf,We,lt,se,H,Le,bh>=Do.length,_n,si,I,xh,df,Te,Oe);if(Bu&&(kl=Bu.placedGlyphBoxes,kl&&kl.box&&kl.box.length)){wi=!0,Pn=Bu.shift;break}}return kl};jo((()=>ba(Ol,xi.iconBox,i.bL.horizontal)),(()=>{const ra=xi.verticalTextBox;return ra&&Dl(ra),I.allowVerticalPlacement&&!(An&&An.box&&An.box.length)&&On>0&&ra?ba(ra,xi.verticalIconBox,i.bL.vertical):{box:null,offscreen:null,occluded:null}})),An&&(wi=An.box,Vi=An.offscreen,ta=An.occluded);const Fa=Wo(!(!An||!An.box));if(!wi&&this.prevPlacement){const ra=this.prevPlacement.variableOffsets[Ci];ra&&(this.variableOffsets[Ci]=ra,this.markUsedJustification(I,ra.anchor,_n,Fa))}}else{const Do=(ba,Fa)=>{const ra=I.getSymbolInstanceTextSize(Te,_n,this.transform.zoom,si),us=this.collisionIndex.placeCollisionBox(I,ra,ba,fe,he,$r,new i.P(0,0),$e,se,H,Le.predicate);return us&&us.box&&us.box.length&&(this.markUsedOrientation(I,Fa,_n),this.placedOrientations[Ci]=Fa),us};jo((()=>Do(Ol,i.bL.horizontal)),(()=>{const ba=xi.verticalTextBox;return I.allowVerticalPlacement&&On>0&&ba?(Dl(ba),Do(ba,i.bL.vertical)):{box:null,offscreen:null,occluded:null}})),Wo(!!(An&&An.box&&An.box.length))}}if(Ho=An,wi=Ho&&Ho.box&&Ho.box.length>0,Vi=Ho&&Ho.offscreen,ta=Ho&&Ho.occluded,_n.useRuntimeCollisionCircles){const Wo=I.text.placedSymbolArray.get(_n.centerJustifiedTextSymbolIndex>=0?_n.centerJustifiedTextSymbolIndex:_n.verticalPlacedTextSymbolIndex),jo=i.bM(I.textSizeData,Te,Wo),Do=D.get("text-padding");ho=this.collisionIndex.placeCollisionCircles(I,$e,Wo,I.lineVertexArray,I.glyphOffsetArray,jo,H,W,ee,d,lt,Le.predicate,_n.collisionCircleDiameter*jo/i.bX,Do,this.retainedQueryData[I.bucketInstanceId].tileID),wi=$e||ho.circles.length>0&&!ho.collisionDetected,Vi=Vi&&ho.offscreen,ta=ho.occluded}if(xi.iconFeatureIndex&&(xa=xi.iconFeatureIndex),xi.iconBox){const Wo=jo=>{Dl(jo);const Do=_n.hasIconTextFit&&Pn?Ti(Pn.x,Pn.y,We,lt,this.transform.angle):new i.P(0,0),ba=I.getSymbolInstanceIconSize(Oe,this.transform.zoom,_n.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(I,ba,jo,fe,he,Yr,Do,Ve,se,H,Le.predicate)};zi&&zi.box&&zi.box.length&&xi.verticalIconBox?(sa=Wo(xi.verticalIconBox),Ji=sa.box.length>0):(sa=Wo(xi.iconBox),Ji=sa.box.length>0),Vi=Vi&&sa.offscreen,so=sa.occluded}const dl=Ue||_n.numHorizontalGlyphVertices===0&&On===0,Es=Ze||_n.numIconVertices===0;if(dl||Es?Es?dl||(Ji=Ji&&wi):wi=Ji&&wi:Ji=wi=Ji&&wi,wi&&Ho&&Ho.box&&this.collisionIndex.insertCollisionBox(Ho.box,D.get("text-ignore-placement"),I.bucketInstanceId,zi&&zi.box&&Xl?Xl:qo,Le.ID),Ji&&sa&&this.collisionIndex.insertCollisionBox(sa.box,D.get("icon-ignore-placement"),I.bucketInstanceId,xa,Le.ID),ho&&(wi&&this.collisionIndex.insertCollisionCircles(ho.circles,D.get("text-ignore-placement"),I.bucketInstanceId,qo,Le.ID),d)){const Wo=I.bucketInstanceId;let jo=this.collisionCircleArrays[Wo];jo===void 0&&(jo=this.collisionCircleArrays[Wo]=new Di);for(let Do=0;Do<ho.circles.length;Do+=4)jo.circles.push(ho.circles[Do+0]),jo.circles.push(ho.circles[Do+1]),jo.circles.push(ho.circles[Do+2]),jo.circles.push(ho.collisionDetected?1:0)}const Yl=I.projection.name!=="globe";Lr=Lr&&(Yl||!ta),rn=rn&&(Yl||!so),this.placements[Ci]=new Kr(wi||Lr,Ji||rn,Vi||I.justReloaded),c.add(Ci)},ki=this.retainedQueryData[I.bucketInstanceId].tileID;if(I.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(I,ki),I.elevationType==="road"&&I.updateRoadElevation(ki.canonical),I.updateZOffset(),I.sortFeaturesByY){const _n=I.getSortedSymbolIndexes(this.transform.angle);for(let si=_n.length-1;si>=0;--si){const xi=_n[si];In(I.symbolInstances.get(xi),xi,I.collisionArrays[xi])}I.hasAnyZOffset&&i.w(`${I.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(I.hasAnyZOffset){const _n=I.getSortedIndexesByZOffset();for(let si=0;si<_n.length;++si){const xi=_n[si];In(I.symbolInstances.get(xi),xi,I.collisionArrays[xi])}}else for(let _n=n.symbolInstanceStart;_n<n.symbolInstanceEnd;_n++)In(I.symbolInstances.get(_n),_n,I.collisionArrays[_n]);if(d&&I.bucketInstanceId in this.collisionCircleArrays){const _n=this.collisionCircleArrays[I.bucketInstanceId];i.bl(_n.invProjMatrix,H),_n.viewportMatrix=this.collisionIndex.getViewportMatrix()}I.justReloaded=!1}markUsedJustification(n,c,d,x){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:N,crossTileID:H}=d,W=i.c2(c),ee=x===i.bL.vertical?N:W==="left"?E:W==="center"?I:W==="right"?D:-1;E>=0&&(n.text.placedSymbolArray.get(E).crossTileID=ee>=0&&E!==ee?0:H),I>=0&&(n.text.placedSymbolArray.get(I).crossTileID=ee>=0&&I!==ee?0:H),D>=0&&(n.text.placedSymbolArray.get(D).crossTileID=ee>=0&&D!==ee?0:H),N>=0&&(n.text.placedSymbolArray.get(N).crossTileID=ee>=0&&N!==ee?0:H)}markUsedOrientation(n,c,d){const x=c===i.bL.horizontal||c===i.bL.horizontalOnly?c:0,E=c===i.bL.vertical?c:0,{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:H}=d,W=n.text.placedSymbolArray;I>=0&&(W.get(I).placedOrientation=x),D>=0&&(W.get(D).placedOrientation=x),N>=0&&(W.get(N).placedOrientation=x),H>=0&&(W.get(H).placedOrientation=E)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let d=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const x=c?c.symbolFadeChange(n):1,E=c?c.opacities:{},I=c?c.variableOffsets:{},D=c?c.placedOrientations:{};for(const N in this.placements){const H=this.placements[N],W=E[N];W?(this.opacities[N]=new ul(W,x,H.text,H.icon,null,H.clipped),d=d||H.text!==W.text.placed||H.icon!==W.icon.placed):(this.opacities[N]=new ul(null,x,H.text,H.icon,H.skipFade,H.clipped),d=d||H.text||H.icon)}for(const N in E){const H=E[N];if(!this.opacities[N]){const W=new ul(H,x,!1,!1);W.isHidden()||(this.opacities[N]=W,d=d||H.text.placed||H.icon.placed)}}for(const N in I)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=I[N]);for(const N in D)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=D[N]);d?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:n)}updateLayerOpacities(n,c,d,x){const E=new Set;for(const I of c){const D=I.getBucket(n);D&&I.latestFeatureIndex&&n.fqid===D.layerIds[0]&&(this.updateBucketOpacities(D,E,I,I.collisionBoxArray,d,x,I.tileID,n.scope),D.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(D,I.tileID),D.elevationType==="road"&&D.updateRoadElevation(I.tileID.canonical),D.updateZOffset())}}updateBucketOpacities(n,c,d,x,E,I,D,N){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const H=n.layers[0].layout,W=n.layers[0].paint,ee=!!n.layers[0].dynamicFilter(),Y=new ul(null,0,!1,!1,!0),se=H.get("text-allow-overlap"),fe=H.get("icon-allow-overlap"),he=H.get("text-variable-anchor"),Se=H.get("text-rotation-alignment")==="map",me=H.get("text-pitch-alignment")==="map",Te=W.get("symbol-z-offset"),Oe=H.get("symbol-elevation-reference")==="sea",Le=!Te.isConstant(),Ge=new ul(null,0,se&&(fe||!n.hasIconData()||H.get("icon-optional")),fe&&(se||!n.hasTextData()||H.get("text-optional")),!0);!n.collisionArrays&&x&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(x);const Ue=($e,Ve,We)=>{for(let yt=0;yt<Ve/4;yt++)$e.opacityVertexArray.emplaceBack(We)};let Ze=0;I&&n.updateReplacement(D,I);for(let $e=0;$e<n.symbolInstances.length;$e++){const Ve=n.symbolInstances.get($e),{numHorizontalGlyphVertices:We,numVerticalGlyphVertices:yt,crossTileID:lt,numIconVertices:Ot,tileAnchorX:_t,tileAnchorY:It}=Ve;let ur=null;const xt=this.retainedQueryData[n.bucketInstanceId];Le&&Ve&&xt&&(ur=d.latestFeatureIndex.loadFeature({featureIndex:Ve.featureIndex,bucketIndex:xt.bucketIndex,sourceLayerIndex:xt.sourceLayerIndex,layoutVertexArrayOffset:0}));const rt=Te.evaluate(ur,{}),zt=c.has(lt);let gt=this.opacities[lt];zt?gt=Y:gt||(gt=Ge,this.opacities[lt]=gt),c.add(lt);const Bt=We>0||yt>0,Gt=Ot>0,ar=this.placedOrientations[lt],Ht=ar===i.bL.vertical,Xt=ar===i.bL.horizontal||ar===i.bL.horizontalOnly;!Bt&&!Gt||gt.isHidden()||Ze++;let qr=!1;if((Bt||Gt)&&I)for(const $r of n.activeReplacements){if(i.bY($r,E,i.bZ.Symbol,N)||$r.min.x>_t||_t>$r.max.x||$r.min.y>It||It>$r.max.y)continue;const Yr=i.b_(_t,It,D.canonical,$r.footprintTileId.canonical);if(qr=i.b$(Yr,$r.footprint),qr)break}if(Bt){const $r=qr?Au:mu(gt.text);Ue(n.text,We,Ht?Au:$r),Ue(n.text,yt,Xt?Au:$r);const Yr=gt.text.isHidden(),{leftJustifiedTextSymbolIndex:Lr,centerJustifiedTextSymbolIndex:rn,rightJustifiedTextSymbolIndex:En,verticalPlacedTextSymbolIndex:In}=Ve,ki=n.text.placedSymbolArray,_n=Yr||Ht?1:0;Lr>=0&&(ki.get(Lr).hidden=_n),rn>=0&&(ki.get(rn).hidden=_n),En>=0&&(ki.get(En).hidden=_n),In>=0&&(ki.get(In).hidden=Yr||Xt?1:0);const si=this.variableOffsets[lt];si&&this.markUsedJustification(n,si.anchor,Ve,ar);const xi=this.placedOrientations[lt];xi&&(this.markUsedJustification(n,"left",Ve,xi),this.markUsedOrientation(n,xi,Ve))}if(Gt){const $r=qr?Au:mu(gt.icon),{placedIconSymbolIndex:Yr,verticalPlacedIconSymbolIndex:Lr}=Ve,rn=n.icon.placedSymbolArray,En=gt.icon.isHidden()?1:0;Yr>=0&&(Ue(n.icon,Ot,Ht?Au:$r),rn.get(Yr).hidden=En),Lr>=0&&(Ue(n.icon,Ve.numVerticalIconVertices,Xt?Au:$r),rn.get(Lr).hidden=En)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const $r=n.collisionArrays[$e];if($r){let Yr=new i.P(0,0),Lr=!0;if($r.textBox||$r.verticalTextBox){if(he){const En=this.variableOffsets[lt];En?(Yr=Bh(En.anchor,En.width,En.height,En.textOffset,En.textScale),Se&&Yr._rotate(me?this.transform.angle:-this.transform.angle)):Lr=!1}ee&&(Lr=!gt.clipped),$r.textBox&&th(n.textCollisionBox.collisionVertexArray,gt.text.placed,!Lr||Ht,rt,Oe,Yr.x,Yr.y),$r.verticalTextBox&&th(n.textCollisionBox.collisionVertexArray,gt.text.placed,!Lr||Xt,rt,Oe,Yr.x,Yr.y)}const rn=Lr&&!!(!Xt&&$r.verticalIconBox);$r.iconBox&&th(n.iconCollisionBox.collisionVertexArray,gt.icon.placed,rn,rt,Oe,Ve.hasIconTextFit?Yr.x:0,Ve.hasIconTextFit?Yr.y:0),$r.verticalIconBox&&th(n.iconCollisionBox.collisionVertexArray,gt.icon.placed,!rn,rt,Oe,Ve.hasIconTextFit?Yr.x:0,Ve.hasIconTextFit?Yr.y:0)}}}if(n.fullyClipped=Ze===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const $e=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=$e.invProjMatrix,n.placementViewportMatrix=$e.viewportMatrix,n.collisionCircleArray=$e.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,c){const d=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*d>n}setStale(){this.stale=!0}}function th(p,n,c,d,x,E,I){p.emplaceBack(n?1:0,c?1:0,E||0,I||0,d,x?1:0),p.emplaceBack(n?1:0,c?1:0,E||0,I||0,d,x?1:0),p.emplaceBack(n?1:0,c?1:0,E||0,I||0,d,x?1:0),p.emplaceBack(n?1:0,c?1:0,E||0,I||0,d,x?1:0)}const _d=Math.pow(2,25),_s=Math.pow(2,24),ma=Math.pow(2,17),op=Math.pow(2,16),yd=Math.pow(2,9),vd=Math.pow(2,8),pu=Math.pow(2,1);function mu(p){if(p.opacity===0&&!p.placed)return 0;if(p.opacity===1&&p.placed)return 4294967295;const n=p.placed?1:0,c=Math.floor(127*p.opacity);return c*_d+n*_s+c*ma+n*op+c*yd+n*vd+c*pu+n}const Au=0;class Fh{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,c,d,x,E,I){const D=this._bucketParts;for(;this._currentTileIndex<n.length;)if(c.getBucketParts(D,x,n[this._currentTileIndex],this._sortAcrossTiles,I),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort(((N,H)=>N.sortKey-H.sortKey)));this._currentPartIndex<D.length;){const N=D[this._currentPartIndex];if(c.placeLayerBucketPart(N,this._seenCrossTileIDs,d,N.symbolInstanceStart===0,I),this._currentPartIndex++,E())return!0}return!1}}class cs{constructor(n,c,d,x,E,I,D,N,H){this.placement=new ip(n,E,I,D,N,H),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(n,c,d,x,E){const I=i.o.now(),D=()=>{const N=i.o.now()-I;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=c[n[this._currentPlacementIndex]],H=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=H)&&(!N.maxzoom||N.maxzoom>H)){const W=N,ee=W.layout.get("symbol-z-elevate"),Y=W.layout.get("symbol-sort-key").constantOr(1)!==void 0,se=W.layout.get("symbol-z-order"),fe=se==="viewport-y"||se==="auto"&&!(se!=="viewport-y"&&Y),he=W.layout.get("text-allow-overlap")||W.layout.get("icon-allow-overlap")||W.layout.get("text-ignore-placement")||W.layout.get("icon-ignore-placement"),Se=fe&&he,me=this._inProgressLayer=this._inProgressLayer||new Fh(W),Te=i.B(N.source,N.scope);if(me.continuePlacement(ee||Se?x[Te]:d[Te],this.placement,this._showCollisionBoxes,N,D,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const ys=512/i.al/2;class Is{constructor(n,c,d){this.tileID=n,this.bucketInstanceId=d,this.index=new i.c3(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=n.canonical.x*i.al,E=n.canonical.y*i.al;for(let I=0;I<c.length;I++){const{key:D,crossTileID:N,tileAnchorX:H,tileAnchorY:W}=c.get(I),ee=Math.floor((x+H)*ys),Y=Math.floor((E+W)*ys);this.index.add(ee,Y),this.keys.push(D),this.crossTileIDs.push(N)}this.index.finish()}findMatches(n,c,d){const x=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),E=ys/Math.pow(2,c.canonical.z-this.tileID.canonical.z),I=c.canonical.x*i.al,D=c.canonical.y*i.al;for(let N=0;N<n.length;N++){const H=n.get(N);if(H.crossTileID)continue;const{key:W,tileAnchorX:ee,tileAnchorY:Y}=H,se=Math.floor((I+ee)*E),fe=Math.floor((D+Y)*E),he=this.index.range(se-x,fe-x,se+x,fe+x).sort(((Se,me)=>Se-me));for(const Se of he){const me=this.crossTileIDs[Se];if(this.keys[Se]===W&&!d.has(me)){d.add(me),H.crossTileID=me;break}}}}}class gu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Nh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const c=Math.round((n-this.lng)/360);if(c!==0)for(const d in this.indexes){const x=this.indexes[d],E={};for(const I in x){const D=x[I];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+c),E[D.tileID.key]=D}this.indexes[d]=E}this.lng=n}addBucket(n,c,d){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let E=0;E<c.symbolInstances.length;E++)c.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const x=this.usedCrossTileIDs[n.overscaledZ];for(const E in this.indexes){const I=this.indexes[E];if(Number(E)>n.overscaledZ)for(const D in I){const N=I[D];N.tileID.isChildOf(n)&&N.findMatches(c.symbolInstances,n,x)}else{const D=I[n.scaledTo(Number(E)).key];D&&D.findMatches(c.symbolInstances,n,x)}}for(let E=0;E<c.symbolInstances.length;E++){const I=c.symbolInstances.get(E);I.crossTileID||(I.crossTileID=d.generate(),x.add(I.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Is(n,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(n,c){for(const d of c.crossTileIDs)this.usedCrossTileIDs[n].delete(d)}removeStaleBuckets(n){let c=!1;for(const d in this.indexes){const x=this.indexes[d];for(const E in x)n[x[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(d,x[E]),delete x[E],c=!0)}return c}}class Ma{constructor(){this.layerIndexes={},this.crossTileIDs=new gu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,c,d,x){let E=this.layerIndexes[n.fqid];E===void 0&&(E=this.layerIndexes[n.fqid]=new Nh);let I=!1;const D={};x.name!=="globe"&&E.handleWrapJump(d);for(const N of c){const H=N.getBucket(n);H&&n.fqid===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(N.tileID,H,this.crossTileIDs)&&(I=!0),D[H.bucketInstanceId]=!0)}return E.removeStaleBuckets(D)&&(I=!0),I}pruneUnusedLayers(n){const c={};n.forEach((d=>{c[d]=!0}));for(const d in this.layerIndexes)c[d]||delete this.layerIndexes[d]}}const Ps=771;class Mn{constructor(n,c,d,x){this.blendFunction=n,this.blendColor=c.toNonPremultipliedRenderColor(null),this.mask=d,this.blendEquation=x}}Mn.Replace=[1,0,1,0],Mn.disabled=new Mn(Mn.Replace,i.ao.transparent,[!1,!1,!1,!1]),Mn.unblended=new Mn(Mn.Replace,i.ao.transparent,[!0,!0,!0,!0]),Mn.alphaBlended=new Mn([1,Ps,1,Ps],i.ao.transparent,[!0,!0,!0,!0]),Mn.alphaBlendedNonPremultiplied=new Mn([770,Ps,770,Ps],i.ao.transparent,[!0,!0,!0,!0]),Mn.multiply=new Mn([774,0,774,0],i.ao.transparent,[!0,!0,!0,!0]);class Mr{constructor(n,c,d){this.func=n,this.mask=c,this.range=d}}Mr.ReadOnly=!1,Mr.ReadWrite=!0,Mr.disabled=new Mr(519,Mr.ReadOnly,[0,1]);const ac=7680;class cn{constructor(n,c,d,x,E,I){this.test=n,this.ref=c,this.mask=d,this.fail=x,this.depthFail=E,this.pass=I}}cn.disabled=new cn({func:519,mask:0},0,0,ac,ac,ac);const So=1029,_u=2305;class gn{constructor(n,c,d){this.enable=n,this.mode=c,this.frontFace=d}}function xd(p,n){const c=i.c9(p,3);i.cb(p,n),i.cf(p,3,c)}function jh(p,n){const c=i.c6([]);return i.c7(c,c,-n),i.c8(c,c,-p),c}function Uh(p,n){const c=[p[0],p[1],0],d=[n[0],n[1],0];if(i.ag(c)>=1e-15){const I=i.aw([],c);i.c4(d,I,i.bJ(d,I)),n[0]=d[0],n[1]=d[1]}const x=i.bI([],n,p);if(i.c5(x)<1e-15)return null;const E=Math.atan2(-x[1],x[0]);return jh(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),E)}gn.disabled=new gn(!1,So,_u),gn.backCCW=new gn(!0,So,_u),gn.backCW=new gn(!0,So,2304),gn.frontCW=new gn(!0,1028,2304),gn.frontCCW=new gn(!0,1028,_u);class ap{constructor(n,c){this.position=n,this.orientation=c}get position(){return this._position}set position(n){if(n){const c=n instanceof i.ae?n:new i.ae(n[0],n[1],n[2]);this._renderWorldCopies&&(c.x=i.bT(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(n,c){if(this.orientation=null,!this.position)return;const d=this.position,x=this._elevation?this._elevation.getAtPointOrZero(i.ae.fromLngLat(n)):0,E=i.ae.fromLngLat(n,x),I=[E.x-d.x,E.y-d.y,E.z-d.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Uh(I,c)}setPitchBearing(n,c){this.orientation=jh(i.an(n),i.an(-c))}}class bd{constructor(n,c){this._transform=i.bA([]),this.orientation=c,this.position=n}get mercatorPosition(){const n=this.position;return new i.ae(n[0],n[1],n[2])}get position(){const n=i.c9(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var c;n&&i.cf(this._transform,3,[(c=n)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||i.c6([]),n&&xd(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,c){this._orientation=jh(n,c),xd(this._transform,this._orientation)}forward(){const n=i.c9(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=i.c9(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=i.c9(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,c){const d=new Float64Array(16);return i.bl(d,this.getWorldToCamera(n,c)),d}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,c,d){const x=this.position;i.c4(x,x,-n);const E=new Float64Array(16);return i.bq(E,[d,d,d]),i.br(E,E,x),E[10]*=c,E}getWorldToCamera(n,c){const d=new Float64Array(16),x=new Float64Array(4),E=this.position;return i.ca(x,this._orientation),i.c4(E,E,-n),i.cb(d,x),i.br(d,d,E),d[1]*=-1,d[5]*=-1,d[9]*=-1,d[13]*=-1,d[8]*=c,d[9]*=c,d[10]*=c,d[11]*=c,d}getCameraToClipPerspective(n,c,d,x){const E=new Float64Array(16);return i.cc(E,n,c,d,x),E}getCameraToClipOrthographic(n,c,d,x,E,I){const D=new Float64Array(16);return i.cd(D,n,c,d,x,E,I),D}getDistanceToElevation(n,c=!1){const d=n===0?0:i.ce(n,c?i.a$(this.position[1]):this.position[1]),x=this.forward();return(d-this.position[2])/x[2]}clone(){return new bd([...this.position],[...this.orientation])}}const Ki={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class wd{constructor(n=0,c=0,d=0,x=0){if(isNaN(n)||n<0||isNaN(c)||c<0||isNaN(d)||d<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=c,this.left=d,this.right=x}interpolate(n,c,d){return c.top!=null&&n.top!=null&&(this.top=i.ak(n.top,c.top,d)),c.bottom!=null&&n.bottom!=null&&(this.bottom=i.ak(n.bottom,c.bottom,d)),c.left!=null&&n.left!=null&&(this.left=i.ak(n.left,c.left,d)),c.right!=null&&n.right!=null&&(this.right=i.ak(n.right,c.right,d)),this}getCenter(n,c){const d=i.aA((this.left+n-this.right)/2,0,n),x=i.aA((this.top+c-this.bottom)/2,0,c);return new i.P(d,x)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new wd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Zs=15;class Rs{constructor(n,c,d,x,E,I,D){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=d??0,this._maxPitch=x??60,this.setProjection(I),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new i.aR(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new wd,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new bd,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const n=new Rs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n._allowWorldUnderZoom=this._allowWorldUnderZoom,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Zs}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,c=!1){const d=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||d)&&this._updateCameraOnTerrain(),(n||d)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return i.aH(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=i.cl(this.projectionOptions);const d=this.getProjection(),x=!i.by(c,d);return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.cl({name:"mercator"});const c=n!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.ce(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bT(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const c=-n*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=i.cm(),i.cn(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const c=i.aA(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=i.an(n),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const c=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,c=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!c||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const d=this._elevation;c||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&d.exaggeration()&&this._centerAltitudeValidForExaggeration!==d.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*d.exaggeration(),this._centerAltitudeValidForExaggeration=d.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=d.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const n=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(n)}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],d=this.horizonLineFromTop();let x=0,E=0;for(let I=0;I<c.length;I++){const D=new i.P(c[I][0]*this.width,d+c[I][1]*(this.height-d)),N=n.pointCoordinate(D);if(!N)continue;const H=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);x+=N[3]*H,E+=H}return E===0?NaN:x/E}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),d=this.pixelsPerMeter/this.worldSize*c,x=this._mercatorZfromZoom(n),E=this._mercatorZfromZoom(this._maxZoom),I=Math.max(x-d,E);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let d;d=n.z<this._camera.position[2]?[c.x,c.y,c.z]:[n.x,n.y,n.z];const x=i.ag(i.av([],this._camera.position,d));return i.aA(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let c=!1;if(n.orientation&&!i.co(n.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(n.orientation)),n.position){const d=[n.position.x,n.position.y,n.position.z];i.cp(d,this._camera.position)||(this._setCameraPosition(d),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,c=new ap;return c.position=new i.ae(n[0],n[1],n[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(n){if(!i.cq(n))return!1;i.cr(n,n);const c=i.cs([],[0,0,-1],n),d=i.cs([],[0,-1,0],n);if(d[2]<0)return!1;const x=Uh(c,d);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(n){const c=this.zoomScale(this.minZoom)*this.tileSize,d=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;n[2]=i.aA(n[2],x/d,x/c),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,c,d){this._unmodified=!1,this._edgeInsets.interpolate(n,c,d),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const c=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(n){const c=[new i.ct(0,n)];if(this.renderWorldCopies){const d=this.pointCoordinate(new i.P(0,0)),x=this.pointCoordinate(new i.P(this.width,0)),E=this.pointCoordinate(new i.P(this.width,this.height)),I=this.pointCoordinate(new i.P(0,this.height)),D=Math.floor(Math.min(d.x,x.x,E.x,I.x)),N=Math.floor(Math.max(d.x,x.x,E.x,I.x)),H=1;for(let W=D-H;W<=N+H;W++)W!==0&&c.push(new i.ct(W,n))}return c}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,c,d){let x=[];const E=d!=null,I=!E;if(I&&this.zoom<c||E&&d[0]===0&&d[1]===0)return x;const D=new Set,N=(W,ee,Y,se,fe)=>{const he=i.cX(ee,W,Y,se,fe);D.has(he)||(x.push(new i.aO(W,ee,Y,se,fe)),D.add(he))};for(let W=0;W<n.length;W++){const ee=n[W];if(I&&ee.canonical.z!==c)continue;const Y=ee.canonical,se=ee.overscaledZ,fe=ee.wrap,he=1<<Y.z,Se=Y.x+1<he,me=Y.x>0,Te=Y.y+1<he,Oe=Y.y>0,Le=ee.wrap-(me?0:1),Ge=ee.wrap+(Se?0:1),Ue=me?Y.x-1:he-1,Ze=Se?Y.x+1:0;if(E)d[0]<0?(N(se,Ge,Y.z,Ze,Y.y),d[1]<0&&Te&&(N(se,fe,Y.z,Y.x,Y.y+1),N(se,Ge,Y.z,Ze,Y.y+1)),d[1]>0&&Oe&&(N(se,fe,Y.z,Y.x,Y.y-1),N(se,Ge,Y.z,Ze,Y.y-1))):d[0]>0?(N(se,Le,Y.z,Ue,Y.y),d[1]<0&&Te&&(N(se,fe,Y.z,Y.x,Y.y+1),N(se,Le,Y.z,Ue,Y.y+1)),d[1]>0&&Oe&&(N(se,fe,Y.z,Y.x,Y.y-1),N(se,Le,Y.z,Ue,Y.y-1))):d[1]<0&&Te?N(se,fe,Y.z,Y.x,Y.y+1):Oe&&N(se,fe,Y.z,Y.x,Y.y-1);else{const $e=ee.visibleQuadrants;1&$e&&(N(se,Le,Y.z,Ue,Y.y),Oe&&(N(se,fe,Y.z,Y.x,Y.y-1),N(se,Le,Y.z,Ue,Y.y-1))),2&$e&&(N(se,Ge,Y.z,Ze,Y.y),Oe&&(N(se,fe,Y.z,Y.x,Y.y-1),N(se,Ge,Y.z,Ze,Y.y-1))),4&$e&&(N(se,Le,Y.z,Ue,Y.y),Te&&(N(se,fe,Y.z,Y.x,Y.y+1),N(se,Le,Y.z,Ue,Y.y+1))),8&$e&&(N(se,Ge,Y.z,Ze,Y.y),Te&&(N(se,fe,Y.z,Y.x,Y.y+1),N(se,Ge,Y.z,Ze,Y.y+1)))}}const H=[];for(const W of x)x.some((ee=>W.isChildOf(ee)))||H.push(W);if(x=H.filter((W=>!n.some((ee=>!!(W.overscaledZ<c&&ee.isChildOf(W))||W.equals(ee)||W.isChildOf(ee))))),I){const W=1<<c,ee=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Y=[W*ee.x,W*ee.y],se=4,fe=se*se;x=x.filter((he=>{const Se=he.canonical.x+.5-Y[0],me=he.canonical.y+.5-Y[1];return Se*Se+me*me<fe}))}return x}extendTileCoverToNearPlane(n,c,d){const x=[],E=new Set;for(const Te of n)E.add(Te.key);const I=(Te,Oe,Le,Ge,Ue)=>{const Ze=i.cX(Oe,Te,Le,Ge,Ue);E.has(Ze)||(x.push(new i.aO(Te,Oe,Le,Ge,Ue)),E.add(Ze))},D=n.reduce(((Te,Oe)=>Math.max(Te,Oe.overscaledZ)),d),N=1<<d,H=[new i.P(0,0),new i.P(i.al,0),new i.P(i.al,i.al),new i.P(0,i.al)],W=new i.P(0,0),ee=new i.P(0,0),Y=(Te,Oe)=>{const Le=Math.floor(Te[0]),Ge=Math.floor(Te[1]),Ue=(Te[0]-Le)*i.al,Ze=(Te[1]-Ge)*i.al,$e=Math.floor(Oe[0]),Ve=Math.floor(Oe[1]),We=(Oe[0]-$e)*i.al,yt=(Oe[1]-Ve)*i.al;for(let lt=-1;lt<=1;lt++){const Ot=Le+lt;if(!(Ot<0||Ot>=N)){W.x=Ue-lt*i.al,ee.x=We-(Ot-$e)*i.al;for(let _t=-1;_t<=1;_t++){const It=Ge+_t;W.y=Ze-_t*i.al,ee.y=yt-(It-Ve)*i.al,i.cY(W,ee,H)&&I(D,0,d,Ot,It)}}}},se=c.points,fe=se[i.cu],he=se[i.cv],Se=this._projectToGround(fe,se[i.cw]),me=this._projectToGround(he,se[i.cx]);return Y(fe,Se),Y(he,me),x}_projectToGround(n,c){return i.cy(i.cz(),n,c,n[2]/(n[2]-c[2]))}coveringTiles(n){let c=this.coveringZoomLevel(n);const d=c,x=this.elevation&&this.elevation.exaggeration(),E=x&&!n.isTerrainDEM,I=this.projection.name==="mercator";if(n.minzoom!==void 0&&c<n.minzoom)return[];n.maxzoom!==void 0&&c>n.maxzoom&&(c=n.maxzoom);const D=this.locationCoordinate(this.center),N=this.center.lat,H=1<<c,W=[H*D.x,H*D.y,0],ee=this.projection.name==="globe",Y=!ee,se=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,Y),fe=ee?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),he=H*i.ce(1,this.center.lat),Se=this._camera.position[2]/i.ce(1,this.center.lat),me=[H*fe.x,H*fe.y,Se*(Y?1:he)],Te=ee||x,Oe=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),Le=this.isLODDisabled(!0)?c:0;let Ge;if(this._elevation&&n.isTerrainDEM)Ge=1e4*this._elevation.exaggeration();else if(this._elevation){const rt=this._elevation.getMinMaxForVisibleTiles();Ge=rt?rt.max:this._centerAltitude}else Ge=this._centerAltitude;const Ue=n.isTerrainDEM?-Ge:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ze=this.projection.isReprojectedInTileSpace?i.cB(this):1,$e=rt=>{const gt=new i.ae(rt.x+25e-6,rt.y,rt.z),Bt=new i.ae(rt.x,rt.y+25e-6,rt.z),Gt=rt.toLngLat(),ar=gt.toLngLat(),Ht=Bt.toLngLat(),Xt=this.locationCoordinate(Gt),qr=this.locationCoordinate(ar),$r=this.locationCoordinate(Ht),Yr=Math.hypot(qr.x-Xt.x,qr.y-Xt.y),Lr=Math.hypot($r.x-Xt.x,$r.y-Xt.y);return Math.sqrt(Yr*Lr)*Ze/25e-6},Ve=rt=>{const zt=Ge,gt=Ue;return{aabb:i.cE(this,H,0,0,0,rt,gt,zt,this.projection),zoom:0,x:0,y:0,minZ:gt,maxZ:zt,wrap:rt,fullyVisible:!1}},We=[];let yt=[];const lt=c,Ot=n.reparseOverscaled?d:c,_t=(Se-this._centerAltitude)*he,It=rt=>{if(!this._elevation||!rt.tileID||!I)return;const zt=this._elevation.getMinMaxForTile(rt.tileID),gt=rt.aabb;zt?(gt.min[2]=zt.min,gt.max[2]=zt.max,gt.center[2]=(gt.min[2]+gt.max[2])/2):(rt.shouldSplit=xt(rt),rt.shouldSplit||(gt.min[2]=gt.max[2]=gt.center[2]=this._centerAltitude))},ur=(rt,zt)=>{if(.707*zt<rt)return 1;const gt=zt/rt;return gt/(1.4144271570014144+(Math.pow(1.1,gt-1.4144271570014144+1)-1)/(1.1-1)-1)},xt=rt=>{if(rt.zoom<Le)return!0;if(rt.zoom===lt)return!1;if(rt.shouldSplit!=null)return rt.shouldSplit;const zt=rt.aabb.distanceX(me),gt=rt.aabb.distanceY(me);let Bt=_t,Gt=1;if(ee){Bt=rt.aabb.distanceZ(me);const Lr=Math.pow(2,rt.zoom),rn=i.a$((rt.y+1)/Lr),En=i.a$(rt.y/Lr),In=Math.min(Math.max(N,rn),En),ki=i.d0(In)/i.d0(N);if(Gt=In===N?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,ki/this._mercatorScaleRatio),this.zoom<=i.cZ&&rt.zoom===lt-1&&ki>=.9)return!0}else if(E&&(Bt=rt.aabb.distanceZ(me)*he),this.projection.isReprojectedInTileSpace&&d<=5){const Lr=Math.pow(2,rt.zoom),rn=$e(new i.ae((rt.x+.5)/Lr,(rt.y+.5)/Lr));Gt=rn>.85?1:rn}if(!I){const Lr=Math.sqrt(zt*zt+gt*gt+Bt*Bt);let rn=(1<<lt-rt.zoom)*Oe*Gt;return rn*=ur(Math.max(Bt,_t),Lr),Lr<rn}let ar=Number.MAX_VALUE,Ht=0;const Xt=rt.aabb.getCorners(),qr=[];for(const Lr of Xt){i.av(qr,Lr,me),ee||(E?qr[2]*=he:qr[2]=_t);const rn=i.bJ(qr,this._camera.forward());rn<ar&&(ar=rn,Ht=Math.abs(qr[2]))}let $r=(1<<lt-rt.zoom)*Oe*Gt;if($r*=ur(Math.max(Ht,_t),ar),ar<$r)return!0;const Yr=rt.aabb.closestPoint(W);return Yr[0]===W[0]&&Yr[1]===W[1]};if(this.renderWorldCopies)for(let rt=1;rt<=3;rt++)We.push(Ve(-rt)),We.push(Ve(rt));for(We.push(Ve(0));We.length>0;){const rt=We.pop(),zt=rt.x,gt=rt.y;let Bt=rt.fullyVisible;const Gt=()=>this.projection.name==="globe"&&(rt.y===0||rt.y===(1<<rt.zoom)-1);if(!Bt){let ar=Te?rt.aabb.intersects(se):rt.aabb.intersectsFlat(se);if(ar===0&&Gt()){const Ht=new i.cC(rt.zoom,zt,gt);ar=i.cD(this,H,Ht,!0).intersects(se)}if(ar===0)continue;Bt=ar===2}if(rt.zoom!==lt&&xt(rt))for(let ar=0;ar<4;ar++){const Ht=(zt<<1)+ar%2,Xt=(gt<<1)+(ar>>1),qr={aabb:I?rt.aabb.quadrant(ar):i.cE(this,H,rt.zoom+1,Ht,Xt,rt.wrap,rt.minZ,rt.maxZ,this.projection),zoom:rt.zoom+1,x:Ht,y:Xt,wrap:rt.wrap,fullyVisible:Bt,tileID:void 0,shouldSplit:void 0,minZ:rt.minZ,maxZ:rt.maxZ};E&&!ee&&(qr.tileID=new i.aO(rt.zoom+1===lt?Ot:rt.zoom+1,rt.wrap,rt.zoom+1,Ht,Xt),It(qr)),We.push(qr)}else{const ar=rt.zoom===lt?Ot:rt.zoom;if(n.minzoom&&n.minzoom>ar)continue;let Ht=0;if(!Bt){let Yr=Te?rt.aabb.intersectsPrecise(se):rt.aabb.intersectsPreciseFlat(se);if(Yr===0&&Gt()){const Lr=new i.cC(rt.zoom,zt,gt);Yr=i.cD(this,H,Lr,!0).intersectsPrecise(se)}if(Yr===0)continue;if(n.calculateQuadrantVisibility)if(se.containsPoint(rt.aabb.center))Ht=15;else for(let Lr=0;Lr<4;Lr++)rt.aabb.quadrant(Lr).intersects(se)!==0&&(Ht|=1<<Lr)}const Xt=W[0]-(.5+zt+(rt.wrap<<rt.zoom))*(1<<c-rt.zoom),qr=W[1]-.5-gt,$r=rt.tileID?rt.tileID:new i.aO(ar,rt.wrap,rt.zoom,zt,gt);n.calculateQuadrantVisibility&&($r.visibleQuadrants=Ht),yt.push({tileID:$r,distanceSq:Xt*Xt+qr*qr})}}if(this.fogCullDistSq){const rt=this.fogCullDistSq,zt=this.horizonLineFromTop();yt=yt.filter((gt=>{const Bt=[0,0,0,1],Gt=[i.al,i.al,0,1],ar=this.calculateFogTileMatrix(gt.tileID.toUnwrapped());i.aC(Bt,Bt,ar),i.aC(Gt,Gt,ar);const Ht=i.cF([],Bt,Gt),Xt=i.cG([],Bt,Gt),qr=i.c_(Ht,Xt);if(qr===0)return!0;let $r=!1;const Yr=this._elevation;if(Yr&&qr>rt&&zt!==0){const Lr=this.calculateProjMatrix(gt.tileID.toUnwrapped());let rn;n.isTerrainDEM||(rn=Yr.getMinMaxForTile(gt.tileID)),rn||(rn={min:Ue,max:Ge});const En=i.cH(this.rotation),In=[En[0]*i.al,En[1]*i.al,rn.max];i.af(In,In,Lr),$r=(1-In[1])*this.height*.5<zt}return qr<rt||$r}))}return yt.sort(((rt,zt)=>rt.distanceSq-zt.distanceSq)).map((rt=>rt.tileID))}resize(n,c){this.width=n,this.height=c,this.pixelsToGLUnits=[2/n,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log2(n)}project(n){const c=i.aA(n.lat,-i.cI,i.cI),d=this.projection.project(n.lng,c);return new i.P(d.x*this.worldSize,d.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.ce(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,c){let d,x;const E=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;d=(c.x-E.x)/D,x=(c.y-E.y)/D}else{const D=this.pointCoordinate(c),N=this.pointCoordinate(E);d=D.x-N.x,x=D.y-N.y}const I=this.locationCoordinate(n);this.setLocation(new i.ae(I.x-d,I.y-x))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n,c){return this.projection.locationPoint(this,n,c)}locationPoint3D(n,c){return this.projection.locationPoint(this,n,c,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n,c){return this.coordinateLocation(this.pointCoordinate3D(n,c))}locationCoordinate(n,c){const d=c?i.ce(c,n.lat):void 0,x=this.projection.project(n.lng,n.lat);return new i.ae(x.x,x.y,d)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,c){const d=c??this._centerAltitude,x=[n.x,n.y,0,1],E=[n.x,n.y,1,1];i.aC(x,x,this.pixelMatrixInverse),i.aC(E,E,this.pixelMatrixInverse);const I=E[3];i.cJ(x,x,1/x[3]),i.cJ(E,E,1/I);const D=x[2],N=E[2];return{p0:x,p1:E,t:D===N?0:(d-D)/(N-D)}}screenPointToMercatorRay(n){const c=[n.x,n.y,0,1],d=[n.x,n.y,1,1];return i.aC(c,c,this.pixelMatrixInverse),i.aC(d,d,this.pixelMatrixInverse),i.cJ(c,c,1/c[3]),i.cJ(d,d,1/d[3]),c[2]=i.ce(c[2],this._center.lat)*this.worldSize,d[2]=i.ce(d[2],this._center.lat)*this.worldSize,i.cJ(c,c,1/this.worldSize),i.cJ(d,d,1/this.worldSize),new i.ax([c[0],c[1],c[2]],i.aw([],i.av([],d,c)))}rayIntersectionCoordinate(n){const{p0:c,p1:d,t:x}=n,E=i.ce(c[2],this._center.lat),I=i.ce(d[2],this._center.lat);return new i.ae(i.ak(c[0],d[0],x)/this.worldSize,i.ak(c[1],d[1],x)/this.worldSize,i.ak(E,I,x))}pointCoordinate(n,c=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,c)}pointCoordinate3D(n,c){if(!this.elevation)return this.pointCoordinate(n,c);let d=this.projection.pointCoordinate3D(this,n.x,n.y);if(d)return new i.ae(d[0],d[1],d[2]);let x=0,E=this.horizonLineFromTop();if(n.y>E)return this.pointCoordinate(n,c);const I=.02*E,D=n.clone();for(let N=0;N<10&&E-x>I;N++){D.y=i.ak(x,E,.66);const H=this.projection.pointCoordinate3D(this,D.x,D.y);H?(E=D.y,d=H):x=D.y}return d?new i.ae(d[0],d[1],d[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=i.cK)return!this.isPointAboveHorizon(n);const c=this.pointCoordinate(n);return c.y>=0&&c.y<=1}_coordinatePoint(n,c){const d=c&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,x=[n.x*this.worldSize,n.y*this.worldSize,d+n.toAltitude(),1];return i.aC(x,x,this.pixelMatrix),x[3]>0?new i.P(x[0]/x[3],x[1]/x[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:c}=this._edgeInsets,d=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,E=this.pointLocation3D(new i.P(c,n)),I=this.pointLocation3D(new i.P(x,n)),D=this.pointLocation3D(new i.P(x,d)),N=this.pointLocation3D(new i.P(c,d));let H=Math.min(E.lng,I.lng,D.lng,N.lng),W=Math.max(E.lng,I.lng,D.lng,N.lng),ee=Math.min(E.lat,I.lat,D.lat,N.lat),Y=Math.max(E.lat,I.lat,D.lat,N.lat);const se=Math.pow(2,-this.zoom)/16*270,fe=this.projection.name==="globe"?1:4,he=(Se,me,Te,Oe,Le)=>{const Ge=(Se+Te)/2,Ue=(me+Oe)/2,Ze=new i.P(Ge,Ue),{lng:$e,lat:Ve}=this.pointLocation3D(Ze),We=Math.max(0,H-$e,ee-Ve,$e-W,Ve-Y);H=Math.min(H,$e),W=Math.max(W,$e),ee=Math.min(ee,Ve),Y=Math.max(Y,Ve),(Le<fe||We>se)&&(he(Se,me,Ge,Ue,Le+1),he(Ge,Ue,Te,Oe,Le+1))};if(he(c,n,x,n,1),he(x,n,x,d,1),he(x,d,c,d,1),he(c,d,c,n,1),this.projection.name==="globe"){const[Se,me]=i.cL(this);Se?(Y=90,W=180,H=-180):me&&(ee=-90,W=180,H=-180)}return new i.aI(new i.aR(H,ee),new i.aR(W,Y))}_getBoundsRectangular(n,c){const{top:d,left:x}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,D=new i.P(x,d),N=new i.P(I,d),H=new i.P(I,E),W=new i.P(x,E);let ee=this.pointCoordinate(D,n),Y=this.pointCoordinate(N,n);const se=this.pointCoordinate(H,c),fe=this.pointCoordinate(W,c),he=(Se,me)=>(me.y-Se.y)/(me.x-Se.x);return ee.y>1&&Y.y>=0?ee=new i.ae((1-fe.y)/he(fe,ee)+fe.x,1):ee.y<0&&Y.y<=1&&(ee=new i.ae(-fe.y/he(fe,ee)+fe.x,0)),Y.y>1&&ee.y>=0?Y=new i.ae((1-se.y)/he(se,Y)+se.x,1):Y.y<0&&ee.y<=1&&(Y=new i.ae(-se.y/he(se,Y)+se.x,0)),new i.aI().extend(this.coordinateLocation(ee)).extend(this.coordinateLocation(Y)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(se))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=n.visibleDemTiles.reduce(((d,x)=>{if(x.dem){const E=x.dem.tree;d.min=Math.min(d.min,E.minimums[0]),d.max=Math.max(d.max,E.maximums[0])}return d}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*n.exaggeration(),c.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,d=this.height/2-c*(1-this._horizonShift);return n?Math.max(0,d):d}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-i.cI,this.maxLat=i.cI,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.aF(this.minLng)*this.tileSize,this.worldMaxX=i.aF(this.maxLng)*this.tileSize,this.worldMinY=i.aJ(this.maxLat)*this.tileSize,this.worldMaxY=i.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,c){return this.projection.createTileMatrix(this,c,n)}calculateDistanceTileData(n){const c=n.key,d=this._distanceTileDataCache;if(d[c])return d[c];const x=n.canonical,E=1/this.height,I=this.cameraWorldSize,D=I/this.zoomScale(x.z),N=(x.x+Math.pow(2,x.z)*n.wrap)*D,H=x.y*D,W=this.point;W.x*=I/this.worldSize,W.y*=I/this.worldSize;const ee=this.angle,Y=Math.sin(-ee),se=-Math.cos(-ee);return d[c]={bearing:[Y,se],center:[(W.x-N)*E,(W.y-H)*E],scale:D/i.al*E},d[c]}calculateFogTileMatrix(n){const c=n.key,d=this._fogTileMatrixCache;if(d[c])return d[c];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return i.aB(x,this.worldToFogMatrix,x),d[c]=new Float32Array(x),d[c]}calculateProjMatrix(n,c=!1,d=!1){const x=n.key;let E;if(E=d?this._expandedProjMatrixCache:c?this._alignedProjMatrixCache:this._projMatrixCache,E[x])return E[x];const I=this.calculatePosMatrix(n,this.worldSize);let D;return D=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:d?this.expandedFarZProjMatrix:c?this.alignedProjMatrix:this.projMatrix,i.aB(I,D,I),E[x]=new Float32Array(I),E[x]}calculatePixelsToTileUnitsMatrix(n){const c=n.tileID.key,d=this._pixelsToTileUnitsCache;if(d[c])return d[c];const x=i.cM(n,this);return d[c]=x,d[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,c=i.bq([],[n,n,n]);return i.aB(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const c=i.ce(1,this._center.lat)*this.worldSize,d=this._computeCameraPosition(c),x=this._camera.forward(),E=i.ce(1,this._center.lat);d[2]/=E,x[2]/=E,i.aw(x,x);const I=n.raycast(d,x,n.exaggeration());if(I){const D=i.bH([],d,x,I),N=new i.ae(D[0],D[1],i.ce(D[2],i.a$(D[1]))),H=(N.z+i.ag([N.x-d[0],N.y-d[1],N.z-d[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const c=this._elevation,d=i.ce(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(d),E=c.getAtPointOrZero(new i.ae(...x)),I=this.pixelsPerMeter/this.worldSize*E,D=this._minimumHeightOverTerrain(),N=x[2]-I;if(N<=D)if(N<0||n){const H=this.locationCoordinate(this._center,this._centerAltitude),W=[x[0],x[1],H.z-x[2]],ee=i.ag(W);W[2]-=(D-N)/this._pixelsPerMercatorPixel;const Y=i.ag(W);if(Y===0)return;i.c4(W,W,ee/Y*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],H.z*this._pixelsPerMercatorPixel-W[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const Y=this.center;return Y.lat=i.aA(Y.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(Y.lng=i.aA(Y.lng,this.minLng,this.maxLng)),this.center=Y,void(this._constraining=!1)}const c=this._unmodified,{x:d,y:x}=this.point;let E=0,I=d,D=x;const N=this.width/2,H=this.height/2,W=this.worldMinY*this.scale,ee=this.worldMaxY*this.scale;if(x-H<W&&(D=W+H),x+H>ee&&(D=ee-H),ee-W<this.height&&(E=Math.max(E,this.height/(ee-W)),D=(ee+W)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Y=this.worldMinX*this.scale,se=this.worldMaxX*this.scale,fe=this.worldSize/2-(Y+se)/2;I=(d+fe+this.worldSize)%this.worldSize-fe,I-N<Y&&(I=Y+N),I+N>se&&(I=se-N),se-Y<this.width&&(E=Math.max(E,this.width/(se-Y)),I=(se+Y)/2)}I===d&&D===x||this._allowWorldUnderZoom||(this.center=this.unproject(new i.P(I,D))),E&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,c=this.projection.name==="globe",d=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.ce(1,this.center.lat)/i.ce(1,i.d1));const x=i.cN(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this.projection.zAxisUnit==="meters"?d:1,I=this._camera.getWorldToCamera(this.worldSize,E);let D;const N=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(N[8]=2*-n.x/this.width,N[9]=2*n.y/this.height,this.isOrthographic){let Ve=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),We=Ve*this.aspect,yt=-We,lt=-Ve;We-=n.x,yt-=n.x,Ve+=n.y,lt+=n.y,D=this._camera.getCameraToClipOrthographic(yt,We,lt,Ve,this._nearZ,this._farZ),((Ot,_t,It,ur)=>{for(let xt=0;xt<16;xt++)Ot[xt]=i.ak(_t[xt],It[xt],ur)})(D,D,N,i.c$(this.pitch>=Zs?1:this.pitch/Zs))}else D=N;const H=i.cO([],N,I);let W=i.cO([],D,I);if(this.projection.isReprojectedInTileSpace){const Ve=this.locationCoordinate(this.center),We=i.bA([]);i.br(We,We,[Ve.x*this.worldSize,Ve.y*this.worldSize,0]),i.aB(We,We,i.cP(this)),i.br(We,We,[-Ve.x*this.worldSize,-Ve.y*this.worldSize,0]),i.aB(W,W,We),i.aB(H,H,We),this.inverseAdjustmentMatrix=i.cQ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.cR([],W,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=W,this.invProjMatrix=i.bl(new Float64Array(16),this.projMatrix),c){const Ve=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ve[8]=2*-n.x/this.width,Ve[9]=2*n.y/this.height,this.expandedFarZProjMatrix=i.cO([],Ve,I)}else this.expandedFarZProjMatrix=this.projMatrix;const ee=i.bl([],D);this.frustumCorners=i.cS.fromInvProjectionMatrix(ee,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!c);const Y=new Float32Array(16);i.bA(Y),i.cR(Y,Y,[1,-1,1]),i.cT(Y,Y,this._pitch),i.bB(Y,Y,this.angle);const se=i.cc(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.bz(se);const fe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;se[8]=2*-n.x/this.width,se[9]=2*(n.y+fe)/this.height,this.skyboxMatrix=i.aB(Y,se,Y);const he=this.point,Se=he.x,me=he.y,Te=this.width%2/2,Oe=this.height%2/2,Le=Math.cos(this.angle),Ge=Math.sin(this.angle),Ue=Se-Math.round(Se)+Le*Te+Ge*Oe,Ze=me-Math.round(me)+Le*Oe+Ge*Te,$e=new Float64Array(W);if(i.br($e,$e,[Ue>.5?Ue-1:Ue,Ze>.5?Ze-1:Ze,0]),this.alignedProjMatrix=$e,W=i.bC(),i.cR(W,W,[this.width/2,-this.height/2,1]),i.br(W,W,[1,-1,0]),this.labelPlaneMatrix=W,W=i.bC(),i.cR(W,W,[1,-1,1]),i.br(W,W,[-1,-1,0]),i.cR(W,W,[2/this.width,2/this.height,1]),this.glCoordMatrix=W,this.pixelMatrix=i.aB(new Float64Array(16),this.labelPlaneMatrix,H),this._calcFogMatrices(),this._distanceTileDataCache={},W=i.bl(new Float64Array(16),this.pixelMatrix),!W)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=W,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.cU(this);const Ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.af(Ve,Ve,I),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=W;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,d=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,E=[n,n,c];i.c4(E,E,x),i.c4(d,d,-1),i.cV(d,d,E);const I=i.bC();i.br(I,I,d),i.cR(I,I,E),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,c,x)}_computeCameraPosition(n){const c=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,d=this._camera.forward(),x=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-n/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-d[0]*E,x.y/this.worldSize-d[1]*E,n/this.worldSize*this._centerAltitude-d[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),d=this._camera.position[2],x=n[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(E=Math.min((c-d)/x,1)),this._camera.position=i.bH([],this._camera.position,n,E),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,c=this._camera.forward(),{pitch:d,bearing:x}=this._camera.getPitchBearing(),E=i.ce(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.an(this._maxPitch)),D=Math.max((n[2]-E)/Math.cos(d),I),N=this._zoomFromMercatorZ(D);i.bH(n,n,c,D),this._pitch=i.aA(d,i.an(this.minPitch),i.an(this.maxPitch)),this.angle=i.bT(x,-Math.PI,Math.PI),this._setZoom(i.aA(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.ae(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,n)*this.tileSize))}zoomFromMercatorZAdjusted(n){let c=0,d=i.cK,x=0,E=1/0;for(;d-c>1e-6&&d>c;){const I=c+.5*(d-c),D=this.tileSize*Math.pow(2,I),N=this.getCameraToCenterDistance(this.projection,I,D),H=this.scaleZoom(N/(Math.max(0,n)*this.tileSize)),W=Math.abs(I-H);W<E&&(E=W,x=I),I<H?c=I:d=I}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,c){const d=Math.min(n.x,c.x),x=Math.max(n.x,c.x),E=Math.min(n.y,c.y),I=Math.max(n.y,c.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new i.P(d,E),new i.P(x,I),new i.P(d,I),new i.P(x,E)],N=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const W of D){const ee=this.pointRayIntersection(W);if(ee.t<0)return!0;const Y=this.rayIntersectionCoordinate(ee);if(Y.x<N||Y.y<0||Y.x>H||Y.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.cW(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(n,c){const d=i.ag(i.av([],this._camera.position,n)),x=this._zoomFromMercatorZ(d)+c;return d-this._mercatorZfromZoom(x)}getCameraPoint(){if(this.projection.name==="globe"){const n=(function([c,d,x],E){const I=[c,d,x,1];i.aC(I,I,E);const D=I[3]=Math.max(I[3],1e-6);return I[0]/=D,I[1]/=D,I[2]/=D,I})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,n))}}getCameraToCenterDistance(n,c=this.zoom,d=this.worldSize){const x=i.cN(n,c,this.width,this.height,1024),E=n.pixelSpaceConversion(this.center.lat,d,x);let I=.5/Math.tan(.5*this._fov)*this.height*E;return this.isOrthographic&&(I=i.ak(1,I,i.c$(this.pitch>=Zs?1:this.pitch/Zs))),I}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.aB(n,n,this.globeMatrix),n}getFrustum(n){return i.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const Ec=(p,n)=>{if(n>0&&p.terrain&&i.w("Cutoff is currently disabled on terrain"),n<=0||p.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const c=p.transform,d=Math.max(Math.abs(c._zoom-(p.minCutoffZoom-1)),1),x=c.isLODDisabled(!1)?i.ah(60,45,c.pitch):i.ah(30,15,c.pitch),E=c._farZ-c._nearZ,I=n*c.height,D=((1-(N=x))*c.cameraToCenterDistance+N*(c._farZ+I))*d;var N;return{shouldRenderCutoff:x<1,uniformValues:{u_cutoff_params:[c._nearZ,c._farZ,(D-c._nearZ)/E,(D-I-c._nearZ)/E]}}},Ja={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class ua{constructor(n,c){this.aabb=n,this.lastCascade=c}}class sc{add(n,c){const d=this.receivers[n.key];d!==void 0?(d.aabb.min[0]=Math.min(d.aabb.min[0],c.min[0]),d.aabb.min[1]=Math.min(d.aabb.min[1],c.min[1]),d.aabb.min[2]=Math.min(d.aabb.min[2],c.min[2]),d.aabb.max[0]=Math.max(d.aabb.max[0],c.max[0]),d.aabb.max[1]=Math.max(d.aabb.max[1],c.max[1]),d.aabb.max[2]=Math.max(d.aabb.max[2],c.max[2])):this.receivers[n.key]=new ua(c,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,c,d){const x=i.d8.fromPoints(n.points);let E=0;for(const I in this.receivers){const D=this.receivers[I];if(!D||!x.intersectsAabb(D.aabb))continue;D.aabb.min=x.closestPoint(D.aabb.min),D.aabb.max=x.closestPoint(D.aabb.max);const N=D.aabb.getCorners();for(let H=0;H<d.length;H++){let W=!0;for(const ee of N){const Y=[ee[0]*c,ee[1]*c,ee[2]];if(i.af(Y,Y,d[H].matrix),Y[0]<-1||Y[0]>1||Y[1]<-1||Y[1]>1){W=!1;break}}if(D.lastCascade=H,E=Math.max(E,H),W)break}}return E+1}}class sp{constructor(n){this.painter=n,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new sc,this._depthMode=new Mr(n.context.gl.LEQUAL,Mr.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,n.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),n.tp.registerParameter(Ja,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),n.tp.registerParameter(Ja,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),n.tp.registerParameter(Ja,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),n.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,c){const d=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!c||!c.properties)return;const x=c.properties.get("shadow-intensity");if(!c.shadowsEnabled()||x<=0||(this._shadowLayerCount=d.style.order.reduce(((fe,he)=>{const Se=d.style._mergedLayers[he];return fe+(Se.hasShadowPass()&&!Se.isHidden(n.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const E=d.context,I=Ja.shadowMapResolution,D=Ja.shadowMapResolution;if(this._cascades.length===0||Ja.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let fe=0;fe<Ja.cascadeCount;++fe){const he=d._shadowMapDebug,Se=E.gl,me=E.createFramebuffer(I,D,he,"texture"),Te=new i.T(E,{width:I,height:D,data:null},Se.DEPTH_COMPONENT16);if(me.depthAttachment.set(Te.texture),he){const Oe=new i.T(E,{width:I,height:D,data:null},Se.RGBA8);me.colorAttachment.set(Oe.texture)}this._cascades.push({framebuffer:me,texture:Te,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.cA,scale:0})}}this.shadowDirection=Sl(c);let N=0;if(n.elevation){const fe=n.elevation,he=[1e4,-1e4];fe.visibleDemTiles.filter((Se=>Se.dem)).forEach((Se=>{const me=Se.dem.tree;he[0]=Math.min(he[0],me.minimums[0]),he[1]=Math.max(he[1],me.maximums[0])})),he[0]!==1e4&&(N=(he[1]-he[0])*fe.exaggeration())}const H=1.5*n.cameraToCenterDistance,W=3*H,ee=new Float64Array(16);for(let fe=0;fe<this._cascades.length;++fe){const he=this._cascades[fe];let Se=n.height/50,me=1;Ja.cascadeCount===1?me=W:fe===0?me=H:(Se=H,me=W);const[Te,Oe]=em(n,this.shadowDirection,Se,me,Ja.shadowMapResolution,N);he.scale=n.scale,he.matrix=Te,he.boundingSphereRadius=Oe,i.bl(ee,he.matrix),he.frustum=i.cA.fromInvProjectionMatrix(ee,1,0,!0),he.far=me}const Y=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[Y].far,this._cascades[Y].far],this._uniformValues.u_shadow_intensity=x,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Ja.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Ja.shadowMapResolution,this._uniformValues.u_shadowmap_0=Ki.ShadowMap0,this._uniformValues.u_shadowmap_1=Ki.ShadowMap0+1,this._groundShadowTiles=d.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const se=d.transform.elevation;for(const fe of this._groundShadowTiles){let he={min:0,max:0};if(se){const Se=se.getMinMaxForTile(fe);Se&&(he=Se)}this.addShadowReceiver(fe.toUnwrapped(),he.min,he.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,c){if(!this.enabled)return;const d=this.painter,x=d.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(d.transform.getFrustum(0),d.transform.worldSize,this._cascades),x.viewport.set([0,0,Ja.shadowMapResolution,Ja.shadowMapResolution]);for(let E=0;E<this._numCascadesToRender;++E){d.currentShadowCascade=E,x.bindFramebuffer.set(this._cascades[E].framebuffer.framebuffer),x.clear({color:i.ao.white,depth:1});for(const I of n.order){const D=n._mergedLayers[I];if(!D.hasShadowPass()||D.isHidden(d.transform.zoom))continue;const N=n.getLayerSourceCache(D),H=N?c[N.id]:void 0;(D.type==="model"||H&&H.length)&&d.renderLayer(d,N,D,H)}}d.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,c=n.style,d=n.context,x=d.gl,E=c.directionalLight,I=c.ambientLight;if(!E||!I)return;const D=[],N=Ec(n,n.longestCutoffRange);N.shouldRenderCutoff&&D.push("RENDER_CUTOFF"),D.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&D.push("NORMAL_OFFSET");const H=vs(c,E,I),W=new Mr(x.LEQUAL,Mr.ReadOnly,n.depthRangeFor3D),ee=new cn({func:x.EQUAL,mask:255},0,255,x.KEEP,x.KEEP,x.KEEP);for(const Y of this._groundShadowTiles){const se=Y.toUnwrapped(),fe=n.isTileAffectedByFog(Y),he=n.getOrCreateProgram("groundShadow",{defines:D,overrideFog:fe});this.setupShadows(se,he),n.uploadCommonUniforms(d,he,se,null,N);const Se={u_matrix:n.transform.calculateProjMatrix(se),u_ground_shadow_factor:H};he.draw(n,x.TRIANGLES,W,ee,Mn.multiply,gn.disabled,Se,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,null,n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Mn.unblended:Mn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(n){const c=this.painter.transform,d=c.calculatePosMatrix(n,c.worldSize);return i.aB(d,this._cascades[this.painter.currentShadowCascade].matrix,d),Float32Array.from(d)}calculateShadowPassMatrixFromMatrix(n){return i.aB(n,this._cascades[this.painter.currentShadowCascade].matrix,n),Float32Array.from(n)}setupShadows(n,c,d){if(!this.enabled)return;const x=this.painter.transform,E=this.painter.context,I=E.gl,D=this._uniformValues,N=new Float64Array(16),H=x.calculatePosMatrix(n,x.worldSize);for(let W=0;W<this._cascades.length;W++)i.aB(N,this._cascades[W].matrix,H),D[W===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(N),E.activeTexture.set(I.TEXTURE0+Ki.ShadowMap0+W),this._cascades[W].texture.bindExtraParam(I.LINEAR,I.LINEAR,I.CLAMP_TO_EDGE,I.CLAMP_TO_EDGE,I.GREATER);if(this.useNormalOffset=!!d,this.useNormalOffset){const W=i.d6(n.canonical),ee=2/x.tileSize*i.al/Ja.shadowMapResolution,Y=ee*this._cascades[0].boundingSphereRadius,se=ee*this._cascades[this._cascades.length-1].boundingSphereRadius,fe=(d==="vector-tile"?1:3)*(function(he,Se,me,Te,Oe){const Le=i.aA((he-22)/-22,0,1);return .125*(1-Le)+4*Le})(x.zoom);D.u_shadow_normal_offset=[W,Y*fe,se*fe],D.u_shadow_bias=[1e-4,.0012,.012]}else D.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(E,D)}setupShadowsFromMatrix(n,c,d=!1){if(!this.enabled)return;const x=this.painter.context,E=x.gl,I=this._uniformValues,D=new Float64Array(16);for(let N=0;N<Ja.cascadeCount;N++)i.aB(D,this._cascades[N].matrix,n),I[N===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(D),x.activeTexture.set(E.TEXTURE0+Ki.ShadowMap0+N),this._cascades[N].texture.bindExtraParam(E.LINEAR,E.LINEAR,E.CLAMP_TO_EDGE,E.CLAMP_TO_EDGE,E.GREATER);if(this.useNormalOffset=d,d){const N=Ja.normalOffset;I.u_shadow_normal_offset=[1,N,N],I.u_shadow_bias=[6e-5,.0012,.012]}else I.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(x,I)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,c,d,x){if(x[2]>=0)return{};const E=(function(N,H,W){const ee=W/(1<<N.canonical.z);return new i.d8([N.canonical.x*ee+N.wrap*W,N.canonical.y*ee+N.wrap*W,0],[(N.canonical.x+1)*ee+N.wrap*W,(N.canonical.y+1)*ee+N.wrap*W,H])})(n,c,d).getCorners(),I=c/-x[2];x[0]<0?(i.d7(E[0],E[0],[x[0]*I,0,0]),i.d7(E[3],E[3],[x[0]*I,0,0])):x[0]>0&&(i.d7(E[1],E[1],[x[0]*I,0,0]),i.d7(E[2],E[2],[x[0]*I,0,0])),x[1]<0?(i.d7(E[0],E[0],[0,x[1]*I,0]),i.d7(E[1],E[1],[0,x[1]*I,0])):x[1]>0&&(i.d7(E[2],E[2],[0,x[1]*I,0]),i.d7(E[3],E[3],[0,x[1]*I,0]));const D={};return D.vertices=E,D.planes=[Cc(E[1],E[0],E[4]),Cc(E[2],E[1],E[5]),Cc(E[3],E[2],E[6]),Cc(E[0],E[3],E[7])],D}addShadowReceiver(n,c,d){this._receivers.add(n,i.d8.fromTileIdAndHeight(n,c,d))}getMaxCascadeForTile(n){const c=this._receivers.get(n);return c&&c.lastCascade?c.lastCascade:0}}function Cc(p,n,c){const d=i.av([],c,n),x=i.av([],p,n),E=i.bI([],d,x),I=i.ag(E);return I===0?[0,0,1,0]:(i.c4(E,E,1/I),[E[0],E[1],E[2],-i.bJ(E,n)])}function Sl(p){const n=p.properties.get("direction"),c=i.d3(n.x,n.y,n.z);c[2]=i.aA(c[2],0,75);const d=i.d5([c[0],c[1],c[2]]);return i.d4(d.x,d.y,d.z)}function vs(p,n,c){const d=n.properties.get("color-use-theme")==="none",x=n.properties.get("color"),E=n.properties.get("intensity"),I=n.properties.get("direction"),D=[I.x,I.y,I.z],N=c.properties.get("color-use-theme")==="none",H=c.properties.get("color"),W=c.properties.get("intensity"),ee=Math.max(i.bJ([0,0,1],D),0),Y=[0,0,0];i.c4(Y,H.toPremultipliedRenderColor(N?null:p.getLut(n.scope)).toArray01Linear().slice(0,3),W);const se=[0,0,0];return i.c4(se,x.toPremultipliedRenderColor(d?null:p.getLut(c.scope)).toArray01Linear().slice(0,3),ee*E),i.da([Y[0]>0?Y[0]/(Y[0]+se[0]):0,Y[1]>0?Y[1]/(Y[1]+se[1]):0,Y[2]>0?Y[2]/(Y[2]+se[2]):0])}function em(p,n,c,d,x,E){const I=p.zoom,D=p.scale,N=p.worldSize,H=1/N,W=p.aspect,ee=Math.sqrt(1+W*W)*Math.tan(.5*p.fovX),Y=ee*ee,se=d-c,fe=d+c;let he,Se;Y>se/fe?(he=d,Se=d*ee):(he=.5*fe*(1+Y),Se=.5*Math.sqrt(se*se+2*(d*d+c*c)*Y+fe*fe*Y*Y));const me=p.projection.pixelsPerMeter(p.center.lat,N),Te=p._camera.getCameraToWorldMercator(),Oe=[0,0,-he*H];i.af(Oe,Oe,Te);let Le=Se*H;const Ge=p._edgeInsets;if(!(Ge.left===0&&Ge.top===0&&Ge.right===0&&Ge.bottom===0||Ge.left===Ge.right&&Ge.top===Ge.bottom)){const Bt=p._camera.getWorldToCamera(p.worldSize,p.projection.zAxisUnit==="meters"?me:1),Gt=p._camera.getCameraToClipPerspective(p._fov,p.width/p.height,c,d);Gt[8]=2*-p.centerOffset.x/p.width,Gt[9]=2*p.centerOffset.y/p.height;const ar=new Float64Array(16);i.cO(ar,Gt,Bt);const Ht=new Float64Array(16);i.bl(Ht,ar);const Xt=i.cA.fromInvProjectionMatrix(Ht,N,I,!0);for(const qr of Xt.points){const $r=((Ue=qr)[0]/=D,Ue[1]/=D,Ue[2]=i.ce(Ue[2],p._center.lat),Ue);Le=Math.max(Le,i.c5(i.d9([],Oe,$r)))}}var Ue;Le*=x/(x-1);const Ze=Math.acos(n[2]),$e=Math.atan2(-n[0],-n[1]),Ve=new bd;Ve.position=Oe,Ve.setPitchBearing(Ze,$e);const We=Ve.getWorldToCamera(N,me),yt=Le*N,lt=Math.min(p._mercatorZfromZoom(17)*N*-2,-2*yt),Ot=Ve.getCameraToClipOrthographic(-yt,yt,-yt,yt,lt,(yt+E*me)/n[2]),_t=new Float64Array(16);i.aB(_t,Ot,We);const It=i.d4(Math.floor(1e6*Oe[0])/1e6*N,Math.floor(1e6*Oe[1])/1e6*N,0),ur=.5*x,xt=[0,0,0];i.af(xt,It,_t),i.c4(xt,xt,ur);const rt=[Math.floor(xt[0]),Math.floor(xt[1]),Math.floor(xt[2])],zt=[0,0,0];i.av(zt,xt,rt),i.c4(zt,zt,-1/ur);const gt=new Float64Array(16);return i.bA(gt),i.br(gt,gt,zt),i.aB(_t,gt,_t),[_t,yt]}class Vh extends i.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(n,c){return i.aV(this.requestManager.transformRequest(c,i.R.Model).url).then((d=>{if(!d)return;const x=i.aW(d),E=new i.aX(n,void 0,void 0,x);return E.computeBoundsAndApplyParent(),E})).catch((d=>{if(d&&d.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${n} from ${c}: ${d.message}`)))}))}load(n,c,d={forceReload:!1}){this.models[c]||(this.models[c]={});const x=Object.keys(n),E=[],I=[];for(const D of x){const N=n[D];this.hasURLBeenRequested(N)&&!d.forceReload||(this.modelByURL[N]={modelId:D,scope:c},E.push(this.loadModel(D,N)),I.push(D)),this.models[c][D]||(this.models[c][D]={model:null,numReferences:1})}this.numModelsLoading[c]=(this.numModelsLoading[c]||0)+I.length,Promise.allSettled(E).then((D=>{for(let N=0;N<D.length;N++){const{status:H}=D[N];if(H==="rejected")continue;const{value:W}=D[N];this.models[c][I[N]]||(this.models[c][I[N]]={model:null,numReferences:1}),this.models[c][I[N]].model=W}this.numModelsLoading[c]-=I.length,this.fire(new i.z("data",{dataType:"style"}))})).catch((D=>{this.fire(new i.y(new Error(`Could not load models: ${D.message}`)))}))}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,c,d={exactIdMatch:!1}){return!!(d.exactIdMatch?this.getModel(n,c):this.getModelByURL(this.modelUris[c][n]))}getModel(n,c){return this.models[c]||(this.models[c]={}),this.models[c][n]?this.models[c][n].model:void 0}getModelByURL(n){if(!n)return null;const c=this.modelByURL[n];return c?this.models[c.scope][c.modelId].model:null}hasModelBeenAdded(n,c){return this.models[c]&&this.models[c][n]!==void 0}getModelURIs(n){return this.modelUris[n]||{}}addModel(n,c,d){this.models[d]||(this.models[d]={}),this.modelUris[d]||(this.modelUris[d]={});const x=this.requestManager.normalizeModelURL(c);if((this.hasModel(n,d,{exactIdMatch:!0})||this.hasModelBeenAdded(n,d))&&this.modelUris[d][n]===x)this.models[d][n].numReferences++;else if(this.hasURLBeenRequested(x)){const{scope:E,modelId:I}=this.modelByURL[x];this.models[E][I].numReferences++}else this.modelUris[d][n]=x,this.load({[n]:this.modelUris[d][n]},d)}addModelURLs(n,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});const d=this.modelUris[c];for(const x in n)d[x]=this.requestManager.normalizeModelURL(n[x])}reloadModels(n){this.load(this.modelUris[n],n,{forceReload:!0})}addModelsFromBucket(n,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});const d={};for(const x of n)this.hasModel(x,c,{exactIdMatch:!0})||this.hasURLBeenRequested(x)?this.models[c][x].numReferences++:this.modelUris[c][x]&&!this.hasURLBeenRequested(x)?d[x]=this.modelUris[c][x]:!this.hasURLBeenRequested(x)&&i.db(x,!1)&&(this.modelUris[c][x]=this.requestManager.normalizeModelURL(x),d[x]=this.modelUris[c][x]);this.load(d,c)}hasURLBeenRequested(n){return this.modelByURL[n]!==void 0}removeModel(n,c,d=!1,x=!1){if(this.models[c]&&this.models[c][n]&&(this.models[c][n].numReferences--,this.models[c][n].numReferences===0||x)){const E=this.modelUris[c][n];d||delete this.modelUris[c][n],delete this.modelByURL[E];const I=this.models[c][n].model;if(!I)return;delete this.models[c][n],I.destroy()}}destroy(){for(const n of Object.keys(this.models))for(const c of Object.keys(this.models[n])){const d=this.models[n][c].model;delete this.models[n][c],d&&d.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,c){this.models[c]||(this.models[c]={});for(const d in this.models[c])this.models[c][d].model&&this.models[c][d].model.upload(n.context)}}const $h=new i.a9({data:new i.aa(i.a6.colorTheme.data)});function rh(p){if(!p.metadata||!p.metadata.content_area)return;const n=i.o.devicePixelRatio,{left:c,top:d,width:x,height:E}=p.metadata.content_area,I=c*n,D=d*n;return[I,D,I+x*n,D+E*n]}function nh(p){if(p)return p.map((([n,c])=>[n*i.o.devicePixelRatio,c*i.o.devicePixelRatio]))}class Mc{constructor(n,c,d){this.id=n,this.scope=c,this.sourceCache=d,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(n){this.missingRequests.has(n.name)||this.pendingRequests.has(n.name)||this.pendingRequests.add(n.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const n=new Map;if(!this.sourceCache.loaded())return n;const c=this.sourceCache.getVisibleCoordinates();if(c.length===0)return n;const d=this.sourceCache.getSource();if(!(d instanceof Yu))return n;const x=c.map((I=>this.sourceCache.getTile(I))),E=d.getImages(x,Array.from(this.pendingRequests));for(const[I,D]of E)n.set(i.I.from({name:I,iconsetId:this.id}),D),this.pendingRequests.delete(I);for(const I of this.pendingRequests)this.missingRequests.add(I);return this.pendingRequests.clear(),n}}const Ic=(p,n)=>ce(p,n&&n.filter((c=>c.identifier!=="source.canvas"))),ih=i.aH(oi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),oh=i.aH(oi,["setCenter","setZoom","setBearing","setPitch"]),Pc=new Set(["background","sky","slot","custom"]),ah={version:8,layers:[],sources:{}},Ia={duration:300,delay:0};class Tl extends i.E{constructor(n,c={}){super(),this.map=n,this.scope=c.scope||"",this.globalId=null,this.fragments=[],this.importDepth=c.importDepth||0,this.importsCache=c.importsCache||new Map,this.resolvedImports=c.resolvedImports||new Set,this.transition=Object.assign({},Ia),this._buildingIndex=new zh(this),this.crossTileSymbolIndex=new Ma,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=c.styleChanges||new Zi,this.dispatcher=c.dispatcher?c.dispatcher:new i.D(i.dd(),this),c.imageManager?this.imageManager=c.imageManager:(this.imageManager=new Rn(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=c.glyphManager?c.glyphManager:new i.de(n._requestManager,c.localFontFamily?i.df.all:c.localIdeographFontFamily?i.df.ideographs:i.df.none,c.localFontFamily||c.localIdeographFontFamily),c.modelManager?this.modelManager=c.modelManager:(this.modelManager=new Vh(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=c.configOptions?c.configOptions:new Map,this._configDependentLayers=c.configDependentLayers?c.configDependentLayers:new Set,this._config=c.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:c.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=c.initialConfig,this.dispatcher.broadcast("setReferrer",i.dg());const d=this;this._rtlTextPluginCallback=Tl.registerForPluginStateChange((x=>{d.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},((E,I)=>{if(i.dh(E),I&&I.every((D=>D)))for(const D in d._sourceCaches){const N=d._sourceCaches[D],H=N.getSource().type;H!=="vector"&&H!=="geojson"||N.reload()}}))})),this.on("data",(x=>{if(x.dataType!=="source"||x.sourceDataType!=="metadata")return;const E=this.getOwnSource(x.sourceId);if(E&&E.vectorLayerIds)for(const I in this._layers){const D=this._layers[I];D.source===E.id&&this._validateLayer(D)}}))}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(i.h(n))return n;const c=i.di(n);if(!c.startsWith("http"))try{return new URL(c,location.href).toString()}catch{return c}return c}return`json://${i.dj(JSON.stringify(n))}`}_diffStyle(n,c,d){this.globalId=this._getGlobalId(n);const x=(E,I)=>{try{I(null,this.setState(E,d))}catch(D){I(D,!1)}};if(typeof n=="string"){const E=this.map._requestManager.normalizeStyleURL(n),I=this.map._requestManager.transformRequest(E,i.R.Style);i.m(I,((D,N)=>{D?this.fire(new i.y(D)):N&&x(N,c)}))}else typeof n=="object"&&x(n,c)}loadURL(n,c={}){this.fire(new i.z("dataloading",{dataType:"style"}));const d=typeof c.validate=="boolean"?c.validate:!i.h(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,c.accessToken),this.resolvedImports.add(n);const x=this.importsCache.get(n);if(x)return this._load(x,d);const E=this.map._requestManager.transformRequest(n,i.R.Style);this._request=i.m(E,((I,D)=>{if(this._request=null,I)this.fire(new i.y(I));else if(D)return this.importsCache.set(n,D),this._load(D,d)}))}loadJSON(n,c={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=i.o.frame((()=>{this._request=null,this._load(n,c.validate!==!1)}))}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(ah,!1)}_loadImports(n,c,d){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const x=[];for(const E of n){const I=this._createFragmentStyle(E),D=new Promise((W=>{I.once("style.import.load",W),I.once("error",W)})).then((()=>this.mergeAll()));if(x.push(D),this.resolvedImports.has(E.url)){I.loadEmpty();continue}const N=E.data||this.importsCache.get(E.url);N?(I.loadJSON(N,{validate:c}),this._isInternalStyle(N)&&(I.globalId=null)):E.url?I.loadURL(E.url,{validate:c}):I.loadEmpty();const H={style:I,id:E.id,config:E.config};if(d){const W=this.fragments.findIndex((({id:ee})=>ee===d));this.fragments=this.fragments.slice(0,W).concat(H).concat(this.fragments.slice(W))}else this.fragments.push(H)}return Promise.allSettled(x)}getImportGlobalIds(n=this,c=new Set){for(const d of n.fragments)d.style.globalId&&c.add(d.style.globalId),this.getImportGlobalIds(d.style,c);return[...c.values()]}_createFragmentStyle(n){const c=this.scope?i.B(n.id,this.scope):n.id;let d;const x=this._initialConfig&&this._initialConfig[c];(n.config||x)&&(d=Object.assign({},n.config,x));const E=new Tl(this.map,{scope:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:d,configOptions:this.options,colorThemeOverride:n["color-theme"],configDependentLayers:this._configDependentLayers});return E.setEventedParent(this.map,{style:E}),E}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,c){if(this._isInternalStyle(n)){const E=Object.assign({},ah,{imports:[{id:"basemap",data:n,url:""}]});return void this._load(E,c)}if(this.updateConfig(this._config,n.schema),c&&Ic(this,Gs(n)))return;this._loaded=!0,this.stylesheet=i.dk(n);const d=()=>{for(const N in n.sources)this.addSource(N,n.sources[N],{validate:!1,isInitialLoad:!0});if(n.iconsets)for(const N in n.iconsets)this.addIconset(N,n.iconsets[N]);n.sprite?this._loadIconset(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&n.glyphs&&this.glyphManager.setURL(n.glyphs);const E=$l(this.stylesheet.layers);if(this._order=E.map((N=>N.id)),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const N=this.stylesheet.lights[0];this.light=new Je(N.properties,N.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Je(this.stylesheet.light)),this._layers={};for(const N of E){const H=i.dq(N,this.scope,this._styleColorTheme.lut,this.options);H.configDependencies.size!==0&&this._configDependentLayers.add(H.fqid),H.setEventedParent(this,{layer:{id:H.id}}),this._layers[H.id]=H;const W=this.getOwnLayerSourceCache(H),ee=!!this.directionalLight&&this.directionalLight.shadowsEnabled();W&&H.canCastShadows()&&ee&&(W.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const I=this.stylesheet.terrain;I&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(I,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const D=this.isRootStyle();n.imports?this._loadImports(n.imports,c).then((()=>{this._reloadImports(),this.fire(new i.z(D?"style.load":"style.import.load"))})).catch((N=>{this.fire(new i.y(new Error("Failed to load imports",N))),this.fire(new i.z(D?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new i.z(D?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const x=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(x){const E=this._evaluateColorThemeData(x);this._loadColorTheme(E).then((()=>{d()})).catch((I=>{i.w(`Couldn't load color theme from the stylesheet: ${I}`),d()}))}else this._styleColorTheme.lut=null,d()}isRootStyle(){return this.importDepth===0}mergeAll(){let n,c,d,x,E,I,D,N,H,W;const ee={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((Y=>{if(Y.stylesheet){if(Y.light!=null&&(n=Y.light),Y.stylesheet.lights)for(const se of Y.stylesheet.lights)se.type==="ambient"&&Y.ambientLight!=null&&(c=Y.ambientLight),se.type==="directional"&&Y.directionalLight!=null&&(d=Y.directionalLight);x=this._prioritizeTerrain(x,Y.terrain,Y.stylesheet.terrain),Y.stylesheet.fog&&Y.fog!=null&&(E=Y.fog),Y.stylesheet.snow&&Y.snow!=null&&(I=Y.snow),Y.stylesheet.rain&&Y.rain!=null&&(D=Y.rain),Y.stylesheet.camera!=null&&(W=Y.stylesheet.camera),Y.stylesheet.projection!=null&&(N=Y.stylesheet.projection),Y.stylesheet.transition!=null&&(H=Y.stylesheet.transition),ee[Y.scope]=Y._styleColorTheme}})),this.light=n,this.ambientLight=c,this.directionalLight=d,this.fog=E,this.snow=I,this.rain=D,this._styleColorThemeForScope=ee,x===null?delete this.terrain:this.terrain=x,this.camera=W||{"camera-projection":"perspective"},this.projection=N||{name:"mercator"},this.transition=Object.assign({},Ia,H),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(n){const c=d=>{for(const x of d.fragments)c(x.style);n(d)};c(this)}_prioritizeTerrain(n,c,d){const x=n&&n.drapeRenderMode===0;return d===null?c&&c.drapeRenderMode===0?c:x?n:null:c!=null&&(!n||x||c&&c.drapeRenderMode===1)?c:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((c=>{n=this._prioritizeTerrain(n,c.terrain,c.stylesheet.terrain)})),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle((c=>{c.stylesheet.projection!=null&&(n=c.stylesheet.projection)})),this.projection=n||{name:"mercator"}}mergeSources(){const n={},c={},d={};this.forEachFragmentStyle((x=>{for(const E in x._sourceCaches){const I=i.B(E,x.scope);n[I]=x._sourceCaches[E]}for(const E in x._otherSourceCaches){const I=i.B(E,x.scope);c[I]=x._otherSourceCaches[E]}for(const E in x._symbolSourceCaches){const I=i.B(E,x.scope);d[I]=x._symbolSourceCaches[E]}})),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=c,this._mergedSymbolSourceCaches=d}mergeLayers(){const n={},c=[],d={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((I=>{for(const D of I._order){const N=I._layers[D];if(N.type==="slot"){const H=i.dl(D);if(n[H])continue;n[H]=[]}N.slot&&n[N.slot]?n[N.slot].push(N):c.push(N)}})),this._mergedOrder=[];let x=-1;const E=(I=[])=>{for(const D of I)if(D.type==="slot"){const N=i.dl(D.id);n[N]&&E(n[N]),this._mergedSlots.push(N)}else{const N=i.B(D.id,D.scope);this._mergedOrder.push(N),d[N]=D,D.is3D(!!this.terrain)&&(this._has3DLayers=!0,x=this._mergedOrder.length-1),D.type==="circle"&&(this._hasCircleLayers=!0),D.type==="symbol"&&(this._hasSymbolLayers=!0),D.type==="clip"&&(this._clipLayerPresent=!0)}};if(E(c),this._has3DLayers){const I={};for(let D=0;D<this._mergedOrder.length;++D){const N=this._mergedOrder[D];I[N]=D===x?1:D<x?d[N].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort(((D,N)=>I[D]-I[N]))}this._mergedLayers=d,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?(function(c,d,x,E){const I=Object.assign({},d);for(const N of Object.keys(i.a6.colorTheme))I[N]===void 0&&(I[N]=i.a6.colorTheme[N].default);const D=new i.a8($h,c,new Map(x));return D.setTransitionOrValue(I,x),D.untransitioned().possiblyEvaluate(new i.ac(0,{worldview:void 0}))})(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const c=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((d,x)=>{const E="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void d();let I=n;I.startsWith(E)||(I=E+I);const D=i.I.from("mapbox-reserved-lut"),N=new Image;N.src=I,N.onerror=()=>{this._styleColorTheme.lutLoading=!1,x(new Error("Failed to load image data"))},N.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==c)return void d();this._styleColorTheme.lutLoading=!1;const{width:H,height:W,data:ee}=i.o.getImageData(N);if(W>32)return void x(new Error("The height of the image must be less than or equal to 32 pixels."));if(H!==W*W)return void x(new Error("The width of the image must be equal to the height squared."));this.getImage(D)&&this.removeImage(D),this.addImage(D,{data:new i.q({width:H,height:W},ee),pixelRatio:1,sdf:!1,usvg:!1,version:0});const Y=this.imageManager.getImage(D,this.scope);Y?(this._styleColorTheme.lut={image:Y.data,data:n},d()):x(new Error("Missing LUT image."))}}))}getLut(n){const c=this._styleColorThemeForScope[n];return c?c.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=(function(c,d,x){let E,I,D;const N=i.o.devicePixelRatio>1?"@2x":"";let H=i.m(d.transformRequest(d.normalizeSpriteURL(c,N,".json"),i.R.SpriteJSON),((Y,se)=>{H=null,D||(D=Y,E=se,ee())})),W=i.n(d.transformRequest(d.normalizeSpriteURL(c,N,".png"),i.R.SpriteImage),((Y,se)=>{W=null,D||(D=Y,I=se,ee())}));function ee(){if(D)x(D);else if(E&&I){const Y=i.o.getImageData(I),se={};for(const fe in E){const{width:he,height:Se,x:me,y:Te,sdf:Oe,pixelRatio:Le,stretchX:Ge,stretchY:Ue,content:Ze}=E[fe],$e=new i.q({width:he,height:Se});i.q.copy(Y,$e,{x:me,y:Te},{x:0,y:0},{width:he,height:Se},null),se[fe]={data:$e,pixelRatio:Le!==void 0?Le:1,sdf:Oe!==void 0&&Oe,stretchX:Ge,stretchY:Ue,content:Ze,usvg:!1,version:0}}x(null,se)}}return{cancel(){H&&(H.cancel(),H=null),W&&(W.cancel(),W=null)}}})(n,this.map._requestManager,((c,d)=>{if(this._spriteRequest=null,c)this.fire(new i.y(c));else if(d){const x=new Map;for(const E in d)x.set(i.I.from(E),d[E]);this.addImages(x)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))}))}addIconset(n,c){if(c.type==="sprite")return void this._loadSprite(c.url);const d=this.getOwnSourceCache(c.source);if(!d)return void this.fire(new i.y(new Error(`Source "${c.source}" as specified by iconset "${n}" does not exist and cannot be used as an iconset source`)));const x=d.getSource();if(x.type!=="raster-array")return void this.fire(new i.y(new Error(`Source "${c.source}" as specified by iconset "${n}" is not a "raster-array" source and cannot be used as an iconset source`)));x.partial=!1;const E=new Mc(n,this.scope,d);this.imageManager.addImageProvider(E,this.scope)}removeIconset(n){this.imageManager.removeImageProvider(n,this.scope)}_loadIconset(n){if(!i.h(n)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(n);const c=this.map._spriteFormat==="auto";var d,x;this._spriteRequest=(x=(E,I)=>{if(this._spriteRequest=null,E)c?this._loadSprite(n):this.fire(new i.y(E));else if(I){const D=new Map;for(const N in I)D.set(i.I.from(N),I[N]);this.addImages(D)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bu((d=this.map._requestManager).transformRequest(d.normalizeIconsetURL(n),i.R.Iconset),((E,I)=>{if(E)return void x(E);const D={},N=i.dc(new i.bt(I));for(const H of N.icons){const W={version:1,pixelRatio:i.o.devicePixelRatio,content:rh(H),stretchX:H.metadata?nh(H.metadata.stretch_x_areas):void 0,stretchY:H.metadata?nh(H.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:H};D[H.name]=W}x(null,D)})))}_validateLayer(n){const c=this.getOwnSource(n.source);if(!c)return;const d=n.sourceLayer;d&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(d)===-1)&&this.fire(new i.y(new Error(`Source layer "${d}" does not exist on source "${c.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((n,c)=>{const d=this.fragments[c];return d&&d.style&&(n.data=d.style.serialize()),n}))}_serializeSources(){const n={};for(const c in this._sourceCaches){const d=this._sourceCaches[c].getSource();n[d.id]||(n[d.id]=d.serialize())}return n}_serializeLayers(n){const c=[];for(const d of n){const x=this._layers[d];x&&x.type!=="custom"&&c.push(x.serialize())}return c}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(n){return n?this.order:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const c=this.getOwnLayer(n);if(c)return c;this.fire(new i.y(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const c=this.getOwnSource(n);if(c)return c;this.fire(new i.y(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,c){const d=this.map.painter;if(d)for(let x=n.minzoom||0;x<(n.maxzoom||25.5);x++){const E=n.getProgramIds();if(E)for(const I of E){const D=n.getDefaultProgramParams(I,c.zoom,this._styleColorTheme.lut);D&&(d.style=this,this.fog&&(d._fogVisible=!0,D.overrideFog=!0,d.getOrCreateProgram(I,D)),d._fogVisible=!1,D.overrideFog=!1,d.getOrCreateProgram(I,D),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(D.overrideRtt=!0,d.getOrCreateProgram(I,D)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const c=this.calculateLightsBrightness();n.brightness=c||0,c!==this._brightness&&(this._brightness=c,this.dispatcher.broadcast("setBrightness",c)),n.worldview!==this._worldview&&(this._worldview=n.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const d=this._changes.isDirty();let x=!1;if(this._changes.isDirty()){const D=this._changes.getLayerUpdatesByScope();for(const N in D){const{updatedIds:H,removedIds:W}=D[N];(H||W)&&(this._updateWorkerLayers(N,H,W),x=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this.snow&&this.snow.updateTransitions(n),this.rain&&this.rain.updateTransitions(n),this._changes.reset()}const E={};for(const D in this._mergedSourceCaches){const N=this._mergedSourceCaches[D];E[D]=N.used,N.used=!1,N.tileCoverLift=0}for(const D of this._mergedOrder){const N=this._mergedLayers[D];if(N.recalculate(n,this._availableImages),!N.isHidden(n.zoom)){const H=this.getLayerSourceCache(N);H&&(H.used=!0,H.tileCoverLift=Math.max(H.tileCoverLift,N.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(N,n)})):this.precompilePrograms(N,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&x&&this.mergeLayers();const I=this.imageManager.getPendingImageProviders();for(const D of I)D.sourceCache.used=!0;for(const D in E){const N=this._mergedSourceCaches[D];E[D]!==N.used&&N.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:N.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.snow&&this.snow.recalculate(n),this.rain&&this.rain.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),d&&this.fire(new i.z("data",{dataType:"style"}))}updateImageProviders(){const n=this.imageManager.getPendingImageProviders();for(const c of n){const d=c.resolvePendingRequests(),x=this.getFragmentStyle(c.scope);x&&x.addImages(d)}}_updateTilesForChangedImages(){const n={};for(const c in this._mergedSourceCaches){const d=this._mergedSourceCaches[c].getSource().scope;n[d]=n[d]||this._changes.getUpdatedImages(d),n[d].length!==0&&this._mergedSourceCaches[c].reloadTilesForDependencies(["icons","patterns"],n[d])}for(const c in n)this._changes.resetUpdatedImages(c)}_updateWorkerLayers(n,c,d){const x=this.getFragmentStyle(n);x&&this.dispatcher.broadcast("updateLayers",{layers:c?x._serializeLayers(c):[],scope:n,removedIds:d||[],options:x.options})}setState(n,c){if(this._checkLoaded(),Ic(this,Gs(n)))return!1;(n=i.dk(n)).layers=$l(n.layers);const d=(function(I,D){if(!I)return[{command:oi.setStyle,args:[D]}];let N=[];try{if(!i.by(I.version,D.version))return[{command:oi.setStyle,args:[D]}];if(i.by(I.center,D.center)||N.push({command:oi.setCenter,args:[D.center]}),i.by(I.zoom,D.zoom)||N.push({command:oi.setZoom,args:[D.zoom]}),i.by(I.bearing,D.bearing)||N.push({command:oi.setBearing,args:[D.bearing]}),i.by(I.pitch,D.pitch)||N.push({command:oi.setPitch,args:[D.pitch]}),i.by(I.sprite,D.sprite)||N.push({command:oi.setSprite,args:[D.sprite]}),i.by(I.glyphs,D.glyphs)||N.push({command:oi.setGlyphs,args:[D.glyphs]}),i.by(I.imports,D.imports)||(function(se=[],fe=[],he){fe=fe||[];const Se=(se=se||[]).map(cu),me=fe.map(cu),Te=se.reduce(uu,{}),Oe=fe.reduce(uu,{}),Le=Se.slice();let Ge,Ue,Ze,$e;for(Ge=0,Ue=0;Ge<Se.length;Ge++)Ze=Se[Ge],Oe.hasOwnProperty(Ze)?Ue++:(he.push({command:oi.removeImport,args:[Ze]}),Le.splice(Le.indexOf(Ze,Ue),1));for(Ge=0,Ue=0;Ge<me.length;Ge++)Ze=me[me.length-1-Ge],Le[Le.length-1-Ge]!==Ze&&(Te.hasOwnProperty(Ze)?(he.push({command:oi.removeImport,args:[Ze]}),Le.splice(Le.lastIndexOf(Ze,Le.length-Ue),1)):Ue++,$e=Le[Le.length-Ge],he.push({command:oi.addImport,args:[Oe[Ze],$e]}),Le.splice(Le.length-Ge,0,Ze));for(const Ve of fe){const We=Te[Ve.id];We&&(delete We.data,i.by(We,Ve)||he.push({command:oi.updateImport,args:[Ve.id,Ve]}))}})(I.imports,D.imports,N),i.by(I.transition,D.transition)||N.push({command:oi.setTransition,args:[D.transition]}),i.by(I.light,D.light)||N.push({command:oi.setLight,args:[D.light]}),i.by(I.fog,D.fog)||N.push({command:oi.setFog,args:[D.fog]}),i.by(I.snow,D.snow)||N.push({command:oi.setSnow,args:[D.snow]}),i.by(I.rain,D.rain)||N.push({command:oi.setRain,args:[D.rain]}),i.by(I.projection,D.projection)||N.push({command:oi.setProjection,args:[D.projection]}),i.by(I.lights,D.lights)||N.push({command:oi.setLights,args:[D.lights]}),i.by(I.camera,D.camera)||N.push({command:oi.setCamera,args:[D.camera]}),i.by(I.iconsets,D.iconsets)||(function(se,fe,he){let Se;for(Se in fe=fe||{},se=se||{})se.hasOwnProperty(Se)&&(fe.hasOwnProperty(Se)||he.push({command:oi.removeIconset,args:[Se]}));for(Se in fe){if(!fe.hasOwnProperty(Se))continue;const me=fe[Se];se.hasOwnProperty(Se)?i.by(se[Se],me)||(he.push({command:oi.removeIconset,args:[Se]}),he.push({command:oi.addIconset,args:[Se,me]})):he.push({command:oi.addIconset,args:[Se,me]})}})(I.iconsets,D.iconsets,N),!i.by(I["color-theme"],D["color-theme"]))return[{command:oi.setStyle,args:[D]}];const H={},W=[];(function(se,fe,he,Se){let me;for(me in fe=fe||{},se=se||{})se.hasOwnProperty(me)&&(fe.hasOwnProperty(me)||Sc(me,he,Se));for(me in fe){if(!fe.hasOwnProperty(me))continue;const Te=fe[me];se.hasOwnProperty(me)?i.by(se[me],Te)||(se[me].type==="geojson"&&Te.type==="geojson"&&lu(se,fe,me)?he.push({command:oi.setGeoJSONSourceData,args:[me,Te.data]}):rp(me,fe,he,Se)):wc(me,fe,he)}})(I.sources,D.sources,W,H);const ee=[];I.layers&&I.layers.forEach((se=>{se.source&&H[se.source]?N.push({command:oi.removeLayer,args:[se.id]}):ee.push(se)}));let Y=I.terrain;Y&&H[Y.source]&&(N.push({command:oi.setTerrain,args:[void 0]}),Y=void 0),N=N.concat(W),i.by(Y,D.terrain)||N.push({command:oi.setTerrain,args:[D.terrain]}),(function(se,fe,he){fe=fe||[];const Se=(se=se||[]).map(cu),me=fe.map(cu),Te=se.reduce(uu,{}),Oe=fe.reduce(uu,{}),Le=Se.slice(),Ge=Object.create(null);let Ue,Ze,$e,Ve,We,yt,lt;for(Ue=0,Ze=0;Ue<Se.length;Ue++)$e=Se[Ue],Oe.hasOwnProperty($e)?Ze++:(he.push({command:oi.removeLayer,args:[$e]}),Le.splice(Le.indexOf($e,Ze),1));for(Ue=0,Ze=0;Ue<me.length;Ue++)$e=me[me.length-1-Ue],Le[Le.length-1-Ue]!==$e&&(Te.hasOwnProperty($e)?(he.push({command:oi.removeLayer,args:[$e]}),Le.splice(Le.lastIndexOf($e,Le.length-Ze),1)):Ze++,yt=Le[Le.length-Ue],he.push({command:oi.addLayer,args:[Oe[$e],yt]}),Le.splice(Le.length-Ue,0,$e),Ge[$e]=!0);for(Ue=0;Ue<me.length;Ue++)if($e=me[Ue],Ve=Te[$e],We=Oe[$e],!Ge[$e]&&!i.by(Ve,We))if(i.by(Ve.source,We.source)&&i.by(Ve["source-layer"],We["source-layer"])&&i.by(Ve.type,We.type)){for(lt in oc(Ve.layout,We.layout,he,$e,null,oi.setLayoutProperty),oc(Ve.paint,We.paint,he,$e,null,oi.setPaintProperty),i.by(Ve.slot,We.slot)||he.push({command:oi.setSlot,args:[$e,We.slot]}),i.by(Ve.filter,We.filter)||he.push({command:oi.setFilter,args:[$e,We.filter]}),i.by(Ve.minzoom,We.minzoom)&&i.by(Ve.maxzoom,We.maxzoom)||he.push({command:oi.setLayerZoomRange,args:[$e,We.minzoom,We.maxzoom]}),Ve)Ve.hasOwnProperty(lt)&&lt!=="layout"&&lt!=="paint"&&lt!=="filter"&&lt!=="metadata"&&lt!=="minzoom"&&lt!=="maxzoom"&&lt!=="slot"&&(lt.indexOf("paint.")===0?oc(Ve[lt],We[lt],he,$e,lt.slice(6),oi.setPaintProperty):i.by(Ve[lt],We[lt])||he.push({command:oi.setLayerProperty,args:[$e,lt,We[lt]]}));for(lt in We)We.hasOwnProperty(lt)&&!Ve.hasOwnProperty(lt)&&lt!=="layout"&&lt!=="paint"&&lt!=="filter"&&lt!=="metadata"&&lt!=="minzoom"&&lt!=="maxzoom"&&lt!=="slot"&&(lt.indexOf("paint.")===0?oc(Ve[lt],We[lt],he,$e,lt.slice(6),oi.setPaintProperty):i.by(Ve[lt],We[lt])||he.push({command:oi.setLayerProperty,args:[$e,lt,We[lt]]}))}else he.push({command:oi.removeLayer,args:[$e]}),yt=Le[Le.lastIndexOf($e)+1],he.push({command:oi.addLayer,args:[We,yt]})})(ee,D.layers,N)}catch(H){console.warn("Unable to compute style diff:",H),N=[{command:oi.setStyle,args:[D]}]}return N})(this.serialize(),n).filter((I=>!(I.command in oh)));if(d.length===0)return!1;const x=d.filter((I=>!(I.command in ih)));if(x.length>0)throw new Error(`Unimplemented: ${x.map((I=>I.command)).join(", ")}.`);const E=[];return d.forEach((I=>{E.push(this[I.command](...I.args))})),c&&Promise.all(E).then(c).catch(c),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(n){if(n.size===0)return this;for(const[c,d]of n.entries()){if(this.getImage(c))return this.fire(new i.y(new Error(`An image with the name "${c.name}" already exists.`)));this.imageManager.addImage(c,this.scope,d),this._changes.updateImage(c,this.scope)}return this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this}addImage(n,c){return this.getImage(n)?this.fire(new i.y(new Error(`An image with the name "${n.name}" already exists.`))):(this.imageManager.addImage(n,this.scope,c),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this)}updateImage(n,c,d=!1){this.imageManager.updateImage(n,this.scope,c),d&&(this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})))}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._changes.updateImage(n,this.scope),this._updateWorkerImages(),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(n){return this.modelManager.addModelURLs(n,this.scope),this._updateWorkerModels(),this.fire(new i.z("data",{dataType:"style"})),this}addModel(n,c,d={}){return this._checkLoaded(),this._validate(ze,`models.${n}`,c,null,d)||(this.modelManager.addModel(n,c,this.scope),this.fire(new i.z("data",{dataType:"style"}))),this}hasModel(n){return this.modelManager.hasModel(n,this.scope)}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.scope,!1,!0),this.fire(new i.z("data",{dataType:"style"})),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(n,c,d={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(hd,`sources.${n}`,c,null,d))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const x=Rf(n,c,this.dispatcher,this);x.scope=this.scope,x.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(x.id),source:x.serialize(),sourceId:x.id})));const E=I=>{const D=(I?"symbol:":"other:")+x.id,N=i.B(D,this.scope),H=this._sourceCaches[D]=new ls(N,x,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[x.id]=H,H.onAdd(this.map)};E(!1),c.type!=="vector"&&c.type!=="geojson"||E(!0),x.onAdd&&x.onAdd(this.map),d.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const c=this.getOwnSource(n);if(!c)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===n)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const x=Object.entries(this.stylesheet.iconsets).find((([E,I])=>I.type==="source"&&I.source===n));if(x)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while iconset "${x[0]}" is using it.`)))}const d=this.getOwnSourceCaches(n);for(const x of d){const E=i.dl(x.id);delete this._sourceCaches[E],this._changes.discardSourceCacheUpdate(x.id),x.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,c){this._checkLoaded(),this.getOwnSource(n).setData(c),this._changes.setDirty()}getOwnSource(n){const c=this.getOwnSourceCache(n);return c&&c.getSource()}getOwnSources(){const n=[];for(const c in this._otherSourceCaches){const d=this.getOwnSourceCache(c);d&&n.push(d.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const c in n){const d=n[c]._tiles;for(const x in d){const E=d[x];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const c=this._getTransitionParameters();for(const E of n){if(this._validate(Pf,"lights",E))return;switch(E.type){case"ambient":if(this.ambientLight){const I=this.ambientLight;I.set(E),I.updateTransitions(c)}else this.ambientLight=new ri(E,go||(go=new i.a9({color:new i.aa(i.a6.properties_light_ambient.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const I=this.directionalLight;I.set(E),I.updateTransitions(c)}else this.directionalLight=new ri(E,wo||(wo=new i.a9({direction:new i.ap(i.a6.properties_light_directional.direction),color:new i.aa(i.a6.properties_light_directional.color),"color-use-theme":new i.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.aa(i.a6.properties_light_directional.intensity),"cast-shadows":new i.aa(i.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new i.aa(i.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.aa(i.a6.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const d=Object.assign(c,{worldview:this.map.getWorldview()}),x=new i.ac(this.z||0,d);this.ambientLight&&this.ambientLight.recalculate(x),this.directionalLight&&this.directionalLight.recalculate(x),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,c=this.ambientLight;if(!n||!c)return;const d=Y=>.2126*(Y[0]<=.03928?Y[0]/12.92:Math.pow((Y[0]+.055)/1.055,2.4))+.7152*(Y[1]<=.03928?Y[1]/12.92:Math.pow((Y[1]+.055)/1.055,2.4))+.0722*(Y[2]<=.03928?Y[2]/12.92:Math.pow((Y[2]+.055)/1.055,2.4)),x=n.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),E=n.properties.get("intensity"),I=n.properties.get("direction"),D=1-i.d3(I.x,I.y,I.z)[2]/90,N=d(x)*E*D,H=c.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),W=c.properties.get("intensity"),ee=d(H)*W;return Number(((N+ee)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(n==null||n===""&&this.isRootStyle())return this;if(i.dm(n)){const c=i.dn(n),d=this.fragments.find((({id:E})=>E===c));if(!d)return;const x=i.dl(n);return d.style.getFragmentStyle(x)}{const c=this.fragments.find((({id:d})=>d===n));return c?c.style:void 0}}setFeaturesetSelectors(n){if(!n)return;const c={},d=(x,E="")=>`${x}::${E}`;this._featuresetSelectors={};for(const x in n){const E=this._featuresetSelectors[x]=[];for(const I of n[x].selectors){if(I.featureNamespace){const N=this.getOwnLayer(I.layer);if(!N){i.w(`Layer is undefined for selector: ${I.layer}`);continue}const H=d(N.source,N.sourceLayer);if(H in c&&c[H]!==I.featureNamespace){i.w(`"featureNamespace ${I.featureNamespace} of featureset ${x}'s selector is not associated to the same source, skip this selector`);continue}c[H]=I.featureNamespace}let D;if(I.properties)for(const N in I.properties){const H=i.U(I.properties[N]);H.result==="success"&&(D=D||{},D[N]=H.value)}E.push({layerId:I.layer,namespace:I.featureNamespace,properties:D,uniqueFeatureID:I._uniqueFeatureID})}}}getFeaturesetDescriptors(n){const c=this.getFragmentStyle(n);if(!c||!c.stylesheet.featuresets)return[];const d=[];for(const x in c.stylesheet.featuresets)d.push({featuresetId:x,importId:c.scope?c.scope:void 0});return d}getFeaturesetLayers(n,c){const d=this.getFragmentStyle(c),x=d.stylesheet.featuresets;if(!x||!x[n])return this.fire(new i.y(new Error(`The featureset '${n}' does not exist in the map's style and cannot be queried.`))),[];const E=[];for(const I of x[n].selectors){const D=d.getOwnLayer(I.layer);D&&E.push(D)}return E}getConfigProperty(n,c){const d=this.getFragmentStyle(n);if(!d)return null;const x=i.B(c,d.scope),E=d.options.get(x),I=E?E.value||E.default:null;return I?I.serialize():null}setConfigProperty(n,c,d){const x=this.getFragmentStyle(n);if(!x)return;const E=x.stylesheet.schema;if(!E||!E[c])return;const I=i.U(d);if(I.result!=="success")return void Ic(this,I.value);const D=I.value.expression,N=i.B(c,x.scope),H=x.options.get(N);if(!H)return;let W;const{minValue:ee,maxValue:Y,stepValue:se,type:fe,values:he}=E[c],Se=i.U(E[c].default);Se.result==="success"&&(W=Se.value.expression),W?(this.options.set(N,Object.assign({},H,{value:D,default:W,minValue:ee,maxValue:Y,stepValue:se,type:fe,values:he})),this.updateConfigDependencies(c)):this.fire(new i.y(new Error(`No schema defined for the config option "${c}" in the "${n}" fragment.`)))}getConfig(n){const c=this.getFragmentStyle(n);if(!c)return null;const d=c.stylesheet.schema;if(!d)return null;const x={};for(const E in d){const I=i.B(E,c.scope),D=c.options.get(I),N=D?D.value||D.default:null;x[E]=N?N.serialize():null}return x}setConfig(n,c){const d=this.getFragmentStyle(n);d&&(d.updateConfig(c,d.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const c=this.getFragmentStyle(n);return c?c.stylesheet.schema:null}setSchema(n,c){const d=this.getFragmentStyle(n);d&&(d.stylesheet.schema=c,d.updateConfig(d._config,c),this.updateConfigDependencies())}updateConfig(n,c){if(this._config=n,n||c)if(c)for(const d in c){let x,E;const I=i.U(c[d].default);if(I.result==="success"&&(x=I.value.expression),n&&n[d]!==void 0){const Y=i.U(n[d]);Y.result==="success"&&(E=Y.value.expression)}const{minValue:D,maxValue:N,stepValue:H,type:W,values:ee}=c[d];if(x){const Y=i.B(d,this.scope);this.options.set(Y,{default:x,value:E,minValue:D,maxValue:N,stepValue:H,type:W,values:ee})}else this.fire(new i.y(new Error(`No schema defined for config option "${d}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(n){for(const c of this._configDependentLayers){const d=this.getLayer(c);if(d){if(n&&!d.configDependencies.has(n))continue;d.possiblyEvaluateVisibility(),this._updateLayer(d)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle((c=>{const d=c._styleColorTheme.colorThemeOverride?c._styleColorTheme.colorThemeOverride:c._styleColorTheme.colorTheme;if(d){const x=c._evaluateColorThemeData(d);(!c._styleColorTheme.lut&&x!==""||c._styleColorTheme.lut&&x!==c._styleColorTheme.lut.data)&&c.setColorTheme(d)}})),this._changes.setDirty()}addLayer(n,c,d={}){this._checkLoaded();const x=n.id;if(this._layers[x])return void this.fire(new i.y(new Error(`Layer with id "${x}" already exists on this map`)));let E;if(n.type==="custom"){if(Ic(this,i.dp(n)))return;E=i.dq(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(x,n.source),n=i.dk(n),n=Object.assign(n,{source:x})),this._validate(ut,`layers.${x}`,n,{arrayIndex:-1},d))return;E=i.dq(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(E),E.setEventedParent(this,{layer:{id:x}})}E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid);let I=this._order.length;if(c){const W=this._order.indexOf(c);if(W===-1)return void this.fire(new i.y(new Error(`Layer with id "${c}" does not exist on this map.`)));E.slot===this._layers[c].slot?I=W:i.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(I,0,x),this._layerOrderChanged=!0,this._layers[x]=E;const D=this.getOwnLayerSourceCache(E),N=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&E.canCastShadows()&&N&&(D.castsShadows=!0);const H=this._changes.getRemovedLayer(E);if(H&&E.source&&D&&E.type!=="custom"){this._changes.discardLayerRemoval(E);const W=i.B(E.source,E.scope);H.type!==E.type?this._changes.updateSourceCache(W,"clear"):(this._changes.updateSourceCache(W,"reload"),D.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),E.scope=this.scope,this.mergeLayers()}moveLayer(n,c){this._checkLoaded();const d=this._checkLayer(n);if(!d||n===c)return;const x=this._order.indexOf(n);this._order.splice(x,1);let E=this._order.length;if(c){const I=this._order.indexOf(c);if(I===-1)return void this.fire(new i.y(new Error(`Layer with id "${c}" does not exist on this map.`)));d.slot===this._layers[c].slot?E=I:i.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,n),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(n){this._checkLoaded();const c=this._checkLayer(n);if(!c)return;c.setEventedParent(null);const d=this._order.indexOf(n);this._order.splice(d,1),delete this._layers[n],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(c.fqid),this._changes.removeLayer(c);const x=this.getOwnLayerSourceCache(c);if(x&&x.castsShadows){let E=!1;for(const I in this._layers)if(this._layers[I].source===c.source&&this._layers[I].canCastShadows()){E=!0;break}x.castsShadows=E}c.onRemove&&c.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const c in this._layers)if(this._layers[c].type===n)return!0;return!1}setLayerZoomRange(n,c,d){this._checkLoaded();const x=this._checkLayer(n);x&&(x.minzoom===c&&x.maxzoom===d||(c!=null&&(x.minzoom=c),d!=null&&(x.maxzoom=d),this._updateLayer(x)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,c){this._checkLoaded();const d=this._checkLayer(n);d&&d.slot!==c&&(d.slot=c,this._updateLayer(d))}setFilter(n,c,d={}){this._checkLoaded();const x=this._checkLayer(n);if(x&&!i.by(x.filter,c))return c==null?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(le,`layers.${x.id}.filter`,c,{layerType:x.type},d)||(x.filter=i.dk(c),this._updateLayer(x)))}getFilter(n){const c=this._checkLayer(n);if(c)return i.dk(c.filter)}setLayoutProperty(n,c,d,x={}){this._checkLoaded();const E=this._checkLayer(n);if(E&&!i.by(E.getLayoutProperty(c),d)){if(d!=null&&(!x||x.validate!==!1)&&Ic(E,Me.call(Gs,{key:`layers.${n}.layout.${c}`,layerType:E.type,objectKey:c,value:d,styleSpec:i.a6,style:{glyphs:!0,sprite:!0}})))return;E.setLayoutProperty(c,d),E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid),this._updateLayer(E)}}getLayoutProperty(n,c){const d=this._checkLayer(n);if(d)return d.getLayoutProperty(c)}setPaintProperty(n,c,d,x={}){this._checkLoaded();const E=this._checkLayer(n);if(!E||i.by(E.getPaintProperty(c),d)||d!=null&&(!x||x.validate!==!1)&&Ic(E,ge.call(Gs,{key:`layers.${n}.paint.${c}`,layerType:E.type,objectKey:c,value:d,styleSpec:i.a6})))return;const I=E.setPaintProperty(c,d);E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid),I&&this._updateLayer(E),this._changes.updatePaintProperties(E)}getPaintProperty(n,c){const d=this._checkLayer(n);if(d)return d.getPaintProperty(c)}setFeatureState(n,c){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:N,importId:H}=n.target,W=this.getFragmentStyle(H),ee=W.getFeaturesetLayers(N);for(const{source:Y,sourceLayer:se}of ee)W.setFeatureState({id:n.id,source:Y,sourceLayer:se},c)}else if("layerId"in n.target){const{layerId:N}=n.target,H=this.getLayer(N);this.setFeatureState({id:n.id,source:H.source,sourceLayer:H.sourceLayer},c)}return}const d=n.source,x=n.sourceLayer,E=this._checkSource(d);if(!E)return;const I=E.type;if(I==="geojson"&&x)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(I==="vector"&&!x)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const D=this.getOwnSourceCaches(d);for(const N of D)N.setFeatureState(x,n.id,c)}removeFeatureState(n,c){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:N,importId:H}=n.target,W=this.getFragmentStyle(H),ee=W.getFeaturesetLayers(N);for(const{source:Y,sourceLayer:se}of ee)W.removeFeatureState({id:n.id,source:Y,sourceLayer:se},c)}else if("layerId"in n.target){const{layerId:N}=n.target,H=this.getLayer(N);this.removeFeatureState({id:n.id,source:H.source,sourceLayer:H.sourceLayer},c)}return}const d=n.source,x=this._checkSource(d);if(!x)return;const E=x.type,I=E==="vector"?n.sourceLayer:void 0;if(E==="vector"&&!I)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const D=this.getOwnSourceCaches(d);for(const N of D)N.removeFeatureState(I,n.id,c)}getFeatureState(n){if(this._checkLoaded(),"target"in n){let E;if("featuresetId"in n.target){const{featuresetId:I,importId:D}=n.target,N=this.getFragmentStyle(D),H=N.getFeaturesetLayers(I);for(const{source:W,sourceLayer:ee}of H){const Y=N.getFeatureState({id:n.id,source:W,sourceLayer:ee});if(Y&&!E)E=Y;else if(!i.by(E,Y))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in n.target){const{layerId:I}=n.target,D=this.getLayer(I);E=this.getFeatureState({id:n.id,source:D.source,sourceLayer:D.sourceLayer})}return E}const c=n.source,d=n.sourceLayer,x=this._checkSource(c);if(x){if(x.type!=="vector"||d)return n.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(c)[0].getFeatureState(d,n.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),c=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return i.dr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:c,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(d=>d!==void 0))}_updateFilteredLayers(n){for(const c of Object.values(this._mergedLayers))n(c)&&this._updateLayer(c)}_updateLayer(n){this._changes.updateLayer(n);const c=this.getLayerSourceCache(n),d=i.B(n.source,n.scope),x=this._changes.getUpdatedSourceCaches();n.source&&!x[d]&&c&&c.getSource().type!=="raster"&&(this._changes.updateSourceCache(d,"reload"),c.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const c=D=>this._mergedLayers[D].is3D(!!this.terrain),d=this.order,x={},E=[];for(let D=d.length-1;D>=0;D--){const N=d[D];if(c(N)){x[N]=D;for(const H of n){const W=H[N];if(W)for(const ee of W)E.push(ee)}}}E.sort(((D,N)=>N.intersectionZ-D.intersectionZ));const I=[];for(let D=d.length-1;D>=0;D--){const N=d[D];if(c(N))for(let H=E.length-1;H>=0;H--){const W=E[H].feature;if(W.layer&&x[W.layer.id]<D)break;I.push(W),E.pop()}else for(const H of n){const W=H[N];if(W)for(const ee of W)I.push(ee.feature)}}return I}queryRasterValue(n,c,d){const x=this.getOwnSource(n);return x?x.type!=="raster-array"?(this.fire(new i.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):x.queryRasterArrayValue(c,d):(this.fire(new i.y(new Error(`Source with id "${n}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(n,c,d){let x;c&&!Array.isArray(c)&&c.filter&&(this._validate(le,"queryRenderedFeatures.filter",c.filter,null,c),x=i.b6(c.filter));const E={},I=W=>{if(Pc.has(W.type))return;const ee=this.getOwnLayerSourceCache(W),Y=E[ee.id]=E[ee.id]||{sourceCache:ee,layers:{},has3DLayers:!1};W.is3D(!!this.terrain)&&(Y.has3DLayers=!0),Y.layers[W.fqid]=Y.layers[W.fqid]||{styleLayer:W,targets:[]},Y.layers[W.fqid].targets.push({filter:x})};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const W of c.layers){const ee=this._layers[W];if(!ee)return this.fire(new i.y(new Error(`The layer '${W}' does not exist in the map's style and cannot be queried for features.`))),[];I(ee)}}else for(const W in this._layers)I(this._layers[W]);const D=this._queryRenderedFeatures(n,E,d),N=this._flattenAndSortRenderedFeatures(D),H=[];for(const W of N)i.ds(W.layer.id)===this.scope&&H.push(W);return H}queryRenderedFeatureset(n,c,d){let x;c&&!Array.isArray(c)&&c.filter&&(this._validate(le,"queryRenderedFeatures.filter",c.filter,null,c),x=i.b6(c.filter));const E="mock",I=[];if(c&&c.target)I.push(Object.assign({},c,{targetId:E,filter:x}));else{const W=this.getFeaturesetDescriptors();for(const ee of W)I.push({targetId:E,filter:x,target:ee});for(const{style:ee}of this.fragments){const Y=ee.getFeaturesetDescriptors();for(const se of Y)I.push({targetId:E,filter:x,target:se})}}const D=this.queryRenderedTargets(n,I,d),N=[],H=new Set;for(const W of D)for(const ee of W.variants[E])Ku(ee,W,H)||N.push(new i.dt(W,ee));return N}queryRenderedTargets(n,c,d){const x={},E=(D,N,H,W)=>{const ee=x[N.id]=x[N.id]||{sourceCache:N,layers:{},has3DLayers:!1};if(ee.layers[D.fqid]=ee.layers[D.fqid]||{styleLayer:D,targets:[]},D.is3D(!!this.terrain)&&(ee.has3DLayers=!0),!W)return H.uniqueFeatureID=!1,void ee.layers[D.fqid].targets.push(H);ee.layers[D.fqid].targets.push(Object.assign({},H,{namespace:W.namespace,properties:W.properties,uniqueFeatureID:W.uniqueFeatureID}))};for(const D of c)if("featuresetId"in D.target){const{featuresetId:N,importId:H}=D.target,W=this.getFragmentStyle(H);if(!W||!W._featuresetSelectors)continue;const ee=W._featuresetSelectors[N];if(!ee){this.fire(new i.y(new Error(`The featureset '${N}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const Y of ee){const se=W.getOwnLayer(Y.layerId);se&&!Pc.has(se.type)&&E(se,W.getOwnLayerSourceCache(se),D,Y)}}else if("layerId"in D.target){const{layerId:N}=D.target,H=this.getLayer(N);if(!H||Pc.has(H.type))continue;E(H,this.getLayerSourceCache(H),D)}const I=this._queryRenderedFeatures(n,x,d);return this._flattenAndSortRenderedFeatures(I)}_queryRenderedFeatures(n,c,d){const x=[],E=!!this.map._showQueryGeometry,I=yn.createFromScreenPoints(n,d);for(const D in c){const N=As(I,c[D],this._availableImages,d,E);Object.keys(N).length&&x.push(N)}if(this.placement)for(const D in c){if(!c[D].sourceCache._onlySymbols)continue;const N=Df(I.screenGeometry,c[D],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(N).length&&x.push(N)}return x}querySourceFeatures(n,c){const d=c&&c.filter;d&&this._validate(le,"querySourceFeatures.filter",d,null,c);let x=[];const E=this.getOwnSourceCaches(n);for(const I of E)x=x.concat(Vl(I,c));return x}addSourceType(n,c,d){return Tl.getSourceType(n)?d(new Error(`A source type called "${n}" already exists.`)):(Tl.setSourceType(n,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:c.workerSourceURL},d):d(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,c,d={}){this._checkLoaded();const x=this.light.getLight();let E=!1;for(const D in n)if(!i.by(n[D],x[D])){E=!0;break}if(!E)return;const I=this._getTransitionParameters();this.light.setLight(n,c,d),this.light.updateTransitions(I)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,c=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),c===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let d=n;const x=n.source==null;if(c===1){if(this.disableElevatedTerrain)return;if(typeof d.source=="object"){const D="terrain-dem-src";this.addSource(D,d.source),d=i.dk(d),d=Object.assign(d,{source:D})}const E=Object.assign({},d),I={};if(this.terrain&&x){E.source=this.terrain.get().source;const D=this.terrain?this.getFragmentStyle(this.terrain.scope):null;D&&(I.style=D.serialize())}if(this._validate(rr,"terrain",E,I))return}if(!this.terrain||this.terrain.scope!==this.scope&&!x||this.terrain&&c!==this.terrain.drapeRenderMode){if(!d)return;this._createTerrain(d,c),this.fire(new i.z("data",{dataType:"style"}))}else{const E=this.terrain,I=E.get();for(const D of Object.keys(i.a6.terrain))!d.hasOwnProperty(D)&&i.a6.terrain[D].default&&(d[D]=i.a6.terrain[D].default);for(const D in n)if(!i.by(n[D],I[D])){E.set(n,this.options),this.stylesheet.terrain=n;const N=this._getTransitionParameters({duration:0});E.updateTransitions(N),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const c=this.fog=new Yn(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=c.get();const d=this._getTransitionParameters({duration:0});c.updateTransitions(d)}_createSnow(n){const c=this.snow=new ia(n,this.map.transform,this.scope,this.options);this.stylesheet.snow=c.get();const d=this._getTransitionParameters({duration:0});c.updateTransitions(d)}_createRain(n){const c=this.rain=new Ui(n,this.map.transform,this.scope,this.options);this.stylesheet.rain=c.get();const d=this._getTransitionParameters({duration:0});c.updateTransitions(d)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const n of this.map._markers)n._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog;if(!i.by(c.get(),n)){c.set(n,this.options),this.stylesheet.fog=c.get();const d=this._getTransitionParameters({duration:0});c.updateTransitions(d)}}else this._createFog(n);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(n){if(this._checkLoaded(),!n)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const c=this.snow;if(!i.by(c.get(),n)){c.set(n,this.options),this.stylesheet.snow=c.get();const d=this._getTransitionParameters({duration:0});c.updateTransitions(d)}}else this._createSnow(n);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(n){if(this._checkLoaded(),!n)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const c=this.rain;if(!i.by(c.get(),n)){c.set(n,this.options),this.stylesheet.rain=c.get();const d=this._getTransitionParameters({duration:0});c.updateTransitions(d)}}else this._createRain(n);this._markersNeedUpdate=!0}_reloadColorTheme(){const n=()=>{for(const x in this._layers)this._layers[x].lut=this._styleColorTheme.lut;for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()},c=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!c)return this._styleColorTheme.lut=null,void n();const d=this._evaluateColorThemeData(c);this._loadColorTheme(d).then((()=>{this.fire(new i.z("colorthemeset")),n()})).catch((x=>{i.w(`Couldn't set color theme: ${x}`)}))}setColorTheme(n){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=n,this._reloadColorTheme()}setImportColorTheme(n,c){const d=this.getFragmentStyle(n);d&&(d._styleColorTheme.colorThemeOverride=c,d._reloadColorTheme())}_getTransitionParameters(n){return{now:i.o.now(),transition:Object.assign(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],c=[];for(const d of this._mergedOrder)this.isLayerDraped(this._mergedLayers[d])?n.push(d):c.push(d);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...c)}_createTerrain(n,c){const d=this.terrain=new vt(n,c,this.scope,this.options,this.map.getWorldview());c===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const x=this._getTransitionParameters({duration:0});d.updateTransitions(x)}_force3DLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const c=this._layers[n];c.type==="symbol"&&this._updateLayer(c)}}_validate(n,c,d,x,E={}){if(E&&E.validate===!1)return!1;const I=Object.assign({},this.serialize());return Ic(this,n.call(Gs,Object.assign({key:c,style:I,value:d,styleSpec:i.a6},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.du.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(n){const c=this.getSourceCaches(n);for(const d of c)d.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}clearLayers(){for(const n in this._mergedLayers){const c=this._mergedLayers[n];c._clear&&c._clear()}}reloadSource(n){const c=this.getSourceCaches(n);for(const d of c)d.resume(),d.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle((n=>{n.modelManager.reloadModels(n.scope)}))}updateSources(n){let c;this.directionalLight&&(c=Sl(this.directionalLight));const d=new Set;for(const x in this._mergedLayers){const E=this._mergedLayers[x];E.hasElevation()&&!d.has(E.source)&&d.add(E.source)}for(const x in this._mergedSourceCaches){const E=this._mergedSourceCaches[x],I=d.has(E._source.id);E.update(n,void 0,void 0,c,I)}}_generateCollisionBoxes(){for(const n in this._sourceCaches){const c=this._sourceCaches[n];c.resume(),c.reload()}}_updatePlacement(n,c,d,x,E,I,D=!1){let N=!1,H=!1;const W={},ee={};for(const Y of this._mergedOrder){const se=this._mergedLayers[Y];if(se.type!=="symbol")continue;const fe=i.B(se.source,se.scope);let he=W[fe];if(!he){const me=this.getLayerSourceCache(se);if(!me)continue;const Te=me.getRenderableIds(!0).map((Oe=>me.getTileByID(Oe)));ee[fe]=Te.slice(),he=W[fe]=Te.sort(((Oe,Le)=>Le.tileID.overscaledZ-Oe.tileID.overscaledZ||(Oe.tileID.isLessThan(Le.tileID)?-1:1)))}const Se=this.crossTileSymbolIndex.addLayer(se,he,c.center.lng,c.projection);N=N||Se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),D=D||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(D||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.o.now(),c.zoom))&&(this.pauseablePlacement=new cs(c,this._mergedOrder,D,d,x,E,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,W,ee,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.o.now()),H=!0),N&&this.pauseablePlacement.placement.setStale()),H||N){this._buildingIndex.onNewFrame(c.zoom);for(let Y=0;Y<this._mergedOrder.length;Y++){const se=this._mergedLayers[this._mergedOrder[Y]];if(se.type!=="symbol")continue;const fe=this.isLayerClipped(se);this.placement.updateLayerOpacities(se,W[i.B(se.source,se.scope)],Y,fe?I:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.o.now())}}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,c){this._checkLoaded();const d=this.stylesheet.imports=this.stylesheet.imports||[];if(d.findIndex((({id:E})=>E===n.id))!==-1)return void this.fire(new i.y(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!c)return d.push(n),this._loadImports([n],!0);const x=d.findIndex((({id:E})=>E===c));return x===-1&&this.fire(new i.y(new Error(`Import with id "${c}" does not exist on this map.`))),this.stylesheet.imports=d.slice(0,x).concat(n).concat(d.slice(x)),this._loadImports([n],!0,c)}updateImport(n,c){this._checkLoaded();const d=this.stylesheet.imports||[],x=this.getImportIndex(n);return x===-1?this:typeof c=="string"?(this.setImportUrl(n,c),this):(c.url&&c.url!==d[x].url&&this.setImportUrl(n,c.url),i.by(c.config,d[x].config)||this.setImportConfig(n,c.config,c.data.schema),i.by(c.data,d[x].data)||this.setImportData(n,c.data),this)}moveImport(n,c){this._checkLoaded();let d=this.stylesheet.imports||[];const x=this.getImportIndex(n);if(x===-1)return this;const E=this.getImportIndex(c);if(E===-1)return this;const I=d[x],D=this.fragments[x];return d=d.filter((({id:N})=>N!==n)),this.fragments=this.fragments.filter((({id:N})=>N!==n)),this.stylesheet.imports=d.slice(0,E).concat(I).concat(d.slice(E)),this.fragments=this.fragments.slice(0,E).concat(D).concat(this.fragments.slice(E)),this.mergeLayers(),this}setImportUrl(n,c){this._checkLoaded();const d=this.stylesheet.imports||[],x=this.getImportIndex(n);if(x===-1)return this;d[x].url=c;const E=this.fragments[x];return E.style=this._createFragmentStyle(d[x]),E.style.on("style.import.load",(()=>this.mergeAll())),E.style.loadURL(c),this}setImportData(n,c){this._checkLoaded();const d=this.getImportIndex(n),x=this.stylesheet.imports||[];return d===-1?this:c?(this.fragments[d].style.setState(c),this._reloadImports(),this):(delete x[d].data,this.setImportUrl(n,x[d].url))}setImportConfig(n,c,d){this._checkLoaded();const x=this.getImportIndex(n),E=this.stylesheet.imports||[];if(x===-1)return this;c?E[x].config=c:delete E[x].config;const I=this.fragments[x];d&&I.style.stylesheet&&(I.style.stylesheet.schema=d);const D=I.style.stylesheet&&I.style.stylesheet.schema;return I.config=c,I.style.updateConfig(c,D),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const c=this.stylesheet.imports||[],d=this.getImportIndex(n);d!==-1&&(c.splice(d,1),this.fragments[d].style._remove(),this.fragments.splice(d,1),this._reloadImports())}getImportIndex(n){const c=(this.stylesheet.imports||[]).findIndex((d=>d.id===n));return c===-1&&this.fire(new i.y(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),c}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const c in this._mergedOtherSourceCaches){const d=this._mergedOtherSourceCaches[c];d&&n.push(d.getSource())}return n}getSource(n,c){const d=this.getSourceCache(n,c);return d&&d.getSource()}getLayerSource(n){const c=this.getLayerSourceCache(n);return c&&c.getSource()}getSourceCache(n,c){const d=i.B(n,c);return this._mergedOtherSourceCaches[d]}getLayerSourceCache(n){const c=i.B(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[c]:this._mergedOtherSourceCaches[c]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const c=[];return this._mergedOtherSourceCaches[n]&&c.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&c.push(this._mergedSymbolSourceCaches[n]),c}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const c in n){const d=n[c];d==="reload"?this.reloadSource(c):d==="clear"&&this.clearSource(c)}}updateLayers(n){const c=this._changes.getUpdatedPaintProperties();for(const d of c){const x=this.getLayer(d);x&&x.updateTransitions(n)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(n){this.stylesheet.glyphs=n,this.glyphManager.setURL(n)}getImages(n,c,d){this.imageManager.getImages(c.images,c.scope,d),this._updateTilesForChangedImages();const x=I=>{if(I){const D=c.images.map((N=>i.I.toString(N)));I.setDependencies(c.tileID.key,c.type,D)}},E=i.B(c.source,c.scope);x(this._mergedOtherSourceCaches[E]),x(this._mergedSymbolSourceCaches[E]),c.images.some((I=>I.iconsetId))&&this.fire(new i.z("data",{dataType:"style"}))}rasterizeImages(n,c,d){this.imageManager.rasterizeImages(c,d)}getGlyphs(n,c,d){this.glyphManager.getGlyphs(c.stacks,d)}getResource(n,c,d){return i.dv(c,d)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const c=[];return this._otherSourceCaches[n]&&c.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&c.push(this._symbolSourceCaches[n]),c}_isSourceCacheLoaded(n){const c=this.getOwnSourceCaches(n);return c.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${n}'`))),!1):c.every((d=>d.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,c){if(!this._clipLayerPresent&&n.type!=="fill-extrusion"&&n.type!=="building")return!1;const d=n.type==="fill-extrusion"&&(n.sourceLayer==="building"||n.sourceLayer==="procedural_buildings"),x=n.type==="building";if(n.is3D(!!this.terrain)){if(d||x||c&&c.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((n=>{n.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Tl.getSourceType=function(p){return ru[p]},Tl.setSourceType=function(p,n){ru[p]=n},Tl.registerForPluginStateChange=i.dw;class Gh{execute(n){const c=this._makeBuildingsQueryArea(n),d=this._makeFloorsQueryArea(n),x=n.queryRenderedFeatures(c).reduce(((H,W)=>{const ee=W.properties.id;return W.properties.type!=="building"||H.some((Y=>Y.properties.id===ee))||H.push(W),H}),[]),E=n.queryRenderedFeatures(d).reduce(((H,W)=>{const ee=W.properties.id;return W.properties.type!=="floor"||H.some((Y=>Y.properties.id===ee))||H.push(W),H}),[]),I=[n.getCenter().lng,n.getCenter().lat],D=this._findBuildingAtCenter(I,x),N=x.length>0?x[0]:null;return{floors:E.map((H=>({id:H.properties.id,name:H.properties.name,isDefault:H.properties.is_default,zIndex:H.properties.z_index,connectedFloorIds:H.properties.connected_floor_ids,conflictedFloorIds:H.properties.conflicted_floor_ids,buildingIds:H.properties.building_ids}))),building:D?{id:D.properties.id,name:D.properties.name}:{id:N.properties.id,name:N.properties.name}}}_makeBuildingsQueryArea(n){const c=n.transform.width,d=n.transform.height,x=Math.min(c,d)*(1/8),E=.5*(c-x),I=.5*(d-x);return[new i.P(E,I),new i.P(E+x,I+x)]}_makeFloorsQueryArea(n){const c=n.transform.width,d=n.transform.height;return[new i.P(0,0),new i.P(c,d)]}_findBuildingAtCenter(n,c){for(const d of c)if(d.geometry.type==="Polygon"&&this._pointInPolygon(n,d.geometry.coordinates[0]))return d;return null}_pointInPolygon(n,c){let d=!1;for(let x=0,E=c.length-1;x<c.length;E=x++){const I=c[x][0],D=c[x][1],N=c[E][1];D>n[1]!=N>n[1]&&n[0]<(c[E][0]-I)*(n[1]-D)/(N-D)+I&&(d=!d)}return d}}class tm{constructor(){this._floors=new Map,this._buildings=new Map}append(n){const c=n.building;let d=!1;if(c){const x=c.id;x&&(this._buildings.set(x,c),d||this._buildings.has(x)||(d=!0))}return n.floors.forEach((x=>{const E=x.id;d||this._floors.has(E)||(d=!0),this._floors.set(E,x)})),d}clear(){this._floors.clear(),this._buildings.clear()}getFloors(n=null){const c=Array.from(this._floors.values());return n?c.filter((d=>{const x=d.buildingIds;return!!x&&x.split(";").includes(n)})):c}}class sA{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage=new tm}setIndoorData(n){const c=this._featuresStorage.append(n);return this._selectedBuildingId=n.building?n.building.id:null,c}setFloorId(n){const c=this._selectedFloorId!==n;return c&&(this._selectedFloorId=n),c}getCurrentBuildingSelection(){if(!this._selectedBuildingId)return{selectedFloorId:null,floors:[]};const n=this._featuresStorage.getFloors(this._selectedBuildingId),c=this.getActiveFloors().find((d=>{const x=d.buildingIds;if(!x)return!1;const E=x.split(";");return!!this._selectedBuildingId&&E.includes(this._selectedBuildingId)}));return{selectedFloorId:c?c.id:null,floors:n}}getActiveFloors(n=!1){const c=this._featuresStorage.getFloors(),d=c.find((N=>N.id===this._selectedFloorId)),x=c.filter((N=>N.isDefault===!0));let E=[];if(d)return E=this._calculateCurrentActiveFloors(c,d,x,n),E;if(x.length===0){const N=this._featuresStorage.getFloors(this._selectedBuildingId);E=N.length>0?[N[0]]:[]}else E=x;const I=this._getNonConflictingLastActiveFloors(E),D=[...E,...I];return this._lastActiveFloors=D,D}hasBuildingChanged(n){return this._selectedBuildingId!==(n.building?n.building.id:null)}hasActiveBuilding(){return this._selectedBuildingId!==null}isEmpty(){return this._selectedFloorId===null&&this._selectedBuildingId===null&&this._lastActiveFloors.length===0}_calculateCurrentActiveFloors(n,c,d,x){if(!c)return this._getNonConflictingDefaultFloors(this._lastActiveFloors,d);const E=this._getConnectedFloors(c,n);return x?this._buildExplicitSelectionFloors(c,E,d):this._buildImplicitSelectionFloors(E,d)}_getConnectedFloors(n,c){const d=n.connectedFloorIds;if(!d)return[];const x=new Set(d.split(";"));return c.filter((E=>x.has(E.id)))}_buildExplicitSelectionFloors(n,c,d){const x=[n,...c],E=this._getNonConflictingLastActiveFloors(x),I=[...x,...E],D=this._deduplicateFloors(I),N=this._getConflictingFloorIdsFrom(D),H=d.filter((ee=>!N.has(ee.id))),W=[...D,...H];return this._lastActiveFloors=W,W}_buildImplicitSelectionFloors(n,c){const d=this._getConflictingFloorIdsFrom(this._lastActiveFloors),x=c.filter((I=>!d.has(I.id))),E=this._deduplicateFloors([...this._lastActiveFloors,...x]);return this._lastActiveFloors=E,E}_getNonConflictingDefaultFloors(n,c){const d=this._getConflictingFloorIdsFrom(n),x=c.filter((I=>!d.has(I.id))),E=this._deduplicateFloors([...n,...x]);return this._lastActiveFloors=E,E}_deduplicateFloors(n){const c=new Set;return n.filter((d=>{const x=d.id;return!c.has(x)&&(c.add(x),!0)}))}_getConflictingFloorIdsFrom(n){const c=new Set;return n.forEach((d=>{const x=d.conflictedFloorIds;x&&x.split(";").forEach((E=>c.add(E)))})),c}_getNonConflictingLastActiveFloors(n){if(!this._lastActiveFloors||this._lastActiveFloors.length===0)return[];const c=new Set(n.map((x=>x.id))),d=this._getConflictingFloorIdsFrom(n);return this._lastActiveFloors.filter((x=>{const E=x.id;return!c.has(E)&&!d.has(E)}))}_isFloorConflicted(n,c){const d=n.id;return c.some((x=>{const E=x.conflictedFloorIds;return!!E&&E.split(";").includes(d)}))}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage.clear()}}class Hh extends i.E{constructor(n){super(),i.aY(["_onLoad","_onMove"],this),this._map=n,this._floorSelectionState=new sA,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.off("load",this._onLoad),this._map.off("move",this._onMove),this._map=null,this._floorSelectionState=null}selectFloor(n){this._floorSelectionState.setFloorId(n)&&this._updateIndoorConfig(!0)}_onLoad(){this._map.style.forEachFragmentStyle((n=>{n.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=n.scope,this._indoorDataQuery=new Gh))})),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<15)return void this._clearIndoorData();const n=this._indoorDataQuery.execute(this._map);if(!n||n.floors.length===0||this._map.transform.zoom<16)this._clearIndoorData();else if(this._floorSelectionState.hasBuildingChanged(n)){if(!n.building&&this._floorSelectionState.getActiveFloors().length<=0)return void this._clearIndoorData();this._setIndoorData(n),n.building&&this._updateIndoorSelector()}else this._setIndoorData(n)}_setIndoorData(n){this._floorSelectionState.setIndoorData(n)&&this._updateIndoorConfig()}_clearIndoorData(){this._floorSelectionState.isEmpty()||(this._floorSelectionState.reset(),this._updateIndoorSelector(),this._map.setConfigProperty(this._scope,"activeFloors",["literal",[]]))}_updateIndoorSelector(){const n=this._floorSelectionState.getCurrentBuildingSelection(),c=n.floors.map((d=>({id:d.id,name:d.name,shortName:d.zIndex.toString(),levelOrder:d.zIndex})));this.fire(new i.z("indoorupdate",{selectedFloorId:n.selectedFloorId,floors:c}))}_updateIndoorConfig(n=!1){const c=this._floorSelectionState.getActiveFloors(n).map((d=>d.id))||[];this._map.setConfigProperty(this._scope,"activeFloors",["literal",c])}}var Lf=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,lp=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,cp=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,sh="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",es=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Sd=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,xs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Aa=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,yu=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,mr=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Bf=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const vu=[];Ga(Lf,vu),Ga(cp,vu),Ga(lp,vu);const lh={"_prelude_fog.vertex.glsl":Sd,"_prelude_terrain.vertex.glsl":es,"_prelude_shadow.vertex.glsl":mr,"_prelude_fog.fragment.glsl":xs,"_prelude_shadow.fragment.glsl":Bf,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Aa,"_prelude_raster_particle.glsl":yu},Rc={};Dn("",es),Dn(xs,Sd),Dn(Bf,mr),Dn(Aa,""),Dn(yu,"");const qh=Dn(lp,cp),El=Lf;var Dc={background:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:Dn(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:Dn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Dn("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Dn(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Dn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Dn("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Dn("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Dn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:Dn(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:Dn(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Dn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Dn(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Dn(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Dn(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Dn("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Dn("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Dn(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Dn(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Dn("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Dn(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,sh),skyboxGradient:Dn(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,sh),skyboxCapture:Dn(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Dn(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Dn(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Dn(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Dn(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Dn("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Dn("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Dn("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Dn("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ga(p,n){const c=p.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let d of c)if(d=d.trim(),d[0]==="#"&&d.includes("if")&&!d.includes("endif")){d=d.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=d.split(" ");for(const E of x)n.includes(E)||n.push(E)}}function Dn(p,n){const c=/#include\s+"([^"]+)"/g,d=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,x={},E=[],I=[];if(p=p.replace(c,((N,H)=>(I.push(H),""))),(n=n.replace(c,((N,H)=>(E.push(H),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let D=[...vu];Ga(p,D),Ga(n,D);for(const N of[...E,...I])lh[N]||console.error(`Undefined include: ${N}`),Rc[N]||(Rc[N]=[],Ga(lh[N],Rc[N])),D=[...D,...Rc[N]];return{fragmentSource:p=p.replace(d,((N,H,W,ee,Y)=>(x[Y]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
in ${W} ${ee} ${Y};
#else
uniform ${W} ${ee} u_${Y};
#endif
`:H==="initialize"?`
#ifdef HAS_UNIFORM_u_${Y}
    ${W} ${ee} ${Y} = u_${Y};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    in ${W} ${ee} ${Y};
#endif
`:H==="initialize-attribute"?"":void 0))),vertexSource:n=n.replace(d,((N,H,W,ee,Y)=>{const se=ee==="float"?"vec2":ee,fe=Y.match(/color/)?"color":se;return H==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
in ${W} ${ee} a_${Y};
#endif
`:x[Y]?H==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${W} ${se} a_${Y};
out ${W} ${ee} ${Y};
#else
uniform ${W} ${ee} u_${Y};
#endif
`:H==="initialize"?fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${W} ${ee} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${fe}(a_${Y}, u_${Y}_t);
#else
    ${W} ${ee} ${Y} = u_${Y};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    in ${W} ${ee} a_${Y};
    out ${W} ${ee} ${Y};
#endif
`:H==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    ${Y} = a_${Y};
#endif
`:void 0:H==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
in ${W} ${se} a_${Y};
#else
uniform ${W} ${ee} u_${Y};
#endif
`:H==="define-instanced"?fe==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${Y}0;
in vec4 a_${Y}1;
in vec4 a_${Y}2;
in vec4 a_${Y}3;
#else
uniform ${W} ${ee} u_${Y};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${W} ${se} a_${Y};
#else
uniform ${W} ${ee} u_${Y};
#endif
`:H==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${Y}
    ${W} ${ee} ${Y} = a_${Y};
#endif
`:fe==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${W} ${ee} ${Y} = a_${Y};
#else
    ${W} ${ee} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${W} ${ee} ${Y} = unpack_mix_${fe}(a_${Y}, u_${Y}_t);
#else
    ${W} ${ee} ${Y} = u_${Y};
#endif
`})),usedDefines:D,vertexIncludes:E,fragmentIncludes:I}}class ch{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,c,d,x,E,I,D,N){this.context=n;let H=this.boundPaintVertexBuffers.length!==x.length;for(let ee=0;!H&&ee<x.length;ee++)this.boundPaintVertexBuffers[ee]!==x[ee]&&(H=!0);let W=this.boundDynamicVertexBuffers.length!==D.length;for(let ee=0;!W&&ee<D.length;ee++)this.boundDynamicVertexBuffers[ee]!==D[ee]&&(W=!0);if(!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==d||H||W||this.boundIndexBuffer!==E||this.boundVertexOffset!==I)this.freshBind(c,d,x,E,I,D,N);else{n.bindVertexArrayOES.set(this.vao);for(const ee of D)ee&&(ee.bind(),N&&ee.instanceCount&&ee.setVertexAttribDivisor(n.gl,c,N));E&&E.dynamicDraw&&E.bind()}}freshBind(n,c,d,x,E,I,D){const N=this.context,H=N.gl;this.vao&&this.destroy(),this.vao=N.gl.createVertexArray(),N.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=d,this.boundIndexBuffer=x,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=I,c.enableAttributes(H,n),c.bind(),c.setVertexAttribPointers(H,n,E);for(const W of d)W.enableAttributes(H,n),W.bind(),W.setVertexAttribPointers(H,n,E);for(const W of I)W&&(W.enableAttributes(H,n),W.bind(),W.setVertexAttribPointers(H,n,E),D&&W.instanceCount&&W.setVertexAttribDivisor(H,n,D));x&&x.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function xu(p,n){const c=Math.pow(2,n.canonical.z),d=n.canonical.y;return[new i.ae(0,d/c).toLngLat().lat,new i.ae(0,(d+1)/c).toLngLat().lat]}function lA(p,n,c,d,x,E,I){const D=p.context,N=D.gl,H=c.hillshadeFBO;if(!H)return;p.prepareDrawTile();const W=p.isTileAffectedByFog(n),ee=p.getOrCreateProgram("hillshade",{overrideFog:W});D.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,H.colorAttachment.get());const Y=((Se,me,Te,Oe)=>{const Le=Te.paint.get("hillshade-shadow-color"),Ge=Te.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Ue=Te.paint.get("hillshade-highlight-color"),Ze=Te.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",$e=Te.paint.get("hillshade-accent-color"),Ve=Te.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",We=Te.paint.get("hillshade-emissive-strength");let yt=i.an(Te.paint.get("hillshade-illumination-direction"));if(Te.paint.get("hillshade-illumination-anchor")==="viewport")yt-=Se.transform.angle;else if(Se.style&&Se.style.enable3dLights()&&Se.style.directionalLight){const Ot=Se.style.directionalLight.properties.get("direction"),_t=i.d3(Ot.x,Ot.y,Ot.z);yt=i.an(_t[1])}const lt=!Se.options.moving;return{u_matrix:Oe||Se.transform.calculateProjMatrix(me.tileID.toUnwrapped(),lt),u_image:0,u_latrange:xu(0,me.tileID),u_light:[Te.paint.get("hillshade-exaggeration"),yt],u_shadow:Le.toPremultipliedRenderColor(Ge?null:Te.lut),u_highlight:Ue.toPremultipliedRenderColor(Ze?null:Te.lut),u_emissive_strength:We,u_accent:$e.toPremultipliedRenderColor(Ve?null:Te.lut)}})(p,c,d,p.terrain?n.projMatrix:null);p.uploadCommonUniforms(D,ee,n.toUnwrapped());const{tileBoundsBuffer:se,tileBoundsIndexBuffer:fe,tileBoundsSegments:he}=p.getTileBoundsBuffers(c);ee.draw(p,N.TRIANGLES,x,E,I,gn.disabled,Y,d.id,se,fe,he)}function Wh(p,n,c){if(!n.needsDEMTextureUpload)return;const d=p.context,x=d.gl;d.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||p.getTileTexture(c.stride);const E=c.getPixels();n.demTexture?n.demTexture.update(E,{premultiply:!1}):n.demTexture=new i.T(d,E,x.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Zh(p,n,c){const d=p.context,x=d.gl;if(!n.dem)return;const E=n.dem;if(d.activeTexture.set(x.TEXTURE1),Wh(p,n,E),!n.demTexture)return;n.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE);const I=E.dim;d.activeTexture.set(x.TEXTURE0);let D=n.hillshadeFBO;if(!D){const Y=new i.T(d,{width:I,height:I,data:null},x.RGBA8);Y.bind(x.LINEAR,x.CLAMP_TO_EDGE),D=n.hillshadeFBO=d.createFramebuffer(I,I,!0,"renderbuffer"),D.colorAttachment.set(Y.texture)}d.bindFramebuffer.set(D.framebuffer),d.viewport.set([0,0,I,I]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:H,tileBoundsSegments:W}=p.getMercatorTileBoundsBuffers(),ee=[];p.linearFloatFilteringSupported()&&ee.push("TERRAIN_DEM_FLOAT_FORMAT"),p.getOrCreateProgram("hillshadePrepare",{defines:ee}).draw(p,x.TRIANGLES,Mr.disabled,cn.disabled,Mn.unblended,gn.disabled,((Y,se)=>{const fe=se.stride,he=i.bC();return i.cd(he,0,i.al,-i.al,0,0,1),i.br(he,he,[0,-i.al,0]),{u_matrix:he,u_image:1,u_dimension:[fe,fe],u_zoom:Y.overscaledZ}})(n.tileID,E),c.id,N,H,W),n.needsHillshadePrepare=!1}class $i{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ff extends $i{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class uh extends $i{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class bu extends $i{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Td extends $i{getDefault(){return[!0,!0,!0,!0]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class up extends $i{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Hl extends $i{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class bs extends $i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const c=this.current;(n.func!==c.func||n.ref!==c.ref||n.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class hh extends $i{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Ds extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=n,this.dirty=!1}}class lc extends $i{getDefault(){return[0,1]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Oc extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=n,this.dirty=!1}}class Ed extends $i{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class wu extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.BLEND):c.disable(c.BLEND),this.current=n,this.dirty=!1}}class Nf extends $i{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class ka extends $i{getDefault(){return i.ao.transparent.toNonPremultipliedRenderColor(null)}set(n){const c=this.current;(n.r!==c.r||n.g!==c.g||n.b!==c.b||n.a!==c.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Jo extends $i{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class To extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;n?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=n,this.dirty=!1}}class kc extends $i{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Xs extends $i{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let hp=class extends $i{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class Su extends $i{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class rm extends $i{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const c=this.current;(n[0]!==c[0]||n[1]!==c[1]||n[2]!==c[2]||n[3]!==c[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Xh extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Tu extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Eu extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class va extends $i{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class fh extends $i{getDefault(){return null}set(n){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Yh extends $i{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class ql extends $i{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class za extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Cu extends $i{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Os extends $i{constructor(n,c){super(n),this.context=n,this.parent=c}getDefault(){return null}}class fp extends Os{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Cd extends Os{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class jf extends Os{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,this.attachment(),c.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Md extends Cd{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const zc=(p,n,c)=>({u_matrix:p,u_image0:0,u_skirt_height:n,u_ground_shadow_factor:c}),ts=(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(d),u_merc_matrix:c,u_zoom_transition:x,u_merc_center:E,u_image0:0,u_frustum_tl:I,u_frustum_tr:D,u_frustum_br:N,u_frustum_bl:H,u_globe_pos:W,u_globe_radius:ee,u_viewport:Y,u_grid_matrix:he?Float32Array.from(he):new Float32Array(9),u_skirt_height:se,u_far_z_cutoff:fe});function Qh(p,n){return p!=null&&n!=null&&!(!p.hasData()||!n.hasData())&&p.demTexture!=null&&n.demTexture!=null&&p.tileID.key!==n.tileID.key}const Mu=new class{constructor(){this.operations={}}newMorphing(p,n,c,d,x){if(p in this.operations){const E=this.operations[p];E.to.tileID.key!==c.tileID.key&&(E.queued=c)}else this.operations[p]={startTime:d,phase:0,duration:x,from:n,to:c,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const n=this.operations[p];return{from:n.from,to:n.to,phase:n.phase}}update(p){for(const n in this.operations){const c=this.operations[n];for(c.phase=(p-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,p)){delete this.operations[n];break}}}_nextOp(p,n){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=n,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},nm={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Lc(p,n,c){if(n===0)return 0;const d=n<1&&c===514?.25/n:1;return 6*Math.pow(1.5,22-p)*Math.max(n,1)*d}function Bc(p,n){const c=1<<p.z;return!n&&(p.x===0||p.x===c-1)||p.y===0||p.y===c-1}const xn=p=>({u_matrix:p});function Pa(p,n,c,d,x){if(x>0){const E=i.o.now(),I=(E-p.timeAdded)/x,D=n?(E-n.timeAdded)/x:-1,N=c.getSource(),H=d.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),W=!n||Math.abs(n.tileID.overscaledZ-H)>Math.abs(p.tileID.overscaledZ-H),ee=W&&p.refreshedUponExpiration?1:i.aA(W?I:1-D,0,1);return n?{opacity:1,mix:1-ee,isFading:I<1}:{opacity:ee,mix:0,isFading:I<1}}return{opacity:1,mix:0,isFading:!1}}class qn extends ls{constructor(n){const c=Rf("mock-dem",{type:"raster-dem",maxzoom:n.transform.maxZoom},n.style.dispatcher,n.style);super("mock-dem",c,!1),c.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,c){n.state="loaded",c(null)}}class Ro extends ls{constructor(n){const c=Rf("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},n.style.dispatcher,n.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,c,d){if(n.freezeTileCoverage)return;this.transform=n;const x=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((E,I)=>{if(E[I.key]="",!this._tiles[I.key]){const D=new Ju(I,this._source.tileSize*I.overscaleFactor(),n.tileZoom,void 0,void 0,this._source.worldview);D.state="loaded",this._tiles[I.key]=D}return E}),{});for(const E in this._tiles)E in x||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(n){const c=this.proxyCachedFBO[n];if(c!==void 0){const d=Object.values(c);this.renderCachePool.push(...d),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach((n=>n.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Kh extends i.aO{constructor(n,c,d){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=c,this.projMatrix=d}}class Wl extends i.dH{constructor(n,c){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},n.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),n.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),n.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[d,x,E]=(function(N){const H=new i.bd,W=new i.b1,ee=131;H.reserve(17161),W.reserve(33800);const Y=i.al/128,se=i.al+Y/2,fe=se+Y;for(let Se=-Y;Se<fe;Se+=Y)for(let me=-Y;me<fe;me+=Y){const Te=me<0||me>se||Se<0||Se>se?24575:0,Oe=i.aA(Math.round(me),0,i.al),Le=i.aA(Math.round(Se),0,i.al);H.emplaceBack(Oe+Te,Le)}const he=(Se,me)=>{const Te=me*ee+Se;W.emplaceBack(Te+1,Te,Te+ee),W.emplaceBack(Te+ee,Te+ee+1,Te+1)};for(let Se=1;Se<129;Se++)for(let me=1;me<129;me++)he(me,Se);return[0,129].forEach((Se=>{for(let me=0;me<130;me++)he(me,Se),he(Se,me)})),[H,W,32768]})(),I=n.context;this.gridBuffer=I.createVertexBuffer(d,i.bf.members),this.gridIndexBuffer=I.createIndexBuffer(x),this.gridSegments=i.bg.simpleSegment(0,0,d.length,x.length),this.gridNoSkirtSegments=i.bg.simpleSegment(0,0,d.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ro(c.map),this.orthoMatrix=i.bC(),i.cd(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.al,0,i.al,0,1);const D=I.gl;this._overlapStencilMode=new cn({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new qn(c.map),this._pendingGroundEffectLayers=[]}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(n,c,d){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const x=n.terrain.properties,E=n.terrain.drapeRenderMode===0,I=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.o.now();const D=n.terrain&&n.terrain.scope,N=x.get("source"),H=E?this._mockSourceCache:n.getSourceCache(N,D);if(!H)return void i.w(`Couldn't find terrain source "${N}".`);if(this.sourceCache=H,this._attenuationRange=n.terrain.getAttenuationRange(),this._exaggeration=I?this.calculateExaggeration(c):x.get("exaggeration"),!c.projection.requiresDraping&&I&&this._exaggeration===0)return void this._disable();this.enabled=!0;const W=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const ee=this.getScaledDemTileSize();this.sourceCache.update(c,ee,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,W(),this._initializing=!0),W(),c.updateElevation(!0,d),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0,this._previousZoom=c.zoom}else this._disable()}calculateExaggeration(n){if(this._attenuationRange&&n.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(n.zoom);const c=this._previousCameraAltitude,d=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=d;const x=c!=null?d-c:Number.MAX_VALUE;if(Math.abs(x)<2)return this._exaggeration;const E=n.zoom,I=this._style.terrain;if(!this._previousUpdateTimestamp)return I.getExaggeration(E);let D=E-this._previousZoom;const N=this._previousUpdateTimestamp;let H=E;this._evaluationZoom!=null&&(H=this._evaluationZoom,Math.abs(E-H)>.5&&(D=.5*(E-H+D)),D*x<0&&(H+=D)),this._evaluationZoom=H;const W=I.getExaggeration(H),ee=W===I.getExaggeration(Math.max(0,H-.1));if(ee&&Math.abs(W-this._exaggeration)<.01)return W;let Y=Math.min(.1,.00375*(this._updateTimestamp-N));return(ee||W<.1||Math.abs(D)<1e-4)&&(Y=Math.min(.2,4*Y)),i.ak(this._exaggeration,W,Y)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.dataType==="source"&&n.coord?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((n=>n.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,d=this.painter.transform;this._initializing&&(this._initializing=d._centerAltitude===0&&this.getAtPointOrZero(i.ae.fromLngLat(d.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=c.getIds().map((N=>{const H=c.getTileByID(N).tileID;return H.projMatrix=d.calculateProjMatrix(H.toUnwrapped()),H}));(function(N,H){const W=H.transform.pointCoordinate(H.transform.getCameraPoint()),ee=new i.P(W.x,W.y);N.sort(((Y,se)=>{if(se.overscaledZ-Y.overscaledZ)return se.overscaledZ-Y.overscaledZ;const fe=new i.P(Y.canonical.x+(1<<Y.canonical.z)*Y.wrap,Y.canonical.y),he=new i.P(se.canonical.x+(1<<se.canonical.z)*se.wrap,se.canonical.y),Se=ee.mult(1<<Y.canonical.z);return Se.x-=.5,Se.y-=.5,Se.distSqr(fe)-Se.distSqr(he)}))})(x,this.painter);const E=this.proxyToSource||{};this.proxyToSource={},x.forEach((N=>{this.proxyToSource[N.key]={}})),this.terrainTileForTile={};const I=this._style._mergedSourceCaches;for(const N in I){const H=I[N];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,n[N],E),H.usedForTerrain))continue;const W=n[N];H.getSource().reparseOverscaled&&this._assignTerrainTiles(W)}this.proxiedCoords[c.id]=x.map((N=>new Kh(N,N.key,this.orthoMatrix))),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1;const D={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const H=this.terrainTileForTile[N.key];if(!H)continue;const W=H.tileID.key;W in D||(this._visibleDemTiles.push(H),D[W]=W)}}_assignTerrainTiles(n){this._initializing||n.forEach((c=>{if(this.terrainTileForTile[c.key])return;const d=this._findTileCoveringTileID(c,this.sourceCache);d&&(this.terrainTileForTile[c.key]=d)}))}_prepareDEMTextures(){const n=this.painter.context,c=n.gl;for(const d in this.terrainTileForTile){const x=this.terrainTileForTile[d],E=x.dem;!E||x.demTexture&&!x.needsDEMTextureUpload||(n.activeTexture.set(c.TEXTURE1),Wh(this.painter,x,E))}}_prepareDemTileUniforms(n,c,d,x){if(!c||c.demTexture==null)return!1;const E=n.tileID.canonical,I=Math.pow(2,c.tileID.canonical.z-E.z),D=x||"";return d[`u_dem_tl${D}`]=[E.x*I%1,E.y*I%1],d[`u_dem_scale${D}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const c=this._visibleDemTiles.reduce(((d,x)=>{if(!x.dem)return d;const E=x.dem.tree.minimums[0];return E>0&&n++,d+E}),0);return n?c/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,c=n.gl;n.activeTexture.set(c.TEXTURE2);const d=this._getLoadedAreaMinimum(),x=new i.dI({width:1,height:1},new Float32Array([d]));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(x,{premultiply:!1}):E=this._emptyDEMTexture=new i.T(n,x,c.R32F,{premultiply:!1}),E}setupElevationDraw(n,c,d){const x=this.painter.context,E=x.gl,I={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};I.u_exaggeration=this.exaggeration();let D=null,N=null,H=1;if(d&&d.morphing&&this._useVertexMorphing){const se=d.morphing.srcDemTile,fe=d.morphing.dstDemTile;H=d.morphing.phase,se&&fe&&(this._prepareDemTileUniforms(n,se,I,"_prev")&&(N=se),this._prepareDemTileUniforms(n,fe,I)&&(D=fe))}const W=se=>se&&se.demTexture&&this.painter.linearFloatFilteringSupported()?E.LINEAR:E.NEAREST;let ee=null;var Y;if(this.enabled?N&&D?(ee=D.demTexture,x.activeTexture.set(E.TEXTURE4),N.demTexture.bind(W(N),E.CLAMP_TO_EDGE),I.u_dem_lerp=H):(D=this.terrainTileForTile[n.tileID.key],ee=this._prepareDemTileUniforms(n,D,I)?D.demTexture:this.emptyDEMTexture):ee=this.emptyDEMTexture,x.activeTexture.set(E.TEXTURE2),ee&&(I.u_dem_size=(Y=ee).size[0]===1?1:Y.size[0]-2,ee.bind(W(D),E.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(d&&d.useDepthForOcclusion,c,I),d&&d.useMeterToDem&&D){const se=(1<<D.tileID.canonical.z)*i.ce(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=se}if(d&&d.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=d.labelPlaneMatrixInv),c.setTerrainUniformValues(x,I),this.painter.transform.projection.name==="globe"){const se=this.globeUniformValues(this.painter.transform,n.tileID.canonical,d&&d.useDenormalizedUpVectorScale);c.setGlobeUniformValues(x,se)}}globeUniformValues(n,c,d){const x=n.projection;return{u_tile_tl_up:x.upVector(c,0,0),u_tile_tr_up:x.upVector(c,i.al,0),u_tile_br_up:x.upVector(c,i.al,i.al),u_tile_bl_up:x.upVector(c,0,i.al),u_tile_up_scale:d?i.dJ(1):x.upVectorScale(c,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const c=this.painter,d=this.painter.context;n.length!==0&&(d.bindFramebuffer.set(null),d.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(x,E,I,D,N){if(x.transform.projection.name==="globe")(function(H,W,ee,Y,se){const fe=H.context,he=fe.gl;let Se,me;const Te=H.transform,Oe=i.dA(H,fe,Te),Le=(Ot,_t)=>{if(me===_t)return;const It=[nm[_t],"PROJECTION_GLOBE_VIEW"];Oe&&It.push("CUSTOM_ANTIALIASING");const ur=H.isTileAffectedByFog(Ot);Se=H.getOrCreateProgram("globeRaster",{defines:It,overrideFog:ur}),me=_t},Ge=H.colorModeForRenderPass(),Ue=new Mr(he.LEQUAL,Mr.ReadWrite,H.depthRangeFor3D);Mu.update(se);const Ze=i.dB(Te),$e=[i.aF(Te.center.lng),i.aJ(Te.center.lat)],Ve=H.globeSharedBuffers,We=[Te.width*i.o.devicePixelRatio,Te.height*i.o.devicePixelRatio],yt=Float32Array.from(Te.globeMatrix),lt={useDenormalizedUpVectorScale:!0};{const Ot=H.transform,_t=Lc(Ot.zoom,W.exaggeration(),W.sourceCache._source.tileSize);me=-1;const It=he.TRIANGLES;for(const ur of Y){const xt=ee.getTile(ur),rt=cn.disabled,zt=W.prevTerrainTileForTile[ur.key],gt=W.terrainTileForTile[ur.key];Qh(zt,gt)&&Mu.newMorphing(ur.key,zt,gt,se,250),fe.activeTexture.set(he.TEXTURE0),xt.texture&&xt.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);const Bt=Mu.getMorphValuesForProxy(ur.key),Gt=Bt?1:0;Bt&&Object.assign(lt,{morphing:{srcDemTile:Bt.from,dstDemTile:Bt.to,phase:i.dz(Bt.phase)}});const ar=i.dC(ur.canonical),Ht=i.dD(ar.getCenter().lat),Xt=i.dE(ur.canonical,ar,Ht,Ot.worldSize/Ot._pixelsPerMercatorPixel),qr=i.bk(i.dF(ur.canonical)),$r=ts(Ot.expandedFarZProjMatrix,yt,Ze,qr,i.aj(Ot.zoom),$e,Ot.frustumCorners.TL,Ot.frustumCorners.TR,Ot.frustumCorners.BR,Ot.frustumCorners.BL,Ot.globeCenterInViewSpace,Ot.globeRadius,We,_t,Ot._farZ,Xt);if(Le(ur,Gt),Se&&(W.setupElevationDraw(xt,Se,lt),H.uploadCommonUniforms(fe,Se,ur.toUnwrapped()),Ve)){const[Yr,Lr,rn]=Ve.getGridBuffers(Ht,_t!==0);Se.draw(H,It,Ue,rt,Ge,gn.backCCW,$r,"globe_raster",Yr,Lr,rn)}}}if(Ve&&(H.renderDefaultNorthPole||H.renderDefaultSouthPole)){const Ot=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Oe&&Ot.push("CUSTOM_ANTIALIASING"),Se=H.getOrCreateProgram("globeRaster",{defines:Ot});for(const _t of Y){const{x:It,y:ur,z:xt}=_t.canonical,rt=ur===0,zt=ur===(1<<xt)-1,[gt,Bt,Gt,ar]=Ve.getPoleBuffers(xt,!1);if(ar&&(rt||zt)){const Ht=ee.getTile(_t);fe.activeTexture.set(he.TEXTURE0),Ht.texture&&Ht.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE);let Xt=i.dG(xt,It,Te);const qr=i.bk(i.dF(_t.canonical)),$r=(Yr,Lr)=>Yr.draw(H,he.TRIANGLES,Ue,cn.disabled,Ge,gn.disabled,ts(Te.expandedFarZProjMatrix,Xt,Xt,qr,0,$e,Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.globeCenterInViewSpace,Te.globeRadius,We,0,Te._farZ),"globe_pole_raster",Lr,Gt,ar);W.setupElevationDraw(Ht,Se,lt),H.uploadCommonUniforms(fe,Se,_t.toUnwrapped()),rt&&H.renderDefaultNorthPole&&$r(Se,gt),zt&&H.renderDefaultSouthPole&&(Xt=i.cR(i.bC(),Xt,[1,-1,1]),$r(Se,Bt))}}}})(x,E,I,D,N);else{const H=x.context,W=H.gl;let ee,Y;const se=x.shadowRenderer,fe=Ec(x,x.longestCutoffRange),he=Ge=>{if(Y===Ge)return;const Ue=[];Ue.push(nm[Ge]),fe.shouldRenderCutoff&&Ue.push("RENDER_CUTOFF"),se&&(Ue.push("RENDER_SHADOWS","DEPTH_TEXTURE"),se.useNormalOffset&&Ue.push("NORMAL_OFFSET")),ee=x.getOrCreateProgram("terrainRaster",{defines:Ue}),Y=Ge},Se=x.colorModeForRenderPass(),me=new Mr(W.LEQUAL,Mr.ReadWrite,x.depthRangeFor3D);Mu.update(N);const Te=x.transform,Oe=Lc(Te.zoom,E.exaggeration(),E.sourceCache._source.tileSize);let Le=[0,0,0];if(se){const Ge=x.style.directionalLight,Ue=x.style.ambientLight;Ge&&Ue&&(Le=vs(x.style,Ge,Ue))}{Y=-1;const Ge=W.TRIANGLES,[Ue,Ze]=[E.gridIndexBuffer,E.gridSegments];for(const $e of D){const Ve=I.getTile($e),We=cn.disabled,yt=E.prevTerrainTileForTile[$e.key],lt=E.terrainTileForTile[$e.key];Qh(yt,lt)&&Mu.newMorphing($e.key,yt,lt,N,250),H.activeTexture.set(W.TEXTURE0),Ve.texture&&Ve.texture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const Ot=Mu.getMorphValuesForProxy($e.key),_t=Ot?1:0;let It;Ot&&(It={morphing:{srcDemTile:Ot.from,dstDemTile:Ot.to,phase:i.dz(Ot.phase)}});const ur=zc($e.projMatrix,Bc($e.canonical,Te.renderWorldCopies)?Oe/10:Oe,Le);if(he(_t),!ee)continue;E.setupElevationDraw(Ve,ee,It);const xt=$e.toUnwrapped();se&&se.setupShadows(xt,ee),x.uploadCommonUniforms(H,ee,xt,null,fe),ee.draw(x,Ge,me,We,Se,gn.backCCW,ur,"terrain_raster",E.gridBuffer,Ue,Ze)}}}})(c,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const c=this.painter,d=this.painter.context,x=this.proxySourceCache,E=this.proxiedCoords[x.id],I=this._drapedRenderBatches.shift(),D=c.style.order,N=[];let H=0;for(const W of E){const ee=x.getTileByID(W.proxyTileKey),Y=x.proxyCachedFBO[W.key]?x.proxyCachedFBO[W.key][n]:void 0,se=Y!==void 0?x.renderCache[Y]:this.pool[H++],fe=Y!==void 0;if(ee.texture=se.tex,fe&&!se.dirty){N.push(ee.tileID);continue}let he;d.bindFramebuffer.set(se.fb.framebuffer),this.renderedToTile=!1,se.dirty&&(d.clear({color:i.ao.transparent,stencil:0}),se.dirty=!1);for(let Se=I.start;Se<=I.end;++Se){const me=c.style._mergedLayers[D[Se]];if(me.isHidden(c.transform.zoom))continue;const Te=c.style.getLayerSourceCache(me),Oe=Te?this.proxyToSource[W.key][Te.id]:[W];if(!Oe)continue;const Le=Oe;d.viewport.set([0,0,se.fb.width,se.fb.height]),he!==(Te?Te.id:null)&&(this._setupStencil(se,Oe,me,Te),he=Te?Te.id:null),c.renderLayer(c,Te,me,Le)}if(this._drapedRenderBatches.length===0)for(const Se of this._pendingGroundEffectLayers){const me=c.style._mergedLayers[D[Se]];if(me.isHidden(c.transform.zoom))continue;const Te=c.style.getLayerSourceCache(me),Oe=Te?this.proxyToSource[W.key][Te.id]:[W];if(!Oe)continue;const Le=Oe;d.viewport.set([0,0,se.fb.width,se.fb.height]),he!==(Te?Te.id:null)&&(this._setupStencil(se,Oe,me,Te),he=Te?Te.id:null),c.renderLayer(c,Te,me,Le)}this.renderedToTile?(se.dirty=!0,N.push(ee.tileID)):fe||--H,H===5&&(H=0,this.renderToBackBuffer(N))}return this.renderToBackBuffer(N),this.renderingToTexture=!1,d.bindFramebuffer.set(null),d.viewport.set([0,0,c.width,c.height]),I.end+1}postRender(){}isLayerOrderingCorrect(n){const c=n.order.length;let d=-1,x=c;for(let E=0;E<c;++E)this._style.isLayerDraped(n._mergedLayers[n.order[E]])?d=Math.max(d,E):x=Math.min(x,E);return x>d}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter((c=>c.dem)).forEach((c=>{n=Math.min(n,c.dem.tree.minimums[0])})),n===0?n:(n-30)*this._exaggeration}raycast(n,c,d){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter((E=>E.dem)).map((E=>{const I=E.tileID,D=1<<I.overscaledZ,{x:N,y:H}=I.canonical,W=N/D,ee=(N+1)/D,Y=H/D,se=(H+1)/D;return{minx:W,miny:Y,maxx:ee,maxy:se,t:E.dem.tree.raycastRoot(W,Y,ee,se,n,c,d),tile:E}}));x.sort(((E,I)=>(E.t!==null?E.t:Number.MAX_VALUE)-(I.t!==null?I.t:Number.MAX_VALUE)));for(const E of x){if(E.t==null)return null;const I=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,n,c,d);if(I!=null)return I}return null}_createFBO(){const n=this.painter.context,c=n.gl,d=this.drapeBufferSize;n.activeTexture.set(c.TEXTURE0);const x=new i.T(n,{width:d[0],height:d[1],data:null},c.RGBA8);x.bind(c.LINEAR,c.CLAMP_TO_EDGE);const E=n.createFramebuffer(d[0],d[1],!0,null);return E.colorAttachment.set(x.texture),E.depthAttachment=new Md(n,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,d[0],d[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:E,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some((n=>{const c=this._style._mergedLayers[n],d=c.isHidden(this.painter.transform.zoom);return c.type==="hillshade"||c.type==="custom"?!d&&c.shouldRedrape():!d&&c.hasTransition()}))}_clearLineLayersFromRenderCache(){let n=!1;for(const d of this._style.getSources())if(d instanceof ss){n=!0;break}if(!n)return;const c={};for(let d=0;d<this._style.order.length;++d){const x=this._style._mergedLayers[this._style.order[d]],E=this._style.getLayerSourceCache(x);if(E&&!c[E.id]&&!x.isHidden(this.painter.transform.zoom)&&x.type==="line"&&x.widthExpression()instanceof i.ad){c[E.id]=!0;for(const I of this.proxyCoords){const D=this.proxyToSource[I.key][E.id];if(D)for(const N of D)this._clearRenderCacheForTile(E.id,N)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const d in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[d]._source instanceof Fe){n=!0;break}if(!n)return;const c={};for(let d=0;d<this._style.order.length;++d){const x=this._style._mergedLayers[this._style.order[d]],E=this._style.getLayerSourceCache(x);if(!E||c[E.id]||x.isHidden(this.painter.transform.zoom)||x.type!=="raster")continue;const I=x.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const N=this.proxyToSource[D.key][E.id];if(N)for(const H of N){const W=Pa(E.getTile(H),E.findLoadedParent(H,0),E,this.painter.transform,I);(W.opacity!==1||W.mix!==0)&&this._clearRenderCacheForTile(E.id,H)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const n=this._style.order,c=n.length;if(c===0)return;const d=[];this._pendingGroundEffectLayers=[];let x,E=0,I=this._style._mergedLayers[n[E]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++E<c;)I=this._style._mergedLayers[n[E]];for(;E<c;++E){const D=this._style._mergedLayers[n[E]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?x===void 0&&(x=E):(D.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(E),x!==void 0&&(d.push({start:x,end:E-1}),x=void 0)))}if(x!==void 0&&d.push({start:x,end:E-1}),d.length!==0){const D=d[d.length-1];this._pendingGroundEffectLayers.every((N=>N>D.end))||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=d}_setupRenderCache(n){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const I=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let D=0;D<I.length;++D){const N=Object.values(I[D]);c.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const d=this.proxyCoords,x=this._tilesDirty;for(let I=d.length-1;I>=0;I--){const D=d[I];if(c.getTileByID(D.key),c.proxyCachedFBO[D.key]!==void 0){const N=n[D.key],H=this.proxyToSource[D.key];let W=0;for(const ee in H){const Y=H[ee],se=N[ee];if(!se||se.length!==Y.length||Y.some(((fe,he)=>fe!==se[he]||x[ee]&&x[ee].hasOwnProperty(fe.key)))){W=-1;break}++W}for(const ee in c.proxyCachedFBO[D.key])c.renderCache[c.proxyCachedFBO[D.key][ee]].dirty=W<0||W!==Object.values(N).length}}const E=[...this._drapedRenderBatches];E.sort(((I,D)=>D.end-D.start-(I.end-I.start)));for(const I of E)for(const D of d){if(c.proxyCachedFBO[D.key])continue;let N=c.renderCachePool.pop();N===void 0&&c.renderCache.length<50&&(N=c.renderCache.length,c.renderCache.push(this._createFBO())),N!==void 0&&(c.proxyCachedFBO[D.key]={},c.proxyCachedFBO[D.key][I.start]=N,c.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(n,c,d,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,I=E.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let D;if(d.isTileClipped())D=c.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,d.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):cn.disabled}_renderTileClippingMasks(n,c){const d=this.painter,x=this.painter.context,E=x.gl;d._tileClippingMaskIDs={},x.setColorMode(Mn.disabled),x.setDepthMode(Mr.disabled);const I=d.getOrCreateProgram("clippingMask");for(const D of n){const N=d._tileClippingMaskIDs[D.key]=--c;I.draw(d,E.TRIANGLES,Mr.disabled,new cn({func:E.ALWAYS,mask:0},N,255,E.KEEP,E.KEEP,E.REPLACE),Mn.disabled,gn.disabled,xn(D.projMatrix),"$clipping",d.tileExtentBuffer,d.quadTriangleIndexBuffer,d.tileExtentSegments)}}pointCoordinate(n){const c=this.painter.transform;if(n.x<0||n.x>c.width||n.y<0||n.y>c.height)return null;const d=[n.x,n.y,1,1];i.aC(d,d,c.pixelMatrixInverse),i.cJ(d,d,1/d[3]),d[0]/=c.worldSize,d[1]/=c.worldSize;const x=c._camera.position,E=i.ce(1,c.center.lat),I=[x[0],x[1],x[2]/E,0],D=i.d9([],d.slice(0,3),I);i.aw(D,D);const N=this.raycast(I,D,this._exaggeration);return N!==null&&N?(i.bH(I,I,D,N),I[3]=I[2],I[2]*=E,I):null}_setupProxiedCoordsForOrtho(n,c,d){if(n.getSource()instanceof i.aS)return this._setupProxiedCoordsForImageSource(n,c,d);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const x=this.proxiedCoords[n.id]=[],E=this.proxyCoords;for(let N=0;N<E.length;N++){const H=E[N],W=this._findTileCoveringTileID(H,n);if(W){const ee=this._createProxiedId(H,W,d[H.key]&&d[H.key][n.id]);x.push(ee),this.proxyToSource[H.key][n.id]=[ee]}}let I=!1;const D=new Set;for(let N=0;N<c.length;N++){const H=n.getTile(c[N]);if(!H||!H.hasData())continue;const W=this._findTileCoveringTileID(H.tileID,this.proxySourceCache);if(W&&W.tileID.canonical.z!==H.tileID.canonical.z){const ee=this.proxyToSource[W.tileID.key][n.id],Y=this._createProxiedId(W.tileID,H,d[W.tileID.key]&&d[W.tileID.key][n.id]);ee?ee.splice(ee.length-1,0,Y):this.proxyToSource[W.tileID.key][n.id]=[Y];const se=this.proxyToSource[W.tileID.key][n.id];D.has(se)||D.add(se),x.push(Y),I=!0}}if(this._sourceTilesOverlap[n.id]=I,I&&this._debugParams.sortTilesHiZFirst)for(const N of D)N.sort(((H,W)=>W.overscaledZ-H.overscaledZ))}_setupProxiedCoordsForImageSource(n,c,d){if(!n.getSource().loaded())return;const x=this.proxiedCoords[n.id]=[],E=this.proxyCoords,I=n.getSource(),D=I.tileID;if(!D)return;const N=new i.P(D.x,D.y)._div(1<<D.z),H=I.coordinates.map(i.ae.fromLngLat).reduce(((ee,Y)=>(ee.min.x=Math.min(ee.min.x,Y.x-N.x),ee.min.y=Math.min(ee.min.y,Y.y-N.y),ee.max.x=Math.max(ee.max.x,Y.x-N.x),ee.max.y=Math.max(ee.max.y,Y.y-N.y),ee)),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),W=(ee,Y)=>{const se=ee.wrap+ee.canonical.x/(1<<ee.canonical.z),fe=ee.canonical.y/(1<<ee.canonical.z),he=i.al/(1<<ee.canonical.z),Se=Y.wrap+Y.canonical.x/(1<<Y.canonical.z),me=Y.canonical.y/(1<<Y.canonical.z);return se+he<Se+H.min.x||se>Se+H.max.x||fe+he<me+H.min.y||fe>me+H.max.y};for(let ee=0;ee<E.length;ee++){const Y=E[ee];for(let se=0;se<c.length;se++){const fe=n.getTile(c[se]);if(!fe||!fe.hasData()||W(Y,fe.tileID))continue;const he=this._createProxiedId(Y,fe,d[Y.key]&&d[Y.key][n.id]),Se=this.proxyToSource[Y.key][n.id];Se?Se.push(he):this.proxyToSource[Y.key][n.id]=[he],x.push(he)}}}_createProxiedId(n,c,d){let x=this.orthoMatrix;if(d){const E=d.find((I=>I.key===c.tileID.key));if(E)return E}if(c.tileID.key!==n.key){const E=n.canonical.z-c.tileID.canonical.z;let I,D,N;x=i.bC();const H=c.tileID.wrap-n.wrap<<n.overscaledZ;E>0?(I=i.al>>E,D=I*((c.tileID.canonical.x<<E)-n.canonical.x+H),N=I*((c.tileID.canonical.y<<E)-n.canonical.y)):(I=i.al<<-E,D=i.al*(c.tileID.canonical.x-(n.canonical.x+H<<-E)),N=i.al*(c.tileID.canonical.y-(n.canonical.y<<-E))),i.cd(x,0,I,0,I,0,1),i.br(x,x,[D,N,0])}return new Kh(c.tileID,n.key,x)}_findTileCoveringTileID(n,c){let d=c.getTile(n);if(d&&d.hasData())return d;const x=this._findCoveringTileCache[c.id],E=x[n.key];if(d=E?c.getTileByID(E):null,d&&d.hasData()||E===null)return d;let I=d?d.tileID:n,D=I.overscaledZ;const N=c.getSource().minzoom,H=[];if(!E){const ee=c.getSource().maxzoom;if(n.canonical.z>=ee){const Y=n.canonical.z-ee;c.getSource().reparseOverscaled?(D=Math.max(n.canonical.z+2,c.transform.tileZoom),I=new i.aO(D,n.wrap,ee,n.canonical.x>>Y,n.canonical.y>>Y)):Y!==0&&(D=ee,I=new i.aO(D,n.wrap,ee,n.canonical.x>>Y,n.canonical.y>>Y))}I.key!==n.key&&(H.push(I.key),d=c.getTile(I))}const W=ee=>{H.forEach((Y=>{x[Y]=ee})),H.length=0};for(D-=1;D>=N&&(!d||!d.hasData());D--){d&&W(d.tileID.key);const ee=I.calculateScaledKey(D);if(d=c.getTileByID(ee),d&&d.hasData())break;const Y=x[ee];if(Y===null)break;Y===void 0?H.push(ee):d=c.getTileByID(Y)}return W(d?d.tileID.key:null),d&&d.hasData()?d:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,c){let d=this._tilesDirty[n];d||(d=this._tilesDirty[n]={}),d[c.key]=!0}}function ks(p,n,c){const d=(function(D,N,H){const W=i.bJ(N,D),ee=i.bJ(H,[.2126,.7152,.0722]),Y=(fe,he,Se)=>(1-Se)*fe+Se*he,se=Y(1-.3*Math.min(ee,1),1,Math.min(W+1,1));return Y(.92,1,Math.asin(i.aA(N[2],-1,1))/Math.PI+.5)*se})(p,[0,0,1],n),x=[0,0,0];i.c4(x,c.slice(0,3),d);const E=[0,0,0];i.c4(E,n.slice(0,3),p[2]);const I=[0,0,0];return i.d7(I,x,E),i.da(I)}const im=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],La=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class Iu{static cacheKey(n,c,d,x){let E=`${c}${x?x.cacheKey:""}`;for(const I of d)n.usedDefines.includes(I)&&(E+=`/${I}`);return E}constructor(n,c,d,x,E,I){const D=n.gl;this.program=D.createProgram(),this.configuration=x,this.name=c,this.fixedDefines=[...I];let N=x?x.defines():[];N=N.concat(I.map((fe=>`#define ${fe}`)));const H=`#version 300 es
`;let W=H+N.concat("precision mediump float;",El,qh.fragmentSource).join(`
`);for(const fe of d.fragmentIncludes)W+=`
${lh[fe]}`;W+=`
${d.fragmentSource}`;let ee=H+N.concat("precision highp float;",El,qh.vertexSource).join(`
`);for(const fe of d.vertexIncludes)ee+=`
${lh[fe]}`;this.forceManualRenderingForInstanceIDShaders=n.forceManualRenderingForInstanceIDShaders&&d.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(ee+=`
uniform int u_instanceID;
`),ee+=`
${d.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(ee=ee.replaceAll("gl_InstanceID","u_instanceID"));const Y=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(Y,W),D.compileShader(Y),D.attachShader(this.program,Y);const se=D.createShader(D.VERTEX_SHADER);D.isContextLost()?this.failedToCreate=!0:(D.shaderSource(se,ee),D.compileShader(se),D.attachShader(this.program,se),this.attributes={},D.linkProgram(this.program),D.deleteShader(se),D.deleteShader(Y),this.fixedUniforms=E(n),this.binderUniforms=x?x.getUniforms(n):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(fe=>({u_instanceID:new i.cg(fe)}))(n)),(I.includes("TERRAIN")||c.indexOf("symbol")!==-1||c.indexOf("circle")!==-1)&&(this.terrainUniforms=(fe=>({u_dem:new i.cg(fe),u_dem_prev:new i.cg(fe),u_dem_tl:new i.cj(fe),u_dem_scale:new i.ci(fe),u_dem_tl_prev:new i.cj(fe),u_dem_scale_prev:new i.ci(fe),u_dem_size:new i.ci(fe),u_dem_lerp:new i.ci(fe),u_exaggeration:new i.ci(fe),u_depth:new i.cg(fe),u_depth_size_inv:new i.cj(fe),u_depth_range_unpack:new i.cj(fe),u_occluder_half_size:new i.ci(fe),u_occlusion_depth_offset:new i.ci(fe),u_meter_to_dem:new i.ci(fe),u_label_plane_matrix_inv:new i.ck(fe)}))(n)),I.includes("GLOBE")&&(this.globeUniforms=(fe=>({u_tile_tl_up:new i.ch(fe),u_tile_tr_up:new i.ch(fe),u_tile_br_up:new i.ch(fe),u_tile_bl_up:new i.ch(fe),u_tile_up_scale:new i.ci(fe)}))(n)),I.includes("FOG")&&(this.fogUniforms=(fe=>({u_fog_matrix:new i.ck(fe),u_fog_range:new i.cj(fe),u_fog_color:new i.d2(fe),u_fog_horizon_blend:new i.ci(fe),u_fog_vertical_limit:new i.cj(fe),u_fog_temporal_offset:new i.ci(fe),u_frustum_tl:new i.ch(fe),u_frustum_tr:new i.ch(fe),u_frustum_br:new i.ch(fe),u_frustum_bl:new i.ch(fe),u_globe_pos:new i.ch(fe),u_globe_radius:new i.ci(fe),u_globe_transition:new i.ci(fe),u_is_globe:new i.cg(fe),u_viewport:new i.cj(fe)}))(n)),I.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(fe=>({u_cutoff_params:new i.d2(fe)}))(n)),I.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(fe=>({u_lighting_ambient_color:new i.ch(fe),u_lighting_directional_dir:new i.ch(fe),u_lighting_directional_color:new i.ch(fe),u_ground_radiance:new i.ch(fe)}))(n)),I.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(fe=>({u_light_matrix_0:new i.ck(fe),u_light_matrix_1:new i.ck(fe),u_fade_range:new i.cj(fe),u_shadow_normal_offset:new i.ch(fe),u_shadow_intensity:new i.ci(fe),u_shadow_texel_size:new i.ci(fe),u_shadow_map_resolution:new i.ci(fe),u_shadow_direction:new i.ch(fe),u_shadow_bias:new i.ch(fe),u_shadowmap_0:new i.cg(fe),u_shadowmap_1:new i.cg(fe)}))(n)))}getAttributeLocation(n,c){let d=this.attributes[c];return d===void 0&&(d=this.attributes[c]=n.getAttribLocation(this.program,c)),d}setTerrainUniformValues(n,c){if(!this.terrainUniforms)return;const d=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in c)d[x]&&d[x].set(this.program,x,c[x])}}setGlobeUniformValues(n,c){if(!this.globeUniforms)return;const d=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in c)d[x]&&d[x].set(this.program,x,c[x])}}setFogUniformValues(n,c){if(!this.fogUniforms)return;const d=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in c)d[x].set(this.program,x,c[x])}}setCutoffUniformValues(n,c){if(!this.cutoffUniforms)return;const d=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in c)d[x].set(this.program,x,c[x])}}setLightsUniformValues(n,c){if(!this.lightsUniforms)return;const d=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in c)d[x].set(this.program,x,c[x])}}setShadowUniformValues(n,c){if(this.failedToCreate||!this.shadowUniforms)return;const d=this.shadowUniforms;n.program.set(this.program);for(const x in c)d[x].set(this.program,x,c[x])}_drawDebugWireframe(n,c,d,x,E,I,D,N,H,W){const ee=n.options.wireframe;if(ee.terrain===!1&&ee.layers2D===!1&&ee.layers3D===!1)return;const Y=n.context;if(!(!(!ee.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!ee.layers2D||n._terrain&&n._terrain.renderingToTexture||!im.includes(this.name))||!(!ee.layers3D||!La.includes(this.name))))return;const se=Y.gl,fe=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,E,Y);if(!fe)return;const he=[...this.fixedDefines];he.push("DEBUG_WIREFRAME");const Se=n.getOrCreateProgram(this.name,{config:this.configuration,defines:he});Y.program.set(Se.program);const me=(Le,Ge,Ue)=>{if(Ge[Le]&&Ue[Le])for(const Ze in Ge[Le])Ue[Le][Ze]&&Ue[Le][Ze].set(Ue.program,Ze,Ge[Le][Ze].current)};H&&H.setUniforms(Se.program,Y,Se.binderUniforms,D,{zoom:N}),me("fixedUniforms",this,Se),me("terrainUniforms",this,Se),me("globeUniforms",this,Se),me("fogUniforms",this,Se),me("lightsUniforms",this,Se),me("shadowUniforms",this,Se),fe.bind(),Y.setColorMode(new Mn([se.ONE,se.ONE_MINUS_SRC_ALPHA,se.ZERO,se.ONE],i.ao.transparent,[!0,!0,!0,!1])),Y.setDepthMode(new Mr(c.func===se.LESS?se.LEQUAL:c.func,Mr.ReadOnly,c.range)),Y.setStencilMode(cn.disabled);const Te=3*I.primitiveLength*2,Oe=3*I.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Le=W||1;for(let Ge=0;Ge<Le;++Ge)Se.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ge),se.drawElements(se.LINES,Te,se.UNSIGNED_SHORT,Oe)}else W&&W>1?se.drawElementsInstanced(se.LINES,Te,se.UNSIGNED_SHORT,Oe,W):se.drawElements(se.LINES,Te,se.UNSIGNED_SHORT,Oe);E.bind(),Y.program.set(this.program),Y.setDepthMode(c),Y.setStencilMode(d),Y.setColorMode(x)}checkUniforms(n,c,d){if(this.fixedDefines.includes(c)){for(const x of Object.keys(d))if(!d[x].initialized)throw new Error(`Program '${this.name}', from draw '${n}': uniform ${x} not set but required by ${c} being defined`)}}draw(n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se){const me=n.context,Te=me.gl;if(this.failedToCreate)return;me.program.set(this.program),me.setDepthMode(d),me.setStencilMode(x),me.setColorMode(E),me.setCullFace(I);for(const Ge of Object.keys(this.fixedUniforms))this.fixedUniforms[Ge].set(this.program,Ge,D[Ge]);fe&&fe.setUniforms(this.program,me,this.binderUniforms,Y,{zoom:se});const Oe={[Te.POINTS]:1,[Te.LINES]:2,[Te.TRIANGLES]:3,[Te.LINE_STRIP]:1}[c];this.checkUniforms(N,"RENDER_SHADOWS",this.shadowUniforms);const Le=Se&&Se>0?1:void 0;for(const Ge of ee.get()){const Ue=Ge.vaos||(Ge.vaos={});if((Ue[N]||(Ue[N]=new ch)).bind(me,this,H,fe?fe.getPaintVertexBuffers():[],W,Ge.vertexOffset,he||[],Le),this.forceManualRenderingForInstanceIDShaders){const Ze=Se||1;for(let $e=0;$e<Ze;++$e)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",$e),W?Te.drawElements(c,Ge.primitiveLength*Oe,Te.UNSIGNED_SHORT,Ge.primitiveOffset*Oe*2):Te.drawArrays(c,Ge.vertexOffset,Ge.vertexLength)}else Se&&Se>1?Te.drawElementsInstanced(c,Ge.primitiveLength*Oe,Te.UNSIGNED_SHORT,Ge.primitiveOffset*Oe*2,Se):W?Te.drawElements(c,Ge.primitiveLength*Oe,Te.UNSIGNED_SHORT,Ge.primitiveOffset*Oe*2):Te.drawArrays(c,Ge.vertexOffset,Ge.vertexLength);c===Te.TRIANGLES&&W&&this._drawDebugWireframe(n,d,x,E,W,Ge,Y,se,fe,Se)}}}function cc(p,n,c=0){const d=Math.pow(2,n.tileID.overscaledZ),x=n.tileSize*Math.pow(2,p.transform.tileZoom)/d,E=x*(n.tileID.canonical.x+n.tileID.wrap*d),I=x*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.ay(n,1,p.transform.tileZoom),u_pixel_coord_upper:[E>>16,I>>16],u_pixel_coord_lower:[65535&E,65535&I],u_pattern_transition:c}}const Cl={terrain:0,flat:1},Vr=i.bC(),Jr=(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me)=>{const Te=n.style.light,Oe=Te.properties.get("position"),Le=[Oe.x,Oe.y,Oe.z],Ge=i.dL();Te.properties.get("anchor")==="viewport"&&(i.dM(Ge,-n.transform.angle),i.dN(Le,Le,Ge));const Ue=Te.properties.get("color").toPremultipliedRenderColor(null),Ze=n.transform,$e={u_matrix:p,u_lightpos:Le,u_lightintensity:Te.properties.get("intensity"),u_lightcolor:[Ue.r,Ue.g,Ue.b],u_vertical_gradient:+c,u_opacity:d,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Vr,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Cl[H],u_base_type:Cl[W],u_ao:x,u_edge_radius:E,u_width_scale:I,u_flood_light_color:fe,u_vertical_scale:he,u_flood_light_intensity:Se,u_ground_shadow_factor:me};return Ze.projection.name==="globe"&&($e.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],$e.u_zoom_transition=ee,$e.u_inv_rot_matrix=se,$e.u_merc_center=Y,$e.u_up_dir=Ze.projection.upVector(new i.cC(0,0,0),Y[0]*i.al,Y[1]*i.al),$e.u_height_lift=N),$e},Id=(p,n,c,d,x,E)=>({u_matrix:p,u_edge_radius:n,u_width_scale:c,u_vertical_scale:d,u_height_type:Cl[x],u_base_type:Cl[E]}),Jh=(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me)=>{const Te=Jr(p,n,c,d,x,E,I,D,H,W,ee,Y,se,fe,he,Se,1,[0,0,0]),Oe={u_height_factor:-Math.pow(2,D.overscaledZ)/N.tileSize/8};return Object.assign(Te,cc(n,N,me),Oe)},ef=(p,n,c)=>({u_matrix:p,u_emissive_strength:n,u_ground_shadow_factor:c}),Ml=(p,n,c,d,x,E=0)=>Object.assign(ef(p,n,x),cc(c,d,E)),dh=(p,n,c,d)=>({u_matrix:p,u_world:c,u_emissive_strength:n,u_ground_shadow_factor:d}),Pu=(p,n,c,d,x,E,I=0)=>Object.assign(Ml(p,n,c,d,E,I),{u_world:x}),Pd=(p,n)=>({u_matrix:p,u_ground_shadow_factor:n}),Zl=(p,n,c,d,x)=>({u_matrix:p,u_camera_pos:[n[0],n[1],n[2]],u_depth_bias:c,u_height_scale:d,u_reset_depth:x}),b=(p,n,c,d,x,E,I)=>({u_matrix:p,u_normal_matrix:n,u_opacity:c,u_faux_facade_ao_intensity:d,u_camera_pos:x,u_tile_to_meter:E,u_facade_emissive_chance:I}),w=p=>({u_matrix:p}),S=p=>({u_matrix:p}),R=(p,n,c,d,x,E,I,D)=>{const N=i.al/E.tileSize;return{u_matrix:p,u_inv_rot_matrix:n,u_camera_to_center_distance:c.getCameraToCenterDistance(D),u_extrude_scale:[c.pixelsToGLUnits[0]/N,c.pixelsToGLUnits[1]/N],u_zoom_transition:d,u_tile_id:I,u_merc_center:x}},O=(p,n,c=1)=>({u_matrix:p,u_color:n,u_overlay:0,u_overlay_scale:c}),j=i.bC(),V=(p,n,c,d,x,E,I)=>{const D=p.transform,N=D.projection.name==="globe",H=N?i.dO(D.zoom,n.canonical)*D._pixelsPerMercatorPixel:i.ay(c,1,E),W={u_matrix:n.projMatrix,u_extrude_scale:H,u_intensity:I,u_inv_rot_matrix:j,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){W.u_inv_rot_matrix=d,W.u_merc_center=x,W.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],W.u_zoom_transition=i.aj(D.zoom);const ee=x[0]*i.al,Y=x[1]*i.al;W.u_up_dir=D.projection.upVector(new i.cC(0,0,0),ee,Y)}return W};function Z(p,[n,c,d,x],[E,I]){if(E===I)return[0,0,0,0];const D=255*(p-1)/(p*(I-E));return[n*D,c*D,d*D,x*D]}function re(p,n,[c,d]){return c===d?0:.5/p+(n-c)*(p-1)/(p*(d-c))}const pe=(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me,Te,Oe,Le)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:c,u_merc_matrix:d,u_grid_matrix:x,u_tl_parent:E,u_scale_parent:H,u_fade_t:W.mix,u_opacity:W.opacity*ee.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ee.paint.get("raster-brightness-min"),u_brightness_high:ee.paint.get("raster-brightness-max"),u_saturation_factor:i.dQ(ee.paint.get("raster-saturation")),u_contrast_factor:i.dP(ee.paint.get("raster-contrast")),u_spin_weights:xe(ee.paint.get("raster-hue-rotate")),u_perspective_transform:Y,u_raster_elevation:se,u_zoom_transition:I,u_merc_center:D,u_cutoff_params:N,u_colorization_mix:Z(i.dR,he,me),u_colorization_offset:re(i.dR,Se,me),u_color_ramp:fe,u_texture_offset:[Oe/(Te+2*Oe),Te/(Te+2*Oe)],u_texture_res:[Te+2*Oe,Te+2*Oe],u_emissive_strength:Le});function xe(p){p*=Math.PI/180;const n=Math.sin(p),c=Math.cos(p);return[(2*c+1)/3,(-Math.sqrt(3)*n-c+1)/3,(Math.sqrt(3)*n-c+1)/3]}const qe=.05,nt=(p,n,c,d,x,E,I,D,N,H,W,ee)=>({u_matrix:p,u_normalize_matrix:n,u_globe_matrix:c,u_merc_matrix:d,u_grid_matrix:x,u_tl_parent:E,u_scale_parent:H,u_fade_t:W.mix,u_opacity:W.opacity,u_image0:0,u_image1:1,u_raster_elevation:ee,u_zoom_transition:I,u_merc_center:D,u_cutoff_params:N}),ot=(p,n,c,d,x,E,I,D,N,H)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_tile_offset:c,u_velocity:d,u_color_ramp:E,u_velocity_res:x,u_max_speed:I,u_uv_offset:D,u_data_scale:[255*N[0],255*N[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[qe,qe]}),at=(p,n,c,d,x,E,I,D,N,H)=>({u_particle_texture:p,u_particle_texture_side_len:n,u_velocity:c,u_velocity_res:d,u_max_speed:x,u_speed_factor:E,u_reset_rate:I,u_rand_seed:Math.random(),u_uv_offset:D,u_data_scale:[255*N[0],255*N[1]],u_data_offset:H,u_particle_pos_scale:1.1,u_particle_pos_offset:[qe,qe]}),Rt=i.bC(),jt=(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me,Te,Oe,Le,Ge,Ue,Ze)=>{const $e=x.transform,Ve={u_is_size_zoom_constant:+(p==="constant"||p==="source"),u_is_size_feature_constant:+(p==="constant"||p==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:$e.getCameraToCenterDistance(Te),u_rotate_symbol:+c,u_aspect_ratio:$e.width/$e.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:I,u_coord_matrix:D,u_is_text:+H,u_elevation_from_sea:N?1:0,u_pitch_with_map:+d,u_texsize:W,u_texsize_icon:ee,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Rt,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Rt,u_up_vector:[0,-1,0],u_color_adj_mat:Ge,u_icon_transition:Ue||0,u_gamma_scale:d?x.transform.getCameraToCenterDistance(Te)*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:i.o.devicePixelRatio,u_is_halo:1,u_scale_factor:Ze||1,u_ground_shadow_factor:Oe,u_inv_matrix:i.bl(i.bC(),I),u_normal_scale:Le,u_lutTexture:Ki.LUT};return Te.name==="globe"&&(Ve.u_tile_id=[se.canonical.x,se.canonical.y,1<<se.canonical.z],Ve.u_zoom_transition=fe,Ve.u_inv_rot_matrix=Se,Ve.u_merc_center=he,Ve.u_camera_forward=$e._camera.forward(),Ve.u_ecef_origin=i.dS($e.globeMatrix,se.toUnwrapped()),Ve.u_tile_matrix=Float32Array.from($e.globeMatrix),Ve.u_up_vector=me),Ve},fr=(p,n,c,d)=>({u_matrix:p,u_emissive_strength:n,u_opacity:c,u_color:d}),Qt=(p,n,c,d,x,E,I,D,N)=>Object.assign((function(H,W,ee,Y,se,fe){const{width:he,height:Se}=Y.imageManager.getPixelSize(W),me=Math.pow(2,fe.tileID.overscaledZ),Te=fe.tileSize*Math.pow(2,Y.transform.tileZoom)/me,Oe=Te*(fe.tileID.canonical.x+fe.tileID.wrap*me),Le=Te*fe.tileID.canonical.y;return{u_image:0,u_pattern_tl:ee.tl,u_pattern_br:ee.br,u_texsize:[he,Se],u_pattern_size:ee.displaySize,u_pattern_units_to_pixels:se?[Y.transform.width,-1*Y.transform.height]:[1/i.ay(fe,1,Y.transform.tileZoom),1/i.ay(fe,1,Y.transform.tileZoom)],u_pixel_coord_upper:[Oe>>16,Le>>16],u_pixel_coord_lower:[65535&Oe,65535&Le]}})(0,E,I,d,D,N),{u_matrix:p,u_emissive_strength:n,u_opacity:c}),qt=new Float32Array(i.bA([])),Dt=(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se=[0,0,0],fe)=>{const he=x.style.light,Se=he.properties.get("position"),me=[-Se.x,-Se.y,Se.z],Te=i.dL();he.properties.get("anchor")==="viewport"&&(i.dM(Te,-x.transform.angle),i.dN(me,me,Te));const Oe=W.alphaMode==="MASK",Le=he.properties.get("color").toNonPremultipliedRenderColor(null),Ge=Y.paint.get("model-ambient-occlusion-intensity"),Ue=Y.paint.get("model-color").constantOr(i.ao.white).toNonPremultipliedRenderColor(null);return Ue.a=Y.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:p,u_lighting_matrix:n,u_normal_matrix:c,u_node_matrix:d||qt,u_lightpos:me,u_lightintensity:he.properties.get("intensity"),u_lightcolor:[Le.r,Le.g,Le.b],u_camera_pos:se,u_opacity:E,u_baseTextureIsAlpha:0,u_alphaMask:+Oe,u_alphaCutoff:W.alphaCutoff,u_baseColorFactor:I.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:D.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:N,u_roughnessFactor:H,u_baseColorTexture:Ki.BaseColor,u_metallicRoughnessTexture:Ki.MetallicRoughness,u_normalTexture:Ki.Normal,u_occlusionTexture:Ki.Occlusion,u_emissionTexture:Ki.Emission,u_lutTexture:Ki.LUT,u_color_mix:Ue.toArray01(),u_aoIntensity:Ge,u_emissive_strength:ee,u_occlusionTextureTransform:fe||[0,0,0,0]}},yr=(p,n=qt,c=qt)=>({u_matrix:p,u_instance:n,u_node_matrix:c}),fn={fillExtrusion:p=>({u_matrix:new i.ck(p),u_lightpos:new i.ch(p),u_lightintensity:new i.ci(p),u_lightcolor:new i.ch(p),u_vertical_gradient:new i.ci(p),u_opacity:new i.ci(p),u_edge_radius:new i.ci(p),u_width_scale:new i.ci(p),u_ao:new i.cj(p),u_height_type:new i.cg(p),u_base_type:new i.cg(p),u_tile_id:new i.ch(p),u_zoom_transition:new i.ci(p),u_inv_rot_matrix:new i.ck(p),u_merc_center:new i.cj(p),u_up_dir:new i.ch(p),u_height_lift:new i.ci(p),u_flood_light_color:new i.ch(p),u_vertical_scale:new i.ci(p),u_flood_light_intensity:new i.ci(p),u_ground_shadow_factor:new i.ch(p)}),fillExtrusionDepth:p=>({u_matrix:new i.ck(p),u_edge_radius:new i.ci(p),u_width_scale:new i.ci(p),u_vertical_scale:new i.ci(p),u_height_type:new i.cg(p),u_base_type:new i.cg(p)}),fillExtrusionPattern:p=>({u_matrix:new i.ck(p),u_lightpos:new i.ch(p),u_lightintensity:new i.ci(p),u_lightcolor:new i.ch(p),u_vertical_gradient:new i.ci(p),u_height_factor:new i.ci(p),u_edge_radius:new i.ci(p),u_width_scale:new i.ci(p),u_ao:new i.cj(p),u_height_type:new i.cg(p),u_base_type:new i.cg(p),u_tile_id:new i.ch(p),u_zoom_transition:new i.ci(p),u_inv_rot_matrix:new i.ck(p),u_merc_center:new i.cj(p),u_up_dir:new i.ch(p),u_height_lift:new i.ci(p),u_image:new i.cg(p),u_texsize:new i.cj(p),u_pixel_coord_upper:new i.cj(p),u_pixel_coord_lower:new i.cj(p),u_tile_units_to_pixels:new i.ci(p),u_opacity:new i.ci(p),u_pattern_transition:new i.ci(p)}),fillExtrusionGroundEffect:p=>({u_matrix:new i.ck(p),u_opacity:new i.ci(p),u_ao_pass:new i.ci(p),u_meter_to_tile:new i.ci(p),u_ao:new i.cj(p),u_flood_light_intensity:new i.ci(p),u_flood_light_color:new i.ch(p),u_attenuation:new i.ci(p),u_edge_radius:new i.ci(p),u_fb:new i.cg(p),u_fb_size:new i.ci(p),u_dynamic_offset:new i.ci(p)}),fill:p=>({u_matrix:new i.ck(p),u_emissive_strength:new i.ci(p),u_ground_shadow_factor:new i.ch(p)}),fillPattern:p=>({u_matrix:new i.ck(p),u_emissive_strength:new i.ci(p),u_image:new i.cg(p),u_texsize:new i.cj(p),u_pixel_coord_upper:new i.cj(p),u_pixel_coord_lower:new i.cj(p),u_tile_units_to_pixels:new i.ci(p),u_ground_shadow_factor:new i.ch(p),u_pattern_transition:new i.ci(p)}),fillOutline:p=>({u_matrix:new i.ck(p),u_emissive_strength:new i.ci(p),u_world:new i.cj(p),u_ground_shadow_factor:new i.ch(p)}),fillOutlinePattern:p=>({u_matrix:new i.ck(p),u_emissive_strength:new i.ci(p),u_world:new i.cj(p),u_image:new i.cg(p),u_texsize:new i.cj(p),u_pixel_coord_upper:new i.cj(p),u_pixel_coord_lower:new i.cj(p),u_tile_units_to_pixels:new i.ci(p),u_ground_shadow_factor:new i.ch(p),u_pattern_transition:new i.ci(p)}),building:p=>({u_matrix:new i.ck(p),u_normal_matrix:new i.ck(p),u_opacity:new i.ci(p),u_faux_facade_ao_intensity:new i.ci(p),u_camera_pos:new i.ch(p),u_tile_to_meter:new i.ci(p),u_facade_emissive_chance:new i.ci(p)}),buildingBloom:p=>({u_matrix:new i.ck(p)}),buildingDepth:p=>({u_matrix:new i.ck(p)}),elevatedStructuresDepth:p=>({u_matrix:new i.ck(p),u_depth_bias:new i.ci(p)}),elevatedStructures:p=>({u_matrix:new i.ck(p),u_ground_shadow_factor:new i.ch(p)}),elevatedStructuresDepthReconstruct:p=>({u_matrix:new i.ck(p),u_camera_pos:new i.ch(p),u_depth_bias:new i.ci(p),u_height_scale:new i.ci(p),u_reset_depth:new i.ci(p)}),circle:i.dV,collisionBox:p=>({u_matrix:new i.ck(p),u_inv_rot_matrix:new i.ck(p),u_camera_to_center_distance:new i.ci(p),u_extrude_scale:new i.cj(p),u_zoom_transition:new i.ci(p),u_merc_center:new i.cj(p),u_tile_id:new i.ch(p)}),collisionCircle:p=>({u_matrix:new i.ck(p),u_inv_matrix:new i.ck(p),u_camera_to_center_distance:new i.ci(p),u_viewport_size:new i.cj(p)}),debug:p=>({u_color:new i.dx(p),u_matrix:new i.ck(p),u_overlay:new i.cg(p),u_overlay_scale:new i.ci(p)}),clippingMask:p=>({u_matrix:new i.ck(p)}),heatmap:p=>({u_extrude_scale:new i.ci(p),u_intensity:new i.ci(p),u_matrix:new i.ck(p),u_inv_rot_matrix:new i.ck(p),u_merc_center:new i.cj(p),u_tile_id:new i.ch(p),u_zoom_transition:new i.ci(p),u_up_dir:new i.ch(p)}),heatmapTexture:p=>({u_image:new i.cg(p),u_color_ramp:new i.cg(p),u_opacity:new i.ci(p)}),hillshade:p=>({u_matrix:new i.ck(p),u_image:new i.cg(p),u_latrange:new i.cj(p),u_light:new i.cj(p),u_shadow:new i.dx(p),u_highlight:new i.dx(p),u_emissive_strength:new i.ci(p),u_accent:new i.dx(p)}),hillshadePrepare:p=>({u_matrix:new i.ck(p),u_image:new i.cg(p),u_dimension:new i.cj(p),u_zoom:new i.ci(p)}),line:i.dU,linePattern:i.dT,raster:p=>({u_matrix:new i.ck(p),u_normalize_matrix:new i.ck(p),u_globe_matrix:new i.ck(p),u_merc_matrix:new i.ck(p),u_grid_matrix:new i.dy(p),u_tl_parent:new i.cj(p),u_scale_parent:new i.ci(p),u_fade_t:new i.ci(p),u_opacity:new i.ci(p),u_image0:new i.cg(p),u_image1:new i.cg(p),u_brightness_low:new i.ci(p),u_brightness_high:new i.ci(p),u_saturation_factor:new i.ci(p),u_contrast_factor:new i.ci(p),u_spin_weights:new i.ch(p),u_perspective_transform:new i.cj(p),u_raster_elevation:new i.ci(p),u_zoom_transition:new i.ci(p),u_merc_center:new i.cj(p),u_cutoff_params:new i.d2(p),u_colorization_mix:new i.d2(p),u_colorization_offset:new i.ci(p),u_color_ramp:new i.cg(p),u_texture_offset:new i.cj(p),u_texture_res:new i.cj(p),u_emissive_strength:new i.ci(p)}),rasterParticle:p=>({u_matrix:new i.ck(p),u_normalize_matrix:new i.ck(p),u_globe_matrix:new i.ck(p),u_merc_matrix:new i.ck(p),u_grid_matrix:new i.dy(p),u_tl_parent:new i.cj(p),u_scale_parent:new i.ci(p),u_fade_t:new i.ci(p),u_opacity:new i.ci(p),u_image0:new i.cg(p),u_image1:new i.cg(p),u_raster_elevation:new i.ci(p),u_zoom_transition:new i.ci(p),u_merc_center:new i.cj(p),u_cutoff_params:new i.d2(p)}),rasterParticleTexture:p=>({u_texture:new i.cg(p),u_opacity:new i.ci(p)}),rasterParticleDraw:p=>({u_particle_texture:new i.cg(p),u_particle_texture_side_len:new i.ci(p),u_tile_offset:new i.cj(p),u_velocity:new i.cg(p),u_color_ramp:new i.cg(p),u_velocity_res:new i.cj(p),u_max_speed:new i.ci(p),u_uv_offset:new i.cj(p),u_data_scale:new i.cj(p),u_data_offset:new i.ci(p),u_particle_pos_scale:new i.ci(p),u_particle_pos_offset:new i.cj(p)}),rasterParticleUpdate:p=>({u_particle_texture:new i.cg(p),u_particle_texture_side_len:new i.ci(p),u_velocity:new i.cg(p),u_velocity_res:new i.cj(p),u_max_speed:new i.ci(p),u_speed_factor:new i.ci(p),u_reset_rate:new i.ci(p),u_rand_seed:new i.ci(p),u_uv_offset:new i.cj(p),u_data_scale:new i.cj(p),u_data_offset:new i.ci(p),u_particle_pos_scale:new i.ci(p),u_particle_pos_offset:new i.cj(p)}),symbol:p=>({u_is_size_zoom_constant:new i.cg(p),u_is_size_feature_constant:new i.cg(p),u_size_t:new i.ci(p),u_size:new i.ci(p),u_camera_to_center_distance:new i.ci(p),u_rotate_symbol:new i.cg(p),u_aspect_ratio:new i.ci(p),u_fade_change:new i.ci(p),u_matrix:new i.ck(p),u_label_plane_matrix:new i.ck(p),u_coord_matrix:new i.ck(p),u_is_text:new i.cg(p),u_elevation_from_sea:new i.cg(p),u_pitch_with_map:new i.cg(p),u_texsize:new i.cj(p),u_texsize_icon:new i.cj(p),u_texture:new i.cg(p),u_texture_icon:new i.cg(p),u_gamma_scale:new i.ci(p),u_device_pixel_ratio:new i.ci(p),u_tile_id:new i.ch(p),u_zoom_transition:new i.ci(p),u_inv_rot_matrix:new i.ck(p),u_merc_center:new i.cj(p),u_camera_forward:new i.ch(p),u_tile_matrix:new i.ck(p),u_up_vector:new i.ch(p),u_ecef_origin:new i.ch(p),u_is_halo:new i.cg(p),u_icon_transition:new i.ci(p),u_color_adj_mat:new i.ck(p),u_scale_factor:new i.ci(p),u_ground_shadow_factor:new i.ch(p),u_inv_matrix:new i.ck(p),u_normal_scale:new i.ci(p),u_lutTexture:new i.cg(p)}),background:p=>({u_matrix:new i.ck(p),u_emissive_strength:new i.ci(p),u_opacity:new i.ci(p),u_color:new i.dx(p)}),backgroundPattern:p=>({u_matrix:new i.ck(p),u_emissive_strength:new i.ci(p),u_opacity:new i.ci(p),u_image:new i.cg(p),u_pattern_tl:new i.cj(p),u_pattern_br:new i.cj(p),u_texsize:new i.cj(p),u_pattern_size:new i.cj(p),u_pixel_coord_upper:new i.cj(p),u_pixel_coord_lower:new i.cj(p),u_pattern_units_to_pixels:new i.cj(p)}),terrainRaster:p=>({u_matrix:new i.ck(p),u_image0:new i.cg(p),u_skirt_height:new i.ci(p),u_ground_shadow_factor:new i.ch(p)}),skybox:p=>({u_matrix:new i.ck(p),u_sun_direction:new i.ch(p),u_cubemap:new i.cg(p),u_opacity:new i.ci(p),u_temporal_offset:new i.ci(p)}),skyboxGradient:p=>({u_matrix:new i.ck(p),u_color_ramp:new i.cg(p),u_center_direction:new i.ch(p),u_radius:new i.ci(p),u_opacity:new i.ci(p),u_temporal_offset:new i.ci(p)}),skyboxCapture:p=>({u_matrix_3f:new i.dy(p),u_sun_direction:new i.ch(p),u_sun_intensity:new i.ci(p),u_color_tint_r:new i.d2(p),u_color_tint_m:new i.d2(p),u_luminance:new i.ci(p)}),globeRaster:p=>({u_proj_matrix:new i.ck(p),u_globe_matrix:new i.ck(p),u_normalize_matrix:new i.ck(p),u_merc_matrix:new i.ck(p),u_zoom_transition:new i.ci(p),u_merc_center:new i.cj(p),u_image0:new i.cg(p),u_grid_matrix:new i.dy(p),u_skirt_height:new i.ci(p),u_far_z_cutoff:new i.ci(p),u_frustum_tl:new i.ch(p),u_frustum_tr:new i.ch(p),u_frustum_br:new i.ch(p),u_frustum_bl:new i.ch(p),u_globe_pos:new i.ch(p),u_globe_radius:new i.ci(p),u_viewport:new i.cj(p)}),globeAtmosphere:p=>({u_frustum_tl:new i.ch(p),u_frustum_tr:new i.ch(p),u_frustum_br:new i.ch(p),u_frustum_bl:new i.ch(p),u_horizon:new i.ci(p),u_transition:new i.ci(p),u_fadeout_range:new i.ci(p),u_atmosphere_fog_color:new i.d2(p),u_high_color:new i.d2(p),u_space_color:new i.d2(p),u_temporal_offset:new i.ci(p),u_horizon_angle:new i.ci(p)}),model:p=>({u_matrix:new i.ck(p),u_lighting_matrix:new i.ck(p),u_normal_matrix:new i.ck(p),u_node_matrix:new i.ck(p),u_lightpos:new i.ch(p),u_lightintensity:new i.ci(p),u_lightcolor:new i.ch(p),u_camera_pos:new i.ch(p),u_opacity:new i.ci(p),u_baseColorFactor:new i.d2(p),u_emissiveFactor:new i.d2(p),u_metallicFactor:new i.ci(p),u_roughnessFactor:new i.ci(p),u_baseTextureIsAlpha:new i.cg(p),u_alphaMask:new i.cg(p),u_alphaCutoff:new i.ci(p),u_baseColorTexture:new i.cg(p),u_metallicRoughnessTexture:new i.cg(p),u_normalTexture:new i.cg(p),u_occlusionTexture:new i.cg(p),u_emissionTexture:new i.cg(p),u_lutTexture:new i.cg(p),u_color_mix:new i.d2(p),u_aoIntensity:new i.ci(p),u_emissive_strength:new i.ci(p),u_occlusionTextureTransform:new i.d2(p)}),modelDepth:p=>({u_matrix:new i.ck(p),u_instance:new i.ck(p),u_node_matrix:new i.ck(p)}),groundShadow:p=>({u_matrix:new i.ck(p),u_ground_shadow_factor:new i.ch(p)}),stars:p=>({u_matrix:new i.ck(p),u_up:new i.ch(p),u_right:new i.ch(p),u_intensity_multiplier:new i.ci(p)}),snowParticle:p=>({u_modelview:new i.ck(p),u_projection:new i.ck(p),u_time:new i.ci(p),u_cam_pos:new i.ch(p),u_velocityConeAperture:new i.ci(p),u_velocity:new i.ci(p),u_horizontalOscillationRadius:new i.ci(p),u_horizontalOscillationRate:new i.ci(p),u_boxSize:new i.ci(p),u_billboardSize:new i.ci(p),u_simpleShapeParameters:new i.cj(p),u_screenSize:new i.cj(p),u_thinningCenterPos:new i.cj(p),u_thinningShape:new i.ch(p),u_thinningAffectedRatio:new i.ci(p),u_thinningParticleOffset:new i.ci(p),u_particleColor:new i.d2(p),u_direction:new i.ch(p)}),rainParticle:p=>({u_modelview:new i.ck(p),u_projection:new i.ck(p),u_time:new i.ci(p),u_cam_pos:new i.ch(p),u_texScreen:new i.cg(p),u_velocityConeAperture:new i.ci(p),u_velocity:new i.ci(p),u_boxSize:new i.ci(p),u_rainDropletSize:new i.cj(p),u_distortionStrength:new i.ci(p),u_rainDirection:new i.ch(p),u_color:new i.d2(p),u_screenSize:new i.cj(p),u_thinningCenterPos:new i.cj(p),u_thinningShape:new i.ch(p),u_thinningAffectedRatio:new i.ci(p),u_thinningParticleOffset:new i.ci(p),u_shapeDirectionalPower:new i.ci(p),u_shapeNormalPower:new i.ci(p),u_mode:new i.ci(p)}),vignette:p=>({u_vignetteShape:new i.ch(p),u_vignetteColor:new i.d2(p)}),occlusion:p=>({u_matrix:new i.ck(p),u_anchorPos:new i.ch(p),u_screenSizePx:new i.cj(p),u_occluderSizePx:new i.cj(p),u_color:new i.d2(p)})};class an{constructor(n,c,d,x){this.id=an.uniqueIdxCounter,an.uniqueIdxCounter++,this.context=n;const E=n.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!d,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||x||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=an.uniqueIdxCounter,an.uniqueIdxCounter++;const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}an.uniqueIdxCounter=0;const ci={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ui{constructor(n,c,d,x,E,I){this.length=c.length,this.attributes=d,this.itemSize=c.bytesPerElement,this.dynamicDraw=x,this.instanceCount=I,this.context=n;const D=n.gl;this.buffer=D.createBuffer(),n.bindVertexBuffer.set(this.buffer),D.bufferData(D.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?D.DYNAMIC_DRAW:D.STATIC_DRAW),this.dynamicDraw||E||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,c){for(let d=0;d<this.attributes.length;d++){const x=c.getAttributeLocation(n,this.attributes[d].name);x!==-1&&n.enableVertexAttribArray(x)}}setVertexAttribPointers(n,c,d){for(let x=0;x<this.attributes.length;x++){const E=this.attributes[x],I=c.getAttributeLocation(n,E.name);I!==-1&&n.vertexAttribPointer(I,E.components,n[ci[E.type]],!1,this.itemSize,E.offset+this.itemSize*(d||0))}}setVertexAttribDivisor(n,c,d){for(let x=0;x<this.attributes.length;x++){const E=c.getAttributeLocation(n,this.attributes[x].name);E!==-1&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(E,d)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class yi{constructor(n,c,d,x,E){this.context=n,this.width=c,this.height=d;const I=this.framebuffer=n.gl.createFramebuffer();x&&(this.colorAttachment=new fp(n,I)),E&&(this.depthAttachmentType=E,this.depthAttachment=E==="renderbuffer"?new Cd(n,I):new jf(n,I))}destroy(){const n=this.context.gl;if(this.colorAttachment){const c=this.colorAttachment.get();c&&n.deleteTexture(c)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const c=this.depthAttachment.get();c&&n.deleteRenderbuffer(c)}else{const c=this.depthAttachment.get();c&&n.deleteTexture(c)}n.deleteFramebuffer(this.framebuffer)}}class ni{constructor(n,c){this.gl=n,this.clearColor=new Ff(this),this.clearDepth=new uh(this),this.clearStencil=new bu(this),this.colorMask=new Td(this),this.depthMask=new up(this),this.stencilMask=new Hl(this),this.stencilFunc=new bs(this),this.stencilOp=new hh(this),this.stencilTest=new Ds(this),this.depthRange=new lc(this),this.depthTest=new Oc(this),this.depthFunc=new Ed(this),this.blend=new wu(this),this.blendFunc=new Nf(this),this.blendColor=new ka(this),this.blendEquation=new Jo(this),this.cullFace=new To(this),this.cullFaceSide=new kc(this),this.frontFace=new Xs(this),this.program=new hp(this),this.activeTexture=new Su(this),this.viewport=new rm(this),this.bindFramebuffer=new Xh(this),this.bindRenderbuffer=new Tu(this),this.bindTexture=new Eu(this),this.bindVertexBuffer=new va(this),this.bindElementBuffer=new fh(this),this.bindVertexArrayOES=new Yh(this),this.pixelStoreUnpack=new ql(this),this.pixelStoreUnpackPremultiplyAlpha=new za(this),this.pixelStoreUnpackFlipY=new Cu(this),this.options=c?Object.assign({},c):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=c&&!!c.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.maxPointSize=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,c,d){return new an(this,n,c,d)}createVertexBuffer(n,c,d,x,E){return new ui(this,n,c,d,x,E)}createRenderbuffer(n,c,d){const x=this.gl,E=x.createRenderbuffer();return this.bindRenderbuffer.set(E),x.renderbufferStorage(x.RENDERBUFFER,n,c,d),this.bindRenderbuffer.set(null),E}createFramebuffer(n,c,d,x){return new yi(this,n,c,d,x)}clear({color:n,depth:c,stencil:d,colorMask:x}){const E=this.gl;let I=0;n&&(I|=E.COLOR_BUFFER_BIT,this.clearColor.set(n.toNonPremultipliedRenderColor(null)),this.colorMask.set(x||[!0,!0,!0,!0])),c!==void 0&&(I|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),d!==void 0&&(I|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(d),this.stencilMask.set(255)),E.clear(I)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){i.by(n.blendFunction,Mn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Tn;function Wr(p,n,c,d,x,E,I){const D=p.context,N=D.gl,H=p.transform,W=[i.aF(H.center.lng),i.aJ(H.center.lat)],ee=c.layout.get("symbol-placement"),Y=c.layout.get("text-variable-anchor"),se=c.layout.get("icon-rotation-alignment")==="map",fe=c.layout.get("text-rotation-alignment")==="map",he=ee!=="point",Se=[];let me=0,Te=0;for(let Ve=0;Ve<d.length;Ve++){const We=d[Ve],yt=n.getTile(We),lt=yt.getBucket(c);if(!lt)continue;const Ot=lt.getProjection().createInversionMatrix(H,We.canonical),_t=[],It=Ms(We,lt,H),ur=!I&&se&&he,xt=I&&fe&&he,rt=Y&&lt.hasTextData(),zt=lt.hasIconTextFit()&&rt&&lt.hasIconData(),gt=ur||xt||I&&rt||zt,Bt=lt.projection.name==="globe",Gt=Bt?i.aj(H.zoom):0;Bt&&(_t.push("PROJECTION_GLOBE_VIEW"),gt&&_t.push("PROJECTED_POS_ON_VIEWPORT"));const ar=p.getOrCreateProgram("collisionBox",{defines:_t});let Ht=It;x[0]===0&&x[1]===0||(Ht=p.translatePosMatrix(It,yt,x,E));const Xt=I?lt.textCollisionBox:lt.iconCollisionBox,qr=lt.collisionCircleArray;if(qr.length>0){const Yr=i.bC(),Lr=Ht;i.cO(Yr,lt.placementInvProjMatrix,H.glCoordMatrix),i.cO(Yr,Yr,lt.placementViewportMatrix),Se.push({circleArray:qr,circleOffset:Te,transform:Lr,invTransform:Yr,projection:lt.getProjection()}),me+=qr.length/4,Te=me}if(!Xt)continue;p.terrain&&p.terrain.setupElevationDraw(yt,ar);const $r=Bt?[We.canonical.x,We.canonical.y,1<<We.canonical.z]:[0,0,0];ar.draw(p,N.LINES,Mr.disabled,cn.disabled,p.colorModeForRenderPass(),gn.disabled,R(Ht,Ot,H,Gt,W,yt,$r,lt.getProjection()),c.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,null,H.zoom,null,[Xt.collisionVertexBuffer,Xt.collisionVertexBufferExt])}if(!I||!Se.length)return;const Oe=p.getOrCreateProgram("collisionCircle"),Le=new i.dW;Le.resize(4*me),Le._trim();let Ge=0;for(const Ve of Se)for(let We=0;We<Ve.circleArray.length/4;We++){const yt=4*We,lt=Ve.circleArray[yt+0],Ot=Ve.circleArray[yt+1],_t=Ve.circleArray[yt+2],It=Ve.circleArray[yt+3];Le.emplace(Ge++,lt,Ot,_t,It,0),Le.emplace(Ge++,lt,Ot,_t,It,1),Le.emplace(Ge++,lt,Ot,_t,It,2),Le.emplace(Ge++,lt,Ot,_t,It,3)}(!Tn||Tn.length<2*me)&&(Tn=(function(Ve){const We=2*Ve,yt=new i.b1;yt.resize(We),yt._trim();for(let lt=0;lt<We;lt++){const Ot=6*lt;yt.uint16[Ot+0]=4*lt+0,yt.uint16[Ot+1]=4*lt+1,yt.uint16[Ot+2]=4*lt+2,yt.uint16[Ot+3]=4*lt+2,yt.uint16[Ot+4]=4*lt+3,yt.uint16[Ot+5]=4*lt+0}return yt})(me));const Ue=D.createIndexBuffer(Tn,!0),Ze=D.createVertexBuffer(Le,i.dX.members,!0);for(const Ve of Se){const We={u_matrix:Ve.transform,u_inv_matrix:Ve.invTransform,u_camera_to_center_distance:($e=H).getCameraToCenterDistance(Ve.projection),u_viewport_size:[$e.width,$e.height]};Oe.draw(p,N.TRIANGLES,Mr.disabled,cn.disabled,p.colorModeForRenderPass(),gn.disabled,We,c.id,Ze,Ue,i.bg.simpleSegment(0,2*Ve.circleOffset,Ve.circleArray.length,Ve.circleArray.length/2),null,H.zoom)}var $e;Ze.destroy(),Ue.destroy()}const pi=i.bC();function hi(p){const n=p._camera.getWorldToCamera(p.worldSize,1),c=i.aB([],n,p.globeMatrix);i.bl(c,c);const d=[0,0,0],x=[0,1,0,0];return i.aC(x,x,c),d[0]=x[0],d[1]=x[1],d[2]=x[2],i.aw(d,d),d}function mi({width:p,height:n,anchor:c,textOffset:d,textScale:x},E){const{horizontalAlign:I,verticalAlign:D}=i.c0(c),N=-(I-.5)*p,H=-(D-.5)*n,W=i.c1(c,d);return new i.P((N/x+W[0])*E,(H/x+W[1])*E)}function Eo(p,n,c,d,x,E,I,D,N,H){const W=p.text.placedSymbolArray,ee=p.text.dynamicLayoutVertexArray,Y=p.icon.dynamicLayoutVertexArray,se={},fe=p.getProjection(),he=bl(I,fe,x),Se=x.elevation,me=fe.upVectorScale(I.canonical,x.center.lat,x.worldSize).metersToTile;ee.clear();for(let Te=0;Te<W.length;Te++){const Oe=W.get(Te),{tileAnchorX:Le,tileAnchorY:Ge,numGlyphs:Ue}=Oe,Ze=Oe.hidden||!Oe.crossTileID||p.allowVerticalPlacement&&!Oe.placedOrientation?null:d[Oe.crossTileID];if(Ze){let $e=0,Ve=0,We=0;if(Se){const zt=Se?Se.getAtTileOffset(I,Le,Ge):0,[gt,Bt,Gt]=fe.upVector(I.canonical,Le,Ge);$e=zt*gt*me,Ve=zt*Bt*me,We=zt*Gt*me}let[yt,lt,Ot,_t]=qs(Oe.projectedAnchorX+$e,Oe.projectedAnchorY+Ve,Oe.projectedAnchorZ+We,c?he:E);const It=Tc(x.getCameraToCenterDistance(fe),_t);let ur=i.bM(p.textSizeData,N,Oe)*It/i.bX;c&&(ur*=p.tilePixelRatio/D);const xt=mi(Ze,ur);c?({x:yt,y:lt,z:Ot}=fe.projectTilePoint(Le+xt.x,Ge+xt.y,I.canonical),[yt,lt,Ot]=qs(yt+$e,lt+Ve,Ot+We,E)):(n&&xt._rotate(-x.angle),yt+=xt.x,lt+=xt.y,Ot=0);const rt=p.allowVerticalPlacement&&Oe.placedOrientation===i.bL.vertical?Math.PI/2:0;for(let zt=0;zt<Ue;zt++)i.bO(ee,yt,lt,Ot,rt);H&&Oe.associatedIconIndex>=0&&(se[Oe.associatedIconIndex]={x:yt,y:lt,z:Ot,angle:rt})}else hn(Ue,ee)}if(H){Y.clear();const Te=p.icon.placedSymbolArray;for(let Oe=0;Oe<Te.length;Oe++){const Le=Te.get(Oe),{numGlyphs:Ge}=Le,Ue=se[Oe];if(Le.hidden||!Ue)hn(Ge,Y);else{const{x:Ze,y:$e,z:Ve,angle:We}=Ue;for(let yt=0;yt<Ge;yt++)i.bO(Y,Ze,$e,Ve,We)}}p.icon.dynamicLayoutVertexBuffer.updateData(Y)}p.text.dynamicLayoutVertexBuffer.updateData(ee)}function Ha(p,n,c,d,x,E,I={}){const D=c.paint.get("icon-translate"),N=c.paint.get("text-translate"),H=c.paint.get("icon-translate-anchor"),W=c.paint.get("text-translate-anchor"),ee=c.layout.get("icon-rotation-alignment"),Y=c.layout.get("text-rotation-alignment"),se=c.layout.get("icon-pitch-alignment"),fe=c.layout.get("text-pitch-alignment"),he=c.layout.get("icon-keep-upright"),Se=c.layout.get("text-keep-upright"),me=c.paint.get("icon-color-saturation"),Te=c.paint.get("icon-color-contrast"),Oe=c.paint.get("icon-color-brightness-min"),Le=c.paint.get("icon-color-brightness-max"),Ge=c.layout.get("symbol-elevation-reference")==="sea",Ue=c.layout.get("icon-image-use-theme")==="none",Ze=p.context,$e=Ze.gl,Ve=p.transform,We=ee==="map",yt=Y==="map",lt=se==="map",Ot=fe==="map",_t=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let It=!1;const ur=p.depthModeForSublayer(0,Mr.ReadOnly),xt=new Mr(p.context.gl.LEQUAL,Mr.ReadOnly,p.depthRangeFor3D),rt=[i.aF(Ve.center.lng),i.aJ(Ve.center.lat)],zt=c.layout.get("text-variable-anchor"),gt=Ve.projection.name==="globe",Bt=[],Gt=[0,-1,0];for(const ar of d){const Ht=n.getTile(ar),Xt=Ht.getBucket(c);if(!Xt||Xt.projection.name==="mercator"&&gt||Xt.fullyClipped)continue;const qr=Xt.projection.name==="globe",$r=qr?i.aj(Ve.zoom):0,Yr=bl(ar,Xt.getProjection(),Ve),Lr=Ve.calculatePixelsToTileUnitsMatrix(Ht),rn=zt&&Xt.hasTextData(),En=Xt.hasIconTextFit()&&rn&&Xt.hasIconData(),In=Xt.getProjection().createInversionMatrix(Ve,ar.canonical),ki=(1<<Ht.tileID.canonical.z)*i.al/p.transform.worldSize,_n=so=>{let Pn=[0,0,0];if(so){const An=p.style.directionalLight,zi=p.style.ambientLight;An&&zi&&(Pn=vs(p.style,An,zi))}return Pn},si=so=>{Ve.depthOcclusionForSymbolsAndCircles&&(c.hasOcclusionOpacityProperties||p.terrain)&&(so.push("DEPTH_D24"),so.push("DEPTH_OCCLUSION"))},xi=so=>{c.lut&&!Ue&&(c.lut.texture||(c.lut.texture=new i.dY(p.context,c.lut.image,[c.lut.image.height,c.lut.image.height,c.lut.image.height],Ze.gl.RGBA8)),Ze.activeTexture.set(Ze.gl.TEXTURE0+Ki.LUT),c.lut.texture&&c.lut.texture.bind(Ze.gl.LINEAR,Ze.gl.CLAMP_TO_EDGE),so.push("APPLY_LUT_ON_GPU"))},Ci=()=>{const so=We&&c.layout.get("symbol-placement")!=="point",Pn=[];si(Pn),xi(Pn);const An=so||En,zi=Xt.elevationType==="road",Ho=p.shadowRenderer,ho=zi&&lt&&!!Ho&&Ho.enabled,sa=_n(ho),qo=zi&&lt&&!p.terrain?xt:ur,Xl=c.paint.get("icon-image-cross-fade");p.terrainRenderModeElevated()&&lt&&Pn.push("PITCH_WITH_MAP_TERRAIN"),qr&&(Pn.push("PROJECTION_GLOBE_VIEW"),An&&Pn.push("PROJECTED_POS_ON_VIEWPORT")),Xl>0&&Xt.hasAnySecondaryIcon&&Pn.push("ICON_TRANSITION"),!Xt.icon.zOffsetVertexBuffer||zi&&p.terrain||Pn.push("Z_OFFSET"),me===0&&Te===0&&Oe===0&&Le===1||Pn.push("COLOR_ADJUSTMENT"),Xt.sdfIcons&&Pn.push("RENDER_SDF"),ho&&Pn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),zi&&lt&&!p.terrain&&Xt.icon.orientationVertexBuffer&&Pn.push("ELEVATED_ROADS");const xa=Xt.icon.programConfigurations.get(c.id),Dl=p.getOrCreateProgram("symbol",{config:xa,defines:Pn}),Ol=Ht.imageAtlasTexture?Ht.imageAtlasTexture.size:[0,0],dl=Xt.iconSizeData,Es=i.bK(dl,Ve.zoom),Yl=lt||!Ve.isOrthographic,Wo=Ka(Yr,Ht.tileID.canonical,lt,We,Ve,Xt.getProjection(),Lr),jo=hu(Yr,Ht.tileID.canonical,lt,We,Ve,Xt.getProjection(),Lr),Do=p.translatePosMatrix(jo,Ht,D,H,!0),ba=p.translatePosMatrix(Yr,Ht,D,H),Fa=An?pi:Wo,ra=We&&!lt&&!so;let us=Gt;!gt&&!Ve.mercatorFromTransition||We||(us=hi(Ve));const xh=qr?us:Gt,hf=c.getColorAdjustmentMatrix(me,Te,Oe,Le),Lu=jt(dl.kind,Es,ra,lt,p,ba,Fa,Do,Ge,!1,Ol,[0,0],0,ar,$r,rt,In,xh,Xt.getProjection(),sa,ki,hf,Xl,null),ff=Ht.imageAtlasTexture?Ht.imageAtlasTexture:null,df=c.layout.get("icon-size").constantOr(0)!==1||Xt.iconsNeedLinear,kl=Xt.sdfIcons||p.options.rotating||p.options.zooming||df||Yl?$e.LINEAR:$e.NEAREST,pf=Xt.sdfIcons&&c.paint.get("icon-halo-width").constantOr(1)!==0,bh=p.terrain&&lt&&so?i.bl(i.bC(),Wo):pi;if(so&&Xt.icon){const Bu=Ve.elevation,wh=Bu?Bu.getAtTileOffsetFunc(ar,Ve.center.lat,Ve.worldSize,Xt.getProjection()):null,xm=ya(Yr,Ht.tileID.canonical,lt,We,Ve,Xt.getProjection(),Lr);Kp(Xt,Yr,p,!1,xm,jo,lt,he,wh,ar)}return{program:Dl,buffers:Xt.icon,uniformValues:Lu,atlasTexture:ff,atlasTextureIcon:null,atlasInterpolation:kl,atlasInterpolationIcon:null,isSDF:Xt.sdfIcons,hasHalo:pf,depthMode:qo,tile:Ht,renderWithShadows:ho,labelPlaneMatrixInv:bh}},On=()=>{const so=yt&&c.layout.get("symbol-placement")!=="point",Pn=[],An=so||zt||En,zi=Xt.elevationType==="road",Ho=p.shadowRenderer,ho=zi&&Ot&&!!Ho&&Ho.enabled,sa=_n(ho),qo=zi&&Ot&&!p.terrain?xt:ur;p.terrainRenderModeElevated()&&Ot&&Pn.push("PITCH_WITH_MAP_TERRAIN"),qr&&(Pn.push("PROJECTION_GLOBE_VIEW"),An&&Pn.push("PROJECTED_POS_ON_VIEWPORT")),!Xt.text.zOffsetVertexBuffer||zi&&p.terrain||Pn.push("Z_OFFSET"),Xt.iconsInText&&Pn.push("RENDER_TEXT_AND_SYMBOL"),Pn.push("RENDER_SDF"),ho&&Pn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),zi&&Ot&&!p.terrain&&Xt.text.orientationVertexBuffer&&Pn.push("ELEVATED_ROADS"),si(Pn);const Xl=Xt.text.programConfigurations.get(c.id),xa=p.getOrCreateProgram("symbol",{config:Xl,defines:Pn});let Dl,Ol=[0,0],dl=null;const Es=Xt.textSizeData;Xt.iconsInText&&(Ol=Ht.imageAtlasTexture?Ht.imageAtlasTexture.size:[0,0],dl=Ht.imageAtlasTexture?Ht.imageAtlasTexture:null,Dl=Ot||!Ve.isOrthographic||p.options.rotating||p.options.zooming||Es.kind==="composite"||Es.kind==="camera"?$e.LINEAR:$e.NEAREST);const Yl=Ht.glyphAtlasTexture?Ht.glyphAtlasTexture.size:[0,0],Wo=c.layout.get("text-size-scale-range"),jo=i.aA(p.scaleFactor,Wo[0],Wo[1]),Do=i.bK(Es,Ve.zoom,jo),ba=Ka(Yr,Ht.tileID.canonical,Ot,yt,Ve,Xt.getProjection(),Lr),Fa=hu(Yr,Ht.tileID.canonical,Ot,yt,Ve,Xt.getProjection(),Lr),ra=p.translatePosMatrix(Fa,Ht,N,W,!0),us=p.translatePosMatrix(Yr,Ht,N,W),xh=An?pi:ba,hf=yt&&!Ot&&!so;let Lu=Gt;!gt&&!Ve.mercatorFromTransition||yt||(Lu=hi(Ve));const ff=jt(Es.kind,Do,hf,Ot,p,us,xh,ra,Ge,!0,Yl,Ol,0,ar,$r,rt,In,qr?Lu:Gt,Xt.getProjection(),sa,ki,null,null,jo),df=Ht.glyphAtlasTexture?Ht.glyphAtlasTexture:null,kl=$e.LINEAR,pf=c.paint.get("text-halo-width").constantOr(1)!==0,bh=p.terrain&&Ot&&so?i.bl(i.bC(),ba):pi;if(so&&Xt.text){const Bu=Ve.elevation,wh=Bu?Bu.getAtTileOffsetFunc(ar,Ve.center.lat,Ve.worldSize,Xt.getProjection()):null,xm=ya(Yr,Ht.tileID.canonical,Ot,yt,Ve,Xt.getProjection(),Lr);Kp(Xt,Yr,p,!0,xm,Fa,Ot,Se,wh,ar)}return{program:xa,buffers:Xt.text,uniformValues:ff,atlasTexture:df,atlasTextureIcon:dl,atlasInterpolation:kl,atlasInterpolationIcon:Dl,isSDF:!0,hasHalo:pf,depthMode:qo,tile:Ht,renderWithShadows:ho,labelPlaneMatrixInv:bh}},bi=Xt.icon.segments.get().length,Ai=Xt.text.segments.get().length,wi=bi&&!I.onlyText?Ci():null,Ji=Ai&&!I.onlyIcons?On():null,Vi=c.paint.get("icon-opacity").constantOr(1),ta=c.paint.get("text-opacity").constantOr(1);if(_t&&Xt.canOverlap){It=!0;const so=Vi&&!I.onlyText?Xt.icon.segments.get():[],Pn=ta&&!I.onlyIcons?Xt.text.segments.get():[];for(const An of so)Bt.push({segments:new i.bg([An]),sortKey:An.sortKey,state:wi});for(const An of Pn)Bt.push({segments:new i.bg([An]),sortKey:An.sortKey,state:Ji})}else I.onlyText||Bt.push({segments:Vi?Xt.icon.segments:new i.bg([]),sortKey:0,state:wi}),I.onlyIcons||Bt.push({segments:ta?Xt.text.segments:new i.bg([]),sortKey:0,state:Ji})}It&&Bt.sort(((ar,Ht)=>ar.sortKey-Ht.sortKey));for(const ar of Bt){const Ht=ar.state;if(Ht)if(p.terrain?p.terrain.setupElevationDraw(Ht.tile,Ht.program,{useDepthForOcclusion:Ve.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Ht.labelPlaneMatrixInv}):p.setupDepthForOcclusion(Ve.depthOcclusionForSymbolsAndCircles,Ht.program),Ze.activeTexture.set($e.TEXTURE0),Ht.atlasTexture&&Ht.atlasTexture.bind(Ht.atlasInterpolation,$e.CLAMP_TO_EDGE,!0),Ht.atlasTextureIcon&&(Ze.activeTexture.set($e.TEXTURE1),Ht.atlasTextureIcon&&Ht.atlasTextureIcon.bind(Ht.atlasInterpolationIcon,$e.CLAMP_TO_EDGE,!0)),Ht.renderWithShadows&&p.shadowRenderer.setupShadows(Ht.tile.tileID.toUnwrapped(),Ht.program,"vector-tile"),p.uploadCommonLightUniforms(p.context,Ht.program),Ht.hasHalo){const Xt=Ht.uniformValues;Xt.u_is_halo=1,Uf(Ht.buffers,ar.segments,c,p,Ht.program,Ht.depthMode,x,E,Xt,2),Xt.u_is_halo=0}else{if(Ht.isSDF){const Xt=Ht.uniformValues;Ht.hasHalo&&(Xt.u_is_halo=1,Uf(Ht.buffers,ar.segments,c,p,Ht.program,Ht.depthMode,x,E,Xt,1)),Xt.u_is_halo=0}Uf(Ht.buffers,ar.segments,c,p,Ht.program,Ht.depthMode,x,E,Ht.uniformValues,1)}}}function Uf(p,n,c,d,x,E,I,D,N,H){const W=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.iconTransitioningVertexBuffer,p.globeExtVertexBuffer,p.zOffsetVertexBuffer,p.orientationVertexBuffer];x.draw(d,d.context.gl.TRIANGLES,E,I,D,gn.disabled,N,c.id,p.layoutVertexBuffer,p.indexBuffer,n,c.paint,d.transform.zoom,p.programConfigurations.get(c.id),W,H)}function Cg(p,n){const c=1<<p.canonical.z,d=(n.x*c-p.canonical.x-p.wrap*c)*i.al,x=(n.y*c-p.canonical.y)*i.al,E=i.e5(n.z,n.y);return i.d4(d,x,E)}function tf(p,n,c,d,x){if(!c.layout||c.layout.get("fill-elevation-reference")==="none")return;const E=p.context.gl,I=new Mr(p.context.gl.LEQUAL,Mr.ReadWrite,p.depthRangeFor3D),D=new Mr(p.context.gl.GREATER,Mr.ReadWrite,p.depthRangeFor3D),N=(function(se){let fe=.01;return se.isOrthographic&&(fe=i.ak(1e-4,fe,i.c$(se.pitch>=Zs?1:se.pitch/Zs))),2*fe})(p.transform),H=p.transform.getFreeCameraOptions().position,W="elevatedStructuresDepthReconstruct",ee=p.getOrCreateProgram(W,{defines:["DEPTH_RECONSTRUCTION"]}),Y=p.getOrCreateProgram(W);for(const se of d){const fe=n.getTile(se),he=fe.getBucket(c);if(!he)continue;const Se=he.elevatedStructures;if(!Se)continue;const me=he.elevationBufferData.heightRange,Te=Cg(se.toUnwrapped(),H),Oe=p.translatePosMatrix(se.projMatrix,fe,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));let Le,Ge,Ue,Ze;if(x==="initialize"){if(!me||me.min>=1||Se.depthSegments.segments[0].primitiveLength===0)continue;Le=Zl(Oe,Te,N,1,0),Ge=I,Ue=Se.depthSegments,Ze=ee}else if(x==="reset"){if(!me||me.min>=0||Se.maskSegments.segments[0].primitiveLength===0)continue;Le=Zl(Oe,Te,0,0,1),Ge=D,Ue=Se.maskSegments,Ze=ee}else if(x==="geometry"){if(Se.depthSegments.segments[0].primitiveLength===0)continue;Le=Zl(Oe,Te,N,1,0),Ge=I,Ue=Se.depthSegments,Ze=Y}Ze.draw(p,E.TRIANGLES,Ge,cn.disabled,Mn.disabled,gn.disabled,Le,c.id,Se.vertexBuffer,Se.indexBuffer,Ue,c.paint,p.transform.zoom)}}function Vf(p,n,c){const{painter:d,sourceCache:x,layer:E,coords:I,colorMode:D,elevationType:N,terrainEnabled:H,pass:W}=p,ee=d.context.gl,Y=E.paint.get("fill-pattern"),se=E.paint.get("fill-pattern-cross-fade"),fe=Y.constantOr(null);let he=N;N!=="road"||n&&!H||(he="none");const Se=he==="road",me=p.painter.shadowRenderer,Te=Se&&!!me&&me.enabled,Oe=new Mr(d.context.gl.LEQUAL,Mr.ReadOnly,d.depthRangeFor3D);let Le=[0,0,0];if(Te){const Ze=d.style.directionalLight,$e=d.style.ambientLight;Ze&&$e&&(Le=vs(d.style,Ze,$e))}const Ge=Y&&Y.constantOr(1),Ue=(Ze,$e)=>{let Ve,We,yt,lt,Ot;$e?(Ve=Ge&&!E.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",yt=ee.LINES):(Ve=Ge?"fillPattern":"fill",yt=ee.TRIANGLES);for(const _t of I){const It=x.getTile(_t);if(Ge&&!It.patternsLoaded())continue;const ur=It.getBucket(E);if(!ur)continue;const xt=n?ur.elevationBufferData:ur.bufferData;if(xt.isEmpty())continue;d.prepareDrawTile();const rt=xt.programConfigurations.get(E.id),zt=d.isTileAffectedByFog(_t),gt=[],Bt=[];Se&&(gt.push("ELEVATED_ROADS"),Bt.push(xt.elevatedLayoutVertexBuffer)),Te&&gt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ge&&(d.context.activeTexture.set(ee.TEXTURE0),It.imageAtlasTexture&&It.imageAtlasTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),rt.updatePaintBuffers());let Gt=!1;if(fe&&It.imageAtlas){const $r=It.imageAtlas,Yr=i.e0.from(fe),Lr=Yr.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),rn=Yr.getSecondary(),En=$r.patternPositions.get(Lr),In=rn?$r.patternPositions.get(rn.scaleSelf(i.o.devicePixelRatio).toString()):null;Gt=!!En&&!!In,En&&rt.setConstantPatternPositions(En,In)}se>0&&(Gt||rt.getPatternTransitionVertexBuffer("fill-pattern"))&&gt.push("FILL_PATTERN_TRANSITION");const ar=d.getOrCreateProgram(Ve,{config:rt,overrideFog:zt,defines:gt}),Ht=d.translatePosMatrix(_t.projMatrix,It,E.paint.get("fill-translate"),E.paint.get("fill-translate-anchor"));Te&&me.setupShadows(It.tileID.toUnwrapped(),ar,"vector-tile");const Xt=E.paint.get("fill-emissive-strength");if($e){lt=xt.lineIndexBuffer,Ot=xt.lineSegments;const $r=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[ee.drawingBufferWidth,ee.drawingBufferHeight];We=Ve==="fillOutlinePattern"&&Ge?Pu(Ht,Xt,d,It,$r,Le,se):dh(Ht,Xt,$r,Le)}else lt=xt.indexBuffer,Ot=xt.triangleSegments,We=Ge?Ml(Ht,Xt,d,It,Le,se):ef(Ht,Xt,Le);d.uploadCommonUniforms(d.context,ar,_t.toUnwrapped());let qr=Ze;(N==="road"&&!H||N==="offset")&&(qr=Oe),ar.draw(d,yt,qr,c||d.stencilModeForClipping(_t),D,gn.disabled,We,E.id,xt.layoutVertexBuffer,lt,Ot,E.paint,d.transform.zoom,rt,Bt)}};d.renderPass===W&&Ue(d.depthModeForSublayer(1,d.renderPass==="opaque"?Mr.ReadWrite:Mr.ReadOnly),!1),he==="none"&&d.renderPass==="translucent"&&E.paint.get("fill-antialias")&&Ue(d.depthModeForSublayer(E.getPaintProperty("fill-outline-color")?2:0,Mr.ReadOnly),!0)}function Rr(p,n,c,d,x,E,I,D){c.resetLayerRenderingStats(p);const N=p.context,H=N.gl,W=p.transform,ee=c.paint.get("fill-extrusion-pattern"),Y=c.paint.get("fill-extrusion-pattern-cross-fade"),se=ee.constantOr(null),fe=ee.constantOr(1),he=c.paint.get("fill-extrusion-opacity"),Se=p.style.enable3dLights(),me=c.paint.get(Se&&!fe?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),Te=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),me],Oe=c.layout.get("fill-extrusion-edge-radius"),Le=Oe>0&&!c.paint.get("fill-extrusion-rounded-roof"),Ge=Le?0:Oe,Ue=W.projection.name==="globe"?i.e8():0,Ze=W.projection.name==="globe",$e=Ze?i.aj(W.zoom):0,Ve=[i.aF(W.center.lng),i.aJ(W.center.lat)],We=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",yt=c.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(We?null:c.lut).toArray01().slice(0,3),lt=c.paint.get("fill-extrusion-flood-light-intensity"),Ot=c.paint.get("fill-extrusion-vertical-scale"),_t=c.paint.get("fill-extrusion-line-width").constantOr(1)!==0,It=c.paint.get("fill-extrusion-height-alignment"),ur=c.paint.get("fill-extrusion-base-alignment"),xt=Ec(p,c.paint.get("fill-extrusion-cutoff-fade-range")),rt=[];let zt;Ze&&rt.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&rt.push("FAUX_AO"),Le&&rt.push("ZERO_ROOF_RADIUS"),D&&rt.push("HAS_CENTROID"),lt>0&&rt.push("FLOOD_LIGHT"),xt.shouldRenderCutoff&&rt.push("RENDER_CUTOFF"),_t&&rt.push("RENDER_WALL_MODE");const gt=p.renderPass==="shadow",Bt=p.shadowRenderer,Gt=gt&&!!Bt,ar=gt?gn.disabled:gn.backCCW;p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0);let Ht=[0,0,0];if(Bt){const $r=p.style.directionalLight,Yr=p.style.ambientLight;$r&&Yr&&(Ht=vs(p.style,$r,Yr)),gt||(rt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Bt.useNormalOffset&&rt.push("NORMAL_OFFSET")),zt=rt.concat(["SHADOWS_SINGLE_CASCADE"])}const Xt=Gt?"fillExtrusionDepth":fe?"fillExtrusionPattern":"fillExtrusion",qr=c.getLayerRenderingStats();for(const $r of d){const Yr=n.getTile($r),Lr=Yr.getBucket(c);if(!Lr||Lr.projection.name!==W.projection.name)continue;let rn=!1;Bt&&(rn=Bt.getMaxCascadeForTile($r.toUnwrapped())===0);const En=p.isTileAffectedByFog($r),In=Lr.programConfigurations.get(c.id);let ki=!1;if(se&&Yr.imageAtlas){const Ai=Yr.imageAtlas,wi=i.e0.from(se),Ji=wi.getPrimary().scaleSelf(i.o.devicePixelRatio).toString(),Vi=wi.getSecondary(),ta=Ai.patternPositions.get(Ji),so=Vi?Ai.patternPositions.get(Vi.scaleSelf(i.o.devicePixelRatio).toString()):null;ki=!!ta&&!!so,ta&&In.setConstantPatternPositions(ta,so)}Y>0&&(ki||In.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&rt.push("FILL_EXTRUSION_PATTERN_TRANSITION");const _n=p.getOrCreateProgram(Xt,{config:In,defines:rn?zt:rt,overrideFog:En});if(p.terrain&&p.terrain.setupElevationDraw(Yr,_n,{useMeterToDem:!0}),!Lr.centroidVertexBuffer){const Ai=_n.getAttributeLocation(H,"a_centroid_pos");Ai!==-1&&H.vertexAttrib2f(Ai,0,0)}!gt&&Bt&&Bt.setupShadows(Yr.tileID.toUnwrapped(),_n,"vector-tile"),fe&&(p.context.activeTexture.set(H.TEXTURE0),Yr.imageAtlasTexture&&Yr.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),In.updatePaintBuffers());const si=c.paint.get("fill-extrusion-vertical-gradient"),xi=1/Lr.tileToMeter;let Ci;if(gt&&Bt){if(mh(Yr.tileID,Lr.maxHeight,p))continue;const Ai=Bt.calculateShadowPassMatrixFromTile(Yr.tileID.toUnwrapped());Ci=Id(Ai,Ge,xi,Ot,It,ur)}else{const Ai=p.translatePosMatrix($r.expandedProjMatrix,Yr,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),wi=W.projection.createInversionMatrix(W,$r.canonical);Ci=fe?Jh(Ai,p,si,he,Te,Ge,xi,$r,Yr,Ue,It,ur,$e,Ve,wi,yt,Ot,Y):Jr(Ai,p,si,he,Te,Ge,xi,$r,Ue,It,ur,$e,Ve,wi,yt,Ot,lt,Ht)}p.uploadCommonUniforms(N,_n,$r.toUnwrapped(),null,xt);let On=Lr.segments;if(W.projection.name==="mercator"&&!gt&&(On=Lr.getVisibleSegments(Yr.tileID,p.terrain,p.transform.getFrustum(0)),!On.get().length))continue;if(qr)if(gt)for(const Ai of On.get())qr.numRenderedVerticesInShadowPass+=Ai.primitiveLength;else for(const Ai of On.get())qr.numRenderedVerticesInTransparentPass+=Ai.primitiveLength;const bi=[];(p.terrain||D)&&bi.push(Lr.centroidVertexBuffer),Ze&&bi.push(Lr.layoutVertexExtBuffer),_t&&bi.push(Lr.wallVertexBuffer),_n.draw(p,N.gl.TRIANGLES,x,E,I,ar,Ci,c.id,Lr.layoutVertexBuffer,Lr.indexBuffer,On,c.paint,p.transform.zoom,In,bi)}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1)}class hl{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function aa(p,n,c,d,x,E,I,D,N,H,W,ee,Y,se,fe,he,Se,me,Te,Oe){const Le=n.context,Ge=Le.gl,Ue=n.transform,Ze=n.transform.zoom,$e=[],Ve=p.translate,We=p.translateAnchor,yt=p.edgeRadius,lt=Ec(n,p.cutoffFadeRange);W==="clear"?($e.push("CLEAR_SUBPASS"),Oe&&($e.push("CLEAR_FROM_TEXTURE"),Le.activeTexture.set(Ge.TEXTURE0),Oe.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE))):W==="sdf"&&$e.push("SDF_SUBPASS"),me&&$e.push("HAS_CENTROID"),lt.shouldRenderCutoff&&$e.push("RENDER_CUTOFF");const Ot=(_t,It,ur,xt,rt)=>{const zt=It.programConfigurations.get(d.id),gt=n.isTileAffectedByFog(_t),Bt=n.getOrCreateProgram("fillExtrusionGroundEffect",{config:zt,defines:$e,overrideFog:gt}),Gt=((Ht,Xt,qr,$r,Yr,Lr,rn,En,In,ki,_n)=>({u_matrix:Xt,u_opacity:qr,u_ao_pass:$r?1:0,u_meter_to_tile:Yr,u_ao:Lr,u_flood_light_intensity:rn,u_flood_light_color:En,u_attenuation:In,u_edge_radius:ki,u_fb:0,u_fb_size:_n,u_dynamic_offset:1}))(0,xt,ee,H,rt,[Y,se*rt],fe,he,Se,Ze>=17?0:yt*rt,Oe?Oe.size[0]:0),ar=[];me&&ar.push(It.hiddenByLandmarkVertexBuffer),n.uploadCommonUniforms(Le,Bt,_t.toUnwrapped(),null,lt),Bt.draw(n,Le.gl.TRIANGLES,E,I,D,N,Gt,d.id,It.vertexBuffer,It.indexBuffer,ur,d.paint,Ze,zt,ar)};for(const _t of x){const It=c.getTile(_t),ur=It.getBucket(d);if(!ur||ur.projection.name!==Ue.projection.name||!ur.groundEffect||ur.groundEffect&&!ur.groundEffect.hasData())continue;const xt=ur.groundEffect,rt=1/ur.tileToMeter;{const zt=n.translatePosMatrix(_t.projMatrix,It,Ve,We),gt=xt.getDefaultSegment();Ot(_t,xt,gt,zt,rt)}if(Te)for(let zt=0;zt<4;zt++){const gt=i.e6[zt](_t),Bt=c.getTile(gt);if(!Bt)continue;const Gt=Bt.getBucket(d);if(!Gt||Gt.projection.name!==Ue.projection.name||!Gt.groundEffect||Gt.groundEffect&&!Gt.groundEffect.hasData())continue;const ar=Gt.groundEffect;let Ht,Xt;zt===0?(Ht=[-i.al,0,0],Xt=1):zt===1?(Ht=[i.al,0,0],Xt=0):zt===2?(Ht=[0,-i.al,0],Xt=3):(Ht=[0,i.al,0],Xt=2);const qr=ar.regionSegments[Xt];if(!qr)continue;const $r=new Float32Array(16);i.br($r,_t.projMatrix,Ht),Ot(_t,ar,qr,n.translatePosMatrix($r,It,Ve,We),rt)}}}function ph(p,n,c,d,x,E,I){d.centroidVertexArray.length===0&&d.createCentroidsBuffer();const D=E?E.findDEMTileFor(c):null;if(!(D&&D.dem||I))return;E&&D&&D.dem&&d.selfDEMTileTimestamp!==D.dem._timestamp&&(d.borderDoneWithNeighborZ=[-1,-1,-1,-1],d.selfDEMTileTimestamp=D.dem._timestamp);const N=me=>new i.P(Math.ceil((me+i.ea)*i.eb),0),H=me=>{const Te=n.getSource().minzoom,Oe=Ge=>{const Ue=n.getTileByID(Ge);if(Ue&&Ue.hasData())return Ue.getBucket(x)},Le=[0,-1,1];for(const Ge of Le){if(me.overscaledZ+Ge<Te)continue;const Ue=Oe(me.calculateScaledKey(me.overscaledZ+Ge));if(Ue)return Ue}},W=[0,0,0],ee=(me,Te)=>(W[0]=Math.min(me.min.y,Te.min.y),W[1]=Math.max(me.max.y,Te.max.y),W[2]=i.al-Te.min.x>me.max.x?Te.min.x-i.al:me.max.x,W),Y=(me,Te)=>(W[0]=Math.min(me.min.x,Te.min.x),W[1]=Math.max(me.max.x,Te.max.x),W[2]=i.al-Te.min.y>me.max.y?Te.min.y-i.al:me.max.y,W),se=[(me,Te)=>ee(me,Te),(me,Te)=>ee(Te,me),(me,Te)=>Y(me,Te),(me,Te)=>Y(Te,me)],fe=(me,Te,Oe,Le,Ge,Ue,Ze)=>{if(!E)return 0;const $e=[[Ue?Oe:me,Ue?me:Oe,0],[Ue?Oe:Te,Ue?Te:Oe,0]],Ve=Ze<0?i.al+Ze:Ze,We=[Ue?Ve:(me+Te)/2,Ue?(me+Te)/2:Ve,0];return Oe===0&&Ze<0||Oe!==0&&Ze>0?E.getForTilePoints(Ge,[We],!0,Le):$e.push(We),E.getForTilePoints(c,$e,!0,D),Math.max($e[0][2],$e[1][2],We[2])/E.exaggeration()};for(let me=0;me<4;me++){const Te=d.borderFeatureIndices[me];if(Te.length===0)continue;const Oe=i.e6[me](c),Le=H(Oe);if(!(Le&&Le instanceof i.e7))continue;const Ge=E?E.findDEMTileFor(Oe):null;if(!(Ge&&Ge.dem||I)||(E&&Ge&&Ge.dem&&d.borderDEMTileTimestamp[me]!==Ge.dem._timestamp&&(d.borderDoneWithNeighborZ[me]=-1,d.borderDEMTileTimestamp[me]=Ge.dem._timestamp),d.borderDoneWithNeighborZ[me]===Le.canonical.z))continue;Le.centroidVertexArray.length===0&&Le.createCentroidsBuffer();const Ue=(me<2?1:5)-me,Ze=Le.borderDoneWithNeighborZ[Ue]!==d.canonical.z,$e=Le.borderFeatureIndices[Ue];let Ve=0;if(d.canonical.z!==Le.canonical.z){for(const We of Te)d.showCentroid(d.featuresOnBorder[We]);if(Ze)for(const We of $e)Le.showCentroid(Le.featuresOnBorder[We]);d.borderDoneWithNeighborZ[me]=Le.canonical.z,Le.borderDoneWithNeighborZ[Ue]=d.canonical.z}for(const We of Te){const yt=d.featuresOnBorder[We],lt=d.centroidData[yt.centroidDataIndex],Ot=yt.borders[me];let _t;for(;Ve<$e.length;){_t=Le.featuresOnBorder[$e[Ve]];const It=_t.borders[Ue];if(It[1]>Ot[0]+3||It[0]>Ot[0]-3)break;Le.showCentroid(_t),Ve++}if(_t&&Ve<$e.length){const It=Ve;let ur=0;for(;!(_t.borders[Ue][0]>Ot[1]-3)&&(ur++,++Ve!==$e.length);)_t=Le.featuresOnBorder[$e[Ve]];_t=Le.featuresOnBorder[$e[It]];let xt=!1;if(ur>=1){const gt=_t.borders[Ue];Math.abs(Ot[0]-gt[0])<3&&Math.abs(Ot[1]-gt[1])<3&&(ur=1,xt=!0,Ve=It+1)}else if(ur===0){d.showCentroid(yt);continue}const rt=Le.centroidData[_t.centroidDataIndex];I&&xt&&(((he=lt).flags|(Se=rt).flags)&i.e9?(he.flags|=i.e9,Se.flags|=i.e9):(he.flags&=~i.e9,Se.flags&=~i.e9));const zt=yt.intersectsCount()>1||_t.intersectsCount()>1;if(ur>1)Ve=It,lt.centroidXY=rt.centroidXY=new i.P(0,0);else if(Ge&&Ge.dem&&!zt){const gt=se[me](lt,rt),Bt=me%2?i.al-1:0,Gt=fe(gt[0],Math.min(i.al-1,gt[1]),Bt,Ge,Oe,me<2,gt[2]);lt.centroidXY=rt.centroidXY=N(Gt)}else zt?lt.centroidXY=rt.centroidXY=new i.P(0,0):(lt.centroidXY=d.encodeBorderCentroid(yt),rt.centroidXY=Le.encodeBorderCentroid(_t));d.writeCentroidToBuffer(lt),Le.writeCentroidToBuffer(rt)}else d.showCentroid(yt)}d.borderDoneWithNeighborZ[me]=Le.canonical.z,Le.borderDoneWithNeighborZ[Ue]=d.canonical.z}var he,Se;(d.needsCentroidUpdate||!d.centroidVertexBuffer&&d.centroidVertexArray.length!==0)&&d.uploadCentroid(p)}const Fc=[1,0,0],dn=[0,1,0],om=[0,0,1];function mh(p,n,c){const d=c.transform,x=c.shadowRenderer;if(!x)return!0;const E=p.toUnwrapped(),I=d.tileSize*x._cascades[c.currentShadowCascade].scale;let D=n;if(d.elevation){const he=d.elevation.getMinMaxForTile(p);he&&(D+=he.max)}const N=[...x.shadowDirection];N[2]=-N[2];const H=x.computeSimplifiedTileShadowVolume(E,D,I,N);if(!H)return!1;const W=[Fc,dn,om,N,[N[0],0,N[2]],[0,N[1],N[2]]],ee=d.projection.name==="globe",Y=d.scaleZoom(I),se=i.cA.fromInvProjectionMatrix(d.invProjMatrix,d.worldSize,Y,!ee),fe=x.getCurrentCascadeFrustum();return se.intersectsPrecise(H.vertices,H.planes,W)===0||fe.intersectsPrecise(H.vertices,H.planes,W)===0}function Rd(p){const{painter:n,source:c,layer:d,coords:x}=p;let E=p.defines;const I=n.context,D=n.renderPass==="shadow",N=n.renderPass==="light-beam",H=n.shadowRenderer,W=i.ec(n.transform.center.lat,n.transform.zoom),ee=Ec(n,d.paint.get("building-cutoff-fade-range"));ee.shouldRenderCutoff&&(E=E.concat("RENDER_CUTOFF"));for(const Y of x){const se=c.getTile(Y),fe=se.getBucket(d);if(!fe)continue;H&&H.getMaxCascadeForTile(Y.toUnwrapped())===0&&(E=E.concat("SHADOWS_SINGLE_CASCADE"));const he=fe.programConfigurations.get(d.id);let Se,me,Te,Oe=n.translatePosMatrix(Y.expandedProjMatrix,se,[0,0],"map");if(Oe=i.cR(i.bC(),Oe,[1,1,p.verticalScale]),D&&H){if(mh(se.tileID,fe.maxHeight*W,n))continue;let Ge=H.calculateShadowPassMatrixFromTile(se.tileID.toUnwrapped());Ge=i.cR(i.bC(),Ge,[1,1,p.verticalScale]),Te=S(Ge),Se=me=n.getOrCreateProgram("buildingDepth",{config:he,defines:E,overrideFog:!1})}else if(N)Se=me=n.getOrCreateProgram("buildingBloom",{config:he,defines:E,overrideFog:!1}),Te=w(Oe);else{const Ge=n.transform.calculatePosMatrix(Y.toUnwrapped(),n.transform.worldSize);i.cR(Ge,Ge,[1,1,p.verticalScale]);const Ue=i.bC();i.cR(Ue,Ge,[1,-1,1/W]),i.bl(Ue,Ue),i.ed(Ue,Ue);const Ze=n.transform.getFreeCameraOptions().position,$e=1<<Y.canonical.z;Te=b(Oe,Ue,p.opacity,p.facadeAOIntensity,[((Ze.x-Y.wrap)*$e-Y.canonical.x)*i.al,(Ze.y*$e-Y.canonical.y)*i.al,Ze.z*$e*i.al],fe.tileToMeter,p.facadeEmissiveChance),me=n.getOrCreateProgram("building",{config:he,defines:E,overrideFog:!1});const Ve=E.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);Se=n.getOrCreateProgram("building",{config:he,defines:Ve,overrideFog:!1}),H&&(H.setupShadowsFromMatrix(Ge,me,!0),H.setupShadowsFromMatrix(Ge,Se,!0))}const Le=(Ge,Ue)=>{if(N){const Ze=Ge.entranceBloom;Ue.draw(n,I.gl.TRIANGLES,p.depthMode,cn.disabled,p.blendMode,gn.disabled,Te,d.id,Ze.layoutVertexBuffer,Ze.indexBuffer,Ze.segmentsBucket,d.paint,n.transform.zoom,he,[Ze.layoutAttenuationBuffer,Ze.layoutColorBuffer])}else{const Ze=Ge.segmentsBucket;let $e=[Ge.layoutNormalBuffer,Ge.layoutCentroidBuffer,Ge.layoutColorBuffer];Ge.layoutFacadePaintBuffer&&($e=$e.concat([Ge.layoutFacadeDataBuffer,Ge.layoutFacadeVerticalRangeBuffer,Ge.layoutFacadePaintBuffer])),Ue.draw(n,I.gl.TRIANGLES,p.depthMode,cn.disabled,p.blendMode,D?gn.disabled:gn.backCW,Te,d.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ze,d.paint,n.transform.zoom,he,$e)}};n.uploadCommonUniforms(I,me,Y.toUnwrapped(),null,ee),fe.buildingWithoutFacade&&Le(fe.buildingWithoutFacade,me),Se!==me&&n.uploadCommonUniforms(I,Se,Y.toUnwrapped(),null,ee),fe.buildingWithFacade&&Le(fe.buildingWithFacade,Se)}}function dp(p){return[p[0]*i.ee,p[1]*i.ee,p[2]*i.ee,0]}function pp(p,n,c,d,x,E,I,D,N){const H=d.getSource(),W=c.globeSharedBuffers;if(!W)return;let ee,Y,se;if(n&&(ee=d.getTile(n)),H instanceof i.aS?(Y=H.texture,se=i.dG(0,0,c.transform)):ee&&n&&(Y=ee.texture,se=i.dG(n.canonical.z,n.canonical.x,c.transform)),!Y||!se)return;p||(se=i.cR(i.bC(),se,[1,-1,1]));const fe=c.context,he=fe.gl,Se=x.paint.get("raster-resampling")==="nearest"?he.NEAREST:he.LINEAR,me=c.colorModeForDrapableLayerRenderPass(E),Te=I.defines;Te.push("GLOBE_POLES");const Oe=new Mr(he.LEQUAL,Mr.ReadWrite,c.depthRangeFor3D),Le=Float32Array.from(c.transform.expandedFarZProjMatrix),Ge=Float32Array.from(i.bk(i.dF(new i.cC(0,0,0))));c.terrain&&c.terrain.prepareDrawTile(),fe.activeTexture.set(he.TEXTURE0),Y.bind(Se,he.CLAMP_TO_EDGE),fe.activeTexture.set(he.TEXTURE1),Y.bind(Se,he.CLAMP_TO_EDGE),"useMipmap"in Y&&fe.extTextureFilterAnisotropic&&c.transform.pitch>20&&he.texParameterf(he.TEXTURE_2D,fe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,fe.extTextureFilterAnisotropicMax);const[Ue,Ze,$e,Ve]=n?W.getPoleBuffers(n.canonical.z,!1):W.getPoleBuffers(0,!0),We=x.paint.get("raster-elevation");let yt;p?(yt=Ue,c.renderDefaultNorthPole=We!==0):(yt=Ze,c.renderDefaultSouthPole=We!==0);const lt=dp(I.mix),Ot=((It,ur,xt,rt,zt,gt,Bt,Gt,ar,Ht,Xt,qr,$r)=>pe(It,ur,xt,new Float32Array(16),new Float32Array(9),[0,0],rt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},gt,[0,0],Gt,2,Ht,Xt,qr,1,0,$r))(Le,Ge,se,i.aj(c.transform.zoom),0,x,0,We,0,lt,I.offset,I.range,E),_t=c.getOrCreateProgram("raster",{defines:Te});c.uploadCommonUniforms(fe,_t,null),_t.draw(c,he.TRIANGLES,Oe,N,me,D,Ot,x.id,yt,$e,Ve)}function Mg(p){const n=p._nearZ,c=p.projection.farthestPixelDistance(p),d=c-n,x=.2*p.height,E=n+x;return[n,c,(E-x-n)/d,(E-n)/d]}function p0(p,n,c,d){if(p)return n instanceof Yu&&p instanceof Fo?n.getTextureDescriptor(p,c,!0):{texture:p.texture,mix:dp(d.mix),offset:d.offset,buffer:0,tileSize:1}}var Ig=i.ef([{name:"a_index",type:"Int16",components:1}]);class Pg{constructor(n,c,d,x){const E={width:d[0],height:d[1],data:null},I=n.gl;this.targetColorTexture=new i.T(n,E,I.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(n,E,I.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(c,x),this.lastInvalidatedAt=0}updateParticleTexture(n,c){if(this.particleTextureDimension===c.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const d=this.context.gl,x=c.width*c.height;this.particleTexture0=new i.T(this.context,c,d.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,c,d.RGBA8,{premultiply:!1,useMipmap:!1});const E=new i.eg;E.reserve(x);for(let I=0;I<x;I++)E.emplaceBack(I);this.particleIndexBuffer=this.context.createVertexBuffer(E,Ig.members,!0),this.particleSegment=i.bg.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=c.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=i.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Il(p,n,c){if(!p)return null;const d=n.getTextureDescriptor(p,c,!0);if(!d)return null;let{texture:x,mix:E,offset:I,tileSize:D,buffer:N,format:H}=d;if(!x||!H)return null;let W=!1;return H==="uint32"&&(W=!0,E[3]=0,E=Z(i.eh,E,[0,c.paint.get("raster-particle-max-speed")]),I=re(i.eh,I,[0,c.paint.get("raster-particle-max-speed")])),{texture:x,textureOffset:[N/(D+2*N),D/(D+2*N)],tileSize:D,scalarData:W,scale:E,offset:I,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[H]]}}function cA(p){const n=p._nearZ,c=p.projection.farthestPixelDistance(p),d=c-n,x=.2*p.height,E=n+x;return[n,c,(E-x-n)/d,(E-n)/d]}const zs=new i.ao(1,0,0,1),rf=new i.ao(0,1,0,1),Rg=new i.ao(0,0,1,1),uA=new i.ao(1,0,1,1),hA=new i.ao(0,1,1,1);function am(p,n,c,d,x,E){for(let I=0;I<c.length;I++)if(x){const H=new i.ao(d.r*.8,d.g*.8,d.b*.8,1);nf(p,n,c[I],d,-1,-1,E),nf(p,n,c[I],d,-1,1,E),nf(p,n,c[I],d,1,1,E),nf(p,n,c[I],d,1,-1,E),nf(p,n,c[I],H,0,0,E)}else nf(p,n,c[I],d,0,0,E)}function nf(p,n,c,d,x,E,I){const D=p.context,N=p.transform,H=D.gl,W=N.projection.name==="globe",ee=W?["PROJECTION_GLOBE_VIEW"]:[];let Y=i.bz(c.projMatrix);if(W&&i.aj(N.zoom)>0){const lt=i.bj(c.canonical,N),Ot=i.ei(lt);Y=i.aB(new Float32Array(16),N.globeMatrix,Ot),i.aB(Y,N.projMatrix,Y)}const se=i.bC();se[12]+=2*x/(i.o.devicePixelRatio*N.width),se[13]+=2*E/(i.o.devicePixelRatio*N.height),i.aB(Y,se,Y);const fe=p.getOrCreateProgram("debug",{defines:ee}),he=n.getTileByID(c.key);p.terrain&&p.terrain.setupElevationDraw(he,fe);const Se=Mr.disabled,me=cn.disabled,Te=p.colorModeForRenderPass(),Oe="$debug";D.activeTexture.set(H.TEXTURE0),p.emptyTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),W?he._makeGlobeTileDebugBuffers(p.context,N):he._makeDebugTileBoundsBuffers(p.context,N.projection);const Le=he._tileDebugBuffer||p.debugBuffer,Ge=he._tileDebugIndexBuffer||p.debugIndexBuffer,Ue=he._tileDebugSegments||p.debugSegments;if(fe.draw(p,H.LINE_STRIP,Se,me,Te,gn.disabled,O(Y,d.toPremultipliedRenderColor(null)),Oe,Le,Ge,Ue,null,null,null,[he._globeTileDebugBorderBuffer]),I){const lt=he.latestRawTileData,Ot=Math.floor((lt&&lt.byteLength||0)/1024);let _t=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(_t+=` => ${c.overscaledZ}`),_t+=` ${he.state}`,_t+=` ${Ot}kb`,(function(It,ur){It.initDebugOverlayCanvas();const xt=It.debugOverlayCanvas,rt=It.context.gl,zt=It.debugOverlayCanvas.getContext("2d");zt.clearRect(0,0,xt.width,xt.height),zt.shadowColor="white",zt.shadowBlur=2,zt.lineWidth=1.5,zt.strokeStyle="white",zt.textBaseline="top",zt.font="bold 36px Open Sans, sans-serif",zt.fillText(ur,5,5),zt.strokeText(ur,5,5),It.debugOverlayTexture.update(xt),It.debugOverlayTexture.bind(rt.LINEAR,rt.CLAMP_TO_EDGE)})(p,_t)}const Ze=n.getTile(c).tileSize,$e=512/Math.min(Ze,512)*(c.overscaledZ/N.zoom)*.5,Ve=he._tileDebugTextBuffer||p.debugBuffer,We=he._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,yt=he._tileDebugTextSegments||p.debugSegments;fe.draw(p,H.TRIANGLES,Se,me,Mn.alphaBlended,gn.disabled,O(Y,i.ao.transparent.toPremultipliedRenderColor(null),$e),Oe,Ve,We,yt,null,null,null,[he._globeTileDebugTextBuffer])}function Ru(p,n,c,d){$f(p,0,n+c/2,p.transform.width,c,d)}function co(p,n,c,d){$f(p,n-c/2,0,c,p.transform.height,d)}function $f(p,n,c,d,x,E){const I=p.context,D=I.gl;D.enable(D.SCISSOR_TEST),D.scissor(n*i.o.devicePixelRatio,c*i.o.devicePixelRatio,d*i.o.devicePixelRatio,x*i.o.devicePixelRatio),I.clear({color:E}),D.disable(D.SCISSOR_TEST)}const fA=i.ef([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:m0}=fA;function of(p,n,c,d){p.emplaceBack(n,c,d)}class dA{constructor(n){this.vertexArray=new i.ej,this.indices=new i.b1,of(this.vertexArray,-1,-1,1),of(this.vertexArray,1,-1,1),of(this.vertexArray,-1,1,1),of(this.vertexArray,1,1,1),of(this.vertexArray,-1,-1,-1),of(this.vertexArray,1,-1,-1),of(this.vertexArray,-1,1,-1),of(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,m0),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=i.bg.simpleSegment(0,0,36,12)}}function Nc(p,n,c,d,x,E){const I=p.context.gl,D=n.paint.get("sky-atmosphere-color"),N=n.paint.get("sky-atmosphere-halo-color"),H=n.paint.get("sky-atmosphere-sun-intensity"),W=((ee,Y,se,fe,he)=>({u_matrix_3f:ee,u_sun_direction:Y,u_sun_intensity:se,u_color_tint_r:[fe.r,fe.g,fe.b,fe.a],u_color_tint_m:[he.r,he.g,he.b,he.a],u_luminance:5e-5}))(i.el(i.dL(),d),x,H,D.toPremultipliedRenderColor(null),N.toPremultipliedRenderColor(null));I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+E,n.skyboxTexture,0),c.draw(p,I.TRIANGLES,Mr.disabled,cn.disabled,Mn.unblended,gn.frontCW,W,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Ah=i.ef([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Gf{constructor(n){const c=new i.em;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const d=new i.b1;d.emplaceBack(0,1,2),d.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(c,Ah.members),this.indexBuffer=n.createIndexBuffer(d),this.segments=i.bg.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const lr=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class xr{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Dd{constructor(n){this.colorModeAlphaBlendedWriteRGB=new Mn([1,Ps,1,Ps],i.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Mn([1,0,1,0],i.ao.transparent,[!1,!1,!1,!0]),this.params=new xr,this.updateNeeded=!0,n.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),n.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),n.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),n.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(n){const c=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Gf(c);const d=this.params.sizeRange,x=this.params.intensityRange,E=(function(W){const ee=i.eo(30),Y=[];for(let se=0;se<W;++se){const fe=2*Math.PI*ee(),he=Math.acos(1-2*ee())-.5*Math.PI;Y.push(i.d4(Math.cos(he)*Math.cos(fe),Math.cos(he)*Math.sin(fe),Math.sin(he)))}return Y})(this.params.starsCount),I=i.eo(300),D=new i.en,N=new i.b1;let H=0;for(let W=0;W<E.length;++W){const ee=i.c4([],E[W],200),Y=Math.max(0,1+.01*d*(1*I()-.5)),se=Math.max(0,1+.01*x*(1*I()-.5));D.emplaceBack(ee[0],ee[1],ee[2],-1,-1,Y,se),D.emplaceBack(ee[0],ee[1],ee[2],1,-1,Y,se),D.emplaceBack(ee[0],ee[1],ee[2],1,1,Y,se),D.emplaceBack(ee[0],ee[1],ee[2],-1,1,Y,se),N.emplaceBack(H+0,H+1,H+2),N.emplaceBack(H+0,H+2,H+3),H+=4}this.starsVx=c.createVertexBuffer(D,lr.members),this.starsIdx=c.createIndexBuffer(N),this.starsSegments=i.bg.simpleSegment(0,0,D.length,N.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,c){const d=n.context,x=d.gl,E=n.transform,I=new Mr(x.LEQUAL,Mr.ReadOnly,[0,1]),D=i.aj(E.zoom),N=n.style.getLut(c.scope),H=c.properties.get("color-use-theme")==="none",W=c.properties.get("color").toNonPremultipliedRenderColor(H?null:N),ee=c.properties.get("high-color-use-theme")==="none",Y=c.properties.get("high-color").toNonPremultipliedRenderColor(ee?null:N),se=c.properties.get("space-color-use-theme")==="none",fe=c.properties.get("space-color").toNonPremultipliedRenderColor(se?null:N),he=5e-4,Se=i.ep(c.properties.get("horizon-blend"),0,1,he,.25),me=i.dA(n,d,E)&&Se===he?E.worldSize/(2*Math.PI*1.025)-1:E.globeRadius,Te=n.frameCounter/1e3%1,Oe=i.ag(E.globeCenterInViewSpace),Le=Math.sqrt(Math.pow(Oe,2)-Math.pow(me,2)),Ge=Math.acos(Le/Oe),Ue=Ze=>{const $e=E.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ze&&$e.push("ALPHA_PASS");const Ve=n.getOrCreateProgram("globeAtmosphere",{defines:$e}),We=((lt,Ot,_t,It,ur,xt,rt,zt,gt,Bt,Gt,ar)=>({u_frustum_tl:lt,u_frustum_tr:Ot,u_frustum_br:_t,u_frustum_bl:It,u_horizon:ur,u_transition:xt,u_fadeout_range:rt,u_atmosphere_fog_color:zt.toArray01(),u_high_color:gt.toArray01(),u_space_color:Bt.toArray01(),u_temporal_offset:Gt,u_horizon_angle:ar}))(E.frustumCorners.TL,E.frustumCorners.TR,E.frustumCorners.BR,E.frustumCorners.BL,E.frustumCorners.horizon,D,Se,W,Y,fe,Te,Ge);n.uploadCommonUniforms(d,Ve);const yt=this.atmosphereBuffer;yt&&Ve.draw(n,x.TRIANGLES,I,cn.disabled,Ze?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,gn.backCW,We,Ze?"atmosphere_glow_alpha":"atmosphere_glow",yt.vertexBuffer,yt.indexBuffer,yt.segments)};Ue(!1),Ue(!0)}drawStars(n,c){const d=i.aA(c.properties.get("star-intensity"),0,1);if(d===0)return;const x=n.context,E=x.gl,I=n.transform,D=n.getOrCreateProgram("stars"),N=i.c6([]);i.c8(N,N,-I._pitch),i.c7(N,N,-I.angle),i.c8(N,N,i.an(I._center.lat)),i.eq(N,N,-i.an(I._center.lng));const H=i.cb(new Float32Array(16),N),W=i.aB([],I.starsProjMatrix,H),ee=i.el([],H),Y=i.er([],ee),se=[0,1,0];i.dN(se,se,Y),i.c4(se,se,this.params.sizeMultiplier);const fe=[1,0,0];i.dN(fe,fe,Y),i.c4(fe,fe,this.params.sizeMultiplier);const he=(Se=se,me=fe,Te=d,{u_matrix:Float32Array.from(W),u_up:Se,u_right:me,u_intensity_multiplier:Te});var Se,me,Te;n.uploadCommonUniforms(x,D),this.starsVx&&this.starsIdx&&D.draw(n,E.TRIANGLES,Mr.disabled,cn.disabled,this.colorModeAlphaBlendedWriteRGB,gn.disabled,he,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class Go{constructor(){this.visibleTiles=[]}updateBorders(n,c){const d=[],x=[],E=n._getRenderableCoordinates(!1,!0);for(const N of E){const H=n.getTile(N);if(!H.hasData())continue;const W=H.getBucket(c);W&&(W.isEmpty()||(d.push(N.key),x.push({bucket:W,tileID:N.canonical})))}let I=d.length!==this.visibleTiles.length;if(!I){d.sort();for(let N=0;N<d.length;N++)if(d[N]!==this.visibleTiles[N]){I=!0;break}}if(!I)return;const D=new Set;this.visibleTiles=d,x.sort(((N,H)=>N.tileID.z-H.tileID.z||N.tileID.x-H.tileID.x||N.tileID.y-H.tileID.y));for(const N of x){const H=new Array,W=new Array,ee=N.bucket;for(const Y of ee.featuresOnBorder)D.has(Y.featureId)?W.push(Y.footprintIndex):(D.add(Y.featureId),H.push(Y.footprintIndex));ee.updateFootprintHiddenFlags(H,i.es,!1),ee.updateFootprintHiddenFlags(W,i.es,!0)}}}function pt(p,n){const c=[...p],d=n.cameraWorldSizeForFog/n.worldSize,x=i.bA([]);return i.cR(x,x,[d,d,1]),i.aB(c,x,c),i.aB(c,n.worldToFogMatrix,c),c}function sm(p,n,c,d,x){const E=c.material,I=d.context,{baseColorTexture:D,metallicRoughnessTexture:N}=E.pbrMetallicRoughness,{normalTexture:H,occlusionTexture:W,emissionTexture:ee}=E;function Y(fe,he,Se){if(fe&&(p.push(he),I.activeTexture.set(I.gl.TEXTURE0+Se),fe.gfxTexture)){const{minFilter:me,magFilter:Te,wrapS:Oe,wrapT:Le}=fe.sampler;fe.gfxTexture.bindExtraParam(me,Te,Oe,Le)}}Y(D,"HAS_TEXTURE_u_baseColorTexture",Ki.BaseColor),Y(N,"HAS_TEXTURE_u_metallicRoughnessTexture",Ki.MetallicRoughness),Y(H,"HAS_TEXTURE_u_normalTexture",Ki.Normal),Y(W,"HAS_TEXTURE_u_occlusionTexture",Ki.Occlusion),Y(ee,"HAS_TEXTURE_u_emissionTexture",Ki.Emission),x&&(x.texture||(x.texture=new i.dY(d.context,x.image,[x.image.height,x.image.height,x.image.height],I.gl.RGBA8)),I.activeTexture.set(I.gl.TEXTURE0+Ki.LUT),x.texture&&x.texture.bind(I.gl.LINEAR,I.gl.CLAMP_TO_EDGE),p.push("APPLY_LUT_ON_GPU")),c.texcoordBuffer&&(p.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(c.texcoordBuffer)),c.colorBuffer&&(p.push(c.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(c.colorBuffer)),c.normalBuffer&&(p.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(c.normalBuffer)),c.pbrBuffer&&(p.push("HAS_ATTRIBUTE_a_pbr"),p.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(c.pbrBuffer)),E.alphaMode!=="OPAQUE"&&E.alphaMode!=="MASK"||p.push("UNPREMULT_TEXTURE_IN_SHADER"),E.defined||p.push("DIFFUSE_SHADED");const se=d.shadowRenderer;se&&(p.push("RENDER_SHADOWS","DEPTH_TEXTURE"),se.useNormalOffset&&p.push("NORMAL_OFFSET"))}function Hf(p,n,c,d,x,E){const I=c.paint.get("model-opacity").constantOr(1),D=n.context,N=new Mr(n.context.gl.LEQUAL,Mr.ReadWrite,n.depthRangeFor3D),H=n.transform,W=p.mesh,ee=W.material,Y=ee.pbrMetallicRoughness,se=n.style.fog;let fe;fe=n.transform.projection.zAxisUnit==="pixels"?[...p.nodeModelMatrix]:i.aB([],d.zScaleMatrix,p.nodeModelMatrix),i.aB(fe,d.negCameraPosMatrix,fe);const he=i.bl([],fe);i.ed(he,he);const Se=c.paint.get("model-color-use-theme").constantOr("default")==="none",me=c.paint.get("model-emissive-strength").constantOr(0),Te=Dt(new Float32Array(p.worldViewProjection),new Float32Array(fe),new Float32Array(he),null,n,I,Y.baseColorFactor,ee.emissiveFactor,Y.metallicFactor,Y.roughnessFactor,ee,me,c),Oe={defines:[]},Le=[],Ge=n.shadowRenderer;Ge&&(Ge.useNormalOffset=!1),sm(Oe.defines,Le,W,n,Se?null:c.lut);let Ue=null;if(se){const Ve=pt(p.nodeModelMatrix,n.transform);if(Ue=new Float32Array(Ve),H.projection.name!=="globe"){const We=W.aabb.min,yt=W.aabb.max,[lt,Ot]=se.getOpacityForBounds(Ve,We[0],We[1],yt[0],yt[1]);Oe.overrideFog=lt>=Fr||Ot>=Fr}}const Ze=Ec(n,c.paint.get("model-cutoff-fade-range"));Ze.shouldRenderCutoff&&Oe.defines.push("RENDER_CUTOFF");const $e=n.getOrCreateProgram("model",Oe);n.uploadCommonUniforms(D,$e,null,Ue,Ze),n.renderPass!=="shadow"&&Ge&&Ge.setupShadowsFromMatrix(p.nodeModelMatrix,$e),$e.draw(n,D.gl.TRIANGLES,N,x,E,W.material.doubleSided?gn.disabled:gn.backCCW,Te,c.id,W.vertexBuffer,W.indexBuffer,W.segments,c.paint,n.transform.zoom,void 0,Le)}function lm(p,n,c,d,x,E,I){let D;D=p.projection.name==="globe"?i.eu(c,p):[...c],i.aB(D,D,n.matrix);const N=i.aB([],d,D);if(n.meshes)for(const H of n.meshes){if(H.material.alphaMode!=="BLEND"){I.push({mesh:H,depth:0,modelIndex:x,worldViewProjection:N,nodeModelMatrix:D});continue}const W=i.af([],H.centroid,N);!p.isOrthographic&&W[2]<=0||E.push({mesh:H,depth:W[2],modelIndex:x,worldViewProjection:N,nodeModelMatrix:D})}if(n.children)for(const H of n.children)lm(p,H,c,d,x,E,I)}function Od(p,n,c,d){const x=c.shadowRenderer;if(!x)return;const E=x.getShadowPassDepthMode(),I=x.getShadowPassColorMode(),D=x.calculateShadowPassMatrixFromMatrix(n),N=yr(D);c.getOrCreateProgram("modelDepth",{defines:c._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(c,c.context.gl.TRIANGLES,E,cn.disabled,I,gn.backCCW,N,d.id,p.vertexBuffer,p.indexBuffer,p.segments,d.paint,c.transform.zoom,void 0,void 0)}function A0(p,n,c){const d=n.updateZoomBasedPaintProperties(),x=(function(E,I,D){let N,H,W,ee=E.terrain?E.terrain.exaggeration():0;if(E.terrain&&ee>0){const Y=E.terrain,se=Y.findDEMTileFor(D);se&&se.dem?N=i.ew.create(Y,D,se):ee=0}if(ee===0&&(I.terrainElevationMin=0,I.terrainElevationMax=0),ee===I.validForExaggeration&&(ee===0||N&&N._demTile&&N._demTile.tileID===I.validForDEMTile.id&&N._dem._timestamp===I.validForDEMTile.timestamp))return!1;for(const Y in I.instancesPerModel){const se=I.instancesPerModel[Y];for(let fe=0;fe<se.instancedDataArray.length;++fe){const he=(N?ee*N.getElevationAt(0|se.instancedDataArray.float32[16*fe],0|se.instancedDataArray.float32[16*fe+1],!0,!0):0)+se.instancesEvaluatedElevation[fe];se.instancedDataArray.float32[16*fe+6]=he,H=H?Math.min(I.terrainElevationMin,he):he,W=W?Math.max(I.terrainElevationMax,he):he}}return I.terrainElevationMin=H||0,I.terrainElevationMax=W||0,I.validForExaggeration=ee,I.validForDEMTile=N&&N._demTile?{id:N._demTile.tileID,timestamp:N._dem._timestamp}:{id:void 0,timestamp:0},!0})(p,n,c);(d||x)&&(n.uploaded=!1,n.upload(p.context))}const jc={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.d8([0,0,0],[i.al,i.al,0])};function qf(p,n){const c=1<<p.canonical.z,d=n.getFreeCameraOptions().position,x=n.elevation,E=p.canonical.x/c,I=(p.canonical.x+1)/c,D=p.canonical.y/c,N=(p.canonical.y+1)/c;let H=n._centerAltitude;if(x){const se=x.getMinMaxForTile(p);se&&se.max>H&&(H=se.max)}const W=i.aA(d.x,E,I)-d.x,ee=i.aA(d.y,D,N)-d.y,Y=i.ce(H,n.center.lat)-d.z;return n._zoomFromMercatorZ(Math.sqrt(W*W+ee*ee+Y*Y))}function g0(p,n,c,d,x,E,I){const D=p.context,N=p.renderPass==="shadow",H=p.shadowRenderer,W=N&&H?H.getShadowPassDepthMode():new Mr(D.gl.LEQUAL,Mr.ReadWrite,p.depthRangeFor3D),ee=p.isTileAffectedByFog(E);if(c.meshes)for(const Y of c.meshes){const se=["MODEL_POSITION_ON_GPU"],fe=[];let he,Se,me;d.instancedDataArray.length>20&&se.push("INSTANCED_ARRAYS");const Te=Ec(p,n.paint.get("model-cutoff-fade-range"));if(Te.shouldRenderCutoff&&se.push("RENDER_CUTOFF"),N&&H)he=p.getOrCreateProgram("modelDepth",{defines:se}),Se=yr(I.shadowTileMatrix,I.shadowTileMatrix,Float32Array.from(c.matrix)),me=H.getShadowPassColorMode();else{sm(se,fe,Y,p,n.paint.get("model-color-use-theme").constantOr("default")==="none"?null:n.lut),he=p.getOrCreateProgram("model",{defines:se,overrideFog:ee});const Le=Y.material,Ge=Le.pbrMetallicRoughness,Ue=n.paint.get("model-opacity").constantOr(1),Ze=n.paint.get("model-emissive-strength").constantOr(0);Se=Dt(E.expandedProjMatrix,Float32Array.from(c.matrix),new Float32Array(16),null,p,Ue,Ge.baseColorFactor,Le.emissiveFactor,Ge.metallicFactor,Ge.roughnessFactor,Le,Ze,n,x),H&&(I.shadowUniformsInitialized?he.setShadowUniformValues(D,H.getShadowUniformValues()):(H.setupShadows(E.toUnwrapped(),he,"model-tile"),I.shadowUniformsInitialized=!0)),me=Te.shouldRenderCutoff||Ue<1||Le.alphaMode!=="OPAQUE"?Mn.alphaBlended:Mn.unblended}p.uploadCommonUniforms(D,he,E.toUnwrapped(),null,Te);const Oe=Y.material.doubleSided?gn.disabled:gn.backCCW;if(d.instancedDataArray.length>20)fe.push(d.instancedDataBuffer),he.draw(p,D.gl.TRIANGLES,W,cn.disabled,me,Oe,Se,n.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,n.paint,p.transform.zoom,void 0,fe,d.instancedDataArray.length);else{const Le=N?"u_instance":"u_normal_matrix";for(let Ge=0;Ge<d.instancedDataArray.length;++Ge)Se[Le]=new Float32Array(d.instancedDataArray.arrayBuffer,64*Ge,16),he.draw(p,D.gl.TRIANGLES,W,cn.disabled,me,Oe,Se,n.id,Y.vertexBuffer,Y.indexBuffer,Y.segments,n.paint,p.transform.zoom,void 0,fe)}}if(c.children)for(const Y of c.children)g0(p,n,Y,d,x,E,I)}const Dg=[1,-1,1];function Og(p,n,c,d){if(!c.modelManager)return!0;const x=c.modelManager;if(!c.shadowRenderer)return!0;const E=c.shadowRenderer,I=n.aabb;let D=!0,N=p.maxHeight;if(N===0){let W=0;for(const ee in p.instancesPerModel){const Y=x.getModel(ee,d);Y?W=Math.max(W,Math.max(Math.max(Y.aabb.max[0],Y.aabb.max[1]),Y.aabb.max[2])):D=!1}N=p.maxScale*W*1.41+p.maxVerticalOffset,D&&(p.maxHeight=N)}I.max[2]=N,I.min[2]+=p.terrainElevationMin,I.max[2]+=p.terrainElevationMax,i.af(I.min,I.min,n.tileMatrix),i.af(I.max,I.max,n.tileMatrix);const H=I.intersects(E.getCurrentCascadeFrustum());return c.currentShadowCascade===0&&(p.isInsideFirstShadowMapFrustum=H===2),H===0}function mp(p,n){const c=p.uniformValues.u_cutoff_params[0],d=p.uniformValues.u_cutoff_params[1],x=p.uniformValues.u_cutoff_params[2],E=p.uniformValues.u_cutoff_params[3];return d===c||E===x?1:i.aA(((n-c)/(d-c)-x)/(E-x),0,1)}function pA(p,n,c,d){if(n.pitch<20)return 1;const x=n.getWorldToCameraMatrix();i.aB(x,x,p);const E=i.bU(c.min[0],c.min[1],c.min[2],1);let I=i.aC(i.ex(),E,x),D=I,N=I;E[1]=c.max[1],I=i.aC(i.ex(),E,x),D=I[1]<D[1]?I:D,N=I[1]>N[1]?I:N,E[0]=c.max[0],I=i.aC(i.ex(),E,x),D=I[1]<D[1]?I:D,N=I[1]>N[1]?I:N,E[1]=c.min[1],I=i.aC(i.ex(),E,x),D=I[1]<D[1]?I:D,N=I[1]>N[1]?I:N;const H=i.aA(d[0],0,1),W=100*n.pixelsPerMeter*i.aA(d[1],0,1),ee=i.aA(d[2],0,1),Y=i.ey(i.ex(),D,N,H),se=Math.tan(.5*n.fovX),fe=-Y[2]*se;if(W===0)return Y[1]<-Math.abs(fe)?ee:1;const he=(-Math.abs(fe)-Y[1])/W,Se=(Te,Oe,Le)=>(1-Le)*Te+Le*Oe,me=i.aA(Se(1,ee,he),ee,1);return Se(1,me,i.aA((n.pitch-20)/20,0,1))}class _0{}class mA{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,c,d){{const ee=this._storage.get(c.id);if(ee)return ee.lastUsedFrameIdx=n,ee.buf}const x=d.gl,E=x.getBufferParameter(x.ELEMENT_ARRAY_BUFFER,x.BUFFER_SIZE),I=new ArrayBuffer(E),D=new Int16Array(I);x.getBufferSubData(x.ELEMENT_ARRAY_BUFFER,0,new Int16Array(I));const N=new i.eA;for(let ee=0;ee<E/2;ee+=3){const Y=D[ee],se=D[ee+1],fe=D[ee+2];N.emplaceBack(Y,se),N.emplaceBack(se,fe),N.emplaceBack(fe,Y)}const H=d.bindVertexArrayOES.current,W=new _0;return W.buf=new an(d,N),W.lastUsedFrameIdx=n,this._storage.set(c.id,W),d.bindVertexArrayOES.set(H),W.buf}update(n){for(const[c,d]of this._storage)n-d.lastUsedFrameIdx>30&&(d.buf.destroy(),this._storage.delete(c))}destroy(){for(const[n,c]of this._storage)c.buf.destroy(),this._storage.delete(n)}}class cm{constructor(n){this.occluderSize=30,this.depthOffset=-1e-4,n.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),n.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Ap=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class gp{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class y0{constructor(n,c){this.revealStart=11,this.revealRange=2,n.registerParameter(this,[...c,"Reveal"],"revealStart",{min:0,max:17,step:.05}),n.registerParameter(this,[...c,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const v0=i.ef([{type:"Float32",name:"a_pos_2f",components:2}]);class um{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(n,c){const d=n.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const I=new i.eB,D=new i.b1;I.emplaceBack(-1,-1),I.emplaceBack(1,-1),I.emplaceBack(1,1),I.emplaceBack(-1,1),D.emplaceBack(0,1,2),D.emplaceBack(0,2,3),this.vignetteVx=n.context.createVertexBuffer(I,v0.members),this.vignetteIdx=n.context.createIndexBuffer(D)}const x=i.bg.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){n.uploadCommonUniforms(n.context,d);const I={u_vignetteShape:(E={vignetteShape:[c.start,c.range,Math.pow(10,c.fadePower)],vignetteColor:[c.color.r,c.color.g,c.color.b,c.color.a*c.strength]}).vignetteShape,u_vignetteColor:E.vignetteColor};d.draw(n,n.context.gl.TRIANGLES,Mr.disabled,cn.disabled,Mn.alphaBlended,gn.disabled,I,"vignette",this.vignetteVx,this.vignetteIdx,x)}var E}}class AA{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(n,c){const d=n.getFreeCameraOptions().position,x=d.toAltitude(),E=d.toLngLat(),I=i.an(E.lng),D=i.an(E.lat),N=n.pixelsPerMeter/c,H=I*i.eD,W=i.eD*Math.log(Math.tan(Math.PI/4+D/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const ee=-this._offsetYPrev+W,Y=-this._elevationPrev+x;this._accumulatedOffsetX+=(-this._offsetXPrev+H)*N,this._accumulatedOffsetY+=ee*N,this._accumulatedElevation+=Y*N,this._offsetXPrev=H,this._offsetYPrev=W,this._elevationPrev=x}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function hm(p,n){return[-(p[0]-Math.floor(p[0]/n)*n),-(p[1]-Math.floor(p[1]/n)*n),-(p[2]-Math.floor(p[2]/n)*n)]}function Ls(p){const n=i.eo(1323123451230),c=[];for(let d=0;d<p;++d){const x=2*n()-1,E=2*n()-1,I=2*n()-1;c.push(i.d4(x,E,I))}return c}function af(p,n,c,d,x){const E=i.aA((x-c)/(d-c),0,1);return(1-E)*p+E*n}class sf{constructor(n){this._movement=new AA,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new um,this._ppmScaleFactor=n}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(n,c){const d=n.transform;this._movement.update(d,this._ppmScaleFactor);const x=d.starsProjMatrix,E=i.c6([]);i.c8(E,E,i.an(90)-d._pitch),i.c7(E,E,-d.angle);const I=i.cb(new Float32Array(16),E),D=i.eC(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),N=i.ed([],D),H=i.aB([],N,I),W=Date.now()/1e3;return this._accumulatedTimeFromStart+=(W-this._prevTime)*c,this._prevTime=W,{projectionMatrix:x,modelviewMatrix:H}}}class _o extends sf{constructor(n){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new y0(n.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(n){const c=n.context;if(!this.particlesVx){const d=Ls(this.particlesCount),x=new i.eE,E=new i.b1;let I=0;const D=i.eo(1323123451230);for(let N=0;N<d.length;++N){const H=d[N],W=[2*D()-1,D(),D(),D()];x.emplaceBack(H[0],H[1],H[2],-1,-1,...W),x.emplaceBack(H[0],H[1],H[2],1,-1,...W),x.emplaceBack(H[0],H[1],H[2],1,1,...W),x.emplaceBack(H[0],H[1],H[2],-1,1,...W),E.emplaceBack(I+0,I+1,I+2),E.emplaceBack(I+0,I+2,I+3),I+=4}this.particlesVx=c.createVertexBuffer(x,Ap.members),this.particlesIdx=c.createIndexBuffer(E)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.rain)return;const c=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},d=n.transform.zoom;if(c.revealStart>d)return;const x=af(0,1,c.revealStart,c.revealStart+c.revealRange,d);if(!this.particlesVx||!this.particlesIdx)return;const E=structuredClone(this._params);let I=[-E.direction.x,E.direction.y,-100];i.aw(I,I);const D=structuredClone(this._vignetteParams);D.strength*=x,E.overrideStyleParameters||(E.intensity=n.style.rain.state.density,E.timeFactor=n.style.rain.state.intensity,E.color=structuredClone(n.style.rain.state.color),I=structuredClone(n.style.rain.state.direction),E.screenThinning.intensity=n.style.rain.state.centerThinning,E.dropletSizeX=n.style.rain.state.dropletSize[0],E.dropletSizeYScale=n.style.rain.state.dropletSize[1]/n.style.rain.state.dropletSize[0],E.distortionStrength=100*n.style.rain.state.distortionStrength,D.strength=1,D.color=structuredClone(n.style.rain.state.vignetteColor));const N=this.updateOnRender(n,E.timeFactor),H=n.context,W=H.gl,ee=n.transform;this.screenTexture&&this.screenTexture.size[0]===n.width&&this.screenTexture.size[1]===n.height||(this.screenTexture=new i.T(H,{width:n.width,height:n.height,data:null},W.RGBA8)),E.distortionStrength>0&&(H.activeTexture.set(W.TEXTURE0),this.screenTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),W.copyTexSubImage2D(W.TEXTURE_2D,0,0,0,0,0,n.width,n.height));const Y=n.getOrCreateProgram("rainParticle");n.uploadCommonUniforms(H,Y),H.activeTexture.set(W.TEXTURE0),this.screenTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const se=[E.color.r,E.color.g,E.color.b,E.color.a],fe=(he,Se)=>{const me=hm(this._movement.getPosition(),he),Te=E.dropletSizeX,Oe=E.dropletSizeX*E.dropletSizeYScale,Le=n.width/2,Ge=n.height/2,Ue=af(0,E.screenThinning.start,0,1,E.screenThinning.intensity),Ze=af(.001,E.screenThinning.range,0,1,E.screenThinning.intensity),$e=af(0,E.screenThinning.particleOffset,0,1,E.screenThinning.intensity),Ve=(We={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:me,velocityConeAperture:E.velocityConeAperture,velocity:E.velocity,boxSize:he,rainDropletSize:[Te,Oe],distortionStrength:E.distortionStrength,rainDirection:I,color:se,screenSize:[ee.width,ee.height],thinningCenterPos:[Le,Ge],thinningShape:[Ue,Ze,Math.pow(10,E.screenThinning.fadePower)],thinningAffectedRatio:E.screenThinning.affectedRatio,thinningParticleOffset:$e,shapeDirectionalPower:E.shapeDirPower,shapeNormalPower:E.shapeNormalPower,mode:Se?0:1},{u_modelview:Float32Array.from(We.modelview),u_projection:Float32Array.from(We.projection),u_time:We.time,u_cam_pos:We.camPos,u_texScreen:0,u_velocityConeAperture:We.velocityConeAperture,u_velocity:We.velocity,u_boxSize:We.boxSize,u_rainDropletSize:We.rainDropletSize,u_distortionStrength:We.distortionStrength,u_rainDirection:We.rainDirection,u_color:We.color,u_screenSize:We.screenSize,u_thinningCenterPos:We.thinningCenterPos,u_thinningShape:We.thinningShape,u_thinningAffectedRatio:We.thinningAffectedRatio,u_thinningParticleOffset:We.thinningParticleOffset,u_shapeDirectionalPower:We.shapeDirectionalPower,u_shapeNormalPower:We.shapeNormalPower,u_mode:We.mode});var We;const yt=Math.round(E.intensity*this.particlesCount),lt=i.bg.simpleSegment(0,0,4*yt,2*yt);Y.draw(n,W.TRIANGLES,Mr.disabled,cn.disabled,Mn.alphaBlended,gn.disabled,Ve,"rain_particles",this.particlesVx,this.particlesIdx,lt)};E.distortionStrength>0&&fe(E.boxSize,!0),fe(E.boxSize,!1),this._vignette.draw(n,D)}}const ii=i.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class kg extends sf{constructor(n){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new y0(n.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(n){const c=n.context;if(!this.particlesVx){const d=Ls(this.particlesCount),x=new i.eF,E=new i.b1;let I=0;const D=i.eo(1323123451230);for(let N=0;N<d.length;++N){const H=d[N],W=D(),ee=D(),Y=D(),se=[N/d.length,W,ee,Y],fe=[D(),D()];x.emplaceBack(H[0],H[1],H[2],-1,-1,...se,...fe),x.emplaceBack(H[0],H[1],H[2],1,-1,...se,...fe),x.emplaceBack(H[0],H[1],H[2],1,1,...se,...fe),x.emplaceBack(H[0],H[1],H[2],-1,1,...se,...fe),E.emplaceBack(I+0,I+1,I+2),E.emplaceBack(I+0,I+2,I+3),I+=4}this.particlesVx=c.createVertexBuffer(x,ii.members),this.particlesIdx=c.createIndexBuffer(E)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.snow)return;const c=structuredClone(this._params);let d=[-c.direction.x,c.direction.y,-100];i.aw(d,d);const x=structuredClone(this._vignetteParams),E=c.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},I=n.transform.zoom;if(E.revealStart>I)return;const D=af(0,1,E.revealStart,E.revealStart+E.revealRange,I);x.strength*=D,c.overrideStyleParameters||(c.intensity=n.style.snow.state.density,c.timeFactor=n.style.snow.state.intensity,c.color=structuredClone(n.style.snow.state.color),d=structuredClone(n.style.snow.state.direction),c.screenThinning.intensity=n.style.snow.state.centerThinning,c.billboardSize=2.79*n.style.snow.state.flakeSize,x.strength=1,x.color=structuredClone(n.style.snow.state.vignetteColor));const N=this.updateOnRender(n,c.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const H=n.context,W=H.gl,ee=n.transform,Y=n.getOrCreateProgram("snowParticle");n.uploadCommonUniforms(H,Y),((se,fe,he)=>{const Se=hm(this._movement.getPosition(),se),me=ee.width/2,Te=ee.height/2,Oe=af(0,he.screenThinning.start,0,1,he.screenThinning.intensity),Le=af(.001,he.screenThinning.range,0,1,he.screenThinning.intensity),Ge=af(0,he.screenThinning.particleOffset,0,1,he.screenThinning.intensity),Ue=(Ze={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Se,velocityConeAperture:he.velocityConeAperture,velocity:he.velocity,horizontalOscillationRadius:he.horizontalOscillationRadius,horizontalOscillationRate:he.horizontalOscillationRate,boxSize:se,billboardSize:1*he.billboardSize,simpleShapeParameters:[he.shapeFadeStart,he.shapeFadePower],screenSize:[ee.width,ee.height],thinningCenterPos:[me,Te],thinningShape:[Oe,Le,Math.pow(10,he.screenThinning.fadePower)],thinningAffectedRatio:he.screenThinning.affectedRatio,thinningParticleOffset:Ge,color:[he.color.r,he.color.g,he.color.b,he.color.a],direction:d},{u_modelview:Float32Array.from(Ze.modelview),u_projection:Float32Array.from(Ze.projection),u_time:Ze.time,u_cam_pos:Ze.camPos,u_velocityConeAperture:Ze.velocityConeAperture,u_velocity:Ze.velocity,u_horizontalOscillationRadius:Ze.horizontalOscillationRadius,u_horizontalOscillationRate:Ze.horizontalOscillationRate,u_boxSize:Ze.boxSize,u_billboardSize:Ze.billboardSize,u_simpleShapeParameters:Ze.simpleShapeParameters,u_screenSize:Ze.screenSize,u_thinningCenterPos:Ze.thinningCenterPos,u_thinningShape:Ze.thinningShape,u_thinningAffectedRatio:Ze.thinningAffectedRatio,u_thinningParticleOffset:Ze.thinningParticleOffset,u_particleColor:Ze.color,u_direction:Ze.direction});var Ze;const $e=Math.round(he.intensity*this.particlesCount),Ve=i.bg.simpleSegment(0,0,4*$e,2*$e);this.particlesVx&&this.particlesIdx&&Y.draw(n,W.TRIANGLES,Mr.disabled,cn.disabled,Mn.alphaBlended,gn.disabled,Ue,"snow_particles",this.particlesVx,this.particlesIdx,Ve)})(c.boxSize,0,c),this._vignette.draw(n,x)}}const uc={symbol:function(p,n,c,d,x){if(p.renderPass!=="translucent")return;const E=cn.disabled,I=p.colorModeForRenderPass(),D=c.layout.get("text-variable-anchor"),N=c.layout.get("text-size-scale-range"),H=i.aA(p.scaleFactor,N[0],N[1]);D&&(function(Y,se,fe,he,Se,me,Te,Oe){const Le=se.transform,Ge=Se==="map",Ue=me==="map";for(const Ze of Y){const $e=he.getTile(Ze),Ve=$e.getBucket(fe);if(!Ve||!Ve.text||!Ve.text.segments.get().length)continue;const We=i.bK(Ve.textSizeData,Le.zoom,Oe),yt=bl(Ze,Ve.getProjection(),Le),lt=Le.calculatePixelsToTileUnitsMatrix($e),Ot=Ka(yt,$e.tileID.canonical,Ue,Ge,Le,Ve.getProjection(),lt),_t=Ve.hasIconTextFit()&&Ve.hasIconData();We&&Eo(Ve,Ge,Ue,Te,Le,Ot,Ze,Math.pow(2,Le.zoom-$e.tileID.overscaledZ),We,_t)}})(d,p,c,n,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),x,H);const W=c.paint.get("icon-opacity").constantOr(1)!==0,ee=c.paint.get("text-opacity").constantOr(1)!==0;c.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(W||ee)?Ha(p,n,c,d,E,I):(W&&Ha(p,n,c,d,E,I,{onlyIcons:!0}),ee&&Ha(p,n,c,d,E,I,{onlyText:!0})),n.map.showCollisionBoxes&&(Wr(p,n,c,d,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Wr(p,n,c,d,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(p,n,c,d){if(p.renderPass!=="translucent")return;const x=c.paint.get("circle-opacity"),E=c.paint.get("circle-stroke-width"),I=c.paint.get("circle-stroke-opacity"),D=c.layout.get("circle-sort-key").constantOr(1)!==void 0,N=c.paint.get("circle-emissive-strength");if(x.constantOr(1)===0&&(E.constantOr(1)===0||I.constantOr(1)===0))return;const H=p.context,W=H.gl,ee=p.transform,Y=!(!p.terrain||!p.terrain.enabled),se=c.layout.get("circle-elevation-reference"),fe=p.depthModeForSublayer(0,Mr.ReadOnly),he=new Mr(p.context.gl.LEQUAL,Mr.ReadOnly,p.depthRangeFor3D),Se=se==="none"||Y?fe:he,me=cn.disabled,Te=p.colorModeForDrapableLayerRenderPass(N),Oe=ee.projection.name==="globe",Le=[i.aF(ee.center.lng),i.aJ(ee.center.lat)],Ge=[];for(let Ze=0;Ze<d.length;Ze++){const $e=d[Ze],Ve=n.getTile($e),We=Ve.getBucket(c);if(!We||We.projection.name!==ee.projection.name)continue;const yt=We.programConfigurations.get(c.id),lt=We.layoutVertexBuffer,Ot=We.globeExtVertexBuffer,_t=We.indexBuffer,It=i.dZ(c),ur=[Ot],xt=p.isTileAffectedByFog($e);Oe&&It.push("PROJECTION_GLOBE_VIEW"),It.push("DEPTH_D24"),p.terrain&&ee.depthOcclusionForSymbolsAndCircles&&It.push("DEPTH_OCCLUSION"),We.hasElevation&&!p.terrain&&(It.push("ELEVATED_ROADS"),ur.push(We.elevatedLayoutVertexBuffer));const rt=p.getOrCreateProgram("circle",{config:yt,defines:It,overrideFog:xt}),zt=ee.projection.createInversionMatrix(ee,$e.canonical),gt={programConfiguration:yt,program:rt,layoutVertexBuffer:lt,dynamicBuffers:ur,indexBuffer:_t,uniformValues:i.d_(p,$e,Ve,zt,Le,c),tile:Ve};if(D){const Bt=We.segments.get();for(const Gt of Bt)Ge.push({segments:new i.bg([Gt]),sortKey:Gt.sortKey,state:gt})}else Ge.push({segments:We.segments,sortKey:0,state:gt})}D&&Ge.sort(((Ze,$e)=>Ze.sortKey-$e.sortKey));const Ue={useDepthForOcclusion:ee.depthOcclusionForSymbolsAndCircles};for(const Ze of Ge){const{programConfiguration:$e,program:Ve,layoutVertexBuffer:We,dynamicBuffers:yt,indexBuffer:lt,uniformValues:Ot,tile:_t}=Ze.state,It=Ze.segments;p.terrain&&p.terrain.setupElevationDraw(_t,Ve,Ue),p.uploadCommonUniforms(H,Ve,_t.tileID.toUnwrapped()),Ve.draw(p,W.TRIANGLES,Se,me,Te,gn.disabled,Ot,c.id,We,lt,It,c.paint,ee.zoom,$e,yt)}},heatmap:function(p,n,c,d){if(c.paint.get("heatmap-opacity")!==0)if(p.renderPass==="offscreen"){const x=p.context,E=x.gl,I=cn.disabled,D=new Mn([E.ONE,E.ONE,E.ONE,E.ONE],i.ao.transparent,[!0,!0,!0,!0]);(function(se,fe,he,Se){const me=se.gl,Te=fe.width*Se,Oe=fe.height*Se;se.activeTexture.set(me.TEXTURE1),se.viewport.set([0,0,Te,Oe]);let Le=he.heatmapFbo;if(!Le||Le&&(Le.width!==Te||Le.height!==Oe)){Le&&Le.destroy();const Ge=me.createTexture();me.bindTexture(me.TEXTURE_2D,Ge),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_S,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_WRAP_T,me.CLAMP_TO_EDGE),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MIN_FILTER,me.LINEAR),me.texParameteri(me.TEXTURE_2D,me.TEXTURE_MAG_FILTER,me.LINEAR),Le=he.heatmapFbo=se.createFramebuffer(Te,Oe,!0,null),(function(Ue,Ze,$e,Ve,We,yt){const lt=Ue.gl;lt.texImage2D(lt.TEXTURE_2D,0,Ue.extRenderToTextureHalfFloat?lt.RGBA16F:lt.RGBA,We,yt,0,lt.RGBA,Ue.extRenderToTextureHalfFloat?lt.HALF_FLOAT:lt.UNSIGNED_BYTE,null),Ve.colorAttachment.set($e)})(se,0,Ge,Le,Te,Oe)}else me.bindTexture(me.TEXTURE_2D,Le.colorAttachment.get()),se.bindFramebuffer.set(Le.framebuffer)})(x,p,c,p.transform.projection.name==="globe"?.5:.25),x.clear({color:i.ao.transparent});const N=p.transform,H=N.projection.name==="globe",W=H?["PROJECTION_GLOBE_VIEW"]:[],ee=H?gn.frontCCW:gn.disabled,Y=[i.aF(N.center.lng),i.aJ(N.center.lat)];for(let se=0;se<d.length;se++){const fe=d[se];if(n.hasRenderableParent(fe))continue;const he=n.getTile(fe),Se=he.getBucket(c);if(!Se||Se.projection.name!==N.projection.name)continue;const me=p.isTileAffectedByFog(fe),Te=Se.programConfigurations.get(c.id),Oe=p.getOrCreateProgram("heatmap",{config:Te,defines:W,overrideFog:me}),{zoom:Le}=p.transform;p.terrain&&p.terrain.setupElevationDraw(he,Oe),p.uploadCommonUniforms(x,Oe,fe.toUnwrapped());const Ge=N.projection.createInversionMatrix(N,fe.canonical);Oe.draw(p,E.TRIANGLES,Mr.disabled,I,D,ee,V(p,fe,he,Ge,Y,Le,c.paint.get("heatmap-intensity")),c.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,c.paint,p.transform.zoom,Te,H?[Se.globeExtVertexBuffer]:null)}x.viewport.set([0,0,p.width,p.height])}else p.renderPass==="translucent"&&(p.context.setColorMode(p.colorModeForRenderPass()),(function(x,E){const I=x.context,D=I.gl,N=E.heatmapFbo;if(!N)return;I.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,N.colorAttachment.get()),I.activeTexture.set(D.TEXTURE1);let H=E.colorRampTexture;H||(H=E.colorRampTexture=new i.T(I,E.colorRamp,D.RGBA8)),H.bind(D.LINEAR,D.CLAMP_TO_EDGE),x.getOrCreateProgram("heatmapTexture").draw(x,D.TRIANGLES,Mr.disabled,cn.disabled,x.colorModeForRenderPass(),gn.disabled,((W,ee,Y,se)=>({u_image:0,u_color_ramp:1,u_opacity:ee.paint.get("heatmap-opacity")}))(0,E),E.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,E.paint,x.transform.zoom)})(p,c))},line:function(p,n,c,d){if(p.renderPass!=="translucent")return;const x=c.paint.get("line-opacity"),E=c.paint.get("line-width");if(x.constantOr(1)===0||E.constantOr(1)===0)return;const I=c.paint.get("line-emissive-strength"),D=c.paint.get("line-occlusion-opacity"),N=c.layout.get("line-elevation-reference"),H=c.layout.get("line-width-unit")==="meters",W=N==="sea",ee=!(!p.terrain||!p.terrain.enabled),Y=p.context,se=Y.gl;if(c.hasElevatedBuckets&&p.transform.projection.name==="globe")return;const fe=c.layout.get("line-cross-slope"),he=fe!==void 0,Se=fe<1,me=p.colorModeForDrapableLayerRenderPass(I),Te=p.terrain&&p.terrain.renderingToTexture,Oe=Te?1:i.o.devicePixelRatio,Le=c.paint.get("line-dasharray"),Ge=Le.constantOr(1),Ue=c.layout.get("line-cap"),Ze=Le.constantOr(null),$e=Ue.constantOr(null),Ve=c.paint.get("line-pattern"),We=Ve.constantOr(1),yt=c.paint.get("line-pattern-cross-fade"),lt=Ve.constantOr(null),Ot=c.paint.get("line-opacity").constantOr(1);let _t=!We&&Ot!==1||p.depthOcclusion&&D>0&&D<1;const It=c.paint.get("line-gradient"),ur=We?"linePattern":"line",xt=i.d$(c);let rt;if(Te&&p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(_t=!1),D!==0&&p.depthOcclusion){const Gt=c.paint._values["line-opacity"];Gt&&Gt.value&&Gt.value.kind==="constant"?rt=Gt.value:i.w(`Occlusion opacity for layer ${c.id} is supported only when line-opacity isn't data-driven.`)}E.value.kind!=="constant"&&E.value.isLineProgressConstant===!1&&xt.push("VARIABLE_LINE_WIDTH");const zt=(Gt,ar,Ht,Xt,qr,$r)=>{for(const Yr of Gt){const Lr=n.getTile(Yr);if(We&&!Lr.patternsLoaded())continue;const rn=Lr.getBucket(c);if(!rn||rn.elevationType!=="none"&&!qr||rn.elevationType==="none"&&qr)continue;p.prepareDrawTile();const En=[...ar],In=p.shadowRenderer,ki=rn.elevationType==="road"&&!!In&&In.enabled;let _n=[0,0,0];if(ki){const Pn=p.style.directionalLight,An=p.style.ambientLight;Pn&&An&&(_n=vs(p.style,Pn,An)),En.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const si=rn.programConfigurations.get(c.id);let xi=!1;if(lt&&Lr.imageAtlas){const Pn=i.e0.from(lt),An=Pn.getPrimary().scaleSelf(Oe).toString(),zi=Lr.imageAtlas.patternPositions.get(An),Ho=Pn.getSecondary(),ho=Ho?Lr.imageAtlas.patternPositions.get(Ho.scaleSelf(Oe).toString()):null;xi=!!zi&&!!ho,zi&&si.setConstantPatternPositions(zi,ho)}yt>0&&(xi||si.getPatternTransitionVertexBuffer("line-pattern"))&&En.push("LINE_PATTERN_TRANSITION");const Ci=p.isTileAffectedByFog(Yr),On=p.getOrCreateProgram(ur,{config:si,defines:En,overrideFog:Ci});if(!We&&Ze&&$e&&Lr.lineAtlas){const Pn=Lr.lineAtlas.getDash(Ze,$e);Pn&&si.setConstantPatternPositions(Pn)}ki&&In.setupShadows(Lr.tileID.toUnwrapped(),On,"vector-tile");let[bi,Ai]=c.paint.get("line-trim-offset");($e==="round"||$e==="square")&&bi!==Ai&&(bi===0&&(bi-=1),Ai===1&&(Ai+=1));const wi=Te?Yr.projMatrix:null,Ji=H?1/rn.tileToMeter/i.ay(Lr,1,p.transform.zoom):1,Vi=H?1/rn.tileToMeter/i.ay(Lr,1,Math.floor(p.transform.zoom)):1,ta=We?i.e1(p,Lr,c,wi,Oe,Ji,Vi,[bi,Ai],_n,yt):i.e2(p,Lr,c,wi,rn.lineClipsArray.length,Oe,Ji,Vi,[bi,Ai],_n);if(It){const Pn=rn.gradients[c.id];let An=Pn.texture;if(c.gradientVersion!==Pn.version){let zi=256;if(c.stepInterpolant){const Ho=n.getSource().maxzoom,ho=Yr.canonical.z===Ho?Math.ceil(1<<p.transform.maxZoom-Yr.canonical.z):1;zi=i.aA(i.e3(rn.maxLineLength/i.al*1024*ho),256,Y.maxTextureSize)}Pn.gradient=i.e4({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:zi,image:Pn.gradient||void 0,clips:rn.lineClipsArray}),Pn.texture?Pn.texture.update(Pn.gradient):Pn.texture=new i.T(Y,Pn.gradient,se.RGBA8),Pn.version=c.gradientVersion,An=Pn.texture}Y.activeTexture.set(se.TEXTURE1),An.bind(c.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}Ge&&(Y.activeTexture.set(se.TEXTURE0),Lr.lineAtlasTexture&&Lr.lineAtlasTexture.bind(se.LINEAR,se.REPEAT),si.updatePaintBuffers()),We&&(Y.activeTexture.set(se.TEXTURE0),Lr.imageAtlasTexture&&Lr.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),si.updatePaintBuffers()),qr&&!W&&p.terrain.setupElevationDraw(Lr,On),p.uploadCommonUniforms(Y,On,Yr.toUnwrapped());const so=Pn=>{rt!=null&&(rt.value=Ot*D),On.draw(p,se.TRIANGLES,Ht,Pn,me,gn.disabled,ta,c.id,rn.layoutVertexBuffer,rn.indexBuffer,rn.segments,c.paint,p.transform.zoom,si,[rn.layoutVertexBuffer2,rn.patternVertexBuffer,rn.zOffsetVertexBuffer]),rt!=null&&(rt.value=Ot)};if(_t&&!qr){const Pn=p.stencilModeForClipping(Yr).ref;Pn===0&&Te&&Y.clear({stencil:0});const An={func:se.EQUAL,mask:255};ta.u_alpha_discard_threshold=.8,so(new cn(An,Pn,255,se.KEEP,se.KEEP,se.INVERT)),ta.u_alpha_discard_threshold=0,so(new cn(An,Pn,255,se.KEEP,se.KEEP,se.KEEP))}else ta.u_alpha_discard_threshold=_t&&qr&&$r?.8:0,so(qr?Xt:p.stencilModeForClipping(Yr))}};let gt=p.depthModeForSublayer(0,Mr.ReadOnly);const Bt=new Mr(p.depthOcclusion?se.GREATER:se.LEQUAL,Mr.ReadOnly,p.depthRangeFor3D);if(c.hasNonElevatedBuckets){const Gt=!Te&&p.terrain;D!==0&&Gt?i.w(`Occlusion opacity for layer ${c.id} is supported on terrain only if the layer has line-z-offset enabled.`):Gt?i.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${c.id}.`):zt(d,xt,gt,cn.disabled,!1,!0)}if(c.hasElevatedBuckets){N==="hd-road-markup"?ee||(gt=Bt,xt.push("ELEVATED_ROADS")):(xt.push("ELEVATED"),gt=Bt,he&&xt.push(Se?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),W&&xt.push("ELEVATION_REFERENCE_SEA"));const Gt=_t?p.stencilModeFor3D():cn.disabled;p.forceTerrainMode=!0,zt(d,xt,gt,Gt,!0,!0),_t&&zt(d,xt,gt,Gt,!0,!1),p.forceTerrainMode=!1}_t&&(p.resetStencilClippingMasks(),Te&&Y.clear({stencil:0})),D===0||p.depthOcclusion||Te||p.layersWithOcclusionOpacity.push(p.currentLayer)},fill:function(p,n,c,d){const x=c.paint.get("fill-color"),E=c.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const I=c.paint.get("fill-emissive-strength"),D=p.colorModeForDrapableLayerRenderPass(I),N=c.paint.get("fill-pattern"),H=p.opaquePassEnabledForLayer()&&!N.constantOr(1)&&x.constantOr(i.ao.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";let W="none";c.layout.get("fill-elevation-reference")!=="none"?W="road":c.paint.get("fill-z-offset").constantOr(1)!==0&&(W="offset");const ee=!(!p.terrain||!p.terrain.enabled),Y={painter:p,sourceCache:n,layer:c,coords:d,colorMode:D,elevationType:W,terrainEnabled:ee,pass:H};if(p.renderPass!=="shadow")if(W!=="offset"){if(Vf(Y,!1),W==="road"){const se=!ee&&p.renderPass==="translucent";se&&tf(p,n,c,d,"geometry"),Vf(Y,!0,cn.disabled),se&&(function(fe){const{painter:he,sourceCache:Se,layer:me,coords:Te,colorMode:Oe}=fe,Le=he.context.gl,Ge=fe.painter.shadowRenderer,Ue=!!Ge&&Ge.enabled,Ze=new Mr(he.context.gl.LEQUAL,Mr.ReadOnly,he.depthRangeFor3D);let $e=[0,0,0];if(Ue){const We=he.style.directionalLight,yt=he.style.ambientLight;We&&yt&&($e=vs(he.style,We,yt))}const Ve=We=>{for(const yt of Te){const lt=Se.getTile(yt),Ot=lt.getBucket(me);if(!Ot)continue;const _t=Ot.elevatedStructures;if(!_t)continue;let It,ur;if(We?(It=_t.renderableBridgeSegments,ur=_t.bridgeProgramConfigurations.get(me.id)):(It=_t.renderableTunnelSegments,ur=_t.tunnelProgramConfigurations.get(me.id)),!It||It.segments[0].primitiveLength===0)continue;ur.updatePaintBuffers(),he.prepareDrawTile();const xt=he.isTileAffectedByFog(yt),rt=[];Ue&&rt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const zt=he.getOrCreateProgram("elevatedStructures",{config:ur,overrideFog:xt,defines:rt}),gt=he.translatePosMatrix(yt.projMatrix,lt,me.paint.get("fill-translate"),me.paint.get("fill-translate-anchor"));Ue&&Ge.setupShadows(lt.tileID.toUnwrapped(),zt,"vector-tile");const Bt=Pd(gt,$e);he.uploadCommonUniforms(he.context,zt,yt.toUnwrapped()),zt.draw(he,Le.TRIANGLES,Ze,cn.disabled,Oe,gn.backCCW,Bt,me.id,_t.vertexBuffer,_t.indexBuffer,It,me.paint,he.transform.zoom,ur,[_t.vertexBufferNormal])}};Ve(!0),Ve(!1)})(Y)}}else Vf(Y,!1,p.stencilModeFor3D());else p.shadowRenderer&&W==="road"&&!ee&&(function(se){const{painter:fe,sourceCache:he,layer:Se,coords:me}=se,Te=fe.context.gl,Oe=se.painter.shadowRenderer;for(const Le of me){const Ge=he.getTile(Le),Ue=Ge.getBucket(Se);if(!Ue)continue;const Ze=Ue.elevatedStructures;if(!Ze||!Ze.shadowCasterSegments||Ze.shadowCasterSegments.segments[0].primitiveLength===0)continue;fe.prepareDrawTile();const $e=Ue.bufferData.programConfigurations.get(Se.id),Ve=fe.isTileAffectedByFog(Le),We=fe.getOrCreateProgram("elevatedStructuresDepth",{config:$e,overrideFog:Ve}),yt=Oe.calculateShadowPassMatrixFromTile(Ge.tileID.toUnwrapped());fe.uploadCommonUniforms(fe.context,We,Le.toUnwrapped());const lt={u_matrix:yt,u_depth_bias:0};We.draw(fe,Te.TRIANGLES,Oe.getShadowPassDepthMode(),cn.disabled,Oe.getShadowPassColorMode(),gn.disabled,lt,Se.id,Ze.vertexBuffer,Ze.indexBuffer,Ze.shadowCasterSegments,Se.paint,fe.transform.zoom,$e)}})(Y)},"fill-extrusion":function(p,n,c,d){const x=c.paint.get("fill-extrusion-opacity"),E=p.context,I=E.gl,D=p.terrain,N=D&&D.renderingToTexture;if(x===0)return;const H=p.conflationActive&&p.style.isLayerClipped(c,n.getSource()),W=p.style.order.indexOf(c.fqid);if(H&&(function(ee,Y,se,fe,he){for(const Se of fe){const me=Y.getTile(Se).getBucket(se);me&&(me.updateReplacement(Se,ee.replacementSource,he),me.uploadCentroid(ee.context))}})(p,n,c,d,W),D||H)for(const ee of d){const Y=n.getTile(ee).getBucket(c);Y&&ph(p.context,n,ee,Y,c,D,H)}if(p.renderPass==="shadow"&&p.shadowRenderer){const ee=p.shadowRenderer;if(D&&x<.65&&c._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.ad)return;const Y=ee.getShadowPassDepthMode(),se=ee.getShadowPassColorMode();Rr(p,n,c,d,Y,cn.disabled,se,H)}else if(p.renderPass==="translucent"){const ee=!c.paint.get("fill-extrusion-pattern").constantOr(1),Y=c.paint.get("fill-extrusion-color").constantOr(i.ao.white);if(!N&&Y.a!==0){const se=new Mr(p.context.gl.LEQUAL,Mr.ReadWrite,p.depthRangeFor3D);x===1&&ee?Rr(p,n,c,d,se,cn.disabled,Mn.unblended,H):(Rr(p,n,c,d,se,cn.disabled,Mn.disabled,H),Rr(p,n,c,d,se,p.stencilModeFor3D(),p.colorModeForRenderPass(),H),p.resetStencilClippingMasks())}if(p.style.enable3dLights()&&ee&&(!D&&p.transform.projection.name!=="globe"||N)){const se=c.paint.get("fill-extrusion-opacity"),fe=c.paint.get("fill-extrusion-ambient-occlusion-intensity"),he=c.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),Se=c.paint.get("fill-extrusion-flood-light-intensity"),me=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Te=c.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(me?null:c.lut).toArray01().slice(0,3),Oe=fe>0&&he>0,Le=Se>0,Ge=($e,Ve,We)=>(1-We)*$e+We*Ve,Ue=new hl;Ue.translate=c.paint.get("fill-extrusion-translate"),Ue.translateAnchor=c.paint.get("fill-extrusion-translate-anchor"),Ue.edgeRadius=c.layout.get("fill-extrusion-edge-radius"),Ue.cutoffFadeRange=c.paint.get("fill-extrusion-cutoff-fade-range");const Ze=$e=>{const Ve=p.depthModeForSublayer(1,Mr.ReadOnly,I.LEQUAL,!0),We=c.paint.get($e?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),yt=Ge(.1,3,We),lt=p._showOverdrawInspector;if(!lt){const Ot=new cn({func:I.ALWAYS,mask:255},255,255,I.KEEP,I.KEEP,I.REPLACE),_t=new Mn([I.ONE,I.ONE,I.ONE,I.ONE],i.ao.transparent,[!1,!1,!1,!0],I.MIN);aa(Ue,p,n,c,d,Ve,Ot,_t,gn.disabled,$e,"sdf",se,fe,he,Se,Te,yt,H,!1)}{const Ot=lt?cn.disabled:new cn({func:I.EQUAL,mask:255},255,255,I.KEEP,I.DECR,I.DECR),_t=lt?p.colorModeForRenderPass():new Mn([I.ONE_MINUS_DST_ALPHA,I.DST_ALPHA,I.ONE,I.ONE],i.ao.transparent,[!0,!0,!0,!0]);aa(Ue,p,n,c,d,Ve,Ot,_t,gn.disabled,$e,"color",se,fe,he,Se,Te,yt,H,!1)}};if(N){const $e=(Ve,We,yt)=>{const lt=p.depthModeForSublayer(1,Mr.ReadOnly,I.LEQUAL,!1),Ot=c.paint.get(Ve?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),_t=Ge(.1,3,Ot);{const It=new Mn([I.ONE,I.ONE,I.ONE,I.ONE],i.ao.transparent,[!1,!1,!1,!0]);aa(Ue,p,n,c,d,lt,cn.disabled,It,gn.disabled,Ve,"clear",se,fe,he,Se,Te,_t,H,We)}{const It=new cn({func:I.ALWAYS,mask:255},255,255,I.KEEP,I.KEEP,I.REPLACE),ur=new Mn([I.ONE,I.ONE,I.ONE,I.ONE],i.ao.transparent,[!1,!1,!1,!0],I.MIN);aa(Ue,p,n,c,d,lt,It,ur,gn.disabled,Ve,"sdf",se,fe,he,Se,Te,_t,H,We)}{const It=Ve?I.ZERO:I.ONE_MINUS_DST_ALPHA,ur=new cn({func:I.EQUAL,mask:255},255,255,I.KEEP,I.DECR,I.DECR),xt=new Mn([It,I.DST_ALPHA,I.ONE_MINUS_DST_ALPHA,I.ZERO],i.ao.transparent,[!0,!0,!0,!0]);aa(Ue,p,n,c,d,lt,ur,xt,gn.disabled,Ve,"color",se,fe,he,Se,Te,_t,H,We)}{const It=new Mn([I.ONE,I.ONE,I.ONE,Ve?I.ZERO:I.ONE],i.ao.transparent,[!1,!1,!1,!0],Ve?I.FUNC_ADD:I.MAX);aa(Ue,p,n,c,d,lt,cn.disabled,It,gn.disabled,Ve,"clear",se,fe,he,Se,Te,_t,H,We,yt)}};if(Oe||Le){let Ve;if(p.prepareDrawTile(),D){const We=D.drapeBufferSize[0],yt=D.drapeBufferSize[1];Ve=D.framebufferCopyTexture,Ve&&(!Ve||Ve.size[0]===We&&Ve.size[1]===yt)||(Ve&&Ve.destroy(),Ve=D.framebufferCopyTexture=new i.T(E,new i.q({width:We,height:yt}),I.RGBA8)),Ve.bind(I.LINEAR,I.CLAMP_TO_EDGE),I.copyTexSubImage2D(I.TEXTURE_2D,0,0,0,0,0,We,yt)}Oe&&$e(!0,!1,Ve),Le&&$e(!1,!0,Ve)}}else Oe&&Ze(!0),Le&&Ze(!1),(Oe||Le)&&p.resetStencilClippingMasks()}}},building:function(p,n,c,d){p.currentLayer<p.firstLightBeamLayer&&(p.firstLightBeamLayer=p.currentLayer);const x=c.paint.get("building-ambient-occlusion-ground-intensity"),E=c.paint.get("building-ambient-occlusion-ground-radius"),I=c.paint.get("building-ambient-occlusion-ground-attenuation"),D=c.paint.get("building-opacity");if(D<=0)return;let N=x>0&&E>0,H=!0;const W=c.paint.get("building-vertical-scale");(!p.shadowRenderer||W<1)&&(H=!1);const ee=p.conflationActive&&p.style.isLayerClipped(c,n.getSource()),Y=p.style.order.indexOf(c.fqid);if((function(se,fe,he,Se,me,Te){for(const Oe of Te){const Le=fe.getTile(Oe).getBucket(he);Le&&(me&&Le.updateReplacement(Oe,se.replacementSource,Se),Le.uploadUpdatedIndexBuffer(se.context))}})(p,n,c,Y,ee,d),(function(se,fe,he,Se){for(const me of Se){const Te=fe.getTile(me).getBucket(he);Te&&Te.needsEvaluation()&&Te.uploadUpdatedColorBuffer(se.context)}})(p,n,c,d),c.resetLayerRenderingStats(p),p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!0),p.renderPass==="shadow"&&p.shadowRenderer){const se=p.shadowRenderer,fe=[],he=se.getShadowPassDepthMode();Rd({painter:p,source:n,layer:c,coords:d,defines:fe,blendMode:se.getShadowPassColorMode(),depthMode:he,opacity:D,verticalScale:W,facadeEmissiveChance:0,facadeAOIntensity:0})}else if(p.renderPass==="translucent"){let se=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];H&&(se=se.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),p.shadowRenderer&&p.shadowRenderer.useNormalOffset&&(se=se.concat("NORMAL_OFFSET"));const fe=c.paint.get("building-facade-emissive-chance"),he=c.paint.get("building-ambient-occlusion-intensity"),Se=new Mr(p.context.gl.LEQUAL,Mr.ReadWrite,p.depthRangeFor3D);D<1&&Rd({painter:p,source:n,layer:c,coords:d,defines:se,blendMode:Mn.disabled,depthMode:Se,opacity:D,verticalScale:W,facadeEmissiveChance:fe,facadeAOIntensity:he});const me=p.colorModeForRenderPass();Rd({painter:p,source:n,layer:c,coords:d,defines:se,blendMode:me,depthMode:Se,opacity:D,verticalScale:W,facadeEmissiveChance:fe,facadeAOIntensity:he}),N&&(function(Te,Oe,Le,Ge,Ue,Ze,$e,Ve,We,yt,lt,Ot,_t){const It=Te.context.gl,ur=Te.depthModeForSublayer(1,Mr.ReadOnly,It.LEQUAL,!0),xt=.1*(1-(rt=lt))+3*rt;var rt;const zt=Te._showOverdrawInspector,gt=Ot,Bt=new hl;zt||aa(Bt,Te,Oe,Le,Ge,ur,new cn({func:It.ALWAYS,mask:255},255,255,It.KEEP,It.KEEP,It.REPLACE),new Mn([It.ONE,It.ONE,It.ONE,It.ONE],i.ao.transparent,[!1,!1,!1,!0],It.MIN),gn.disabled,Ue,"sdf",Ze,$e,Ve,0,yt,xt,gt,!1);{const Gt=zt?cn.disabled:new cn({func:It.EQUAL,mask:255},255,255,It.KEEP,It.DECR,It.DECR),ar=zt?Te.colorModeForRenderPass():new Mn([It.ONE_MINUS_DST_ALPHA,It.DST_ALPHA,It.ONE,It.ONE],i.ao.transparent,[!0,!0,!0,!0]);aa(Bt,Te,Oe,Le,Ge,ur,Gt,ar,gn.disabled,Ue,"color",Ze,$e,Ve,0,yt,xt,gt,!1)}})(p,n,c,d,!0,D,x,E,0,[0,0,0],I,ee)}else if(p.renderPass==="light-beam"){const se=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],fe=new Mr(p.context.gl.LEQUAL,Mr.ReadOnly,p.depthRangeFor3D);Rd({painter:p,source:n,layer:c,coords:d,defines:se,blendMode:Mn.alphaBlended,depthMode:fe,opacity:D,verticalScale:W,facadeEmissiveChance:0,facadeAOIntensity:0})}p.shadowRenderer&&(p.shadowRenderer.useNormalOffset=!1),p.resetStencilClippingMasks()},hillshade:function(p,n,c,d){if(p.renderPass!=="offscreen"&&p.renderPass!=="translucent"||p.style.disableElevatedTerrain)return;const x=p.context,E=p.terrain&&p.terrain.renderingToTexture,[I,D]=p.renderPass!=="translucent"||E?[{},d]:p.stencilConfigForOverlap(d);for(const N of D){const H=n.getTile(N);if(H.needsHillshadePrepare&&p.renderPass==="offscreen")Zh(p,H,c);else if(p.renderPass==="translucent"){const W=p.depthModeForSublayer(0,Mr.ReadOnly),ee=c.paint.get("hillshade-emissive-strength"),Y=p.colorModeForDrapableLayerRenderPass(ee),se=E&&p.terrain?p.terrain.stencilModeForRTTOverlap(N):I[N.overscaledZ];lA(p,N,H,c,W,se,Y)}}x.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,n,c,d,x,E){if(p.renderPass!=="translucent"||c.paint.get("raster-opacity")===0)return;const I=p.transform.projection.name==="globe",D=c.paint.get("raster-elevation")!==0,N=D&&I;if(p.renderElevatedRasterBackface&&!N)return;const H=p.context,W=H.gl,ee=n.getSource(),Y=(function(Ue,Ze,$e,Ve){const We=Ze.paint.get("raster-color"),yt=Ue.type==="raster-array",lt=[],Ot=Ze.paint.get("raster-resampling"),_t=Ze.paint.get("raster-color-mix");let It=Ze.paint.get("raster-color-range");const ur=[_t[0],_t[1],_t[2],0],xt=_t[3];let rt=Ot==="nearest"?Ve.NEAREST:Ve.LINEAR;if(yt&&(lt.push("RASTER_ARRAY"),We||lt.push("RASTER_COLOR"),Ot==="linear"&&lt.push("RASTER_ARRAY_LINEAR"),rt=Ve.NEAREST,!It&&Ue.rasterLayers)){const zt=Ue.rasterLayers.find((({id:gt})=>gt===Ze.sourceLayer));zt&&zt.fields&&zt.fields.range&&(It=zt.fields.range)}if(It=It||[0,1],We){lt.push("RASTER_COLOR"),$e.activeTexture.set(Ve.TEXTURE2),Ze.updateColorRamp(It);let zt=Ze.colorRampTexture;zt||(zt=Ze.colorRampTexture=new i.T($e,Ze.colorRamp,Ve.RGBA8)),zt.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE)}return{mix:ur,range:It,offset:xt,defines:lt,resampling:rt}})(ee,c,H,W);if(ee instanceof i.aS&&!d.length&&!I)return;const se=c.paint.get("raster-emissive-strength"),fe=p.colorModeForDrapableLayerRenderPass(se),he=p.terrain&&p.terrain.renderingToTexture,Se=!p.options.moving,me=c.paint.get("raster-resampling")==="nearest"?W.NEAREST:W.LINEAR;if(ee instanceof i.aS&&!d.length&&(ee.onNorthPole||ee.onSouthPole)){const Ue=D?p.stencilModeFor3D():cn.disabled;return void pp(!!ee.onNorthPole,null,p,n,c,se,Y,gn.disabled,Ue)}if(!d.length)return;const[Te,Oe]=ee instanceof i.aS||he?[{},d]:p.stencilConfigForOverlap(d),Le=Oe[Oe.length-1].overscaledZ;N&&Y.defines.push("PROJECTION_GLOBE_VIEW"),D&&Y.defines.push("RENDER_CUTOFF");const Ge=(Ue,Ze,$e)=>{for(const Ve of Ue){const We=Ve.toUnwrapped(),yt=n.getTile(Ve);if(he&&(!yt||!yt.hasData()))continue;H.activeTexture.set(W.TEXTURE0);const lt=p0(yt,ee,c,Y);if(!lt||!lt.texture)continue;const{texture:Ot,mix:_t,offset:It,tileSize:ur,buffer:xt}=lt;let rt,zt;he?(rt=Mr.disabled,zt=Ve.projMatrix):D?(rt=new Mr(W.LEQUAL,Mr.ReadWrite,p.depthRangeFor3D),zt=I?Float32Array.from(p.transform.expandedFarZProjMatrix):p.transform.calculateProjMatrix(We,Se)):(rt=p.depthModeForSublayer(Ve.overscaledZ-Le,c.paint.get("raster-opacity")===1?Mr.ReadWrite:Mr.ReadOnly,W.LESS),zt=p.transform.calculateProjMatrix(We,Se));const gt=p.terrain&&he?p.terrain.stencilModeForRTTOverlap(Ve):Te[Ve.overscaledZ],Bt=E?0:c.paint.get("raster-fade-duration");yt.registerFadeDuration(Bt);const Gt=n.findLoadedParent(Ve,0),ar=Pa(yt,Gt,n,p.transform,Bt);let Ht,Xt;!ar.isFading&&yt.refreshedUponExpiration&&(yt.refreshedUponExpiration=!1),p.terrain&&p.terrain.prepareDrawTile(),H.activeTexture.set(W.TEXTURE0),Ot.bind(me,W.CLAMP_TO_EDGE),H.activeTexture.set(W.TEXTURE1),Gt?(Gt.texture&&Gt.texture.bind(me,W.CLAMP_TO_EDGE),Ht=Math.pow(2,Gt.tileID.overscaledZ-yt.tileID.overscaledZ),Xt=[yt.tileID.canonical.x*Ht%1,yt.tileID.canonical.y*Ht%1]):Ot.bind(me,W.CLAMP_TO_EDGE),"useMipmap"in Ot&&H.extTextureFilterAnisotropic&&p.transform.pitch>20&&W.texParameterf(W.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax);const qr=p.transform;let $r;const Yr=D?Mg(qr):[0,0,0,0];let Lr,rn,En,In,ki,_n=0;if(N&&ee instanceof i.aS&&ee.coordinates.length>3)Lr=Float32Array.from(i.bk(i.dF(new i.cC(0,0,0)))),rn=Float32Array.from(qr.globeMatrix),En=Float32Array.from(i.dB(qr)),In=[i.aF(qr.center.lng),i.aJ(qr.center.lat)],$r=ee.elevatedGlobePerspectiveTransform,ki=ee.elevatedGlobeGridMatrix||new Float32Array(9);else if(N){const On=i.dC(Ve.canonical);_n=i.dD(On.getCenter().lat),Lr=Float32Array.from(i.bk(i.dF(Ve.canonical))),rn=Float32Array.from(qr.globeMatrix),En=Float32Array.from(i.dB(qr)),In=[i.aF(qr.center.lng),i.aJ(qr.center.lat)],$r=[0,0],ki=Float32Array.from(i.dE(Ve.canonical,On,_n,qr.worldSize/qr._pixelsPerMercatorPixel))}else $r=ee instanceof i.aS?ee.perspectiveTransform:[0,0],Lr=new Float32Array(16),rn=new Float32Array(9),En=new Float32Array(16),In=[0,0],ki=new Float32Array(9);const si=pe(zt,Lr,rn,En,ki,Xt||[0,0],i.aj(p.transform.zoom),In,Yr,Ht||1,ar,c,$r,D?c.paint.get("raster-elevation"):0,2,_t,It,Y.range,ur,xt,se),xi=p.isTileAffectedByFog(Ve),Ci=p.getOrCreateProgram("raster",{defines:Y.defines,overrideFog:xi});if(p.uploadCommonUniforms(H,Ci,We),ee instanceof i.aS){const On=ee.elevatedGlobeVertexBuffer,bi=ee.elevatedGlobeIndexBuffer;if(he||!I)ee.boundsBuffer&&ee.boundsSegments&&Ci.draw(p,W.TRIANGLES,rt,cn.disabled,fe,gn.disabled,si,c.id,ee.boundsBuffer,p.quadTriangleIndexBuffer,ee.boundsSegments);else if(On&&bi){const Ai=qr.zoom<=i.cZ?ee.elevatedGlobeSegments:ee.getSegmentsForLongitude(qr.center.lng);Ai&&Ci.draw(p,W.TRIANGLES,rt,cn.disabled,fe,Ze,si,c.id,On,bi,Ai)}}else if(N){rt=new Mr(W.LEQUAL,Mr.ReadOnly,p.depthRangeFor3D);const On=p.globeSharedBuffers;if(On){const[bi,Ai,wi]=On.getGridBuffers(_n,!1);Ci.draw(p,W.TRIANGLES,rt,$e||gt,p.colorModeForRenderPass(),Ze,si,c.id,bi,Ai,wi)}}else{const{tileBoundsBuffer:On,tileBoundsIndexBuffer:bi,tileBoundsSegments:Ai}=p.getTileBoundsBuffers(yt);Ci.draw(p,W.TRIANGLES,rt,gt,fe,gn.disabled,si,c.id,On,bi,Ai)}}if(!(ee instanceof i.aS)&&N)for(const Ve of Ue){const We=Ve.canonical.y===(1<<Ve.canonical.z)-1;Ve.canonical.y===0&&pp(!0,Ve,p,n,c,se,Y,Ze,$e||cn.disabled),We&&pp(!1,Ve,p,n,c,se,Y,Ze===gn.frontCW?gn.backCW:gn.frontCW,$e||cn.disabled)}};N?Ge(Oe,p.renderElevatedRasterBackface?gn.backCW:gn.frontCW,p.stencilModeFor3D()):Ge(Oe,gn.disabled,void 0),p.resetStencilClippingMasks()},"raster-particle":function(p,n,c,d,x,E){p.renderPass==="offscreen"&&(function(I,D,N,H){if(!H.length)return;const W=I.context,ee=W.gl,Y=D.getSource();if(!(Y instanceof Yu))return;const se=Math.ceil(Math.sqrt(N.paint.get("raster-particle-count")));let fe=N.particlePositionRGBAImage;if(!fe||fe.width!==se){const Oe=(function(Le){const Ge=Le*Le,Ue=new Uint8Array(4*Ge),Ze=function(Ve){return Ve|=0,Ve=Math.imul(2747636419^Ve,2654435769),Ve=Math.imul(Ve^Ve>>>16,2654435769),((Ve=Math.imul(Ve^Ve>>>16,2654435769))>>>0)/4294967296},$e=1/1.1;for(let Ve=0;Ve<Ge;Ve++){const We=$e*(Ze(2*Ve+0)+qe),yt=$e*(Ze(2*Ve+1)+qe),lt=255*We%1,Ot=255*yt%1,_t=lt,It=yt-Ot/255,ur=Ot;Ue[4*Ve+0]=255*(We-lt/255),Ue[4*Ve+1]=255*_t,Ue[4*Ve+2]=255*It,Ue[4*Ve+3]=255*ur}return Ue})(se);fe=N.particlePositionRGBAImage=new i.q({width:se,height:se},Oe)}let he=N.particleFramebuffer;he?he.width!==se&&(he.destroy(),he=N.particleFramebuffer=W.createFramebuffer(se,se,!0,null)):he=N.particleFramebuffer=W.createFramebuffer(se,se,!0,null);const Se=[];for(const Oe of H){const Le=D.getTile(Oe);if(!(Le instanceof Fo))continue;const Ge=Il(Le,Y,N);if(!Ge)continue;const Ue=[Le.tileSize,Le.tileSize];let Ze=N.tileFramebuffer;Ze||(Ze=N.tileFramebuffer=W.createFramebuffer(Ue[0],Ue[1],!0,null));let $e=Le.rasterParticleState;$e||($e=Le.rasterParticleState=new Pg(W,Oe,Ue,fe));const Ve=$e.update(N.lastInvalidatedAt);$e.particleTextureDimension!==se&&$e.updateParticleTexture(Oe,fe);const We=$e.targetColorTexture;$e.targetColorTexture=$e.backgroundColorTexture,$e.backgroundColorTexture=We;const yt=$e.particleTexture0;$e.particleTexture0=$e.particleTexture1,$e.particleTexture1=yt,Se.push([Oe,Ge,$e,Ve])}if(Se.length===0)return;const me=i.o.now(),Te=N.previousDrawTimestamp?.001*(me-N.previousDrawTimestamp):.0167;if(N.previousDrawTimestamp=me,N.hasColorMap()){W.activeTexture.set(ee.TEXTURE0+2);let Oe=N.colorRampTexture;Oe||(Oe=N.colorRampTexture=new i.T(W,N.colorRamp,ee.RGBA8)),Oe.bind(ee.LINEAR,ee.CLAMP_TO_EDGE)}W.bindFramebuffer.set(N.tileFramebuffer.framebuffer),(function(Oe,Le,Ge){const Ue=Oe.context,Ze=Ue.gl,$e=Le.tileFramebuffer;Ue.activeTexture.set(Ze.TEXTURE0);const Ve={u_texture:0,u_opacity:1.05*(yt=Le.paint.get("raster-particle-fade-opacity-factor"))/(yt+.05)},We=Oe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var yt;for(const lt of Ge){const[,,Ot,_t]=lt;$e.colorAttachment.set(Ot.targetColorTexture.texture),Ue.viewport.set([0,0,$e.width,$e.height]),Ue.clear({color:i.ao.transparent}),_t&&(Ot.backgroundColorTexture.bind(Ze.NEAREST,Ze.CLAMP_TO_EDGE),We.draw(Oe,Ze.TRIANGLES,Mr.disabled,cn.disabled,Mn.alphaBlended,gn.disabled,Ve,Le.id,Oe.viewportBuffer,Oe.quadTriangleIndexBuffer,Oe.viewportSegments))}})(I,N,Se),(function(Oe,Le,Ge,Ue){const Ze=Oe.context,$e=Ze.gl,Ve=Ge.tileFramebuffer,We=Oe.transform.projection.name==="globe",yt=Ge.paint.get("raster-particle-max-speed");for(const lt of Ue){const[Ot,_t,It]=lt;Ze.activeTexture.set($e.TEXTURE0+0),_t.texture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),Ve.colorAttachment.set(It.targetColorTexture.texture);const ur=Oe.getOrCreateProgram("rasterParticleDraw",{defines:_t.defines,overrideFog:!1});Ze.activeTexture.set($e.TEXTURE0+1);const xt=_t.scalarData?[]:[0,1,2,3].map((gt=>i.e6[gt](Ot)));xt.push(Ot);const rt=Ot.canonical.x,zt=Ot.canonical.y;for(const gt of xt){const Bt=Le.getTile(We?gt.wrapped():gt);if(!Bt)continue;const Gt=Bt.rasterParticleState;if(!Gt)continue;const ar=gt.canonical.x+(1<<gt.canonical.z)*(gt.wrap-Ot.wrap),Ht=gt.canonical.y;Gt.particleTexture0.bind($e.NEAREST,$e.CLAMP_TO_EDGE);const Xt=ot(1,Gt.particleTexture0.size[0],[ar-rt,Ht-zt],0,_t.texture.size,2,yt,_t.textureOffset,_t.scale,_t.offset);ur.draw(Oe,$e.POINTS,Mr.disabled,cn.disabled,Mn.alphaBlended,gn.disabled,Xt,Ge.id,Gt.particleIndexBuffer,void 0,Gt.particleSegment)}}})(I,D,N,Se),W.bindFramebuffer.set(N.particleFramebuffer.framebuffer),(function(Oe,Le,Ge,Ue){const Ze=Oe.context,$e=Ze.gl,Ve=Le.paint.get("raster-particle-max-speed"),We=Ue*Le.paint.get("raster-particle-speed-factor")*.15,yt=(function(Ot){return Math.pow(Ot,6)})(.01+1*Le.paint.get("raster-particle-reset-rate-factor")),lt=Le.particleFramebuffer;Ze.viewport.set([0,0,lt.width,lt.height]);for(const Ot of Ge){const[,_t,It]=Ot;Ze.activeTexture.set($e.TEXTURE0+0),_t.texture.bind($e.LINEAR,$e.CLAMP_TO_EDGE),Ze.activeTexture.set($e.TEXTURE0+1);const ur=It.particleTexture0;ur.bind($e.NEAREST,$e.CLAMP_TO_EDGE);const xt=at(1,ur.size[0],0,_t.texture.size,Ve,We,yt,_t.textureOffset,_t.scale,_t.offset);lt.colorAttachment.set(It.particleTexture1.texture),Ze.clear({color:i.ao.transparent}),Oe.getOrCreateProgram("rasterParticleUpdate",{defines:_t.defines}).draw(Oe,$e.TRIANGLES,Mr.disabled,cn.disabled,Mn.unblended,gn.disabled,xt,Le.id,Oe.viewportBuffer,Oe.quadTriangleIndexBuffer,Oe.viewportSegments)}})(I,N,Se,Te)})(p,n,c,d),p.renderPass==="translucent"&&((function(I,D,N,H,W){const ee=I.context,Y=ee.gl,se=D.getSource().tileSize,fe=5*(1-i.ah(i.cK,i.cK+1,I.transform.zoom))*se+N.paint.get("raster-particle-elevation"),he=!I.options.moving,Se=I.transform.projection.name==="globe";if(!H.length)return;const[me,Te]=I.stencilConfigForOverlap(H),Oe=[];Se&&Oe.push("PROJECTION_GLOBE_VIEW");const Le=I.stencilModeFor3D();for(const Ge of Te){const Ue=Ge.toUnwrapped(),Ze=D.getTile(Ge);if(!Ze.rasterParticleState)continue;const $e=Ze.rasterParticleState,Ve=100;Ze.registerFadeDuration(Ve);const We=D.findLoadedParent(Ge,0),yt=Pa(Ze,We,D,I.transform,Ve);let lt,Ot;I.terrain&&I.terrain.prepareDrawTile(),ee.activeTexture.set(Y.TEXTURE0),$e.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),ee.activeTexture.set(Y.TEXTURE1),We&&We.rasterParticleState?(We.rasterParticleState.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),lt=Math.pow(2,We.tileID.overscaledZ-Ze.tileID.overscaledZ),Ot=[Ze.tileID.canonical.x*lt%1,Ze.tileID.canonical.y*lt%1]):$e.targetColorTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE);const _t=Se?Float32Array.from(I.transform.expandedFarZProjMatrix):I.transform.calculateProjMatrix(Ue,he),It=I.transform,ur=cA(It),xt=i.dC(Ge.canonical),rt=i.dD(xt.getCenter().lat);let zt,gt,Bt,Gt,ar;Se?(zt=Float32Array.from(i.bk(i.dF(Ge.canonical))),gt=Float32Array.from(It.globeMatrix),Bt=Float32Array.from(i.dB(It)),Gt=[i.aF(It.center.lng),i.aJ(It.center.lat)],ar=Float32Array.from(i.dE(Ge.canonical,xt,rt,It.worldSize/It._pixelsPerMercatorPixel))):(zt=new Float32Array(16),gt=new Float32Array(9),Bt=new Float32Array(16),Gt=[0,0],ar=new Float32Array(9));const Ht=nt(_t,zt,gt,Bt,ar,Ot||[0,0],i.aj(I.transform.zoom),Gt,ur,lt||1,yt,fe),Xt=I.isTileAffectedByFog(Ge),qr=I.getOrCreateProgram("rasterParticle",{defines:Oe,overrideFog:Xt});if(I.uploadCommonUniforms(ee,qr,Ue),Se){const $r=new Mr(Y.LEQUAL,Mr.ReadOnly,I.depthRangeFor3D),Yr=0,Lr=I.globeSharedBuffers;if(Lr){const[rn,En,In]=Lr.getGridBuffers(rt,Yr!==0);qr.draw(I,Y.TRIANGLES,$r,Le,Mn.alphaBlended,I.renderElevatedRasterBackface?gn.frontCCW:gn.backCCW,Ht,N.id,rn,En,In)}}else{const $r=I.depthModeForSublayer(0,Mr.ReadOnly),Yr=me[Ge.overscaledZ],{tileBoundsBuffer:Lr,tileBoundsIndexBuffer:rn,tileBoundsSegments:En}=I.getTileBoundsBuffers(Ze);qr.draw(I,Y.TRIANGLES,$r,Yr,Mn.alphaBlended,gn.disabled,Ht,N.id,Lr,rn,En)}}I.resetStencilClippingMasks()})(p,n,c,d),p.style.map.triggerRepaint())},background:function(p,n,c,d){const x=c.paint.get("background-color"),E=c.paint.get("background-color-use-theme").constantOr("default")==="none",I=c.paint.get("background-opacity"),D=c.paint.get("background-emissive-strength"),N=c.paint.get("background-pitch-alignment")==="viewport";if(I===0)return;const H=p.context,W=H.gl,ee=p.transform,Y=ee.tileSize,se=c.paint.get("background-pattern");let fe;if(se!==void 0&&(se===null||(fe=p.imageManager.getPattern(i.I.from(se.toString()),c.scope,p.style.getLut(c.scope)),!fe)))return;const he=!se&&x.a===1&&I===1&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==he)return;const Se=cn.disabled,me=p.depthModeForSublayer(0,he==="opaque"?Mr.ReadWrite:Mr.ReadOnly),Te=p.colorModeForDrapableLayerRenderPass(D),Oe=se?"backgroundPattern":"background";let Le,Ge=d;if(Ge||(Le=p.getBackgroundTiles(),Ge=Object.values(Le).map((Ue=>Ue.tileID))),se&&(H.activeTexture.set(W.TEXTURE0),p.imageManager.bind(p.context,c.scope)),N){const Ue=p.getOrCreateProgram(Oe,{overrideFog:!1,overrideRtt:!0}),Ze=new Float32Array(i.bA([])),$e=new i.aO(0,0,0,0,0),Ve=se?Qt(Ze,D,I,p,0,c.scope,fe,N,{tileID:$e,tileSize:Y}):fr(Ze,D,I,x.toPremultipliedRenderColor(E?null:c.lut));Ue.draw(p,W.TRIANGLES,me,Se,Te,gn.disabled,Ve,c.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments)}else for(const Ue of Ge){const Ze=p.isTileAffectedByFog(Ue),$e=p.getOrCreateProgram(Oe,{overrideFog:Ze}),Ve=Ue.toUnwrapped(),We=d?Ue.projMatrix:p.transform.calculateProjMatrix(Ve);p.prepareDrawTile();const yt=n?n.getTile(Ue):Le?Le[Ue.key]:new Ju(Ue,Y,ee.zoom,p),lt=se?Qt(We,D,I,p,0,c.scope,fe,N,{tileID:Ue,tileSize:Y}):fr(We,D,I,x.toPremultipliedRenderColor(E?null:c.lut));p.uploadCommonUniforms(H,$e,Ve);const{tileBoundsBuffer:Ot,tileBoundsIndexBuffer:_t,tileBoundsSegments:It}=p.getTileBoundsBuffers(yt);$e.draw(p,W.TRIANGLES,me,Se,Te,gn.disabled,lt,c.id,Ot,_t,It)}},sky:function(p,n,c){const d=p._atmosphere?i.aj(p.transform.zoom):1,x=c.paint.get("sky-opacity")*d;if(x===0)return;const E=p.context,I=c.paint.get("sky-type"),D=new Mr(E.gl.LEQUAL,Mr.ReadOnly,[0,1]),N=p.frameCounter/1e3%1;I==="atmosphere"?p.renderPass==="offscreen"?c.needsSkyboxCapture(p)&&((function(H,W,ee,Y){const se=H.context,fe=se.gl;let he=W.skyboxFbo;if(!he){he=W.skyboxFbo=se.createFramebuffer(32,32,!0,null),W.skyboxGeometry=new dA(se),W.skyboxTexture=se.gl.createTexture(),fe.bindTexture(fe.TEXTURE_CUBE_MAP,W.skyboxTexture),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_CUBE_MAP,fe.TEXTURE_MAG_FILTER,fe.LINEAR);for(let Oe=0;Oe<6;++Oe)fe.texImage2D(fe.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0,fe.RGBA,32,32,0,fe.RGBA,fe.UNSIGNED_BYTE,null)}se.bindFramebuffer.set(he.framebuffer),se.viewport.set([0,0,32,32]);const Se=W.getCenter(H,!0),me=H.getOrCreateProgram("skyboxCapture"),Te=new Float64Array(16);i.bA(Te),i.ek(Te,Te,.5*-Math.PI),Nc(H,W,me,Te,Se,0),i.bA(Te),i.ek(Te,Te,.5*Math.PI),Nc(H,W,me,Te,Se,1),i.bA(Te),i.cT(Te,Te,.5*-Math.PI),Nc(H,W,me,Te,Se,2),i.bA(Te),i.cT(Te,Te,.5*Math.PI),Nc(H,W,me,Te,Se,3),i.bA(Te),Nc(H,W,me,Te,Se,4),i.bA(Te),i.ek(Te,Te,Math.PI),Nc(H,W,me,Te,Se,5),se.viewport.set([0,0,H.width,H.height])})(p,c),c.markSkyboxValid(p)):p.renderPass==="sky"&&(function(H,W,ee,Y,se){const fe=H.context,he=fe.gl,Se=H.transform,me=H.getOrCreateProgram("skybox");fe.activeTexture.set(he.TEXTURE0),he.bindTexture(he.TEXTURE_CUBE_MAP,W.skyboxTexture);const Te=((Oe,Le,Ge,Ue,Ze)=>({u_matrix:Oe,u_sun_direction:Le,u_cubemap:0,u_opacity:Ue,u_temporal_offset:Ze}))(Se.skyboxMatrix,W.getCenter(H,!1),0,Y,se);H.uploadCommonUniforms(fe,me),me.draw(H,he.TRIANGLES,ee,cn.disabled,H.colorModeForRenderPass(),gn.backCW,Te,"skybox",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)})(p,c,D,x,N):I==="gradient"&&p.renderPass==="sky"&&(function(H,W,ee,Y,se){const fe=H.context,he=fe.gl,Se=H.transform,me=H.getOrCreateProgram("skyboxGradient");W.skyboxGeometry||(W.skyboxGeometry=new dA(fe)),fe.activeTexture.set(he.TEXTURE0);let Te=W.colorRampTexture;Te||(Te=W.colorRampTexture=new i.T(fe,W.colorRamp,he.RGBA8)),Te.bind(he.LINEAR,he.CLAMP_TO_EDGE);const Oe=((Le,Ge,Ue,Ze,$e)=>({u_matrix:Le,u_color_ramp:0,u_center_direction:Ge,u_radius:i.an(Ue),u_opacity:Ze,u_temporal_offset:$e}))(Se.skyboxMatrix,W.getCenter(H,!1),W.paint.get("sky-gradient-radius"),Y,se);H.uploadCommonUniforms(fe,me),me.draw(H,he.TRIANGLES,ee,cn.disabled,H.colorModeForRenderPass(),gn.backCW,Oe,"skyboxGradient",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)})(p,c,D,x,N)},custom:function(p,n,c,d){const x=p.context,E=c.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||p.renderPass==="offscreen")&&c.isDraped(n)){if(p.renderPass==="offscreen"){const I=E.prerender;if(I){if(p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),p.transform.projection.name==="globe"){const D=p.transform.pointMerc;I.call(E,x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.aj(p.transform.zoom),[D.x,D.y],p.transform.pixelsPerMeterRatio)}else I.call(E,x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState()}}else if(p.renderPass==="translucent"){if(p.terrain&&p.terrain.renderingToTexture){const D=E.renderToTile;if(D){const N=d[0].canonical,H={x:N.x+d[0].wrap*(E.wrapTileId?0:1<<N.z),y:N.y,z:N.z};x.setDepthMode(Mr.disabled),x.setStencilMode(cn.disabled),x.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),D.call(E,x.gl,H),x.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),x.setStencilMode(cn.disabled);const I=E.renderingMode==="3d"?new Mr(p.context.gl.LEQUAL,Mr.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,Mr.ReadOnly);if(x.setDepthMode(I),p.transform.projection.name==="globe"){const D=p.transform.pointMerc;E.render(x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),i.aj(p.transform.zoom),[D.x,D.y],p.transform.pixelsPerMeterRatio)}else E.render(x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState(),x.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(p,n,c,d){if(p.renderPass==="opaque")return;const x=c.paint.get("model-opacity").constantOr(1);if(x===0)return;const E=c.paint.get("model-cast-shadows");if(p.renderPass==="shadow"&&(!E||p.terrain&&x<.65&&c._transitionablePaint._values["model-opacity"].value.expression instanceof i.ad))return;const I=p.shadowRenderer,D=c.paint.get("model-receive-shadows");I&&(I.useNormalOffset=!0,D||(I.enabled=!1));const N=()=>{I&&(I.useNormalOffset=!0,D||(I.enabled=!0))},H=n.getSource();if(p.renderPass==="light-beam"&&H.type!=="batched-model")return;if(H.type==="vector"||H.type==="geojson")return(function(me,Te,Oe,Le,Ge){const Ue=me.transform;if(Ue.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Ue.projection.name} projection is not yet implemented`);const Ze=Ue.getFreeCameraOptions().position;if(!me.modelManager)return;const $e=me.modelManager;Oe.modelManager=$e;const Ve=me.shadowRenderer;if(!Oe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const We=Oe._unevaluatedLayout._values["model-id"],yt=Object.assign({},Oe.layout.get("model-id").parameters),lt=me.style.order.indexOf(Oe.fqid);for(const Ot of Le){const _t=Te.getTile(Ot).getBucket(Oe);if(!_t||_t.projection.name!==Ue.projection.name)continue;const It=_t.getModelUris();It&&!_t.modelsRequested&&($e.addModelsFromBucket(It,Ge),_t.modelsRequested=!0);const ur=qf(Ot,Ue);yt.zoom=ur;const xt=We.possiblyEvaluate(yt);if(A0(me,_t,Ot),jc.shadowUniformsInitialized=!1,jc.useSingleShadowCascade=!!Ve&&Ve.getMaxCascadeForTile(Ot.toUnwrapped())===0,me.renderPass==="shadow"&&Ve){if(me.currentShadowCascade===1&&_t.isInsideFirstShadowMapFrustum)continue;const gt=Ue.calculatePosMatrix(Ot.toUnwrapped(),Ue.worldSize);if(jc.tileMatrix.set(gt),jc.shadowTileMatrix=Float32Array.from(Ve.calculateShadowPassMatrixFromMatrix(gt)),jc.aabb.min=[0,0,0],jc.aabb.max[0]=jc.aabb.max[1]=i.al,jc.aabb.max[2]=0,Og(_t,jc,me,Oe.scope))continue}const rt=1<<Ot.canonical.z,zt=[((Ze.x-Ot.wrap)*rt-Ot.canonical.x)*i.al,(Ze.y*rt-Ot.canonical.y)*i.al,Ze.z*rt*i.al];me.conflationActive&&Object.keys(_t.instancesPerModel).length>0&&me.style.isLayerClipped(Oe,Te.getSource())&&_t.updateReplacement(Ot,me.replacementSource,lt,Ge)&&(_t.uploaded=!1,_t.upload(me.context));for(let gt in _t.instancesPerModel){const Bt=_t.instancesPerModel[gt];Bt.features.length>0&&(gt=xt.evaluate(Bt.features[0].feature,{}));const Gt=$e.getModel(gt,Ge);if(Gt||$e.hasURLBeenRequested(gt)||_t.modelUris.includes(gt)||(_t.modelUris.push(gt),_t.modelsRequested=!1),Gt&&Gt.uploaded)for(const ar of Gt.nodes)g0(me,Oe,ar,Bt,zt,Ot,jc)}}})(p,n,c,d,H.type==="vector"?c.scope:""),void N();if(!H.loaded())return;if(H.type==="batched-model")return(function(me,Te,Oe,Le){Oe.resetLayerRenderingStats(me);const Ge=me.context,Ue=me.transform,Ze=me.style.fog,$e=me.shadowRenderer;if(Ue.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Ue.projection.name} projection is not yet implemented`);const Ve=me.transform.getFreeCameraOptions().position,We=i.c4([],[Ve.x,Ve.y,Ve.z],me.transform.worldSize),yt=i.et([],We),lt=i.bA([]),Ot=i.ec(Ue.center.lat,Ue.zoom),_t=i.bq([],[1,1,1/Ot]);i.br(lt,lt,yt);const It=Oe.paint.get("model-opacity").constantOr(1),ur=new Mr(Ge.gl.LEQUAL,Mr.ReadWrite,me.depthRangeFor3D),xt=new Mr(Ge.gl.LEQUAL,Mr.ReadOnly,me.depthRangeFor3D),rt=new i.d8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),zt=me.renderPass==="shadow",gt=zt&&$e?$e.getCurrentCascadeFrustum():Ue.getFrustum(Ue.scaleZoom(Ue.worldSize)),Bt=Oe.paint.get("model-front-cutoff"),Gt=Bt[2]<1,ar=Ec(me,Oe.paint.get("model-cutoff-fade-range")),Ht=Oe.getLayerRenderingStats();(function(Xt,qr,$r,Yr){const Lr=Xt.terrain?Xt.terrain.exaggeration():0,rn=Xt.transform.zoom;for(const En of Yr){const In=qr.getTile(En).getBucket($r);In&&(In.setFilter($r.filter),Xt.conflationActive&&In.updateReplacement(En,Xt.replacementSource),In.evaluateTransform(Xt,$r),Xt.terrain&&Lr>0&&In.elevationUpdate(Xt.terrain,Lr,En,$r.source),In.needsReEvaluation(Xt,rn,$r)&&In.evaluate($r))}})(me,Te,Oe,Le),(function(){let Xt,qr,$r;Gt?(Xt=Le.length-1,qr=-1,$r=-1):(Xt=0,qr=Le.length,$r=1);const Yr=new Float64Array(16),Lr=i.cz(),rn=new i.P(0,0);for(let En=Xt;En!==qr;En+=$r){const In=Le[En],ki=Te.getTile(In).getBucket(Oe);if(!ki||!ki.uploaded)continue;let _n=!1;$e&&(_n=$e.getMaxCascadeForTile(In.toUnwrapped())===0);const si=Ue.calculatePosMatrix(In.toUnwrapped(),Ue.worldSize),xi=ki.modelTraits;!zt&&Gt&&(i.bl(Yr,si),i.af(Lr,We,Yr),rn.x=Lr[0],rn.y=Lr[1]);const Ci=[];ki.setFilter(Oe.filter);for(const On of ki.getNodesInfo()){if(On.hiddenByReplacement||!On.node.meshes)continue;const bi=On.node;let Ai=0;me.terrain&&bi.elevation&&(Ai=bi.elevation*me.terrain.exaggeration());const wi=(()=>{const qo=On.aabb;return rt.min=[...qo.min],rt.max=[...qo.max],rt.min[2]+=Ai,rt.max[2]+=Ai,i.af(rt.min,rt.min,si),i.af(rt.max,rt.max,si),rt})(),Ji=On.evaluatedScale;if(Ji[0]<=1&&Ji[1]<=1&&Ji[2]<=1&&wi.intersects(gt)===0)continue;if(!zt&&Gt){const qo=.16666666666666666;On.cameraCollisionOpacity=We[0]>wi.min[0]&&We[0]<wi.max[0]&&We[1]>wi.min[1]&&We[1]<wi.max[1]&&We[2]*Ot<wi.max[2]&&bi.footprint&&i.b$(rn,bi.footprint)?Math.max(On.cameraCollisionOpacity-qo,0):Math.min(1,On.cameraCollisionOpacity+qo)}const Vi=[...si],ta=1/i.d6(In.canonical),so=bi.anchor?bi.anchor[0]:0,Pn=bi.anchor?bi.anchor[1]:0;i.br(Vi,Vi,[so*(Ji[0]-1)+On.evaluatedTranslation[0]*ta,Pn*(Ji[1]-1)+On.evaluatedTranslation[1]*ta,Ai+On.evaluatedTranslation[2]]),i.cp(Ji,i.ev)||i.cR(Vi,Vi,Ji);const An=i.aB([],Vi,bi.matrix),zi=i.aB([],Ue.expandedFarZProjMatrix,An),Ho=i.aB([],Ue.expandedFarZProjMatrix,Vi),ho=i.aC([],[so,Pn,Ai,1],zi)[2];bi.hidden=!1;let sa=It;zt||(Gt&&(sa*=On.cameraCollisionOpacity,sa*=pA(Vi,Ue,On.aabb,Bt)),sa*=mp(ar,ho)),sa!==0?Ci.push({nodeInfo:On,depth:ho,opacity:sa,wvpForNode:zi,wvpForTile:Ho,nodeModelMatrix:An,tileModelMatrix:Vi}):bi.hidden=!0}zt||Ci.sort(((On,bi)=>!Gt||On.opacity===1&&bi.opacity===1?On.depth<bi.depth?-1:1:On.opacity===1?-1:bi.opacity===1?1:On.depth>bi.depth?-1:1));for(const On of Ci){const bi=On.nodeInfo,Ai=bi.node;let wi=i.aB([],_t,On.tileModelMatrix);i.aB(wi,lt,wi);const Ji=i.bl([],wi);i.ed(Ji,Ji),i.cR(Ji,Ji,Dg),wi=i.aB(wi,wi,Ai.matrix);const Vi=me.renderPass==="light-beam",ta=Oe.paint.get("model-color-use-theme").constantOr("default")==="none",so=xi&i.ez.HasMapboxMeshFeatures,Pn=so?0:bi.evaluatedRMEA[0][2];for(let An=0;An<Ai.meshes.length;++An){const zi=Ai.meshes[An],Ho=An===Ai.lightMeshIndex;let ho=On.wvpForNode;if(Ho){if(!Vi&&!me.terrain&&me.shadowRenderer){me.currentLayer<me.firstLightBeamLayer&&(me.firstLightBeamLayer=me.currentLayer);continue}ho=On.wvpForTile}else if(Vi)continue;const sa={defines:[]},qo=[];if(!zt&&$e&&($e.useNormalOffset=!!zi.normalBuffer),sm(sa.defines,qo,zi,me,ta?null:Oe.lut),so||sa.defines.push("DIFFUSE_SHADED"),_n&&sa.defines.push("SHADOWS_SINGLE_CASCADE"),Ht&&(zt?Ht.numRenderedVerticesInShadowPass+=zi.vertexArray.length:Ht.numRenderedVerticesInTransparentPass+=zi.vertexArray.length),zt){Od(zi,On.nodeModelMatrix,me,Oe);continue}let Xl=null;if(Ze){const Yl=pt(On.nodeModelMatrix,me.transform);if(Xl=new Float32Array(Yl),Ue.projection.name!=="globe"){const Wo=zi.aabb.min,jo=zi.aabb.max,[Do,ba]=Ze.getOpacityForBounds(Yl,Wo[0],Wo[1],jo[0],jo[1]);sa.overrideFog=Do>=Fr||ba>=Fr}}const xa=zi.material;let Dl;xa.occlusionTexture&&xa.occlusionTexture.offsetScale&&(Dl=xa.occlusionTexture.offsetScale,sa.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Ol=me.getOrCreateProgram("model",sa);!zt&&$e&&$e.setupShadowsFromMatrix(On.tileModelMatrix,Ol,$e.useNormalOffset),me.uploadCommonUniforms(Ge,Ol,null,Xl);const dl=xa.pbrMetallicRoughness;dl.metallicFactor=.9,dl.roughnessFactor=.5;const Es=Dt(new Float32Array(ho),new Float32Array(wi),new Float32Array(Ji),new Float32Array(Ai.matrix),me,On.opacity,dl.baseColorFactor,xa.emissiveFactor,dl.metallicFactor,dl.roughnessFactor,xa,Pn,Oe,[0,0,0],Dl);!Ho&&(bi.hasTranslucentParts||On.opacity<1)&&Ol.draw(me,Ge.gl.TRIANGLES,ur,cn.disabled,Mn.disabled,gn.backCCW,Es,Oe.id,zi.vertexBuffer,zi.indexBuffer,zi.segments,Oe.paint,me.transform.zoom,void 0,qo),Ol.draw(me,Ge.gl.TRIANGLES,Ho?xt:ur,cn.disabled,Ho||On.opacity<1||bi.hasTranslucentParts?Mn.alphaBlended:Mn.unblended,gn.backCCW,Es,Oe.id,zi.vertexBuffer,zi.indexBuffer,zi.segments,Oe.paint,me.transform.zoom,void 0,qo)}}}})()})(p,n,c,d),void N();if(H.type!=="model")return;const W=H.getModels(),ee=[],Y=p.transform.getFreeCameraOptions().position,se=i.c4([],[Y.x,Y.y,Y.z],p.transform.worldSize);i.et(se,se);const fe=[],he=[];let Se=0;for(const me of W){const Te=c.paint.get("model-rotation").constantOr(null),Oe=c.paint.get("model-scale").constantOr(null),Le=c.paint.get("model-translation").constantOr(null);me.computeModelMatrix(p,Te,Oe,Le,!0,!0,!1);const Ge=i.bA([]),Ue=i.ec(me.position.lat,p.transform.zoom),Ze=i.bq([],[1,1,1/Ue]);i.br(Ge,Ge,se),ee.push({zScaleMatrix:Ze,negCameraPosMatrix:Ge});for(const $e of me.nodes)lm(p.transform,$e,me.matrix,p.transform.expandedFarZProjMatrix,Se,fe,he);Se++}if(fe.sort(((me,Te)=>Te.depth-me.depth)),p.renderPass!=="shadow"){if(x===1)for(const me of he)Hf(me,p,c,ee[me.modelIndex],cn.disabled,p.colorModeForRenderPass());else{for(const me of he)Hf(me,p,c,ee[me.modelIndex],cn.disabled,Mn.disabled);for(const me of he)Hf(me,p,c,ee[me.modelIndex],p.stencilModeFor3D(),p.colorModeForRenderPass());p.resetStencilClippingMasks()}for(const me of fe)Hf(me,p,c,ee[me.modelIndex],cn.disabled,p.colorModeForRenderPass());N()}else{for(const me of he)Od(me.mesh,me.nodeModelMatrix,p,c);for(const me of fe)Od(me.mesh,me.nodeModelMatrix,p,c);N()}}},Du={line:function(p,n,c){if(p.hasElevatedBuckets=!1,p.hasNonElevatedBuckets=!1,p._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||p._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(n){const d=n.getVisibleCoordinates();for(const x of d){const E=n.getTile(x).getBucket(p);if(E&&(E.elevationType!=="none"?p.hasElevatedBuckets=!0:p.hasNonElevatedBuckets=!0,p.hasElevatedBuckets&&p.hasNonElevatedBuckets))break}}}else p.hasNonElevatedBuckets=!0},model:function(p,n,c){const d=n.getSource();if(!d.loaded())return;if(d.type==="vector"||d.type==="geojson")return void(c.modelManager&&c.modelManager.upload(c,d.type==="vector"?p.scope:""));if(d.type==="batched-model"||d.type!=="model")return;const x=d.getModels();for(const E of x)E.upload(c.context)},raster:function(p,n,c){const d=n.getSource();if(!(d instanceof Yu&&d.loaded()))return;const x=p.sourceLayer||d.rasterLayerIds&&d.rasterLayerIds[0];if(!x)return;const E=p.paint.get("raster-array-band")||d.getInitialBand(x);if(E==null)return;const I=n.getIds().map((D=>n.getTileByID(D)));for(const D of I)D.updateNeeded(p.id,E)&&d.prepareTile(D,x,p.id,E)},"raster-particle":function(p,n,c){const d=n.getSource();if(!(d instanceof Yu&&d.loaded()))return;const x=p.sourceLayer||d.rasterLayerIds&&d.rasterLayerIds[0];if(!x)return;const E=p.paint.get("raster-particle-array-band")||d.getInitialBand(x);if(E==null)return;const I=n.getIds().map((D=>n.getTileByID(D)));for(const D of I)D.updateNeeded(p.id,E)&&d.prepareTile(D,x,p.id,E)}},gh={fill:tf},Uc={fill:function(p,n,c,d){if(!c.layout||c.layout.get("fill-elevation-reference")==="none")return;const x=p.context.gl,E=new Mr(x.LEQUAL,Mr.ReadOnly,p.depthRangeFor3D),I=new cn({func:x.ALWAYS,mask:255},255,255,x.KEEP,x.KEEP,x.REPLACE),D=p.transform.getFreeCameraOptions().position,N=p.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const H of d){const W=n.getTile(H),ee=W.getBucket(c);if(!ee)continue;const Y=ee.elevatedStructures;if(!Y||Y.depthSegments.segments[0].primitiveLength===0)continue;const se=Cg(H.toUnwrapped(),D),fe=p.translatePosMatrix(H.projMatrix,W,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor")),he=Zl(fe,se,0,1,0);N.draw(p,x.TRIANGLES,E,I,Mn.disabled,gn.disabled,he,c.id,Y.vertexBuffer,Y.indexBuffer,Y.depthSegments,c.paint,p.transform.zoom)}}};class _p{constructor(n,c,d,x,E,I){this.context=new ni(n,c),this.transform=d,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=E,this._timeStamp=i.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const D=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const H of D)this._debugParams.enabledLayers[H]=!0;E.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),E.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),E.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),E.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),E.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),E.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const H of D)E.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],H);this.occlusionParams=new cm(E),this.setup(),this.numSublayers=ls.maxUnderzooming+ls.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.eG,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new sp(this),this._wireframeDebugCache=new mA,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const N=new i.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,N,n.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=x,this.worldview=I}updateTerrain(n,c){const d=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(d||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Wl(this,n));const x=this._terrain;this.transform.elevation=d?x:null,x.update(n,this.transform,c),this.transform.elevation&&!x.enabled&&(this.transform.elevation=null)}_updateFog(n){const c=n.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[d,x]=c.getFovAdjustedRange(this.transform._fov);if(d>x)return void(this.transform.fogCullDistSq=null);const E=d+.78*(x-d);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new Wl(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,c){if(this.width=n*i.o.devicePixelRatio,this.height=c*i.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style.order)this.style._mergedLayers[d].resize()}setup(){const n=this.context,c=new i.bd;c.emplaceBack(0,0),c.emplaceBack(i.al,0),c.emplaceBack(0,i.al),c.emplaceBack(i.al,i.al),this.tileExtentBuffer=n.createVertexBuffer(c,i.bf.members),this.tileExtentSegments=i.bg.simpleSegment(0,0,4,2);const d=new i.bd;d.emplaceBack(0,0),d.emplaceBack(i.al,0),d.emplaceBack(0,i.al),d.emplaceBack(i.al,i.al),this.debugBuffer=n.createVertexBuffer(d,i.bf.members),this.debugSegments=i.bg.simpleSegment(0,0,4,5);const x=new i.bd;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(x,i.bf.members),this.viewportSegments=i.bg.simpleSegment(0,0,4,2);const E=new i.b0;E.emplaceBack(0,0,0,0),E.emplaceBack(i.al,0,i.al,0),E.emplaceBack(0,i.al,0,i.al),E.emplaceBack(i.al,i.al,i.al,i.al),this.mercatorBoundsBuffer=n.createVertexBuffer(E,i.bi.members),this.mercatorBoundsSegments=i.bg.simpleSegment(0,0,4,2);const I=new i.b1;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(I);const D=new i.be;for(const H of[0,1,3,2,0])D.emplaceBack(H);this.debugIndexBuffer=n.createIndexBuffer(D),this.emptyTexture=new i.T(n,new i.q({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=i.bC();const N=this.context.gl;this.stencilClearMode=new cn({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,Mr.disabled,this.stencilClearMode,Mn.disabled,gn.disabled,xn(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,c,d){if(!c||this.currentStencilSource===c.id||!n.isTileClipped()||!d||d.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const N of d)if(this._tileClippingMaskIDs[N.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=c.id;const x=this.context,E=x.gl;this.nextStencilID+d.length>256&&this.clearStencil(),x.setColorMode(Mn.disabled),x.setDepthMode(Mr.disabled);const I=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of d){const N=c.getTile(D),H=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:W,tileBoundsIndexBuffer:ee,tileBoundsSegments:Y}=this.getTileBoundsBuffers(N);I.draw(this,E.TRIANGLES,Mr.disabled,new cn({func:E.ALWAYS,mask:0},H,255,E.KEEP,E.KEEP,E.REPLACE),Mn.disabled,gn.disabled,xn(D.projMatrix),"$clipping",W,ee,Y)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,c=this.context.gl;return new cn({func:c.NOTEQUAL,mask:255},n,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const c=this.context.gl;return new cn({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(n){const c=this.context.gl,d=n.sort(((I,D)=>D.overscaledZ-I.overscaledZ)),x=d[d.length-1].overscaledZ,E=d[0].overscaledZ-x+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const I={};for(let D=0;D<E;D++)I[D+x]=new cn({func:c.GEQUAL,mask:255},D+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=E,[I,d]}return[{[x]:cn.disabled},d]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Mn([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new i.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Mn.unblended:Mn.alphaBlended}colorModeForDrapableLayerRenderPass(n){const c=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Mn([c.ONE,c.ONE_MINUS_SRC_ALPHA,c.CONSTANT_ALPHA,c.ONE_MINUS_SRC_ALPHA],new i.ao(0,0,0,n===void 0?0:n),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(n,c,d,x=!1){if(this.depthOcclusion)return new Mr(this.context.gl.GREATER,Mr.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!x)return Mr.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Mr(d||this.context.gl.LEQUAL,c,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,c=Math.ceil(this.width),d=Math.ceil(this.height),x=this.context.bindFramebuffer.get(),E=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===c&&this.depthFBO.height===d||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),c!==0&&d!==0&&(this.depthFBO=new yi(this.context,c,d,!1,"texture"),this.depthTexture=new i.T(this.context,{width:c,height:d,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(x),n.bindTexture(n.TEXTURE_2D,E),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,c,d,0,0,c,d,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((n,c)=>n+c/this._fpsHistory.length),0))}render(n,c){const d=i.o.now();this._dt=d-this._timeStamp,this._timeStamp=d,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=c;const x=this.style._mergedLayers,E=!(!this.terrain||!this.terrain.enabled),I=()=>this.style._getOrder(E).filter((xt=>{const rt=x[xt];return!(rt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[rt.type]}));let D=I(),N=!1,H=!1,W=null;for(const xt of D){const rt=x[xt];rt.type==="circle"?N=!0:rt.type==="building"?W=rt:rt.type==="symbol"&&(rt.hasOcclusionOpacityProperties?H=!0:N=!0)}let ee=D.map((xt=>x[xt]));const Y=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(i.o.now()),this.imageManager.beginFrame();let se=0,fe=!1;for(const xt in Y){const rt=Y[xt];rt.used&&(rt.prepare(this.context),rt.getSource().usedInConflation&&++se)}let he=!1;for(const xt of ee)xt.isHidden(this.transform.zoom)||(xt.type==="clip"&&(he=!0),this.prepareLayer(xt));const Se={},me={},Te={},Oe={},Le={};for(const xt in Y){const rt=Y[xt];Se[xt]=rt.getVisibleCoordinates(),me[xt]=Se[xt].slice().reverse(),Te[xt]=rt.getVisibleCoordinates(!0).reverse(),Oe[xt]=rt.getShadowCasterCoordinates(),Le[xt]=rt.sortCoordinatesByDistance(Se[xt])}const Ge=xt=>{const rt=this.style.getLayerSourceCache(xt);return rt&&rt.used?rt.getSource():null};if(se||he||this._clippingActiveLastFrame){const xt=[],rt=[];let zt=0;for(const gt of ee)this.isSourceForClippingOrConflation(gt,Ge(gt))&&(xt.push(gt),rt.push(zt)),zt++;if(xt&&(he||xt.length>1)||this._clippingActiveLastFrame){he=!1;const gt=[];for(let Bt=0;Bt<xt.length;Bt++){const Gt=xt[Bt],ar=rt[Bt],Ht=this.style.getLayerSourceCache(Gt);if(!Ht||!Ht.used||!Ht.getSource().usedInConflation&&Gt.type!=="clip"&&Gt.type!=="building")continue;let Xt=i.eH,qr=i.bZ.None;const $r=[];let Yr=!0;if(Gt.type==="building")Xt=i.eJ;else if(Gt.type==="clip"){Xt=ar;for(const Lr of Gt.layout.get("clip-layer-types"))qr|=Lr==="model"?i.bZ.Model:Lr==="symbol"?i.bZ.Symbol:i.bZ.FillExtrusion;for(const Lr of Gt.layout.get("clip-layer-scope"))$r.push(Lr);Gt.isHidden(this.transform.zoom)?Yr=!1:he=!0}Yr&&gt.push({layer:Gt.fqid,cache:Ht,order:Xt,clipMask:qr,clipScope:$r})}this.replacementSource.setSources(gt),fe=!0}}this._clippingActiveLastFrame=he,fe||this.replacementSource.clear(),this.conflationActive=fe,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let xt=0;xt<ee.length;xt++){const rt=ee[xt],zt=rt.cutoffRange();if(this.longestCutoffRange=Math.max(zt,this.longestCutoffRange),zt>0){const gt=Ge(rt);gt&&(this.minCutoffZoom=Math.max(gt.minzoom,this.minCutoffZoom)),rt.minzoom&&(this.minCutoffZoom=Math.max(rt.minzoom,this.minCutoffZoom))}rt.is3D(E)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=xt),this._lastOcclusionLayer=xt)}const Ue=this.style&&this.style.fog;Ue?(this._fogVisible=Ue.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ue.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Te),this.opaquePassCutoff=0,D=I(),ee=D.map((xt=>x[xt])));const Ze=this._shadowRenderer;if(Ze){Ze.updateShadowParameters(this.transform,this.style.directionalLight);for(const xt in Y)for(const rt of Se[xt]){let zt={min:0,max:0};this.terrain&&(zt=this.terrain.getMinMaxForTile(rt)||zt),Ze.addShadowReceiver(rt.toUnwrapped(),zt.min,zt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.eI(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Dd(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const $e=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ve=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if($e&&!this._snow&&(this._snow=new kg(this)),!$e&&this._snow&&(this._snow.destroy(),delete this._snow),Ve&&!this._rain&&(this._rain=new _o(this)),!Ve&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),W){this.buildingTileBorderManager||(this.buildingTileBorderManager=new Go);const xt=this.style.getLayerSourceCache(W);this.buildingTileBorderManager.updateBorders(xt,W)}if(!Sn.has(this.context.gl))return;this.renderPass="offscreen";for(const xt of ee){const rt=n.getLayerSourceCache(xt);if(!xt.hasOffscreenPass()||xt.isHidden(this.transform.zoom))continue;const zt=rt?me[rt.id]:void 0;(xt.type==="custom"||xt.type==="raster"||xt.type==="raster-particle"||xt.isSky()||zt&&zt.length)&&this.renderLayer(this,rt,xt,zt)}this.depthRangeFor3D=[0,1-(ee.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,Oe)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const We=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),yt=(()=>{if(c.showOverdrawInspector)return i.ao.black;const xt=this.style.fog;if(xt&&this.transform.projection.supportsFog){const rt=this.style.getLut(xt.scope);if(!We){const zt=xt.properties.get("color-use-theme")==="none",gt=xt.properties.get("color").toNonPremultipliedRenderColor(zt?null:rt).toArray01();return new i.ao(...gt)}if(We){const zt=xt.properties.get("space-color-use-theme")==="none",gt=xt.properties.get("space-color").toNonPremultipliedRenderColor(zt?null:rt).toArray01();return new i.ao(...gt)}}return i.ao.transparent})();if(this.context.clear({color:yt,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=D.length-1;this.currentLayer>=0;this.currentLayer--){const xt=ee[this.currentLayer],rt=n.getLayerSourceCache(xt);if(xt.isSky())continue;const zt=rt?(xt.is3D(E)?Le:me)[rt.id]:void 0;this._renderTileClippingMasks(xt,rt,zt),this.renderLayer(this,rt,xt,zt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<D.length;this.currentLayer++){const xt=ee[this.currentLayer],rt=n.getLayerSourceCache(xt);xt.isSky()&&this.renderLayer(this,rt,xt,rt?me[rt.id]:void 0)}function lt(xt,rt){let zt;return rt&&(zt=(xt.type==="symbol"?Te:xt.is3D(E)?Le:me)[rt.id]),zt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<D.length;){const xt=ee[this.currentLayer];if(xt.type==="raster"||xt.type==="raster-particle"){const rt=n.getLayerSourceCache(xt);this.renderLayer(this,rt,xt,lt(xt,rt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Ot=0;Ze&&(Ot=Ze.getShadowCastingLayerCount());let _t=!1,It=-1;for(let xt=0;xt<D.length;++xt){const rt=ee[xt];rt.isHidden(this.transform.zoom)||rt.is3D(E)&&(It=xt)}H&&It===-1&&(N=!0);let ur=!1;for(;this.currentLayer<D.length;){const xt=ee[this.currentLayer],rt=n.getLayerSourceCache(xt);if(xt.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(xt)){if(xt.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!ur&&xt.is3D(E)&&!E){const zt=this.currentLayer,gt=Bt=>{for(this.currentLayer=0;this.currentLayer<ee.length;this.currentLayer++){const Gt=ee[this.currentLayer];if(gh[Gt.type]){const ar=this.style.getLayerSourceCache(Gt);gh[Gt.type](this,ar,Gt,lt(Gt,ar),Bt)}}};gt("initialize"),gt("reset"),this.currentLayer=zt,ur=!0}if(N&&!_t&&this.terrain&&!this.transform.isOrthographic&&(_t=!0,this.blitDepth()),H&&It!==-1&&this.currentLayer===It+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(xt,rt,rt?Se[rt.id]:void 0),this.renderLayer(this,rt,xt,lt(xt,rt)),!this.terrain&&Ze&&Ot>0&&xt.hasShadowPass()&&--Ot==0){{this.clearStencil(),this.resetStencilClippingMasks();const zt=this.currentLayer;for(this.currentLayer=0;this.currentLayer<ee.length;this.currentLayer++){const gt=ee[this.currentLayer];if(Uc[gt.type]){const Bt=this.style.getLayerSourceCache(gt);Uc[gt.type](this,Bt,gt,lt(gt,Bt))}}this.currentLayer=zt}if(Ze.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const zt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=zt;this.currentLayer++){const gt=ee[this.currentLayer];if(!gt.hasLightBeamPass())continue;const Bt=n.getLayerSourceCache(gt);this.renderLayer(this,Bt,gt,Bt?me[Bt.id]:void 0)}this.currentLayer=zt,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const zt=this.currentLayer;this.depthOcclusion=!0;for(const gt of this.layersWithOcclusionOpacity){this.currentLayer=gt;const Bt=ee[this.currentLayer],Gt=n.getLayerSourceCache(Bt),ar=Gt?me[Gt.id]:void 0;this.terrain||this._renderTileClippingMasks(Bt,Gt,Gt?Se[Gt.id]:void 0),this.renderLayer(this,Gt,Bt,ar)}this.depthOcclusion=!1,this.currentLayer=zt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let xt=null;ee.forEach((rt=>{const zt=n.getLayerSourceCache(rt);zt&&!rt.isHidden(this.transform.zoom)&&zt.getVisibleCoordinates().length&&(!xt||xt.getSource().maxzoom<zt.getSource().maxzoom)&&(xt=zt)})),xt&&this.options.showTileBoundaries&&am(this,xt,xt.getVisibleCoordinates(),i.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&am(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&(function(xt){const rt=xt.transform.padding;Ru(xt,xt.transform.height-(rt.top||0),3,zs),Ru(xt,rt.bottom||0,3,rf),co(xt,rt.left||0,3,Rg),co(xt,xt.transform.width-(rt.right||0),3,uA);const zt=xt.transform.centerPoint;(function(gt,Bt,Gt,ar){$f(gt,Bt-1,Gt-10,2,20,ar),$f(gt,Bt-10,Gt-1,20,2,ar)})(xt,zt.x,xt.transform.height-zt.y,hA)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),fe||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:c}=this.transform.projection,d=!c||!c.includes(n.type);if(Du[n.type]&&(d||this.terrain&&n.type==="custom")){const x=this.style.getLayerSourceCache(n);Du[n.type](n,x,this)}this.gpuTimingEnd()}renderLayer(n,c,d,x){d.isHidden(this.transform.zoom)||(d.type==="background"||d.type==="sky"||d.type==="custom"||d.type==="model"||d.type==="raster"||d.type==="raster-particle"||x&&x.length)&&(this.id=d.id,this.gpuTimingStart(d),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(d.type)&&(!n.terrain||d.type!=="custom")||d.type==="clip"||uc[d.type](n,c,d,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery,d=this.context.gl;let x=this.gpuTimers[n.id];x||(x=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:d.createQuery()}),x.calls++,d.beginQuery(c.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,c=this.context.gl,d=c.createQuery();this.deferredRenderGpuTimeQueries.push(d),c.beginQuery(n.TIME_ELAPSED_EXT,d)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const c={};for(const d in n){const x=n[d],E=this.context.extTimerQuery,I=E.getQueryParameter(x.query,this.context.gl.QUERY_RESULT)/1e6;E.deleteQueryEXT(x.query),c[d]=I}return c}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.gl;let d=0;for(const x of n)d+=c.getQueryParameter(x,c.QUERY_RESULT)/1e6,c.deleteQuery(x);return d}translatePosMatrix(n,c,d,x,E){if(!d[0]&&!d[1])return n;const I=E?x==="map"?this.transform.angle:0:x==="viewport"?-this.transform.angle:0;if(I){const H=Math.sin(I),W=Math.cos(I);d=[d[0]*W-d[1]*H,d[0]*H+d[1]*W]}const D=[E?d[0]:i.ay(c,d[0],this.transform.zoom),E?d[1]:i.ay(c,d[1],this.transform.zoom),0],N=new Float32Array(16);return i.br(N,n,D),N}saveTileTexture(n){if(n.context!==this.context)return;const c=n.size[0],d=this._tileTextures[c];d?d.push(n):this._tileTextures[c]=[n]}getTileTexture(n){const c=this._tileTextures[n];return c&&c.length>0?c.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,c,d){const x=d===void 0?this.terrain&&this.terrain.renderingToTexture:d,E=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(E.push("LIGHTING_3D_MODE"),E.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):x||E.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||E.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(E.push("TERRAIN"),this.linearFloatFilteringSupported()&&E.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&E.push("GLOBE"),!this._fogVisible||x||c!==void 0&&!c||E.push("FOG","FOG_DITHERING"),x&&E.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&E.push("OVERDRAW_INSPECTOR"),E}getOrCreateProgram(n,c){this.cache=this.cache||{};const d=c&&c.defines||[],x=c&&c.config,E=this.currentGlobalDefines(n,c&&c.overrideFog,c&&c.overrideRtt).concat(d),I=Iu.cacheKey(Dc[n],n,E,x);return this.cache[I]||(this.cache[I]=new Iu(this.context,n,Dc[n],x,fn[n],E)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,c){if(this.style.enable3dLights()){const d=this.style.directionalLight,x=this.style.ambientLight;if(d&&x){const E=((I,D,N)=>{const H=I.properties.get("direction"),W=I.properties.get("color-use-theme")==="none",ee=I.properties.get("color").toNonPremultipliedRenderColor(W?null:N.getLut(I.scope)).toArray01(),Y=I.properties.get("intensity"),se=D.properties.get("color-use-theme")==="none",fe=D.properties.get("color").toNonPremultipliedRenderColor(se?null:N.getLut(D.scope)).toArray01(),he=D.properties.get("intensity"),Se=[H.x,H.y,H.z],me=i.dK(fe,he),Te=i.dK(ee,Y);return{u_lighting_ambient_color:me,u_lighting_directional_dir:Se,u_lighting_directional_color:Te,u_ground_radiance:ks(Se,Te,me)}})(d,x,this.style);c.setLightsUniformValues(n,E)}}}uploadCommonUniforms(n,c,d,x,E){if(this.uploadCommonLightUniforms(n,c),this.terrain&&this.terrain.renderingToTexture)return;const I=this.style.fog;if(I){const D=I.getOpacity(this.transform.pitch),N=((H,W,ee,Y,se,fe,he,Se,me,Te,Oe,Le)=>{const Ge=H.transform,Ue=W.properties.get("color-use-theme")==="none",Ze=W.properties.get("color").toNonPremultipliedRenderColor(Ue?null:H.style.getLut(W.scope)).toArray01();Ze[3]=Y;const $e=H.frameCounter/1e3%1,[Ve,We]=W.properties.get("vertical-range");return{u_fog_matrix:ee?Ge.calculateFogTileMatrix(ee):Le||H.identityMat,u_fog_range:W.getFovAdjustedRange(Ge._fov),u_fog_color:Ze,u_fog_horizon_blend:W.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ve,We),We],u_fog_temporal_offset:$e,u_frustum_tl:se,u_frustum_tr:fe,u_frustum_br:he,u_frustum_bl:Se,u_globe_pos:me,u_globe_radius:Te,u_viewport:Oe,u_globe_transition:i.aj(Ge.zoom),u_is_globe:+(Ge.projection.name==="globe")}})(this,I,d,D,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.o.devicePixelRatio,this.transform.height*i.o.devicePixelRatio],x);c.setFogUniformValues(n,N)}E&&c.setCutoffUniformValues(n,E.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,c=n.createTexture();return n.bindTexture(n.TEXTURE_2D,c),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,c=this._backgroundTiles={},d=this.transform.coveringTiles({tileSize:512});for(const x of d)c[x.key]=n[x.key]||new Ju(x,512,this.transform.tileZoom,this,void 0,this.worldview);return c}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,c){return!(!n.is3D(!(!this.terrain||!this.terrain.enabled))||n.type!=="clip"&&n.type!=="building"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building"&&n.sourceLayer!=="procedural_buildings")&&(!c||c.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let c=this._cachedTileFogOpacities[n.key];return c||(this._cachedTileFogOpacities[n.key]=c=this.style.fog.getOpacityForTile(n)),c[0]>=Fr||c[1]>=Fr}setupDepthForOcclusion(n,c,d){const x=this.context,E=x.gl,I=!!d;var D;d||(d={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),x.activeTexture.set(E.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),d.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],d.u_depth_range_unpack=[2/((D=this.depthRangeFor3D)[1]-D[0]),-1-2*D[0]/(D[1]-D[0])],d.u_occluder_half_size=.5*this.occlusionParams.occluderSize,d.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),x.activeTexture.set(E.TEXTURE0),I||c.setTerrainUniformValues(x,d)}}function fm(p,n){let c=!1,d=null;const x=()=>{d=null,c&&(p(),d=setTimeout(x,n),c=!1)};return()=>(c=!0,d||x(),d)}class gA{constructor(n){this._hashName=n&&encodeURIComponent(n),i.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=fm(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const c=lf(n);if(this._hashName){const d=this._hashName;let x=!1;const E=location.hash.slice(1).split("&").map((I=>{const D=I.split("=")[0];return D===d?(x=!0,`${D}=${c}`):I})).filter((I=>I));return x||E.push(`${d}=${c}`),`#${E.join("&")}`}return`#${c}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map((d=>d.split("="))).forEach((d=>{d[0]===this._hashName&&(c=d)})),(c&&c[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some((d=>isNaN(Number(d))))){const d=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(c[3]||0):n.getBearing();return n.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:d,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function lf(p,n){const c=p.getCenter(),d=Math.round(100*p.getZoom())/100,x=Math.ceil((d*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,x),I=Math.round(c.lng*E)/E,D=Math.round(c.lat*E)/E,N=p.getBearing(),H=p.getPitch();let W=n?`/${I}/${D}/${d}`:`${d}/${D}/${I}`;return(N||H)&&(W+="/"+Math.round(10*N)/10),H&&(W+=`/${Math.round(H)}`),W}const fl={linearity:.3,easing:i.eK(0,0,.3,1)},ws=Object.assign({deceleration:2500,maxSpeed:1400},fl),Pl=Object.assign({deceleration:20,maxSpeed:1400},fl),Ou=Object.assign({deceleration:1e3,maxSpeed:360},fl),_A=Object.assign({deceleration:1e3,maxSpeed:90},fl);class _h{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.o.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,c=i.o.now();for(;n.length>0&&c-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)c.zoom+=E.zoomDelta||0,c.bearing+=E.bearingDelta||0,c.pitch+=E.pitchDelta||0,E.panDelta&&c.pan._add(E.panDelta),E.around&&(c.around=E.around),E.pinchAround&&(c.pinchAround=E.pinchAround);const d=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(c.pan.mag()){const E=Ra(c.pan.mag(),d,Object.assign({},ws,n||{}));x.offset=c.pan.mult(E.amount/c.pan.mag()),x.center=this._map.transform.center,Ss(x,E)}if(c.zoom){const E=Ra(c.zoom,d,Pl);x.zoom=this._map.transform.zoom+E.amount,Ss(x,E)}if(c.bearing){const E=Ra(c.bearing,d,Ou);x.bearing=this._map.transform.bearing+i.aA(E.amount,-179,179),Ss(x,E)}if(c.pitch){const E=Ra(c.pitch,d,_A);x.pitch=this._map.transform.pitch+E.amount,Ss(x,E)}if(x.zoom||x.bearing){const E=c.pinchAround===void 0?c.around:c.pinchAround;x.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Ss(p,n){(!p.duration||p.duration<n.duration)&&(p.duration=n.duration,p.easing=n.easing)}function Ra(p,n,c){const{maxSpeed:d,linearity:x,deceleration:E}=c,I=i.aA(p*x/(n/1e3),-d,d),D=Math.abs(I)/(E*x);return{easing:c.easing,duration:1e3*D,amount:I*(D/2)}}class ha extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,d,x={}){const E=st(c.getCanvasContainer(),d),I=c.unproject(E);super(n,Object.assign({point:E,lngLat:I,originalEvent:d},x)),this._defaultPrevented=!1,this.target=c}}class Wf extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c,d){const x=n==="touchend"?d.changedTouches:d.touches,E=dt(c.getCanvasContainer(),x),I=E.map((N=>c.unproject(N))),D=E.reduce(((N,H,W,ee)=>N.add(H.div(ee.length))),new i.P(0,0));super(n,{points:E,point:D,lngLats:I,lngLat:c.unproject(D),originalEvent:d}),this._defaultPrevented=!1}}class yp extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,c){super("wheel",{originalEvent:c}),this._defaultPrevented=!1}}class yA{constructor(n,c){this._map=n,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new yp(this._map,n))}mousedown(n,c){return this._mousedownPos=c,this._firePreventable(new ha(n.type,this._map,n))}mouseup(n){this._map.fire(new ha(n.type,this._map,n))}preclick(n){const c=new MouseEvent("preclick",n);this._map.fire(new ha(c.type,this._map,c))}click(n,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(n),this._map.fire(new ha(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new ha(n.type,this._map,n))}mouseover(n){this._map.fire(new ha(n.type,this._map,n))}mouseout(n){this._map.fire(new ha(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Wf(n.type,this._map,n))}touchmove(n){this._map.fire(new Wf(n.type,this._map,n))}touchend(n){this._map.fire(new Wf(n.type,this._map,n))}touchcancel(n){this._map.fire(new Wf(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class vA{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new ha(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ha("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new ha(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ea{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,c){this.isEnabled()&&n.shiftKey&&n.button===0&&(Ce(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(n,c){if(!this._active)return;const d=c,x=this._startPos,E=this._lastPos;if(!x||!E||E.equals(d)||!this._box&&d.dist(x)<this._clickTolerance)return;this._lastPos=d,this._box||(this._box=oe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const I=Math.min(x.x,d.x),D=Math.max(x.x,d.x),N=Math.min(x.y,d.y),H=Math.max(x.y,d.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${I}px,${N}px)`,this._box.style.width=D-I+"px",this._box.style.height=H-N+"px")}))}mouseupWindow(n,c){if(!this._active)return;const d=this._startPos,x=c;if(d&&n.button===0){if(this.reset(),Ke(),d.x!==x.x||d.y!==x.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:n})),{cameraAnimation:E=>E.fitScreenCoordinates(d,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ee(),delete this._startPos,delete this._lastPos}_fireEvent(n,c){return this._map.fire(new i.z(n,{originalEvent:c}))}}function Zf(p,n){const c={};for(let d=0;d<p.length;d++)c[p[d].identifier]=n[d];return c}class xA{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,c,d){(this.centroid||d.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),d.length===this.numTouches&&(this.centroid=(function(x){const E=new i.P(0,0);for(const I of x)E._add(I);return E.div(x.length)})(c),this.touches=Zf(d,c)))}touchmove(n,c,d){if(this.aborted||!this.centroid)return;const x=Zf(d,c);for(const E in this.touches){const I=x[E];(!I||I.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(n,c,d){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),d.length===0){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class vp{constructor(n){this.singleTap=new xA(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,c,d){this.singleTap.touchstart(n,c,d)}touchmove(n,c,d){this.singleTap.touchmove(n,c,d)}touchend(n,c,d){const x=this.singleTap.touchend(n,c,d);if(x){const E=n.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(x)<30;if(E&&I||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Xf{constructor(){this._zoomIn=new vp({numTouches:1,numTaps:2}),this._zoomOut=new vp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,c,d){this._zoomIn.touchstart(n,c,d),this._zoomOut.touchstart(n,c,d)}touchmove(n,c,d){this._zoomIn.touchmove(n,c,d),this._zoomOut.touchmove(n,c,d)}touchend(n,c,d){const x=this._zoomIn.touchend(n,c,d),E=this._zoomOut.touchend(n,c,d);return x?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(x)},{originalEvent:n})}):E?(this._active=!0,n.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(E)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const xp={0:1,2:2},dm={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class kd{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,c){return!1}_move(n,c){return{}}mousedown(n,c){if(this._lastPoint)return;const d=bt(n);this._correctButton(n,d)&&(this._lastPoint=c,this._eventButton=d)}mousemoveWindow(n,c){const d=this._lastPoint;if(d){if(n.preventDefault(),this._eventButton!=null&&(function(x,E){const I=xp[E];return x.buttons===void 0||(x.buttons&I)!==I})(n,this._eventButton))this.reset();else if(this._moved||!(c.dist(d)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(d,c)}}mouseupWindow(n){this._lastPoint&&bt(n)===this._eventButton&&(this._moved&&Ke(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zd extends kd{mousedown(n,c){super.mousedown(n,c),this._lastPoint&&(this._active=!0)}_correctButton(n,c){return c===0&&!n.ctrlKey}_move(n,c){return{around:c,panDelta:c.sub(n)}}}class pm extends kd{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?dm[n.pitchRotateKey]:void 0}_correctButton(n,c){return this._pitchRotateKey?c===0&&n[this._pitchRotateKey]:c===0&&n.ctrlKey||c===2}_move(n,c){const d=.8*(c.x-n.x);if(d)return this._active=!0,{bearingDelta:d}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class bA extends kd{constructor(n){super(n),this._pitchRotateKey=n.pitchRotateKey?dm[n.pitchRotateKey]:void 0}_correctButton(n,c){return this._pitchRotateKey?c===0&&n[this._pitchRotateKey]:c===0&&n.ctrlKey||c===2}_move(n,c){const d=-.5*(c.y-n.y);if(d)return this._active=!0,{pitchDelta:d}}contextmenu(n){this._pitchRotateKey||n.preventDefault()}}class wA{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),i.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(n,c,d){return this._calculateTransform(n,c,d)}touchmove(n,c,d){if(this._active&&!(d.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(d.length===1&&!i.eL())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,c,d)}}touchend(n,c,d){this._calculateTransform(n,c,d),this._active&&d.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,c,d){d.length>0&&(this._active=!0);const x=Zf(d,c),E=new i.P(0,0),I=new i.P(0,0);let D=0;for(const H in x){const W=x[H],ee=this._touches[H];ee&&(E._add(W),I._add(W.sub(ee)),D++,x[H]=W)}if(this._touches=x,D<this._minTouches||!I.mag())return;const N=I.div(D);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(D),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=oe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class Ba{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,c,d){return{}}touchstart(n,c,d){this._firstTwoTouches||d.length<2||(this._firstTwoTouches=[d[0].identifier,d[1].identifier],this._start([c[0],c[1]]))}touchmove(n,c,d){const x=this._firstTwoTouches;if(!x)return;n.preventDefault();const[E,I]=x,D=qa(d,c,E),N=qa(d,c,I);if(!D||!N)return;const H=this._aroundCenter?null:D.add(N).div(2);return this._move([D,N],H,n)}touchend(n,c,d){if(!this._firstTwoTouches)return;const[x,E]=this._firstTwoTouches,I=qa(d,c,x),D=qa(d,c,E);I&&D||(this._active&&Ke(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function qa(p,n,c){for(let d=0;d<p.length;d++)if(p[d].identifier===c)return n[d]}function mm(p,n){return Math.log2(p/n)}class x0 extends Ba{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,c){const d=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(mm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mm(this._distance,d),pinchAround:c}}}function SA(p,n){return 180*p.angleWith(n)/Math.PI}class b0 extends Ba{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,c){const d=this._vector;if(this._vector=n[0].sub(n[1]),d&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:SA(this._vector,d),pinchAround:c}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const c=25/(Math.PI*this._minDiameter)*360,d=this._startVector;if(!d)return!1;const x=SA(n,d);return Math.abs(x)<c}}function Am(p){return Math.abs(p.y)>Math.abs(p.x)}class gm extends Ba{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Am(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,c,d){const x=this._lastPoints;if(!x)return;const E=n[0].sub(x[0]),I=n[1].sub(x[1]);return this._map._cooperativeGestures&&!i.eL()&&d.touches.length<3||(this._valid=this.gestureBeginsVertically(E,I,d.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(E.y+I.y)/2*-.5})}gestureBeginsVertically(n,c,d){if(this._valid!==void 0)return this._valid;const x=n.mag()>=2,E=c.mag()>=2;if(!x&&!E)return;if(!x||!E)return this._firstMove==null&&(this._firstMove=d),d-this._firstMove<100&&void 0;const I=n.y>0==c.y>0;return Am(n)&&Am(c)&&I}}const TA={panStep:100,bearingStep:15,pitchStep:10};class w0{constructor(){const n=TA;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let c=0,d=0,x=0,E=0,I=0;switch(n.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:n.shiftKey?d=-1:(n.preventDefault(),E=-1);break;case 39:n.shiftKey?d=1:(n.preventDefault(),E=1);break;case 38:n.shiftKey?x=1:(n.preventDefault(),I=-1);break;case 40:n.shiftKey?x=-1:(n.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(d=0,x=0),{cameraAnimation:D=>{const N=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:S0,zoom:c?Math.round(N)+c*(n.shiftKey?2:1):N,bearing:D.getBearing()+d*this._bearingStep,pitch:D.getPitch()+x*this._pitchStep,offset:[-E*this._panStep,-I*this._panStep],center:D.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function S0(p){return p*(2-p)}const EA=4.000244140625,CA=1/450;class MA{constructor(n,c){this._map=n,this._el=n.getCanvasContainer(),this._handler=c,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=CA,i.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||i.eL()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const d=i.o.now(),x=d-(this._lastWheelEventTime||0);this._lastWheelEventTime=d,c!==0&&c%EA==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=c,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(x*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),n.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=n,this._delta-=c,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=st(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const H=this._type==="wheel"&&Math.abs(this._delta)>EA?this._wheelZoomRate:this._defaultZoomRate;let W=2/(1+Math.exp(-Math.abs(this._delta*H)));this._delta<0&&W!==0&&(W=1/W);const ee=c(),Y=Math.pow(2,ee),se=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):Y;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(se*W))),this._type==="wheel"&&(this._startZoom=ee,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const d=typeof this._targetZoom=="number"?this._targetZoom:c(),x=this._startZoom,E=this._easing;let I,D=!1;if(this._type==="wheel"&&x&&E){const H=Math.min((i.o.now()-this._lastWheelEventTime)/200,1),W=E(H);I=i.ak(x,d,W),H<1?this._frameId||(this._frameId=!0):D=!0}else I=d,D=!0;this._active=!0,D&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let N=I-c();return N*this._lastDelta<0&&(N=0),{noInertia:!0,needsRenderFrame:!D,zoomDelta:N,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let c=i.eM;if(this._prevEase){const d=this._prevEase,x=(i.o.now()-d.start)/d.duration,E=d.easing(x+.01)-d.easing(x),I=.27/Math.sqrt(E*E+1e-4)*.01,D=Math.sqrt(.0729-I*I);c=i.eK(I,D,.25,1)}return this._prevEase={start:i.o.now(),duration:n,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=oe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class IA{constructor(n,c){this._clickZoom=n,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class T0{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,c){return n.preventDefault(),{cameraAnimation:d=>{d.easeTo({duration:300,zoom:d.getZoom()+(n.shiftKey?-1:1),around:d.unproject(c)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class E0{constructor(){this._tap=new vp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,c,d){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?d.length>0&&(this._swipePoint=c[0],this._swipeTouch=d[0].identifier):this._tap.touchstart(n,c,d))}touchmove(n,c,d){if(this._tapTime){if(this._swipePoint){if(d[0].identifier!==this._swipeTouch)return;const x=c[0],E=x.y-this._swipePoint.y;return this._swipePoint=x,n.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(n,c,d)}touchend(n,c,d){this._tapTime?this._swipePoint&&d.length===0&&this.reset():this._tap.touchend(n,c,d)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class PA{constructor(n,c,d){this._el=n,this._mousePan=c,this._touchPan=d}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class C0{constructor(n,c,d){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=c,this._mousePitch=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class No{constructor(n,c,d,x){this._el=n,this._touchZoom=c,this._touchRotate=d,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ld=p=>p.zoom||p.drag||p.pitch||p.rotate;class zg extends i.z{}class cf{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,c){const d=i.av([],c,n);this.radius=i.ag(d[2]<0?i.eO([],d,this.constants):[d[0],d[1],0])}projectRay(n){i.eO(n,n,this.constants),i.aw(n,n),i.eP(n,n,this.constants);const c=i.c4([],n,this.radius);if(c[2]>0){const d=i.c4([],[0,0,1],i.bJ(c,[0,0,1])),x=i.c4([],i.aw([],[c[0],c[1],0]),this.radius),E=i.d7([],c,i.c4([],i.av([],i.d7([],x,d),c),2));c[0]=E[0],c[1]=E[1]}return c}}function bp(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class _m{constructor(n,c){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new _h(n),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new cf,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),i.aY(["handleEvent","handleWindowEvent"],this);const d=this._el;this._listeners=[[d,"touchstart",{passive:!0}],[d,"touchmove",{passive:!1}],[d,"touchend",void 0],[d,"touchcancel",void 0],[d,"mousedown",void 0],[d,"mousemove",void 0],[d,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[d,"mouseover",void 0],[d,"mouseout",void 0],[d,"dblclick",void 0],[d,"click",void 0],[d,"keydown",{capture:!1}],[d,"keyup",void 0],[d,"wheel",{passive:!1}],[d,"contextmenu",void 0],[window,"blur",void 0]];for(const[x,E,I]of this._listeners){const D=x===document?this.handleWindowEvent:this.handleEvent;x.addEventListener(E,D,I)}}destroy(){for(const[n,c,d]of this._listeners){const x=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(c,x,d)}}_addDefaultHandlers(n){const c=this._map,d=c.getCanvasContainer();this._add("mapEvent",new yA(c,n));const x=c.boxZoom=new ea(c,n);this._add("boxZoom",x);const E=new Xf,I=new T0;c.doubleClickZoom=new IA(I,E),this._add("tapZoom",E),this._add("clickZoom",I);const D=new E0;this._add("tapDragZoom",D);const N=c.touchPitch=new gm(c);this._add("touchPitch",N);const H=new pm(n),W=new bA(n);c.dragRotate=new C0(n,H,W),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",W,["mouseRotate"]);const ee=new zd(n),Y=new wA(c,n);c.dragPan=new PA(d,ee,Y),this._add("mousePan",ee),this._add("touchPan",Y,["touchZoom","touchRotate"]);const se=new b0,fe=new x0;c.touchZoomRotate=new No(d,fe,se,D),this._add("touchRotate",se,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new vA(c));const he=c.scrollZoom=new MA(c,this);this._add("scrollZoom",he,["mousePan"]);const Se=c.keyboard=new w0;this._add("keyboard",Se);for(const me of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[me]&&c[me].enable(n[me])}_add(n,c,d){this._handlers.push({handlerName:n,handler:c,allowed:d}),this._handlersById[n]=c}stop(n){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ld(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,c,d){for(const x in n)if(x!==d&&(!c||c.indexOf(x)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const c=[];for(const d of n)this._el.contains(d.target)&&c.push(d);return c}handleEvent(n,c){this._updatingCamera=!0;const d=n.type==="renderFrame",x=d?void 0:n,E={needsRenderFrame:!1},I={},D={},N=n.touches?this._getMapTouches(n.touches):void 0,H=N?dt(this._el,N):d?void 0:st(this._el,n);for(const{handlerName:Y,handler:se,allowed:fe}of this._handlers){if(!se.isEnabled())continue;let he;this._blockedByActive(D,fe,Y)?se.reset():se[c||n.type]&&(he=se[c||n.type](n,H,N),this.mergeHandlerResult(E,I,he,Y,x),he&&he.needsRenderFrame&&this._triggerRenderFrame()),(he||se.isActive())&&(D[Y]=se)}const W={};for(const Y in this._previousActiveHandlers)D[Y]||(W[Y]=x);this._previousActiveHandlers=D,(Object.keys(W).length||bp(E))&&(this._changes.push([E,I,W]),this._triggerRenderFrame()),(Object.keys(D).length||bp(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ee}=E;ee&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ee(this._map))}mergeHandlerResult(n,c,d,x,E){if(!d)return;Object.assign(n,d);const I={handlerName:x,originalEvent:d.originalEvent||E};d.zoomDelta!==void 0&&(c.zoom=I),d.panDelta!==void 0&&(c.drag=I),d.pitchDelta!==void 0&&(c.pitch=I),d.bearingDelta!==void 0&&(c.rotate=I)}_applyChanges(){const n={},c={},d={};for(const[x,E,I]of this._changes)x.panDelta&&(n.panDelta=(n.panDelta||new i.P(0,0))._add(x.panDelta)),x.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+x.pitchDelta),x.around!==void 0&&(n.around=x.around),x.aroundCoord!==void 0&&(n.aroundCoord=x.aroundCoord),x.pinchAround!==void 0&&(n.pinchAround=x.pinchAround),x.noInertia&&(n.noInertia=x.noInertia),Object.assign(c,E),Object.assign(d,I);this._updateMapTransform(n,c,d),this._changes=[]}_updateMapTransform(n,c,d){const x=this._map,E=x.transform,I=Te=>[Te.x,Te.y,Te.z];if((Te=>{const Oe=this._eventsInProgress.drag;return Oe&&!this._handlersById[Oe.handlerName].isActive()})()&&!bp(n)){const Te=E.zoom;E.cameraElevationReference="sea",this._originalZoom!=null&&E._orthographicProjectionAtLowPitch&&E.projection.name!=="globe"&&E.pitch===0?(E.cameraElevationReference="ground",E.zoom=this._originalZoom):(E.recenterOnTerrain(),E.cameraElevationReference="ground"),Te!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&x._stop(!0),!bp(n))return void this._fireEvents(c,d,!0);let{panDelta:D,zoomDelta:N,bearingDelta:H,pitchDelta:W,around:ee,aroundCoord:Y,pinchAround:se}=n;E._isCameraConstrained&&(N>0&&(N=0),E._isCameraConstrained=!1),se!==void 0&&(ee=se),(N||(Te=>c[Te]&&!this._eventsInProgress[Te])("drag"))&&ee&&(this._dragOrigin=I(E.pointCoordinate3D(ee)),this._originalZoom=E.zoom,this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",x._stop(!0),ee=ee||x.transform.centerPoint,H&&(E.bearing+=H),W&&(E.pitch+=W),E._updateCameraState();const fe=[0,0,0];if(D)if(E.projection.name==="mercator"){const Te=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(ee).dir),Oe=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(ee.sub(D)).dir);fe[0]=Oe[0]-Te[0],fe[1]=Oe[1]-Te[1]}else{const Te=E.pointCoordinate(ee);if(E.projection.name==="globe"){D=D.rotate(-E.angle);const Oe=E._pixelsPerMercatorPixel/E.worldSize;fe[0]=-D.x*i.eN(i.a$(Te.y))*Oe,fe[1]=-D.y*i.eN(E.center.lat)*Oe}else{const Oe=E.pointCoordinate(ee.sub(D));Te&&Oe&&(fe[0]=Oe.x-Te.x,fe[1]=Oe.y-Te.y)}}const he=E.zoom,Se=[0,0,0];if(N){const Te=I(Y||E.pointCoordinate3D(ee)),Oe={dir:i.aw([],i.av([],Te,E._camera.position))};if(Oe.dir[2]<0){const Le=E.zoomDeltaToMovement(Te,N);i.c4(Se,Oe.dir,Le)}}const me=i.d7(fe,fe,Se);E._translateCameraConstrained(me),N&&Math.abs(E.zoom-he)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(c,d,!0)}_fireEvents(n,c,d){const x=Ld(this._eventsInProgress),E=Ld(n),I={};for(const W in n){const{originalEvent:ee}=n[W];this._eventsInProgress[W]||(I[`${W}start`]=ee),this._eventsInProgress[W]=n[W]}!x&&E&&this._fireEvent("movestart",E.originalEvent);for(const W in I)this._fireEvent(W,I[W]);E&&this._fireEvent("move",E.originalEvent);for(const W in n){const{originalEvent:ee}=n[W];this._fireEvent(W,ee)}const D={};let N;for(const W in this._eventsInProgress){const{handlerName:ee,originalEvent:Y}=this._eventsInProgress[W];this._handlersById[ee].isActive()||(delete this._eventsInProgress[W],N=c[ee]||Y,D[`${W}end`]=N)}for(const W in D)this._fireEvent(W,D[W]);const H=Ld(this._eventsInProgress);if(d&&(x||E)&&!H){this._updatingCamera=!0;const W=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ee=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;W?(ee(W.bearing||this._map.getBearing())&&(W.bearing=0),this._map.easeTo(W,{originalEvent:N})):(this._map.fire(new i.z("moveend",{originalEvent:N})),ee(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,c){this._map.fire(new i.z(n,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((n=>{this._frameId=void 0,this.handleEvent(new zg("renderFrame",{timeStamp:n})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const RA="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class ku extends i.E{constructor(n,c){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,i.aY(["_renderFrameCallback"],this)}getCenter(){return new i.aR(this.transform.center.lng,this.transform.center.lat)}setCenter(n,c){return this.jumpTo({center:n},c)}panBy(n,c,d){return n=i.P.convert(n).mult(-1),this.panTo(this.transform.center,Object.assign({offset:n},c),d)}panTo(n,c,d){return this.easeTo(Object.assign({center:n},c),d)}getZoom(){return this.transform.zoom}setZoom(n,c){return this.jumpTo({zoom:n},c),this}zoomTo(n,c,d){return this.easeTo(Object.assign({zoom:n},c),d)}zoomIn(n,c){return this.zoomTo(this.getZoom()+1,n,c),this}zoomOut(n,c){return this.zoomTo(this.getZoom()-1,n,c),this}getBearing(){return this.transform.bearing}setBearing(n,c){return this.jumpTo({bearing:n},c),this}getPadding(){return this.transform.padding}setPadding(n,c){return this.jumpTo({padding:n},c),this}rotateTo(n,c,d){return this.easeTo(Object.assign({bearing:n},c),d)}resetNorth(n,c){return this.rotateTo(0,Object.assign({duration:1e3},n),c),this}resetNorthPitch(n,c){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},n),c),this}snapToNorth(n,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,c):this}getPitch(){return this.transform.pitch}setPitch(n,c){return this.jumpTo({pitch:n},c),this}cameraForBounds(n,c){n=i.aI.convert(n);const d=c&&c.bearing||0,x=c&&c.pitch||0,E=n.getNorthWest(),I=n.getSouthEast();return this._cameraForBounds(this.transform,E,I,d,x,c)}_extendPadding(n){const c={top:0,right:0,bottom:0,left:0};return n==null?Object.assign({},c,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:Object.assign({},c,n)}_extendCameraOptions(n){return(n=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,c){const d=c.max[0]-c.min[0],x=c.max[1]-c.min[1];return d/x>n.aspect?d/(2*Math.tan(.5*n.fovX)*n.aspect):x/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,c,d,x,E,I){const D=n.clone(),N=this._extendCameraOptions(I);D.bearing=x,D.pitch=E;const H=i.aR.convert(c),W=i.aR.convert(d),ee=.5*(H.lat+W.lat),Y=.5*(H.lng+W.lng),se=i.eQ(ee,Y),fe=i.aw([],se),he=i.aw([],i.bI([],fe,[0,1,0])),Se=i.bI([],he,fe),me=[he[0],he[1],he[2],0,Se[0],Se[1],Se[2],0,fe[0],fe[1],fe[2],0,0,0,0,1],Te=[se,i.eQ(H.lat,H.lng),i.eQ(W.lat,H.lng),i.eQ(W.lat,W.lng),i.eQ(H.lat,W.lng),i.eQ(ee,H.lng),i.eQ(ee,W.lng),i.eQ(H.lat,Y),i.eQ(W.lat,Y)];let Oe=i.d8.fromPoints(Te.map((gt=>[i.bJ(he,gt),i.bJ(Se,gt),i.bJ(fe,gt)])));const Le=i.af([],Oe.center,me);i.eR(Le)===0&&i.eS(Le,0,0,1),i.aw(Le,Le),i.c4(Le,Le,i.aD),D.center=i.eT(Le);const Ge=D.getWorldToCameraMatrix(),Ue=i.bl(new Float64Array(16),Ge);Oe=i.d8.applyTransform(Oe,i.aB([],Ge,me));const Ze=this._extendAABB(Oe,D,N,x);if(!Ze)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Oe=Ze,i.af(Le,Le,Ge);const $e=.5*(Oe.max[2]-Oe.min[2]),Ve=this._minimumAABBFrustumDistance(D,Oe),We=i.c4([],[0,0,1],$e),yt=i.d7(We,Le,We),lt=Ve+(D.pitch===0?0:i.bG(Le,yt)),Ot=D.globeCenterInViewSpace,_t=i.av([],Le,[Ot[0],Ot[1],Ot[2]]);i.aw(_t,_t),i.c4(_t,_t,lt);const It=i.d7([],Le,_t);i.af(It,It,Ue);const ur=i.eD/i.aD,xt=i.ag(It),rt=i.ce(Math.max(xt*ur-i.eD,Number.EPSILON),0),zt=Math.min(D.zoomFromMercatorZAdjusted(rt),N.maxZoom);return zt>.5*(i.cZ+i.cK)?(D.setProjection({name:"mercator"}),D.zoom=zt,this._cameraForBounds(D,c,d,x,E,I)):{center:D.center,zoom:zt,bearing:x,pitch:E}}_extendAABB(n,c,d,x){const E=.5*((d.padding.left||0)+(d.padding.right||0)),I=.5*((d.padding.top||0)+(d.padding.bottom||0)),D=I,N=E,H=E,W=I,ee=c.width-(N+H),Y=c.height-(D+W),se=i.av([],n.max,n.min),fe=Math.min(ee/se[0],Y/se[1]),he=Math.min(c.scaleZoom(c.scale*fe),d.maxZoom);if(isNaN(he))return null;const Se=c.scale/c.zoomScale(he),me=new i.d8([n.min[0]-N*Se,n.min[1]-W*Se,n.min[2]],[n.max[0]+H*Se,n.max[1]+D*Se,n.max[2]]),Te=(typeof d.offset.x=="number"&&typeof d.offset.y=="number"?new i.P(d.offset.x,d.offset.y):i.P.convert(d.offset)).rotate(-i.an(x));return me.center[0]-=Te.x*Se,me.center[1]+=Te.y*Se,me}queryTerrainElevation(n,c){const d=this.transform.elevation;return d?(c=Object.assign({},{exaggerated:!0},c),d.getAtPoint(i.ae.fromLngLat(n),null,c.exaggerated)):null}_cameraForBounds(n,c,d,x,E,I){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,c,d,x,E,I);const D=n.clone(),N=this._extendCameraOptions(I);D.bearing=x,D.pitch=E;const H=i.aR.convert(c),W=i.aR.convert(d),ee=new i.aR(H.lng,W.lat),Y=new i.aR(W.lng,H.lat),se=D.project(H),fe=D.project(W),he=this.queryTerrainElevation(H),Se=this.queryTerrainElevation(W),me=this.queryTerrainElevation(ee),Te=this.queryTerrainElevation(Y),Oe=[[se.x,se.y,Math.min(he||0,Se||0,me||0,Te||0)],[fe.x,fe.y,Math.max(he||0,Se||0,me||0,Te||0)]];let Le=i.d8.fromPoints(Oe);const Ge=D.getWorldToCameraMatrix(),Ue=i.bl(new Float64Array(16),Ge);Le=i.d8.applyTransform(Le,Ge);const Ze=this._extendAABB(Le,D,N,x);if(!Ze)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Le=Ze;const $e=.5*i.av([],Le.max,Le.min)[2],Ve=this._minimumAABBFrustumDistance(D,Le),We=[0,0,1,0];i.aC(We,We,Ge),i.eU(We,We);const yt=i.c4([],We,Ve+$e),lt=i.d7([],Le.center,yt);i.af(Le.center,Le.center,Ue),i.af(lt,lt,Ue);const Ot=D.unproject(new i.P(Le.center[0],Le.center[1])),_t=i.eV(D.projection,Ot),It=Math.pow(2,_t),ur=Math.min(D._zoomFromMercatorZ(lt[2]*D.pixelsPerMeter*It/D.worldSize),N.maxZoom);return D.mercatorFromTransition&&ur<.5*(i.cZ+i.cK)?(D.setProjection({name:"globe"}),D.zoom=ur,this._cameraForBounds(D,c,d,x,E,I)):{center:Ot,zoom:ur,bearing:x,pitch:E}}fitBounds(n,c,d){const x=this.cameraForBounds(n,c);return this._fitInternal(x,c,d)}fitScreenCoordinates(n,c,d,x,E){const I=i.P.convert(n),D=i.P.convert(c),N=new i.P(Math.min(I.x,D.x),Math.min(I.y,D.y)),H=new i.P(Math.max(I.x,D.x),Math.max(I.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(I,D))return this;const W=this.transform.pointLocation3D(N),ee=this.transform.pointLocation3D(H),Y=this.transform.pointLocation3D(new i.P(N.x,H.y)),se=this.transform.pointLocation3D(new i.P(H.x,N.y)),fe=[Math.min(W.lng,ee.lng,Y.lng,se.lng),Math.min(W.lat,ee.lat,Y.lat,se.lat)],he=[Math.max(W.lng,ee.lng,Y.lng,se.lng),Math.max(W.lat,ee.lat,Y.lat,se.lat)],Se=x&&x.pitch?x.pitch:this.getPitch(),me=this._cameraForBounds(this.transform,fe,he,d,Se,x);return this._fitInternal(me,x,E)}_fitInternal(n,c,d){return n?(c=Object.assign(n,c)).linear?this.easeTo(c,d):this.flyTo(c,d):this}jumpTo(n,c){this.stop();const d=n.preloadOnly?this.transform.clone():this.transform;let x=!1,E=!1,I=!1;"zoom"in n&&d.zoom!==+n.zoom&&(x=!0,d.zoom=+n.zoom),n.center!==void 0&&(d.center=i.aR.convert(n.center)),"bearing"in n&&d.bearing!==+n.bearing&&(E=!0,d.bearing=+n.bearing),"pitch"in n&&d.pitch!==+n.pitch&&(I=!0,d.pitch=+n.pitch);const D=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!d.isPaddingEqual(D))if(n.retainPadding===!1){const N=d.clone();N.padding=D,d.setLocationAtPoint(d.center,N.centerPoint)}else d.padding=D;return n.preloadOnly?(this._preloadTiles(d),this):(this.fire(new i.z("movestart",c)).fire(new i.z("move",c)),x&&this.fire(new i.z("zoomstart",c)).fire(new i.z("zoom",c)).fire(new i.z("zoomend",c)),E&&this.fire(new i.z("rotatestart",c)).fire(new i.z("rotate",c)).fire(new i.z("rotateend",c)),I&&this.fire(new i.z("pitchstart",c)).fire(new i.z("pitch",c)).fire(new i.z("pitchend",c)),this.fire(new i.z("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(RA),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,c){const d=this.transform;if(!d.projection.supportsFreeCamera)return i.w(RA),this;this.stop();const x=d.zoom,E=d.pitch,I=d.bearing;d.setFreeCameraOptions(n);const D=x!==d.zoom,N=E!==d.pitch,H=I!==d.bearing;return this.fire(new i.z("movestart",c)).fire(new i.z("move",c)),D&&this.fire(new i.z("zoomstart",c)).fire(new i.z("zoom",c)).fire(new i.z("zoomend",c)),H&&this.fire(new i.z("rotatestart",c)).fire(new i.z("rotate",c)).fire(new i.z("rotateend",c)),N&&this.fire(new i.z("pitchstart",c)).fire(new i.z("pitch",c)).fire(new i.z("pitchend",c)),this.fire(new i.z("moveend",c)),this}easeTo(n,c){this._stop(!1,n.easeId),((n=Object.assign({offset:[0,0],duration:500,easing:i.eM},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const d=this.transform,x=this.getZoom(),E=this.getBearing(),I=this.getPitch(),D=this.getPadding(),N="zoom"in n?+n.zoom:x,H="bearing"in n?this._normalizeBearing(n.bearing,E):E,W="pitch"in n?+n.pitch:I,ee=this._extendPadding(n.padding),Y=i.P.convert(n.offset);let se,fe,he;if(d.projection.name==="globe"){const We=i.ae.fromLngLat(d.center),yt=Y.rotate(-d.angle);We.x+=yt.x/d.worldSize,We.y+=yt.y/d.worldSize;const lt=We.toLngLat(),Ot=i.aR.convert(n.center||lt);this._normalizeCenter(Ot),se=d.centerPoint.add(yt),fe=new i.P(We.x,We.y).mult(d.worldSize),he=new i.P(i.aF(Ot.lng),i.aJ(Ot.lat)).mult(d.worldSize).sub(fe)}else{se=d.centerPoint.add(Y);const We=d.pointLocation(se),yt=i.aR.convert(n.center||We);this._normalizeCenter(yt),fe=d.project(We),he=d.project(yt).sub(fe)}const Se=d.zoomScale(N-x);let me,Te;n.around&&(me=i.aR.convert(n.around),Te=d.locationPoint(me));const Oe=this._zooming||N!==x,Le=this._rotating||E!==H,Ge=this._pitching||W!==I,Ue=!d.isPaddingEqual(ee),Ze=n.retainPadding===!1?d.clone():d,$e=We=>yt=>{if(Oe&&(We.zoom=i.ak(x,N,yt)),Le&&(We.bearing=i.ak(E,H,yt)),Ge&&(We.pitch=i.ak(I,W,yt)),Ue&&(Ze.interpolatePadding(D,ee,yt),se=Ze.centerPoint.add(Y)),me)We.setLocationAtPoint(me,Te);else{const lt=We.zoomScale(We.zoom-x),Ot=N>x?Math.min(2,Se):Math.max(.5,Se),_t=Math.pow(Ot,1-yt),It=We.unproject(fe.add(he.mult(yt*_t)).mult(lt));We.setLocationAtPoint(We.renderWorldCopies?It.wrap():It,se)}return n.preloadOnly||this._fireMoveEvents(c),We};if(n.preloadOnly){const We=this._emulate($e,n.duration,d);return this._preloadTiles(We),this}const Ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Oe,this._rotating=Le,this._pitching=Ge,this._padding=Ue,this._easeId=n.easeId,this._prepareEase(c,n.noMoveStart,Ve),this._ease($e(d),(We=>{d.cameraElevationReference==="sea"&&d.recenterOnTerrain(),this._afterEase(c,We)}),n),this}_prepareEase(n,c,d={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),c||d.moving||this.fire(new i.z("movestart",n)),this._zooming&&!d.zooming&&this.fire(new i.z("zoomstart",n)),this._rotating&&!d.rotating&&this.fire(new i.z("rotatestart",n)),this._pitching&&!d.pitching&&this.fire(new i.z("pitchstart",n))}_fireMoveEvents(n){this.fire(new i.z("move",n)),this._zooming&&this.fire(new i.z("zoom",n)),this._rotating&&this.fire(new i.z("rotate",n)),this._pitching&&this.fire(new i.z("pitch",n))}_afterEase(n,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const d=this._zooming,x=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,d&&this.fire(new i.z("zoomend",n)),x&&this.fire(new i.z("rotateend",n)),E&&this.fire(new i.z("pitchend",n)),this.fire(new i.z("moveend",n))}flyTo(n,c){if(this._prefersReducedMotion(n)){const gt=i.aH(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(gt,c)}this.stop(),n=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:i.eM},n);const d=this.transform,x=this.getZoom(),E=this.getBearing(),I=this.getPitch(),D=this.getPadding(),N="zoom"in n?i.aA(+n.zoom,d.minZoom,d.maxZoom):x,H="bearing"in n?this._normalizeBearing(n.bearing,E):E,W="pitch"in n?+n.pitch:I,ee=this._extendPadding(n.padding),Y=d.zoomScale(N-x),se=i.P.convert(n.offset);let fe=d.centerPoint.add(se);const he=d.pointLocation(fe),Se=i.aR.convert(n.center||he);this._normalizeCenter(Se);const me=d.project(he),Te=d.project(Se).sub(me);let Oe=n.curve;const Le=Math.max(d.width,d.height),Ge=Le/Y,Ue=Te.mag();if("minZoom"in n){const gt=i.aA(Math.min(n.minZoom,x,N),d.minZoom,d.maxZoom),Bt=Le/d.zoomScale(gt-x);Oe=Math.sqrt(Bt/Ue*2)}const Ze=Oe*Oe;function $e(gt){const Bt=(Ge*Ge-Le*Le+(gt?-1:1)*Ze*Ze*Ue*Ue)/(2*(gt?Ge:Le)*Ze*Ue);return Math.log(Math.sqrt(Bt*Bt+1)-Bt)}function Ve(gt){return(Math.exp(gt)-Math.exp(-gt))/2}function We(gt){return(Math.exp(gt)+Math.exp(-gt))/2}const yt=$e(0);let lt=function(gt){return We(yt)/We(yt+Oe*gt)},Ot=function(gt){return Le*((We(yt)*(Ve(Bt=yt+Oe*gt)/We(Bt))-Ve(yt))/Ze)/Ue;var Bt},_t=($e(1)-yt)/Oe;if(Math.abs(Ue)<1e-6||!isFinite(_t)){if(Math.abs(Le-Ge)<1e-6)return this.easeTo(n,c);const gt=Ge<Le?-1:1;_t=Math.abs(Math.log(Ge/Le))/Oe,Ot=function(){return 0},lt=function(Bt){return Math.exp(gt*Oe*Bt)}}n.duration="duration"in n?+n.duration:1e3*_t/("screenSpeed"in n?+n.screenSpeed/Oe:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const It=E!==H,ur=W!==I,xt=!d.isPaddingEqual(ee),rt=n.retainPadding===!1?d.clone():d,zt=gt=>Bt=>{const Gt=Bt*_t,ar=1/lt(Gt);gt.zoom=Bt===1?N:x+gt.scaleZoom(ar),It&&(gt.bearing=i.ak(E,H,Bt)),ur&&(gt.pitch=i.ak(I,W,Bt)),xt&&(rt.interpolatePadding(D,ee,Bt),fe=rt.centerPoint.add(se));const Ht=Bt===1?Se:gt.unproject(me.add(Te.mult(Ot(Gt))).mult(ar));return gt.setLocationAtPoint(gt.renderWorldCopies?Ht.wrap():Ht,fe),gt._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(c),gt};if(n.preloadOnly){const gt=this._emulate(zt,n.duration,d);return this._preloadTiles(gt),this}return this._zooming=!0,this._rotating=It,this._pitching=ur,this._padding=xt,this._prepareEase(c,!1),this._ease(zt(d),(()=>this._afterEase(c)),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const d=this._onEaseEnd;this._onEaseEnd=void 0,d.call(this,c)}if(!n){const d=this.handlers;d&&d.stop(!1)}return this}_ease(n,c,d){d.animate===!1||d.duration===0?(n(1),c()):(this._easeStart=i.o.now(),this._easeOptions=d,this._onEaseFrame=n,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((i.o.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,c){n=i.bT(n,-180,180);const d=Math.abs(n-c);return Math.abs(n-360-c)<d&&(n-=360),Math.abs(n+360-c)<d&&(n+=360),n}_normalizeCenter(n){const c=this.transform;if(c.maxBounds||c.projection.name!=="globe"&&!c.renderWorldCopies)return;const d=n.lng-c.center.lng;n.lng+=d>180?-360:d<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&i.o.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,c,d){const x=Math.ceil(15*c/1e3),E=[],I=n(d.clone());for(let D=0;D<=x;D++){const N=I(D/x);E.push(N.clone())}return E}_preloadTiles(n,c){}}class wp{constructor(n={}){this.options=n,i.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const c=this.options&&this.options.compact,d=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=oe("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",d);const x=oe("span","mapboxgl-ctrl-icon",this._compactButton);return x.setAttribute("aria-hidden","true"),x.setAttribute("title",d),this._innerContainer=oe("div","mapboxgl-ctrl-attrib-inner",this._container),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(n){const d=c.reduce(((x,E,I)=>(E.value&&(x+=`${E.key}=${E.value}${I<c.length-1?"&":""}`),x)),"?");n.href=`${i.e.FEEDBACK_URL}/${d}#${lf(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||(n.dataType!=="source"||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility")&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const c=this._map.style._mergedSourceCaches;for(const x in c){const E=c[x];if(E.used){const I=E.getSource();I.attribution&&n.indexOf(I.attribution)<0&&n.push(I.attribution)}}n.sort(((x,E)=>x.length-E.length)),n=n.filter(((x,E)=>{for(let I=E+1;I<n.length;I++)if(n[I].indexOf(x)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const d=n.join(" | ");d!==this._attribHTML&&(this._attribHTML=d,n.length?(this._innerContainer.innerHTML=d,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class hc{constructor(){i.aY(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=oe("div","mapboxgl-ctrl");const c=oe("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const c in n){const d=n[c].getSource();if(d.hasOwnProperty("mapbox_logo")&&!d.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class uf{constructor(){i.aY(["_onIndoorUpdate"],this)}onAdd(n){return this._map=n,this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",(c=>this._onIndoorUpdate({selectedFloorId:c.selectedFloorId,floors:c.floors}))),this._container}_createButton(n,c){const d=oe("button",n,this._container);return d.type="button",d.addEventListener("click",c),d}_createSeparator(){return oe("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(n,c){this._map&&(n.setAttribute("aria-label",c),n.textContent=c)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(n){if(!n||!n.floors)return void(this._container.style.display="none");const c=this._model;this._model=n,this._container.style.display="inline-block",this._container.style.borderRadius="8px";const d=n.floors.sort(((x,E)=>E.levelOrder-x.levelOrder));c?(Array.from(this._container.children).forEach((x=>x.remove())),this.addCurrentFloors(d)):this.addCurrentFloors(d)}addCurrentFloors(n){for(let c=0;c<n.length;c++){const d=n[c],x=this._createButton("mapboxgl-ctrl-level-button",(()=>{this._map._selectIndoorFloor(d.id),this._model&&(this._model.selectedFloorId=d.id),Array.from(this._container.children).forEach((E=>{E.classList.contains("mapboxgl-ctrl-level-button")&&E.classList.remove("mapboxgl-ctrl-level-button-selected")})),x.classList.add("mapboxgl-ctrl-level-button-selected")}));this._setButtonTitle(x,d.shortName),this._model&&d.id===this._model.selectedFloorId&&x.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(x),c<n.length-1&&this._createSeparator()}}}class Ei{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const c=++this._id;return this._queue.push({callback:n,id:c,cancelled:!1}),c}remove(n){const c=this._currentlyRunning,d=c?this._queue.concat(c):this._queue;for(const x of d)if(x.id===n)return void(x.cancelled=!0)}run(n=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const d of c)if(!d.cancelled&&(d.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class yh{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const c=i.dz((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,c,d){this._start=this.getValue(c),this._end=n,this._startTime=c,this._endTime=c+d}}const ym={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Sp extends i.z{constructor(n,c,d,x){const{point:E,lngLat:I,originalEvent:D,target:N}=n;super(n.type,{point:E,lngLat:I,originalEvent:D,target:N}),this.preventDefault=()=>{n.preventDefault()},this.id=c,this.interaction=d,this.feature=x}}class Tp{constructor(n){this.map=n,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(n,c){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const d=c.filter;let x=c.type;d&&this.filters.set(n,i.b6(d)),x==="mouseover"&&(x="mouseenter"),x==="mouseout"&&(x="mouseleave");const E=this.interactionsByType.get(x)||new Map;x==="mouseenter"||x==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(n,c)):E.size===0&&this.map.on(x,this.handleType),E.size===0&&this.interactionsByType.set(x,E),E.set(n,c),this.typeById.set(n,x)}get(n){const c=this.typeById.get(n);if(!c)return;const d=this.interactionsByType.get(c);return d?d.get(n):void 0}remove(n){const c=this.typeById.get(n);if(!c)return;this.typeById.delete(n),this.filters.delete(n);const d=this.interactionsByType.get(c);d&&(d.delete(n),c==="mouseenter"||c==="mouseleave"?(this.delegatedInteractions.delete(n),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):d.size===0&&this.map.off(c,this.handleType))}queryTargets(n,c){const d=[];for(const[x,E]of c)E.target&&d.push({targetId:x,target:E.target,filter:this.filters.get(x)});return this.map.style.queryRenderedTargets(n,d,this.map.transform)}handleMove(n){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const c=this.queryTargets(n.point,Array.from(this.delegatedInteractions).reverse());c.length&&(n.type="mouseenter",this.handleType(n,c));const d=new Map;for(const[x,{feature:E}]of this.prevHoveredFeatures)this.hoveredFeatures.has(x)||d.set(E.id,E);d.size&&(n.type="mouseleave",this.handleType(n,Array.from(d.values())))}handleOut(n){const c=Array.from(this.hoveredFeatures.values()).map((({feature:d})=>d));c.length&&(n.type="mouseleave",this.handleType(n,c)),this.hoveredFeatures.clear()}handleType(n,c){const d=n.type==="mouseenter";if(d&&!this.interactionsByType.has(n.type))return void i.w("mouseenter interaction required for mouseleave to work.");const x=Array.from(this.interactionsByType.get(n.type)).reverse(),E=!!c;c=c||this.queryTargets(n.point,x);let I=!1;const D=new Set;for(const N of c){for(const[H,W]of x){if(!W.target)continue;const ee=N.variants?N.variants[H]:null;if(ee){for(const Y of ee){if(Ku(Y,N,D,H))continue;const se=new i.dt(N,Y),fe=Qu(Y,N,H);E&&(se.state=this.map.getFeatureState(se));const he=d?this.prevHoveredFeatures.get(fe):null,Se=new Sp(n,H,W,se),me=he?he.stop:W.handler(Se);if(d&&this.hoveredFeatures.set(fe,{feature:N,stop:me}),me!==!1){I=!0;break}}if(I)break}}if(I)break}if(!I)for(const[N,H]of x){const{handler:W,target:ee}=H;if(!ee&&W(new Sp(n,N,H,null))!==!1)break}}}function Yf(p,n){if(Array.isArray(p)&&Array.isArray(n)){const c=new Set(p),d=new Set(n);return c.size===d.size&&p.every((x=>d.has(x)))}return i.by(p,n)}const Ep={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Lg={showCompass:!0,showZoom:!0,visualizePitch:!1};class vm{constructor(n,c,d=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new pm({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,d&&(this.mousePitch=new bA({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),i.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(n,c){this.mouseRotate.mousedown(n,c),this.mousePitch&&this.mousePitch.mousedown(n,c),Ce()}move(n,c){const d=this.map,x=this.mouseRotate.mousemoveWindow(n,c),E=x&&x.bearingDelta;if(E&&d.setBearing(d.getBearing()+E),this.mousePitch){const I=this.mousePitch.mousemoveWindow(n,c),D=I&&I.pitchDelta;D&&d.setPitch(d.getPitch()+D)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ee(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(Object.assign({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),st(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,st(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=dt(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=dt(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function fc(p,n,c){if(p=new i.aR(p.lng,p.lat),n){const d=new i.aR(p.lng-360,p.lat),x=new i.aR(p.lng+360,p.lat),E=360*Math.ceil(Math.abs(p.lng-c.center.lng)/360),I=c.locationPoint3D(p).distSqr(n),D=n.x<0||n.y<0||n.x>c.width||n.y>c.height;c.locationPoint3D(d).distSqr(n)<I&&(D||Math.abs(d.lng-c.center.lng)<E)?p=d:c.locationPoint3D(x).distSqr(n)<I&&(D||Math.abs(x.lng-c.center.lng)<E)&&(p=x)}for(;Math.abs(p.lng-c.center.lng)>180;){const d=c.locationPoint3D(p);if(d.x>=0&&d.y>=0&&d.x<=c.width&&d.y<=c.height)break;p.lng>c.center.lng?p.lng-=360:p.lng+=360}return p}const Cp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},Rl={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Qf extends i.E{constructor(n,c){super(),(n instanceof HTMLElement||c)&&(n=Object.assign({element:n},c)),i.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:d="center",color:x="#3FB1CE",scale:E=1,draggable:I=!1,clickTolerance:D=0,rotation:N=Rl.rotation,rotationAlignment:H=Rl.rotationAlignment,pitchAlignment:W=Rl.pitchAlignment,occludedOpacity:ee=Rl.occludedOpacity,altitude:Y=Rl.altitude}=n||{};this._anchor=d,this._color=x,this._scale=E,this._draggable=I,this._clickTolerance=D,this._rotation=N,this._rotationAlignment=H,this._pitchAlignment=W,this._occludedOpacity=ee,this._altitude=Y,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),n&&n.element?(this._element=n.element,this._offset=i.P.convert(n&&n.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=i.P.convert(n&&n.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(he=>{he.preventDefault()})),this._element.addEventListener("mousedown",(he=>{he.preventDefault()}));const se=this._element.classList;for(const he in Cp)se.remove(`mapboxgl-marker-anchor-${he}`);se.add(`mapboxgl-marker-anchor-${this._anchor}`);const fe=n&&n.className?n.className.trim().split(/\s+/):[];se.add(...fe),this._popup=null}_createDefaultMarker(){const n=oe("div"),c=ue("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},n);if(this._altitude===0){const d=ue("radialGradient",{id:"shadowGradient"},ue("defs",{},c));ue("stop",{offset:"10%","stop-opacity":.4},d),ue("stop",{offset:"100%","stop-opacity":.05},d),ue("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},c)}return ue("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},c),ue("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},c),ue("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},c),n}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=i.aR.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(n){return n===this._altitude||(this._defaultMarker&&(this._altitude===0&&n!==0||this._altitude!==0&&n===0)&&(this._element=this._createDefaultMarker()),this._altitude=n||Rl.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(38.1-13.5+x)],"bottom-right":[-x,-1*(38.1-13.5+x)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,n._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const c=n.code,d=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&d!==32&&d!==13||this.togglePopup()}_onMapClick(n){const c=n.originalEvent.target,d=this._element;this._popup&&(c===d||d.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,c=this._pos;if(!n||!c)return!1;const d=n.unproject(c,this._altitude),x=n.getFreeCameraOptions();if(!x.position)return!1;const E=x.position.toLngLat();return E.distanceTo(d)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const c=this._pos;if(!c||c.x<0||c.x>n.transform.width||c.y<0||c.y>n.transform.height)return void this._clearFadeTimer();const d=n.unproject(c,this._altitude);let x;n._showingGlobe()&&i.eY(n.transform,this._lngLat)?x=0:(x=1-n._queryFogOpacity(d),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${Cp[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const n=this._pos,c=this._map,d=this.getPitchAlignment();if(!c||!n||d!=="map")return"";if(!c._showingGlobe()){const N=c.getPitch();return N?`rotateX(${N}deg)`:""}const x=i.cW(i.eZ(c.transform,this._lngLat)),E=n.sub(i.e_(c.transform)),I=Math.abs(E.x)+Math.abs(E.y);if(I===0)return"";const D=x/I;return`rotateX(${-E.y*D}deg) rotateY(${E.x*D}deg)`}_calculateZTransform(){const n=this._pos,c=this._map;if(!c||!n)return"";let d=0;const x=this.getRotationAlignment();if(x==="map")if(c._showingGlobe()){const E=c.project(new i.aR(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),I=c.project(new i.aR(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(E);d=i.cW(Math.atan2(I.y,I.x))-90}else d=-c.getBearing();else if(x==="horizon"){const E=i.ah(4,6,c.getZoom()),I=i.e_(c.transform);I.y+=E*c.transform.height;const D=n.sub(I),N=i.cW(Math.atan2(D.y,D.x));d=(N>90?N-270:N+90)*(1-E)}return d+=this._rotation,d?`rotateZ(${d}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=fc(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat,this._altitude),n===!0?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),c._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(n){return this._offset=i.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const c=this._map;if(!c)return;const d=this._pointerdownPos,x=this._positionDelta;if(d&&x){if(!this._isDragging){const E=this._clickTolerance||c._clickTolerance;if(n.point.dist(d)<E)return;this._isDragging=!0}this._pos=n.point.sub(x),this._lngLat=c.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(n){const c=this._map,d=this._pos;c&&d&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(d),this._pointerdownPos=n.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const c=this._map;return c&&(n?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||Rl.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||Rl.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||Rl.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||Rl.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const vh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},zu={maxWidth:100,unit:"metric"},Vc={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Kf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},Ts=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Wa(p=new i.P(0,0),n="bottom"){if(typeof p=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(n){case"top":return new i.P(0,p);case"top-left":return new i.P(c,c);case"top-right":return new i.P(-c,c);case"bottom":return new i.P(0,-p);case"bottom-left":return new i.P(c,-c);case"bottom-right":return new i.P(-c,-c);case"left":return new i.P(p,0);case"right":return new i.P(-p,0)}return new i.P(0,0)}return p instanceof i.P||Array.isArray(p)?i.P.convert(p):i.P.convert(p[n]||[0,0])}return{version:z,supported:ne.supported,setRTLTextPlugin:i.f2,getRTLTextPluginStatus:i.f1,Map:class extends ku{constructor(p){F.mark(B.create);const n=p;if((p=Object.assign({},Ep,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&i.eW(window)&&(p.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Rs(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies,null,null),p),this._repaint=!!p.repaint,this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new Ei,this._domRenderTaskQueue=new Ei,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.b2(),this._locale=Object.assign({},ym,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._tessellationStep=p.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=p.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new yh(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=p.scaleFactor,this._requestManager=new wt(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,this._contextCreateOptions=p.contextCreateOptions?Object.assign({},p.contextCreateOptions):{},typeof p.container=="string"){const c=document.getElementById(p.container);if(!c)throw new Error(`Container '${p.container.toString()}' not found.`);this._container=c}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),this._spriteFormat=p.spriteFormat,i.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new gp),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},(()=>{this.setScaleFactor(this._scaleFactor)})),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new _m(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,(p.style||!p.testMode)&&this.setStyle(p.style||i.e.DEFAULT_STYLE,{config:p.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this.indoor=new Hh(this),p.hash&&(this._hash=new gA(typeof p.hash=="string"&&p.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch});const c=p.bounds;c&&(this.resize(),this.fitBounds(c,Object.assign({},p.fitBoundsOptions,{duration:0})))}this.resize(),p.attributionControl&&this.addControl(new wp({customAttribution:p.customAttribution})),this._logoControl=new hc,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(c=>{this._update(c.dataType==="style"),this.fire(new i.z(`${c.dataType}data`,c))})),this.on("dataloading",(c=>{this.fire(new i.z(`${c.dataType}dataloading`,c))})),this._interactions=new Tp(this)}_getMapId(){return this._mapId}addControl(p,n){if(n===void 0&&(n=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=p.onAdd(this);this._controls.push(p);const d=this._controlPositions[n];return n.indexOf("bottom")!==-1?d.insertBefore(c,d.firstChild):d.appendChild(c),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(p);return n>-1&&this._controls.splice(n,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new i.z("movestart",p)).fire(new i.z("move",p)),this.fire(new i.z("resize",p)),n&&this.fire(new i.z("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(i.aI.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(p){return this._scaleFactor=p,this.painter.scaleFactor=p,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers((n=>n.type==="symbol")),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return p==="auto"?navigator.language:Array.isArray(p)?p.length===0?void 0:p.map((n=>n==="auto"?navigator.language:n)):p}setLanguage(p){const n=this._parseLanguage(p);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(p){return this._lazyInitEmptyStyle(),p?typeof p=="string"&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const p=this.transform,n=p.projection.name;let c;n==="globe"&&p.zoom>=i.cK?(p.setMercatorFromTransition(),c=!0):n==="mercator"&&p.zoom<i.cK&&(p.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(p,n){return this._updateProjection(p||n||{name:"mercator"})}_updateProjection(p){let n;return n=p.name==="globe"&&this.transform.zoom>=i.cK?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(p,n){return this.transform.locationPoint3D(i.aR.convert(p),n)}unproject(p,n){return this.transform.pointLocation3D(i.P.convert(p),n)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,n,c){const d=x=>{let E=[];if(Array.isArray(n)){const I=n.filter((D=>this.getLayer(D)));E=I.length?this.queryRenderedFeatures(x,{layers:I}):[]}else E=this.queryRenderedFeatures(x,{target:n});return E};if(p==="mouseenter"||p==="mouseover"){let x=!1;return{listener:c,targets:n,delegates:{mousemove:I=>{const D=d(I.point);D.length?x||(x=!0,c.call(this,new ha(p,this,I.originalEvent,{features:D}))):x=!1},mouseout:()=>{x=!1}}}}if(p==="mouseleave"||p==="mouseout"){let x=!1;return{listener:c,targets:n,delegates:{mousemove:D=>{d(D.point).length?x=!0:x&&(x=!1,c.call(this,new ha(p,this,D.originalEvent)))},mouseout:D=>{x&&(x=!1,c.call(this,new ha(p,this,D.originalEvent)))}}}}{const x=E=>{const I=d(E.point);I.length&&(E.features=I,c.call(this,E),delete E.features)};return{listener:c,targets:n,delegates:{[p]:x}}}}on(p,n,c){if(typeof n=="function"||c===void 0)return super.on(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const d=this._createDelegatedListener(p,n,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(d);for(const x in d.delegates)this.on(x,d.delegates[x]);return this}once(p,n,c){if(typeof n=="function"||c===void 0)return super.once(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const d=this._createDelegatedListener(p,n,c);for(const x in d.delegates)this.once(x,d.delegates[x]);return this}off(p,n,c){if(typeof n=="function"||c===void 0)return super.off(p,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const d=this._delegatedListeners?this._delegatedListeners[p]:void 0;return d&&(x=>{for(let E=0;E<x.length;E++){const I=x[E];if(I.listener===c&&Yf(I.targets,n)){for(const D in I.delegates)this.off(D,I.delegates[D]);return x.splice(E,1),this}}})(d),this}queryRenderedFeatures(p,n){if(!this.style)return[];if(p===void 0||p instanceof i.P||Array.isArray(p)||n!==void 0||(n=p,p=void 0),p=p||[[0,0],[this.transform.width,this.transform.height]],!n){const E=this.style.queryRenderedFeatures(p,void 0,this.transform),I=this.style.queryRenderedFeatureset(p,void 0,this.transform);return E.concat(I)}let c=!0;if(n.target&&(c=this._isTargetValid(n.target),c&&!n.layers))return this.style.queryRenderedFeatureset(p,n,this.transform);let d=!0;if(n.layers&&Array.isArray(n.layers)){for(const E of n.layers)if(!this._isValidId(E)){d=!1;break}if(d&&!n.target)return this.style.queryRenderedFeatures(p,n,this.transform)}let x=[];return d&&(x=x.concat(this.style.queryRenderedFeatures(p,n,this.transform))),c&&(x=x.concat(this.style.queryRenderedFeatureset(p,n,this.transform))),x}querySourceFeatures(p,n){return!p||typeof p=="string"&&!this._isValidId(p)?[]:this.style.querySourceFeatures(p,n)}queryRasterValue(p,n,c){return this._isValidId(p)?this.style.queryRasterValue(p,n,c):Promise.resolve(null)}isPointOnSurface(p){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&i.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(p))}addInteraction(p,n){return this._interactions.add(p,n),this}removeInteraction(p){return this._interactions.remove(p),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(p){return this._cooperativeGestures=p,this}setStyle(p,n){return n=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&p&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(p,((c,d)=>{if(c){const x=typeof c=="string"?c:c instanceof Error?c.message:c.error;i.w(`Unable to perform style diff: ${x}. Rebuilding the style from scratch.`),this._updateStyle(p,n)}else d&&this._update(!0)}),(()=>this._postStyleLoadEvent())),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(p,n))}_getUIString(p){const n=this._locale[p];if(n==null)throw new Error(`Missing UI string '${p}'`);return n}_updateStyle(p,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p){const c=Object.assign({},n);n&&n.config&&(c.initialConfig=n.config,delete c.config),this.style=new Tl(this,c).load(p),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Tl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(p){return p==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.dm(p)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${p}".`))),!1)}_isTargetValid(p){return"featuresetId"in p?this._isValidId("importId"in p?p.importId:p.featuresetId):"layerId"in p&&this._isValidId(p.layerId)}_areTargetsValid(p){if(Array.isArray(p)){for(const n of p)if(!this._isValidId(n))return!1;return!0}return this._isTargetValid(p)}addSource(p,n){return this._isValidId(p)?(this._lazyInitEmptyStyle(),this.style.addSource(p,n),this._update(!0)):this}isSourceLoaded(p){return!!this._isValidId(p)&&!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(p,n,c){this._lazyInitEmptyStyle(),this.style.addSourceType(p,n,c)}removeSource(p){return this._isValidId(p)?(this.style.removeSource(p),this._updateTerrain(),this._update(!0)):this}getSource(p){return this._isValidId(p)?this.style.getOwnSource(p):null}addImage(p,n,{pixelRatio:c=1,sdf:d=!1,stretchX:x,stretchY:E,content:I}={}){this._lazyInitEmptyStyle();const D=i.I.from(p);if(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:N,height:H,data:W}=i.o.getImageData(n);this.style.addImage(D,{data:new i.q({width:N,height:H},W),pixelRatio:c,stretchX:x,stretchY:E,content:I,sdf:d,version:0,usvg:!1})}else if(n.width===void 0||n.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:N,height:H}=n,W=n;this.style.addImage(D,{data:new i.q({width:N,height:H},new Uint8Array(W.data)),pixelRatio:c,stretchX:x,stretchY:E,content:I,sdf:d,usvg:!1,version:0,userImage:W}),W.onAdd&&W.onAdd(this,p)}}updateImage(p,n){this._lazyInitEmptyStyle();const c=i.I.from(p),d=this.style.getImage(c);if(!d)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?i.o.getImageData(n):n,{width:E,height:I,data:D}=x;if(E===void 0||I===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(E!==(d.usvg?d.icon.usvg_tree.width:d.data.width)||I!==(d.usvg?d.icon.usvg_tree.height:d.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${E}, ${I})
                must be that same as the previous version of the image
                (${d.data.width}, ${d.data.height})`)));const N=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);let H=!1;d.usvg?(d.data=new i.q({width:E,height:I},new Uint8Array(D)),d.usvg=!1,d.icon=void 0,H=!0):d.data.replace(D,N),this.style.updateImage(c,d,H)}hasImage(p){return p?!!this.style&&!!this.style.getImage(i.I.from(p)):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(i.I.from(p))}loadImage(p,n){i.n(this._requestManager.transformRequest(p,i.R.Image),((c,d)=>{n(c,d instanceof HTMLImageElement?i.o.getImageData(d):d)}))}listImages(){return this.style.listImages().map((p=>p.name))}addModel(p,n){this._lazyInitEmptyStyle(),this.style.addModel(p,n)}hasModel(p){return p?this.style.hasModel(p):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(p){this.style.removeModel(p)}listModels(){return this.style.listModels()}addLayer(p,n){return this._isValidId(p.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(p,n),this._update(!0)):this}getSlot(p){const n=this.getLayer(p);return n&&n.slot||null}setSlot(p,n){return this.style.setSlot(p,n),this.style.mergeLayers(),this._update(!0)}addImport(p,n){return this.style.addImport(p,n).catch((c=>this.fire(new i.y(new Error("Failed to add import",c))))),this}updateImport(p,n){return typeof n!="string"&&n.id!==p?(this.removeImport(p),this.addImport(n)):(this.style.updateImport(p,n),this._update(!0))}removeImport(p){return this.style.removeImport(p),this}moveImport(p,n){return this.style.moveImport(p,n),this._update(!0)}moveLayer(p,n){return this._isValidId(p)?(this.style.moveLayer(p,n),this._update(!0)):this}removeLayer(p){return this._isValidId(p)?(this.style.removeLayer(p),this._update(!0)):this}getLayer(p){if(!this._isValidId(p))return null;const n=this.style.getOwnLayer(p);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(p,n,c){return this._isValidId(p)?(this.style.setLayerZoomRange(p,n,c),this._update(!0)):this}setFilter(p,n,c={}){return this._isValidId(p)?(this.style.setFilter(p,n,c),this._update(!0)):this}getFilter(p){return this._isValidId(p)?this.style.getFilter(p):null}setPaintProperty(p,n,c,d={}){return this._isValidId(p)?(this.style.setPaintProperty(p,n,c,d),this._update(!0)):this}getPaintProperty(p,n){return this._isValidId(p)?this.style.getPaintProperty(p,n):null}setLayoutProperty(p,n,c,d={}){return this._isValidId(p)?(this.style.setLayoutProperty(p,n,c,d),this._update(!0)):this}getLayoutProperty(p,n){return this._isValidId(p)?this.style.getLayoutProperty(p,n):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(p){return this.style.setGlyphsUrl(p),this._update(!0)}getSchema(p){return this.style.getSchema(p)}setSchema(p,n){return this.style.setSchema(p,n),this._update(!0)}getConfig(p){return this.style.getConfig(p)}setConfig(p,n){return this.style.setConfig(p,n),this._update(!0)}getConfigProperty(p,n){return this.style.getConfigProperty(p,n)}setConfigProperty(p,n,c){return this.style.setConfigProperty(p,n,c),this._update(!0)}getFeaturesetDescriptors(p){return this.style.getFeaturesetDescriptors(p)}setLights(p){if(this._lazyInitEmptyStyle(),p&&p.length===1&&p[0].type==="flat"){const n=p[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(p),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const p=this.style.getLights()||[];return p.length===0&&p.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),p}setLight(p,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:p}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(p){return this._lazyInitEmptyStyle(),this.style.setSnow(p),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(p){return this._lazyInitEmptyStyle(),this.style.setRain(p),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(p){return this._lazyInitEmptyStyle(),this.style.setColorTheme(p),this._update(!0)}setImportColorTheme(p,n){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(p,n),this._update(!0)}setCamera(p){return this.style.setCamera(p),this._triggerCameraUpdate(p)}_triggerCameraUpdate(p){return this._update(this.transform.setOrthographicProjectionAtLowPitch(p["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.aR.convert(p),this.transform):0}setFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.setFeatureState(p,n),this._update())}removeFeatureState(p,n){return p.source&&!this._isValidId(p.source)?this:(this.style.removeFeatureState(p,n),this._update())}getFeatureState(p){return p.source&&!this._isValidId(p.source)?null:this.style.getFeatureState(p)}_selectIndoorFloor(p){this.indoor.selectFloor(p)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new uf),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let c,d,x,E=this._container;for(;E&&(!d||!x);){const I=window.getComputedStyle(E).transform;I&&I!=="none"&&(c=I.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(d=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(x=c[3])),E=E.parentElement}this._containerWidth=d?Math.abs(p/d):p,this._containerHeight=x?Math.abs(n/x):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=oe("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=oe("div","mapboxgl-canvas-container",p);this._canvas=oe("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=oe("div","mapboxgl-control-container",p),d=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((x=>{d[x]=oe("div",`mapboxgl-ctrl-${x}`,c)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,n){const c=i.o.devicePixelRatio||1;this._canvas.width=c*Math.ceil(p),this._canvas.height=c*Math.ceil(n),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${n}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const n=this._markers.indexOf(p);n!==-1&&this._markers.splice(n,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const n=this._popups.indexOf(p);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const p=Object.assign({},ne.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",p);n?(Tr(n,!0),this.painter=new _p(n,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",(c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),i.k.testSupport(n)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let n;this.fire(new i.z("renderstart")),++this._frameId;const c=this.painter.context.extTimerQuery,d=i.o.now(),x=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=x.createQuery(),x.beginQuery(c.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const H=this.transform.zoom,W=this.transform.pitch,ee=i.o.now(),Y=new i.ac(H,{now:ee,fadeDuration:E,pitch:W,transition:this.style.transition,worldview:this._worldview});this.style.update(Y)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let I=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),I=this._updateAverageElevation(d),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):I=this._updateAverageElevation(d);const D=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),D&&(this._placementDirty=D.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,F.mark(B.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const H=i.o.now()-d;x.endQuery(c.TIME_ELAPSED_EXT),setTimeout((()=>{const W=x.getQueryParameter(n,x.QUERY_RESULT)/1e6;x.deleteQuery(n),this.fire(new i.z("gpu-timing-frame",{cpuTime:H,gpuTime:W}))}),50)}if(this.listens("gpu-timing-layer")){const H=this.painter.collectGpuTimers();setTimeout((()=>{const W=this.painter.queryGpuTimers(H);this.fire(new i.z("gpu-timing-layer",{layerTimes:W}))}),50)}if(this.listens("gpu-timing-deferred-render")){const H=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const W=this.painter.queryGpuTimeDeferredRender(H);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:W}))}),50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||I;if(N||this._repaint)this.triggerRepaint();else{const H=this.idle();if(H&&(I=this._updateAverageElevation(d,!0)),I)this.triggerRepaint();else if(this._triggerFrame(!1),H&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const W=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:W})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,F.mark(B.fullLoad),this._performanceMetricsCollection&&jn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const n of this._markers)p&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!p||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(p,n=!1){const c=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);const d=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(d||(n||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const x=this.transform.averageElevation;let E=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=p;const I=Math.abs(x-E);if(I>1){if(this._isInitialLoad||d)return this._averageElevation.jumpTo(E),c(E);this._averageElevation.easeTo(E,p,300)}else if(I>1e-4)return this._averageElevation.jumpTo(E),c(E)}return!!this._averageElevation.isEasing(p)&&c(this._averageElevation.getValue(p))}_authenticate(){Gr(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(p=>{if(p&&(p.message===Pt||p.status===401)){const n=this.painter.context.gl;Tr(n,!1),this._logoControl instanceof hc&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),ln(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&Hr(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const c=this.painter.context.gl,d=c.createFramebuffer();function x(E){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,E,0);const I=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,I),I}return c.bindFramebuffer(c.FRAMEBUFFER,d),this._canvasPixelComparison(x(p),n.canvasCopies.map(x),n.timeStamps)}_canvasPixelComparison(p,n,c){let d=c[1]-c[0];const x=p.length/4;for(let E=0;E<n.length;E++){const I=n[E];let D=0;for(let N=0;N<I.length;N+=4)I[N]===p[N]&&I[N+1]===p[N+1]&&I[N+2]===p[N+2]&&I[N+3]===p[N+3]&&(D+=1);d+=(c[E+2]-c[E+1])*(1-D/x)}return d}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Sn.delete(this.painter.context.gl),Ur.remove(),Cr.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=i.o.frame((n=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(n)})))}_preloadTiles(p){const n=this.style?this.style.getSourceCaches():[];return i.bw(n,((c,d)=>c._preloadTiles(p,d)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(p){this._showParseStatus!==p&&(this._showParseStatus=p,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(p){this._showLayers2DWireframe!==p&&(this._showLayers2DWireframe=p,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(p){this._showLayers3DWireframe!==p&&(this._showLayers3DWireframe=p,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,this._tp.refreshUI(),p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,this._tp.refreshUI(),p&&this._update())}_setCacheLimits(p,n){i.eX(p,n)}get version(){return z}},NavigationControl:class{constructor(p={}){this.options=Object.assign({},Lg,p),this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this.options.showZoom&&(i.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(n=>{this._map&&this._map.zoomIn({},{originalEvent:n})})),oe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(n=>{this._map&&this._map.zoomOut({},{originalEvent:n})})),oe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(n=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:n}):c.resetNorth({},{originalEvent:n}))})),this._compassIcon=oe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const n=p.getZoom(),c=n===p.getMaxZoom(),d=n===p.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=n)}))}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new vm(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,n){const c=oe("button",p,this._container);return c.type="button",c.addEventListener("click",n),c}_setButtonTitle(p,n){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${n}`);p.setAttribute("aria-label",c),p.firstElementChild&&p.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends i.E{constructor(p={}){super();const n=navigator.geolocation;this.options=Object.assign({geolocation:n},vh,p),i.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=fm(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const n=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,p(c)};this._supportsGeolocation!==void 0?p(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then((c=>n(c.state!=="denied"))).catch((()=>n())):n()}_isOutOfMapMaxBounds(p){const n=this._map.getMaxBounds(),c=p.coords;return!!n&&(c.longitude<n.getWest()||c.longitude>n.getEast()||c.latitude<n.getSouth()||c.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(p),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(p),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",p)),this._finish()}}_updateCamera(p){const n=new i.aR(p.coords.longitude,p.coords.latitude),c=p.coords.accuracy,d=this._map.getBearing(),x=Object.assign({bearing:d},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(c),x,{geolocateSource:!0})}_updateMarker(p){if(p){const n=new i.aR(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,n=i.ce(1,p._center.lat)*p.worldSize,c=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(p.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(p.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(n=>n.preventDefault())),this._geolocateButton=oe("button","mapboxgl-ctrl-geolocate",this._container),oe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",p===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=oe("div","mapboxgl-user-location"),this._dotElement.appendChild(oe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(oe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Qf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=oe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))}))}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:p.absolute===!0&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((n=>{n==="granted"&&p()})).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:wp,ScaleControl:class{constructor(p={}){this.options=Object.assign({},zu,p),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),i.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,n=this._map,c=n._containerHeight/2,d=n._containerWidth/2-p/2,x=n.unproject([d,c]),E=n.unproject([d+p,c]),I=x.distanceTo(E);if(this.options.unit==="imperial"){const D=3.2808*I;D>5280?this._setScale(p,D/5280,"mile"):this._setScale(p,D,"foot")}else this.options.unit==="nautical"?this._setScale(p,I/1852,"nautical-mile"):I>=1e3?this._setScale(p,I/1e3,"kilometer"):this._setScale(p,I,"meter")}_setScale(p,n,c){this._map._requestDomTask((()=>{const d=(function(E){const I=Math.pow(10,`${Math.floor(E)}`.length-1);let D=E/I;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:(function(N){const H=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*H)/H})(D),I*D})(n),x=d/n;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(d):`${d}&nbsp;${Vc[c]}`,this._container.style.width=p*x+"px"}))}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=oe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p={}){this._fullscreen=!1,p&&p.container&&(p.container instanceof HTMLElement?this._container=p.container:i.w("Full screen control 'container' must be a DOM element.")),i.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=oe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=oe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);oe("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:uf,Popup:class extends i.E{constructor(p){super(),this.options=Object.assign(Object.create(Kf),p),this._altitude=this.options.altitude,i.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=i.aR.convert(p),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(p){return this._altitude=p,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(document.createTextNode(p))}setHTML(p){const n=document.createDocumentFragment(),c=document.createElement("body");let d;for(c.innerHTML=p;d=c.firstChild,d;)n.appendChild(d);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=oe("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(p),this.options.closeButton){const c=this._closeButton=oe("button","mapboxgl-popup-close-button",n);c.type="button",c.setAttribute("aria-label","Close popup"),c.innerHTML='<span aria-hidden="true">&#215;</span>',c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let n;return this._classList.delete(p)?n=!1:(this._classList.add(p),n=!0),this._updateClassList(),n}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const n=this._map,c=this._container,d=this._pos;if(!n||!c||!d)return"bottom";const x=c.offsetWidth,E=c.offsetHeight,I=d.x<x/2,D=d.x>n.transform.width-x/2;if(d.y+p<E)return I?"top-left":D?"top-right":"top";if(d.y>n.transform.height-E){if(I)return"bottom-left";if(D)return"bottom-right"}return I?"left":D?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),p.className=n.join(" ")}_update(p){const n=this._map,c=this._content;if(!n||!this._lngLat&&!this._trackPointer||!c)return;let d=this._container;if(d||(d=this._container=oe("div","mapboxgl-popup",n.getContainer()),this._tip=oe("div","mapboxgl-popup-tip",d),d.appendChild(c)),this.options.maxWidth&&d.style.maxWidth!==this.options.maxWidth&&(d.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=fc(this._lngLat,this._pos,n.transform)),!this._trackPointer||p){const x=this._pos=this._trackPointer&&p instanceof i.P?p:n.project(this._lngLat,this._altitude),E=Wa(this.options.offset),I=this._anchor=this._getAnchor(E.y),D=Wa(this.options.offset,I),N=x.add(D).round();n._requestDomTask((()=>{this._container&&I&&(this._container.style.transform=`${Cp[I]} translate(${N.x}px,${N.y}px)`)}))}if(!this._marker&&n._showingGlobe()){const x=i.eY(n.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(Ts);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:Qf,Style:Tl,LngLat:i.aR,LngLatBounds:i.aI,Point:i.P,MercatorCoordinate:i.ae,FreeCameraOptions:ap,Evented:i.E,config:i.e,prewarm:i.f0,clearPrewarmedResources:i.e$,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(p){i.e.ACCESS_TOKEN=p},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(p){i.e.API_URL=p},get workerCount(){return i.f9.workerCount},set workerCount(p){i.f9.workerCount=p},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){i.e.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){i.f8(p)},get workerUrl(){return i.f7.workerUrl},set workerUrl(p){i.f7.workerUrl=p},get workerClass(){return i.f7.workerClass},set workerClass(p){i.f7.workerClass=p},get workerParams(){return i.f7.workerParams},set workerParams(p){i.f7.workerParams=p},get dracoUrl(){return i.f6()},set dracoUrl(p){i.f5(p)},get meshoptUrl(){return i.f4()},set meshoptUrl(p){i.f3(p)},setNow:i.o.setNow,restoreNow:i.o.restoreNow}}));var T=m;return T}))})(Ob)),Ob.exports}var Xme=Zme();const lj=Zp(Xme),Yme=240;lj.accessToken="pk.eyJ1Ijoibml6YWdhbSIsImEiOiJjbTlsam50Y2IwNW5mMnFvOHZ1NjBvbTgyIn0.QTYMFBgRepCWgyo5Vvhbcg";const Qme=()=>{const[e,r]=ae.useState(null),[a,l]=ae.useState([]);return ae.useEffect(()=>{const m=new lj.Map({container:"map",style:"mapbox://styles/nizagam/cmficvpi7003n01sdh3mnchtf",center:[69.2,41.3],zoom:11,attributionControl:!1});return m.on("load",()=>{r(m)}),()=>m.remove()},[]),ae.useEffect(()=>{e&&(e.getSource("zones")||(e.addSource("zones",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),e.addLayer({id:"zones-fill",type:"fill",source:"zones",paint:{"fill-color":"#ffeb00","fill-opacity":.3}}),e.addLayer({id:"zones-outline",type:"line",source:"zones",paint:{"line-color":"#ffeb00","line-width":2}}),e.on("click",m=>{const y=$me(m.lngLat.lat,m.lngLat.lng,8);l(T=>T.includes(y)?T.filter(i=>i!==y):[...T,y])})))},[e]),ae.useEffect(()=>{if(!e)return;const m=a.map(T=>({type:"Feature",geometry:{type:"Polygon",coordinates:[Gme(T,!0)]},properties:{h3Index:T}})),y=e.getSource("zones");y&&y.setData({type:"FeatureCollection",features:m})},[e,a]),be.jsx(bo,{id:"map",sx:{position:"absolute",top:"64px",left:`${Yme}px`,right:0,bottom:0},children:be.jsx(Tf,{variant:"contained",color:"primary",sx:{position:"absolute",right:10,bottom:20},children:""})})};function Kme(){const e=localStorage.getItem("role"),r=localStorage.getItem("access_token"),a=localStorage.getItem("refresh_token");console.log(e,r,a);let l;return e&&r&&a?(l=`/${e}`,e=="superAdmin"&&(l="/super-admin")):l="/login",console.log(l),be.jsx(MQ,{children:be.jsxs(iQ,{children:[be.jsx(ns,{path:"/",element:be.jsx(rQ,{to:l,replace:!0})}),be.jsx(ns,{path:"/login",element:be.jsx(yee,{})}),be.jsxs(ns,{element:be.jsx(ZQ,{}),children:[be.jsxs(ns,{path:"/support",element:be.jsx(YQ,{}),children:[be.jsx(ns,{path:"",element:be.jsx(fT,{})}),be.jsx(ns,{path:"add-user-bonus",element:be.jsx(hT,{})})]}),be.jsxs(ns,{path:"/super-admin",element:be.jsx(XQ,{}),children:[be.jsx(ns,{path:"",element:be.jsx(ame,{})}),be.jsx(ns,{path:"register-admin",element:be.jsx(xee,{})}),be.jsx(ns,{path:"register-support",element:be.jsx(nk,{})}),be.jsx(ns,{path:"drivers",element:be.jsx(fT,{})}),be.jsx(ns,{path:"add-driver",element:be.jsx(tk,{})}),be.jsx(ns,{path:"settings",element:be.jsx(Tee,{})}),be.jsx(ns,{path:"tariffs",element:be.jsx(ume,{})}),be.jsx(ns,{path:"add-user-bonus",element:be.jsx(hT,{})}),be.jsx(ns,{path:"working-zone",element:be.jsx(Qme,{})}),be.jsx(ns,{path:"withdraw-driver",element:be.jsx(PL,{})}),be.jsx(ns,{path:"banners",element:be.jsx(Aee,{})})]}),be.jsxs(ns,{path:"/admin",element:be.jsx(WQ,{}),children:[be.jsx(ns,{path:"",element:be.jsx(fT,{})}),be.jsx(ns,{path:"add-driver",element:be.jsx(tk,{})}),be.jsx(ns,{path:"register-support",element:be.jsx(nk,{})}),be.jsx(ns,{path:"add-user-bonus",element:be.jsx(hT,{})}),be.jsx(ns,{path:"withdraw-driver",element:be.jsx(PL,{})})]})]})]})})}const Jme=Vw({palette:{primary:{main:"#ffeb00"}}});hY.createRoot(document.getElementById("root")).render(be.jsx(FG,{theme:Jme,children:be.jsx(Kme,{})}));
